/*!
*  filename: ej2-excel-export.min.js
*  version : 24.2.4
*  Copyright Syncfusion Inc. 2001 - 2023. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("SyncfusionBase"),require("SyncfusionCompression"),require("SyncfusionFileUtils")):"function"==typeof define&&define.amd?define(["SyncfusionBase","SyncfusionCompression","SyncfusionFileUtils"],t):"object"==typeof exports?exports.SyncfusionExcelExport=t(require("SyncfusionBase"),require("SyncfusionCompression"),require("SyncfusionFileUtils")):e.SyncfusionExcelExport=t(e.SyncfusionBase,e.SyncfusionCompression,e.SyncfusionFileUtils)}(this,function(e,t,r){return function(e){function t(o){if(r[o])return r[o].exports;var n=r[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var r={};return t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,o){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=13)}([function(t,r){t.exports=e},function(e,t,r){"use strict";r.d(t,"a",function(){return o});var o=function(){function e(){this.parts=[]}return e.prototype.append=function(e){this.parts.push(e),this.blob=void 0},e.prototype.getBlob=function(){return new Blob(this.parts,{type:"text/plain"})},e}()},function(e,t,r){"use strict";r.d(t,"a",function(){return o}),r.d(t,"b",function(){return n}),r.d(t,"c",function(){return i}),r.d(t,"d",function(){return s}),r.d(t,"e",function(){return l}),r.d(t,"f",function(){return a}),r.d(t,"g",function(){return u}),r.d(t,"h",function(){return d}),r.d(t,"i",function(){return c});var o=function(){function e(){this.numFmtId=0,this.backColor="none",this.fontName="Calibri",this.fontSize=10.5,this.fontColor="#000000",this.italic=!1,this.bold=!1,this.underline=!1,this.strikeThrough=!1,this.wrapText=!1,this.hAlign="general",this.vAlign="bottom",this.indent=0,this.rotation=0,this.numberFormat="GENERAL",this.type="datetime",this.borders=new c,this.isGlobalStyle=!1}return e}(),n=function(){function e(){this.sz=10.5,this.name="Calibri",this.u=!1,this.b=!1,this.i=!1,this.color="FF000000",this.strike=!1}return e}(),i=function(){function e(){}return e}(),s=function(){function e(){}return e}(),l=function(){function e(){}return e}(),a=function(){function e(){this.name="Normal",this.xfId=0}return e}(),u=function(){function e(e,t){this.numFmtId=e,this.formatCode=t}return e}(),d=function(){function e(e,t){this.lineStyle=e,this.color=t}return e}(),c=function(){function e(){this.left=new d("none","#FFFFFF"),this.right=new d("none","#FFFFFF"),this.top=new d("none","#FFFFFF"),this.bottom=new d("none","#FFFFFF"),this.all=new d("none","#FFFFFF")}return e}()},function(e,t,r){"use strict";r.d(t,"a",function(){return n}),r.d(t,"b",function(){return i});var o=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),n=function(){function e(){}return e}(),i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.add=function(e){for(var r=!1,o=0,n=0,i=t;n<i.length;n++){i[n].index===e.index&&(t[o]=e,r=!0),o++}r||t.push(e)},t}return o(t,e),t}(Array)},function(e,t,r){"use strict";r.d(t,"a",function(){return o});var o=function(){function e(){}return e}()},function(e,t,r){"use strict";r.d(t,"a",function(){return i});var o=r(7),n=r(15),i=(r.n(n),function(){function e(e,t){if(this.csvStr="",this.separator=null===t||void 0===t?",":t,this.formatter=new o.a,this.isMicrosoftBrowser=!!navigator.msSaveBlob,null!==e.isServerRendered&&void 0!==e.isServerRendered&&(this.isServerRendered=e.isServerRendered),null!==e.styles&&void 0!==e.styles){this.globalStyles=new Map;for(var r=0;r<e.styles.length;r++)void 0!==e.styles[r].name&&void 0!==e.styles[r].numberFormat&&this.globalStyles.set(e.styles[r].name,e.styles[r].numberFormat)}null!==e.worksheets&&void 0!==e.worksheets&&this.parseWorksheet(e.worksheets[0])}return e.prototype.parseWorksheet=function(e){null!==e.rows&&void 0!==e.rows&&this.parseRows(e.rows)},e.prototype.parseRows=function(e){for(var t=1,r=0,o=e;r<o.length;r++){var n=o[r];if(null===n.index||void 0===n.index)throw Error("Row index is missing.");for(;t<n.index;)this.csvStr+="\r\n",t++;this.parseRow(n)}this.csvStr+="\r\n"},e.prototype.parseRow=function(e){if(null!==e.cells&&void 0!==e.cells)for(var t=1,r=0,o=e.cells;r<o.length;r++){var n=o[r];if(null===n.index||void 0===n.index)throw Error("Cell index is missing.");for(;t<n.index;)this.csvStr+=this.separator,t++;this.parseCell(n)}},e.prototype.parseCell=function(e){var t=this.csvStr;if(void 0!==e.value)if(e.value instanceof Date)if(void 0!==e.style&&void 0!==e.style.numberFormat)try{t+=this.parseCellValue(this.formatter.displayText(e.value,{type:"dateTime",skeleton:e.style.numberFormat},this.isServerRendered))}catch(r){t+=this.parseCellValue(this.formatter.displayText(e.value,{type:"dateTime",format:e.style.numberFormat},this.isServerRendered))}else if(void 0!==e.style&&void 0!==e.style.name&&this.globalStyles.has(e.style.name))try{t+=this.parseCellValue(this.formatter.displayText(e.value,{type:"dateTime",skeleton:this.globalStyles.get(e.style.name)},this.isServerRendered))}catch(r){t+=this.parseCellValue(this.formatter.displayText(e.value,{type:"dateTime",format:this.globalStyles.get(e.style.name)},this.isServerRendered))}else t+=e.value;else"boolean"==typeof e.value?t+=e.value?"TRUE":"FALSE":"number"==typeof e.value?void 0!==e.style&&void 0!==e.style.numberFormat?t+=this.parseCellValue(this.formatter.displayText(e.value,{format:e.style.numberFormat},this.isServerRendered)):void 0!==e.style&&void 0!==e.style.name&&this.globalStyles.has(e.style.name)?t+=this.parseCellValue(this.formatter.displayText(e.value,{format:this.globalStyles.get(e.style.name)},this.isServerRendered)):t+=e.value:t+=this.parseCellValue(e.value);this.csvStr=t},e.prototype.parseCellValue=function(e){for(var t="",r=e.length,o=0;o<r;o++)'"'===e[o]?t+=e[o].replace('"','""'):t+=e[o];return e=t,-1!==e.indexOf(this.separator)||-1!==e.indexOf("\n")||-1!==e.indexOf('"')?e='"'+e+'"':e},e.prototype.save=function(e){if(this.buffer=new Blob(["\ufeff"+this.csvStr],{type:"text/csv;charset=UTF-8"}),this.isMicrosoftBrowser)navigator.msSaveBlob(this.buffer,e);else{var t=window.URL.createObjectURL(this.buffer),r=document.createElementNS("http://www.w3.org/1999/xhtml","a");r.download=e,r.href=t;var o=document.createEvent("MouseEvent");o.initEvent("click",!0,!0),r.dispatchEvent(o),setTimeout(function(){window.URL.revokeObjectURL(t)})}},e.prototype.saveAsBlob=function(e){if(void 0!=e){var t=new n.Encoding,r="UTF-8";"ANSI"==e.toUpperCase()?(t.type="Ansi",r="ANSI"):"UNICODE"==e.toUpperCase()?(t.type="Unicode",r="UNICODE"):(t.type="Utf8",r="UTF-8");var o=t.getBytes(this.csvStr,0,this.csvStr.length);return new Blob([o],{type:"text/csv;charset="+r})}return new Blob(["\ufeff"+this.csvStr],{type:"text/csv;charset=UTF-8"})},e}())},function(e,t,r){"use strict";r.d(t,"a",function(){return n}),r.d(t,"b",function(){return i});var o=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),n=function(){function e(){}return e}(),i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.add=function(e){t.push(e)},t}return o(t,e),t}(Array)},function(e,t,r){"use strict";r.d(t,"a",function(){return n});var o=r(0),n=(r.n(o),function(){function e(e){this.intl=new o.Internationalization}return e.prototype.getFormatFunction=function(e,t){return e.type?(t&&(e.isServerRendered=!0),this.intl.getDateFormat(e)):this.intl.getNumberFormat(e)},e.prototype.toView=function(e,t){var n=e;return r.i(o.isNullOrUndefined)(t)||r.i(o.isNullOrUndefined)(e)||(n=t(e)),n},e.prototype.displayText=function(e,t,r){return this.toView(e,this.getFormatFunction(t,r))},e}())},function(e,t,r){"use strict";r.d(t,"a",function(){return n}),r.d(t,"b",function(){return i}),r.d(t,"c",function(){return s}),r.d(t,"d",function(){return l}),r.d(t,"e",function(){return a}),r.d(t,"f",function(){return u});var o=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),n=function(){function e(){this.isSummaryRowBelow=!0,this.showGridLines=!0,this.enableRtl=!1}return e}(),i=function(){function e(){}return e}(),s=function(){function e(){}return e}(),l=function(){function e(){}return e}(),a=function(){function e(){}return e}(),u=function(e){function t(){var r=null!==e&&e.apply(this,arguments)||this;return r.add=function(e){for(var o=!1,n=0,i=0,s=r;i<s.length;i++){var l=s[i];if(t.isIntersecting(l,e)){var u=new a;u.x=Math.min(l.x,e.x),u.y=Math.min(l.Y,e.y),u.width=Math.max(l.Width+l.X,e.width+e.x),u.height=Math.max(l.Height+l.Y,e.height+e.y),u.ref=r[n].ref.split(":")[0]+":"+e.ref.split(":")[1],r[n]=u,e=u,o=!0}n++}return o||r.push(e),e},r}return o(t,e),t.isIntersecting=function(e,t){return e.x<=t.x+t.width&&t.x<=e.x+e.width&&e.y<=t.y+t.height&&t.y<=e.y+e.height},t}(Array)},function(e,t,r){"use strict";r.d(t,"a",function(){return n});var o=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t}(Array)},function(e,t,r){"use strict";r.d(t,"a",function(){return f}),r.d(t,"b",function(){return v});var o=r(9),n=r(8),i=r(2),s=r(4),l=r(6),a=r(12),u=r(3),d=r(14),c=(r.n(d),r(5)),h=r(0),p=(r.n(h),r(1)),m=r(11),f=function(){function e(e,t,r,o,n){if(this.sharedStringCount=0,this.unitsProportions=[1.28,.32,96,96/25.4,96/2.54,1,96/72,96/72/12700],this.hyperlinkStyle={fontColor:"#0000FF",underline:!0},this.culture=void 0!==r?r:"en-US",this.currency=void 0!==o?o:"USD",this.intl=new h.Internationalization(this.culture),this.mSaveType=t,"xlsx"===t){if(this.mArchive=new d.ZipArchive,this.sharedString=[],this.mFonts=[],this.mBorders=[],this.mStyles=[],this.printTitles=new Map,this.cellStyles=new Map,this.mNumFmt=new Map,this.mFills=new Map,this.mStyles.push(new i.a),this.mFonts.push(new i.b),this.cellStyles.set("Normal",new i.f),this.mCellXfs=[],this.mCellStyleXfs=[],this.drawingCount=0,this.imageCount=0,null!==e.styles&&void 0!==e.styles){this.globalStyles=new Map;for(var s=0;s<e.styles.length;s++)if(void 0!==e.styles[s].name){if(this.cellStyles.has(e.styles[s].name))throw Error("Style name "+e.styles[s].name+" is already existed");var l=new i.a;l.isGlobalStyle=!0,this.parserCellStyle(e.styles[s],l,"none");var a=new i.f;a.name=l.name,a.xfId=l.index-1,this.cellStyles.set(a.name,a);var u={};void 0!==e.styles[s].numberFormat&&(u.format=e.styles[s].numberFormat),void 0!==e.styles[s].type?u.type=e.styles[s].type:u.type="datetime",void 0!==u.format&&this.globalStyles.set(e.styles[s].name,u)}}if(null===e.worksheets||void 0===e.worksheets)throw Error("Worksheet is expected.");this.parserWorksheets(e.worksheets),null!==e.builtInProperties&&void 0!==e.builtInProperties&&(this.builtInProperties=new v,this.parserBuiltInProperties(e.builtInProperties,this.builtInProperties))}else this.csvHelper=new c.a(e,n)}return e.prototype.parserBuiltInProperties=function(e,t){null!==e.author&&void 0!==e.author&&(t.author=e.author),null!==e.comments&&void 0!==e.comments&&(t.comments=e.comments),null!==e.category&&void 0!==e.category&&(t.category=e.category),null!==e.company&&void 0!==e.company&&(t.company=e.company),null!==e.manager&&void 0!==e.manager&&(t.manager=e.manager),null!==e.subject&&void 0!==e.subject&&(t.subject=e.subject),null!==e.title&&void 0!==e.title&&(t.title=e.title),null!==e.createdDate&&void 0!==e.createdDate&&(t.createdDate=e.createdDate),null!==e.modifiedDate&&void 0!==e.modifiedDate&&(t.modifiedDate=e.modifiedDate),null!==e.tags&&void 0!==e.tags&&(t.tags=e.tags),null!==e.status&&void 0!==e.status&&(t.status=e.status)},e.prototype.parserWorksheets=function(e){this.worksheets=new o.a;for(var t=e.length,r=0;r<t;r++){var i=e[r],s=new n.a;this.mergeCells=new n.f,this.mergedCellsStyle=new Map,this.mHyperLinks=[],null!==i.name&&void 0!==i.name?s.name=i.name:s.name="Sheet"+(r+1).toString(),null!==i.enableRtl&&void 0!==i.enableRtl&&(s.enableRtl=i.enableRtl),s.index=r+1,null!==i.columns&&void 0!==i.columns&&this.parserColumns(i.columns,s),null!==i.rows&&void 0!==i.rows&&this.parserRows(i.rows,s),null!==i.showGridLines&&void 0!==i.showGridLines&&(s.showGridLines=i.showGridLines),null!==i.freeze&&void 0!==i.freeze&&this.parserFreezePanes(i.freeze,s),null!==i.printTitle&&void 0!==i.printTitle&&this.parserPrintTitle(i.printTitle,s),void 0!==i.pageSetup&&void 0!==i.pageSetup.isSummaryRowBelow&&(s.isSummaryRowBelow=i.pageSetup.isSummaryRowBelow),void 0!==i.images&&this.parserImages(i.images,s),null!==i.autoFilters&&void 0!==i.autoFilters&&this.parseFilters(i.autoFilters,s),s.index=r+1,s.mergeCells=this.mergeCells,s.hyperLinks=this.mHyperLinks,this.worksheets.push(s)}},e.prototype.mergeOptions=function(e,t){var r={};return this.applyProperties(e,r),this.applyProperties(t,r),r},e.prototype.applyProperties=function(e,t){for(var r=Object.keys(e),o=0;o<r.length;o++)"name"!==r[o]&&(t[r[o]]=e[r[o]])},e.prototype.getCellName=function(e,t){return this.getColumnName(t)+e.toString()},e.prototype.getColumnName=function(e){e--;var t="";do{var r=e%26;e=e/26-1,t=String.fromCharCode(65+r)+t}while(e>=0);return t},e.prototype.parserPrintTitle=function(e,t){var r,o="";if(null!==e.fromRow&&void 0!==e.fromRow){var n=e.fromRow,i=void 0;i=null!==e.toRow&&void 0!==e.toRow?e.toRow:e.fromRow,r="$"+n+":$"+i}var s;if(null!==e.fromColumn&&void 0!==e.fromColumn){var l=e.fromColumn,a=void 0;a=null!==e.toColumn&&void 0!==e.toColumn?e.toColumn:e.fromColumn,s="$"+this.getColumnName(l)+":$"+this.getColumnName(a)}void 0!==r&&(o+=t.name+"!"+r),void 0!==s&&void 0!==r?o+=","+t.name+"!"+s:void 0!==s&&(o+=t.name+"!"+s),""!==o&&this.printTitles.set(t.index-1,o)},e.prototype.parserFreezePanes=function(e,t){t.freezePanes=new n.d,null!==e.row&&void 0!==e.row?t.freezePanes.row=e.row:t.freezePanes.row=0,null!==e.column&&void 0!==e.column?t.freezePanes.column=e.column:t.freezePanes.column=0,t.freezePanes.leftCell=this.getCellName(t.freezePanes.row+1,t.freezePanes.column+1)},e.prototype.parserColumns=function(e,t){var r=e.length;t.columns=[];for(var o=0;o<r;o++){var n=new s.a;if(null===e[o].index||void 0===e[o].index)throw Error("Column index is missing.");n.index=e[o].index,null!==e[o].width&&void 0!==e[o].width&&(n.width=e[o].width),t.columns.push(n)}},e.prototype.parserRows=function(e,t){var r=e.length;t.rows=new l.b;for(var o=0,n=0;n<r;n++){var i=this.parserRow(e[n],o);o=i.index,t.rows.add(i)}this.insertMergedCellsStyle(t)},e.prototype.insertMergedCellsStyle=function(e){var t=this;this.mergeCells.length>0&&this.mergedCellsStyle.forEach(function(o,n){var i=e.rows.filter(function(e){return e.index===o.y})[0];if(r.i(h.isNullOrUndefined)(i)){var s=e.rows.filter(function(e){return e.index<=o.y}),a=new l.a;a.index=o.y,a.cells=new u.b,a.cells.add(t.createCell(o,n));var d=0;s.length>0&&(d=e.rows.indexOf(s[s.length-1])+1),e.rows.splice(d,0,a)}else{var c=i.cells.filter(function(e){return e.index===o.x})[0];if(r.i(h.isNullOrUndefined)(c)){var p=i.cells.filter(function(e){return e.index<=o.x}),d=0;p.length>0&&(d=i.cells.indexOf(p[p.length-1])+1),i.cells.splice(d,0,t.createCell(o,n))}else c.styleIndex=o.styleIndex}})},e.prototype.createCell=function(e,t){var r=new u.a;return r.refName=t,r.index=e.x,r.cellStyle=new i.a,r.styleIndex=e.styleIndex,r},e.prototype.parserRow=function(e,t){var r=new l.a;if(null!==e.height&&void 0!==e.height&&(r.height=e.height),null===e.index||void 0===e.index)throw Error("Row index is missing.");return r.index=e.index,null!==e.grouping&&void 0!==e.grouping&&this.parseGrouping(e.grouping,r),this.parseCells(e.cells,r),r},e.prototype.parseGrouping=function(e,t){t.grouping=new n.c,void 0!==e.outlineLevel&&(t.grouping.outlineLevel=e.outlineLevel),void 0!==e.isCollapsed&&(t.grouping.isCollapsed=e.isCollapsed),void 0!==e.isHidden&&(t.grouping.isHidden=e.isHidden)},e.prototype.parseCells=function(e,t){t.cells=new u.b;for(var r=void 0!==e?e.length:0,o=1,s=1,l=0;l<r;l++){var a=e[l],d=new u.a;if(null===a.index||void 0===a.index)throw Error("Cell index is missing.");if(d.index=a.index,d.index<o?o=d.index:d.index>s&&(s=d.index),d.refName=this.getCellName(t.index,d.index),null!==a.rowSpan&&void 0!==a.rowSpan?d.rowSpan=a.rowSpan-1:d.rowSpan=0,null!==a.colSpan&&void 0!==a.colSpan?d.colSpan=a.colSpan-1:d.colSpan=0,null!==a.hyperlink&&void 0!==a.hyperlink){var c=new n.b;void 0!==a.hyperlink.target&&(c.target=a.hyperlink.target,void 0!==a.hyperlink.displayText?d.value=a.hyperlink.displayText:d.value=a.hyperlink.target,d.type=this.getCellValueType(d.value),c.ref=d.refName,c.rId=this.mHyperLinks.length+1,this.mHyperLinks.push(c),d.cellStyle=new i.a,this.parserCellStyle(void 0!==a.style?this.mergeOptions(a.style,this.hyperlinkStyle):this.hyperlinkStyle,d.cellStyle,"string"),d.styleIndex=d.cellStyle.index)}null!==a.formula&&void 0!==a.formula&&(d.formula=a.formula,d.type="formula"),null!==a.value&&void 0!==a.value&&(void 0!==d.formula?d.value=0:(d.value=a.value,d.type=this.getCellValueType(d.value))),null!==a.style&&void 0!==a.style&&void 0===d.styleIndex?(d.cellStyle=new i.a,d.value instanceof Date?this.parserCellStyle(a.style,d.cellStyle,d.type,14):this.parserCellStyle(a.style,d.cellStyle,d.type),d.styleIndex=d.cellStyle.index):d.value instanceof Date&&(d.cellStyle=new i.a,this.parserCellStyle({},d.cellStyle,d.type,14),d.styleIndex=d.cellStyle.index),this.parseCellType(d),this.mergeCells=this.processMergeCells(d,t.index,this.mergeCells),t.cells.add(d),d.index+1}t.spans=o+":"+s},e.prototype.GetColors=function(){var e;return e=new Map,e.set("WHITE","FFFFFFFF"),e.set("SILVER","FFC0C0C0"),e.set("GRAY","FF808080"),e.set("BLACK","FF000000"),e.set("RED","FFFF0000"),e.set("MAROON","FF800000"),e.set("YELLOW","FFFFFF00"),e.set("OLIVE","FF808000"),e.set("LIME","FF00FF00"),e.set("GREEN","FF008000"),e.set("AQUA","FF00FFFF"),e.set("TEAL","FF008080"),e.set("BLUE","FF0000FF"),e.set("NAVY","FF000080"),e.set("FUCHSIA","FFFF00FF"),e.set("PURPLE","FF800080"),e},e.prototype.processColor=function(e){return 0===e.indexOf("#")?e.replace("#","FF"):(e=e.toUpperCase(),this.rgbColors=this.GetColors(),e=this.rgbColors.has(e)?this.rgbColors.get(e):"FF000000")},e.prototype.processCellValue=function(e,t){var r=e;if(-1!==e.indexOf("<font")||-1!==e.indexOf("<a")||-1!==e.indexOf("<b>")||-1!==e.indexOf("<i>")||-1!==e.indexOf("<u>")){var o="",i=e.indexOf("<",0),s=e.indexOf(">",i+1);if(i>=0&&s>=0){for(0!==i&&(o+='<r><t xml:space="preserve">'+this.processString(e.substring(0,i))+"</t></r>");i>=0&&s>=0;)if((s=e.indexOf(">",i+1))>=0){var l=e.substring(i+1,s);i=e.indexOf("<",s+1),i<0&&(i=r.length);var a=r.substring(s+1,i);if(0!==a.length){var u=l.split(" ");if(u.length>0&&(o+="<r><rPr>"),u.length>1)for(var d=0,c=u;d<c.length;d++){var h=c[d],p=h.trim().substring(0,5);switch(p){case"size=":o+='<sz val="'+h.substring(6,h.length-1)+'"/>';break;case"face=":o+='<rFont val="'+h.substring(6,h.length-1)+'"/>';break;case"color":o+='<color rgb="'+this.processColor(h.substring(7,h.length-1))+'"/>';break;case"href=":var m=new n.b;m.target=h.substring(6,h.length-1).trim(),m.ref=t.refName,m.rId=this.mHyperLinks.length+1,this.mHyperLinks.push(m),o+='<color rgb="FF0000FF"/><u/><b/>'}}else if(1===u.length){var f=u[0].trim();switch(f){case"b":o+="<b/>";break;case"i":o+="<i/>";break;case"u":o+="<u/>"}}o+='</rPr><t xml:space="preserve">'+this.processString(a)+"</t></r>"}}return""===o?r:o}return r}return r},e.prototype.applyGlobalStyle=function(e,t){this.cellStyles.has(e.name)&&(t.index=this.mStyles.filter(function(t){return t.name===e.name})[0].index,t.name=e.name)},e.prototype.parserCellStyle=function(e,t,r,o){if(null!==e.name&&void 0!==e.name){if(!t.isGlobalStyle)return void this.applyGlobalStyle(e,t);t.name=e.name}null!==e.backColor&&void 0!==e.backColor&&(t.backColor=e.backColor),t.borders=new i.i,null!==e.borders&&void 0!==e.borders&&this.parserBorder(e.borders,t.borders.all),null!==e.leftBorder&&void 0!==e.leftBorder&&this.parserBorder(e.leftBorder,t.borders.left),null!==e.rightBorder&&void 0!==e.rightBorder&&this.parserBorder(e.rightBorder,t.borders.right),null!==e.topBorder&&void 0!==e.topBorder&&this.parserBorder(e.topBorder,t.borders.top),null!==e.bottomBorder&&void 0!==e.bottomBorder&&this.parserBorder(e.bottomBorder,t.borders.bottom),null!==e.fontName&&void 0!==e.fontName&&(t.fontName=e.fontName),null!==e.fontSize&&void 0!==e.fontSize&&(t.fontSize=e.fontSize),null!==e.fontColor&&void 0!==e.fontColor&&(t.fontColor=e.fontColor),null!==e.italic&&void 0!==e.italic&&(t.italic=e.italic),null!==e.bold&&void 0!==e.bold&&(t.bold=e.bold),null!==e.hAlign&&void 0!==e.hAlign&&(t.hAlign=e.hAlign.toLowerCase()),null!==e.indent&&void 0!==e.indent&&(t.indent=e.indent,"left"!==t.hAlign&&"right"!==t.hAlign&&(t.hAlign="left")),null!==e.rotation&&void 0!==e.rotation&&(t.rotation=e.rotation),null!==e.vAlign&&void 0!==e.vAlign&&(t.vAlign=e.vAlign.toLowerCase()),null!==e.underline&&void 0!==e.underline&&(t.underline=e.underline),null!==e.strikeThrough&&void 0!==e.strikeThrough&&(t.strikeThrough=e.strikeThrough),null!==e.wrapText&&void 0!==e.wrapText&&(t.wrapText=e.wrapText),null!==e.numberFormat&&void 0!==e.numberFormat?null!==e.type&&void 0!==e.type?t.numberFormat=this.getNumberFormat(e.numberFormat,e.type):t.numberFormat=this.getNumberFormat(e.numberFormat,r):void 0!==o?(t.numFmtId=14,t.numberFormat="GENERAL"):t.numberFormat="GENERAL",t.index=this.processCellStyle(t)},e.prototype.switchNumberFormat=function(e,t){var r=this.getNumberFormat(e,t);if(r!==e){var o=this.mNumFmt.get(e);if(void 0!==o&&(o.formatCode=r,this.mNumFmt.has(r))){for(var n=0,i=this.mCellStyleXfs;n<i.length;n++){var s=i[n];s.numFmtId===o.numFmtId&&(s.numFmtId=this.mNumFmt.get(r).numFmtId)}for(var l=0,a=this.mCellXfs;l<a.length;l++){var u=a[l];u.numFmtId===o.numFmtId&&(u.numFmtId=this.mNumFmt.get(r).numFmtId)}}}},e.prototype.changeNumberFormats=function(e){if("string"==typeof e){var t=new RegExp(this.currency,"g");e=e.replace(t,"[$"+this.currency+"]")}else if("object"==typeof e)for(var r=0;r<e.length;r++)e[r]=e[r].replace(this.currency,"[$"+this.currency+"]");return e},e.prototype.getNumberFormat=function(e,t){var r;switch(t){case"number":try{r=this.intl.getNumberPattern({format:e,currency:this.currency,useGrouping:!0},!0),this.currency.length>1&&(r=this.changeNumberFormats(r))}catch(t){r=e}break;case"datetime":try{r=this.intl.getDatePattern({skeleton:e,type:"dateTime"},!0)}catch(t){try{r=this.intl.getDatePattern({format:e,type:"dateTime"},!0)}catch(t){r=e}}break;case"date":try{r=this.intl.getDatePattern({skeleton:e,type:"date"},!0)}catch(t){try{r=this.intl.getDatePattern({format:e,type:"date"},!0)}catch(t){r=e}}break;case"time":try{r=this.intl.getDatePattern({skeleton:e,type:"time"},!0)}catch(t){try{r=this.intl.getDatePattern({format:e,type:"time"},!0)}catch(t){r=e}}break;default:r=e}return r},e.prototype.parserBorder=function(e,t){null!==e.color&&void 0!==e.color?t.color=e.color:t.color="#000000",null!==e.lineStyle&&void 0!==e.lineStyle?t.lineStyle=e.lineStyle:t.lineStyle="thin"},e.prototype.processCellStyle=function(e){if(e.isGlobalStyle)return this.processNumFormatId(e),this.mStyles.push(e),this.mStyles.length;var t=this.compareStyle(e);return t.result?t.index:(this.processNumFormatId(e),this.mStyles.push(e),this.mStyles.length)},e.prototype.processNumFormatId=function(e){if("GENERAL"!==e.numberFormat&&!this.mNumFmt.has(e.numberFormat)){var t=this.mNumFmt.size+164;this.mNumFmt.set(e.numberFormat,new i.g(t,e.numberFormat))}},e.prototype.isNewFont=function(e){for(var t=!1,r=0,o=0,n=this.mFonts;o<n.length;o++){var i=n[o];r++;var s=void 0;if(void 0!==e.fontColor&&(s="FF"+e.fontColor.replace("#","")),t=i.color===s&&i.b===e.bold&&i.i===e.italic&&i.u===e.underline&&i.strike===e.strikeThrough&&i.name===e.fontName&&i.sz===e.fontSize)break}return r-=1,{index:r,result:t}},e.prototype.isNewBorder=function(e){var t=new i.a;return this.isAllBorder(e.borders)?t.borders.all.color===e.borders.all.color&&t.borders.all.lineStyle===e.borders.all.lineStyle:t.borders.left.color===e.borders.left.color&&t.borders.left.lineStyle===e.borders.left.lineStyle&&t.borders.right.color===e.borders.right.color&&t.borders.right.lineStyle===e.borders.right.lineStyle&&t.borders.top.color===e.borders.top.color&&t.borders.top.lineStyle===e.borders.top.lineStyle&&t.borders.bottom.color===e.borders.bottom.color&&t.borders.bottom.lineStyle===e.borders.bottom.lineStyle},e.prototype.isAllBorder=function(e){var t=new i.a;return t.borders.all.color!==e.all.color&&t.borders.all.lineStyle!==e.all.lineStyle},e.prototype.compareStyle=function(e){for(var t=!0,r=0,o=0,n=this.mStyles;o<n.length;o++){var i=n[o];if(t=!i.isGlobalStyle&&(i.backColor===e.backColor&&i.bold===e.bold&&i.numFmtId===e.numFmtId&&i.numberFormat===e.numberFormat&&i.type===e.type&&i.fontColor===e.fontColor&&i.fontName===e.fontName&&i.fontSize===e.fontSize&&i.hAlign===e.hAlign&&i.italic===e.italic&&i.underline===e.underline&&i.strikeThrough===e.strikeThrough&&i.vAlign===e.vAlign&&i.indent===e.indent&&i.rotation===e.rotation&&i.wrapText===e.wrapText&&i.borders.all.color===e.borders.all.color&&i.borders.all.lineStyle===e.borders.all.lineStyle&&i.borders.left.color===e.borders.left.color&&i.borders.left.lineStyle===e.borders.left.lineStyle&&i.borders.right.color===e.borders.right.color&&i.borders.right.lineStyle===e.borders.right.lineStyle&&i.borders.top.color===e.borders.top.color&&i.borders.top.lineStyle===e.borders.top.lineStyle&&i.borders.bottom.color===e.borders.bottom.color&&i.borders.bottom.lineStyle===e.borders.bottom.lineStyle)){r=i.index;break}}return{index:r,result:t}},e.prototype.contains=function(e,t){var r=e.indexOf(t);return r>-1&&r<e.length},e.prototype.getCellValueType=function(e){return e instanceof Date?"datetime":"boolean"==typeof e?"boolean":"number"==typeof e?"number":"string"},e.prototype.parseCellType=function(e){var t,r=e.type,o=e.value;switch(r){case"datetime":if(o=this.toOADate(o),void 0!==e.cellStyle&&void 0!==e.cellStyle.name&&this.globalStyles.has(e.cellStyle.name)){var n=this.globalStyles.get(e.cellStyle.name);this.switchNumberFormat(n.format,n.type)}t="n";break;case"boolean":o=o?1:0,t="b";break;case"number":t="n",void 0!==e.cellStyle&&void 0!==e.cellStyle.name&&this.globalStyles.has(e.cellStyle.name)&&this.switchNumberFormat(this.globalStyles.get(e.cellStyle.name).format,"number");break;case"string":this.sharedStringCount++,t="s";var i=this.processCellValue(o,e);this.contains(this.sharedString,i)||this.sharedString.push(i),o=this.sharedString.indexOf(i)}e.saveType=t,e.value=o},e.prototype.parserImages=function(e,t){var r=e.length;t.images=[];for(var o=0;o<r;o++){var n=this.parserImage(e[o]);t.images.push(n)}},e.prototype.parseFilters=function(e,t){if(t.autoFilters=new m.a,null===e.row||void 0===e.row)throw new Error("Argument Null Exception: row null or empty");if(t.autoFilters.row=e.row,null===e.lastRow||void 0===e.lastRow)throw new Error("Argument Null Exception: lastRow cannot be null or empty");if(t.autoFilters.lastRow=e.lastRow,null===e.column||void 0===e.column)throw new Error("Argument Null Exception: column cannot be null or empty");if(t.autoFilters.column=e.column,null===e.lastColumn||void 0===e.row)throw new Error("Argument Null Exception: lastColumn cannot be null or empty");t.autoFilters.lastColumn=e.lastColumn},e.prototype.parserImage=function(e){var t=new a.a;return null!==e.image&&void 0!==e.image&&(t.image=e.image),null!==e.row&&void 0!==e.row&&(t.row=e.row),null!==e.column&&void 0!==e.column&&(t.column=e.column),null!==e.lastRow&&void 0!==e.lastRow&&(t.lastRow=e.lastRow),null!==e.lastColumn&&void 0!==e.lastColumn&&(t.lastColumn=e.lastColumn),null!==e.width&&void 0!==e.width&&(t.width=e.width),null!==e.height&&void 0!==e.height&&(t.height=e.height),null!==e.horizontalFlip&&void 0!==e.horizontalFlip&&(t.horizontalFlip=e.horizontalFlip),null!==e.verticalFlip&&void 0!==e.verticalFlip&&(t.verticalFlip=e.verticalFlip),null!==e.rotation&&void 0!==e.rotation&&(t.rotation=e.rotation),t},e.prototype.saveAsBlob=function(e,t){var r=this;switch(e){case"text/csv":return new Promise(function(e,o){var n={};n.blobData=r.csvHelper.saveAsBlob(t),e(n)});default:return new Promise(function(e,t){r.saveInternal(),r.mArchive.saveAsBlob().then(function(t){var r={};r.blobData=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),e(r)})})}},e.prototype.save=function(e,t){var r=this;if(null===e||void 0===e||""===e)throw new Error("Argument Null Exception: fileName cannot be null or empty");var o=e.match(".xlsx$"),n=e.match(".csv$");if(null!==o&&o[0]==="."+this.mSaveType)this.saveInternal(),this.mArchive.save(e).then(function(){r.mArchive.destroy()});else{if(null===n||n[0]!=="."+this.mSaveType)throw Error("Save type and file extension is different.");this.csvHelper.save(e)}},e.prototype.saveInternal=function(){this.saveWorkbook(),this.saveWorksheets(),this.saveSharedString(),this.saveStyles(),this.saveApp(this.builtInProperties),this.saveCore(this.builtInProperties),this.saveContentType(),this.saveTopLevelRelation(),this.saveWorkbookRelation()},e.prototype.saveWorkbook=function(){for(var e='<?xml version="1.0" encoding="utf-8"?><workbook xmlns:r = "http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns= "http://schemas.openxmlformats.org/spreadsheetml/2006/main"><workbookPr codeName="ThisWorkbook" defaultThemeVersion= "153222"/><bookViews><workbookView activeTab="0"/></bookViews>',t="<sheets>",r=this.worksheets.length,o=0;o<r;o++){var n=this.worksheets[o].name;n=n.replace("&","&amp;"),n=n.replace("<","&lt;"),n=n.replace(">","&gt;"),n=n.replace('"',"&quot;"),t+='<sheet name="'+n+'" sheetId="'+(o+1).toString()+'" r:id ="rId'+(o+1).toString()+'" />'}if(t+="</sheets>",e+=t,this.printTitles.size>0){var i="<definedNames>";this.printTitles.forEach(function(e,t){i+='<definedName name="_xlnm.Print_Titles" localSheetId="'+t+'">'+e+"</definedName>"}),i+="</definedNames>",e+=i}this.addToArchive(e+"</workbook>","xl/workbook.xml")},e.prototype.saveWorksheets=function(){for(var e=this.worksheets.length,t=0;t<e;t++)this.saveWorksheet(this.worksheets[t],t)},e.prototype.saveWorksheet=function(e,t){var o=new p.a,n='<?xml version="1.0" encoding="utf-8" standalone="yes"?><worksheet xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:x14="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">';if(e.isSummaryRowBelow?n+="<sheetPr />":n+='<sheetPr><outlinePr summaryBelow="0" ></outlinePr></sheetPr>',n+=this.saveSheetView(e),void 0!==e.columns){for(var i="<cols>",s=0,l=e.columns;s<l.length;s++){var a=l[s];void 0!==a.width?i+='<col min="'+a.index+'" max="'+a.index+'" width="'+this.pixelsToColumnWidth(a.width)+'" customWidth="1" />':i+='<col min="'+a.index+'" max="'+a.index+'" width="8.43" customWidth="1" />'}n+=i+"</cols>"}if(n+="<sheetData>",o.append(n),n="",void 0!==e.rows)for(var u=0,d=e.rows;u<d.length;u++){var c=d[u],m='<row r="'+c.index+'" ';r.i(h.isNullOrUndefined)(c.spans)||(m+='spans="'+c.spans+'" '),void 0!==c.height&&(m+='ht="'+this.pixelsToRowHeight(c.height)+'" customHeight="1" '),void 0!==c.grouping&&(c.grouping.isHidden&&(m+='hidden="1" '),void 0!==c.grouping.outlineLevel&&(m+='outlineLevel="'+c.grouping.outlineLevel+'" '),c.grouping.isCollapsed&&(m+='collapsed="1" ')),m+=">";for(var f=0,v=c.cells;f<v.length;f++){var g=v[f];void 0===g||void 0===g.value&&void 0===g.cellStyle||(m+='<c r="'+g.refName+'" ',void 0!==g.saveType&&(m+='t="'+g.saveType+'" '),void 0!==g.styleIndex&&(m+='s="'+g.styleIndex+'" '),m+=" >",void 0!==g.formula&&(m+="<f>"+g.formula+"</f>"),void 0!==g.value?m+="<v>"+g.value+"</v></c>":m+="</c>")}m+="</row>",o.append(m)}if(n+="</sheetData>",null!==e.autoFilters&&void 0!==e.autoFilters&&(n+='<autoFilter ref="'+this.getCellName(e.autoFilters.row,e.autoFilters.column)+":"+this.getCellName(e.autoFilters.lastRow,e.autoFilters.lastColumn)+'"/>'),e.mergeCells.length>0){n+='<mergeCells count="'+e.mergeCells.length+'">';for(var y=0,x=e.mergeCells;y<x.length;y++){n+='<mergeCell ref="'+x[y].ref+'" />'}n+="</mergeCells>"}if(e.hyperLinks.length>0){n+="<hyperlinks>";for(var w=0,b=e.hyperLinks;w<b.length;w++){var F=b[w];n+='<hyperlink ref="'+F.ref+'" r:id="rId'+F.rId+'" />'}n+="</hyperlinks>"}n+='<pageMargins left="0.75" right="0.75" top="1" bottom="1" header="0.5" footer="0.5" /><headerFooter scaleWithDoc="1" alignWithMargins="0" differentFirst="0" differentOddEven="0" />',void 0!=e.images&&e.images.length>0&&(this.drawingCount++,this.saveDrawings(e,e.index),n+='<drawing r:id="rId'+(e.hyperLinks.length+1)+'"/>'),this.addToArchive(this.saveSheetRelations(e),"xl/worksheets/_rels/sheet"+e.index+".xml.rels"),o.append(n+"</worksheet>"),this.addToArchive(o.getBlob(),"xl/worksheets/sheet"+(t+1)+".xml")},e.prototype.saveDrawings=function(e,t){var r=new p.a,o='<xdr:wsDr xmlns:xdr="http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing" xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main">';if(void 0!==e.images){for(var n=0,i=0,s=e.images;i<s.length;i++){var l=s[i];void 0!==l.height&&void 0!==l.width?(this.updatelastRowOffset(e,l),this.updatelastColumnOffSet(e,l),l.lastRow-=1,l.lastColumn-=1):void 0!==l.lastRow&&void 0!==l.lastColumn&&(l.lastRowOffset=0,l.lastColOffset=0),n++,o+='<xdr:twoCellAnchor editAs="oneCell">',o+="<xdr:from><xdr:col>",o+=l.column-1,o+="</xdr:col><xdr:colOff>",o+=0,o+="</xdr:colOff><xdr:row>",o+=l.row-1,o+="</xdr:row><xdr:rowOff>",o+=0,o+="</xdr:rowOff></xdr:from>",o+="<xdr:to><xdr:col>",o+=l.lastColumn,o+="</xdr:col><xdr:colOff>",o+=l.lastColOffset,o+="</xdr:colOff><xdr:row>",o+=l.lastRow,o+="</xdr:row><xdr:rowOff>",o+=l.lastRowOffset,o+="</xdr:rowOff></xdr:to>",o+="<xdr:pic>",o+="<xdr:nvPicPr>",o+='<xdr:cNvPr id="'+n+'" name="Picture '+n+'"> </xdr:cNvPr>',o+='<xdr:cNvPicPr><a:picLocks noChangeAspect="1"/></xdr:cNvPicPr> </xdr:nvPicPr>',o+="<xdr:blipFill>",o+='<a:blip xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" r:embed="rId'+n+'" cstate="print">',o+="</a:blip><a:stretch><a:fillRect /></a:stretch></xdr:blipFill>",o+="<xdr:spPr>",o+="<a:xfrm",void 0!=l.rotation&&l.rotation<=3600&&l.rotation>=-3600&&(o+=' rot="'+6e4*l.rotation+'"'),void 0!=l.verticalFlip&&0!=l.verticalFlip&&(o+=' flipV="1"'),void 0!=l.horizontalFlip&&0!=l.horizontalFlip&&(o+=' flipH="1"'),o+="/>",o+='<a:prstGeom prst="rect"><a:avLst /></a:prstGeom></xdr:spPr>',o+="</xdr:pic><xdr:clientData /></xdr:twoCellAnchor>";var a=(new p.a,this.convertBase64toImage(l.image));this.imageCount+=1,this.addToArchive(a,"xl/media/image"+this.imageCount+".png")}r.append(o),r.append("</xdr:wsDr>"),this.saveDrawingRelations(e),this.addToArchive(r.getBlob(),"xl/drawings/drawing"+this.drawingCount+".xml")}},e.prototype.updatelastRowOffset=function(e,t){for(var r=t.height,o=t.row,n=0;r>=0;){var i=0;i=void 0!==e.rows&&void 0!==e.rows[o-1]?this.convertToPixels(void 0===e.rows[o-1].height?15:e.rows[o-1].height):this.convertToPixels(15);var s=i-n*i/256;if(s>r){t.lastRow=o,t.lastRowOffset=n+256*r/i;var l=0;l=void 0!==e.rows&&void 0!==e.rows[o-1]?this.convertToPixels(void 0===e.rows[o-1].height?15:e.rows[o-1].height):this.convertToPixels(15),t.lastRowOffset=l*t.lastRowOffset/256,t.lastRowOffset=Math.round(t.lastRowOffset/this.unitsProportions[7]);break}r-=s,o++,n=0}},e.prototype.updatelastColumnOffSet=function(e,t){for(var r=t.width,o=t.column,n=0;r>=0;){var i=0;i=void 0!==e.columns&&void 0!==e.columns[o-1]?this.ColumnWidthToPixels(void 0===e.columns[o-1].width?8.43:e.columns[o-1].width):this.ColumnWidthToPixels(8.43);var s=i-n*i/1024;if(s>r){t.lastColumn=o,t.lastColOffset=n+1024*r/i;var l=0;l=void 0!==e.columns&&void 0!==e.columns[o-1]?this.ColumnWidthToPixels(void 0===e.columns[o-1].width?8.43:e.columns[o-1].width):this.ColumnWidthToPixels(8.43),t.lastColOffset=l*t.lastColOffset/1024,t.lastColOffset=Math.round(t.lastColOffset/this.unitsProportions[7]);break}r-=s,o++,n=0}},e.prototype.convertToPixels=function(e){return e*this.unitsProportions[6]},e.prototype.convertBase64toImage=function(e){for(var t=window.atob(e),r=new ArrayBuffer(t.length),o=new Uint8Array(r),n=0;n<t.length;n++)o[n]=t.charCodeAt(n);return new Blob([o],{type:"image/png"})},e.prototype.saveDrawingRelations=function(e){for(var t='<?xml version="1.0" encoding="utf-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">',r=e.images.length,o=this.imageCount-e.images.length,n=1;n<=r;n++)o++,t+='<Relationship Id="rId'+n+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image" Target="../media/image'+o+'.png" />';this.addToArchive(t+"</Relationships>","xl/drawings/_rels/drawing"+this.drawingCount+".xml.rels")},e.prototype.pixelsToColumnWidth=function(e){var t=e>12?this.trunc((e-5)/7*100+.5)/100:e/12;return t>1?(7*t+5)/7*256/256:12*t/7*256/256},e.prototype.ColumnWidthToPixels=function(e){var t=e>1?(7*e+5)/7*256/256:12*e/7*256/256;return this.trunc((256*t+this.trunc(128/7))/256*7)},e.prototype.trunc=function(e){var t=e-e%1;return 0===t&&(e<0||0===e&&1/e!=1/0)?-0:t},e.prototype.pixelsToRowHeight=function(e){return e*this.unitsProportions[5]/this.unitsProportions[6]},e.prototype.saveSheetRelations=function(e){for(var t='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">',r=0,o=e.hyperLinks;r<o.length;r++){var n=o[r];t+='<Relationship Id="rId'+n.rId+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink" Target="'+this.processString(n.target)+'" TargetMode="External" />'}return void 0!=e.images&&e.images.length>0&&(t+='<Relationship Id="rId'+(e.hyperLinks.length+1)+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing" Target="../drawings/drawing'+this.drawingCount+'.xml" />'),t+="</Relationships>"},e.prototype.saveSheetView=function(e){var t='<sheetViews><sheetView workbookViewId="0" ';return!0===e.enableRtl&&(t+='rightToLeft="1"'),!1===e.showGridLines?t+='showGridLines="0" >':t+=">",void 0!==e.freezePanes&&(t+='<pane state="frozen" topLeftCell="'+e.freezePanes.leftCell+'" ',0!==e.freezePanes.row&&(t+='ySplit="'+e.freezePanes.row+'" '),0!==e.freezePanes.column&&(t+='xSplit="'+e.freezePanes.column+'" '),t+="/>"),t+="</sheetView></sheetViews > "},e.prototype.saveSharedString=function(){var e=this.sharedString.length;if(e>0){for(var t='<?xml version="1.0" encoding="utf-8"?><sst uniqueCount="'+e+'" count="'+this.sharedStringCount+'" xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">',r="",o=0;o<e;o++)0!==this.sharedString[o].indexOf("<r>")?(r+="<si><t>",r+=this.processString(this.sharedString[o]),r+="</t></si>"):(r+="<si>",r+=this.sharedString[o],r+="</si>");r+="</sst>",this.addToArchive(t+r,"xl/sharedStrings.xml")}},e.prototype.processString=function(e){if("string"==typeof e)-1!==e.indexOf("&")&&(e=e.replace(/&/g,"&amp;")),-1!==e.indexOf("<")&&(e=e.replace(/</g,"&lt;")),-1!==e.indexOf(">")&&(e=e.replace(/>/g,"&gt;")),-1!==e.indexOf("\v")&&(e=e.replace(/\v/g,"_x000B_"));else if("object"==typeof e)for(var t=0;t<e.length;t++)-1!==e[t].indexOf("&")&&(e[t]=e[t].replace(/&/g,"&amp;")),-1!==e[t].indexOf("<")&&(e[t]=e[t].replace(/</g,"&lt;")),-1!==e[t].indexOf(">")&&(e[t]=e[t].replace(/>/g,"&gt;")),-1!==e[t].indexOf("\v")&&(e[t]=e[t].replace(/\v/g,"_x000B_"));return e},e.prototype.saveStyles=function(){this.updateCellXfsStyleXfs();var e='<?xml version="1.0" encoding="utf-8"?><styleSheet xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac" xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">';e+=this.saveNumberFormats(),e+=this.saveFonts(),e+=this.saveFills(),e+=this.saveBorders(),e+=this.saveCellStyleXfs(),e+=this.saveCellXfs(),e+=this.saveCellStyles(),this.addToArchive(e+"</styleSheet>","xl/styles.xml")},e.prototype.updateCellXfsStyleXfs=function(){for(var e=0,t=this.mStyles;e<t.length;e++){var r=t[e],o=void 0;r.isGlobalStyle?(o=new i.e,o.xfId=r.index-1):(o=new i.c,o.xfId=0);var n=this.isNewFont(r);if(n.result)o.fontId=n.index;else{var s=new i.b;s.b=r.bold,s.i=r.italic,s.name=r.fontName,s.sz=r.fontSize,s.u=r.underline,s.strike=r.strikeThrough,s.color="FF"+r.fontColor.replace("#",""),this.mFonts.push(s),o.fontId=this.mFonts.length-1}if("none"!==r.backColor){var l="FF"+r.backColor.replace("#","");if(this.mFills.has(l)){var a=this.mFills.get(l);o.fillId=a}else{var a=this.mFills.size+2;this.mFills.set(l,a),o.fillId=a}}else o.fillId=0;if(this.isNewBorder(r)?o.borderId=0:(this.mBorders.push(r.borders),o.borderId=this.mBorders.length),"GENERAL"!==r.numberFormat)if(this.mNumFmt.has(r.numberFormat)){var u=this.mNumFmt.get(r.numberFormat);o.numFmtId=u.numFmtId}else{var d=this.mNumFmt.size+164;this.mNumFmt.set(r.numberFormat,new i.g(d,r.numberFormat)),o.numFmtId=d}else"GENERAL"===r.numberFormat&&14===r.numFmtId?o.numFmtId=14:o.numFmtId=0;r.isGlobalStyle||(o.applyAlignment=1),o.alignment=new i.d,o.alignment.indent=r.indent,o.alignment.horizontal=r.hAlign,o.alignment.vertical=r.vAlign,o.alignment.wrapText=r.wrapText?1:0,o.alignment.rotation=r.rotation,r.isGlobalStyle?(this.mCellStyleXfs.push(o),this.mCellXfs.push(o)):this.mCellXfs.push(o)}},e.prototype.saveNumberFormats=function(){if(this.mNumFmt.size>=1){var e='<numFmts count="'+this.mNumFmt.size+'">';return this.mNumFmt.forEach(function(t,r){e+='<numFmt numFmtId="'+t.numFmtId+'" formatCode="'+t.formatCode.replace(/"/g,"&quot;")+'" />'}),e+="</numFmts>"}return""},e.prototype.saveFonts=function(){var e='<fonts count="'+this.mFonts.length+'">';if(this.mFonts.length>=1)for(var t=0,r=this.mFonts;t<r.length;t++){var o=r[t];e+="<font>",o.b&&(e+="<b />"),o.i&&(e+="<i />"),o.u&&(e+="<u />"),o.strike&&(e+="<strike />"),e+='<sz val="'+o.sz+'" />',e+='<color rgb="'+o.color+'" />',e+='<name val="'+o.name+'" /></font>'}return e+"</fonts>"},e.prototype.saveFills=function(){var e='<fills count="'+(this.mFills.size+2)+'"><fill><patternFill patternType="none"></patternFill></fill><fill><patternFill patternType="gray125"></patternFill></fill>';return this.mFills.size>=1&&this.mFills.forEach(function(t,r){e+='<fill><patternFill patternType="solid"><fgColor rgb="'+r+'" /><bgColor rgb="FFFFFFFF" /></patternFill></fill>'}),e+"</fills>"},e.prototype.saveBorders=function(){var e='<borders count="'+(this.mBorders.length+1)+'"><border><left /><right /><top /><bottom /><diagonal /></border>';if(this.mBorders.length>=1)for(var t=0,r=this.mBorders;t<r.length;t++){var o=r[t];if(this.isAllBorder(o)){var n=o.all.color.replace("#",""),i=o.all.lineStyle;e+='<border><left style="'+i+'"><color rgb="FF'+n+'" /></left><right style="'+i+'"><color rgb="FF'+n+'" /></right><top style="'+i+'"><color rgb="FF'+n+'" /></top><bottom style="'+i+'"><color rgb="FF'+n+'" /></bottom></border>'}else e+='<border><left style="'+o.left.lineStyle+'"><color rgb="FF'+o.left.color.replace("#","")+'" /></left><right style="'+o.right.lineStyle+'"><color rgb="FF'+o.right.color.replace("#","")+'" /></right><top style="'+o.top.lineStyle+'"><color rgb="FF'+o.top.color.replace("#","")+'" /></top><bottom style="'+o.bottom.lineStyle+'"><color rgb="FF'+o.bottom.color.replace("#","")+'" /></bottom></border>'}return e+"</borders>"},e.prototype.saveCellStyles=function(){var e=this,t='<cellStyles  count="'+this.cellStyles.size+'">';return this.cellStyles.forEach(function(r,o){t+='<cellStyle name="'+o+'" xfId="'+e.cellStyles.get(o).xfId+'"',"Normal"===o&&(t+=' builtinId="0"'),t+=" />"}),t+="</cellStyles>"},e.prototype.saveCellStyleXfs=function(){var e='<cellStyleXfs count="'+(this.mCellStyleXfs.length+1)+'"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" />';if(this.mCellStyleXfs.length>=1)for(var t=0,r=this.mCellStyleXfs;t<r.length;t++){var o=r[t];e+='<xf numFmtId="'+o.numFmtId+'" fontId="'+o.fontId+'" fillId="'+o.fillId+'" borderId="'+o.borderId+'" ',void 0!==o.alignment?e+=">"+this.saveAlignment(o)+"</xf>":e+=" />"}return e+"</cellStyleXfs>"},e.prototype.saveCellXfs=function(){var e='<cellXfs count="'+(this.mCellXfs.length+1)+'"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" xfId="0" />';if(this.mCellXfs.length>=1)for(var t=0,r=this.mCellXfs;t<r.length;t++){var o=r[t];e+='<xf numFmtId="'+o.numFmtId+'" fontId="'+o.fontId+'" fillId="'+o.fillId+'" borderId="'+o.borderId+'" xfId="'+o.xfId+'" ',1===o.applyAlignment&&(e+='applyAlignment="1"'),e+=">"+this.saveAlignment(o)+"</xf>"}return e+"</cellXfs>"},e.prototype.saveAlignment=function(e){var t="<alignment ";return void 0!==e.alignment.horizontal&&(t+='horizontal="'+e.alignment.horizontal+'" '),void 0!==e.alignment.indent&&0!==e.alignment.indent?t+='indent="'+e.alignment.indent+'" ':void 0!==e.alignment.rotation&&0!==e.alignment.rotation&&(t+='textRotation="'+e.alignment.rotation+'" '),void 0!==e.alignment.vertical&&(t+='vertical="'+e.alignment.vertical+'" '),t+='wrapText="'+e.alignment.wrapText+'" />'},e.prototype.saveApp=function(e){var t='<?xml version="1.0" encoding="utf-8" standalone="yes"?><Properties xmlns="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties"><Application>Essential XlsIO</Application>';void 0!==e&&(void 0!==e.manager&&(t+="<Manager>"+e.manager+"</Manager>"),void 0!==e.company&&(t+="<Company>"+e.company+"</Company>")),this.addToArchive(t+"</Properties>","docProps/app.xml")},e.prototype.saveCore=function(e){var t=new Date,r='<?xml version="1.0" encoding="utf-8" standalone="yes"?><cp:coreProperties xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" xmlns:dcmitype="http://purl.org/dc/dcmitype/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:cp="http://schemas.openxmlformats.org/package/2006/metadata/core-properties">';void 0!==this.builtInProperties?(void 0!==e.author&&(r+="<dc:creator>"+e.author+"</dc:creator>"),void 0!==e.subject&&(r+="<dc:subject>"+e.subject+"</dc:subject>"),void 0!==e.category&&(r+="<cp:category>"+e.category+"</cp:category>"),void 0!==e.comments&&(r+="<dc:description>"+e.comments+"</dc:description>"),void 0!==e.title&&(r+="<dc:title>"+e.title+"</dc:title>"),void 0!==e.tags&&(r+="<cp:keywords>"+e.tags+"</cp:keywords>"),void 0!==e.status&&(r+="<cp:contentStatus>"+e.status+"</cp:contentStatus>"),void 0!==e.createdDate?r+='<dcterms:created xsi:type="dcterms:W3CDTF">'+e.createdDate.toISOString()+"</dcterms:created>":r+='<dcterms:created xsi:type="dcterms:W3CDTF">'+t.toISOString()+"</dcterms:created>",void 0!==e.modifiedDate?r+='<dcterms:modified xsi:type="dcterms:W3CDTF">'+e.modifiedDate.toISOString()+"</dcterms:modified>":r+='<dcterms:modified xsi:type="dcterms:W3CDTF">'+t.toISOString()+"</dcterms:modified>"):(r+='<dcterms:created xsi:type="dcterms:W3CDTF">'+t.toISOString()+"</dcterms:created>",r+='<dcterms:modified xsi:type="dcterms:W3CDTF">'+t.toISOString()+"</dcterms:modified>"),r+="</cp:coreProperties>",this.addToArchive(r,"docProps/core.xml")},e.prototype.saveTopLevelRelation=function(){this.addToArchive('<?xml version="1.0" encoding="utf-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml" /><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties" Target="docProps/app.xml" /><Relationship Id="rId3" Type="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties" Target="docProps/core.xml" /></Relationships>',"_rels/.rels")},e.prototype.saveWorkbookRelation=function(){for(var e='<?xml version="1.0" encoding="utf-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">',t=this.worksheets.length,r=0,o=0;o<t;o++,r++)e+='<Relationship Id="rId'+(o+1).toString()+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet'+(o+1).toString()+'.xml" />';e+='<Relationship Id="rId'+(++r).toString()+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml" />',this.sharedStringCount>0&&(e+='<Relationship Id="rId'+(++r).toString()+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings" Target="sharedStrings.xml" />'),this.addToArchive(e+"</Relationships>","xl/_rels/workbook.xml.rels")},e.prototype.saveContentType=function(){for(var e='<?xml version="1.0" encoding="utf-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="xml" ContentType="application/xml" /><Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml" /><Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml" /><Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml" /><Override PartName="/docProps/app.xml" ContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml" /><Override PartName="/docProps/core.xml" ContentType="application/vnd.openxmlformats-package.core-properties+xml" />',t="",r=this.worksheets.length,o=0,n=0;n<r;n++)t+='<Override PartName="/xl/worksheets/sheet'+(n+1).toString()+'.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml" />',void 0!=this.worksheets[n].images&&this.worksheets[n].images.length>0&&(o++,t+='<Override PartName="/xl/drawings/drawing'+o.toString()+'.xml" ContentType="application/vnd.openxmlformats-officedocument.drawing+xml" />');this.imageCount>0&&(t+='<Default Extension="png" ContentType="image/png" />'),this.sharedStringCount>0&&(e+='<Override PartName="/xl/sharedStrings.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml" />'),this.addToArchive(e+t+"</Types>","[Content_Types].xml")},e.prototype.addToArchive=function(e,t){if("string"==typeof e){var r=new Blob([e],{type:"text/plain"}),o=new d.ZipArchiveItem(r,t);this.mArchive.addItem(o)}else{var o=new d.ZipArchiveItem(e,t);this.mArchive.addItem(o)}},e.prototype.processMergeCells=function(e,t,r){if(0!==e.rowSpan||0!==e.colSpan){var o=new n.e;o.x=e.index,o.width=e.colSpan,o.y=t,o.height=e.rowSpan;var i=this.getCellName(o.y,o.x),s=this.getCellName(t+o.height,e.index+o.width);o.ref=i+":"+s;var l=(r.add(o),{x:o.x,y:o.y}),a={x:e.index+o.width,y:t+o.height};this.updatedMergedCellStyles(l,a,e)}return r},e.prototype.updatedMergedCellStyles=function(e,t,r){for(var o=e.x;o<=t.x;o++)for(var n=e.y;n<=t.y;n++)this.mergedCellsStyle.set(this.getCellName(n,o),{x:o,y:n,styleIndex:r.styleIndex})},e.prototype.dateToTicks=function(e,t,r){var o=[0,31,59,90,120,151,181,212,243,273,304,334,365],n=[0,31,60,91,121,152,182,213,244,274,305,335,366];if(e>=1&&e<=9999&&t>=1&&t<=12){var i=this.isLeapYear(e)?n:o,s=e-1;return 864e9*(365*s+(s/4|0)-(s/100|0)+(s/400|0)+i[t-1]+r-1)}throw new Error("Not a valid date")},e.prototype.timeToTicks=function(e,t,r){if(e>=0&&e<24&&t>=0&&t<60&&r>=0&&r<60){return 1e4*(3600*e+60*t+r)*1e3}throw new Error("Not valid time")},e.prototype.isLeapYear=function(e){return e%4==0&&(e%100!=0||e%400==0)},e.prototype.toOADate=function(e){var t=0;if(0===(t=this.dateToTicks(e.getFullYear(),e.getMonth()+1,e.getDate())+this.timeToTicks(e.getHours(),e.getMinutes(),e.getSeconds())))return 0;if(t<31241376e9)throw new Error("Arg_OleAutDateInvalid");return(t-599264352e9)/1e4/864e5},e}(),v=function(){function e(){}return e}()},function(e,t,r){"use strict";r.d(t,"a",function(){return o});var o=function(){function e(){}return e}()},function(e,t,r){"use strict";r.d(t,"a",function(){return o});var o=function(){function e(){}return e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(2);r.d(t,"CellStyle",function(){return o.a}),r.d(t,"Font",function(){return o.b}),r.d(t,"CellXfs",function(){return o.c}),r.d(t,"Alignment",function(){return o.d}),r.d(t,"CellStyleXfs",function(){return o.e}),r.d(t,"CellStyles",function(){return o.f}),r.d(t,"NumFmt",function(){return o.g}),r.d(t,"Border",function(){return o.h}),r.d(t,"Borders",function(){return o.i});var n=r(3);r.d(t,"Cell",function(){return n.a}),r.d(t,"Cells",function(){return n.b});var i=r(4);r.d(t,"Column",function(){return i.a});var s=r(6);r.d(t,"Row",function(){return s.a}),r.d(t,"Rows",function(){return s.b});var l=r(10);r.d(t,"Workbook",function(){return l.a}),r.d(t,"BuiltInProperties",function(){return l.b});var a=r(8);r.d(t,"Worksheet",function(){return a.a}),r.d(t,"HyperLink",function(){return a.b}),r.d(t,"Grouping",function(){return a.c}),r.d(t,"FreezePane",function(){return a.d}),r.d(t,"MergeCell",function(){return a.e}),r.d(t,"MergeCells",function(){return a.f});var u=r(9);r.d(t,"Worksheets",function(){return u.a});var d=r(5);r.d(t,"CsvHelper",function(){return d.a});var c=r(7);r.d(t,"ValueFormatter",function(){return c.a});var h=r(1);r.d(t,"BlobHelper",function(){return h.a})},function(e,r){e.exports=t},function(e,t){e.exports=r}])});