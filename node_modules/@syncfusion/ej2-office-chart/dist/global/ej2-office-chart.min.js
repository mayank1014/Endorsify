/*!
*  filename: ej2-office-chart.min.js
*  version : 24.2.3
*  Copyright Syncfusion Inc. 2001 - 2023. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
this.ej=this.ej||{},this.ej.officechart=function(e,r,t,i){"use strict";r.Chart.Inject(r.AreaSeries,r.StackingAreaSeries,r.BarSeries,r.PieSeries,r.StackingBarSeries,r.PolarSeries,r.ScatterSeries,r.BubbleSeries,r.RadarSeries,r.DateTime,r.ColumnSeries,r.StackingColumnSeries,r.LineSeries,r.StackingLineSeries,r.ErrorBar,r.Trendlines,r.SplineSeries,r.DataLabel,r.Category,r.Legend,r.Tooltip,r.Export),r.AccumulationChart.Inject(r.AccumulationLegend,r.PieSeries,r.AccumulationTooltip,r.AccumulationDataLabel);var a=function(){function e(){this.keywordIndex=void 0}return e.prototype.chartRender=function(e,t){this.keywordIndex=i.isNullOrUndefined(t)?0:t,this.chartType=e[k[this.keywordIndex]],this.isPieType="Pie"===this.chartType||"Doughnut"===this.chartType;var a=this.chartData(e,this.chartType),s={enableAnimation:!1,width:e[n[this.keywordIndex]]*(96/72)+"px",height:e[o[this.keywordIndex]]*(96/72)+"px"};this.isPieType?this.chart=new r.AccumulationChart(s):(this.chart=new r.Chart(s),this.chart.primaryXAxis=this.chartPrimaryXAxis(e[y[this.keywordIndex]],this.chartType),this.chart.primaryYAxis=this.chartPrimaryYAxis(e[p[this.keywordIndex]])),this.chart.series=this.chartSeries(e[h[this.keywordIndex]],a,this.chartType);for(var d=0;d<this.chart.series.length;d++)this.chart.series[parseInt(d.toString(),10)].animation.enable=!1;this.chart.title=e[l[this.keywordIndex]],this.chart.legendSettings=this.parseChartLegend(e[c[this.keywordIndex]])},e.prototype.convertChartToImage=function(e,r,t){var a=this;return new Promise(function(n,o){var s=0,d=0,h=a.getControlsValue([e],r,t);s=s||h.width,d=d||h.height;var c=i.createElement("canvas"),y=Math.max(1,window.devicePixelRatio||1);c.width=s*y,c.height=d*y,c.style.width=s+"px",c.style.height=d+"px";var p=window.URL.createObjectURL(new Blob([(new XMLSerializer).serializeToString(h.svg)],{type:"image/svg+xml"})),l=new Image,k=c.getContext("2d");k.scale(y,y),l.onload=function(){k.drawImage(l,0,0),window.URL.revokeObjectURL(p);var e=c.toDataURL("image/png");n(e)},l.onerror=function(){o("Invalid data")},l.src=p})},e.prototype.getControlsValue=function(e,r,i){var a=0,n=0,o="",s=new t.SvgRenderer("").createSvg({id:"Image_Export",width:200,height:200});return e.map(function(e){if(e){var t=e.svgObject.cloneNode(!0),i=e.renderer.createGroup({style:"transform: translateY("+n+"px)"});i.appendChild(t),a=Math.max(e.availableSize.width,r),n+=e.availableSize.height,o+=e.svgObject.outerHTML,s.appendChild(i)}}),s.setAttribute("width",a+""),s.setAttribute("height",n+""),{width:a,height:n,svg:s}},e.prototype.officeChartType=function(e){var r="";switch(e){case"Area_Stacked":r="StackingArea";break;case"Area":r="Area";break;case"Area_Stacked_100":r="StackingArea100";break;case"Bar_Clustered":r="Bar";break;case"Bar_Stacked":r="StackingBar";break;case"Bar_Stacked_100":r="StackingBar100";break;case"Column_Clustered":r="Column";break;case"Column_Stacked":r="StackingColumn";break;case"Column_Stacked_100":r="StackingColumn100";break;case"Scatter_Markers":r="Scatter";break;case"Bubble":r="Bubble";break;case"Doughnut":case"Pie":r="Pie";break;case"Line_Stacked_100":case"Line_Markers_Stacked_100":r="StackingLine100";break;case"Line":case"Line_Markers":r="Line";break;case"Line_Stacked":case"Line_Markers_Stacked":r="StackingLine"}return r},e.prototype.chartSeries=function(e,r,t){for(var i=[],a=0;a<e.length;a++){var n=e[parseInt(a.toString(),10)],o=this.writeChartSeries(n,r,t,a);i.push(o)}return i},e.prototype.writeChartSeries=function(e,r,t,a){var n,o=this.officeChartType(t),s=e[w[this.keywordIndex]][parseInt(a.toString(),10)],d={};if(d.type=o,d.dataSource=r,d.name=e[x[this.keywordIndex]],d.xName="x",d.yName="y"+a,"Bubble"===t&&(d.size="size"+a),this.isPieType?(d.pointColorMapping="color","Doughnut"===t&&(d.innerRadius="75%",d.radius="70%")):(i.isNullOrUndefined(s)&&(s=e[w[this.keywordIndex]][0]),n=this.chartFormat(s,o),d.fill=n,i.isNullOrUndefined(s[g[this.keywordIndex]][P[this.keywordIndex]])||(d.pointColorMapping="color")),"Line_Markers"!==t&&"Line_Markers_Stacked"!==t&&"Line_Markers_Stacked_100"!==t||(d.marker={visible:!0}),e.hasOwnProperty(m[this.keywordIndex]))if(this.isPieType)d.dataLabel=this.parseDataLabels(e[m[this.keywordIndex]]);else{var h={};h.dataLabel=this.parseDataLabels(e[m[this.keywordIndex]]),d.marker=h}if(e.hasOwnProperty(I[this.keywordIndex])){var c=e[I[this.keywordIndex]];d.errorBar=this.parseErrorBars(c)}if(e.hasOwnProperty(u[this.keywordIndex]))for(var y=e[u[this.keywordIndex]],p=[],l=0;l<y.length;l++){var k=y[parseInt(l.toString(),10)],S={};S=this.parseTrendLines(k,n),p.push(S),d.trendlines=p}return d},e.prototype.parseDataLabels=function(e){var r={};return r.visible=!0,this.isPieType?"BestFit"===e[v[this.keywordIndex]]||"Inside"===e[v[this.keywordIndex]]?r.position="Inside":r.position="Outside":r.position=this.dataLabelPosition(e[v[this.keywordIndex]]),r},e.prototype.parseErrorBars=function(e){var r={};return r.visible=!0,r.type=e[L[this.keywordIndex]],r.direction=e[T[this.keywordIndex]],"Cap"===e[A[this.keywordIndex]]?r.errorBarCap={width:1}:r.errorBarCap={width:0},r},e.prototype.parseTrendLines=function(e,r){var t={};return t.type=e[L[this.keywordIndex]],t.name=e[C[this.keywordIndex]],t.forwardForecast=e[B[this.keywordIndex]],t.backwardForecast=e[_[this.keywordIndex]],"NaN"===e[j[this.keywordIndex]]?t.intercept=0:t.intercept=e[j[this.keywordIndex]],t.fill=r,t},e.prototype.dataLabelPosition=function(e){var r="Auto";switch(e){case"Outside":r="Outer";break;case"Center":r="Middle";break;case"Inside":r="Top";break;case"OutsideBase":r="Bottom"}return r},e.prototype.chartFormat=function(e,r){var t=e;return"Line"===r||"StackingLine"===r||"StackingLine100"===r?t[S[this.keywordIndex]][f[this.keywordIndex]]:t[g[this.keywordIndex]][f[this.keywordIndex]]},e.prototype.chartPrimaryXAxis=function(e,r){var t={};e[l[this.keywordIndex]]&&(t.title=e[l[this.keywordIndex]]);var i=this.chartCategoryType(e[D[this.keywordIndex]]);return t.valueType=i,"DateTime"===i&&(t.intervalType="Days",t.labelFormat="M/d/yyyy",t.edgeLabelPlacement="Shift"),"Scatter_Markers"!==r&&"Bubble"!==r||this.checkAndSetAxisValue(t,e),this.parseBoolValue(e[M[this.keywordIndex]])&&(t.majorGridLines={width:1}),this.parseBoolValue(e[N[this.keywordIndex]])&&(t.minorTicksPerInterval=4),t},e.prototype.chartCategoryType=function(e){var r="";switch(e){case"Time":r="DateTime";break;case"Automatic":r="Category"}return r},e.prototype.chartPrimaryYAxis=function(e){var r={};return e[l[this.keywordIndex]]&&(r.title=e[l[this.keywordIndex]]),this.checkAndSetAxisValue(r,e),e[M[this.keywordIndex]]&&(r.majorGridLines={width:1}),e[N[this.keywordIndex]]&&(r.minorTicksPerInterval=4),r},e.prototype.checkAndSetAxisValue=function(e,r){0!==r[U[this.keywordIndex]]&&(e.minimum=r[U[this.keywordIndex]]),0!==r[V[this.keywordIndex]]&&(e.maximum=r[V[this.keywordIndex]]),0!==r[O[this.keywordIndex]]&&(e.interval=r[O[this.keywordIndex]])},e.prototype.chartData=function(e,r){for(var t=e[d[this.keywordIndex]],i=[],a=0;a<t.length;a++){var n=t[parseInt(a.toString(),10)],o=this.chartPlotData(n,e,r,a);i.push(o)}return i},e.prototype.chartPlotData=function(e,r,t,a){var n=this,o={},d=r[h[this.keywordIndex]];if("m/d/yyyy"===r[y[this.keywordIndex]][z[this.keywordIndex]]){var c=e[F[this.keywordIndex]].split("/"),p=Number(c[0]),l=Number(c[1]),u=Number(c[2]);o.x=new Date(u,p-1,l)}else o.x=e[F[this.keywordIndex]];for(var x=0;x<d.length;x++){var m=e[s[this.keywordIndex]][parseInt(x.toString(),10)];if(o["y"+x]=m[R[this.keywordIndex]],"Bubble"===t&&(o["size"+x]=m[G[this.keywordIndex]]),"Pie"===r[k[this.keywordIndex]]||"Doughnut"===r[k[this.keywordIndex]]||"Column_Stacked"===r[k[this.keywordIndex]]){var I=d[parseInt(x.toString(),10)],S=I[w[this.keywordIndex]].find(function(e){return e[b[n.keywordIndex]]===a});i.isNullOrUndefined(S)?I[w[this.keywordIndex]].length>1&&0===I[w[this.keywordIndex]][parseInt(a.toString(),10)][b[this.keywordIndex]]?(S=I[w[this.keywordIndex]][parseInt(a.toString(),10)],o.color=this.chartFormat(S,t)):i.isNullOrUndefined(I[E[this.keywordIndex]])||i.isNullOrUndefined(I[E[this.keywordIndex]][g[this.keywordIndex]])||I[E[this.keywordIndex]][g[this.keywordIndex]][f[this.keywordIndex]].length>7&&(o.color=this.getColor(I[E[this.keywordIndex]][g[this.keywordIndex]][f[this.keywordIndex]])):o.color=this.chartFormat(S,t)}}return o},e.prototype.getColor=function(e){return e.length>0&&"#"===e[0]&&e.length>7?e.substr(0,7):e},e.prototype.parseChartLegend=function(e){var r={},t=e[v[this.keywordIndex]];return"Corner"===t&&(t="right"),t?(r.visible=!0,r.position=t.charAt(0).toUpperCase()+t.slice(1)):r.visible=!1,r},e.prototype.parseBoolValue=function(e){return e instanceof String?!i.isNullOrUndefined(e)&&"f"!=e&&"0"!=e&&"off"!=e&&"false"!=e:1==e},e.prototype.destroy=function(){this.chart&&this.chart.destroy(),this.chart=void 0},e}(),n=["width","w"],o=["height","h"],s=["chartData","chd"],d=["chartCategory","c"],h=["chartSeries","cs"],c=["chartLegend","cl"],y=["chartPrimaryCategoryAxis","cpca"],p=["chartPrimaryValueAxis","cpva"],l=["chartTitle","ctt"],k=["chartType","ct"],u=["trendLines","tl"],w=["dataPoints","dp"],x=["seriesName","sn"],m=["dataLabel","sl"],I=["errorBar","eb"],g=["fill","f"],S=["line","l"],f=["rgb","rgb"],b=["id","i"],P=["foreColor","fc"],v=["position","p"],L=["type","t"],C=["name","n"],T=["direction","dir"],A=["endStyle","est"],B=["forward","fw"],_=["backward","bw"],j=["intercept","itr"],D=["categoryType","ct"],M=["hasMajorGridLines","hmajgl"],N=["hasMinorGridLines","hmingl"],O=["majorUnit","maju"],V=["maximumValue","maxv"],U=["minimumValue","minv"],F=["categoryXName","cx"],z=["numberFormat","nf"],R=["yValue","y"],G=["size","sz"],E=["seriesFormat","sf"];return e.ChartComponent=a,e.widthProperty=n,e.heightProperty=o,e.chartDataProperty=s,e.chartCategoryProperty=d,e.chartSeriesProperty=h,e.chartLegendProperty=c,e.chartPrimaryCategoryAxisProperty=y,e.chartPrimaryValueAxisProperty=p,e.chartTitleProperty=l,e.chartTypeProperty=k,e.trendLinesProperty=u,e.dataPointsProperty=w,e.seriesNameProperty=x,e.dataLabelProperty=m,e.errorBarProperty=I,e.fillProperty=g,e.lineProperty=S,e.rgbProperty=f,e.idProperty=b,e.foreColorProperty=P,e.positionProperty=v,e.typeProperty=L,e.nameProperty=C,e.directionProperty=T,e.endStyleProperty=A,e.forwardProperty=B,e.backwardProperty=_,e.interceptProperty=j,e.categoryTypeProperty=D,e.hasMajorGridLinesProperty=M,e.hasMinorGridLinesProperty=N,e.majorUnitProperty=O,e.maximumValueProperty=V,e.minimumValueProperty=U,e.categoryXNameProperty=F,e.numberFormatProperty=z,e.yValueProperty=R,e.sizeProperty=G,e.seriesFormatProperty=E,e}({},ej.charts,ej.svgbase,ej.base),this.ejs=ej;
//# sourceMappingURL=ej2-office-chart.min.js.map
