/*!
*  filename: ej2-documenteditor.min.js
*  version : 24.2.9
*  Copyright Syncfusion Inc. 2001 - 2023. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("SyncfusionBase"),require("SyncfusionButtons"),require("SyncfusionInputs"),require("SyncfusionPopups"),require("SyncfusionDropdowns"),require("SyncfusionNavigations"),require("SyncfusionLists"),require("SyncfusionSplitbuttons"),require("SyncfusionCompression"),require("SyncfusionData"),require("SyncfusionFileUtils"),require("SyncfusionCalendars"),require("SyncfusionOfficeChart")):"function"==typeof define&&define.amd?define(["SyncfusionBase","SyncfusionButtons","SyncfusionInputs","SyncfusionPopups","SyncfusionDropdowns","SyncfusionNavigations","SyncfusionLists","SyncfusionSplitbuttons","SyncfusionCompression","SyncfusionData","SyncfusionFileUtils","SyncfusionCalendars","SyncfusionOfficeChart"],t):"object"==typeof exports?exports.SyncfusionDocumenteditor=t(require("SyncfusionBase"),require("SyncfusionButtons"),require("SyncfusionInputs"),require("SyncfusionPopups"),require("SyncfusionDropdowns"),require("SyncfusionNavigations"),require("SyncfusionLists"),require("SyncfusionSplitbuttons"),require("SyncfusionCompression"),require("SyncfusionData"),require("SyncfusionFileUtils"),require("SyncfusionCalendars"),require("SyncfusionOfficeChart")):e.SyncfusionDocumenteditor=t(e.SyncfusionBase,e.SyncfusionButtons,e.SyncfusionInputs,e.SyncfusionPopups,e.SyncfusionDropdowns,e.SyncfusionNavigations,e.SyncfusionLists,e.SyncfusionSplitbuttons,e.SyncfusionCompression,e.SyncfusionData,e.SyncfusionFileUtils,e.SyncfusionCalendars,e.SyncfusionOfficeChart)}(this,function(e,t,i,n,r,o,s,a,l,d,h,c,p){return function(e){function t(n){if(i[n])return i[n].exports;var r=i[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var i={};return t.m=e,t.c=i,t.i=function(e){return e},t.d=function(e,i,n){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=42)}([function(t,i){t.exports=e},function(e,t,i){"use strict";var n=i(11);i.d(t,"i",function(){return n.o}),i.d(t,"j",function(){return n.z}),i.d(t,"k",function(){return n.A}),i.d(t,"l",function(){return n.B}),i.d(t,"m",function(){return n.C}),i.d(t,"n",function(){return n.D}),i.d(t,"o",function(){return n.g}),i.d(t,"p",function(){return n.E}),i.d(t,"q",function(){return n.F}),i.d(t,"r",function(){return n.l}),i.d(t,"s",function(){return n.G}),i.d(t,"t",function(){return n.H}),i.d(t,"u",function(){return n.I}),i.d(t,"v",function(){return n.J}),i.d(t,"w",function(){return n.K}),i.d(t,"x",function(){return n.L}),i.d(t,"y",function(){return n.M}),i.d(t,"z",function(){return n.c}),i.d(t,"A",function(){return n.b}),i.d(t,"B",function(){return n.N}),i.d(t,"C",function(){return n.O}),i.d(t,"D",function(){return n.P}),i.d(t,"E",function(){return n.Q}),i.d(t,"F",function(){return n.p}),i.d(t,"G",function(){return n.h}),i.d(t,"H",function(){return n.i}),i.d(t,"I",function(){return n.k}),i.d(t,"J",function(){return n.j}),i.d(t,"K",function(){return n.a}),i.d(t,"L",function(){return n.e}),i.d(t,"M",function(){return n.n}),i.d(t,"N",function(){return n.m}),i.d(t,"O",function(){return n.r}),i.d(t,"P",function(){return n.w}),i.d(t,"Q",function(){return n.d}),i.d(t,"R",function(){return n.x}),i.d(t,"S",function(){return n.y}),i.d(t,"T",function(){return n.R}),i.d(t,"U",function(){return n.q}),i.d(t,"V",function(){return n.s}),i.d(t,"W",function(){return n.S}),i.d(t,"X",function(){return n.v}),i.d(t,"Y",function(){return n.T}),i.d(t,"Z",function(){return n.U}),i.d(t,"_0",function(){return n.V}),i.d(t,"_1",function(){return n.W}),i.d(t,"_2",function(){return n.X}),i.d(t,"_3",function(){return n.Y}),i.d(t,"_4",function(){return n.Z}),i.d(t,"_5",function(){return n._0}),i.d(t,"_6",function(){return n._1}),i.d(t,"_7",function(){return n._2}),i.d(t,"_8",function(){return n._3}),i.d(t,"_9",function(){return n._4}),i.d(t,"_10",function(){return n._5}),i.d(t,"_11",function(){return n._6}),i.d(t,"_12",function(){return n._7}),i.d(t,"_13",function(){return n._8}),i.d(t,"_14",function(){return n._9}),i.d(t,"_15",function(){return n._10}),i.d(t,"_16",function(){return n._11}),i.d(t,"_17",function(){return n._12}),i.d(t,"_18",function(){return n._13}),i.d(t,"_19",function(){return n._14}),i.d(t,"_20",function(){return n._15}),i.d(t,"_21",function(){return n._16}),i.d(t,"_22",function(){return n._17}),i.d(t,"_23",function(){return n._18}),i.d(t,"_24",function(){return n._19}),i.d(t,"_25",function(){return n._20}),i.d(t,"_26",function(){return n._21}),i.d(t,"_27",function(){return n._22}),i.d(t,"_28",function(){return n._23}),i.d(t,"_29",function(){return n._24}),i.d(t,"_30",function(){return n._25}),i.d(t,"_31",function(){return n._26}),i.d(t,"_32",function(){return n._27}),i.d(t,"_33",function(){return n._28}),i.d(t,"_34",function(){return n._29}),i.d(t,"_35",function(){return n._30}),i.d(t,"_36",function(){return n._31}),i.d(t,"_37",function(){return n._32}),i.d(t,"_38",function(){return n._33}),i.d(t,"_39",function(){return n._34}),i.d(t,"_40",function(){return n._35}),i.d(t,"_41",function(){return n._36}),i.d(t,"_42",function(){return n._37}),i.d(t,"_43",function(){return n._38}),i.d(t,"_44",function(){return n._39}),i.d(t,"_45",function(){return n._40}),i.d(t,"_46",function(){return n._41}),i.d(t,"_47",function(){return n._42}),i.d(t,"_48",function(){return n._43}),i.d(t,"_49",function(){return n._44}),i.d(t,"_50",function(){return n._45}),i.d(t,"_51",function(){return n._46}),i.d(t,"_52",function(){return n._47}),i.d(t,"_53",function(){return n._48}),i.d(t,"_54",function(){return n._49}),i.d(t,"_55",function(){return n._50}),i.d(t,"_56",function(){return n._51}),i.d(t,"_57",function(){return n._52}),i.d(t,"_58",function(){return n._53}),i.d(t,"_59",function(){return n._54}),i.d(t,"_60",function(){return n._55}),i.d(t,"_61",function(){return n._56}),i.d(t,"_62",function(){return n._57}),i.d(t,"_63",function(){return n._58}),i.d(t,"_64",function(){return n._59}),i.d(t,"_65",function(){return n._60}),i.d(t,"_66",function(){return n._61}),i.d(t,"_67",function(){return n._62}),i.d(t,"_68",function(){return n._63}),i.d(t,"_69",function(){return n._64}),i.d(t,"_70",function(){return n._65}),i.d(t,"_71",function(){return n._66}),i.d(t,"_72",function(){return n._67}),i.d(t,"_73",function(){return n._68}),i.d(t,"_74",function(){return n._69}),i.d(t,"_75",function(){return n._70}),i.d(t,"_76",function(){return n._71}),i.d(t,"_77",function(){return n._72}),i.d(t,"_78",function(){return n._73}),i.d(t,"_79",function(){return n._74}),i.d(t,"_80",function(){return n._75}),i.d(t,"_81",function(){return n._76}),i.d(t,"_82",function(){return n._77}),i.d(t,"_83",function(){return n._78}),i.d(t,"_84",function(){return n._79}),i.d(t,"_85",function(){return n._80}),i.d(t,"_86",function(){return n._81}),i.d(t,"_87",function(){return n._82}),i.d(t,"_88",function(){return n._83}),i.d(t,"_89",function(){return n._84}),i.d(t,"_90",function(){return n._85}),i.d(t,"_91",function(){return n._86}),i.d(t,"_92",function(){return n._87}),i.d(t,"_93",function(){return n._88}),i.d(t,"_94",function(){return n._89}),i.d(t,"_95",function(){return n._90}),i.d(t,"_96",function(){return n._91}),i.d(t,"_97",function(){return n._92}),i.d(t,"_98",function(){return n._93}),i.d(t,"_99",function(){return n._94}),i.d(t,"_100",function(){return n._95}),i.d(t,"_101",function(){return n._96}),i.d(t,"_102",function(){return n._97}),i.d(t,"_103",function(){return n._98}),i.d(t,"_104",function(){return n._99}),i.d(t,"_105",function(){return n._100}),i.d(t,"_106",function(){return n._101}),i.d(t,"_107",function(){return n._102}),i.d(t,"_108",function(){return n._103}),i.d(t,"_109",function(){return n._104}),i.d(t,"_110",function(){return n._105}),i.d(t,"_111",function(){return n._106}),i.d(t,"_112",function(){return n._107}),i.d(t,"_113",function(){return n._108}),i.d(t,"_114",function(){return n._109}),i.d(t,"_115",function(){return n._110}),i.d(t,"_116",function(){return n._111}),i.d(t,"_117",function(){return n._112}),i.d(t,"_118",function(){return n._113}),i.d(t,"_119",function(){return n._114}),i.d(t,"_120",function(){return n._115}),i.d(t,"_121",function(){return n._116}),i.d(t,"_122",function(){return n._117}),i.d(t,"_123",function(){return n._118}),i.d(t,"_124",function(){return n._119}),i.d(t,"_125",function(){return n._120}),i.d(t,"_126",function(){return n._121}),i.d(t,"_127",function(){return n._122}),i.d(t,"_128",function(){return n._123}),i.d(t,"_129",function(){return n._124}),i.d(t,"_130",function(){return n._125}),i.d(t,"_131",function(){return n._126}),i.d(t,"_132",function(){return n._127}),i.d(t,"_133",function(){return n._128}),i.d(t,"_134",function(){return n._129}),i.d(t,"_135",function(){return n._130}),i.d(t,"_136",function(){return n._131}),i.d(t,"_137",function(){return n._132}),i.d(t,"_138",function(){return n._133}),i.d(t,"_139",function(){return n._134}),i.d(t,"_140",function(){return n._135}),i.d(t,"_141",function(){return n._136}),i.d(t,"_142",function(){return n._137}),i.d(t,"_143",function(){return n._138}),i.d(t,"_144",function(){return n._139}),i.d(t,"_145",function(){return n._140}),i.d(t,"_146",function(){return n._141}),i.d(t,"_147",function(){return n._142}),i.d(t,"_148",function(){return n._143}),i.d(t,"_149",function(){return n._144}),i.d(t,"_150",function(){return n._145}),i.d(t,"_151",function(){return n._146}),i.d(t,"_152",function(){return n._147}),i.d(t,"_153",function(){return n._148}),i.d(t,"_154",function(){return n._149}),i.d(t,"_155",function(){return n._150});i.d(t,"_156",function(){return n._151}),i.d(t,"_157",function(){return n._152}),i.d(t,"_158",function(){return n._153}),i.d(t,"_159",function(){return n._154}),i.d(t,"_160",function(){return n._155}),i.d(t,"_161",function(){return n._156}),i.d(t,"_162",function(){return n._157}),i.d(t,"_163",function(){return n._158}),i.d(t,"_164",function(){return n._159}),i.d(t,"_165",function(){return n._160}),i.d(t,"_166",function(){return n._161}),i.d(t,"_167",function(){return n._162}),i.d(t,"_168",function(){return n._163}),i.d(t,"_169",function(){return n._164}),i.d(t,"_170",function(){return n._165}),i.d(t,"_171",function(){return n._166}),i.d(t,"_172",function(){return n._167}),i.d(t,"_173",function(){return n._168}),i.d(t,"_174",function(){return n._169}),i.d(t,"_175",function(){return n._170}),i.d(t,"_176",function(){return n._171}),i.d(t,"_177",function(){return n._172}),i.d(t,"_178",function(){return n._173}),i.d(t,"_179",function(){return n._174}),i.d(t,"_180",function(){return n._175}),i.d(t,"_181",function(){return n._176}),i.d(t,"_182",function(){return n._177}),i.d(t,"_183",function(){return n._178}),i.d(t,"_184",function(){return n._179}),i.d(t,"_185",function(){return n._180}),i.d(t,"_186",function(){return n._181}),i.d(t,"_187",function(){return n._182}),i.d(t,"_188",function(){return n._183}),i.d(t,"_189",function(){return n._184}),i.d(t,"_190",function(){return n._185}),i.d(t,"_191",function(){return n._186}),i.d(t,"_192",function(){return n._187}),i.d(t,"_193",function(){return n._188}),i.d(t,"_194",function(){return n._189}),i.d(t,"_195",function(){return n._190}),i.d(t,"_196",function(){return n._191}),i.d(t,"_197",function(){return n._192}),i.d(t,"_198",function(){return n._193}),i.d(t,"_199",function(){return n._194}),i.d(t,"_200",function(){return n._195}),i.d(t,"_201",function(){return n._196}),i.d(t,"_202",function(){return n._197}),i.d(t,"_203",function(){return n._198}),i.d(t,"_204",function(){return n._199}),i.d(t,"_205",function(){return n._200}),i.d(t,"_206",function(){return n._201}),i.d(t,"_207",function(){return n._202}),i.d(t,"_208",function(){return n._203}),i.d(t,"_209",function(){return n._204}),i.d(t,"_210",function(){return n._205}),i.d(t,"_211",function(){return n._206}),i.d(t,"_212",function(){return n._207}),i.d(t,"_213",function(){return n._208}),i.d(t,"_214",function(){return n._209}),i.d(t,"_215",function(){return n._210}),i.d(t,"_216",function(){return n._211}),i.d(t,"_217",function(){return n._212}),i.d(t,"_218",function(){return n._213}),i.d(t,"_219",function(){return n._214}),i.d(t,"_220",function(){return n._215}),i.d(t,"_221",function(){return n._216}),i.d(t,"_222",function(){return n._217}),i.d(t,"_223",function(){return n._218}),i.d(t,"_224",function(){return n._219}),i.d(t,"_225",function(){return n._220}),i.d(t,"_226",function(){return n._221}),i.d(t,"_227",function(){return n._222}),i.d(t,"_228",function(){return n._223}),i.d(t,"_229",function(){return n._224}),i.d(t,"_230",function(){return n._225}),i.d(t,"_231",function(){return n._226}),i.d(t,"_232",function(){return n._227}),i.d(t,"_233",function(){return n._228}),i.d(t,"_234",function(){return n._229}),i.d(t,"_235",function(){return n._230}),i.d(t,"_236",function(){return n._231}),i.d(t,"_237",function(){return n._232}),i.d(t,"_238",function(){return n._233}),i.d(t,"_239",function(){return n._234}),i.d(t,"_240",function(){return n._235}),i.d(t,"_241",function(){return n._236}),i.d(t,"_242",function(){return n._237}),i.d(t,"_243",function(){return n._238}),i.d(t,"_244",function(){return n._239}),i.d(t,"_245",function(){return n._240}),i.d(t,"_246",function(){return n._241}),i.d(t,"_247",function(){return n._242}),i.d(t,"_248",function(){return n._243}),i.d(t,"_249",function(){return n._244}),i.d(t,"_250",function(){return n._245}),i.d(t,"_251",function(){return n._246}),i.d(t,"_252",function(){return n._247}),i.d(t,"_253",function(){return n._248}),i.d(t,"_254",function(){return n._249}),i.d(t,"_255",function(){return n._250}),i.d(t,"_256",function(){return n._251}),i.d(t,"_257",function(){return n._252}),i.d(t,"_258",function(){return n._253}),i.d(t,"_259",function(){return n._254}),i.d(t,"_260",function(){return n._255}),i.d(t,"_261",function(){return n._256}),i.d(t,"_262",function(){return n._257}),i.d(t,"_263",function(){return n._258}),i.d(t,"_264",function(){return n._259}),i.d(t,"_265",function(){return n._260}),i.d(t,"_266",function(){return n._261}),i.d(t,"_267",function(){return n._262}),i.d(t,"_268",function(){return n._263}),i.d(t,"_269",function(){return n._264}),i.d(t,"_270",function(){return n._265}),i.d(t,"_271",function(){return n._266}),i.d(t,"_272",function(){return n._267}),i.d(t,"_273",function(){return n._268}),i.d(t,"_274",function(){return n._269}),i.d(t,"_275",function(){return n._270}),i.d(t,"_276",function(){return n._271}),i.d(t,"_277",function(){return n._272}),i.d(t,"_278",function(){return n._273}),i.d(t,"_279",function(){return n._274}),i.d(t,"_280",function(){return n._275}),i.d(t,"_281",function(){return n._276}),i.d(t,"_282",function(){return n._277}),i.d(t,"_283",function(){return n._278}),i.d(t,"_284",function(){return n._279}),i.d(t,"_285",function(){return n._280}),i.d(t,"_286",function(){return n._281}),i.d(t,"_287",function(){return n._282}),i.d(t,"_288",function(){return n._283}),i.d(t,"_289",function(){return n._284}),i.d(t,"_290",function(){return n._285}),i.d(t,"_291",function(){return n._286}),i.d(t,"_292",function(){return n._287}),i.d(t,"_293",function(){return n._288}),i.d(t,"_294",function(){return n._289}),i.d(t,"_295",function(){return n._290}),i.d(t,"_296",function(){return n._291}),i.d(t,"_297",function(){return n._292}),i.d(t,"_298",function(){return n._293}),i.d(t,"_299",function(){return n._294}),i.d(t,"_300",function(){return n._295}),i.d(t,"_301",function(){return n._296}),i.d(t,"_302",function(){return n._297}),i.d(t,"_303",function(){return n._298}),i.d(t,"_304",function(){return n._299}),i.d(t,"_305",function(){return n._300}),i.d(t,"_306",function(){return n._301}),i.d(t,"_307",function(){return n._302}),i.d(t,"_308",function(){return n._303}),i.d(t,"_309",function(){return n._304}),i.d(t,"_310",function(){return n._305}),i.d(t,"_311",function(){return n._306}),i.d(t,"_312",function(){return n._307}),i.d(t,"_313",function(){return n._308}),i.d(t,"_314",function(){return n._309}),i.d(t,"_315",function(){return n._310}),i.d(t,"_316",function(){return n._311}),i.d(t,"_317",function(){return n._312}),i.d(t,"_318",function(){return n._313}),i.d(t,"_319",function(){return n._314}),i.d(t,"_320",function(){return n._315}),i.d(t,"_321",function(){return n._316}),i.d(t,"_322",function(){return n._317}),i.d(t,"_323",function(){return n._318}),i.d(t,"_324",function(){return n._319}),i.d(t,"_325",function(){return n._320}),i.d(t,"_326",function(){return n._321}),i.d(t,"_327",function(){return n._322}),i.d(t,"_328",function(){return n._323}),i.d(t,"_329",function(){return n.t}),i.d(t,"_330",function(){return n._324}),i.d(t,"_331",function(){return n._325}),i.d(t,"_332",function(){return n._326}),i.d(t,"_333",function(){return n._327}),i.d(t,"_334",function(){return n._328}),i.d(t,"_335",function(){return n._329}),i.d(t,"_336",function(){return n._330}),i.d(t,"_337",function(){return n._331}),i.d(t,"_338",function(){return n._332}),i.d(t,"_339",function(){return n._333}),i.d(t,"_340",function(){return n._334}),i.d(t,"_341",function(){return n._335}),i.d(t,"_342",function(){return n._336}),i.d(t,"_343",function(){return n._337}),i.d(t,"_344",function(){return n._338}),i.d(t,"_345",function(){return n._339}),i.d(t,"_346",function(){return n._340}),i.d(t,"_347",function(){return n._341}),i.d(t,"_348",function(){return n._342}),i.d(t,"_349",function(){return n._343}),i.d(t,"_350",function(){return n._344}),i.d(t,"_351",function(){return n._345}),i.d(t,"_352",function(){return n._346}),i.d(t,"_353",function(){return n._347}),i.d(t,"_354",function(){return n._348}),i.d(t,"_355",function(){return n._349});i.d(t,"_356",function(){return n._350}),i.d(t,"_357",function(){return n._351}),i.d(t,"_358",function(){return n._352}),i.d(t,"_359",function(){return n._353}),i.d(t,"_360",function(){return n._354}),i.d(t,"_361",function(){return n._355}),i.d(t,"_362",function(){return n._356}),i.d(t,"_363",function(){return n._357}),i.d(t,"_364",function(){return n._358}),i.d(t,"_365",function(){return n._359}),i.d(t,"_366",function(){return n._360}),i.d(t,"_367",function(){return n._361}),i.d(t,"_368",function(){return n._362}),i.d(t,"_369",function(){return n._363}),i.d(t,"_370",function(){return n._364}),i.d(t,"_371",function(){return n._365}),i.d(t,"_372",function(){return n._366}),i.d(t,"_373",function(){return n._367}),i.d(t,"_374",function(){return n._368}),i.d(t,"_375",function(){return n._369}),i.d(t,"_376",function(){return n._370}),i.d(t,"_377",function(){return n.u}),i.d(t,"_378",function(){return n._371}),i.d(t,"_379",function(){return n._372}),i.d(t,"_380",function(){return n._373}),i.d(t,"_381",function(){return n._374}),i.d(t,"_382",function(){return n._375}),i.d(t,"_383",function(){return n._376}),i.d(t,"_384",function(){return n.f});var r=i(7);i.d(t,"_385",function(){return r.Q}),i.d(t,"_386",function(){return r.R}),i.d(t,"_387",function(){return r.e}),i.d(t,"_388",function(){return r.S}),i.d(t,"_389",function(){return r.T}),i.d(t,"_390",function(){return r.U}),i.d(t,"_391",function(){return r.V}),i.d(t,"_392",function(){return r.W}),i.d(t,"_393",function(){return r.X}),i.d(t,"_394",function(){return r.Y}),i.d(t,"_395",function(){return r.Z}),i.d(t,"_396",function(){return r._0}),i.d(t,"_397",function(){return r._1}),i.d(t,"_398",function(){return r._2}),i.d(t,"_399",function(){return r._3}),i.d(t,"_400",function(){return r._4}),i.d(t,"_401",function(){return r._5}),i.d(t,"_402",function(){return r._6}),i.d(t,"_403",function(){return r._7}),i.d(t,"_404",function(){return r._8}),i.d(t,"_405",function(){return r._9}),i.d(t,"_406",function(){return r.a}),i.d(t,"_407",function(){return r._10}),i.d(t,"_408",function(){return r._11}),i.d(t,"_409",function(){return r._12}),i.d(t,"_410",function(){return r._13}),i.d(t,"_411",function(){return r._14}),i.d(t,"_412",function(){return r._15}),i.d(t,"_413",function(){return r._16}),i.d(t,"_414",function(){return r._17}),i.d(t,"_415",function(){return r._18}),i.d(t,"_416",function(){return r._19}),i.d(t,"_417",function(){return r.h}),i.d(t,"_418",function(){return r.l}),i.d(t,"_419",function(){return r._20}),i.d(t,"_420",function(){return r._21}),i.d(t,"_421",function(){return r._22}),i.d(t,"_422",function(){return r._23}),i.d(t,"_423",function(){return r._24}),i.d(t,"_424",function(){return r.k}),i.d(t,"_425",function(){return r._25}),i.d(t,"_426",function(){return r._26}),i.d(t,"_427",function(){return r._27}),i.d(t,"_428",function(){return r._28}),i.d(t,"_429",function(){return r._29}),i.d(t,"_430",function(){return r._30}),i.d(t,"_431",function(){return r._31}),i.d(t,"_432",function(){return r._32}),i.d(t,"_433",function(){return r.G}),i.d(t,"_434",function(){return r.O}),i.d(t,"_435",function(){return r._33}),i.d(t,"_436",function(){return r.E}),i.d(t,"_437",function(){return r._34}),i.d(t,"_438",function(){return r._35}),i.d(t,"_439",function(){return r.g}),i.d(t,"_440",function(){return r.K}),i.d(t,"_441",function(){return r.N}),i.d(t,"_442",function(){return r.F}),i.d(t,"_443",function(){return r.M}),i.d(t,"_444",function(){return r.f}),i.d(t,"_445",function(){return r.H}),i.d(t,"_446",function(){return r.J}),i.d(t,"_447",function(){return r.I}),i.d(t,"_448",function(){return r._36}),i.d(t,"_449",function(){return r._37}),i.d(t,"_450",function(){return r._38}),i.d(t,"_451",function(){return r._39}),i.d(t,"_452",function(){return r._40}),i.d(t,"_453",function(){return r._41}),i.d(t,"_454",function(){return r._42}),i.d(t,"_455",function(){return r._43}),i.d(t,"_456",function(){return r._44}),i.d(t,"_457",function(){return r._45}),i.d(t,"_458",function(){return r._46}),i.d(t,"_459",function(){return r._47}),i.d(t,"_460",function(){return r._48}),i.d(t,"_461",function(){return r._49}),i.d(t,"_462",function(){return r.P}),i.d(t,"_463",function(){return r._50}),i.d(t,"_464",function(){return r.L}),i.d(t,"_465",function(){return r._51}),i.d(t,"_466",function(){return r._52}),i.d(t,"_467",function(){return r._53}),i.d(t,"_468",function(){return r._54}),i.d(t,"_469",function(){return r._55}),i.d(t,"_470",function(){return r._56}),i.d(t,"_471",function(){return r._57}),i.d(t,"_472",function(){return r._58}),i.d(t,"_473",function(){return r._59}),i.d(t,"_474",function(){return r._60}),i.d(t,"_475",function(){return r.i}),i.d(t,"_476",function(){return r._61}),i.d(t,"_477",function(){return r._62}),i.d(t,"_478",function(){return r.j}),i.d(t,"_479",function(){return r._63}),i.d(t,"_480",function(){return r._64}),i.d(t,"_481",function(){return r._65}),i.d(t,"_482",function(){return r._66}),i.d(t,"_483",function(){return r._67}),i.d(t,"_484",function(){return r._68}),i.d(t,"_485",function(){return r._69}),i.d(t,"_486",function(){return r._70}),i.d(t,"_487",function(){return r._71}),i.d(t,"_488",function(){return r.D}),i.d(t,"_489",function(){return r.C}),i.d(t,"_490",function(){return r._72}),i.d(t,"_491",function(){return r._73}),i.d(t,"_492",function(){return r._74}),i.d(t,"_493",function(){return r._75}),i.d(t,"_494",function(){return r.q}),i.d(t,"_495",function(){return r.n}),i.d(t,"_496",function(){return r.s}),i.d(t,"_497",function(){return r._76}),i.d(t,"_498",function(){return r._77}),i.d(t,"_499",function(){return r._78}),i.d(t,"_500",function(){return r.A}),i.d(t,"_501",function(){return r._79}),i.d(t,"_502",function(){return r.r}),i.d(t,"_503",function(){return r.o}),i.d(t,"_504",function(){return r.u}),i.d(t,"_505",function(){return r.p}),i.d(t,"_506",function(){return r.z}),i.d(t,"_507",function(){return r.m}),i.d(t,"_508",function(){return r._80}),i.d(t,"_509",function(){return r.b}),i.d(t,"_510",function(){return r.c}),i.d(t,"_511",function(){return r.d}),i.d(t,"_512",function(){return r.w}),i.d(t,"_513",function(){return r._81}),i.d(t,"_514",function(){return r._82}),i.d(t,"_515",function(){return r._83}),i.d(t,"_516",function(){return r._84}),i.d(t,"_517",function(){return r._85}),i.d(t,"_518",function(){return r.t}),i.d(t,"_519",function(){return r._86}),i.d(t,"_520",function(){return r._87}),i.d(t,"_521",function(){return r._88}),i.d(t,"_522",function(){return r._89}),i.d(t,"_523",function(){return r._90}),i.d(t,"_524",function(){return r._91}),i.d(t,"_525",function(){return r._92}),i.d(t,"_526",function(){return r._93}),i.d(t,"_527",function(){return r._94}),i.d(t,"_528",function(){return r._95}),i.d(t,"_529",function(){return r._96}),i.d(t,"_530",function(){return r._97}),i.d(t,"_531",function(){return r.v}),i.d(t,"_532",function(){return r.y}),i.d(t,"_533",function(){return r._98}),i.d(t,"_534",function(){return r._99}),i.d(t,"_535",function(){return r._100}),i.d(t,"_536",function(){return r._101}),i.d(t,"_537",function(){return r._102}),i.d(t,"_538",function(){return r._103}),i.d(t,"_539",function(){return r._104}),i.d(t,"_540",function(){return r._105}),i.d(t,"_541",function(){return r._106}),i.d(t,"_542",function(){return r._107}),i.d(t,"_543",function(){return r._108}),i.d(t,"_544",function(){return r._109}),i.d(t,"_545",function(){return r._110}),i.d(t,"_546",function(){return r._111}),i.d(t,"_547",function(){return r._112}),i.d(t,"_548",function(){return r._113}),i.d(t,"_549",function(){return r._114}),i.d(t,"_550",function(){return r._115}),i.d(t,"_551",function(){return r.x}),i.d(t,"_552",function(){return r._116}),i.d(t,"_553",function(){return r._117}),i.d(t,"_554",function(){return r._118}),i.d(t,"_555",function(){return r._119}),i.d(t,"_556",function(){return r._120}),i.d(t,"_557",function(){return r._121}),i.d(t,"_558",function(){return r._122}),i.d(t,"_559",function(){return r._123}),i.d(t,"_560",function(){return r._124}),i.d(t,"_561",function(){return r._125}),i.d(t,"_562",function(){return r._126}),i.d(t,"_563",function(){return r._127}),i.d(t,"_564",function(){return r._128}),i.d(t,"_565",function(){return r._129}),i.d(t,"_566",function(){return r._130}),i.d(t,"_567",function(){return r._131}),i.d(t,"_568",function(){return r._132}),i.d(t,"_569",function(){return r._133}),i.d(t,"_570",function(){return r.B}),i.d(t,"_571",function(){return r._134}),i.d(t,"_572",function(){return r._135}),i.d(t,"_573",function(){return r._136});var o=i(46);i.d(t,"a",function(){return o.b}),i.d(t,"b",function(){return o.c}),i.d(t,"c",function(){return o.d}),i.d(t,"d",function(){return o.a}),i.d(t,"e",function(){return o.e}),i.d(t,"f",function(){return o.f}),i.d(t,"g",function(){return o.g}),i.d(t,"h",function(){return o.h})},function(e,t,i){"use strict";i.d(t,"t",function(){return c}),i.d(t,"y",function(){return p}),i.d(t,"E",function(){return u}),i.d(t,"w",function(){return g}),i.d(t,"h",function(){return f}),i.d(t,"o",function(){return m}),i.d(t,"x",function(){return v}),i.d(t,"C",function(){return y}),i.d(t,"a",function(){return w}),i.d(t,"g",function(){return b}),i.d(t,"O",function(){return x}),i.d(t,"u",function(){return C}),i.d(t,"z",function(){return I}),i.d(t,"j",function(){return F}),i.d(t,"p",function(){return k}),i.d(t,"c",function(){return P}),i.d(t,"b",function(){return T}),i.d(t,"_3",function(){return S}),i.d(t,"l",function(){return W}),i.d(t,"m",function(){return N}),i.d(t,"n",function(){return H}),i.d(t,"d",function(){return E}),i.d(t,"k",function(){return O}),i.d(t,"f",function(){return _}),i.d(t,"_2",function(){return B}),i.d(t,"D",function(){return L}),i.d(t,"I",function(){return R}),i.d(t,"e",function(){return A}),i.d(t,"H",function(){return D}),i.d(t,"N",function(){return U}),i.d(t,"Q",function(){return M}),i.d(t,"P",function(){return V}),i.d(t,"R",function(){return z}),i.d(t,"S",function(){return j}),i.d(t,"_4",function(){return q}),i.d(t,"v",function(){return G}),i.d(t,"s",function(){return K}),i.d(t,"i",function(){return Z}),i.d(t,"T",function(){return X}),i.d(t,"U",function(){return J}),i.d(t,"r",function(){return Y}),i.d(t,"q",function(){return Q}),i.d(t,"F",function(){return $}),i.d(t,"G",function(){return ee}),i.d(t,"J",function(){return te}),i.d(t,"_5",function(){return ie}),i.d(t,"V",function(){return ne}),i.d(t,"W",function(){return re}),i.d(t,"_6",function(){return oe}),i.d(t,"X",function(){return se}),i.d(t,"_7",function(){return ae}),i.d(t,"Y",function(){return le}),i.d(t,"Z",function(){return de}),i.d(t,"_1",function(){return he}),i.d(t,"_8",function(){return ce}),i.d(t,"_0",function(){return pe}),i.d(t,"_9",function(){return ue}),i.d(t,"_10",function(){return ge}),i.d(t,"_11",function(){return fe}),i.d(t,"_12",function(){return me}),i.d(t,"B",function(){return ve}),i.d(t,"M",function(){return ye}),i.d(t,"A",function(){return we}),i.d(t,"L",function(){return be}),i.d(t,"_13",function(){return xe}),i.d(t,"_14",function(){return Ce}),i.d(t,"_15",function(){return Ie}),i.d(t,"K",function(){return Fe}),i.d(t,"_16",function(){return ke});var n=i(9),r=i(16),o=i(0),s=(i.n(o),i(6)),a=i(4),l=i(32),d=i(25),h=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),c=function(){function e(e,t,i,n){this.x=e,this.y=t,this.width=i,this.height=n}return Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),e.prototype.isIntersecting=function(e){return!(e.y>this.bottom||this.y>e.bottom||e.x>this.right||this.x>e.right)},e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height)},e}(),p=function(){function e(e,t,i,n){this.right=10,this.left=10,this.top=10,this.bottom=10,this.right=e,this.left=t,this.top=i,this.bottom=n}return e}(),u=function(){function e(e,t,i,n){this.left=e,this.top=t,this.right=i,this.bottom=n}return e.prototype.clone=function(){return new e(this.left,this.top,this.right,this.bottom)},e.prototype.destroy=function(){this.left=void 0,this.right=void 0,this.top=void 0,this.bottom=void 0},e}(),g=function(){function e(){this.childWidgets=[],this.x=0,this.y=0,this.width=0,this.height=0,this.index=0}return Object.defineProperty(e.prototype,"indexInOwner",{get:function(){return this instanceof m&&this.page?this.containerWidget instanceof w?this.containerWidget.bodyWidgets.indexOf(this):this.page.bodyWidgets.indexOf(this):this.containerWidget&&this.containerWidget.childWidgets?this.containerWidget.childWidgets.indexOf(this):this instanceof w?0:-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstChild",{get:function(){return this.childWidgets.length>0?this.childWidgets[0]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lastChild",{get:function(){if(this.childWidgets)return this.childWidgets.length>0?this.childWidgets[this.childWidgets.length-1]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousWidget",{get:function(){var e=this,t=this.indexInOwner;return e=e instanceof m?t>0?e.page.bodyWidgets[t-1]:void 0:t>0?e.containerWidget.childWidgets[t-1]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextWidget",{get:function(){var e=this,t=this.indexInOwner;if(-1!==t)return e=e instanceof m?t<e.page.bodyWidgets.length-1?e.page.bodyWidgets[t+1]:void 0:t<e.containerWidget.childWidgets.length-1?e.containerWidget.childWidgets[t+1]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousRenderedWidget",{get:function(){var e=this,t=this.indexInOwner;if(!(t<0)){if(e instanceof m)if(t>0&&!(e.containerWidget instanceof w))e=e.page.bodyWidgets[t-1];else if(e.containerWidget instanceof w&&!e.page.documentHelper.owner.editor.removeEditRange){if(t<=0)return;e=e.containerWidget.bodyWidgets[t-1]}else{var n=e.page.previousPage;e=n&&n.bodyWidgets.length>0?n.bodyWidgets[n.bodyWidgets.length-1]:void 0}else if(e instanceof w)for(var n=e.page;n.previousPage&&(n=n.previousPage,e=n.footnoteWidget,i.i(o.isNullOrUndefined)(e)););else if(t>0)e=e.containerWidget.childWidgets[t-1];else{var r=void 0;for(e.containerWidget instanceof F?r=e.containerWidget.getPreviousSplitWidget():e.containerWidget&&e.containerWidget.containerWidget instanceof w&&"Endnote"===e.containerWidget.containerWidget.footNoteType?r=e.containerWidget.previousWidget?e.containerWidget.previousWidget:e.containerWidget.previousRenderedWidget:e.containerWidget instanceof I||e.containerWidget instanceof v||e.containerWidget&&e.containerWidget.containerWidget instanceof w||(r=e.containerWidget.previousRenderedWidget);r&&0===r.childWidgets.length&&(r=r.previousRenderedWidget,!i.i(o.isNullOrUndefined)(r)););e=r&&r.constructor===e.containerWidget.constructor?r.lastChild:void 0}return e}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextRenderedWidget",{get:function(){var e=this,t=this.indexInOwner;if(!(t<0)){if(e instanceof m)if(t<e.page.bodyWidgets.length-1&&!(e.containerWidget instanceof w))e=e.page.bodyWidgets[t+1];else if(e.containerWidget instanceof w){if(t>=e.containerWidget.bodyWidgets.length-1&&!e.page.documentHelper.owner.editor.removeEditRange)return;e=e.containerWidget.bodyWidgets[t+1]}else if(e.page.allowNextPageRendering){var n=e.page.nextPage;e=n&&n.bodyWidgets.length>0?n.bodyWidgets[0]:void 0}else e=void 0;else if(e instanceof w)for(var n=e.page;n.allowNextPageRendering&&n.nextPage&&(n=n.nextPage,e=n.footnoteWidget,i.i(o.isNullOrUndefined)(e)););else if(t<e.containerWidget.childWidgets.length-1)e=e.containerWidget.childWidgets[t+1];else{var r=void 0;for(e.containerWidget instanceof F?r=e.containerWidget.getNextSplitWidget():e.containerWidget&&e.containerWidget.containerWidget instanceof w&&"Endnote"===e.containerWidget.containerWidget.footNoteType?r=e.containerWidget.nextWidget?e.containerWidget.nextWidget:e.containerWidget.nextRenderedWidget:e.containerWidget instanceof I||e.containerWidget instanceof v||e.containerWidget&&e.containerWidget.containerWidget instanceof w||(r=e.containerWidget.nextRenderedWidget);r&&0===r.childWidgets.length&&!(r instanceof F)&&(r=r.nextRenderedWidget,!i.i(o.isNullOrUndefined)(r)););e=r&&r.constructor===e.containerWidget.constructor?r.firstChild:void 0}return e}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousSplitWidget",{get:function(){var e=this;if(e instanceof F)return e.getPreviousSplitWidget();var t=e.previousRenderedWidget;return e instanceof m&&t instanceof m&&e.equals(t)?t:t instanceof y&&e.index===t.index&&e.equals(t)?t:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextSplitWidget",{get:function(){var e=this;if(e instanceof F)return e.getNextSplitWidget();var t=e.nextRenderedWidget;return e instanceof m&&t instanceof m&&e.equals(t)?t:t instanceof y&&e.index===t.index&&e.equals(t)?t:void 0},enumerable:!0,configurable:!0}),e.prototype.getPreviousSplitWidgets=function(){for(var e=[],t=this.previousSplitWidget;t&&(e.unshift(t),!(t=t.previousSplitWidget)||t!=t.previousSplitWidget););return e},e.prototype.getSplitWidgets=function(){for(var e=this.getPreviousSplitWidgets(),t=this;t;)e.push(t),t=t.nextSplitWidget;return e},e.prototype.combineWidget=function(e){var t=this,i=this.getSplitWidgets();if(i.length>1)for(t=i.shift();i.length>0;){var n=i.shift();t.combine(n,e)}return t instanceof C&&t.combineRows(e),t},e.prototype.combine=function(t,i){if(t.childWidgets.length>0){var n=this.lastChild;if(n instanceof C)n.combineWidget(i);else{var r=t.firstChild;!(t instanceof C)&&n instanceof e&&r instanceof e&&n.index===r.index&&n.combine(t.childWidgets.shift(),i)}this.addWidgets(t.childWidgets),t.childWidgets=[]}t.destroyInternal(i)},e.prototype.addWidgets=function(t){for(;t.length>0;){var i=t.shift();if(i instanceof k&&this instanceof b)i.paragraph=this,this.height+=i.height;else if(i instanceof e){var n=this.lastChild;i.containerWidget=this,i.y=n instanceof e?n.y+n.height:this.y,this.height+=i.height}if(i instanceof I)for(var r=this.childWidgets[this.childWidgets.length-1],o=0;o<r.childWidgets.length;o++){var s=r.childWidgets[o];if(s.cellFormat.rowSpan>1)for(var a=0;a<i.childWidgets.length;a++){var l=i.childWidgets[a];if(l.columnIndex===s.columnIndex&&l.isSplittedCell&&l.cellFormat.rowSpan===s.cellFormat.rowSpan){for(var d=0;d<l.childWidgets.length;d++){var h=l.childWidgets[d];l.childWidgets.splice(h.indexInOwner,1),s.childWidgets.push(h),h.containerWidget=s,d--}l.ownerRow.childWidgets.splice(l.indexInOwner,1),l.containerWidget=void 0,a--}}}this.childWidgets.push(i)}},e.prototype.removeChild=function(e){e>-1&&e<this.childWidgets.length&&this.childWidgets.splice(e,1)},e.prototype.destroy=function(){if(this.childWidgets)for(;this.childWidgets.length>0;){var t=this.childWidgets.pop();(t instanceof k||t instanceof e)&&t.destroy()}this.childWidgets=void 0,this.containerWidget&&this.containerWidget.removeChild(this.indexInOwner),this.containerWidget=void 0,this.margin=void 0,this.x=void 0,this.y=void 0,this.width=void 0,this.height=void 0,this.index=void 0},e.prototype.componentDestroy=function(){if(this.childWidgets)for(;this.childWidgets.length>0;){var t=this.childWidgets.pop();(t instanceof k||t instanceof e)&&t.componentDestroy()}this.childWidgets=void 0,this.margin&&this.margin.destroy(),this.margin=void 0,this.x=void 0,this.y=void 0,this.width=void 0,this.height=void 0,this.index=void 0,this.containerWidget=void 0},e}(),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.floatingElements=[],t.footNoteReference=void 0,t.sectionFormatIn=void 0,t.columnIndex=0,t}return h(t,e),Object.defineProperty(t.prototype,"sectionFormat",{get:function(){var e=this;return e instanceof m?e.sectionFormatIn:e.page&&!i.i(o.isNullOrUndefined)(e.page.bodyWidgets)?e.page.bodyWidgets[0].sectionFormat:void 0},set:function(e){this instanceof m&&(this.sectionFormatIn=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sectionIndex",{get:function(){var e=this,t=0;return e instanceof m?t=e.index:e.page&&(t=e.page.bodyWidgets[0].index),t},enumerable:!0,configurable:!0}),t.prototype.getHierarchicalIndex=function(e){var t=void 0,n=this;if(e=n instanceof m?n.index+";"+e:n instanceof w?"Footnote"===n.footNoteType?"FN;"+e:"EN;"+e:-1!==n.headerFooterType.indexOf("Header")?"H;"+e:"F;"+e,!i.i(o.isNullOrUndefined)(n.page)){t=this.page.documentHelper;return t.pages.indexOf(this.page)+";"+e}return e},t.prototype.componentDestroy=function(){this.sectionFormatIn&&this.sectionFormatIn.destroy(),this.sectionFormatIn=void 0,this.floatingElements=[],this.removedHeaderFooters=[],this.footNoteReference=void 0,this.page=void 0,e.prototype.componentDestroy.call(this)},t}(g),m=function(e){function t(){return e.call(this)||this}return h(t,e),t.prototype.equals=function(e){return e instanceof t&&e.sectionFormat===this.sectionFormat},t.prototype.getHierarchicalIndex=function(e){var t=void 0,n=this;if(n.containerWidget instanceof w?(e=n.containerWidget.bodyWidgets.indexOf(n)+";"+e,e="Footnote"===n.containerWidget.footNoteType?"FN;"+e:"EN;"+e):e=this.page&&-1!==this.page.bodyWidgets.indexOf(this)?this.page.bodyWidgets.indexOf(this)+";"+e:n.index+";"+e,!i.i(o.isNullOrUndefined)(n.page)){t=this.page.documentHelper;return t.pages.indexOf(this.page)+";"+e}return e},t.prototype.getTableCellWidget=function(e){for(var t=0;t<this.childWidgets.length;t++)if(this.childWidgets[t]instanceof C){var i=this.childWidgets[t],n=0;if(i.wrapTextAround&&(n=i.getTableCellWidth()),!i.wrapTextAround&&i.y<=e.y&&i.y+i.height>=e.y)return i.getTableCellWidget(e);if(i.wrapTextAround&&i.x<=e.x&&i.x+n>=e.x&&i.y<=e.y&&i.y+i.height>=e.y)return i.getTableCellWidget(e)}var r=void 0;return this.childWidgets.length>0&&(r=this.childWidgets[0].y<=e.y?this.childWidgets[this.childWidgets.length-1].getTableCellWidget(e):this.childWidgets[0].getTableCellWidget(e)),r},t.prototype.destroyInternal=function(e){this.height;if(!i.i(o.isNullOrUndefined)(this.childWidgets)){for(var t=0;t<this.childWidgets.length;t++){var n=this.childWidgets[t];if(n.destroyInternal(e),i.i(o.isNullOrUndefined)(this.childWidgets))break;t--}this.childWidgets=void 0}if(!i.i(o.isNullOrUndefined)(this.page)){var r=this.indexInOwner;this.indexInOwner>-1&&(this.page.bodyWidgets.splice(r,1),0===this.page.bodyWidgets.length?this.page.destroy():this instanceof v&&this.page.headerWidget===this?this.page.headerWidget=void 0:this instanceof v&&this.page.footerWidget===this&&(this.page.footerWidget=void 0),this.page=void 0)}this.destroy()},t.prototype.destroy=function(){this.sectionFormatIn=void 0,this.page&&this.page.headerWidgetIn&&(this.page.headerWidgetIn.page=void 0),this.page&&this.page.footerWidgetIn&&(this.page.footerWidgetIn.page=void 0),this.page=void 0,e.prototype.destroy.call(this)},t.prototype.componentDestroy=function(){e.prototype.componentDestroy.call(this)},t}(f),v=function(e){function t(t){var i=e.call(this)||this;return i.isEmpty=!1,i.headerFooterType=t,i}return h(t,e),t.prototype.getTableCellWidget=function(e){for(var t=0;t<this.childWidgets.length;t++)if(this.childWidgets[t]instanceof C){var i=this.childWidgets[t],n=0;if(i.wrapTextAround&&(n=i.getTableCellWidth()),!i.wrapTextAround&&i.y<=e.y&&i.y+i.height>=e.y)return i.getTableCellWidget(e);if(i.wrapTextAround&&i.x<=e.x&&i.x+n>=e.x&&i.y<=e.y&&i.y+i.height>=e.y)return i.getTableCellWidget(e)}var r=void 0;return this.childWidgets.length>0&&(r=this.childWidgets[0].y<=e.y?this.childWidgets[this.childWidgets.length-1].getTableCellWidget(e):this.childWidgets[0].getTableCellWidget(e)),r},t.prototype.equals=function(e){return e instanceof t&&e.containerWidget===this.containerWidget},t.prototype.clone=function(){for(var e=new t(this.headerFooterType),i=0;i<this.childWidgets.length;i++){var n=this.childWidgets[i].clone();e.childWidgets.push(n),n.index=i,n.containerWidget=e}return e.isEmpty=this.isEmpty,e.x=this.x,e.y=this.y,e.height=0,e.width=0,e},t.prototype.destroyInternal=function(t){this.page=void 0,e.prototype.destroy.call(this)},t.prototype.componentDestroy=function(){e.prototype.componentDestroy.call(this),this.parentHeaderFooter=void 0},t}(f),y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isLayouted=!1,t.isFieldCodeBlock=!1,t.locked=!1,t.lockedBy="",t}return h(t,e),Object.defineProperty(t.prototype,"bodyWidget",{get:function(){for(var e=this;e.containerWidget;){if(e.containerWidget instanceof Z){var t=e.containerWidget.containerShape.line.paragraph;if(t)return t.bodyWidget}else if(e.containerWidget instanceof f)return e.containerWidget;e=e.containerWidget}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"leftIndent",{get:function(){var e=this;return e instanceof b&&e.paragraphFormat instanceof n.a?e.paragraphFormat.leftIndent:e instanceof C&&e.tableFormat instanceof n.b?e.tableFormat.leftIndent:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rightIndent",{get:function(){var e=this;return e instanceof b&&e.paragraphFormat instanceof n.a?e.paragraphFormat.rightIndent:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isInsideTable",{get:function(){return this.containerWidget instanceof F},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isInHeaderFooter",{get:function(){return this.bodyWidget instanceof v},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"associatedCell",{get:function(){if(this.containerWidget instanceof F)return this.containerWidget},enumerable:!0,configurable:!0}),t.prototype.isPageBreak=function(){var e=!1;if(this instanceof b){var t=this;if(null!=t&&1===t.childWidgets.length&&1===t.firstChild.children.length){e=t.firstChild.children[0].isPageBreak}}return e},t.prototype.isColumnBreak=function(){var e=!1;if(this instanceof b){var t=this;if(null!=t&&1===t.childWidgets.length&&1===t.firstChild.children.length){e=t.firstChild.children[0].isColumnBreak}}return e},t.prototype.getHierarchicalIndex=function(e){var n=this;if(e=n.containerWidget.childWidgets.indexOf(n)+";"+e,!i.i(o.isNullOrUndefined)(n.containerWidget)){if(n.containerWidget instanceof Z)return n.containerWidget.getHierarchicalIndex(e);if(n.containerWidget instanceof t)return n.containerWidget.getHierarchicalIndex(e);n.containerWidget instanceof f&&(e=n.containerWidget.getHierarchicalIndex(e))}return e},t.prototype.getIndex=function(){return this instanceof b||this instanceof C?this.containerWidget.childWidgets.indexOf(this):this instanceof I?this.ownerTable.childWidgets.indexOf(this):this instanceof F?this.ownerRow.childWidgets.indexOf(this):0},t.prototype.getContainerWidth=function(){if(this.isInsideTable){var e=this;if(e instanceof C&&"Auto"===e.tableFormat.preferredWidthType&&this.associatedCell.ownerTable.isGridUpdated){for(var t=0,n=this.associatedCell.cellFormat.columnSpan,r=this.associatedCell.columnIndex,s=0;s<n;s++)t+=this.associatedCell.ownerTable.tableHolder.columns[r].preferredWidth,r++;if(t>0)return t}return this.associatedCell.getCellWidth(this)}if(this.containerWidget instanceof Z){var l=this.containerWidget.containerShape;return a.a.convertPixelToPoint(l.width)-a.a.convertPixelToPoint(l.textFrame.marginLeft)-a.a.convertPixelToPoint(l.textFrame.marginRight)}var d=this.bodyWidget,h=d.sectionFormat,c=0;if(!i.i(o.isNullOrUndefined)(d.page)&&!i.i(o.isNullOrUndefined)(d.page.documentHelper)&&"Word2013"!==d.page.documentHelper.compatibilityMode&&!this.isInsideTable&&this instanceof C){var p=this.firstChild;c=p.firstChild.leftMargin+p.lastChild.rightMargin}if(d instanceof m&&h.columns.length>1){var u=d.columnIndex;return a.a.convertPixelToPoint(h.columns[u].width)}return h.pageWidth-(h.leftMargin+h.rightMargin)+c},Object.defineProperty(t.prototype,"bidi",{get:function(){return this instanceof b&&this.paragraphFormat instanceof n.a?this.paragraphFormat.bidi:this instanceof C&&this.tableFormat instanceof n.b&&this.tableFormat.bidi},enumerable:!0,configurable:!0}),t.prototype.componentDestroy=function(){e.prototype.componentDestroy.call(this),this.contentControlProperties=void 0},t}(g),w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bodyWidgets=[],t}return h(t,e),t.prototype.getMinimumAndMaximumWordWidth=function(e,t){throw new Error("Method not implemented.")},t.prototype.getTableCellWidget=function(e){},t.prototype.equals=function(e){return e instanceof t&&e.containerWidget===this.containerWidget},t.prototype.clone=function(){for(var e=new t,i=0;i<this.childWidgets.length;i++){var n=this.childWidgets[i].clone();e.childWidgets.push(n),n.index=i,n.containerWidget=e}return e.block=this.block,e},t.prototype.destroyInternal=function(t){this.block=void 0,e.prototype.destroy.call(this)},t.prototype.componentDestroy=function(){if(this.bodyWidgets&&this.bodyWidgets.length>0){for(var t=0;t<this.bodyWidgets.length;t++){this.bodyWidgets[t].componentDestroy()}this.bodyWidgets=[]}this.bodyWidgets=void 0,this.block=void 0,e.prototype.componentDestroy.call(this)},t}(f),b=function(e){function t(){var t=e.call(this)||this;return t.isSectionBreak=!1,t.isChangeDetected=!1,t.isCreatedUsingHtmlSpanTag=void 0,t.clientX=void 0,t.floatingElements=[],t.paragraphFormat=new n.a(t),t.characterFormat=new n.c(t),t}return h(t,e),Object.defineProperty(t.prototype,"isEndsWithPageBreak",{get:function(){return this.childWidgets.length>0&&this.lastChild.isEndsWithPageBreak},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isEndsWithColumnBreak",{get:function(){return this.childWidgets.length>0&&this.lastChild.isEndsWithColumnBreak},enumerable:!0,configurable:!0}),t.prototype.equals=function(e){return e instanceof t&&e.paragraphFormat===this.paragraphFormat},t.prototype.isContainsShapeAlone=function(){for(var e=!1,t=0;t<this.childWidgets.length;t++)for(var i=this.childWidgets[t],n=0;n<i.children.length;n++){var r=i.children[n];if(!(r instanceof G)||r instanceof G&&"Inline"===r.textWrappingStyle)return!1;e=!0}return!!e},t.prototype.isEmpty=function(){if(i.i(o.isNullOrUndefined)(this.childWidgets)||0===this.childWidgets.length)return!0;for(var e=0;e<this.childWidgets.length;e++)for(var t=this.childWidgets[e],n=0;n<t.children.length;n++){var r=t.children[n];if(0!==r.length&&(r instanceof E||r instanceof Y||r instanceof A||r instanceof $||r instanceof ee||r instanceof te||r instanceof K||r instanceof D||r instanceof T&&a.a.isLinkedFieldCharacter(r)))return!1}return!0},t.prototype.getInline=function(e,t){for(var n=void 0,r=0,s=!1,l=this.getSplitWidgets(),d=0;d<l.length;d++)for(var h=l[d],c=0;c<h.childWidgets.length;c++)for(var p=h.childWidgets[c],u=0;u<p.children.length;u++)if(!((n=p.children[u])instanceof Q)){if((!s&&(n instanceof E||n instanceof Y||n instanceof K||n instanceof A||n instanceof T&&a.a.isLinkedFieldCharacter(n))||n instanceof te)&&(s=!0),s&&e<=r+n.length)return t=e-r,{element:n,index:t};r+=n.length}return e>r&&(t=i.i(o.isNullOrUndefined)(n)?e:n.length),{element:n,index:t}},t.prototype.getLength=function(){var e=0;if(i.i(o.isNullOrUndefined)(this.childWidgets))return e;for(var t=0;t<this.childWidgets.length;t++)for(var n=this.childWidgets[t],r=0;r<n.children.length;r++){var s=n.children[r];s instanceof Q||(e+=s.length)}return e},t.prototype.getTotalLength=function(){for(var e=0,t=this.getSplitWidgets(),i=0;i<t.length;i++)e+=t[i].getLength();return e},t.prototype.getTableCellWidget=function(e){},t.prototype.getMinimumAndMaximumWordWidth=function(e,t){if(e=a.a.convertPointToPixel(e),t=a.a.convertPointToPixel(t),this.childWidgets.length>0){for(var n=this.childWidgets[0].children[0],r="",l=new s.a,d=[];;){if(n instanceof E&&""!==n.text)l.add(n,r.length),r+=n.text;else if(n instanceof T&&0===n.fieldType){var h=n;i.i(o.isNullOrUndefined)(h.fieldEnd)||(n=i.i(o.isNullOrUndefined)(h.fieldSeparator)?h.fieldEnd:h.fieldSeparator)}else n instanceof Y&&d.push(n.width);if(i.i(o.isNullOrUndefined)(n)||i.i(o.isNullOrUndefined)(n.nextNode))break;n=n.nextNode}for(var c=new RegExp("\\b\\w+\\b","g"),p=[],u=void 0;!i.i(o.isNullOrUndefined)(u=c.exec(r));)p.push(u);for(var g=0;g<p.length;g++){var f=p[g],m=0;r="";for(var v="",y=0,w=f.index,b=f.index,x=0;x<l.keys.length;x++){var C=l.keys[x],I=l.get(C),F=C.length;if(b<=I+F&&(y=b-I,f.index+f[0].length<=I+F?w=f.index+f[0].length-(I+y):(w=F-y,b+=w),r=C.text.substring(y,y+w),v+=r),""!==r&&(m+=this.bodyWidget.page.documentHelper.textHelper.getWidth(r,C.characterFormat,C.scriptType)),v===f[0])break}0!==m&&(0===e||m>e)&&(e=m)}var k=0;d.length>0&&(k=Math.max.apply(null,d)),(0===e||k>e)&&(e=k);var P=this.measureParagraph();(0===t||P>t)&&(t=P)}return{maximumWordWidth:a.a.convertPixelToPoint(t),minimumWordWidth:a.a.convertPixelToPoint(e)}},t.prototype.measureParagraph=function(){for(var e=0,t=this.childWidgets[0].children[0];;){if(t instanceof E&&""!==t.text)e+=this.bodyWidget.page.documentHelper.textHelper.getWidth(t.text,t.characterFormat,t.scriptType);else if(t instanceof T&&0===t.fieldType){var n=t;null!=n.fieldEnd&&(t=i.i(o.isNullOrUndefined)(n.fieldSeparator)?n.fieldEnd:n.fieldSeparator)}else t instanceof Y&&(e+=t.width);if(i.i(o.isNullOrUndefined)(t)||i.i(o.isNullOrUndefined)(t.nextNode))break;t=t.nextNode}return this.leftIndent>0&&(e+=this.leftIndent),this.rightIndent>0&&(e+=this.rightIndent),e},t.prototype.isArabicChar=function(e){return e>=String.fromCharCode(1536)&&e<=String.fromCharCode(1791)||e>=String.fromCharCode(1872)&&e<=String.fromCharCode(1919)||e>=String.fromCharCode(2208)&&e<=String.fromCharCode(2303)||e>=String.fromCharCode(64336)&&e<=String.fromCharCode(65023)||e>=String.fromCharCode(65136)&&e<=String.fromCharCode(65279)},t.prototype.isHebrewChar=function(e){return e>=String.fromCharCode(1424)&&e<=String.fromCharCode(1535)||e>=String.fromCharCode(64285)&&e<=String.fromCharCode(64335)},t.prototype.isHindiChar=function(e){return e>=String.fromCharCode(2304)&&e<=String.fromCharCode(2431)||e>=String.fromCharCode(43232)&&e<=String.fromCharCode(43263)||e>=String.fromCharCode(7376)&&e<=String.fromCharCode(7423)},t.prototype.isKoreanChar=function(e){return e>=String.fromCharCode(44032)&&e<=String.fromCharCode(55203)||e>=String.fromCharCode(4352)&&e<=String.fromCharCode(4607)||e>=String.fromCharCode(12592)&&e<=String.fromCharCode(12687)||e>=String.fromCharCode(43360)&&e<=String.fromCharCode(43391)||e>=String.fromCharCode(55216)&&e<=String.fromCharCode(55295)||e>=String.fromCharCode(44032)&&e<=String.fromCharCode(55215)},t.prototype.isJapanese=function(e){return e>=String.fromCharCode(12448)&&e<=String.fromCharCode(12543)||e>=String.fromCharCode(12352)&&e<=String.fromCharCode(12447)},t.prototype.isThaiCharacter=function(e){return e>=String.fromCharCode(3584)&&e<=String.fromCharCode(3711)},t.prototype.isChineseChar=function(e){return e>=String.fromCharCode(19968)&&e<=String.fromCharCode(40959)||e>=String.fromCharCode(13312)&&e<=String.fromCharCode(19903)||e>=String.fromCharCode(55360)&&e<=String.fromCharCode(55401)||e>=String.fromCharCode(56320)&&e<=String.fromCharCode(57055)||e>=String.fromCharCode(43360)&&e<=String.fromCharCode(43391)||e>=String.fromCharCode(65280)&&e<=String.fromCharCode(65519)||e>=String.fromCharCode(12288)&&e<=String.fromCharCode(12351)},t.prototype.getFontScriptType=function(e){return this.isHindiChar(e)?r.a.Hindi:this.isKoreanChar(e)?r.a.Korean:this.isJapanese(e)?r.a.Japanese:this.isChineseChar(e)?r.a.Chinese:this.isArabicChar(e)?r.a.Arabic:this.isHebrewChar(e)?r.a.Hebrew:this.isThaiCharacter(e)?r.a.Thai:r.a.English},t.prototype.splitTextByFontScriptType=function(e,t){var n=[];if(i.i(o.isNullOrUndefined)(e)||!i.i(o.isNullOrUndefined)(e)&&""===e)return n;for(var s="",a=r.a.English,l=r.a.English,d=/[\uD800-\uDFFF]/,h=0;h<e.length;h++)e[h]==String.fromCharCode(32)||d.test(e[h])||(l=this.getFontScriptType(e[h])),""!=s&&l!==a&&(n.push(s),t.push(a),s=""),s+=e[h],a=l;return""!=s&&(n.push(s),t.push(l),s=""),n},t.prototype.splitTextRangeByScriptType=function(e){var t=!1,i=1;if(this.childWidgets.length>0){for(var n=this.childWidgets[e],r=e+1;r<this.childWidgets.length;r++){for(var o=this.childWidgets[r],s=0;s<o.children.length;s++){var a=o.children[s];n.children.push(a),a.line=n}this.childWidgets.splice(r,1),r--}for(var r=0;r<n.children.length;r+=i){var l=n.children[r];i=1;var d=void 0;if(l instanceof E&&(d=l),l instanceof T&&0==l.fieldType?t=!0:l instanceof T&&2===l.fieldType&&(t=!1),void 0!=d&&!t){var h=[],c=this.splitTextByFontScriptType(d.text,h);if(c.length>1)for(var p=0;p<c.length;p++){var u=c[p];if(p>0){var g=d.clone();g.text=u,g.scriptType=h[p],n.children.splice(r+p,0,g),g.line=n,i++,d.revisions.length>0&&this.updateTextElementInRevisionRange(d,g)}else d.text=u,d.scriptType=h[p]}else c.length>0&&(d.scriptType=h[0]);h.length=0}}}},t.prototype.splitLtrAndRtlText=function(e){var t={value:null},i=1,n={value:null},r=[],o=!1,s=this.bodyWidget.page.documentHelper,a=s.textHelper;if(this.childWidgets.length>0){for(var l=this.childWidgets[e],d=0;d<l.children.length;d+=i){var h=l.children[d];i=1;var c=void 0;if(h instanceof E&&(c=h),h instanceof T&&0==h.fieldType?o=!0:h instanceof T&&2===h.fieldType&&(o=!1),void 0!=c&&!o){var p=c.text,u=c.characterFormat.bidi,g=!1,f=r.length;u&&(g=a.isRightToLeftLanguage(h.characterFormat.localeIdBidi));var m=a.splitTextByConsecutiveLtrAndRtl(p,u,g,r,t,n);if(m.length>1)for(var v=0;v<m.length;v++)if(p=m[v],v>0){var y=c.clone();y.text=p,y.characterRange=r[v+f],l.children.splice(d+v,0,y),y.line=l,i++,c.revisions.length>0&&this.updateTextElementInRevisionRange(c,y)}else c.text=p,c.characterRange=r[f];else m.length>0&&(c.characterRange=r[f])}}r.length=0}},t.prototype.updateTextElementInRevisionRange=function(e,t){for(var i=0;i<e.revisions.length;i++){var n=e.revisions[i],r=n.range.indexOf(e);n.range.splice(r+1,0,t),t.revisions.push(n),t.removedIds=[]}},t.prototype.combineconsecutiveRTL=function(e){for(var t=!1,i=this.bodyWidget.page.documentHelper,n=i.textHelper,o=e;o<this.childWidgets.length;o++)for(var s=this.childWidgets[o],a=0;a<=s.children.length-2;a++){var l=s.children[a];if(l instanceof T&&0===l.fieldType?t=!0:l instanceof T&&2===l.fieldType&&(t=!1),!t&&l instanceof E&&s.children[a+1]instanceof E){var d=l,h=s.children[a+1];(d.characterFormat.complexScript&&d.scriptType==h.scriptType||d.characterFormat.bidi&&d.scriptType!==r.a.Hebrew&&d.characterRange==r.b.RightToLeft&&h.characterRange==r.b.RightToLeft)&&d.text.length>0&&h.text.length>0&&!n.isWordSplitChar(d.text[d.text.length-1])&&!n.isWordSplitChar(h.text[0])&&d.characterFormat.isEqualFormat(h.characterFormat)&&this.compareRevisions(d.revisions,h.revisions)?(d.text=d.text+h.text,s.children.splice(a+1,1),a--):d.characterRange==r.b.RightToLeft&&h.characterRange==r.b.RightToLeft&&d.text.length>0&&h.text.length>0&&n.isWordSplitChar(d.text[d.text.length-1])&&n.isWordSplitChar(h.text[0])&&d.characterFormat.isEqualFormat(h.characterFormat)&&this.compareRevisions(d.revisions,h.revisions)&&(d.text=d.text+h.text,s.children.splice(a+1,1),a--)}}},t.prototype.compareRevisions=function(e,t){if(e.length!==t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0},t.prototype.clone=function(){var e=new t;e.paragraphFormat.copyFormat(this.paragraphFormat),e.characterFormat.copyFormat(this.characterFormat);for(var n=0;n<this.childWidgets.length;n++){var r=this.childWidgets[n],s=r.clone();e.childWidgets.push(s);for(var a=0;a<s.children.length;a++){var l=s.children[a];(l instanceof Y&&"Inline"!==l.textWrappingStyle||l instanceof K)&&e.floatingElements.push(l)}s.paragraph=e}return e.x=this.x,e.y=this.y,e.height=this.height,e.width=this.width,e.absoluteXPosition=i.i(o.isNullOrUndefined)(this.absoluteXPosition)?void 0:{width:this.absoluteXPosition.width,x:this.absoluteXPosition.x},this.contentControlProperties&&(e.contentControlProperties=this.contentControlProperties),e},t.prototype.destroyInternal=function(e){var t=this.height;if(!i.i(o.isNullOrUndefined)(this.childWidgets)){for(var n=0;n<this.childWidgets.length;n++){if(this.childWidgets[n].destroy(),1===this.childWidgets.length&&i.i(o.isNullOrUndefined)(this.childWidgets[0].children)&&(this.childWidgets=void 0),i.i(o.isNullOrUndefined)(this.childWidgets))break;n--}this.childWidgets=void 0}i.i(o.isNullOrUndefined)(this.containerWidget)||i.i(o.isNullOrUndefined)(this.containerWidget.childWidgets)||-1===this.containerWidget.childWidgets.indexOf(this)||(this.containerWidget.childWidgets.splice(this.containerWidget.childWidgets.indexOf(this),1),this.containerWidget.height-=t,this.containerWidget=void 0),this.hasOwnProperty("absoluteXPosition")&&delete this.absoluteXPosition,this.destroy()},t.prototype.destroy=function(){this.paragraphFormat=void 0,this.characterFormat=void 0,e.prototype.destroy.call(this)},t.prototype.componentDestroy=function(){this.paragraphFormat&&this.paragraphFormat.destroy(),this.paragraphFormat=void 0,this.characterFormat&&this.characterFormat.destroy(),this.characterFormat=void 0,e.prototype.componentDestroy.call(this)},t}(y),x=function(){function e(){}return e.prototype.clone=function(){var t=new e;return t.allowOverlap=this.allowOverlap,t.distanceTop=this.distanceTop,t.distanceRight=this.distanceRight,t.distanceLeft=this.distanceLeft,t.distanceBottom=this.distanceBottom,t.verticalAlignment=this.verticalAlignment,t.verticalOrigin=this.verticalOrigin,t.verticalPosition=this.verticalPosition,t.horizontalAlignment=this.horizontalAlignment,t.horizontalOrigin=this.horizontalOrigin,t.horizontalPosition=this.horizontalPosition,t},e}(),C=function(e){function t(){var t=e.call(this)||this;return t.flags=0,t.leftMargin=0,t.topMargin=0,t.rightMargin=0,t.bottomMargin=0,t.isDefaultFormatUpdated=!1,t.isContainInsideTable=!1,t.footnoteElement=[],t.margin=new u(t.leftMargin,t.topMargin,t.rightMargin,t.bottomMargin),t.leftBorderWidth=0,t.rightBorderWidth=0,t.topBorderWidth=0,t.bottomBorderWidth=0,t.tableFormat=new n.b(t),t.tableHolder=new be,t.spannedRowCollection=new s.a,t}return h(t,e),Object.defineProperty(t.prototype,"isGridUpdated",{get:function(){return(4&this.flags)>>2!=0},set:function(e){this.flags=251&this.flags|(e?1:0)<<2},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"continueHeader",{get:function(){return(2&this.flags)>>1!=0},set:function(e){this.flags=253&this.flags|(e?1:0)<<1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"header",{get:function(){return 0!=(1&this.flags)},set:function(e){this.flags=254&this.flags|(e?1:0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isBidiTable",{get:function(){return(16&this.flags)>>4!=0},set:function(e){this.flags=239&this.flags|(e?1:0)<<4},enumerable:!0,configurable:!0}),t.prototype.equals=function(e){return e instanceof t&&e.tableFormat===this.tableFormat},t.prototype.combineRows=function(e){for(var t=0;t<this.childWidgets.length;t++){var i=this.childWidgets[t];0===i.childWidgets.length?(i.destroy(),t--):i.combineCells(e)}},t.prototype.contains=function(e){if(this.equals(e.ownerTable))return!0;for(;e.ownerTable.isInsideTable;){if(this.equals(e.ownerTable))return!0;e=e.ownerTable.associatedCell}return this.equals(e.ownerTable)},t.prototype.getOwnerWidth=function(e){var t=this.getContainerWidth();return t=t-this.leftIndent-this.rightIndent,t>=0?t:0},t.prototype.getTableWidth=function(){for(var e=0,t=0;t<this.childWidgets.length;t++){for(var i=0,n=this.childWidgets[t],r=0;r<n.childWidgets.length;r++)i+=n.childWidgets[r].cellFormat.cellWidth;e<i&&(e=i)}return e},t.prototype.getTableCellWidth=function(){for(var e=0,t=0;t<this.childWidgets.length;t++){for(var i=0,n=this.childWidgets[t],r=0;r<n.childWidgets.length;r++){var o=n.childWidgets[r],s=o.width;0===s&&(s=o.cellFormat.cellWidth,s>o.cellFormat.preferredWidth&&0!==o.cellFormat.preferredWidth&&"Percent"!==o.cellFormat.preferredWidthType&&(s=o.cellFormat.preferredWidth),s=a.a.convertPointToPixel(s-(o.margin.left+o.margin.right))),i+=s+o.margin.left+o.margin.right}e<i&&(e=i)}return e},t.prototype.getTableClientWidth=function(e){var t=e;return"Point"===this.tableFormat.preferredWidthType&&this.tableFormat.preferredWidth>0?t=this.tableFormat.preferredWidth:"Percent"===this.tableFormat.preferredWidthType&&this.tableFormat.preferredWidth>0&&(t=t*this.tableFormat.preferredWidth/100),t},t.prototype.getCellWidth=function(e,t,n,r){var s=e;return"Percent"===t?s=e*n/100:"Point"===t?s=e:i.i(o.isNullOrUndefined)(r)||(s=this.getMinimumPreferredWidth(r)),s},t.prototype.getMinimumPreferredWidth=function(e){return 0===e.cellFormat.preferredWidth&&0!==e.cellFormat.cellWidth?e.cellFormat.cellWidth:e.getMinimumPreferredWidth()},t.prototype.fitCellsToClientArea=function(e){for(var t=this.getTableWidth(),i=e/t,n=0;n<this.childWidgets.length;n++){var r=this.childWidgets[n];r.rowFormat.gridAfterWidth*=i,r.rowFormat.gridBeforeWidth*=i;for(var o=0;o<r.childWidgets.length;o++)r.childWidgets[o].cellFormat.cellWidth*=i,r.childWidgets[o].cellFormat.preferredWidth*=i}},t.prototype.getTableCellWidget=function(e){for(var t=void 0,i=0;i<this.childWidgets.length;i++)if(this.childWidgets[i].y<=e.y&&this.childWidgets[i].y+this.childWidgets[i].height>=e.y){t=this.childWidgets[i].getTableCellWidget(e);break}return t},t.prototype.calculateGrid=function(e){var t=[],i=[],n=[],r=this.getOwnerWidth(!0),o=this.getTableClientWidth(r);this.tableCellInfo=new s.a;for(var a=0;a<this.childWidgets.length;a++){var l=this.childWidgets[a],d=new s.a,h=l.rowFormat,c=0,p=l.rowFormat.gridBefore,u=0;t.indexOf(u)<0&&(t.push(u),i.push(u)),c=this.getCellWidth(h.gridBeforeWidth,h.gridBeforeWidthType,o,null),u+=c;var g=parseFloat(u.toFixed(2));t.indexOf(g)<0&&(t.push(g),i.push(u));for(var f=0;f<l.childWidgets.length;f++){for(var m=l.childWidgets[f],v=0;v<n.length;v++)if(!(n[v].columnIndex<p)){var y=n[v].cellFormat.rowSpan,w=!0;n[v].columnIndex>p?(w=!1,f===l.childWidgets.length-1&&l.rowFormat.gridAfter>0&&(c=this.getCellWidth(n[v].cellFormat.preferredWidth,n[v].cellFormat.preferredWidthType,o,null),u+=c)):(c=this.getCellWidth(n[v].cellFormat.preferredWidth,n[v].cellFormat.preferredWidthType,o,null),u+=c,p=n[v].columnIndex+n[v].cellFormat.columnSpan),w||f!==l.childWidgets.length-1||(w=!0),w&&a-n[v].ownerRow.rowIndex==y-1&&(n.splice(v,1),v--)}if(m.cellFormat.rowSpan>1)if(0===n.length||n[n.length-1].columnIndex<=p)n.push(m);else for(var b=n.length;b>0;b--)n[b-1].columnIndex>p&&n.splice(b-1,0,m);d.containsKey(m.cellIndex)||d.add(m.cellIndex,parseFloat((u-g).toFixed(2))),p+=m.cellFormat.columnSpan,c=this.getCellWidth(m.cellFormat.preferredWidth,m.cellFormat.preferredWidthType,o,null),u+=c;var x=parseFloat(u.toFixed(2));t.indexOf(x)<0&&(t.push(x),i.push(u)),f===l.childWidgets.length-1&&h.gridAfter>0&&(c=this.getCellWidth(h.gridAfterWidth,"Point",o,null),u+=c,t.indexOf(parseFloat(u.toFixed(2)))<0&&(t.push(parseFloat(u.toFixed(2))),i.push(u)),p+=h.gridAfter),this.tableCellInfo.containsKey(l.rowIndex)||this.tableCellInfo.add(l.rowIndex,d)}}t.sort(function(e,t){return e-t}),i.sort(function(e,t){return e-t}),this.tableHolder.columns.length>0&&(t.length-1!==this.tableHolder.columns.length||e)&&this.updateColumnSpans(t,o,i),this.tableCellInfo.clear(),this.tableCellInfo=void 0},t.prototype.updateColumnSpans=function(e,t,i){for(var n=0;n<this.childWidgets.length;n++){var r=this.childWidgets[n];r.rowFormat.gridBeforeWidth>=0&&(r.rowFormat.gridBefore=r.getGridCount(e,void 0,-1,t,i));for(var o=0;o<r.childWidgets.length;o++){var s=r.childWidgets[o],a=r.getGridCount(e,s,s.getIndex(),t,i);a>0&&s.cellFormat.columnSpan!==a&&(s.cellFormat.columnSpan=a)}r.rowFormat.gridAfterWidth>=0&&(r.rowFormat.gridAfter=r.getGridCount(e,void 0,r.childWidgets.length,t,i))}},t.prototype.getMinimumAndMaximumWordWidth=function(e,t){this.checkTableColumns();var i=this.tableHolder.isAllColumnHasPointWidthType(),n=i?this.tableHolder.getTotalWidth(0):this.tableHolder.getTotalWidth(1);return n>e&&(e=n),i||(n=this.tableHolder.getTotalWidth(2)),n>t&&(t=n),{minimumWordWidth:e,maximumWordWidth:t}},t.prototype.checkTableColumns=function(){if(!this.isGridUpdated){(this.isAutoFit()||0===this.tableHolder.columns.length)&&this.buildTableColumns(),this.isGridUpdated=!1}},t.prototype.isAutoFit=function(){var e=this.bodyWidget;return!i.i(o.isNullOrUndefined)(e)&&!i.i(o.isNullOrUndefined)(e.page)&&e.page.documentHelper.layout.getParentTable(this).tableFormat.allowAutoFit},t.prototype.buildTableColumns=function(){if(!this.isGridUpdated){this.tableHolder.resetColumns();var e=0,t=0,n=[],r="Auto"===this.tableFormat.preferredWidthType,s=this.tableFormat.allowAutoFit;e=!(!i.i(o.isNullOrUndefined)(this.bodyWidget.page)&&this.bodyWidget.page.viewer instanceof l.a&&s)||this.isInsideTable||this.containerWidget instanceof Z?this.getOwnerWidth(!0):a.a.convertPixelToPoint(this.bodyWidget.page.viewer.clientArea.width-3*this.bodyWidget.page.viewer.padding.right),e=this.tableFormat.preferredWidth>e?this.tableFormat.preferredWidth:e;var d=r&&0===this.tableFormat.preferredWidth&&!s;t=this.getTableClientWidth(e);var h=this.getContainerWidth();d&&!this.isDefaultFormatUpdated&&s&&this.splitWidthToTableCells(t,d);for(var c=!1,p=0;p<this.childWidgets.length;p++){var u=this.childWidgets[p],g=u.rowFormat,f=0,m=0,v=new Ce,y=0;!(g.gridBefore>0)||0===u.rowFormat.beforeWidth&&0===u.rowFormat.gridBeforeWidth||this.bodyWidget.page.documentHelper.alignTablesRowByRow&&"Left"!==u.ownerTable.tableFormat.tableAlignment||(m=this.getCellWidth(g.gridBeforeWidth,u.rowFormat.gridAfterWidthType,t,null),v.minimumWidth=m,this.tableHolder.addColumns(f,f=g.gridBefore,m,v,y=m,"Point"));for(var w=0;w<u.childWidgets.length;w++){var b=u.childWidgets[w];(b.cellFormat.rowSpan>1||b.cellFormat.columnSpan>1)&&(c=!0),0===n.length&&(b.columnIndex=f);for(var x=0;x<n.length;x++){var C=n[x];if(C.columnIndex<f)b.columnIndex=f;else{var I=1,F=!0;I=C.cellFormat.rowSpan,C.columnIndex>f?(b.columnIndex=f,F=!1):(v=C.getCellSizeInfo(s),m=this.getCellWidth(C.cellFormat.preferredWidth,C.cellFormat.preferredWidthType,t,C),this.tableHolder.columns.length>0?(this.tableHolder.addColumns(f,f=this.tableHolder.columns.indexOf(C.ownerColumn)+C.cellFormat.columnSpan,m,v,y+=m,b.cellFormat.preferredWidthType),b.columnIndex=f):(this.tableHolder.addColumns(f,f=C.columnIndex+C.cellFormat.columnSpan,m,v,y+=m,b.cellFormat.preferredWidthType),b.columnIndex=f)),F||w!==u.childWidgets.length-1||(F=!0),F&&p-C.ownerRow.rowIndex==I-1&&(n.splice(x,1),x--)}}if(b.cellFormat.rowSpan>1)if(0===n.length||n[n.length-1].columnIndex<=f)n.push(b);else{for(var k=0,P=n.length;P>0;P--)n[P-1].columnIndex>f&&(k=P-1);n.splice(k,0,b)}v=b.getCellSizeInfo(s),m=this.getCellWidth(b.cellFormat.preferredWidth,b.cellFormat.preferredWidthType,t,b),this.tableHolder.addColumns(f,f+=b.cellFormat.columnSpan,m,v,y+=m,b.cellFormat.preferredWidthType),w===u.childWidgets.length-1&&g.gridAfterWidth>0&&(m=this.getCellWidth(g.gridAfterWidth,"Point",t,null),v.minimumWordWidth=v.maximumWordWidth=v.minimumWidth=m,this.tableHolder.addColumns(f,f+=g.gridAfter,m,v,y+=m,"Point"))}}d&&!this.isDefaultFormatUpdated&&(this.isDefaultFormatUpdated=!0),this.tableHolder.validateColumnWidths(),s?this.tableHolder.autoFitColumn(e,t,r,this.isInsideTable,s,c,this.leftIndent+this.rightIndent,h):this.tableHolder.fitColumns(e,t,r,s,this.leftIndent+this.rightIndent),this.setWidthToCells(t,r)}},t.prototype.setWidthToCells=function(e,t){for(var i=0;i<this.childWidgets.length;i++){var n=this.childWidgets[i],r=n.rowFormat;r.gridBefore>0&&(r.beforeWidth=this.tableHolder.getCellWidth(0,r.gridBefore,e));for(var o=0;o<n.childWidgets.length;o++){var s=n.childWidgets[o];s.cellFormat.cellWidth=this.tableHolder.getCellWidth(s.columnIndex,s.cellFormat.columnSpan,e)}r.gridAfter>0&&(r.afterWidth=this.tableHolder.getCellWidth(0,r.gridAfter,e))}},t.prototype.updateProperties=function(e,t,i){if(e&&(this.tableFormat.allowAutoFit="FixedColumnWidth"!==i),this!==t)return void t.updateProperties(!1,t,i);if("FixedColumnWidth"===i){this.tableFormat.preferredWidth=0,this.tableFormat.preferredWidthType="Auto";for(var n=0;n<this.childWidgets.length;n++)for(var r=this.childWidgets[n],o=0;o<r.childWidgets.length;o++){var s=r.childWidgets[o];s.cellFormat.preferredWidthType="Point",s.cellFormat.preferredWidth=s.cellFormat.cellWidth}}else if("FitToWindow"===i){var a=this.tableHolder.getTotalWidth(0);this.tableFormat.leftIndent=0,this.tableFormat.preferredWidth=100,this.tableFormat.preferredWidthType="Percent";for(var n=0;n<this.childWidgets.length;n++)for(var l=this.childWidgets[n],d=0;d<l.childWidgets.length;d++){var h=l.childWidgets[d];"Percent"!==h.cellFormat.preferredWidthType&&(h.cellFormat.preferredWidthType="Percent",h.cellFormat.preferredWidth=h.cellFormat.cellWidth/a*100)}}else{this.tableFormat.preferredWidth=0,this.tableFormat.preferredWidthType="Auto";for(var n=0;n<this.childWidgets.length;n++){var l=this.childWidgets[n];l.rowFormat.beforeWidth=0,l.rowFormat.gridBefore=0,l.rowFormat.gridBeforeWidth=0,l.rowFormat.gridBeforeWidthType="Auto",l.rowFormat.afterWidth=0,l.rowFormat.gridAfter=0,l.rowFormat.gridAfterWidth=0,l.rowFormat.gridAfterWidthType="Auto";for(var o=0;o<l.childWidgets.length;o++){var h=l.childWidgets[o];h.cellFormat.preferredWidth=0,h.cellFormat.preferredWidthType="Auto"}}}},t.prototype.getMaxRowWidth=function(e){for(var t=0,i=0;i<this.childWidgets.length;i++){for(var n=this.childWidgets[i],r=0,o=0;o<n.childWidgets.length;o++){var s=n.childWidgets[o];r+=this.getCellWidth(s.cellFormat.preferredWidth,s.cellFormat.preferredWidthType,e,s)}t<r&&(t=r)}return t},t.prototype.updateWidth=function(e){var t=this.tableHolder.getTotalWidth(0),i=this.getOwnerWidth(!0),n=this.getTableClientWidth(i);if(n<=t&&"Auto"===this.tableFormat.preferredWidthType&&(this.tableFormat.preferredWidthType="Point"),"Auto"!==this.tableFormat.preferredWidthType)if("Point"===this.tableFormat.preferredWidthType)this.tableFormat.preferredWidth=this.getMaxRowWidth(n);else{var r=t/i*100;this.tableFormat.preferredWidth=r}},t.prototype.convertPointToPercent=function(e,t){var i=0;return i=e/t*100,i=Math.round(i),i<100?i:100},t.prototype.updateChildWidgetLeft=function(e,t){for(var i=0;i<this.childWidgets.length;i++){var n=this.childWidgets[i];n.x=e,n.updateChildWidgetLeft(e,t)}},t.prototype.shiftWidgetsForRtlTable=function(e,t){var i=t.x,n=e.right,r=0;t.tableFormat&&t.tableFormat.cellSpacing>0&&(r=t.tableFormat.cellSpacing);for(var o=0;o<t.childWidgets.length;o++)for(var s=t.childWidgets[o],a=s.x,l=n-(a-i),d=0;d<s.childWidgets.length;d++){var h=s.childWidgets[d];l-=h.width+h.margin.left+h.margin.right-h.rightBorderWidth+r,h.updateWidgetLeft(l+h.margin.left)}},t.prototype.clone=function(){var e=new t;e.tableHolder=this.tableHolder.clone(),e.tableFormat.copyFormat(this.tableFormat),this.wrapTextAround&&(e.wrapTextAround=this.wrapTextAround,e.positioning=this.positioning.clone());for(var i=0;i<this.childWidgets.length;i++){var n=this.childWidgets[i].clone();e.childWidgets.push(n),n.containerWidget=e,n.index=i}return e.x=this.x,e.y=this.y,e.height=this.height,e.width=this.width,e.containerWidget=this.containerWidget,this.contentControlProperties&&(e.contentControlProperties=this.contentControlProperties),e},t.getTableOf=function(e){if(e instanceof n.d){var r=I.getRowOf(e);return i.i(o.isNullOrUndefined)(r)?e.ownerBase instanceof n.b&&e.ownerBase.ownerBase instanceof t?e.ownerBase.ownerBase:void 0:r.ownerTable}},t.prototype.fitChildToClientArea=function(){var e=this.getContainerWidth();Math.round(e)<Math.round(this.getTableWidth())&&this.fitCellsToClientArea(e);for(var i=0;i<this.childWidgets.length;i++)for(var n=this.childWidgets[i],r=0;r<n.childWidgets.length;r++)for(var o=n.childWidgets[r],s=0;s<o.childWidgets.length;s++)o.childWidgets[s]instanceof t&&o.childWidgets[s].fitChildToClientArea()},t.prototype.getColumnCellsForSelection=function(e,t){for(var i=[],n=e.columnIndex,r=t.columnIndex+t.cellFormat.columnSpan,o=0;o<this.childWidgets.length;o++)for(var s=this.childWidgets[o],a=0;a<s.childWidgets.length;a++){var l=s.childWidgets[a],d=l.columnIndex,h=l.cellFormat.columnSpan;d+h>n&&d+h<r||d>n&&d<r?i.indexOf(l)<0&&i.push(l):d>n&&d<r&&d+h<r||d<n&&d+h>r?i.indexOf(l)<0&&i.push(l):d!==n&&d+h!==r||i.indexOf(l)<0&&i.push(l)}return i},t.prototype.splitWidthToTableCells=function(e,t){for(var i=0;i<this.childWidgets.length;i++)this.childWidgets[i].splitWidthToRowCells(e,t)},t.prototype.insertTableRowsInternal=function(e,t,i){for(var n=e.length-1;n>=0;n--){var r=e.splice(n,1)[0];r.containerWidget=this,this.childWidgets.splice(t,0,r)}this.updateRowIndex(t),this.isGridUpdated=!1,i&&(this.calculateGrid(!0),this.buildTableColumns()),this.isGridUpdated=!0},t.prototype.updateRowIndex=function(e){for(var t=e;t<this.childWidgets.length;t++){var i=this.childWidgets[t];i.index=t;for(var n=0;n<i.childWidgets.length;n++)i.childWidgets[n].index=n,i.childWidgets[n].rowIndex=i.rowIndex;e++}},t.prototype.getCellStartOffset=function(e){var t=0;if(e&&this.tableCellInfo&&this.tableCellInfo.containsKey(e.ownerRow.rowIndex)){var i=this.tableCellInfo.get(e.ownerRow.rowIndex);i.containsKey(e.cellIndex)&&(t=i.get(e.cellIndex))}return t},t.prototype.destroyInternal=function(e){var t=this.height;if(!i.i(o.isNullOrUndefined)(this.childWidgets)){for(var n=0;n<this.childWidgets.length;n++){var r=void 0;if(r=this.childWidgets[n],i.i(o.isNullOrUndefined)(r)||r.destroyInternal(e),i.i(o.isNullOrUndefined)(this.childWidgets))break;n--}this.childWidgets=void 0}i.i(o.isNullOrUndefined)(this.containerWidget)||(this.containerWidget instanceof m&&-1!==this.containerWidget.floatingElements.indexOf(this)&&this.containerWidget.floatingElements.splice(this.containerWidget.floatingElements.indexOf(this),1),i.i(o.isNullOrUndefined)(this.containerWidget.childWidgets)||(-1!==this.containerWidget.childWidgets.indexOf(this)&&this.containerWidget.childWidgets.splice(this.containerWidget.childWidgets.indexOf(this),1),this.containerWidget.height-=t),this.containerWidget=void 0),this.destroy()},t.prototype.destroy=function(){this.tableFormat=void 0,this.spannedRowCollection&&this.spannedRowCollection.destroy(),this.spannedRowCollection=void 0,this.tableHolder=void 0,this.flags=void 0,this.leftMargin=void 0,this.topMargin=void 0,this.rightMargin=void 0,this.bottomMargin=void 0,this.headerHeight=void 0,this.isDefaultFormatUpdated=void 0,e.prototype.destroy.call(this)},t.prototype.componentDestroy=function(){this.tableFormat&&this.tableFormat.destroy(),this.tableFormat=void 0,this.spannedRowCollection&&this.spannedRowCollection.destroy(),this.spannedRowCollection=void 0,this.tableHolder&&this.tableHolder.destroy(),this.tableHolder=void 0,this.flags=void 0,this.leftMargin=void 0,this.topMargin=void 0,this.rightMargin=void 0,this.bottomMargin=void 0,this.headerHeight=void 0,this.isDefaultFormatUpdated=void 0,e.prototype.componentDestroy.call(this)},t}(y),I=function(e){function t(){var t=e.call(this)||this;return t.isRenderBookmarkEnd=!1,t.topBorderWidth=0,t.bottomBorderWidth=0,t.rowFormat=new n.e(t),t.editRangeID=new s.a,t}return h(t,e),Object.defineProperty(t.prototype,"rowIndex",{get:function(){return this.containerWidget?this.containerWidget.childWidgets.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ownerTable",{get:function(){if(this.containerWidget instanceof C)return this.containerWidget},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nextRow",{get:function(){var e=this.indexInOwner;if(e>-1&&e<this.ownerTable.childWidgets.length-1)return this.ownerTable.childWidgets[e+1]},enumerable:!0,configurable:!0}),t.prototype.equals=function(e){return e instanceof t&&e.rowFormat===this.rowFormat},t.prototype.combineCells=function(e){for(var t=0;t<this.childWidgets.length;t++){var n=this.childWidgets[t];if(n.combineWidget(e),i.i(o.isNullOrUndefined)(n.cellFormat)||1!==n.cellFormat.rowSpan)i.i(o.isNullOrUndefined)(n.cellFormat)&&t--;else{n.height,n.margin.top,n.margin.bottom;this.height-this.ownerTable.tableFormat.cellSpacing<n.height&&(this.height=this.ownerTable.tableFormat.cellSpacing+n.height)}}},t.getRowOf=function(e){if(e instanceof n.d){var r=F.getCellOf(e);return i.i(o.isNullOrUndefined)(r)?e.ownerBase instanceof n.e&&e.ownerBase.ownerBase instanceof t?e.ownerBase.ownerBase:void 0:r.ownerRow}},t.prototype.getCell=function(e,t){for(var i=0;i<this.childWidgets.length;i++){var n=this.childWidgets[i];if(n.rowIndex===e&&n.index===t)return n}},t.prototype.getCellUsingColumnIndex=function(e,t){for(var n,r=0;r<this.childWidgets.length;r++)if(n=this.childWidgets[r],n.rowIndex===e&&n.columnIndex===t)return n;if(n=this.getCell(e,t),!i.i(o.isNullOrUndefined)(n))return n},t.prototype.splitWidthToRowCells=function(e,t){for(var i=this.childWidgets,n=e/i.length,r=0;r<i.length;r++)if(t&&0===i[r].cellFormat.preferredWidth)i[r].cellFormat.preferredWidth=n,this.ownerTable.isDefaultFormatUpdated=!1;else{if(t){this.ownerTable.isDefaultFormatUpdated=!0;break}i[r].cellFormat.preferredWidth=n}},t.prototype.getGridCount=function(e,t,n,r,s){var a=0,l=0,d=this.ownerTable,h=this.rowFormat;-1===n?l=d.getCellWidth(h.gridBeforeWidth,h.gridBeforeWidthType,r,null):(a+=d.getCellWidth(h.gridBeforeWidth,h.gridBeforeWidthType,r,null),n>=0&&(a+=d.getCellStartOffset(t)),l=n<this.childWidgets.length?d.getCellWidth(t.cellFormat.preferredWidth,t.cellFormat.preferredWidthType,r,null):d.getCellWidth(h.gridAfterWidth,h.gridAfterWidthType,r,null));var c=e.indexOf(a),p=s[c],u=this.getOffsetIndex(e,a),g=parseFloat((l+a).toFixed(2));return(parseFloat((l+p).toFixed(2))===g||i.i(o.isNullOrUndefined)(p)?this.getOffsetIndex(e,a+l):this.getOffsetIndex(e,p+l))-u},t.prototype.getOffsetIndex=function(e,t){t=parseFloat(t.toFixed(2));var i=0;if(e.indexOf(t)>=0)i=e.indexOf(t);else{for(var n=0;n<e.length;n++)if(e[n]>t)return n;i=e.length-1}return i},t.prototype.getCellOffset=function(e,t){for(var i=0,n=this.ownerTable,r=0;r<this.childWidgets.length;r++){var o=this.childWidgets[r].cellFormat;if(r===e)break;i+=n.getCellWidth(o.preferredWidth,o.preferredWidthType,t,null)}return i},t.prototype.updateRowBySpannedCells=function(){for(var e=this.getPreviousRowSpannedCells(),t=this.rowIndex,i=0;i<e.length;i++){var n=e[i];n.ownerRow.rowIndex+n.cellFormat.rowSpan-1>=t&&(n.cellFormat.rowSpan-=1)}},t.prototype.getPreviousRowSpannedCells=function(e){for(var t=[],n=e?this:this.previousWidget;!i.i(o.isNullOrUndefined)(n);){for(var r=0;r<n.childWidgets.length;r++){var s=n.childWidgets[r];s.cellFormat.rowSpan>1&&t.splice(0,0,s)}n=n.previousWidget}return t},t.prototype.isCellsHaveSameWidthUnit=function(){if(this.childWidgets.length>0)for(var e=this.childWidgets[0].cellFormat.preferredWidthType,t=1;t<this.childWidgets.length;t++){var i=this.childWidgets[t];if(e!=i.cellFormat.preferredWidthType)return!1}return!0},t.prototype.updateUniformWidthUnitForCells=function(){for(var e=0;e<this.childWidgets.length;e++){var t=this.childWidgets[e];t.cellFormat.preferredWidthType="Point",t.cellFormat.preferredWidth=t.cellFormat.cellWidth}},t.prototype.getTableCellWidget=function(e){for(var t=0;t<this.childWidgets.length;t++){var i=Math.round(this.childWidgets[t].x);if(i-this.childWidgets[t].margin.left-1<=e.x&&i+this.childWidgets[t].width>=e.x)return this.childWidgets[t];if(t===this.childWidgets.length-1&&this.childWidgets[t].x+this.childWidgets[t].width+1<=e.x)return this.childWidgets[t]}var n=void 0;return this.childWidgets.length>0&&(n=this.childWidgets[0].x<=e.x?this.childWidgets[this.childWidgets.length-1].getTableCellWidget(e):this.childWidgets[0].getTableCellWidget(e)),n},t.prototype.getFirstRowWidth=function(){for(var e=0,t=0;t<this.childWidgets.length;t++)e+=this.childWidgets[t].getCellWidth(this.ownerTable);return e},t.prototype.getCellWidget=function(e,t){var i=this.ownerTable.tableHolder,n=i.getValidColumnIndex(e);n>e&&(t-=n-e,e=n);var r=0;this.rowFormat.gridBefore>0&&(r+=this.rowFormat.gridBefore);for(var o=0;o<this.childWidgets.length;o++){var s=this.childWidgets[o],a=s.cellFormat.columnSpan;if(r<s.columnIndex&&(r<=e||r<e+t)&&s.columnIndex>e)return null;if((s.columnIndex<=e||s.columnIndex<e+t)&&s.columnIndex+a>e)return s;if(s.columnIndex>e)break;r+=a}return null},t.prototype.getVerticalMergeStartCell=function(e,t){var n=this.ownerTable.tableHolder.columns;if(this.rowFormat.gridBefore>0&&this.rowFormat.gridBefore>e+t)return null;var r=this.getCellWidget(e,t);if(!i.i(o.isNullOrUndefined)(r))return r;if(e+this.rowFormat.gridAfter===n.length)return null;var s,a=this.previousWidget;return i.i(o.isNullOrUndefined)(a)||(s=a.getVerticalMergeStartCell(e,t)),!i.i(o.isNullOrUndefined)(s)&&s.cellFormat.rowSpan>1&&this.index===s.rowIndex+s.cellFormat.rowSpan-1?s:null},t.prototype.getMinimumAndMaximumWordWidth=function(e,t){return{minimumWordWidth:e,maximumWordWidth:t}},t.prototype.destroyInternal=function(e){var t=this.height;if(!i.i(o.isNullOrUndefined)(this.childWidgets)){for(var n=0;n<this.childWidgets.length;n++){if(this.childWidgets[n].destroyInternal(e),i.i(o.isNullOrUndefined)(this.childWidgets))break;n--}this.childWidgets=void 0}i.i(o.isNullOrUndefined)(this.containerWidget)||i.i(o.isNullOrUndefined)(this.containerWidget.childWidgets)||(this.containerWidget.childWidgets.splice(this.containerWidget.childWidgets.indexOf(this),1),(i.i(o.isNullOrUndefined)(this.containerWidget.childWidgets)||0===this.containerWidget.childWidgets.length)&&this.containerWidget instanceof C?this.containerWidget.destroyInternal(e):this.containerWidget.containerWidget instanceof m&&(this.containerWidget.containerWidget.height-=t),this.containerWidget.height-=t),this.destroy()},t.prototype.clone=function(){var e=new t;e.rowFormat.copyFormat(this.rowFormat),e.topBorderWidth=this.topBorderWidth,e.bottomBorderWidth=this.bottomBorderWidth,e.isRenderBookmarkEnd=this.isRenderBookmarkEnd;for(var i=0;i<this.childWidgets.length;i++){var n=this.childWidgets[i].clone();e.childWidgets.push(n),n.containerWidget=e,n.index=i,n.rowIndex=this.rowIndex}return e.x=this.x,e.y=this.y,e.height=this.height,e.width=this.width,this.contentControlProperties&&(e.contentControlProperties=this.contentControlProperties),e},t.prototype.updateChildWidgetLeft=function(e,t){var i=0;this.ownerTable.tableFormat.cellSpacing>0&&(i=this.ownerTable.tableFormat.cellSpacing);for(var n=0;n<this.childWidgets.length;n++){var r=this.childWidgets[n];e+=i+r.margin.left,r.x=e,r.updateChildWidgetLeft(r.x,t),e+=r.width+r.margin.right}},t.prototype.shiftWidgetForRtlTable=function(){var e=this.ownerTable,t=e.x,n=0,r=0;null!=e.tableFormat&&e.tableFormat.cellSpacing>0&&(n=e.tableFormat.cellSpacing),r=a.a.convertPointToPixel(e.getTableWidth());for(var s=this.x,l=t+r,d=l-(s-t),h=0,c=0;c<this.childWidgets.length;c++){var p=this.childWidgets[c],u=0;i.i(o.isNullOrUndefined)(p.previousWidget)||(u=p.previousWidget.columnIndex+p.previousWidget.cellFormat.columnSpan),u<p.columnIndex&&(h=a.a.convertPointToPixel(p.ownerTable.tableHolder.getPreviousSpannedCellWidth(u,p.columnIndex)),0===u&&(h-=n/2)),d-=p.width+p.margin.left+p.margin.right+n,p.updateWidgetLeft(d+p.margin.left-h)}},t.prototype.destroy=function(){this.rowFormat=void 0,this.topBorderWidth=void 0,this.bottomBorderWidth=void 0,e.prototype.destroy.call(this)},t.prototype.componentDestroy=function(){this.rowFormat&&this.rowFormat.destroy(),this.rowFormat=void 0,this.topBorderWidth=void 0,this.bottomBorderWidth=void 0,this.isRenderBookmarkEnd=void 0,e.prototype.componentDestroy.call(this)},t}(y),F=function(e){function t(){var t=e.call(this)||this;return t.rowIndex=-1,t.sizeInfoInternal=new Ce,t.updatedTopBorders=[],t.isRenderBookmarkStart=!1,t.isRenderBookmarkEnd=!1,t.isRenderEditRangeStart=!1,t.isRenderEditRangeEnd=!1,t.isSplittedCell=!1,t.margin=new u(t.leftMargin,t.topMargin,t.rightMargin,t.bottomMargin),t.leftBorderWidth=0,t.rightBorderWidth=0,t.cellFormat=new n.f(t),t}return h(t,e),Object.defineProperty(t.prototype,"ownerColumn",{get:function(){return this.ownerTable.tableHolder.columns[this.columnIndex]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"leftMargin",{get:function(){return this.cellFormat&&this.cellFormat.containsMargins()?this.cellFormat.leftMargin:!i.i(o.isNullOrUndefined)(this.ownerRow)&&this.ownerRow.rowFormat.hasValue("leftMargin")?this.ownerRow.rowFormat.leftMargin:i.i(o.isNullOrUndefined)(this.ownerTable)||i.i(o.isNullOrUndefined)(this.ownerTable.tableFormat)?0:this.ownerTable.tableFormat.leftMargin},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topMargin",{get:function(){return this.cellFormat&&this.cellFormat.containsMargins()?this.cellFormat.topMargin:!i.i(o.isNullOrUndefined)(this.ownerRow)&&this.ownerRow.rowFormat.hasValue("topMargin")?this.ownerRow.rowFormat.topMargin:i.i(o.isNullOrUndefined)(this.ownerTable)||i.i(o.isNullOrUndefined)(this.ownerTable.tableFormat)?0:this.ownerTable.tableFormat.topMargin},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rightMargin",{get:function(){return this.cellFormat&&this.cellFormat.containsMargins()?this.cellFormat.rightMargin:!i.i(o.isNullOrUndefined)(this.ownerRow)&&this.ownerRow.rowFormat.hasValue("rightMargin")?this.ownerRow.rowFormat.rightMargin:i.i(o.isNullOrUndefined)(this.ownerTable)||i.i(o.isNullOrUndefined)(this.ownerTable.tableFormat)?0:this.ownerTable.tableFormat.rightMargin},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomMargin",{get:function(){return this.cellFormat&&this.cellFormat.containsMargins()?this.cellFormat.bottomMargin:!i.i(o.isNullOrUndefined)(this.ownerRow)&&this.ownerRow.rowFormat.hasValue("bottomMargin")?this.ownerRow.rowFormat.bottomMargin:i.i(o.isNullOrUndefined)(this.ownerTable)||i.i(o.isNullOrUndefined)(this.ownerTable.tableFormat)?0:this.ownerTable.tableFormat.bottomMargin},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cellIndex",{get:function(){return this.ownerRow?this.ownerRow.childWidgets.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ownerTable",{get:function(){if(this.containerWidget instanceof I)return this.containerWidget.ownerTable},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ownerRow",{get:function(){return this.containerWidget},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sizeInfo",{get:function(){return this.sizeInfoInternal},enumerable:!0,configurable:!0}),t.prototype.equals=function(e){return e instanceof t&&e.cellFormat===this.cellFormat},t.prototype.getContainerTable=function(){for(var e=this.ownerTable;e instanceof C&&e.associatedCell instanceof t;)e=e.associatedCell.getContainerTable();return e},t.prototype.getPreviousSplitWidget=function(){if(this.containerWidget instanceof I){var e=this.containerWidget;do{if(e=e.previousRenderedWidget,i.i(o.isNullOrUndefined)(e)||e.index<this.rowIndex)break;var t=e.getCell(this.rowIndex,this.index);if(t&&this.equals(t))return t}while(e)}},t.prototype.getNextSplitWidget=function(){var e=this.cellFormat.rowSpan;if(this.containerWidget instanceof I){var t=this.containerWidget;do{if(t=t.nextRenderedWidget,i.i(o.isNullOrUndefined)(t)||t.index>this.rowIndex+e)break;var n=t.getCell(this.rowIndex,this.index);if(n&&this.equals(n))return n}while(t)}},t.prototype.getTableCellWidget=function(e){for(var t=0;t<this.childWidgets.length;t++)if(this.childWidgets[t].y<=e.y&&this.childWidgets[t].y+this.childWidgets[t].height>=e.y)return this.childWidgets[t].getTableCellWidget(e);var i=void 0;return this.childWidgets.length>0&&(i=this.childWidgets[0].y<=e.y?this.childWidgets[this.childWidgets.length-1].getTableCellWidget(e):this.childWidgets[0].getTableCellWidget(e)),i},t.prototype.updateWidth=function(e){"Point"===this.cellFormat.preferredWidthType?this.cellFormat.preferredWidth=e:"Percent"===this.cellFormat.preferredWidthType&&(this.cellFormat.preferredWidth=this.convertPointToPercent(e)),this.cellFormat.cellWidth=e},t.prototype.getCellWidth=function(e){var t=this.ownerTable,n=t?t.getTableClientWidth(t.getOwnerWidth(!0)):0,r=n,s=i.i(o.isNullOrUndefined)(this.leftMargin)?0:this.leftMargin,a=i.i(o.isNullOrUndefined)(this.rightMargin)?0:this.rightMargin;return t&&"Auto"===t.tableFormat.preferredWidthType&&t.tableFormat.allowAutoFit?r=0===this.cellFormat.preferredWidth?n:this.cellFormat.preferredWidth-s-a:"Percent"===this.cellFormat.preferredWidthType?r=this.cellFormat.preferredWidth*n/100-s-a:"Point"===this.cellFormat.preferredWidthType&&(r=e instanceof C&&"Percent"===e.tableFormat.preferredWidthType?this.cellFormat.cellWidth-s-a:this.cellFormat.preferredWidth-s-a),r},t.prototype.convertPointToPercent=function(e){var t=0,i=this.ownerTable.getOwnerWidth(!0);return t=e/this.ownerTable.getTableClientWidth(i)*100,t=Math.round(t),t<100?t:100},t.getCellLeftBorder=function(e){var t=void 0,r=e.cellFormat.borders,s=i.i(o.isNullOrUndefined)(e.ownerRow)?void 0:e.ownerRow.rowFormat.borders,a=i.i(o.isNullOrUndefined)(e.ownerTable)?void 0:e.ownerTable.tableFormat.borders;if(i.i(o.isNullOrUndefined)(r.left)||(t=r.left),i.i(o.isNullOrUndefined)(t)&&(t=e.getLeftBorderToRenderByHierarchy(t,s,a)),e.ownerTable.tableFormat.cellSpacing>0)t=e.getLeftBorderToRenderByHierarchy(t,s,a);else{var l=this.getPreviousCell(e);t=e.getPreviousCellLeftBorder(t,l)}return i.i(o.isNullOrUndefined)(t)&&(t=new n.g(e.cellFormat.borders)),t},t.getPreviousCell=function(e){var t=void 0;if(!i.i(o.isNullOrUndefined)(e.previousWidget)){var n=e.previousWidget;n.columnIndex+n.cellFormat.columnSpan===e.columnIndex&&(t=n)}return t},t.prototype.getLeftBorderWidth=function(){var e=0;return null!==this.cellFormat&&null!==this.cellFormat.borders&&(e=t.getCellLeftBorder(this).getLineWidth()),e},t.prototype.getRightBorderWidth=function(){var e=0;this.ownerTable;return null!==this.cellFormat&&null!==this.cellFormat.borders&&(e=t.getCellRightBorder(this).getLineWidth()),e},t.prototype.getCellSpacing=function(){var e=this.ownerTable&&this.ownerTable.tableFormat?this.ownerTable.tableFormat.cellSpacing:0;return 1===this.ownerRow.childWidgets.length?2*e:0===this.cellIndex||this.cellIndex===this.ownerRow.childWidgets.length-1?e+e/2:e},t.prototype.getCellSizeInfo=function(e){var t=!0,n=void 0;if(i.i(o.isNullOrUndefined)(this.bodyWidget)||i.i(o.isNullOrUndefined)(this.bodyWidget.page)||i.i(o.isNullOrUndefined)(this.bodyWidget.page.documentHelper)||(n=this.bodyWidget.page.documentHelper.layout),i.i(o.isNullOrUndefined)(n)||i.i(o.isNullOrUndefined)(n.currentCell)||(t=!1,this===n.currentCell&&(t=!0)),t&&!this.sizeInfo.hasMinimumWidth&&(this.sizeInfo.minimumWidth=this.getMinimumPreferredWidth()),e&&t&&!this.sizeInfo.hasMinimumWordWidth){var r=this.getMinimumAndMaximumWordWidth(0,0);this.sizeInfo.minimumWordWidth=r.minimumWordWidth+this.sizeInfo.minimumWidth,this.sizeInfo.maximumWordWidth=r.maximumWordWidth+this.sizeInfo.minimumWidth}var s=new Ce;return s.minimumWidth=this.sizeInfo.minimumWidth,s.minimumWordWidth=this.sizeInfo.minimumWordWidth,s.maximumWordWidth=this.sizeInfo.maximumWordWidth,s},t.prototype.getMinimumPreferredWidth=function(){return this.leftMargin+this.rightMargin+this.getLeftBorderWidth()+this.getRightBorderWidth()+this.getCellSpacing()},t.prototype.getPreviousCellLeftBorder=function(e,t){if((i.i(o.isNullOrUndefined)(t)||!i.i(o.isNullOrUndefined)(e)&&"None"===e.lineStyle&&!e.hasNoneStyle)&&(i.i(o.isNullOrUndefined)(e)||e.ownerBase.ownerBase instanceof n.b||(e=this.getLeftBorderToRenderByHierarchy(e,I.getRowOf(e.ownerBase).rowFormat.borders,C.getTableOf(e.ownerBase).tableFormat.borders))),i.i(o.isNullOrUndefined)(t))return e;var r=void 0;return i.i(o.isNullOrUndefined)(t.cellFormat.borders)||i.i(o.isNullOrUndefined)(t.cellFormat.borders.right)||"None"===t.cellFormat.borders.right.lineStyle||(r=t.cellFormat.borders.right),i.i(o.isNullOrUndefined)(r)||"None"===r.lineStyle?i.i(o.isNullOrUndefined)(e)||e.ownerBase.ownerBase instanceof n.b?e:this.getLeftBorderToRenderByHierarchy(e,I.getRowOf(e.ownerBase).rowFormat.borders,C.getTableOf(e.ownerBase).tableFormat.borders):this.getBorderBasedOnPriority(r,e)},t.prototype.getBorderBasedOnPriority=function(e,t){if(i.i(o.isNullOrUndefined)(e))return t;if(i.i(o.isNullOrUndefined)(t))return e;var n=e.getBorderWeight(),r=t.getBorderWeight();if(n===r){var s=e.getPrecedence(),l=t.getPrecedence();if(s===l){var d=a.a.convertHexToRgb(e.color),h=d.r,c=d.g,p=d.b,u=a.a.convertHexToRgb(t.color),g=u.r,f=u.g,m=u.b,v=h+p+2*c,y=g+m+2*f;return v===y?(v=p+2*c,y=m+2*f,v===y?c===f?e:c>f?t:e:v>y?t:e):v>y?t:e}return s>l?e:t}return n>r?e:t},t.prototype.getLeftBorderToRenderByHierarchy=function(e,n,r){var s=t.getCellOf(e.ownerBase);if(!i.i(o.isNullOrUndefined)(s)){var a=!1;(0===s.columnIndex||0===s.cellIndex&&s.ownerRow.rowFormat.gridBefore>0)&&(a=!0),(i.i(o.isNullOrUndefined)(e)||"None"!==e.lineStyle||e.isBorderDefined&&0!==e.lineWidth)&&!i.i(o.isNullOrUndefined)(e)||(a?(e=n.left,(!i.i(o.isNullOrUndefined)(e)&&"None"===e.lineStyle||i.i(o.isNullOrUndefined)(e))&&(e=r.left)):(e=n.vertical,(!i.i(o.isNullOrUndefined)(e)&&"None"===e.lineStyle||i.i(o.isNullOrUndefined)(e))&&(e=r.vertical)))}return e},t.getCellRightBorder=function(e){var t=void 0,r=e.cellFormat.borders,s=i.i(o.isNullOrUndefined)(e.ownerRow)?void 0:e.ownerRow.rowFormat.borders,a=i.i(o.isNullOrUndefined)(e.ownerTable)?void 0:e.ownerTable.tableFormat.borders;if(i.i(o.isNullOrUndefined)(r.right)||(t=r.right),i.i(o.isNullOrUndefined)(t)&&(t=e.getRightBorderToRenderByHierarchy(t,s,a)),e.ownerTable.tableFormat.cellSpacing>0)t=e.getRightBorderToRenderByHierarchy(t,s,a);else{var l=this.getNextCell(e);t=e.getAdjacentCellRightBorder(t,l)}return i.i(o.isNullOrUndefined)(t)&&(t=new n.g(e.cellFormat.borders)),t},t.getNextCell=function(e){var t=void 0,n=e.cellFormat.columnSpan;if(!i.i(o.isNullOrUndefined)(e.nextWidget)){var r=e.nextWidget;e.columnIndex+n===r.columnIndex&&(t=r)}return t},t.prototype.getAdjacentCellRightBorder=function(e,t){if((i.i(o.isNullOrUndefined)(t)||!i.i(o.isNullOrUndefined)(e)&&"None"===e.lineStyle&&!e.hasNoneStyle)&&(i.i(o.isNullOrUndefined)(e)||e.ownerBase.ownerBase instanceof n.b||(e=this.getRightBorderToRenderByHierarchy(e,I.getRowOf(e.ownerBase).rowFormat.borders,C.getTableOf(e.ownerBase).tableFormat.borders))),i.i(o.isNullOrUndefined)(t))return e;var r=void 0;return i.i(o.isNullOrUndefined)(t.cellFormat.borders)||i.i(o.isNullOrUndefined)(t.cellFormat.borders.left)||"None"===t.cellFormat.borders.left.lineStyle||(r=t.cellFormat.borders.left),i.i(o.isNullOrUndefined)(r)||"None"===r.lineStyle?i.i(o.isNullOrUndefined)(e)||e.ownerBase.ownerBase instanceof n.b?e:this.getRightBorderToRenderByHierarchy(e,I.getRowOf(e.ownerBase).rowFormat.borders,C.getTableOf(e.ownerBase).tableFormat.borders):this.getBorderBasedOnPriority(e,r)},t.prototype.getRightBorderToRenderByHierarchy=function(e,n,r){var s=t.getCellOf(e.ownerBase);if(!i.i(o.isNullOrUndefined)(s)){var a=!1;s.columnIndex+s.cellFormat.columnSpan!==s.ownerTable.tableHolder.columns.length&&s.cellIndex!==s.ownerRow.childWidgets.length-1||(a=!0),(i.i(o.isNullOrUndefined)(e)||"None"!==e.lineStyle||e.isBorderDefined&&0!==e.lineWidth)&&!i.i(o.isNullOrUndefined)(e)||(a?(e=n.right,(!i.i(o.isNullOrUndefined)(e)&&"None"===e.lineStyle||i.i(o.isNullOrUndefined)(e))&&(e=r.right)):(e=n.vertical,(!i.i(o.isNullOrUndefined)(e)&&"None"===e.lineStyle||i.i(o.isNullOrUndefined)(e))&&(e=r.vertical)))}return e},t.getCellTopBorder=function(e){var t=void 0,r=e.cellFormat.borders,s=i.i(o.isNullOrUndefined)(e.ownerRow)?void 0:e.ownerRow.rowFormat.borders,a=i.i(o.isNullOrUndefined)(e.ownerTable)?void 0:e.ownerTable.tableFormat.borders;if(i.i(o.isNullOrUndefined)(r.top)||(t=r.top),i.i(o.isNullOrUndefined)(t)&&(t=e.getTopBorderToRenderByHierarchy(t,s,a)),e.ownerTable.tableFormat.cellSpacing>0)t=e.getTopBorderToRenderByHierarchy(t,s,a);else{var l=e.getTopAdjacentCell();t=e.getPreviousCellTopBorder(t,l)}return i.i(o.isNullOrUndefined)(t)&&(t=new n.g(e.cellFormat.borders)),t},t.prototype.getTopAdjacentCell=function(){var e,t=this.ownerRow.previousWidget;return i.i(o.isNullOrUndefined)(t)||(e=t.getVerticalMergeStartCell(this.columnIndex,this.cellFormat.columnSpan)),e},t.prototype.getPreviousCellTopBorder=function(e,t){if((i.i(o.isNullOrUndefined)(t)||!i.i(o.isNullOrUndefined)(e)&&"None"===e.lineStyle&&!e.hasNoneStyle)&&(i.i(o.isNullOrUndefined)(e)||e.ownerBase.ownerBase instanceof n.b||(e=this.getTopBorderToRenderByHierarchy(e,I.getRowOf(e.ownerBase).rowFormat.borders,C.getTableOf(e.ownerBase).tableFormat.borders))),i.i(o.isNullOrUndefined)(t))return e;var r=void 0;return i.i(o.isNullOrUndefined)(t.cellFormat.borders)||i.i(o.isNullOrUndefined)(t.cellFormat.borders.bottom)||(r=this.getBottomBorderToRenderByHierarchy(t.cellFormat.borders.bottom,t.ownerRow.rowFormat.borders,t.ownerTable.tableFormat.borders)),i.i(o.isNullOrUndefined)(r)||"None"===r.lineStyle?i.i(o.isNullOrUndefined)(e)||e.ownerBase.ownerBase instanceof n.b?e:this.getTopBorderToRenderByHierarchy(e,I.getRowOf(e.ownerBase).rowFormat.borders,C.getTableOf(e.ownerBase).tableFormat.borders):this.getBorderBasedOnPriority(e,r)},t.prototype.getTopBorderToRenderByHierarchy=function(e,n,r){var s=t.getCellOf(e.ownerBase);if(!i.i(o.isNullOrUndefined)(s)){var a=i.i(o.isNullOrUndefined)(s.ownerRow.previousWidget);(i.i(o.isNullOrUndefined)(e)||"None"!==e.lineStyle||e.isBorderDefined&&0!==e.lineWidth)&&!i.i(o.isNullOrUndefined)(e)||(a?(e=n.top,(!i.i(o.isNullOrUndefined)(e)&&"None"===e.lineStyle||i.i(o.isNullOrUndefined)(e))&&(e=r.top)):(e=n.horizontal,(!i.i(o.isNullOrUndefined)(e)&&"None"===e.lineStyle||i.i(o.isNullOrUndefined)(e))&&(e=r.horizontal)))}return e},t.getCellBottomBorder=function(e){var t=void 0,r=e.cellFormat.borders,s=i.i(o.isNullOrUndefined)(e.ownerRow)?void 0:e.ownerRow.rowFormat.borders,a=i.i(o.isNullOrUndefined)(e.ownerTable)?void 0:e.ownerTable.tableFormat.borders;if(i.i(o.isNullOrUndefined)(r.bottom)||(t=r.bottom),i.i(o.isNullOrUndefined)(t)&&(t=e.getBottomBorderToRenderByHierarchy(t,s,a)),e.ownerTable.tableFormat.cellSpacing>0)t=e.getBottomBorderToRenderByHierarchy(t,s,a);else{var l=void 0,d=void 0,h=e.cellFormat.rowSpan;if(1===h)d=e.ownerRow.nextWidget;else if(h>1){var c=e.containerWidget;do{if(c=c.nextWidget,i.i(o.isNullOrUndefined)(c))break;if(c.index===e.rowIndex+h){d=c;break}}while(c)}i.i(o.isNullOrUndefined)(d)||(l=d.getCellWidget(e.columnIndex,e.cellFormat.columnSpan)),t=e.getAdjacentCellBottomBorder(t,l)}return i.i(o.isNullOrUndefined)(t)&&(t=new n.g(e.cellFormat.borders)),t},t.prototype.getAdjacentCellBottomBorder=function(e,t){if((i.i(o.isNullOrUndefined)(t)||!i.i(o.isNullOrUndefined)(e)&&"None"===e.lineStyle&&!e.hasNoneStyle)&&(i.i(o.isNullOrUndefined)(e)||e.ownerBase.ownerBase instanceof n.b||(e=this.getBottomBorderToRenderByHierarchy(e,I.getRowOf(e.ownerBase).rowFormat.borders,C.getTableOf(e.ownerBase).tableFormat.borders))),i.i(o.isNullOrUndefined)(t))return e;var r=void 0;return i.i(o.isNullOrUndefined)(t.cellFormat.borders)||i.i(o.isNullOrUndefined)(t.cellFormat.borders.top)||"None"===t.cellFormat.borders.top.lineStyle||(r=t.cellFormat.borders.top),i.i(o.isNullOrUndefined)(r)||"None"===r.lineStyle?i.i(o.isNullOrUndefined)(e)||e.ownerBase.ownerBase instanceof n.b?e:this.getBottomBorderToRenderByHierarchy(e,I.getRowOf(e.ownerBase).rowFormat.borders,C.getTableOf(e.ownerBase).tableFormat.borders):this.getBorderBasedOnPriority(e,r)},t.prototype.getBottomBorderToRenderByHierarchy=function(e,n,r){var s=t.getCellOf(e.ownerBase);if(!i.i(o.isNullOrUndefined)(s)){var a=i.i(o.isNullOrUndefined)(s.ownerRow.nextWidget);(i.i(o.isNullOrUndefined)(e)||"None"!==e.lineStyle||e.isBorderDefined&&0!==e.lineWidth)&&!i.i(o.isNullOrUndefined)(e)||(a?(e=n.bottom,(!i.i(o.isNullOrUndefined)(e)&&"None"===e.lineStyle||i.i(o.isNullOrUndefined)(e))&&(e=r.bottom)):(e=n.horizontal,(!i.i(o.isNullOrUndefined)(e)&&"None"===e.lineStyle||i.i(o.isNullOrUndefined)(e))&&(e=r.horizontal)))}return e},t.getCellOf=function(e){if(e instanceof n.d)return e.ownerBase instanceof n.f&&e.ownerBase.ownerBase instanceof t?e.ownerBase.ownerBase:void 0},t.prototype.updateWidgetLeft=function(e){this.x=e,this.updateChildWidgetLeft(e)},t.prototype.updateChildWidgetLeft=function(e,t){for(var i=0;i<this.childWidgets.length;i++){var n=this.childWidgets[i];if(n.x=e,t&&n instanceof b&&(n.x=e+a.a.convertPointToPixel(n.leftIndent)),n instanceof C){var r=n;if(r.updateChildWidgetLeft(e,t),r.isBidiTable){var o=new c(r.x,r.y,r.width,r.height);r.shiftWidgetsForRtlTable(o,r)}}}},t.prototype.getMinimumAndMaximumWordWidth=function(e,t){for(var i=0;i<this.childWidgets.length;i++){var n=this.childWidgets[i],r=n.getMinimumAndMaximumWordWidth(e,t);e=r.minimumWordWidth,t=r.maximumWordWidth}return{minimumWordWidth:e,maximumWordWidth:t}},t.prototype.destroyInternal=function(e){if(!i.i(o.isNullOrUndefined)(this.childWidgets)){for(var t=0;t<this.childWidgets.length;t++){var n=this.childWidgets[t];n.destroyInternal(e),t--}this.childWidgets=void 0,i.i(o.isNullOrUndefined)(e.documentHelper.selection)||e.documentHelper.selection.selectedWidgets.containsKey(this)&&e.documentHelper.selection.selectedWidgets.remove(this)}this.destroy()},t.prototype.clone=function(){var e=new t;e.cellFormat.copyFormat(this.cellFormat);for(var i=0;i<this.childWidgets.length;i++){var n=this.childWidgets[i].clone();e.childWidgets.push(n),n.containerWidget=e,n.index=i}return e.leftBorderWidth=this.leftBorderWidth,e.rightBorderWidth=this.rightBorderWidth,e.isRenderBookmarkEnd=this.isRenderBookmarkEnd,e.isRenderBookmarkStart=this.isRenderBookmarkStart,this.margin&&(e.margin=this.margin.clone()),e.columnIndex=this.columnIndex,e.x=this.x,e.y=this.y,e.height=this.height,e.width=this.width,this.contentControlProperties&&(e.contentControlProperties=this.contentControlProperties),e},t.prototype.destroy=function(){this.cellFormat=void 0,this.rowIndex=void 0,this.columnIndex=void 0,this.isSplittedCell=void 0,e.prototype.destroy.call(this)},t.prototype.componentDestroy=function(){this.cellFormat&&this.cellFormat.destroy(),this.cellFormat=void 0,this.contentControlProperties=void 0,this.rowIndex=void 0,this.columnIndex=void 0,this.isRenderBookmarkStart=void 0,this.isRenderBookmarkEnd=void 0,e.prototype.componentDestroy.call(this)},t}(y),k=function(){function e(e){this.children=[],this.x=0,this.y=0,this.width=0,this.height=0,this.marginTop=0,this.maxBaseLine=0,this.skipClipImage=!1,this.paragraph=e}return Object.defineProperty(e.prototype,"renderedElements",{get:function(){return i.i(o.isNullOrUndefined)(this.layoutedElements)?this.children:this.layoutedElements},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"indexInOwner",{get:function(){return this.paragraph&&this.paragraph.childWidgets?this.paragraph.childWidgets.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextLine",{get:function(){var t=this.paragraph,i=this.indexInOwner;if(i<=t.childWidgets.length-2)return t.childWidgets[i+1];if(t.nextSplitWidget){var n=t.nextSplitWidget.firstChild;if(n instanceof e&&n.paragraph.equals(this.paragraph))return n}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousLine",{get:function(){var t=this.paragraph,i=this.indexInOwner,n=t.previousSplitWidget;if(i>0)return t.childWidgets[i-1];if(n instanceof b){var r=n.lastChild;if(r instanceof e&&r.paragraph.equals(this.paragraph))return r}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEndsWithPageBreak",{get:function(){if(this.children.length>0){var e=this.children[this.children.length-1];if(e instanceof E)return e.isPageBreak}return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEndsWithColumnBreak",{get:function(){if(this.children.length>0){var e=this.children[this.children.length-1];if(e instanceof E)return e.isColumnBreak}return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEndsWithLineBreak",{get:function(){if(this.children.length>0){var e=this.children[this.children.length-1];if(e instanceof E)return"\v"===e.text}return!1},enumerable:!0,configurable:!0}),e.prototype.isFirstLine=function(){var e=this.indexInOwner;return!!(e>-1&&(void 0===this.paragraph.previousSplitWidget||this.paragraph.previousSplitWidget instanceof b&&(this.paragraph.previousSplitWidget.isEndsWithColumnBreak||this.paragraph.previousSplitWidget.isEndsWithPageBreak)))&&0===e},e.prototype.isLastLine=function(){var e=this.indexInOwner;return e>-1&&void 0===this.paragraph.nextSplitWidget&&e===this.paragraph.childWidgets.length-1},e.prototype.getOffset=function(e,t){if(i.i(o.isNullOrUndefined)(e))return t;for(var n=t,r=e.line,s=0;s<r.children.length;s++){var a=r.children[s];if(e===a)break;a instanceof Q||(n+=a.length)}return n},e.prototype.getEndOffset=function(){for(var e=0,t=0,i=0;i<this.children.length;i++){var n=this.children[i];0!==n.length&&(n instanceof Q||((n instanceof E||n instanceof ve||n instanceof ee||n instanceof Y||n instanceof $||n instanceof A||n instanceof D||n instanceof T&&a.a.isLinkedFieldCharacter(n))&&(e=t+n.length),t+=n.length))}return e},e.prototype.getInline=function(e,t,n,r,s){n=i.i(o.isNullOrUndefined)(n)?this.paragraph.bidi:n;var l=void 0,d=0,h=!1;if(0===this.children.length&&this.previousLine){var c=this.previousLine.children[this.previousLine.children.length-1];if(c instanceof E&&"\v"===c.text)return l=this.previousLine.children[this.previousLine.children.length-1],t=1,{element:l,index:t}}for(var p=0;p<this.children.length;p++)if(!((l=this.children[p])instanceof Q)){if(!h&&(l instanceof E||l instanceof Y||l instanceof K||l instanceof D||l instanceof A||l instanceof $||l instanceof ee||l instanceof ve||l instanceof T&&a.a.isLinkedFieldCharacter(l))&&(h=!0),h&&e<=d+l.length){if(l instanceof E&&" "===l.text&&0===l.revisions.length&&r&&!s){var u=this.getNextTextElement(this,p+1);return l=i.i(o.isNullOrUndefined)(u)?l:u,t=i.i(o.isNullOrUndefined)(u)?e-d:0,{element:l,index:t}}return e===d+l.length&&this.children[p+1]instanceof _?{element:this.children[p+1],index:t}:(t=e-d,{element:l,index:t})}d+=l.length}return e>d&&(t=i.i(o.isNullOrUndefined)(l)?e:l.length),{element:l,index:t}},e.prototype.getNextTextElement=function(e,t){return t<e.children.length-1&&e.children[t]?e.children[t]:null},e.prototype.getHierarchicalIndex=function(e){var t=this;return e=t.paragraph.childWidgets.indexOf(t)+";"+e,t.paragraph instanceof y?t.paragraph.getHierarchicalIndex(e):e},e.prototype.clone=function(){for(var t=new e(void 0),n=0;n<this.children.length;n++){var r=this.children[n],s=r.clone();t.children.push(s),s.line=t}return t.width=this.width,t.height=this.height,i.i(o.isNullOrUndefined)(this.margin)||(t.margin=this.margin.clone()),t},e.prototype.destroy=function(){if(!i.i(o.isNullOrUndefined)(this.children)){for(var e=0;e<this.children.length;e++)this.children[e].destroy();this.children=[]}this.children=void 0,this.paragraph&&this.paragraph.removeChild(this.indexInOwner),this.paragraph=void 0,this.x=void 0,this.y=void 0,this.width=void 0},e.prototype.componentDestroy=function(){if(!i.i(o.isNullOrUndefined)(this.children)){for(var e=0;e<this.children.length;e++){this.children[e].componentDestroy()}this.children=[]}this.children=void 0,this.paragraph=void 0,this.layoutedElements=[],this.layoutedElements=void 0,this.x=void 0,this.y=void 0,this.width=void 0,this.height=void 0},e}(),P=function(){function e(){this.x=0,this.y=0,this.width=0,this.height=0,this.margin=new u(0,0,0,0),this.padding=new u(0,0,0,0),this.characterFormat=void 0,this.isRightToLeft=!1,this.canTrigger=!1,this.ischangeDetected=!1,this.isVisible=!1,this.isSpellChecked=!1,this.revisions=[],this.canTrack=!1,this.removedIds=[],this.isMarkedForRevision=!1,this.characterRange=void 0,this.characterFormat=new n.c(this),this.margin=new u(0,0,0,0)}return Object.defineProperty(e.prototype,"isPageBreak",{get:function(){return this instanceof E&&"\f"===this.text},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isColumnBreak",{get:function(){return this instanceof E&&this.text===String.fromCharCode(14)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isValidNodeForTracking",{get:function(){return!(this instanceof A||this instanceof ve||this instanceof ee||this instanceof $||this instanceof D)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCheckBoxElement",{get:function(){var e=this;return e instanceof E&&!i.i(o.isNullOrUndefined)(e.text)&&(e.text===String.fromCharCode(9745)||e.text===String.fromCharCode(9744))},enumerable:!0,configurable:!0}),e.prototype.linkFieldCharacter=function(e){if(this instanceof T)if(0===this.fieldType){var t=this;i.i(o.isNullOrUndefined)(t.fieldEnd)&&(this.linkFieldTraversingForward(this.line,t,t),-1===e.fields.indexOf(t)&&e.fields.push(t),i.i(o.isNullOrUndefined)(t.formFieldData)||-1!==e.formFields.indexOf(t)||e.layout.isInsertFormField||e.formFields.push(t))}else if(2===this.fieldType){var n=this;if(i.i(o.isNullOrUndefined)(n.fieldBegin)&&this.linkFieldTraversingBackwardSeparator(this.line,n,n),!i.i(o.isNullOrUndefined)(n.fieldBegin)){n.fieldBegin.fieldSeparator=n;var r=this.linkFieldTraversingForward(this.line,n.fieldBegin,n);i.i(o.isNullOrUndefined)(n.fieldEnd)&&r&&(n.fieldEnd=n.fieldBegin.fieldEnd),n.fieldEnd&&(n.fieldEnd.fieldSeparator=n)}}else{var s=this;i.i(o.isNullOrUndefined)(s.fieldBegin)&&this.linkFieldTraversingBackward(this.line,s,s)}},e.prototype.linkFieldTraversingBackward=function(e,t,n){var r=e.children.length-1;e.children.indexOf(n)>-1&&(r=e.children.indexOf(n)-1);for(var s=r;s>=0;s--){var a=e.children[s];if(a instanceof T)if(0===a.fieldType){if(i.i(o.isNullOrUndefined)(a.fieldEnd))return t.fieldBegin=a,i.i(o.isNullOrUndefined)(a.fieldEnd)&&(a.fieldEnd=t),t.fieldSeparator&&i.i(o.isNullOrUndefined)(t.fieldSeparator.fieldBegin)&&(t.fieldSeparator.fieldBegin=a,i.i(o.isNullOrUndefined)(a.fieldSeparator)&&(a.fieldSeparator=t.fieldSeparator)),!i.i(o.isNullOrUndefined)(t.fieldBegin)}else 2===a.fieldType&&i.i(o.isNullOrUndefined)(a.fieldEnd)&&(t.fieldSeparator=a,a.fieldEnd=t,i.i(o.isNullOrUndefined)(a.fieldBegin)||(t.fieldBegin=a.fieldBegin))}if(e.previousLine)this.linkFieldTraversingBackward(e.previousLine,t,this);else if(e.paragraph.previousRenderedWidget instanceof b&&e.paragraph.previousRenderedWidget.childWidgets.length>0){var l=e.paragraph.previousRenderedWidget;this.linkFieldTraversingBackward(l.childWidgets[l.childWidgets.length-1],t,this)}return!0},e.prototype.linkFieldTraversingForward=function(e,t,n){var r=0;e.children.indexOf(n)>-1&&(r=e.children.indexOf(n)+1);for(var s=r;s<e.children.length;s++){var a=e.children[s];if(a instanceof T){if(1===a.fieldType)return i.i(o.isNullOrUndefined)(a.fieldBegin)&&(t.fieldEnd=a),t.fieldEnd&&i.i(o.isNullOrUndefined)(t.fieldEnd.fieldBegin)&&(t.fieldEnd.fieldBegin=t),!0;if(i.i(o.isNullOrUndefined)(t.fieldSeparator)){if(2!==a.fieldType||!i.i(o.isNullOrUndefined)(a.fieldBegin))return!1;if(t.fieldSeparator=a,t.fieldSeparator&&i.i(o.isNullOrUndefined)(t.fieldSeparator.fieldBegin)&&(t.fieldSeparator.fieldBegin=t),!i.i(o.isNullOrUndefined)(a.fieldEnd))return t.fieldEnd=a.fieldEnd,t.fieldSeparator.fieldEnd=t.fieldEnd,!0}}}if(e.nextLine)this.linkFieldTraversingForward(e.nextLine,t,this);else if(e.paragraph.nextRenderedWidget instanceof b&&e.paragraph.nextRenderedWidget.childWidgets.length>0)this.linkFieldTraversingForward(e.paragraph.nextRenderedWidget.childWidgets[0],t,this);else if(e.paragraph.nextRenderedWidget instanceof C){var l=e.paragraph.nextRenderedWidget;l=l.getSplitWidgets().pop(),!i.i(o.isNullOrUndefined)(l.nextRenderedWidget)&&l.nextRenderedWidget instanceof b&&l.nextRenderedWidget.childWidgets.length>0&&this.linkFieldTraversingForward(l.nextRenderedWidget.childWidgets[0],t,this)}return!0},e.prototype.linkFieldTraversingBackwardSeparator=function(e,t,n){var r=e.children.length-1;e.children.indexOf(n)>-1&&(r=e.children.indexOf(n)-1);for(var s=r;s>=0;s--){var a=e.children[s];if(a instanceof T&&a instanceof T&&0===a.fieldType)return i.i(o.isNullOrUndefined)(a.fieldSeparator)&&(t.fieldBegin=a),!i.i(o.isNullOrUndefined)(t.fieldBegin)}if(e.previousLine)this.linkFieldTraversingBackwardSeparator(e.previousLine,t,this);else{if(!(e.paragraph.previousRenderedWidget instanceof b&&e.paragraph.previousRenderedWidget.childWidgets.length>0))return!0;e=e.paragraph.previousRenderedWidget.childWidgets[e.paragraph.previousRenderedWidget.childWidgets.length-1],this.linkFieldTraversingBackwardSeparator(e,t,this)}return!0},Object.defineProperty(e.prototype,"length",{get:function(){return this.getLength()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"indexInOwner",{get:function(){return this.line instanceof k&&this.line.children?this.line.children.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousElement",{get:function(){var e=this.indexInOwner;if(e>0&&e<this.line.children.length)return this.line.children[e-1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextElement",{get:function(){var e=this.indexInOwner;if(e>-1&&e<this.line.children.length-1)return this.line.children[e+1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextNode",{get:function(){var e=this.line.children.indexOf(this),t=this.line.paragraph.childWidgets.indexOf(this.line);return e<this.line.children.length-1?this.line.children[e+1]:t<this.line.paragraph.childWidgets.length-1?this.line.paragraph.childWidgets[t+1].children[0]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextValidNodeForTracking",{get:function(){for(var e=this;!i.i(o.isNullOrUndefined)(e)&&(e instanceof A||e instanceof ve||e instanceof ee||e instanceof $||e instanceof D);)e=e.nextNode;return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousValidNodeForTracking",{get:function(){for(var e=this;!i.i(o.isNullOrUndefined)(e)&&(e instanceof A||e instanceof ve||e instanceof ee||e instanceof $||e instanceof D);)e=e.previousNode;return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousNode",{get:function(){var e=this.line.children.indexOf(this),t=this.line.paragraph.childWidgets.indexOf(this.line);if(e>0)return this.line.children[e-1];if(t>0){var i=this.line.paragraph.childWidgets[t-1];return i.children[i.children.length-1]}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paragraph",{get:function(){if(this.line)return this.line.paragraph},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){if(!i.i(o.isNullOrUndefined)(this.line)&&this.line.children&&this.line.children.indexOf(this)>-1){var e=this.line.children.indexOf(this);this.line.children.splice(e,1)}this.line=void 0,this.characterFormat&&this.characterFormat.destroy(),this.characterFormat=void 0,this.margin&&this.margin.destroy(),this.margin=void 0,this.x=void 0,this.y=void 0,this.width=void 0,this.height=void 0},e.prototype.componentDestroy=function(){this.characterFormat&&this.characterFormat.destroy(),this.characterFormat=void 0,this.margin&&this.margin.destroy(),this.margin=void 0,this.padding&&this.padding.destroy(),this.padding=void 0,this.contentControlProperties=void 0,this.line=void 0,this.x=void 0,this.y=void 0,this.width=void 0,this.height=void 0},e.objectCharacter=String.fromCharCode(65532),e}(),T=function(e){function t(t){var i=e.call(this)||this;return i.fieldType=0,i.fieldCodeType="",i.hasFieldEnd=!1,i.fieldBeginInternal=void 0,i.fieldSeparatorInternal=void 0,i.fieldEndInternal=void 0,i.fieldType=t,i}return h(t,e),Object.defineProperty(t.prototype,"fieldBegin",{get:function(){return this.fieldBeginInternal},set:function(e){this.fieldBeginInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldSeparator",{get:function(){return this.fieldSeparatorInternal},set:function(e){this.fieldSeparatorInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldEnd",{get:function(){return this.fieldEndInternal},set:function(e){this.fieldEndInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"resultText",{get:function(){if(!i.i(o.isNullOrUndefined)(this.formFieldData)&&0===this.fieldType&&!i.i(o.isNullOrUndefined)(this.fieldSeparator)&&!i.i(o.isNullOrUndefined)(this.fieldEnd)){var e=this.fieldSeparator.nextElement,t="";do{if(e instanceof E&&(t+=e.text),(e=e.nextNode)===this.fieldEnd)break}while(e);return t}},enumerable:!0,configurable:!0}),t.prototype.getLength=function(){return 1},t.prototype.clone=function(){var e=new t(this.fieldType);if(0!==this.fieldType||i.i(o.isNullOrUndefined)(this.formFieldData)||(e.formFieldData=this.formFieldData.clone()),e.characterFormat.copyFormat(this.characterFormat),this.margin&&(e.margin=this.margin.clone()),e.width=this.width,e.height=this.height,!i.i(o.isNullOrUndefined)(this.paragraph)&&this.paragraph.isInHeaderFooter){if(this.revisions.length>0)for(var n=0;n<this.revisions.length;n++){var r=this.revisions[n];e.revisions.push(r.clone())}}else this.revisions.length>0?e.removedIds=d.b.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice();return e.fieldCodeType=this.fieldCodeType,e},t.prototype.destroy=function(){this.fieldType=void 0,this.hasFieldEnd=void 0,this.fieldBeginInternal=void 0,this.fieldEndInternal=void 0,this.fieldSeparatorInternal=void 0,e.prototype.destroy.call(this)},t.prototype.componentDestroy=function(){this.formFieldData&&this.formFieldData.destroy(),this.formFieldData=void 0,this.fieldCodeType=void 0,this.fieldBeginInternal=void 0,this.fieldEndInternal=void 0,this.fieldSeparatorInternal=void 0,e.prototype.componentDestroy.call(this)},t}(P),S=function(){function e(){this.name="",this.enabled=!0,this.helpText="",this.statusText=""}return e.prototype.destroy=function(){this.name=void 0,this.helpText=void 0,this.statusText=void 0},e}(),W=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="Text",t.maxLength=0,t.defaultValue="",t.format="",t}return h(t,e),t.prototype.clone=function(){var e=new t;return e.type=this.type,e.name=this.name,e.enabled=this.enabled,e.helpText=this.helpText,e.statusText=this.statusText,e.maxLength=this.maxLength,e.defaultValue=this.defaultValue,e.format=this.format,e},t.prototype.getFormFieldInfo=function(){return{defaultValue:this.defaultValue,enabled:this.enabled,format:this.format,helpText:this.helpText,maxLength:this.maxLength,type:this.type,name:this.name}},t.prototype.copyFieldInfo=function(e){i.i(o.isNullOrUndefined)(e.defaultValue)||(this.defaultValue=e.defaultValue),i.i(o.isNullOrUndefined)(e.enabled)||(this.enabled=e.enabled),i.i(o.isNullOrUndefined)(e.format)||(this.format=e.format),i.i(o.isNullOrUndefined)(e.helpText)||(this.helpText=e.helpText),i.i(o.isNullOrUndefined)(e.maxLength)||(this.maxLength=e.maxLength),i.i(o.isNullOrUndefined)(e.type)||(this.type=e.type)},t.prototype.destroy=function(){this.format=void 0,this.defaultValue=void 0,e.prototype.destroy.call(this)},t}(S),N=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sizeType="Auto",t.size=11,t.defaultValue=!1,t.checked=!1,t}return h(t,e),t.prototype.clone=function(){var e=new t;return e.name=this.name,e.enabled=this.enabled,e.helpText=this.helpText,e.statusText=this.statusText,e.sizeType=this.sizeType,e.size=this.size,e.defaultValue=this.defaultValue,e.checked=this.checked,e},t.prototype.getFormFieldInfo=function(){return{defaultValue:this.defaultValue,enabled:this.enabled,helpText:this.helpText,size:this.size,sizeType:this.sizeType,name:this.name}},t.prototype.copyFieldInfo=function(e){i.i(o.isNullOrUndefined)(e.defaultValue)||(this.defaultValue=e.defaultValue,this.checked=e.defaultValue),i.i(o.isNullOrUndefined)(e.enabled)||(this.enabled=e.enabled),i.i(o.isNullOrUndefined)(e.size)||(this.size=e.size),i.i(o.isNullOrUndefined)(e.helpText)||(this.helpText=e.helpText),i.i(o.isNullOrUndefined)(e.sizeType)||(this.sizeType=e.sizeType)},t.prototype.destroy=function(){e.prototype.destroy.call(this)},t}(S),H=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dropdownItems=[],t.selectedIndex=0,t}return h(t,e),t.prototype.clone=function(){var e=new t;return e.name=this.name,e.enabled=this.enabled,e.helpText=this.helpText,e.statusText=this.statusText,e.dropdownItems=this.dropdownItems.slice(),e.selectedIndex=this.selectedIndex,e},t.prototype.getFormFieldInfo=function(){return{dropdownItems:this.dropdownItems.slice(),enabled:this.enabled,helpText:this.helpText,name:this.name}},t.prototype.copyFieldInfo=function(e){i.i(o.isNullOrUndefined)(e.dropdownItems)||(this.dropdownItems=e.dropdownItems),i.i(o.isNullOrUndefined)(e.enabled)||(this.enabled=e.enabled),i.i(o.isNullOrUndefined)(e.helpText)||(this.helpText=e.helpText)},t.prototype.destroy=function(){this.dropdownItems=[],this.dropdownItems=void 0,e.prototype.destroy.call(this)},t}(S),E=function(e){function t(){var t=e.call(this)||this;return t.baselineOffset=0,t.text="",t.trimEndWidth=0,t.ignoreOnceItems=[],t.istextCombined=!1,t.scriptType=r.a.English,t.renderedFontFamily=void 0,t.errorCollection=[],t}return h(t,e),t.prototype.getLength=function(){return this.text?this.text.length:0},t.prototype.clone=function(){var e=new t;if(e.characterFormat.copyFormat(this.characterFormat),e.text=this.text,this.margin&&(e.margin=this.margin.clone()),e.baselineOffset=this.baselineOffset,!i.i(o.isNullOrUndefined)(this.paragraph)&&this.paragraph.isInHeaderFooter){if(this.revisions.length>0)for(var n=0;n<this.revisions.length;n++){var r=this.revisions[n];e.revisions.push(r.clone())}}else this.revisions.length>0?e.removedIds=d.b.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice();return e.width=this.width,e.height=this.height,this.contentControlProperties&&(e.contentControlProperties=this.contentControlProperties),e},t.prototype.destroy=function(){this.text=void 0,e.prototype.destroy.call(this)},t.prototype.componentDestroy=function(){this.text=void 0,e.prototype.componentDestroy.call(this)},t}(P),O=function(){function e(){this.separator=[],this.continuationNotice=[],this.continuationSeparator=[]}return e.prototype.clear=function(){if(this.separator){for(var e=0;e<this.separator.length;e++){var t=this.separator[e];t.destroy()}this.separator=[]}if(this.continuationSeparator){for(var e=0;e<this.continuationSeparator.length;e++){var t=this.continuationSeparator[e];t.destroy()}this.continuationSeparator=[]}if(this.continuationNotice){for(var e=0;e<this.continuationNotice.length;e++){var t=this.continuationNotice[e];t.destroy()}this.continuationNotice=[]}},e.prototype.destroy=function(){this.separator=[],this.continuationSeparator=[],this.continuationNotice=[]},e.prototype.componentDestroy=function(){if(this.separator){for(var e=0;e<this.separator.length;e++){var t=this.separator[e];t.componentDestroy()}this.separator=[]}if(this.separator=void 0,this.continuationSeparator){for(var e=0;e<this.continuationSeparator.length;e++){var t=this.continuationSeparator[e];t.componentDestroy()}this.continuationSeparator=[]}if(this.continuationSeparator=void 0,this.continuationNotice){for(var e=0;e<this.continuationNotice.length;e++){var t=this.continuationNotice[e];t.componentDestroy()}this.continuationNotice=[]}this.continuationNotice=void 0},e}(),_=function(e){function t(){var t=e.call(this)||this;return t.isLayout=!1,t.bodyWidget=new m,t.bodyWidget.footNoteReference=t,t}return h(t,e),t.prototype.clone=function(){var e=new t;return e.text=this.text,e.characterFormat.copyFormat(this.characterFormat),e.height=this.height,e.footnoteType=this.footnoteType,e.width=this.width,e.symbolCode=this.symbolCode,e.bodyWidget.childWidgets=this.bodyWidget.childWidgets,e.bodyWidget.page=this.bodyWidget.page,this.margin&&(e.margin=this.margin.clone()),e},t.prototype.getLength=function(){return 1},t.prototype.destroy=function(){this.symbolCode="",this.symbolFontName="",this.customMarker=""},t.prototype.componentDestroy=function(){this.characterFormat&&(this.characterFormat.destroy(),this.characterFormat=void 0),this.symbolCode="",this.symbolFontName="",this.customMarker="",this.bodyWidget&&this.bodyWidget.componentDestroy(),this.bodyWidget=void 0,e.prototype.componentDestroy.call(this)},t}(E),B=function(e){function t(){var t=e.call(this)||this;return t.startIn=void 0,t.endIn=void 0,t}return h(t,e),Object.defineProperty(t.prototype,"start",{get:function(){return this.startIn},set:function(e){this.startIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return this.endIn},set:function(e){this.endIn=e},enumerable:!0,configurable:!0}),t.prototype.destroy=function(){this.start=void 0,this.end=void 0},t.prototype.componentDestroy=function(){this.startIn&&this.startIn.destroy(),this.startIn=void 0,this.endIn&&this.endIn.destroy(),this.endIn=void 0,e.prototype.componentDestroy.call(this)},t}(E),L=function(e){function t(){var t=e.call(this)||this;return t.fieldText="",t}return h(t,e),Object.defineProperty(t.prototype,"text",{get:function(){return this.fieldText},set:function(e){this.fieldText=e},enumerable:!0,configurable:!0}),t.prototype.clone=function(){var e=new t;if(e.characterFormat.copyFormat(this.characterFormat),e.fieldBegin=this.fieldBegin,e.text=this.text,this.margin&&(e.margin=this.margin.clone()),!i.i(o.isNullOrUndefined)(this.paragraph)&&this.paragraph.isInHeaderFooter){if(this.revisions.length>0)for(var n=0;n<this.revisions.length;n++){var r=this.revisions[n];e.revisions.push(r.clone())}}else this.revisions.length>0?e.removedIds=d.b.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice();return e.width=this.width,e.height=this.height,e},t.prototype.componentDestroy=function(){this.fieldText=void 0,this.fieldBegin=void 0,e.prototype.componentDestroy.call(this)},t}(E),R=function(e){function t(){var t=e.call(this)||this;return t.tabText="",t.tabLeader="None",t}return h(t,e),t.prototype.destroy=function(){this.tabText=void 0,this.tabLeader=void 0},t.prototype.componentDestroy=function(){this.tabText=void 0,this.tabLeader=void 0,e.prototype.componentDestroy.call(this)},t.prototype.clone=function(){var e=new t;if(e.characterFormat.copyFormat(this.characterFormat),e.tabText=this.tabText,e.tabLeader=this.tabLeader,e.text=this.text,this.margin&&(e.margin=this.margin.clone()),e.width=this.width,e.height=this.height,!i.i(o.isNullOrUndefined)(this.paragraph)&&this.paragraph.isInHeaderFooter){if(this.revisions.length>0)for(var n=0;n<this.revisions.length;n++){var r=this.revisions[n];e.revisions.push(r.clone())}}else this.revisions.length>0?e.removedIds=d.b.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice();return e},t}(E),A=function(e){function t(t){var i=e.call(this)||this;return i.bookmarkTypeIn=0,i.refereneceIn=void 0,i.nameIn="",i.bookmarkTypeIn=t,i}return h(t,e),Object.defineProperty(t.prototype,"bookmarkType",{get:function(){return this.bookmarkTypeIn},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"properties",{get:function(){return this.propertiesIn},set:function(e){this.propertiesIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.nameIn},set:function(e){this.nameIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reference",{get:function(){return this.refereneceIn},set:function(e){this.refereneceIn=e},enumerable:!0,configurable:!0}),t.prototype.getLength=function(){return 1},t.prototype.destroy=function(){this.name=void 0,this.reference=void 0,this.bookmarkTypeIn=void 0},t.prototype.componentDestroy=function(){this.name=void 0,this.reference=void 0,this.bookmarkTypeIn=void 0,e.prototype.componentDestroy.call(this)},t.prototype.clone=function(){var e=new t(this.bookmarkType);return e.name=this.name,e.reference=this.reference,e.properties=this.properties,this.margin&&(e.margin=this.margin.clone()),this.revisions.length>0?e.removedIds=d.b.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice(),e.width=this.width,e.height=this.height,this.contentControlProperties&&(e.contentControlProperties=this.contentControlProperties),e},t}(P),D=function(e){function t(t){var i=e.call(this)||this;return i.contentControlWidgetType=t,i.contentControlProperties=new U(t),i}return h(t,e),t.prototype.getLength=function(){return 1},t.prototype.clone=function(){var e=new t(this.contentControlWidgetType);if(e.characterFormat.copyFormat(this.characterFormat),e.contentControlProperties=this.contentControlProperties,e.contentControlWidgetType=this.contentControlWidgetType,this.margin&&(e.margin=this.margin.clone()),!i.i(o.isNullOrUndefined)(this.paragraph)&&this.paragraph.isInHeaderFooter){if(this.revisions.length>0)for(var n=0;n<this.revisions.length;n++){var r=this.revisions[n];e.revisions.push(r.clone())}}else this.revisions.length>0?e.removedIds=d.b.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice();return e.type=this.type,e.width=this.width,e.height=this.height,e.reference=this.reference,e},t.prototype.destroy=function(){this.contentControlProperties=void 0,this.contentControlWidgetType=void 0,e.prototype.destroy.call(this)},t.prototype.componentDestroy=function(){this.contentControlProperties&&(this.contentControlProperties.destroy(),this.contentControlProperties=void 0),this.contentControlWidgetType=void 0,e.prototype.componentDestroy.call(this)},t}(P),U=function(){function e(e){this.contentControlListItems=[],this.contentControlWidgetType=e,this.characterFormat=new n.c}return e.prototype.destroy=function(){this.characterFormat&&(this.characterFormat.destroy(),this.characterFormat=void 0),this.xmlMapping&&(this.xmlMapping.destroy(),this.xmlMapping=void 0),this.lockContentControl=void 0,this.lockContents=void 0,this.tag=void 0,this.color=void 0,this.title=void 0,this.appearance=void 0,this.type=void 0,this.hasPlaceHolderText=void 0,this.multiline=void 0,this.isTemporary=void 0,this.isChecked=void 0,this.dateCalendarType=void 0,this.dateStorageFormat=void 0,this.dateDisplayLocale=void 0,this.dateDisplayFormat=void 0},e.prototype.clone=function(){var t=new e(this.contentControlWidgetType);if(t.lockContentControl=this.lockContentControl,t.lockContents=this.lockContents,t.tag=this.tag,t.color=this.color,t.title=this.title,t.appearance=this.appearance,t.type=this.type,t.hasPlaceHolderText=this.hasPlaceHolderText,t.multiline=this.multiline,t.isTemporary=this.isTemporary,t.isChecked=this.isChecked,t.dateCalendarType=this.dateCalendarType,t.dateStorageFormat=this.dateStorageFormat,t.dateDisplayLocale=this.dateDisplayLocale,t.dateDisplayFormat=this.dateDisplayFormat,this.contentControlListItems.length>0)for(var i=0;i<this.contentControlListItems.length;i++)t.contentControlListItems.push(this.contentControlListItems[i].clone());return this.checkedState&&(t.checkedState=this.checkedState.clone()),this.uncheckedState&&(t.uncheckedState=this.uncheckedState.clone()),this.xmlMapping&&(t.xmlMapping=this.xmlMapping.clone()),t},e}(),M=function(){function e(){}return e.prototype.destroy=function(){this.displayText=void 0,this.value=void 0},e.prototype.clone=function(){var t=new e;return t.displayText=this.displayText,t.value=this.value,t},e}(),V=function(){function e(){}return e.prototype.destroy=function(){this.font=void 0,this.value=void 0},e.prototype.clone=function(){var t=new e;return t.font=this.font,t.value=this.value,t},e}(),z=function(){function e(){}return e.prototype.destroy=function(){this.isMapped=void 0,this.isWordMl=void 0,this.prefixMapping=void 0,this.xPath=void 0,this.storeItemId=void 0,this.customXmlPart=void 0},e.prototype.clone=function(){var t=new e;return t.isMapped=this.isMapped,t.isWordMl=this.isWordMl,t.prefixMapping=this.prefixMapping,t.xPath=this.xPath,t.storeItemId=this.storeItemId,this.customXmlPart&&(t.customXmlPart=this.customXmlPart.clone()),t},e}(),j=function(){function e(){}return e.prototype.destroy=function(){this.id=void 0,this.xml=void 0},e.prototype.clone=function(){var t=new e;return t.id=this.id,t.xml=this.xml,t},e}(),q=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="",t.alternateText="",t.title="",t}return h(t,e),t.prototype.getLength=function(){return 1},t.prototype.clone=function(){return new K},t}(P),G=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.verticalPosition=0,t.horizontalPosition=0,t.textWrappingStyle="Inline",t.distanceBottom=0,t.distanceLeft=0,t.distanceRight=0,t.distanceTop=0,t}return h(t,e),t}(q),K=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return h(t,e),t.prototype.clone=function(){var e=new t;if(e.characterFormat.copyFormat(this.characterFormat),e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e.shapeId=this.shapeId,e.name=this.name,e.alternateText=this.alternateText,e.title=this.title,e.widthScale=this.widthScale,e.heightScale=this.heightScale,e.visible=this.visible,e.verticalPosition=this.verticalPosition,e.verticalAlignment=this.verticalAlignment,e.verticalOrigin=this.verticalOrigin,e.verticalRelativePercent=this.verticalRelativePercent,e.horizontalPosition=this.horizontalPosition,e.horizontalAlignment=this.horizontalAlignment,e.horizontalOrigin=this.horizontalOrigin,e.horizontalRelativePercent=this.horizontalRelativePercent,e.heightRelativePercent=this.heightRelativePercent,e.widthRelativePercent=this.widthRelativePercent,e.zOrderPosition=this.zOrderPosition,e.allowOverlap=this.allowOverlap,e.textWrappingStyle=this.textWrappingStyle,e.textWrappingType=this.textWrappingType,e.distanceBottom=this.distanceBottom,e.distanceLeft=this.distanceLeft,e.distanceRight=this.distanceRight,e.distanceTop=this.distanceTop,e.layoutInCell=this.layoutInCell,e.lockAnchor=this.lockAnchor,e.autoShapeType=this.autoShapeType,this.lineFormat&&(e.lineFormat=this.lineFormat.clone()),this.fillFormat&&(e.fillFormat=this.fillFormat.clone()),this.textFrame&&(e.textFrame=this.textFrame.clone(),e.textFrame.containerShape=e),this.margin&&(e.margin=this.margin.clone()),!i.i(o.isNullOrUndefined)(this.paragraph)&&this.paragraph.isInHeaderFooter){if(this.revisions.length>0)for(var n=0;n<this.revisions.length;n++){var r=this.revisions[n];e.revisions.push(r.clone())}}else this.revisions.length>0?e.removedIds=d.b.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice();return e},t}(G),Z=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.marginLeft=0,t.marginRight=0,t.marginTop=0,t.marginBottom=0,t}return h(t,e),t.prototype.equals=function(){return!1},t.prototype.destroyInternal=function(){},t.prototype.getHierarchicalIndex=function(e){var t=this.containerShape.line,i=t.getOffset(this.containerShape,0).toString();return t.getHierarchicalIndex(i)},t.prototype.getTableCellWidget=function(){},t.prototype.clone=function(){var e=new t;e.textVerticalAlignment=this.textVerticalAlignment,e.marginBottom=this.marginBottom,e.marginLeft=this.marginLeft,e.marginRight=this.marginRight,e.marginTop=this.marginTop;for(var i=0;i<this.childWidgets.length;i++){var n=this.childWidgets[i].clone();e.childWidgets.push(n),n.index=i,n.containerWidget=e}return e},t}(g),X=function(){function e(){}return e.prototype.clone=function(){var t=new e;return t.lineFormatType=this.lineFormatType,t.color=this.color,t.weight=this.weight,t.dashStyle=this.dashStyle,t.line=this.line,t},e}(),J=function(){function e(){}return e.prototype.clone=function(){var t=new e;return t.color=this.color,t.fill=this.fill,t},e}(),Y=function(e){function t(t){var i=e.call(this)||this;return i.imageStr="",i.imgElement=void 0,i.isInlineImageIn=!0,i.crop=!1,i.left=0,i.top=0,i.right=0,i.bottom=0,i.isMetaFile=!1,i.isCompressed=!1,i.isInlineImageIn=t,i}return h(t,e),Object.defineProperty(t.prototype,"isCrop",{get:function(){return this.crop},set:function(e){if(this.crop=e,e){var t=0,i=0;0!==this.left?this.cropX=this.left*this.cropWidthScale/100:this.cropX=0,0!==this.top?this.cropY=this.top*this.cropHeightScale/100:this.cropY=0,0!==this.right&&(t=this.right*this.cropWidthScale/100),0!==this.bottom&&(i=this.bottom*this.cropHeightScale/100),this.cropWidth=this.cropWidthScale-(this.cropX+t),this.cropHeight=this.cropHeightScale-(this.cropY+i)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isInlineImage",{get:function(){return this.isInlineImageIn},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"element",{get:function(){return i.i(o.isNullOrUndefined)(this.imgElement)&&(this.imgElement=document.createElement("img")),this.imgElement},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageString",{get:function(){return this.imageStr},set:function(e){this.imageStr=e},enumerable:!0,configurable:!0}),t.prototype.getLength=function(){return 1},t.prototype.clone=function(){var e=new t(this.isInlineImage);if(e.characterFormat.copyFormat(this.characterFormat),e.imageString=this.imageString,e.element.src=this.element.src,e.isMetaFile=this.isMetaFile,e.isCompressed=this.isCompressed,e.metaFileImageString=this.metaFileImageString,e.width=this.width,e.height=this.height,e.top=this.top,e.left=this.left,e.bottom=this.bottom,e.right=this.right,e.cropHeightScale=this.cropHeightScale,e.cropWidthScale=this.cropWidthScale,e.cropX=this.cropX,e.cropY=this.cropY,e.isCrop=this.isCrop,this.margin&&(e.margin=this.margin.clone()),!i.i(o.isNullOrUndefined)(this.paragraph)&&this.paragraph.isInHeaderFooter){if(this.revisions.length>0)for(var n=0;n<this.revisions.length;n++){var r=this.revisions[n];e.revisions.push(r.clone())}}else this.revisions.length>0?e.removedIds=d.b.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice();return e.name=this.name,e.alternateText=this.alternateText,e.title=this.title,e.visible=this.visible,e.widthScale=this.widthScale,e.heightScale=this.heightScale,e.verticalPosition=this.verticalPosition,e.verticalOrigin=this.verticalOrigin,e.verticalAlignment=this.verticalAlignment,e.horizontalPosition=this.horizontalPosition,e.horizontalOrigin=this.horizontalOrigin,e.horizontalAlignment=this.horizontalAlignment,e.allowOverlap=this.allowOverlap,e.textWrappingStyle=this.textWrappingStyle,e.textWrappingType=this.textWrappingType,e.layoutInCell=this.layoutInCell,e.zOrderPosition=this.zOrderPosition,e},t.prototype.destroy=function(){this.imgElement=void 0,this.imageString=void 0,this.isInlineImageIn=void 0,e.prototype.destroy.call(this)},t}(G),Q=function(e){function t(t,i){var n=e.call(this)||this;return n.baselineOffset=0,n.trimEndWidth=0,n.isFollowCharacter=!1,n.listLevel=t,n.isFollowCharacter=i,n}return h(t,e),t.prototype.getLength=function(){return this.text?this.text.length:0},t.prototype.clone=function(){var e=new t(this.listLevel,this.isFollowCharacter);return e.text=this.text,e.baselineOffset=this.baselineOffset,this.margin&&(e.margin=this.margin.clone()),e.width=this.width,e.height=this.height,e},t.prototype.destroy=function(){this.text=void 0,e.prototype.destroy.call(this)},t}(P),$=function(e){function t(){var t=e.call(this)||this;return t.editRangeStart=void 0,t.editRangeId=-1,t}return h(t,e),t.prototype.getLength=function(){return 1},t.prototype.destroy=function(){this.editRangeStart=void 0},t.prototype.clone=function(){var e=new t;return e.editRangeStart=this.editRangeStart,e.editRangeId=this.editRangeId,e},t}(P),ee=function(e){function t(){var t=e.call(this)||this;return t.columnFirst=-1,t.columnLast=-1,t.user="",t.group="",t.editRangeId=-1,t}return h(t,e),t.prototype.getLength=function(){return 1},t.prototype.renderLockMark=function(e,t){if(i.i(o.isNullOrUndefined)(this.editRangeMark)){var n=e===this.user?"you":this.user;this.editRangeMark=document.createElement("div"),this.editRangeMark.style.display="none",this.editRangeMark.classList.add("e-de-lock-mark");var r=document.createElement("span");r.className="e-icons e-de-ctnr-lock",this.editRangeMark.appendChild(r),this.editRangeMark.title=t.getConstant("This region is locked by")+" "+n}if(this.line&&i.i(o.isNullOrUndefined)(this.editRangeMark.parentElement)){this.line.paragraph.bodyWidget.page.documentHelper.pageContainer.appendChild(this.editRangeMark)}},t.prototype.removeEditRangeMark=function(){this.editRangeMark&&(this.editRangeMark.parentElement.removeChild(this.editRangeMark),this.editRangeMark=void 0)},t.prototype.destroy=function(){this.user=void 0,this.columnFirst=void 0,this.columnLast=void 0},t.prototype.clone=function(){var e=new t;return e.columnFirst=this.columnFirst,e.columnLast=this.columnLast,e.user=this.user,e.group=this.group,e.editRangeEnd=this.editRangeEnd,e.editRangeId=this.editRangeId,e},t}(P),te=function(e){function t(){var t=e.call(this)||this;return t.chartTitle="",t.chartType="",t.chartElement=void 0,t.chartCategory=[],t.chartSeries=[],t.chartArea=new ie,t.chartPlotArea=new ie,t.chartTitleArea=new ce,t.chartLegend=new oe,t.chartPrimaryCategoryAxis=new fe,t.chartPrimaryValueAxis=new fe,t.chartDataTable=new me,t}return h(t,e),t.prototype.getLength=function(){return 1},Object.defineProperty(t.prototype,"title",{get:function(){return this.chartTitle},set:function(e){this.chartTitle=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this.chartType},set:function(e){this.chartType=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"chartGapWidth",{get:function(){return this.gapWidth},set:function(e){this.gapWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"chartOverlap",{get:function(){return this.overlap},set:function(e){this.overlap=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"targetElement",{get:function(){return i.i(o.isNullOrUndefined)(this.div)&&(this.div=i.i(o.createElement)("div")),this.div},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"officeChart",{get:function(){return this.officeChartInternal},set:function(e){e&&(this.officeChartInternal=e,this.officeChartInternal.chart.loaded=this.onChartLoaded.bind(this))},enumerable:!0,configurable:!0}),t.prototype.onChartLoaded=function(){var e=this;this.officeChart.convertChartToImage(this.officeChart.chart,this.width,this.height).then(function(t){e.imageString=t,e.element.src=t})},t.prototype.clone=function(){var e=new t;e.chartTitle=this.chartTitle,e.chartType=this.chartType,e.height=this.height,e.width=this.width,e.gapWidth=this.gapWidth,e.overlap=this.overlap;for(var i=0;i<this.chartCategory.length;i++){var n=this.chartCategory[i].clone();e.chartCategory.push(n)}for(var i=0;i<this.chartSeries.length;i++){var r=this.chartSeries[i].clone();e.chartSeries.push(r)}return e.chartArea=this.chartArea.clone(),e.chartPlotArea=this.chartPlotArea.clone(),e.chartLegend=this.chartLegend.clone(),e.chartTitleArea=this.chartTitleArea.clone(),e.chartPrimaryCategoryAxis=this.chartPrimaryCategoryAxis.clone(),e.chartPrimaryValueAxis=this.chartPrimaryValueAxis.clone(),e.chartDataTable=this.chartDataTable.clone(),e},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.officeChartInternal&&(this.officeChartInternal.chart.loaded=void 0,this.officeChartInternal.destroy(),this.officeChartInternal=void 0),this.div&&(this.div=void 0),this.chartTitle=void 0,this.chartType=void 0,this.chartArea=void 0,this.chartPlotArea=void 0,this.chartCategory=[],this.chartSeries=[],this.chartTitleArea=void 0,this.chartLegend=void 0,this.chartPrimaryCategoryAxis=void 0,this.chartPrimaryValueAxis=void 0,this.chartDataTable=void 0,this.chartElement=void 0},t}(Y),ie=function(){function e(){}return Object.defineProperty(e.prototype,"chartForeColor",{get:function(){return this.foreColor},set:function(e){this.foreColor=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.foreColor=this.foreColor,t},e.prototype.destroy=function(){this.foreColor=void 0},e}(),ne=function(){function e(){this.categoryXName="",this.chartData=[]}return Object.defineProperty(e.prototype,"xName",{get:function(){return this.categoryXName},set:function(e){this.categoryXName=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;t.categoryXName=this.categoryXName;for(var i=0;i<this.chartData.length;i++){var n=this.chartData[i].clone();t.chartData.push(n)}return t},e.prototype.destroy=function(){this.categoryXName=void 0,this.chartData=[]},e}(),re=function(){function e(){}return Object.defineProperty(e.prototype,"yAxisValue",{get:function(){return this.yValue},set:function(e){this.yValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"xAxisValue",{get:function(){return this.xValue},set:function(e){this.xValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bubbleSize",{get:function(){return this.size},set:function(e){this.size=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.yValue=this.yValue,t.xValue=this.xValue,t.size=this.size,t},e.prototype.destroy=function(){this.xValue=void 0,this.yValue=void 0,this.size=void 0},e}(),oe=function(){function e(){this.chartTitleArea=new ce}return Object.defineProperty(e.prototype,"chartLegendPostion",{get:function(){return this.legendPostion},set:function(e){this.legendPostion=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.legendPostion=this.legendPostion,t.chartTitleArea=this.chartTitleArea.clone(),t},e.prototype.destroy=function(){this.legendPostion=void 0,this.chartTitleArea=void 0},e}(),se=function(){function e(){this.chartDataFormat=[],this.trendLines=[],this.errorBar=new ae,this.dataLabels=new de,this.seriesFormat=new le}return Object.defineProperty(e.prototype,"seriesName",{get:function(){return this.name},set:function(e){this.name=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstSliceAngle",{get:function(){return this.sliceAngle},set:function(e){this.sliceAngle=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"doughnutHoleSize",{get:function(){return this.holeSize},set:function(e){this.holeSize=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;t.name=this.name,t.sliceAngle=this.sliceAngle,t.holeSize=this.holeSize,t.errorBar=this.errorBar.clone(),t.dataLabels=this.dataLabels.clone(),t.seriesFormat=this.seriesFormat.clone();for(var i=0;i<this.chartDataFormat.length;i++){var n=this.chartDataFormat[i].clone();t.chartDataFormat.push(n)}for(var i=0;i<this.trendLines.length;i++){var r=this.trendLines[i].clone();t.trendLines.push(r)}return t},e.prototype.destroy=function(){this.name=void 0,this.errorBar=void 0,this.trendLines=void 0,this.chartDataFormat=[]},e}(),ae=function(){function e(){}return Object.defineProperty(e.prototype,"errorType",{get:function(){return this.type},set:function(e){this.type=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"errorDirection",{get:function(){return this.direction},set:function(e){this.direction=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"errorEndStyle",{get:function(){return this.endStyle},set:function(e){this.endStyle=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numberValue",{get:function(){return this.errorValue},set:function(e){this.errorValue=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.type=this.type,t.errorDirection=this.errorDirection,t.endStyle=this.endStyle,t.errorValue=this.errorValue,t},e.prototype.destroy=function(){this.type=void 0,this.errorDirection=void 0,this.endStyle=void 0},e}(),le=function(){function e(){}return Object.defineProperty(e.prototype,"markerStyle",{get:function(){return this.style},set:function(e){this.style=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"markerColor",{get:function(){return this.color},set:function(e){this.color=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numberValue",{get:function(){return this.size},set:function(e){this.size=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.style=this.style,t.color=this.color,t.size=this.size,t},e.prototype.destroy=function(){this.style=void 0,this.color=void 0,this.size=void 0},e}(),de=function(){function e(){}return Object.defineProperty(e.prototype,"labelPosition",{get:function(){return this.position},set:function(e){this.position=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontName",{get:function(){return this.name},set:function(e){this.name=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontColor",{get:function(){return this.color},set:function(e){this.color=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){return this.size},set:function(e){this.size=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLegendKey",{get:function(){return this.isLegend},set:function(e){this.isLegend=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBubbleSize",{get:function(){return this.isBubble},set:function(e){this.isBubble=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCategoryName",{get:function(){return this.isCategory},set:function(e){this.isCategory=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSeriesName",{get:function(){return this.isSeries},set:function(e){this.isSeries=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isValue",{get:function(){return this.isValueEnabled},set:function(e){this.isValueEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPercentage",{get:function(){return this.isPercentageEnabled},set:function(e){this.isPercentageEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLeaderLines",{get:function(){return this.showLeaderLines},set:function(e){this.showLeaderLines=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.position=this.position,t.name=this.name,t.color=this.color,t.size=this.size,t.isBubble=this.isBubble,t.isLegend=this.isLegend,t.isCategory=this.isCategory,t.isSeries=this.isSeries,t.isValueEnabled=this.isValueEnabled,t.isPercentageEnabled=this.isPercentageEnabled,t.showLeaderLines=this.showLeaderLines,t},e.prototype.destroy=function(){this.position=void 0},e}(),he=function(){function e(){}return Object.defineProperty(e.prototype,"trendLineType",{get:function(){return this.type},set:function(e){this.type=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trendLineName",{get:function(){return this.name},set:function(e){this.name=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"interceptValue",{get:function(){return this.intercept},set:function(e){this.intercept=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"forwardValue",{get:function(){return this.forward},set:function(e){this.forward=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"backwardValue",{get:function(){return this.backward},set:function(e){this.backward=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDisplayRSquared",{get:function(){return this.displayRSquared},set:function(e){this.displayRSquared=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDisplayEquation",{get:function(){return this.displayEquation},set:function(e){this.displayEquation=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.type=this.type,t.name=this.name,t.forward=this.forward,t.backward=this.backward,t.intercept=this.intercept,t.displayEquation=this.displayEquation,t.displayRSquared=this.displayRSquared,t},e.prototype.destroy=function(){this.type=void 0,this.name=void 0,this.forward=void 0,this.backward=void 0},e}(),ce=function(){function e(){this.dataFormat=new pe,this.layout=new ge}return Object.defineProperty(e.prototype,"chartfontName",{get:function(){return this.fontName},set:function(e){this.fontName=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"chartFontSize",{get:function(){return this.fontSize},set:function(e){this.fontSize=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.fontName=this.fontName,t.fontSize=this.fontSize,t.dataFormat=this.dataFormat.clone(),t.layout=this.layout.clone(),t},e.prototype.destroy=function(){this.fontName=void 0,this.fontSize=void 0,this.dataFormat=void 0,this.layout=void 0},e}(),pe=function(){function e(){this.fill=new ue,this.line=new ue}return e.prototype.clone=function(){var t=new e;return t.fill=this.fill.clone(),t.line=this.line.clone(),t},e.prototype.destroy=function(){this.fill=void 0,this.line=void 0},e}(),ue=function(){function e(){}return Object.defineProperty(e.prototype,"color",{get:function(){return this.fillColor},set:function(e){this.fillColor=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rgb",{get:function(){return this.fillRGB},set:function(e){this.fillRGB=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.fillColor=this.fillColor,t.fillRGB=this.fillRGB,t},e.prototype.destroy=function(){this.fillColor=void 0,this.fillRGB=void 0},e}(),ge=function(){function e(){}return Object.defineProperty(e.prototype,"chartLayoutLeft",{get:function(){return this.layoutX},set:function(e){this.layoutX=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"chartLayoutTop",{get:function(){return this.layoutY},set:function(e){this.layoutY=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.layoutX=this.layoutX,t.layoutY=this.layoutY,t},e.prototype.destroy=function(){this.layoutX=void 0,this.layoutY=void 0},e}(),fe=function(){function e(){this.chartTitleArea=new ce}return Object.defineProperty(e.prototype,"majorTick",{get:function(){return this.majorTickMark},set:function(e){this.majorTickMark=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minorTick",{get:function(){return this.minorTickMark},set:function(e){this.minorTickMark=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tickPosition",{get:function(){return this.tickLabelPostion},set:function(e){this.tickLabelPostion=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minorGridLines",{get:function(){return this.hasMinorGridLines},set:function(e){this.hasMinorGridLines=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"majorGridLines",{get:function(){return this.hasMajorGridLines},set:function(e){this.hasMajorGridLines=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"interval",{get:function(){return this.majorUnit},set:function(e){this.majorUnit=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"max",{get:function(){return this.maximumValue},set:function(e){this.maximumValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"min",{get:function(){return this.minimumValue},set:function(e){this.minimumValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"categoryAxisTitle",{get:function(){return this.title},set:function(e){this.title=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"categoryAxisType",{get:function(){return this.categoryType},set:function(e){this.categoryType=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"categoryNumberFormat",{get:function(){return this.numberFormat},set:function(e){this.numberFormat=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"axisFontSize",{get:function(){return this.fontSize},set:function(e){this.fontSize=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"axisFontName",{get:function(){return this.fontName},set:function(e){this.fontName=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.title=this.title,t.categoryType=this.categoryType,t.numberFormat=this.numberFormat,t.fontSize=this.fontSize,t.fontName=this.fontName,t.hasMajorGridLines=this.hasMajorGridLines,t.hasMinorGridLines=this.hasMinorGridLines,t.minimumValue=this.minimumValue,t.maximumValue=this.maximumValue,t.majorUnit=this.majorUnit,t.majorTickMark=this.majorTickMark,t.minorTickMark=this.minorTickMark,t.tickLabelPostion=this.tickLabelPostion,t.chartTitleArea=this.chartTitleArea.clone(),t},e.prototype.destroy=function(){this.title=void 0,this.categoryType=void 0,this.numberFormat=void 0,this.chartTitleArea=void 0,this.minimumValue=void 0,this.maximumValue=void 0,this.fontSize=void 0,this.fontName=void 0,this.majorUnit=void 0,this.majorTickMark=void 0,this.minorTickMark=void 0,this.tickLabelPostion=void 0},e}(),me=function(){function e(){}return Object.defineProperty(e.prototype,"showSeriesKeys",{get:function(){return this.isSeriesKeys},set:function(e){this.isSeriesKeys=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasHorzBorder",{get:function(){return this.isHorzBorder},set:function(e){this.isHorzBorder=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasVertBorder",{get:function(){return this.isVertBorder},set:function(e){this.isVertBorder=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasBorders",{get:function(){return this.isBorders},set:function(e){this.isBorders=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.isSeriesKeys=this.isSeriesKeys,t.isHorzBorder=this.isHorzBorder,t.isVertBorder=this.isVertBorder,t.isBorders=this.isBorders,t},e.prototype.destroy=function(){this.isSeriesKeys=void 0,this.isHorzBorder=void 0,this.isVertBorder=void 0,this.isBorders=void 0},e}(),ve=function(e){function t(t){var i=e.call(this)||this;return i.commentType=0,i.commentId="",i.commentType=t,i}return h(t,e),Object.defineProperty(t.prototype,"comment",{get:function(){return this.commentInternal},set:function(e){this.commentInternal=e},enumerable:!0,configurable:!0}),t.prototype.getLength=function(){return 1},t.prototype.clone=function(){var e=new t(this.commentType);return e.commentId=this.commentId,e.commentType=this.commentType,i.i(o.isNullOrUndefined)(this.commentInternal)||(e.commentInternal=this.commentInternal.clone()),e},t.prototype.renderCommentMark=function(e,t){var n=this.line.paragraph.bodyWidget.page.documentHelper,r=n.render.commentMarkDictionary;if(0===this.commentType&&i.i(o.isNullOrUndefined)(this.commentMark)){this.commentMark=document.createElement("div"),this.commentMark.style.display="none",this.commentMark.classList.add("e-de-cmt-mark");var s=document.createElement("span");s.classList.add("e-icons"),s.classList.add("e-de-cmt-mark-icon"),this.commentMark.appendChild(s)}this.line&&i.i(o.isNullOrUndefined)(this.commentMark.parentElement)&&(n.pageContainer.appendChild(this.commentMark),this.commentMark.addEventListener("click",this.selectComment.bind(this)));for(var a,l=!1,d=0;d<r.length;d++)if(this.elementsOverlap(r.keys[d],e,t)){l=!0,a=r.keys[d];break}if(l){for(var h=!0,d=0;d<r.get(a).length;d++)if(r.get(a)[d]===this){h=!1;break}h&&r.get(a).push(this)}else r.add(this.commentMark,[this]);for(var d=0;d<r.length;d++){var c=r.keys[d];if(1==r.get(c).length&&r.get(c)[0].commentMark&&r.get(c)[0].commentMark.firstElementChild.classList.contains("e-de-multi-cmt-mark")&&i.i(o.classList)(r.get(c)[0].commentMark.firstElementChild,["e-de-cmt-mark-icon"],["e-de-multi-cmt-mark"]),r.get(c).length>1)for(var p=0;p<r.get(c).length;p++)r.get(c)[p].commentMark&&r.get(c)[p].commentMark.firstElementChild.classList.contains("e-de-cmt-mark-icon")&&i.i(o.classList)(r.get(c)[p].commentMark.firstElementChild,["e-de-multi-cmt-mark"],["e-de-cmt-mark-icon"])}},t.prototype.elementsOverlap=function(e,t,i){var n=e.offsetWidth,r=e.offsetHeight,o=parseFloat(e.style.top),s=parseFloat(e.style.left),a=o+r,l=s+n,d=parseFloat(t),h=parseFloat(i),c=d+r,p=h+n;return!(o>c||l<h||a<d||s>p)},t.prototype.selectComment=function(){for(var e=this.line.paragraph.bodyWidget.page.documentHelper,t=e.render.commentMarkDictionary,i=this.commentMark.style.top,n=this.commentMark.style.left,r=0,o=[],s=0;s<t.keys.length;s++)if(this.elementsOverlap(t.keys[s],i,n)){o=t.get(t.keys[s]);break}if(e.owner.documentHelper.currentSelectedComment){for(var s=0;s<o.length;s++)if(o[s].comment===e.owner.documentHelper.currentSelectedComment){r=s;break}r<o.length-1?r+=1:r=0}else r=0;e.owner&&(e.owner.commentReviewPane.commentPane.isEditMode?e.owner.showComments=!0:e.selectComment(o[r].comment))},t.prototype.removeCommentMark=function(){this.commentMark&&this.commentMark.parentElement&&(this.commentMark.removeEventListener("click",this.selectComment.bind(this)),this.commentMark.parentElement.removeChild(this.commentMark))},t.prototype.destroy=function(){this.commentMark&&this.removeCommentMark(),this.commentMark=void 0,this.commentInternal=void 0,this.commentId=void 0,e.prototype.componentDestroy.call(this)},t}(P),ye=function(e){function t(t){var i=e.call(this,0)||this;return i.authorIn="",i.initialIn="",i.done=!1,i.textIn="",i.isReply=!1,i.ownerComment=void 0,i.createdDate=t,i.replyComments=[],i}return h(t,e),Object.defineProperty(t.prototype,"commentStart",{get:function(){return this.commentStartIn},set:function(e){this.commentStartIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"commentEnd",{get:function(){return this.commentEndIn},set:function(e){this.commentEndIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"author",{get:function(){return this.authorIn},set:function(e){this.authorIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"initial",{get:function(){return this.initialIn},set:function(e){this.initialIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isResolved",{get:function(){return this.done},set:function(e){this.done=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"date",{get:function(){return this.createdDate},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this.textIn},set:function(e){this.textIn=e},enumerable:!0,configurable:!0}),t.prototype.getLength=function(){return 1},t.prototype.clone=function(){var e=new t(this.date);return e.author=this.author,e.initial=this.initial,e.commentId=this.commentId,e.replyComments=this.replyComments,e.isResolved=this.isResolved,e.text=this.text,e},t.prototype.destroy=function(){if(this.replyComments&&this.replyComments.length>0){for(var t=0;t<this.replyComments.length;t++){this.replyComments[t].destroy()}this.replyComments=[]}this.replyComments=void 0,this.commentStartIn&&(this.commentStartIn.destroy(),this.commentStartIn=void 0),this.commentEndIn&&(this.commentEndIn.destroy(),this.commentEndIn=void 0),this.commentId=void 0,this.createdDate=void 0,this.initialIn=void 0,this.textIn=void 0,this.authorIn=void 0,this.ownerComment=void 0,e.prototype.destroy.call(this)},t}(ve),we=function(){function e(e){this.boundingRectangle=new c(96,96,816,1056),this.repeatHeaderRowTableWidget=!1,this.bodyWidgets=[],this.headerWidgetIn=void 0,this.footerWidgetIn=void 0,this.footnoteWidget=void 0,this.endnoteWidget=void 0,this.currentPageNum=1,this.allowNextPageRendering=!0,this.documentHelper=e}return Object.defineProperty(e.prototype,"headerWidget",{get:function(){return!i.i(o.isNullOrUndefined)(this.headerWidgetIn)&&this.headerWidgetIn.parentHeaderFooter?this.headerWidgetIn.parentHeaderFooter:this.headerWidgetIn},set:function(e){this.headerWidgetIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"footerWidget",{get:function(){return!i.i(o.isNullOrUndefined)(this.footerWidgetIn)&&this.footerWidgetIn.parentHeaderFooter?this.footerWidgetIn.parentHeaderFooter:this.footerWidgetIn},set:function(e){this.footerWidgetIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return this.documentHelper?this.documentHelper.pages.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousPage",{get:function(){var e=this.index;if(e>0)return this.documentHelper.pages[e-1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextPage",{get:function(){var e=this.index;if(e<this.documentHelper.pages.length-1)return this.documentHelper.pages[e+1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sectionIndex",{get:function(){return this.bodyWidgets.length>0?this.bodyWidgets[0].index:-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.headerWidget&&this.headerWidget.page===this&&(this.headerWidget.page=void 0),this.footerWidget&&this.footerWidget.page===this&&(this.footerWidget.page=void 0),this.headerWidgetIn&&!i.i(o.isNullOrUndefined)(this.headerWidgetIn.parentHeaderFooter)&&(this.viewer&&this.documentHelper.owner.editor&&(this.documentHelper.owner.editor.removeFieldInWidget(this.headerWidgetIn),this.documentHelper.owner.editor.removeFieldInWidget(this.headerWidgetIn,!1,!0)),this.headerWidgetIn.destroy(),this.headerWidget=void 0),this.footerWidgetIn&&!i.i(o.isNullOrUndefined)(this.footerWidgetIn.parentHeaderFooter)&&(this.viewer&&this.documentHelper.owner.editor&&(this.documentHelper.owner.editor.removeFieldInWidget(this.footerWidgetIn),this.documentHelper.owner.editor.removeFieldInWidget(this.footerWidgetIn,!1,!0)),this.footerWidgetIn.destroy(),this.footerWidgetIn=void 0),this.bodyWidgets=[],this.bodyWidgets=void 0,i.i(o.isNullOrUndefined)(this.documentHelper)||i.i(o.isNullOrUndefined)(this.documentHelper.pages)||this.documentHelper.removePage(this),this.documentHelper=void 0},e.prototype.componentDestroy=function(){if(this.headerWidgetIn&&(this.headerWidgetIn.componentDestroy(),this.headerWidgetIn=void 0),this.footerWidgetIn&&(this.footerWidgetIn.componentDestroy(),this.footerWidgetIn=void 0),this.bodyWidgets){for(var e=0;e<this.bodyWidgets.length;e++){this.bodyWidgets[e].componentDestroy()}this.bodyWidgets=[],this.bodyWidgets=void 0}this.documentHelper=void 0},e}(),be=function(){function e(){this.tableColumns=[],this.tableWidth=0}return Object.defineProperty(e.prototype,"columns",{get:function(){return this.tableColumns},enumerable:!0,configurable:!0}),e.prototype.resetColumns=function(){for(var e=0;e<this.tableColumns.length;e++)this.tableColumns[e].destroy();this.tableColumns=[]},e.prototype.getPreviousSpannedCellWidth=function(e,t){for(var i=0,n=e;n<t;n++)i+=this.tableColumns[n].preferredWidth;return i},e.prototype.addColumns=function(e,t,i,n,r,o){for(var s=this.columns.length;s<t;s++)this.columns.push(new xe);for(var a=0,l=e;l<t;l++)a+=this.columns[l].preferredWidth;!(t-e>1)&&a<i&&(this.columns[t-1].preferredWidth+=i-a),n.minimumWordWidth>this.columns[t-1].minimumWordWidth&&(this.columns[t-1].minimumWordWidth=n.minimumWordWidth),n.maximumWordWidth>this.columns[t-1].maximumWordWidth&&(this.columns[t-1].maximumWordWidth=n.maximumWordWidth),n.minimumWidth>this.columns[t-1].minimumWidth&&(this.columns[t-1].minimumWidth=n.minimumWidth),r>this.columns[t-1].endOffset&&(this.columns[t-1].endOffset=r),this.columns[t-1].widthType=o},e.prototype.getTotalWidth=function(e){for(var t=0,i=0;i<this.columns.length;i++){var n=this.columns[i];t+=0===e?n.preferredWidth:1===e?n.minimumWordWidth:2===e?n.maximumWordWidth:n.minimumWidth}return t},e.prototype.isFitColumns=function(e,t,i){var n=this.getTotalWidth(0);if(this.tableWidth=i&&t>n?n:t,n!==this.tableWidth){var r=this.tableWidth/n;r=isNaN(r)||r===1/0?1:r;for(var o=0;o<this.columns.length;o++){var s=this.columns[o];if(r*s.preferredWidth<s.minWidth)return!1}return!0}return!0},e.prototype.isAllColumnHasPointWidthType=function(){for(var e=!0,t=0;t<this.columns.length;t++)"Point"!=this.columns[t].widthType&&(e=!1);return e},e.prototype.autoFitColumn=function(e,t,n,r,s,a,l,d){for(var h=0,c=0,p=0,u=!0,g=0,f=[],m=0;m<this.columns.length;m++){var v=this.columns[m];0===v.minimumWordWidth&&0===v.maximumWordWidth&&0===v.minWidth&&(v.minimumWordWidth=v.preferredWidth,v.maximumWordWidth=v.preferredWidth,v.minWidth=v.preferredWidth),"Point"!==v.widthType&&(u=!1);var y=0;h+=v.preferredWidth>v.maximumWordWidth?v.preferredWidth:v.maximumWordWidth,c+=v.preferredWidth>v.minimumWordWidth?v.preferredWidth:v.minimumWordWidth;var w=0===v.preferredWidth?v.minimumWordWidth:v.preferredWidth>v.minimumWordWidth?v.preferredWidth:v.minimumWordWidth;y=v.maximumWordWidth-w,p+=y>0?y:0,v.preferredWidth<v.minimumWordWidth?g+=v.minimumWordWidth-v.preferredWidth:f.push(m)}if(h<=t){for(var m=0;m<this.columns.length;m++){var v=this.columns[m];"Point"!==v.widthType?v.preferredWidth<v.maximumWordWidth&&(v.preferredWidth=v.maximumWordWidth):v.preferredWidth<v.minimumWordWidth&&(v.preferredWidth=v.minimumWordWidth)}n||this.fitColumns(e,t,n,s)}else{var b=this.getTotalWidth(0);if(u&&!a&&c>e&&(e>b&&(g-=e-b),f.length>0&&g>0)){for(var x=g/f.length,m=0;m<this.columns.length;m++){var v=this.columns[m];-1===f.indexOf(m)?v.preferredWidth=v.minimumWordWidth:v.preferredWidth=v.preferredWidth-x}b=this.getTotalWidth(0)}if(!n){var C=!1;return t<c&&c+(i.i(o.isNullOrUndefined)(l)?0:l)<e&&(C=!0),void this.fitColumns(e,C?c:t,n,s)}if(c<=t||c<=e){var I=e>t?e:t;I-=c;for(var m=0;m<this.columns.length;m++){var v=this.columns[m];if("Point"!==v.widthType){0===v.preferredWidth?v.preferredWidth=v.minimumWordWidth:v.preferredWidth<v.minimumWordWidth&&(v.preferredWidth=v.minimumWordWidth);var y=v.maximumWordWidth-v.preferredWidth;y=y>0?y:0;var F=I*(y/p);v.preferredWidth+=isNaN(F)?0:F}}}else{var k=this.getTotalWidth(1),P=this.getTotalWidth(3);if(P>2112)for(var T=2112/this.columns.length,m=0;m<this.columns.length;m++)this.columns[m].preferredWidth=T;else{var I=0;if(P<e&&e-P>=1&&!u||u&&!a&&k>e){I=e-P;for(var m=0;m<this.columns.length;m++){var v=this.columns[m],F=I*v.minimumWordWidth/k;F=isNaN(F)?0:F,v.preferredWidth=(0==v.minimumWidth?1:v.minimumWidth)+F}}else if(b>e)for(var F=e/b,m=0;m<this.columns.length;m++){var v=this.columns[m];v.preferredWidth=v.preferredWidth*F}}}}this.tableWidth=this.getTotalWidth(0)},e.prototype.getValidColumnIndex=function(e){for(var t=0,i=0;i<this.columns.length;i++){var n=this.columns[i];if(i<e)t=n.endOffset;else{if(t!==n.endOffset)break;e++}}return e},e.prototype.fitColumns=function(e,t,n,r,s){i.i(o.isNullOrUndefined)(s)&&(s=0);var a=this.getTotalWidth(0);if(n&&(a-=s),this.tableWidth=n?a:t,a!==this.tableWidth){var l=this.tableWidth/a;l=isNaN(l)||l===1/0?1:l;for(var d=0;d<this.columns.length;d++){var h=this.columns[d];if("Percent"===h.widthType&&!n&&!r&&a>this.tableWidth){if(0!==d&&h.endOffset>this.tableWidth){var c=this.getCellWidth(0,d+1,t);c>this.tableWidth&&(h.preferredWidth-=c-this.tableWidth,(0===h.preferredWidth||h.preferredWidth<h.minimumWidth)&&(h.preferredWidth=h.minimumWidth>0?h.minimumWidth:1,this.columns[0].preferredWidth-=h.preferredWidth))}}else h.preferredWidth=l*h.preferredWidth}}},e.prototype.getCellWidth=function(e,t,i){for(var n=0,r=0;r<t;r++)n+=this.tableColumns[r+e].preferredWidth;return n},e.prototype.validateColumnWidths=function(){for(var e=0;e<this.columns.length;e++)0===e?this.columns[e].preferredWidth!==this.columns[e].endOffset&&(this.columns[e].preferredWidth=this.columns[e].endOffset):this.columns[e-1].endOffset+this.columns[e].preferredWidth<this.columns[e].endOffset&&(0===this.columns[e-1].endOffset?this.columns[e].preferredWidth=this.columns[e].endOffset-this.getPreviousValidOffset(e-2):this.columns[e].preferredWidth=this.columns[e].endOffset-this.columns[e-1].endOffset)},e.prototype.getPreviousValidOffset=function(e){for(var t=e;t>=0;t--)if(0!==this.columns[t].endOffset)return this.columns[t].endOffset;return 0},e.prototype.clone=function(){var t=new e;t.tableWidth=this.tableWidth;for(var i=0;i<this.columns.length;i++)t.columns.push(this.columns[i].clone());return t},e.prototype.destroy=function(){if(!i.i(o.isNullOrUndefined)(this.tableColumns))for(var e=0;e<this.tableColumns.length;e++){var t=this.tableColumns[e];t.destroy()}this.tableColumns=[],this.tableColumns=void 0,this.tableWidth=void 0},e}(),xe=function(){function e(){this.preferredWidth=0,this.minWidth=0,this.maxWidth=0,this.endOffset=0,this.minimumWordWidth=0,this.maximumWordWidth=0,this.minimumWidth=0}return e.prototype.clone=function(){var t=new e;return t.preferredWidth=this.preferredWidth,t.minWidth=this.minWidth,t.maxWidth=this.maxWidth,t},e.prototype.destroy=function(){this.preferredWidth=void 0,this.minWidth=void 0,this.maxWidth=void 0},e}(),Ce=function(){function e(){this.minimumWordWidth=0,this.maximumWordWidth=0,this.minimumWidth=0,this.hasMinimumWidth=!1,this.hasMinimumWordWidth=!1,this.hasMaximumWordWidth=!1}return e}(),Ie=function(){function e(){}return e}(),Fe=function(e){function t(){return e.call(this)||this}return h(t,e),t.prototype.clone=function(){var t=e.prototype.clone.call(this);return t.breakClearType=this.breakClearType,t},t.prototype.destroy=function(){this.breakClearType=void 0,e.prototype.destroy.call(this)},t.prototype.componentDestroy=function(){this.breakClearType=void 0,e.prototype.componentDestroy.call(this)},t}(E),ke=function(){function e(){}return e}()},function(e,i){e.exports=t},function(e,t,i){"use strict";i.d(t,"a",function(){return a}),i.d(t,"b",function(){return l}),i.d(t,"c",function(){return d}),i.d(t,"d",function(){return h});var n=i(0),r=(i.n(n),i(33)),o=(i.n(r),i(2)),s=i(1),a=function(){function e(){}return e.insert=function(e,t,i){return t>=0?[e.slice(0,t)+i+e.slice(t)].join(""):i+this},e.replaceSpecialChars=function(e){return e=e.replace("^[\\s]*",""),e=e.replace("^[#@!~\\$%^&\\*\\(\\)\\-_\\+\\.=\\{\\}\\[\\]:;,<>\\?'\\\\\"\\\\\\//0123456789]+",""),e=e.replace("[#@!~\\$%^&\\*\\(\\)\\-_\\+\\.=\\{\\}\\[\\]:;,<>\\?'\\\\\"\\\\\\//0123456789]+$","")},e.getSpellCheckData=function(e){e=e.replace("\r\n"," "),e=e.replace("\n"," "),e=e.replace("\r"," "),e=e.replace("\v"," "),e=e.replace("\t"," "),e=e.replace("/"," ");for(var t=e.split(" "),i=[],n=0,r=t;n<r.length;n++){var o=r[n],s={};s.Text=this.replaceSpecialChars(o),s.HasSpellError=!1,i.push(s)}return i},e.checkTextFormat=function(e){var t=/^(M{0,3})(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})$/i,i=/^[0-9]+$/;return!(!t.test(e)&&!i.test(e))},e.sanitizeString=function(e){return i.i(n.isNullOrUndefined)(e)?"":n.SanitizeHtmlHelper.sanitize(e).replace(/&amp;/g,"&").replace(/&nbsp;/g,String.fromCharCode(160)).replace(/&gt;/g,">").replace(/&lt;/g,"<")},e.getSfdtDocument=function(e){if(e=e instanceof Object?e:JSON.parse(e),!i.i(n.isNullOrUndefined)(e.sfdt)){var t=new r.ZipArchive;t.open(JSON.stringify(e.sfdt));var o=t.items[0],s=new Uint8Array(o.data),a=new TextDecoder("utf-8").decode(s);e=JSON.parse(a)}return e},e.generateUniqueId=function(e,t){var r=!i.i(n.isNullOrUndefined)(t),o=Math.floor(1e8*Math.random());return r?this.isSameListIDExists(o,void 0,t,r)?this.generateUniqueId(void 0,t):o:this.isSameListIDExists(o,e)?this.generateUniqueId(e):o},e.isSameListIDExists=function(e,t,i,n){if(n)for(var r=0;r<i.length;r++){var o=i[parseInt(r.toString(),10)];if(e==o.nsid)return!0}else for(var s=0;s<t.length;s++){var a=t[parseInt(s.toString(),10)];if(e==a.nsid)return!0}return!1},e.remove=function(e,t){return 0===t?e.substring(t+1,e.length):e.substring(0,t)+e.substring(t+1,e.length)},e.indexOfAny=function(e,t){for(var r=void 0,o=0;o<t.length;o++){var s=e.indexOf(t[parseInt(o.toString(),10)]);-1!==s&&i.i(n.isNullOrUndefined)(r)?r=s:-1!==s&&s<r&&(r=s)}return i.i(n.isNullOrUndefined)(r)?-1:r},e.lastIndexOfAny=function(e,t){for(var i=e.length-1;i>=0;i--)for(var n=0;n<=t.length-1;n++)if(e[parseInt(i.toString(),10)]===t[parseInt(n.toString(),10)])return i;return-1},e.convertArgbToRgb=function(e){return e.length>=8?e.substr(0,6):e},e.convertRgbToHex=function(e){var t=Number(e).toString(16);return t.length<2&&(t="0"+t),t},e.getNumberFromString=function(e){for(var t=[],i="",n=0,r=e;n<r.length;n++){var o=r[n];/\d|\./.test(o)?i+=o:i&&(t.push(parseFloat(i)),i="")}return i&&t.push(parseFloat(i)),parseFloat(t.join(""))},e.convertHexToRgb=function(e){var t,i,n;if(e){e=e.replace(/[^0-9A-F]/gi,"");var r=parseInt(e,16);return 8===e.length?(t=r>>32&255,i=r>>16&255,n=r>>8&255):6===e.length&&(t=r>>16&255,i=r>>8&255,n=255&r),{r:t,g:i,b:n}}},e.addCssStyle=function(e){var t=document.createElement("style");t.style.cssText?t.style.cssText=e:t.appendChild(document.createTextNode(e)),document.getElementsByTagName("head")[0].appendChild(t)},e.convertNodeListToArray=function(e){var t=[];if(!i.i(n.isNullOrUndefined)(e))for(var r=0;r<e.length;r++)t.push(e[parseInt(r.toString(),10)]);return t},e.getHighlightColorCode=function(e){var t="#ffffff";switch(e){case"Yellow":t="#ffff00";break;case"BrightGreen":t="#00ff00";break;case"Turquoise":t="#00ffff";break;case"Pink":t="#ff00ff";break;case"Blue":t="#0000ff";break;case"Red":t="#ff0000";break;case"DarkBlue":t="#000080";break;case"Teal":t="#008080";break;case"Green":t="#008000";break;case"Violet":t="#800080";break;case"DarkRed":t="#800000";break;case"DarkYellow":t="#808000";break;case"Gray50":t="#808080";break;case"Gray25":t="#c0c0c0";break;case"Black":t="#000000"}return t},e.isVeryDark=function(e){var t=e.substring(1);return(299*parseInt(t.substr(0,2),16)+587*parseInt(t.substr(2,2),16)+114*parseInt(t.substr(4,2),16))/1e3<=60},e.getColor=function(e){return e.length>0&&"#"===e[0]&&e.length>7?e.substr(0,7):e},e.getTextVerticalAlignment=function(e){switch(e){case 0:return"Top";case 1:return"Center";case 2:return"Bottom";default:return e}},e.convertPointToPixel=function(t){return t=e.round(t,5),e.round(96*t/72,5)},e.convertPixelToPoint=function(t){return e.round(72*t/96,5)},e.isLinkedFieldCharacter=function(e){return e instanceof o.b&&0===e.fieldType?!i.i(n.isNullOrUndefined)(e.fieldEnd):e instanceof o.b&&2===e.fieldType?!i.i(n.isNullOrUndefined)(e.fieldBegin)&&!i.i(n.isNullOrUndefined)(e.fieldEnd):!i.i(n.isNullOrUndefined)(e.fieldBegin)},e.removeSpace=function(e){if(!i.i(n.isNullOrUndefined)(e)&&0!==e.length)for(var t=0;t<e.length;t++)" "===e.charAt(t)&&(e=e.replace(" ",""));return e},e.trimStart=function(e){var t=0;for(t;t<e.length&&" "===e[parseInt(t.toString(),10)];t++);return e.substring(t,e.length)},e.trimEnd=function(e){var t=e.length-1;for(t;t>=0&&" "===e[parseInt(t.toString(),10)];t--);return e.substring(0,t+1)},e.endsWith=function(e){return!i.i(n.isNullOrUndefined)(e)&&0!==e.length&&" "===e[e.length-1]},e.addSpace=function(e){var t="";if(e>0)for(var i=0;i<e;i++)t+=" ";return t},e.getBoolValue=function(e){return e?1:0},e.getBoolInfo=function(e,t){return 1===t?this.getBoolValue(e):e},e.parseBoolValue=function(e){return e instanceof String?!i.i(n.isNullOrUndefined)(e)&&"f"!==e&&"0"!==e&&"off"!==e&&"false"!==e:1==e},e.getBaselineAlignmentEnumValue=function(e){switch(e){case"Normal":return 0;case"Superscript":return 1;case"Subscript":return 2}},e.getUnderlineEnumValue=function(e){switch(e){case"None":return 0;case"Single":return 1;case"Words":return 2;case"Double":return 3;case"Dotted":return 4;case"Thick":return 5;case"Dash":return 6;case"DashLong":return 7;case"DotDash":return 8;case"DotDotDash":return 9;case"Wavy":return 10;case"DottedHeavy":return 11;case"DashHeavy":return 12;case"DashLongHeavy":return 13;case"DotDashHeavy":return 14;case"DotDotDashHeavy":return 15;case"WavyHeavy":return 16;case"WavyDouble":return 17}},e.getStrikeThroughEnumValue=function(e){switch(e){case"None":return 0;case"SingleStrike":return 1;case"DoubleStrike":return 2}},e.getHighlightColorEnumValue=function(e){switch(e){case"NoColor":return 0;case"Yellow":return 1;case"BrightGreen":return 2;case"Turquoise":return 3;case"Pink":return 4;case"Blue":return 5;case"Red":return 6;case"DarkBlue":return 7;case"Teal":return 8;case"Green":return 9;case"Violet":return 10;case"DarkRed":return 11;case"DarkYellow":return 12;case"Gray50":return 13;case"Gray25":return 14;case"Black":return 15}},e.getBiDirectionalOverride=function(e){switch(e){case"None":return 0;case"LTR":return 1;case"RTL":return 2}},e.getBreakClearType=function(e){switch(e){case"None":return 0;case"Left":return 1;case"Right":return 2;case"All":return 3}},e.getOutlineLevelEnumValue=function(e){switch(e){case"BodyText":return 0;case"Level1":return 1;case"Level2":return 2;case"Level3":return 3;case"Level4":return 4;case"Level5":return 5;case"Level6":return 6;case"Level7":return 7;case"Level8":return 8;case"Level9":return 9}},e.getTextAlignmentEnumValue=function(e){switch(e){case"Left":return 0;case"Center":return 1;case"Right":return 2;case"Justify":return 3}},e.getLineStyleEnumValue=function(e){switch(e){case"Single":return 0;case"None":return 1;case"Dot":return 2;case"DashSmallGap":return 3;case"DashLargeGap":return 4;case"DashDot":return 5;case"DashDotDot":return 6;case"Double":return 7;case"Triple":return 8;case"ThinThickSmallGap":return 9;case"ThickThinSmallGap":return 10;case"ThinThickThinSmallGap":return 11;case"ThinThickMediumGap":return 12;case"ThickThinMediumGap":return 13;case"ThinThickThinMediumGap":return 14;case"ThinThickLargeGap":return 15;case"ThickThinLargeGap":return 16;case"ThinThickThinLargeGap":return 17;case"SingleWavy":return 18;case"DoubleWavy":return 19;case"DashDotStroked":return 20;case"Emboss3D":return 21;case"Engrave3D":return 22;case"Outset":return 23;case"Inset":return 24;case"Thick":return 25;case"Cleared":return 26}},e.getLineSpacingTypeEnumValue=function(e){switch(e){case"Multiple":return 0;case"AtLeast":return 1;case"Exactly":return 2}},e.writeBorder=function(t,i){var n={};return n[s._221[i]]=t.hasValue("color")?t.color:void 0,n[s._137[i]]=t.hasValue("hasNoneStyle")?e.getBoolInfo(t.hasNoneStyle,i):void 0,n[s._142[i]]=t.hasValue("lineStyle")?1==i?this.getLineStyleEnumValue(t.lineStyle):t.lineStyle:void 0,n[s._143[i]]=t.hasValue("lineWidth")?t.lineWidth:void 0,n[s._136[i]]=t.hasValue("shadow")?e.getBoolInfo(t.shadow,i):void 0,n[s._350[i]]=t.hasValue("space")?t.space:void 0,n},e.writeBorders=function(e,t){var i={};return i[s._229[t]]=this.writeBorder(e.getBorder("top"),t),i[s._232[t]]=this.writeBorder(e.getBorder("left"),t),i[s._231[t]]=this.writeBorder(e.getBorder("right"),t),i[s._230[t]]=this.writeBorder(e.getBorder("bottom"),t),i[s._139[t]]=this.writeBorder(e.getBorder("horizontal"),t),i[s._138[t]]=this.writeBorder(e.getBorder("vertical"),t),i},e.writeParagraphFormat=function(t,r,o,a){a=i.i(n.isNullOrUndefined)(a)?0:a,t[s._85[a]]=this.writeBorders(o.borders,a),t[s._69[a]]=r?o.leftIndent:o.getValue("leftIndent"),t[s._70[a]]=r?o.rightIndent:o.getValue("rightIndent"),t[s._71[a]]=r?o.firstLineIndent:o.getValue("firstLineIndent"),t[s._72[a]]=r?1==a?this.getTextAlignmentEnumValue(o.textAlignment):o.textAlignment:1==a?this.getTextAlignmentEnumValue(o.getValue("textAlignment")):o.getValue("textAlignment"),t[s._74[a]]=r?o.beforeSpacing:o.getValue("beforeSpacing"),t[s._73[a]]=r?o.afterSpacing:o.getValue("afterSpacing"),t[s._76[a]]=r?e.getBoolInfo(o.spaceBeforeAuto,a):o.getValue("spaceBeforeAuto"),t[s._75[a]]=r?e.getBoolInfo(o.spaceAfterAuto,a):o.getValue("spaceAfterAuto"),t[s._77[a]]=r?o.lineSpacing:o.getValue("lineSpacing"),t[s._78[a]]=r?1==a?this.getLineSpacingTypeEnumValue(o.lineSpacingType):o.lineSpacingType:1==a?this.getLineSpacingTypeEnumValue(o.getValue("lineSpacingType")):o.getValue("lineSpacingType"),t[s._51[a]]=i.i(n.isNullOrUndefined)(o.baseStyle)?void 0:o.baseStyle.name,t[s._83[a]]=r?1==a?this.getOutlineLevelEnumValue(o.outlineLevel):o.outlineLevel:1==a?this.getOutlineLevelEnumValue(o.getValue("outlineLevel")):o.getValue("outlineLevel"),t[s._52[a]]=r?e.getBoolInfo(o.bidi,a):o.getValue("bidi"),t[s._82[a]]=r?e.getBoolInfo(o.keepLinesTogether,a):o.getValue("keepLinesTogether"),t[s._80[a]]=r?e.getBoolInfo(o.keepWithNext,a):o.getValue("keepWithNext"),t[s._84[a]]=r?e.getBoolInfo(o.contextualSpacing,a):o.getValue("contextualSpacing"),t[s._81[a]]=r?e.getBoolInfo(o.widowControl,a):o.getValue("widowControl")},e.writeCharacterFormat=function(t,r,o,a,l){a=i.i(n.isNullOrUndefined)(a)?0:a,t[s._42[a]]=l?e.getBoolInfo(o.bold,a):r?e.getBoolInfo(o.bold,a):o.getValue("bold"),t[s._43[a]]=l?e.getBoolInfo(o.italic,a):r?e.getBoolInfo(o.italic,a):o.getValue("italic"),t[s._48[a]]=l?o.fontSize:r?this.toWriteInline(o,"fontSize"):o.getValue("fontSize"),t[s._50[a]]=l?o.fontFamily:r?this.toWriteInline(o,"fontFamily"):o.getValue("fontFamily"),t[s._44[a]]=l?o.underline:r?1==a?e.getUnderlineEnumValue(o.underline):o.underline:1==a?e.getUnderlineEnumValue(o.getValue("underline")):o.getValue("underline"),t[s._46[a]]=l?o.strikethrough:r?1==a?e.getStrikeThroughEnumValue(o.strikethrough):o.strikethrough:1==a?e.getStrikeThroughEnumValue(o.getValue("strikethrough")):o.getValue("strikethrough"),t[s._45[a]]=l?o.baselineAlignment:r?1==a?e.getBaselineAlignmentEnumValue(o.baselineAlignment):o.baselineAlignment:1==a?e.getBaselineAlignmentEnumValue(o.getValue("baselineAlignment")):o.getValue("baselineAlignment"),t[s._47[a]]=l?o.highlightColor:r?1==a?e.getHighlightColorEnumValue(o.highlightColor):o.highlightColor:1==a?e.getHighlightColorEnumValue(o.getValue("highlightColor")):o.getValue("highlightColor"),t[s._49[a]]=l?o.fontColor:r?this.toWriteInline(o,"fontColor"):o.getValue("fontColor"),t[s._51[a]]=i.i(n.isNullOrUndefined)(o.baseCharStyle)?void 0:o.baseCharStyle.name,t[s._52[a]]=l?o.bidi:r?e.getBoolInfo(o.bidi,a):o.getValue("bidi"),t[s._53[a]]=l?o.bdo:r?1==a?e.getBiDirectionalOverride(o.bdo):o.bdo:1==a?e.getBiDirectionalOverride(o.getValue("bdo")):o.getValue("bdo"),t[s._57[a]]=l?o.boldBidi:r?e.getBoolInfo(o.boldBidi,a):o.getValue("boldBidi"),t[s._58[a]]=l?o.italicBidi:r?e.getBoolInfo(o.italicBidi,a):o.getValue("italicBidi"),t[s._55[a]]=l?o.fontSizeBidi:r?o.fontSizeBidi:o.getValue("fontSizeBidi"),t[s._56[a]]=l?o.fontFamilyBidi:r?o.fontFamilyBidi:o.getValue("fontFamilyBidi"),t[s._59[a]]=l?o.allCaps:r?e.getBoolInfo(o.allCaps,a):o.getValue("allCaps"),t[s._41[a]]=l?o.localeIdBidi:r?o.localeIdBidi:o.getValue("localeIdBidi"),t[s._60[a]]=l?o.complexScript:r?e.getBoolInfo(o.complexScript,a):o.getValue("complexScript"),t[s._61[a]]=l?o.fontFamilyAscii:r?this.toWriteInline(o,"fontFamilyAscii"):o.getValue("fontFamilyAscii"),t[s._63[a]]=l?o.fontFamilyNonFarEast:r?this.toWriteInline(o,"fontFamilyNonFarEast"):o.getValue("fontFamilyNonFarEast"),t[s._62[a]]=l?o.fontFamilyFarEast:r?this.toWriteInline(o,"fontFamilyFarEast"):o.getValue("fontFamilyFarEast"),t[s._66[a]]=l?o.characterSpacing:r?this.toWriteInline(o,"characterSpacing"):o.getValue("characterSpacing"),t[s._67[a]]=l?o.scaling:r?this.toWriteInline(o,"scaling"):o.getValue("scaling"),(o.hasValue("fontFamily")||l)&&(i.i(n.isNullOrUndefined)(t[s._61[a]])&&(t[s._61[a]]=o.fontFamily),i.i(n.isNullOrUndefined)(t[s._63[a]])&&(t[s._63[a]]=o.fontFamily),i.i(n.isNullOrUndefined)(t[s._62[a]])&&(t[s._62[a]]=o.fontFamily))},e.isThemeFont=function(e){return"majorAscii"==e||"majorBidi"==e||"majorEastAsia"==e||"majorHAnsi"==e||"minorAscii"==e||"minorBidi"==e||"minorEastAsia"==e||"minorHAnsi"==e},e.toWriteInline=function(e,t){return!i.i(n.isNullOrUndefined)(e.ownerBase)&&e.ownerBase instanceof o.c?e.hasValue(t)?e[t]:e.getValue(t):e[t]},e.round=function(e,t){for(var i=e,n=0;n<t;n++)i*=10;i=Math.round(i);for(var n=0;n<t;n++)i/=10;return i},e.removeInvalidXmlChars=function(e){var t=/[^\x09\x0A\x0C\x0D\v\f\r\u000E\x20-\uD7FF\uE000-\uFFFD\u{10000}-\u{10FFFF}]/gu;return e.replace(t,"")},e.reverseString=function(e){if(!i.i(n.isNullOrUndefined)(e)&&""!==e){e=e.split("").reverse().join("")}return e},e.formatClippedString=function(e){var t="",i="";return this.startsWith(e,"data:image/svg+xml;base64,")?(t=".svg",i=e.replace("data:image/svg+xml;base64,","")):this.startsWith(e,"data:image/svg+xml;utf8,")?(t=".svg",i=e.replace("data:image/svg+xml;utf8,","")):this.startsWith(e,"data:image/bmp;base64,")?(t=".bmp",i=e.replace("data:image/bmp;base64,","")):this.startsWith(e,"data:image/x-emf;base64,")?(t=".emf",i=e.replace("data:image/x-emf;base64,","")):this.startsWith(e,"data:image/exif;base64,")?(t=".exif",i=e.replace("data:image/exif;base64,","")):this.startsWith(e,"data:image/gif;base64,")?(t=".gif",i=e.replace("data:image/gif;base64,","")):this.startsWith(e,"data:image/icon;base64,")?(t=".ico",i=e.replace("data:image/icon;base64,","")):this.startsWith(e,"data:image/jpeg;base64,")?(t=".jpeg",i=e.replace("data:image/jpeg;base64,","")):this.startsWith(e,"data:image/jpg;base64,")?(t=".jpg",i=e.replace("data:image/jpg;base64,","")):this.startsWith(e,"data:image/png;base64,")?(t=".png",i=e.replace("data:image/png;base64,","")):this.startsWith(e,"data:image/tiff;base64,")?(t=".tif",i=e.replace("data:image/tiff;base64,","")):this.startsWith(e,"data:image/x-wmf;base64,")?(t=".wmf",i=e.replace("data:image/x-wmf;base64,","")):t=".jpeg",{extension:t,formatClippedString:i}},e.startsWith=function(e,t){return t.length>0&&e.substring(0,t.length)===t},e.formatText=function(e,t){var i=t;switch(e.toLowerCase()){case"uppercase":i=t.toUpperCase();break;case"lowercase":i=t.toLowerCase();break;case"firstlower":i=this.lowerFirstChar(t);break;case"firstcapital":i=this.capitaliseFirst(t,"FirstCapital");break;case"titlecase":i=this.capitaliseFirst(t,"Titlecase")}return i},e.formatNumber=function(e,t){var i=new n.Internationalization;t=t.split(".")[0];var r=i.parseNumber(t);if("NaN"===t.toString())return"";""===e&&(e="0");var o={format:e};return i.formatNumber(r,o)},e.formatDate=function(e,t){var i=new n.Internationalization,r=new Date(t);if(isNaN(r.getDate()))return"";if(""===e)return t;-1!==e.indexOf("am/pm")&&(e=e.replace(/am\/pm/gi,"a"));var o={format:e};return i.formatDate(r,o)},e.capitaliseFirst=function(e,t,i){var n="";if("Titlecase"===t){for(var r=i?e.split(i):e.split(" "),o=0;o<r.length;o++)n+=i?r[parseInt(o.toString(),10)].charAt(0).toUpperCase()+r[parseInt(o.toString(),10)].slice(1,r[parseInt(o.toString(),10)].length):this.capitaliseFirstInternal(r[parseInt(o.toString(),10)]),r.length>=0&&!i&&(n+=" ");i||(n=this.capitaliseFirst(n,"Titlecase","\r"))}else"FirstCapital"===t&&(n=this.capitaliseFirstInternal(e));return n},e.lowerFirstChar=function(e){return e.charAt(0).toLowerCase()+e.slice(1,e.length)},e.capitaliseFirstInternal=function(e){return e.charAt(0).toUpperCase()+e.slice(1,e.length).toLowerCase()},e.getModifiedDate=function(t){var i=e.getLocaleDate(t);return i.toLocaleDateString([],{year:"numeric",month:"long",day:"numeric"})+" "+i.toLocaleTimeString([],{hour:"numeric",minute:"numeric"})},e.getUtcDate=function(){var e=new Date;return new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString()},e.getLocaleDate=function(e){var t=new Date(e);return new Date(t.getTime()+6e4*t.getTimezoneOffset())},e.getCompatibilityModeValue=function(e){var t;switch(e){case 1:t="11";break;case 2:t="12";break;case 3:t="14";break;default:t="15"}return t},e.getUniqueElementId=function(){return"de_element"+Date.now().toString(36)+Math.random().toString(36).substring(2)},e.splitSpaceInTextElementBox=function(t,i){var n=t.text,r="";if(i)for(;e.startsWith(n," ");)r+=" ",n=n.substring(1);else for(;e.endsWith(n);)r+=" ",n=n.slice(0,-1);if(""!=r){var s=new o.d;if(s.characterFormat.copyFormat(t.characterFormat),t.revisions.length>0){for(var a=0;a<t.revisions.length;a++){var l=t.revisions[a];s.revisions.push(l);var d=l.range.indexOf(t);d<0?l.range.push(s):l.range.splice(d+1,0,s)}s.isMarkedForRevision=t.isMarkedForRevision}s.line=t.line;var h=s.line.children;i?(t.text=r,s.text=n):(t.text=n,s.text=r),h.splice(h.indexOf(t)+1,0,s)}},e.getTextIndexAfterWhitespace=function(e,t){var i=e.length,n=0;n=e.indexOf(" ",t)+1;var r=n;if(0===r||r===i)return r;for(;" "===e[r]&&++r!==i;);return r},e.splitWordByMaxLength=function(t,i,n){for(var r=t.text,s=0,a=r.length,l="",d=t.characterFormat,h=t.revisions,c=i.children.indexOf(t);s<a;){var p=s+90;p>a&&(p=a);var u=e.getTextIndexAfterWhitespace(r,p);if((0===u||u>a)&&(u=p),l=r.substring(s,u),0===s)t.text=l;else{var g=new o.d;if(g.text=l,g.line=i,g.characterFormat.copyFormat(d),h.length>0)for(var f=0;f<h.length;f++){var m=h[f];g.revisions.push(m);var v=m.range.indexOf(t);v<0?m.range.push(g):m.range.splice(v+1,0,g)}n?i.children.push(g):(i.children.splice(c+1,0,g),c++)}s=u}},e.wordBefore="\\b",e.wordAfter="\\b",e.wordSplitCharacters=[" ",",",".",":",";","<",">","=","+","-","_","{","}","[","]","`","~","!","@","#","$","%","^","&","*","(",")",'"',"?","/","|","\\","","","","","","",""],e}(),l=function(){function e(e,t){this.xIn=0,this.yIn=0,this.xIn=e,this.yIn=t}return Object.defineProperty(e.prototype,"x",{get:function(){return this.xIn},set:function(e){this.xIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.yIn},set:function(e){this.yIn=e},enumerable:!0,configurable:!0}),e.prototype.copy=function(e){this.xIn=e.xIn,this.yIn=e.yIn},e.prototype.destroy=function(){this.xIn=void 0,this.yIn=void 0},e}(),d=function(){function e(){this.keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}return e.prototype.encodeString=function(e){var t,i,n,r,o,s,a,l="",d=0;for(e=this.unicodeEncode(e);d<e.length;)t=e.charCodeAt(d++),i=e.charCodeAt(d++),n=e.charCodeAt(d++),r=t>>2,o=(3&t)<<4|i>>4,s=(15&i)<<2|n>>6,a=63&n,isNaN(i)?s=a=64:isNaN(n)&&(a=64),l=l+this.keyStr.charAt(r)+this.keyStr.charAt(o)+this.keyStr.charAt(s)+this.keyStr.charAt(a);return l},e.prototype.unicodeEncode=function(e){for(var t=e.replace(/\r\n/g,"\n"),i="",n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?i+=String.fromCharCode(r):r>127&&r<2048?(i+=String.fromCharCode(r>>6|192),i+=String.fromCharCode(63&r|128)):(i+=String.fromCharCode(r>>12|224),i+=String.fromCharCode(r>>6&63|128),i+=String.fromCharCode(63&r|128))}return i},e.prototype.decodeString=function(e){var t,i,n,r,o,s,a,l=0,d=0;e=e.replace(/[^A-Za-z0-9+\/=]/g,"");var h=3*e.length/4;if(e.charAt(e.length-1)===this.keyStr.charAt(64)&&h--,e.charAt(e.length-2)===this.keyStr.charAt(64)&&h--,h%1!=0)throw new Error("Invalid base64 input, bad content length.");for(var c=new Uint8Array(0|h);l<e.length;)r=this.keyStr.indexOf(e.charAt(l++)),o=this.keyStr.indexOf(e.charAt(l++)),s=this.keyStr.indexOf(e.charAt(l++)),a=this.keyStr.indexOf(e.charAt(l++)),t=r<<2|o>>4,i=(15&o)<<4|s>>2,n=(3&s)<<6|a,c[d++]=t,64!==s&&(c[d++]=i),64!==a&&(c[d++]=n);return c},e.prototype.destroy=function(){this.keyStr=void 0},e}(),h=function(){function e(e,t){this.x=0,this.width=0,this.x=e,this.width=t}return Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),e}()},function(e,t){e.exports=i},function(e,t,i){"use strict";i.d(t,"a",function(){return r});var n=i(0),r=(i.n(n),function(){function e(){this.keysInternal=[],this.valuesInternal=[]}return Object.defineProperty(e.prototype,"length",{get:function(){return this.keysInternal.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"keys",{get:function(){return this.keysInternal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"values",{get:function(){return this.valuesInternal},enumerable:!0,configurable:!0}),e.prototype.add=function(e,t){if(i.i(n.isNullOrUndefined)(e))throw new ReferenceError("Provided key or value is not valid.");return this.keysInternal.indexOf(e)<0&&(this.keysInternal.push(e),this.valuesInternal.push(t)),1},e.prototype.get=function(e){if(i.i(n.isNullOrUndefined)(e))throw new ReferenceError("Provided key is not valid.");var t=this.keysInternal.indexOf(e);return t<0||t>this.keysInternal.length-1?void 0:this.valuesInternal[t]},e.prototype.set=function(e,t){if(i.i(n.isNullOrUndefined)(e))throw new ReferenceError("Provided key is not valid.");var r=this.keysInternal.indexOf(e);if(r<0||r>this.keysInternal.length-1)throw new RangeError("No item with the specified key has been added.");this.valuesInternal[r]=t},e.prototype.remove=function(e){if(i.i(n.isNullOrUndefined)(e))throw new ReferenceError("Provided key is not valid.");var t=this.keysInternal.indexOf(e);if(t<0||t>this.keysInternal.length-1)throw new RangeError("No item with the specified key has been added.");return this.keysInternal.splice(t,1),this.valuesInternal.splice(t,1),!0},e.prototype.containsKey=function(e){if(i.i(n.isNullOrUndefined)(e))throw new ReferenceError("Provided key is not valid.");var t=this.keysInternal.indexOf(e);return!(t<0||t>this.keysInternal.length-1)},e.prototype.clear=function(){this.keysInternal=[],this.valuesInternal=[]},e.prototype.destroy=function(){this.clear(),this.keysInternal=void 0,this.valuesInternal=void 0},e}())},function(e,t,i){"use strict";var n=i(114);i.d(t,"Q",function(){return n.a});var r=i(87);i.d(t,"R",function(){return r.a});var o=i(86);i.d(t,"e",function(){return o.a}),i.d(t,"S",function(){return o.b}),i.d(t,"T",function(){return o.c});var s=i(34);i.d(t,"a",function(){return s.a}),i.d(t,"U",function(){return s.d}),i.d(t,"V",function(){return s.e}),i.d(t,"W",function(){return s.f}),i.d(t,"X",function(){return s.g}),i.d(t,"Y",function(){return s.h}),i.d(t,"Z",function(){return s.i}),i.d(t,"_0",function(){return s.j}),i.d(t,"_1",function(){return s.k}),i.d(t,"_2",function(){return s.c}),i.d(t,"_3",function(){return s.l}),i.d(t,"_4",function(){return s.m}),i.d(t,"_5",function(){return s.n}),i.d(t,"_6",function(){return s.o}),i.d(t,"_7",function(){return s.b}),i.d(t,"_8",function(){return s.p}),i.d(t,"_9",function(){return s.q}),i.d(t,"_10",function(){return s.r}),i.d(t,"_11",function(){return s.s}),i.d(t,"_12",function(){return s.t}),i.d(t,"_13",function(){return s.u}),i.d(t,"_14",function(){return s.v});var a=i(110);i.d(t,"h",function(){return a.a}),i.d(t,"l",function(){return a.b}),i.d(t,"_15",function(){return a.c}),i.d(t,"_16",function(){return a.d}),i.d(t,"_17",function(){return a.e}),i.d(t,"_18",function(){return a.f}),i.d(t,"_19",function(){return a.g}),i.d(t,"_20",function(){return a.h}),i.d(t,"_21",function(){return a.i}),i.d(t,"_22",function(){return a.j});var l=i(36);i.d(t,"k",function(){return l.a}),i.d(t,"_23",function(){return l.b}),i.d(t,"_24",function(){return l.c}),i.d(t,"_25",function(){return l.d}),i.d(t,"_26",function(){return l.e}),i.d(t,"_27",function(){return l.f}),i.d(t,"_28",function(){return l.g}),i.d(t,"_29",function(){return l.h}),i.d(t,"_30",function(){return l.i}),i.d(t,"_31",function(){return l.j}),i.d(t,"_32",function(){return l.k});var d=i(9);i.d(t,"f",function(){return d.e}),i.d(t,"g",function(){return d.c}),i.d(t,"E",function(){return d.k}),i.d(t,"F",function(){return d.a}),i.d(t,"G",function(){return d.i}),i.d(t,"H",function(){return d.f}),i.d(t,"I",function(){return d.d}),i.d(t,"J",function(){return d.g}),i.d(t,"K",function(){return d.m}),i.d(t,"M",function(){return d.b}),i.d(t,"N",function(){return d.n}),i.d(t,"O",function(){return d.j}),i.d(t,"_33",function(){return d.p}),i.d(t,"_34",function(){return d.l}),i.d(t,"_35",function(){return d.h}),i.d(t,"_36",function(){return d.o});var h=i(113);i.d(t,"_37",function(){return h.a}),i.d(t,"_38",function(){return h.b}),i.d(t,"_39",function(){return h.c}),i.d(t,"_40",function(){return h.d});var c=i(115);i.d(t,"_41",function(){return c.a}),i.d(t,"_42",function(){return c.b}),i.d(t,"_43",function(){return c.c}),i.d(t,"_44",function(){return c.d});var p=i(118);i.d(t,"P",function(){return p.a}),i.d(t,"_45",function(){return p.b}),i.d(t,"_46",function(){return p.c}),i.d(t,"_47",function(){return p.d}),i.d(t,"_48",function(){return p.e}),i.d(t,"_49",function(){return p.f});var u=i(122);i.d(t,"i",function(){return u.a}),i.d(t,"j",function(){return u.b}),i.d(t,"L",function(){return u.c}),i.d(t,"_50",function(){return u.d}),i.d(t,"_51",function(){return u.e}),i.d(t,"_52",function(){return u.f}),i.d(t,"_53",function(){return u.g}),i.d(t,"_54",function(){return u.h}),i.d(t,"_55",function(){return u.i}),i.d(t,"_56",function(){return u.j}),i.d(t,"_57",function(){return u.k}),i.d(t,"_58",function(){return u.l}),i.d(t,"_59",function(){return u.m}),i.d(t,"_60",function(){return u.n}),i.d(t,"_61",function(){return u.o}),i.d(t,"_62",function(){return u.p});var g=i(124);i.d(t,"_63",function(){return g.a});var f=i(125);i.d(t,"_64",function(){return f.a}),i.d(t,"_65",function(){return f.b});var m=i(129);i.d(t,"_66",function(){return m.a}),i.d(t,"_67",function(){return m.b}),i.d(t,"_68",function(){return m.c}),i.d(t,"_69",function(){return m.d});var v=i(133);i.d(t,"b",function(){return v.a}),i.d(t,"c",function(){return v.b}),i.d(t,"d",function(){return v.c}),i.d(t,"m",function(){return v.d}),i.d(t,"n",function(){return v.e}),i.d(t,"o",function(){return v.f}),i.d(t,"p",function(){return v.g}),i.d(t,"q",function(){return v.h}),i.d(t,"r",function(){return v.i}),i.d(t,"s",function(){return v.j}),i.d(t,"t",function(){return v.k}),i.d(t,"u",function(){return v.l}),i.d(t,"v",function(){return v.m}),i.d(t,"w",function(){return v.n}),i.d(t,"x",function(){return v.o}),i.d(t,"y",function(){return v.p}),i.d(t,"z",function(){return v.q}),i.d(t,"A",function(){return v.r}),i.d(t,"C",function(){return v.s}),i.d(t,"D",function(){return v.t}),i.d(t,"_70",function(){return v.u}),i.d(t,"_71",function(){return v.v}),i.d(t,"_72",function(){return v.w}),i.d(t,"_73",function(){return v.x}),i.d(t,"_74",function(){return v.y}),i.d(t,"_75",function(){return v.z}),i.d(t,"_76",function(){return v.A}),i.d(t,"_77",function(){return v.B}),i.d(t,"_78",function(){return v.C}),i.d(t,"_79",function(){return v.D}),i.d(t,"_80",function(){return v.E}),i.d(t,"_81",function(){return v.F}),i.d(t,"_82",function(){return v.G}),i.d(t,"_83",function(){return v.H}),i.d(t,"_84",function(){return v.I}),i.d(t,"_85",function(){return v.J}),i.d(t,"_86",function(){return v.K}),i.d(t,"_87",function(){return v.L}),i.d(t,"_88",function(){return v.M}),i.d(t,"_89",function(){return v.N}),i.d(t,"_90",function(){return v.O}),i.d(t,"_91",function(){return v.P}),i.d(t,"_92",function(){return v.Q}),i.d(t,"_93",function(){return v.R}),i.d(t,"_94",function(){return v.S}),i.d(t,"_95",function(){return v.T}),i.d(t,"_96",function(){return v.U}),i.d(t,"_97",function(){return v.V}),i.d(t,"_98",function(){return v.W}),i.d(t,"_99",function(){return v.X}),i.d(t,"_100",function(){return v.Y}),i.d(t,"_101",function(){return v.Z}),i.d(t,"_102",function(){return v._0}),i.d(t,"_103",function(){return v._1}),i.d(t,"_104",function(){return v._2}),i.d(t,"_105",function(){return v._3}),i.d(t,"_106",function(){return v._4}),i.d(t,"_107",function(){return v._5}),i.d(t,"_108",function(){return v._6}),i.d(t,"_109",function(){return v._7}),i.d(t,"_110",function(){return v._8}),i.d(t,"_111",function(){return v._9}),i.d(t,"_112",function(){return v._10}),i.d(t,"_113",function(){return v._11}),i.d(t,"_114",function(){return v._12}),i.d(t,"_115",function(){return v._13}),i.d(t,"_116",function(){return v._14}),i.d(t,"_117",function(){return v._15}),i.d(t,"_118",function(){return v._16}),i.d(t,"_119",function(){return v._17}),i.d(t,"_120",function(){return v._18}),i.d(t,"_121",function(){return v._19}),i.d(t,"_122",function(){return v._20}),i.d(t,"_123",function(){return v._21}),i.d(t,"_124",function(){return v._22}),i.d(t,"_125",function(){return v._23}),i.d(t,"_126",function(){return v._24}),i.d(t,"_127",function(){return v._25}),i.d(t,"_128",function(){return v._26});var y=i(135);i.d(t,"_129",function(){return y.a}),i.d(t,"_130",function(){return y.b}),i.d(t,"_131",function(){return y.c}),i.d(t,"_132",function(){return y.d});var w=i(128);i.d(t,"B",function(){return w.a}),i.d(t,"_133",function(){return w.b}),i.d(t,"_134",function(){return w.c}),i.d(t,"_135",function(){return w.d});var b=i(84);i.d(t,"_136",function(){return b.a})},function(e,t){e.exports=n},function(e,t,i){"use strict";var n=i(31);i.d(t,"i",function(){return n.a}),i.d(t,"j",function(){return n.b});var r=i(22);i.d(t,"h",function(){return r.c}),i.d(t,"k",function(){return r.a}),i.d(t,"l",function(){return r.b}),i.d(t,"p",function(){return r.d});var o=i(21);i.d(t,"c",function(){return o.a});var s=i(30);i.d(t,"m",function(){return s.a});var a=i(17);i.d(t,"a",function(){return a.a}),i.d(t,"n",function(){return a.b});var l=i(112);i.d(t,"b",function(){return l.a});var d=i(56);i.d(t,"e",function(){return d.a});var h=i(111);i.d(t,"f",function(){return h.a});var c=i(55);i.d(t,"g",function(){return c.a});var p=i(27);i.d(t,"d",function(){return p.a});var u=i(37);i.d(t,"o",function(){return u.a})},function(e,t){e.exports=r},function(e,t,i){"use strict";var n=i(16);i.d(t,"o",function(){return n.b}),i.d(t,"z",function(){return n.a}),i.d(t,"A",function(){return n.e}),i.d(t,"B",function(){return n.f}),i.d(t,"C",function(){return n.d}),i.d(t,"D",function(){return n.c});var r=i(6);i.d(t,"g",function(){return r.a});var o=i(12);i.d(t,"E",function(){return o.a});var s=i(13);i.d(t,"F",function(){return s.a});var a=i(45);i.d(t,"l",function(){return a.a});var l=i(28);i.d(t,"a",function(){return l.k}),i.d(t,"b",function(){return l.y}),i.d(t,"c",function(){return l.z}),i.d(t,"d",function(){return l.A}),i.d(t,"e",function(){return l.n}),i.d(t,"h",function(){return l.B}),i.d(t,"i",function(){return l.C}),i.d(t,"j",function(){return l.j}),i.d(t,"k",function(){return l.l}),i.d(t,"m",function(){return l.D}),i.d(t,"n",function(){return l.E}),i.d(t,"p",function(){return l.F}),i.d(t,"q",function(){return l.i}),i.d(t,"r",function(){return l.m}),i.d(t,"s",function(){return l.c}),i.d(t,"v",function(){return l.e}),i.d(t,"w",function(){return l.G}),i.d(t,"x",function(){return l.H}),i.d(t,"y",function(){return l.I}),i.d(t,"G",function(){return l.a}),i.d(t,"H",function(){return l.p}),i.d(t,"I",function(){return l.q}),i.d(t,"J",function(){return l.r}),i.d(t,"K",function(){return l.u}),i.d(t,"L",function(){return l.v}),i.d(t,"M",function(){return l.w}),i.d(t,"N",function(){return l.o}),i.d(t,"O",function(){return l.x}),i.d(t,"P",function(){return l.s}),i.d(t,"Q",function(){return l.t}),i.d(t,"R",function(){return l.b}),i.d(t,"S",function(){return l.d}),i.d(t,"T",function(){return l.J}),i.d(t,"U",function(){return l.f}),i.d(t,"V",function(){return l.g}),i.d(t,"W",function(){return l.h});var d=i(82);i.d(t,"f",function(){return d.a}),i.d(t,"t",function(){return d.b}),i.d(t,"u",function(){return d.c}),i.d(t,"X",function(){return d.d}),i.d(t,"Y",function(){return d.e}),i.d(t,"Z",function(){return d.f}),i.d(t,"_0",function(){return d.g}),i.d(t,"_1",function(){return d.h}),i.d(t,"_2",function(){return d.i}),i.d(t,"_3",function(){return d.j}),i.d(t,"_4",function(){return d.k}),i.d(t,"_5",function(){return d.l}),i.d(t,"_6",function(){return d.m}),i.d(t,"_7",function(){return d.n}),i.d(t,"_8",function(){return d.o}),i.d(t,"_9",function(){return d.p}),i.d(t,"_10",function(){return d.q}),i.d(t,"_11",function(){return d.r}),i.d(t,"_12",function(){return d.s}),i.d(t,"_13",function(){return d.t}),i.d(t,"_14",function(){return d.u}),i.d(t,"_15",function(){return d.v}),i.d(t,"_16",function(){return d.w}),i.d(t,"_17",function(){return d.x}),i.d(t,"_18",function(){return d.y}),i.d(t,"_19",function(){return d.z}),i.d(t,"_20",function(){return d.A}),i.d(t,"_21",function(){return d.B}),i.d(t,"_22",function(){return d.C}),i.d(t,"_23",function(){return d.D}),i.d(t,"_24",function(){return d.E}),i.d(t,"_25",function(){return d.F}),i.d(t,"_26",function(){return d.G}),i.d(t,"_27",function(){return d.H}),i.d(t,"_28",function(){return d.I}),i.d(t,"_29",function(){return d.J}),i.d(t,"_30",function(){return d.K}),i.d(t,"_31",function(){return d.L}),i.d(t,"_32",function(){return d.M}),i.d(t,"_33",function(){return d.N}),i.d(t,"_34",function(){return d.O}),i.d(t,"_35",function(){return d.P}),i.d(t,"_36",function(){return d.Q}),i.d(t,"_37",function(){return d.R}),i.d(t,"_38",function(){return d.S}),i.d(t,"_39",function(){return d.T}),i.d(t,"_40",function(){return d.U}),i.d(t,"_41",function(){return d.V}),i.d(t,"_42",function(){return d.W}),i.d(t,"_43",function(){return d.X}),i.d(t,"_44",function(){return d.Y}),i.d(t,"_45",function(){return d.Z}),i.d(t,"_46",function(){return d._0}),i.d(t,"_47",function(){return d._1}),i.d(t,"_48",function(){return d._2}),i.d(t,"_49",function(){return d._3}),i.d(t,"_50",function(){return d._4}),i.d(t,"_51",function(){return d._5}),i.d(t,"_52",function(){return d._6}),i.d(t,"_53",function(){return d._7}),i.d(t,"_54",function(){return d._8}),i.d(t,"_55",function(){return d._9}),i.d(t,"_56",function(){return d._10}),i.d(t,"_57",function(){return d._11}),i.d(t,"_58",function(){return d._12}),i.d(t,"_59",function(){return d._13}),i.d(t,"_60",function(){return d._14}),i.d(t,"_61",function(){return d._15}),i.d(t,"_62",function(){return d._16}),i.d(t,"_63",function(){return d._17}),i.d(t,"_64",function(){return d._18}),i.d(t,"_65",function(){return d._19}),i.d(t,"_66",function(){return d._20}),i.d(t,"_67",function(){return d._21}),i.d(t,"_68",function(){return d._22}),i.d(t,"_69",function(){return d._23}),i.d(t,"_70",function(){return d._24}),i.d(t,"_71",function(){return d._25}),i.d(t,"_72",function(){return d._26}),i.d(t,"_73",function(){return d._27}),i.d(t,"_74",function(){return d._28}),i.d(t,"_75",function(){return d._29}),i.d(t,"_76",function(){return d._30}),i.d(t,"_77",function(){return d._31}),i.d(t,"_78",function(){return d._32}),i.d(t,"_79",function(){return d._33}),i.d(t,"_80",function(){return d._34}),i.d(t,"_81",function(){return d._35}),i.d(t,"_82",function(){return d._36}),i.d(t,"_83",function(){return d._37}),i.d(t,"_84",function(){return d._38}),i.d(t,"_85",function(){return d._39}),i.d(t,"_86",function(){return d._40}),i.d(t,"_87",function(){return d._41}),i.d(t,"_88",function(){return d._42}),i.d(t,"_89",function(){return d._43}),i.d(t,"_90",function(){return d._44}),i.d(t,"_91",function(){return d._45}),i.d(t,"_92",function(){return d._46}),i.d(t,"_93",function(){return d._47}),i.d(t,"_94",function(){return d._48}),i.d(t,"_95",function(){return d._49}),i.d(t,"_96",function(){return d._50}),i.d(t,"_97",function(){return d._51}),i.d(t,"_98",function(){return d._52}),i.d(t,"_99",function(){return d._53}),i.d(t,"_100",function(){return d._54}),i.d(t,"_101",function(){return d._55}),i.d(t,"_102",function(){return d._56}),i.d(t,"_103",function(){return d._57}),i.d(t,"_104",function(){return d._58}),i.d(t,"_105",function(){return d._59}),i.d(t,"_106",function(){return d._60}),i.d(t,"_107",function(){return d._61}),i.d(t,"_108",function(){return d._62}),i.d(t,"_109",function(){return d._63}),i.d(t,"_110",function(){return d._64}),i.d(t,"_111",function(){return d._65}),i.d(t,"_112",function(){return d._66}),i.d(t,"_113",function(){return d._67}),i.d(t,"_114",function(){return d._68}),i.d(t,"_115",function(){return d._69}),i.d(t,"_116",function(){return d._70}),i.d(t,"_117",function(){return d._71}),i.d(t,"_118",function(){return d._72}),i.d(t,"_119",function(){return d._73}),i.d(t,"_120",function(){return d._74}),i.d(t,"_121",function(){return d._75}),i.d(t,"_122",function(){return d._76}),i.d(t,"_123",function(){return d._77}),i.d(t,"_124",function(){return d._78}),i.d(t,"_125",function(){return d._79}),i.d(t,"_126",function(){return d._80}),i.d(t,"_127",function(){return d._81}),i.d(t,"_128",function(){return d._82}),i.d(t,"_129",function(){return d._83}),i.d(t,"_130",function(){return d._84}),i.d(t,"_131",function(){return d._85}),i.d(t,"_132",function(){return d._86}),i.d(t,"_133",function(){return d._87}),i.d(t,"_134",function(){return d._88}),i.d(t,"_135",function(){return d._89}),i.d(t,"_136",function(){return d._90}),i.d(t,"_137",function(){return d._91}),i.d(t,"_138",function(){return d._92}),i.d(t,"_139",function(){return d._93}),i.d(t,"_140",function(){return d._94}),i.d(t,"_141",function(){return d._95}),i.d(t,"_142",function(){return d._96}),i.d(t,"_143",function(){return d._97}),i.d(t,"_144",function(){return d._98}),i.d(t,"_145",function(){return d._99}),i.d(t,"_146",function(){return d._100}),i.d(t,"_147",function(){return d._101}),i.d(t,"_148",function(){return d._102}),i.d(t,"_149",function(){return d._103}),i.d(t,"_150",function(){return d._104}),i.d(t,"_151",function(){return d._105}),i.d(t,"_152",function(){return d._106}),i.d(t,"_153",function(){return d._107}),i.d(t,"_154",function(){return d._108}),i.d(t,"_155",function(){return d._109}),i.d(t,"_156",function(){return d._110}),i.d(t,"_157",function(){return d._111}),i.d(t,"_158",function(){return d._112}),i.d(t,"_159",function(){return d._113}),i.d(t,"_160",function(){return d._114}),i.d(t,"_161",function(){return d._115}),i.d(t,"_162",function(){return d._116}),i.d(t,"_163",function(){return d._117}),i.d(t,"_164",function(){return d._118}),i.d(t,"_165",function(){return d._119}),i.d(t,"_166",function(){return d._120}),i.d(t,"_167",function(){return d._121}),i.d(t,"_168",function(){return d._122}),i.d(t,"_169",function(){return d._123}),i.d(t,"_170",function(){return d._124}),i.d(t,"_171",function(){return d._125}),i.d(t,"_172",function(){return d._126}),i.d(t,"_173",function(){return d._127}),i.d(t,"_174",function(){return d._128}),i.d(t,"_175",function(){return d._129}),i.d(t,"_176",function(){return d._130}),i.d(t,"_177",function(){return d._131}),i.d(t,"_178",function(){return d._132}),i.d(t,"_179",function(){return d._133}),i.d(t,"_180",function(){return d._134}),i.d(t,"_181",function(){return d._135}),i.d(t,"_182",function(){return d._136}),i.d(t,"_183",function(){return d._137}),i.d(t,"_184",function(){return d._138}),i.d(t,"_185",function(){return d._139}),i.d(t,"_186",function(){return d._140}),i.d(t,"_187",function(){return d._141}),i.d(t,"_188",function(){return d._142}),i.d(t,"_189",function(){return d._143}),i.d(t,"_190",function(){return d._144}),i.d(t,"_191",function(){return d._145}),i.d(t,"_192",function(){return d._146}),i.d(t,"_193",function(){return d._147});i.d(t,"_194",function(){return d._148}),i.d(t,"_195",function(){return d._149}),i.d(t,"_196",function(){return d._150}),i.d(t,"_197",function(){return d._151}),i.d(t,"_198",function(){return d._152}),i.d(t,"_199",function(){return d._153}),i.d(t,"_200",function(){return d._154}),i.d(t,"_201",function(){return d._155}),i.d(t,"_202",function(){return d._156}),i.d(t,"_203",function(){return d._157}),i.d(t,"_204",function(){return d._158}),i.d(t,"_205",function(){return d._159}),i.d(t,"_206",function(){return d._160}),i.d(t,"_207",function(){return d._161}),i.d(t,"_208",function(){return d._162}),i.d(t,"_209",function(){return d._163}),i.d(t,"_210",function(){return d._164}),i.d(t,"_211",function(){return d._165}),i.d(t,"_212",function(){return d._166}),i.d(t,"_213",function(){return d._167}),i.d(t,"_214",function(){return d._168}),i.d(t,"_215",function(){return d._169}),i.d(t,"_216",function(){return d._170}),i.d(t,"_217",function(){return d._171}),i.d(t,"_218",function(){return d._172}),i.d(t,"_219",function(){return d._173}),i.d(t,"_220",function(){return d._174}),i.d(t,"_221",function(){return d._175}),i.d(t,"_222",function(){return d._176}),i.d(t,"_223",function(){return d._177}),i.d(t,"_224",function(){return d._178}),i.d(t,"_225",function(){return d._179}),i.d(t,"_226",function(){return d._180}),i.d(t,"_227",function(){return d._181}),i.d(t,"_228",function(){return d._182}),i.d(t,"_229",function(){return d._183}),i.d(t,"_230",function(){return d._184}),i.d(t,"_231",function(){return d._185}),i.d(t,"_232",function(){return d._186}),i.d(t,"_233",function(){return d._187}),i.d(t,"_234",function(){return d._188}),i.d(t,"_235",function(){return d._189}),i.d(t,"_236",function(){return d._190}),i.d(t,"_237",function(){return d._191}),i.d(t,"_238",function(){return d._192}),i.d(t,"_239",function(){return d._193}),i.d(t,"_240",function(){return d._194}),i.d(t,"_241",function(){return d._195}),i.d(t,"_242",function(){return d._196}),i.d(t,"_243",function(){return d._197}),i.d(t,"_244",function(){return d._198}),i.d(t,"_245",function(){return d._199}),i.d(t,"_246",function(){return d._200}),i.d(t,"_247",function(){return d._201}),i.d(t,"_248",function(){return d._202}),i.d(t,"_249",function(){return d._203}),i.d(t,"_250",function(){return d._204}),i.d(t,"_251",function(){return d._205}),i.d(t,"_252",function(){return d._206}),i.d(t,"_253",function(){return d._207}),i.d(t,"_254",function(){return d._208}),i.d(t,"_255",function(){return d._209}),i.d(t,"_256",function(){return d._210}),i.d(t,"_257",function(){return d._211}),i.d(t,"_258",function(){return d._212}),i.d(t,"_259",function(){return d._213}),i.d(t,"_260",function(){return d._214}),i.d(t,"_261",function(){return d._215}),i.d(t,"_262",function(){return d._216}),i.d(t,"_263",function(){return d._217}),i.d(t,"_264",function(){return d._218}),i.d(t,"_265",function(){return d._219}),i.d(t,"_266",function(){return d._220}),i.d(t,"_267",function(){return d._221}),i.d(t,"_268",function(){return d._222}),i.d(t,"_269",function(){return d._223}),i.d(t,"_270",function(){return d._224}),i.d(t,"_271",function(){return d._225}),i.d(t,"_272",function(){return d._226}),i.d(t,"_273",function(){return d._227}),i.d(t,"_274",function(){return d._228}),i.d(t,"_275",function(){return d._229}),i.d(t,"_276",function(){return d._230}),i.d(t,"_277",function(){return d._231}),i.d(t,"_278",function(){return d._232}),i.d(t,"_279",function(){return d._233}),i.d(t,"_280",function(){return d._234}),i.d(t,"_281",function(){return d._235}),i.d(t,"_282",function(){return d._236}),i.d(t,"_283",function(){return d._237}),i.d(t,"_284",function(){return d._238}),i.d(t,"_285",function(){return d._239}),i.d(t,"_286",function(){return d._240}),i.d(t,"_287",function(){return d._241}),i.d(t,"_288",function(){return d._242}),i.d(t,"_289",function(){return d._243}),i.d(t,"_290",function(){return d._244}),i.d(t,"_291",function(){return d._245}),i.d(t,"_292",function(){return d._246}),i.d(t,"_293",function(){return d._247}),i.d(t,"_294",function(){return d._248}),i.d(t,"_295",function(){return d._249}),i.d(t,"_296",function(){return d._250}),i.d(t,"_297",function(){return d._251}),i.d(t,"_298",function(){return d._252}),i.d(t,"_299",function(){return d._253}),i.d(t,"_300",function(){return d._254}),i.d(t,"_301",function(){return d._255}),i.d(t,"_302",function(){return d._256}),i.d(t,"_303",function(){return d._257}),i.d(t,"_304",function(){return d._258}),i.d(t,"_305",function(){return d._259}),i.d(t,"_306",function(){return d._260}),i.d(t,"_307",function(){return d._261}),i.d(t,"_308",function(){return d._262}),i.d(t,"_309",function(){return d._263}),i.d(t,"_310",function(){return d._264}),i.d(t,"_311",function(){return d._265}),i.d(t,"_312",function(){return d._266}),i.d(t,"_313",function(){return d._267}),i.d(t,"_314",function(){return d._268}),i.d(t,"_315",function(){return d._269}),i.d(t,"_316",function(){return d._270}),i.d(t,"_317",function(){return d._271}),i.d(t,"_318",function(){return d._272}),i.d(t,"_319",function(){return d._273}),i.d(t,"_320",function(){return d._274}),i.d(t,"_321",function(){return d._275}),i.d(t,"_322",function(){return d._276}),i.d(t,"_323",function(){return d._277}),i.d(t,"_324",function(){return d._278}),i.d(t,"_325",function(){return d._279}),i.d(t,"_326",function(){return d._280}),i.d(t,"_327",function(){return d._281}),i.d(t,"_328",function(){return d._282}),i.d(t,"_329",function(){return d._283}),i.d(t,"_330",function(){return d._284}),i.d(t,"_331",function(){return d._285}),i.d(t,"_332",function(){return d._286}),i.d(t,"_333",function(){return d._287}),i.d(t,"_334",function(){return d._288}),i.d(t,"_335",function(){return d._289}),i.d(t,"_336",function(){return d._290}),i.d(t,"_337",function(){return d._291}),i.d(t,"_338",function(){return d._292}),i.d(t,"_339",function(){return d._293}),i.d(t,"_340",function(){return d._294}),i.d(t,"_341",function(){return d._295}),i.d(t,"_342",function(){return d._296}),i.d(t,"_343",function(){return d._297}),i.d(t,"_344",function(){return d._298}),i.d(t,"_345",function(){return d._299}),i.d(t,"_346",function(){return d._300}),i.d(t,"_347",function(){return d._301}),i.d(t,"_348",function(){return d._302}),i.d(t,"_349",function(){return d._303}),i.d(t,"_350",function(){return d._304}),i.d(t,"_351",function(){return d._305}),i.d(t,"_352",function(){return d._306}),i.d(t,"_353",function(){return d._307}),i.d(t,"_354",function(){return d._308}),i.d(t,"_355",function(){return d._309}),i.d(t,"_356",function(){return d._310}),i.d(t,"_357",function(){return d._311}),i.d(t,"_358",function(){return d._312}),i.d(t,"_359",function(){return d._313}),i.d(t,"_360",function(){return d._314}),i.d(t,"_361",function(){return d._315}),i.d(t,"_362",function(){return d._316}),i.d(t,"_363",function(){return d._317}),i.d(t,"_364",function(){return d._318}),i.d(t,"_365",function(){return d._319}),i.d(t,"_366",function(){return d._320}),i.d(t,"_367",function(){return d._321}),i.d(t,"_368",function(){return d._322}),i.d(t,"_369",function(){return d._323}),i.d(t,"_370",function(){return d._324}),i.d(t,"_371",function(){return d._325}),i.d(t,"_372",function(){return d._326}),i.d(t,"_373",function(){return d._327}),i.d(t,"_374",function(){return d._328}),i.d(t,"_375",function(){return d._329}),i.d(t,"_376",function(){return d._330})},function(e,t,i){"use strict";i.d(t,"a",function(){return o});var n=i(0),r=(i.n(n),i(6)),o=function(){function e(e){this.referenceCount=0,this.uniqueFormatType=e,this.propertiesHash=new r.a}return e.prototype.isEqual=function(e,t,i){var n=!1;switch(this.uniqueFormatType){case 1:n=this.isBorderEqual(e,t,i);break;case 2:n=this.isCharacterFormatEqual(e,t,i);break;case 3:n=this.isParagraphFormatEqual(e,t,i);break;case 4:n=this.isCellFormatEqual(e,t,i);break;case 5:n=this.isShadingEqual(e,t,i);break;case 6:n=this.isRowFormatEqual(e,t,i);break;case 7:n=this.isListFormatEqual(e,t,i);break;case 8:n=this.isTableFormatEqual(e,t,i);break;case 9:n=this.isListLevelEqual(e,t,i);break;case 10:n=this.isSectionFormatEqual(e,t,i);break;case 11:n=this.isColumnFormatEqual(e,t,i)}return n},e.prototype.isNotEqual=function(t,r,o,s,a){var l=void 0,d=e.getPropertyType(a,t);this.propertiesHash.containsKey(d)&&(l=this.propertiesHash.get(d));var h=void 0;return t===o?h=s:r.containsKey(d)&&(h=r.get(d)),!(l===h||!i.i(n.isNullOrUndefined)(l)&&!i.i(n.isNullOrUndefined)(h)&&l===h)},e.getPropertyType=function(e,t){var i=0;switch(e){case 1:i=this.getBorderPropertyType(t);break;case 2:i=this.getCharacterFormatPropertyType(t);break;case 3:i=this.getParaFormatPropertyType(t);break;case 4:i=this.getCellFormatPropertyType(t);break;case 5:i=this.getShadingPropertyType(t);break;case 6:i=this.getRowFormatType(t);break;case 7:i=this.getListFormatType(t);break;case 8:i=this.getTableFormatType(t);break;case 9:i=this.getListLevelType(t);break;case 10:i=this.getSectionFormatType(t);break;case 11:i=this.getColumnFormatType(t)}return i},e.getRowFormatType=function(e){return"allowBreakAcrossPages"===e?1:"isHeader"===e?2:"height"===e?3:"heightType"===e?4:"gridBefore"===e?5:"gridBeforeWidth"===e?6:"gridBeforeWidthType"===e?7:"gridAfter"===e?8:"gridAfterWidth"===e?9:"gridAfterWidthType"===e?10:"leftMargin"===e?11:"topMargin"===e?12:"bottomMargin"===e?13:"rightMargin"===e?14:"leftIndent"===e?15:0},e.getListFormatType=function(e){return"listId"===e?1:"listLevelNumber"===e?2:"nsid"===e?3:0},e.getTableFormatType=function(e){return"leftMargin"===e?1:"rightMargin"===e?2:"topMargin"===e?3:"bottomMargin"===e?4:"cellSpacing"===e?5:"leftIndent"===e?6:"tableAlignment"===e?7:"preferredWidth"===e?8:"preferredWidthType"===e?9:"bidi"===e?10:"allowAutoFit"===e?11:"horizontalPositionAbs"===e?12:"horizontalPosition"===e?13:0},e.getListLevelType=function(e){return"listLevelPattern"===e?1:"startAt"===e?2:"followCharacter"===e?3:"numberFormat"===e?4:"restartLevel"===e?5:"isLegalStyleNumbering"===e?6:0},e.getShadingPropertyType=function(e){return"backgroundColor"===e?1:"foregroundColor"===e?2:"textureStyle"===e?3:0},e.getCellFormatPropertyType=function(e){return"leftMargin"===e?1:"rightMargin"===e?2:"topMargin"===e?3:"bottomMargin"===e?4:"columnSpan"===e?5:"rowSpan"===e?6:"verticalAlignment"===e?7:"preferredWidthType"===e?8:"preferredWidth"===e?9:"cellWidth"===e?10:0},e.getBorderPropertyType=function(e){return"color"===e?1:"lineStyle"===e?2:"lineWidth"===e?3:"shadow"===e?4:"space"===e?5:"hasNoneStyle"===e?6:0},e.getCharacterFormatPropertyType=function(e){return"fontColor"===e?1:"fontFamily"===e?2:"fontSize"===e?3:"bold"===e?4:"italic"===e?5:"underline"===e?6:"strikethrough"===e?7:"baselineAlignment"===e?8:"highlightColor"===e?9:"bidi"===e?10:"bdo"===e?11:"boldBidi"===e?12:"italicBidi"===e?13:"fontFamilyBidi"===e?14:"fontSizeBidi"===e?15:"allCaps"===e?16:"localeIdBidi"===e?17:"complexScript"===e?18:"fontFamilyFarEast"===e?19:"fontFamilyAscii"===e?20:"fontFamilyNonFarEast"===e?21:"localeIdAscii"===e?22:"localeIdFarEast"===e?23:"characterSpacing"===e?24:"scaling"===e?25:0},e.getParaFormatPropertyType=function(e){return"leftIndent"===e?1:"rightIndent"===e?2:"firstLineIndent"===e?3:"textAlignment"===e?4:"beforeSpacing"===e?5:"afterSpacing"===e?6:"lineSpacing"===e?7:"lineSpacingType"===e?8:"outlineLevel"===e?9:"bidi"===e?10:"contextualSpacing"===e?11:"keepWithNext"===e?12:"keepLinesTogether"===e?13:"widowControl"===e?14:"spaceBeforeAuto"===e?15:"spaceAfterAuto"===e?16:0},e.getColumnFormatType=function(e){return"width"===e?1:"space"===e?2:0},e.getSectionFormatType=function(e){return"headerDistance"===e?1:"footerDistance"===e?2:"differentFirstPage"===e?3:"differentOddAndEvenPages"===e?4:"pageWidth"===e?5:"pageHeight"===e?6:"leftMargin"===e?7:"topMargin"===e?8:"rightMargin"===e?9:"bottomMargin"===e?10:"bidi"===e?11:"restartPageNumbering"===e?12:"pageStartingNumber"===e?13:"endnoteNumberFormat"===e?14:"endnotePosition"===e?15:"footNoteNumberFormat"===e?16:"footnotePosition"===e?17:"restartIndexForEndnotes"===e?18:"restartIndexForFootnotes"===e?19:"initialFootNoteNumber"===e?20:"initialEndNoteNumber"===e?21:"pageNumberStyle"===e?22:"numberOfColumns"===e?23:"equalWidth"===e?24:"lineBetweenColumns"===e?25:"columns"===e?26:"breakCode"===e?27:0},e.prototype.isBorderEqual=function(e,t,i){return!this.isNotEqual("color",e,t,i,1)&&(!this.isNotEqual("lineStyle",e,t,i,1)&&(!this.isNotEqual("lineWidth",e,t,i,1)&&(!this.isNotEqual("shadow",e,t,i,1)&&(!this.isNotEqual("space",e,t,i,1)&&!this.isNotEqual("hasNoneStyle",e,t,i,1)))))},e.prototype.isCharacterFormatEqual=function(e,t,i){return!this.isNotEqual("fontColor",e,t,i,2)&&(!this.isNotEqual("fontFamily",e,t,i,2)&&(!this.isNotEqual("fontSize",e,t,i,2)&&(!this.isNotEqual("bold",e,t,i,2)&&(!this.isNotEqual("italic",e,t,i,2)&&(!this.isNotEqual("underline",e,t,i,2)&&(!this.isNotEqual("strikethrough",e,t,i,2)&&(!this.isNotEqual("baselineAlignment",e,t,i,2)&&(!this.isNotEqual("highlightColor",e,t,i,2)&&(!this.isNotEqual("bidi",e,t,i,2)&&(!this.isNotEqual("bdo",e,t,i,2)&&(!this.isNotEqual("fontColor",e,t,i,2)&&(!this.isNotEqual("fontFamilyBidi",e,t,i,2)&&(!this.isNotEqual("fontSizeBidi",e,t,i,2)&&(!this.isNotEqual("boldBidi",e,t,i,2)&&(!this.isNotEqual("italicBidi",e,t,i,2)&&(!this.isNotEqual("allCaps",e,t,i,2)&&(!this.isNotEqual("localeIdBidi",e,t,i,2)&&(!this.isNotEqual("complexScript",e,t,i,2)&&(!this.isNotEqual("fontFamilyFarEast",e,t,i,2)&&(!this.isNotEqual("fontFamilyAscii",e,t,i,2)&&(!this.isNotEqual("fontFamilyNonFarEast",e,t,i,2)&&(!this.isNotEqual("characterSpacing",e,t,i,2)&&!this.isNotEqual("scaling",e,t,i,2)))))))))))))))))))))))},e.prototype.isParagraphFormatEqual=function(e,t,i){return!this.isNotEqual("leftIndent",e,t,i,3)&&(!this.isNotEqual("rightIndent",e,t,i,3)&&(!this.isNotEqual("firstLineIndent",e,t,i,3)&&(!this.isNotEqual("textAlignment",e,t,i,3)&&(!this.isNotEqual("beforeSpacing",e,t,i,3)&&(!this.isNotEqual("afterSpacing",e,t,i,3)&&(!this.isNotEqual("spaceBeforeAuto",e,t,i,3)&&(!this.isNotEqual("spaceAfterAuto",e,t,i,3)&&(!this.isNotEqual("lineSpacing",e,t,i,3)&&(!this.isNotEqual("lineSpacingType",e,t,i,3)&&(!this.isNotEqual("outlineLevel",e,t,i,3)&&(!this.isNotEqual("bidi",e,t,i,3)&&(!this.isNotEqual("contextualSpacing",e,t,i,3)&&(!this.isNotEqual("keepWithNext",e,t,i,3)&&(!this.isNotEqual("keepLinesTogether",e,t,i,3)&&!this.isNotEqual("widowControl",e,t,i,3)))))))))))))))},e.prototype.isCellFormatEqual=function(e,t,i){return!this.isNotEqual("leftMargin",e,t,i,4)&&(!this.isNotEqual("rightMargin",e,t,i,4)&&(!this.isNotEqual("topMargin",e,t,i,4)&&(!this.isNotEqual("bottomMargin",e,t,i,4)&&(!this.isNotEqual("columnSpan",e,t,i,4)&&(!this.isNotEqual("rowSpan",e,t,i,4)&&(!this.isNotEqual("verticalAlignment",e,t,i,4)&&(!this.isNotEqual("preferredWidthType",e,t,i,4)&&(!this.isNotEqual("preferredWidth",e,t,i,4)&&!this.isNotEqual("cellWidth",e,t,i,4)))))))))},e.prototype.isShadingEqual=function(e,t,i){return!this.isNotEqual("backgroundColor",e,t,i,5)&&(!this.isNotEqual("foregroundColor",e,t,i,5)&&!this.isNotEqual("textureStyle",e,t,i,5))},e.prototype.isRowFormatEqual=function(e,t,i){return!this.isNotEqual("allowBreakAcrossPages",e,t,i,6)&&(!this.isNotEqual("isHeader",e,t,i,6)&&(!this.isNotEqual("height",e,t,i,6)&&(!this.isNotEqual("heightType",e,t,i,6)&&(!this.isNotEqual("gridBefore",e,t,i,6)&&(!this.isNotEqual("gridBeforeWidth",e,t,i,6)&&(!this.isNotEqual("gridBeforeWidthType",e,t,i,6)&&(!this.isNotEqual("gridAfter",e,t,i,6)&&(!this.isNotEqual("gridAfterWidth",e,t,i,6)&&(!this.isNotEqual("gridAfterWidthType",e,t,i,6)&&(!this.isNotEqual("leftMargin",e,t,i,6)&&(!this.isNotEqual("topMargin",e,t,i,6)&&(!this.isNotEqual("bottomMargin",e,t,i,6)&&(!this.isNotEqual("rightMargin",e,t,i,6)&&!this.isNotEqual("leftIndent",e,t,i,6))))))))))))))},e.prototype.isListFormatEqual=function(e,t,i){return!this.isNotEqual("listId",e,t,i,7)&&(!this.isNotEqual("listLevelNumber",e,t,i,7)&&!this.isNotEqual("nsid",e,t,i,7))},e.prototype.isTableFormatEqual=function(e,t,i){return!this.isNotEqual("leftMargin",e,t,i,8)&&(!this.isNotEqual("rightMargin",e,t,i,8)&&(!this.isNotEqual("topMargin",e,t,i,8)&&(!this.isNotEqual("bottomMargin",e,t,i,8)&&(!this.isNotEqual("cellSpacing",e,t,i,8)&&(!this.isNotEqual("leftIndent",e,t,i,8)&&(!this.isNotEqual("tableAlignment",e,t,i,8)&&(!this.isNotEqual("preferredWidth",e,t,i,8)&&(!this.isNotEqual("preferredWidthType",e,t,i,8)&&(!this.isNotEqual("bidi",e,t,i,8)&&(!this.isNotEqual("allowAutoFit",e,t,i,8)&&(!this.isNotEqual("horizontalPositionAbs",e,t,i,8)&&!this.isNotEqual("horizontalPosition",e,t,i,8))))))))))))},e.prototype.isListLevelEqual=function(e,t,i){return!this.isNotEqual("listLevelPattern",e,t,i,9)&&(!this.isNotEqual("startAt",e,t,i,9)&&(!this.isNotEqual("followCharacter",e,t,i,9)&&(!this.isNotEqual("numberFormat",e,t,i,9)&&(!this.isNotEqual("restartLevel",e,t,i,9)&&!this.isNotEqual("isLegalStyleNumbering",e,t,i,9)))))},e.prototype.isSectionFormatEqual=function(e,t,i){return!this.isNotEqual("headerDistance",e,t,i,10)&&(!this.isNotEqual("footerDistance",e,t,i,10)&&(!this.isNotEqual("differentFirstPage",e,t,i,10)&&(!this.isNotEqual("differentOddAndEvenPages",e,t,i,10)&&(!this.isNotEqual("pageWidth",e,t,i,10)&&(!this.isNotEqual("pageHeight",e,t,i,10)&&(!this.isNotEqual("leftMargin",e,t,i,10)&&(!this.isNotEqual("topMargin",e,t,i,10)&&(!this.isNotEqual("rightMargin",e,t,i,10)&&(!this.isNotEqual("bottomMargin",e,t,i,10)&&(!this.isNotEqual("bidi",e,t,i,10)&&(!this.isNotEqual("restartPageNumbering",e,t,i,10)&&(!this.isNotEqual("pageStartingNumber",e,t,i,10)&&(!this.isNotEqual("endnoteNumberFormat",e,t,i,10)&&(!this.isNotEqual("endnotePosition",e,t,i,10)&&(!this.isNotEqual("footNoteNumberFormat",e,t,i,10)&&(!this.isNotEqual("footnotePosition",e,t,i,10)&&(!this.isNotEqual("restartIndexForEndnotes",e,t,i,10)&&(!this.isNotEqual("restartIndexForFootnotes",e,t,i,10)&&(!this.isNotEqual("initialFootNoteNumber",e,t,i,10)&&(!this.isNotEqual("initialEndNoteNumber",e,t,i,10)&&(!this.isNotEqual("pageNumberStyle",e,t,i,10)&&(!this.isNotEqual("numberOfColumns",e,t,i,10)&&(!this.isNotEqual("equalWidth",e,t,i,10)&&(!this.isNotEqual("lineBetweenColumns",e,t,i,10)&&!this.isNotEqual("breakCode",e,t,i,10)))))))))))))))))))))))))},e.prototype.isColumnFormatEqual=function(e,t,i){return!this.isNotEqual("width",e,t,i,11)&&!this.isNotEqual("space",e,t,i,11)},e.prototype.cloneItems=function(t,i,n,r){for(var o=e.getPropertyType(r,i),s=t.propertiesHash.keys,a=0;a<s.length;a++)s[a]===o?this.propertiesHash.add(o,n):this.propertiesHash.add(s[a],t.propertiesHash.get(s[a]));t.propertiesHash.containsKey(o)||this.propertiesHash.add(o,n)},e.prototype.mergeProperties=function(e){for(var t=e.cloneProperties(),i=this.propertiesHash.keys,n=0;n<i.length;n++)t.containsKey(i[n])||t.add(i[n],this.propertiesHash.get(i[n]));return t},e.prototype.cloneProperties=function(){for(var e=new r.a,t=this.propertiesHash.keys,i=0;i<t.length;i++)e.add(t[i],this.propertiesHash.get(t[i]));return e},e.prototype.destroy=function(){i.i(n.isNullOrUndefined)(this.propertiesHash)||this.propertiesHash.destroy(),this.propertiesHash=void 0,this.referenceCount=void 0,this.uniqueFormatType=void 0},e}()},function(e,t,i){"use strict";i.d(t,"a",function(){return o});var n=i(0),r=(i.n(n),i(12)),o=function(){function e(){this.items=[]}return e.prototype.addUniqueFormat=function(e,t){for(var o=void 0,s=0;s<this.items.length;s++)if(this.items[s].isEqual(e,void 0,void 0)){o=this.items[s];break}return i.i(n.isNullOrUndefined)(o)?(o=new r.a(t),o.propertiesHash=e,o.referenceCount=1,this.items.push(o)):o.referenceCount++,o},e.prototype.updateUniqueFormat=function(e,t,o){for(var s=void 0,a=0;a<this.items.length;a++)if(this.items[a].isEqual(e.propertiesHash,t,o)){s=this.items[a];break}return i.i(n.isNullOrUndefined)(s)?(s=new r.a(e.uniqueFormatType),s.cloneItems(e,t,o,e.uniqueFormatType),s.referenceCount=1,this.items.push(s)):s.referenceCount++,this.remove(e),s},e.prototype.remove=function(e){--e.referenceCount<=0&&(this.items.splice(this.items.indexOf(e),1),e.destroy(),e=void 0)},e.prototype.clear=function(){if(i.i(n.isNullOrUndefined)(this.items))for(var e=0;e<this.items.length;e++)this.items[e].destroy();this.items=[]},e.prototype.destroy=function(){this.clear(),this.items=void 0},e}()},function(e,t,i){"use strict";i.d(t,"a",function(){return r});var n=i(0),r=(i.n(n),function(){function e(){this.abstractListIdIn=-1,this.nsid=-1,this.levels=[]}return Object.defineProperty(e.prototype,"abstractListId",{get:function(){return this.abstractListIdIn},set:function(e){this.abstractListIdIn=e},enumerable:!0,configurable:!0}),e.prototype.clear=function(){if(!i.i(n.isNullOrUndefined)(this.levels)){for(var e=0;e<this.levels.length;e++){var t=this.levels[parseInt(e.toString(),10)];t.clearFormat(),this.levels.splice(this.levels.indexOf(t),1),e--}this.levels=[]}},e.prototype.destroy=function(){if(!i.i(n.isNullOrUndefined)(this.levels)){for(var e=0;e<this.levels.length;e++){var t=this.levels[parseInt(e.toString(),10)];t.destroy(),this.levels.splice(this.levels.indexOf(t),1),e--}this.levels=[]}this.levels=void 0},e.prototype.clone=function(){for(var t=new e,i=0;i<this.levels.length;i++)t.levels.push(this.levels[parseInt(i.toString(),10)].clone(t));return t},e}())},function(e,t){e.exports=o},function(e,t,i){"use strict";i.d(t,"b",function(){return n}),i.d(t,"a",function(){return r}),i.d(t,"e",function(){return o}),i.d(t,"f",function(){return s}),i.d(t,"d",function(){return a}),i.d(t,"c",function(){return l});var n;!function(e){e[e.LeftToRight=0]="LeftToRight",e[e.RightToLeft=1]="RightToLeft",e[e.WordSplit=2]="WordSplit",e[e.Number=4]="Number",e[e.Tab=6]="Tab"}(n||(n={}));var r;!function(e){e[e.English=0]="English",e[e.Hindi=1]="Hindi",e[e.Korean=2]="Korean",e[e.Chinese=3]="Chinese",e[e.Arabic=4]="Arabic",e[e.Hebrew=5]="Hebrew",e[e.Japanese=6]="Japanese",e[e.Thai=7]="Thai"}(r||(r={}));var o;!function(e){e[e.Default=0]="Default",e[e.EastAsia=1]="EastAsia",e[e.CS=2]="CS"}(o||(o={}));var s;!function(e){e[e.af_ZA=1078]="af_ZA",e[e.sq_AL=1052]="sq_AL",e[e.am_ET=1118]="am_ET",e[e.gsw_FR=1156]="gsw_FR",e[e.ar_DZ=5121]="ar_DZ",e[e.ar_BH=15361]="ar_BH",e[e.ar_EG=3073]="ar_EG",e[e.ar_IQ=2049]="ar_IQ",e[e.ar_JO=11265]="ar_JO",e[e.ar_KW=13313]="ar_KW",e[e.ar_LB=12289]="ar_LB",e[e.ar_LY=4097]="ar_LY",e[e.ar_MA=6145]="ar_MA",e[e.ar_OM=8193]="ar_OM",e[e.ar_QA=16385]="ar_QA",e[e.ar_SA=1025]="ar_SA",e[e.ar_SY=10241]="ar_SY",e[e.ar_TN=7169]="ar_TN",e[e.ar_AE=14337]="ar_AE",e[e.ar_YE=9217]="ar_YE",e[e.hy_AM=1067]="hy_AM",e[e.as_IN=1101]="as_IN",e[e.az_Cyrl_AZ=2092]="az_Cyrl_AZ",e[e.az_Latn_AZ=1068]="az_Latn_AZ",e[e.ba_RU=1133]="ba_RU",e[e.eu_ES=1069]="eu_ES",e[e.be_BY=1059]="be_BY",e[e.bn_BD=2117]="bn_BD",e[e.bn_IN=1093]="bn_IN",e[e.bs_Cyrl_BA=8218]="bs_Cyrl_BA",e[e.bs_Latn_BA=5146]="bs_Latn_BA",e[e.bg_BG=1026]="bg_BG",e[e.br_FR=1150]="br_FR",e[e.my_MM=1109]="my_MM",e[e.ca_ES=1027]="ca_ES",e[e.chr_US=1116]="chr_US",e[e.zh_HK=3076]="zh_HK",e[e.zh_MO=5124]="zh_MO",e[e.zh_CN=2052]="zh_CN",e[e.zh_SG=4100]="zh_SG",e[e.zh_TW=1028]="zh_TW",e[e.co_FR=1155]="co_FR",e[e.hr_BA=4122]="hr_BA",e[e.hr_HR=1050]="hr_HR",e[e.cs_CZ=1029]="cs_CZ",e[e.da_DK=1030]="da_DK",e[e.prs_AF=1164]="prs_AF",e[e.dv_MV=1125]="dv_MV",e[e.nl_BE=2067]="nl_BE",e[e.nl_NL=1043]="nl_NL",e[e.bin_NG=1126]="bin_NG",e[e.et_EE=1061]="et_EE",e[e.en_AU=3081]="en_AU",e[e.en_BZ=10249]="en_BZ",e[e.en_CA=4105]="en_CA",e[e.en_029=9225]="en_029",e[e.en_HK=15369]="en_HK",e[e.en_IN=16393]="en_IN",e[e.en_ID=14345]="en_ID",e[e.en_IE=6153]="en_IE",e[e.en_JM=8201]="en_JM",e[e.en_MY=17417]="en_MY",e[e.en_NZ=5129]="en_NZ",e[e.en_PH=13321]="en_PH",e[e.en_SG=18441]="en_SG",e[e.en_ZA=7177]="en_ZA",e[e.en_TT=11273]="en_TT",e[e.en_GB=2057]="en_GB",e[e.en_US=1033]="en_US",e[e.en_ZW=12297]="en_ZW",e[e.fo_FO=1080]="fo_FO",e[e.fil_PH=1124]="fil_PH",e[e.fi_FI=1035]="fi_FI",e[e.fr_BE=2060]="fr_BE",e[e.fr_CM=11276]="fr_CM",e[e.fr_CA=3084]="fr_CA",e[e.fr_CD=9228]="fr_CD",e[e.fr_CI=12300]="fr_CI",e[e.fr_FR=1036]="fr_FR",e[e.fr_HT=15372]="fr_HT",e[e.fr_LU=5132]="fr_LU",e[e.fr_ML=13324]="fr_ML",e[e.fr_MC=6156]="fr_MC",e[e.fr_MA=14348]="fr_MA",e[e.fr_RE=8204]="fr_RE",e[e.fr_SN=10252]="fr_SN",e[e.fr_CH=4108]="fr_CH",e[e.fy_NL=1122]="fy_NL",e[e.ff_NG=1127]="ff_NG",e[e.gd_GB=1084]="gd_GB",e[e.gl_ES=1110]="gl_ES",e[e.ka_GE=1079]="ka_GE",e[e.de_AT=3079]="de_AT",e[e.de_DE=1031]="de_DE",e[e.de_LI=5127]="de_LI",e[e.de_LU=4103]="de_LU",e[e.de_CH=2055]="de_CH",e[e.el_GR=1032]="el_GR",e[e.gn_PY=1140]="gn_PY",e[e.gu_IN=1095]="gu_IN",e[e.kl_GL=1135]="kl_GL",e[e.ha_Latn_NG=1128]="ha_Latn_NG",e[e.haw_US=1141]="haw_US",e[e.he_IL=1037]="he_IL",e[e.hi_IN=1081]="hi_IN",e[e.hu_HU=1038]="hu_HU",e[e.ibb_NG=1129]="ibb_NG",e[e.is_IS=1039]="is_IS",e[e.ig_NG=1136]="ig_NG",e[e.id_ID=1057]="id_ID",e[e.iu_Latn_CA=2141]="iu_Latn_CA",e[e.iu_Cans_CA=1117]="iu_Cans_CA",e[e.it_IT=1040]="it_IT",e[e.it_CH=2064]="it_CH",e[e.ga_IE=2108]="ga_IE",e[e.xh_ZA=1076]="xh_ZA",e[e.zu_ZA=1077]="zu_ZA",e[e.kn_IN=1099]="kn_IN",e[e.kr_NG=1137]="kr_NG",e[e.ks_Deva=2144]="ks_Deva",e[e.ks_Arab=1120]="ks_Arab",e[e.kk_KZ=1087]="kk_KZ",e[e.km_KH=1107]="km_KH",e[e.kok_IN=1111]="kok_IN",e[e.ko_KR=1042]="ko_KR",e[e.ky_KG=1088]="ky_KG",e[e.qut_GT=1158]="qut_GT",e[e.rw_RW=1159]="rw_RW",e[e.lo_LA=1108]="lo_LA",e[e.la_Latn=1142]="la_Latn",e[e.lv_LV=1062]="lv_LV",e[e.lt_LT=1063]="lt_LT",e[e.dsb_DE=2094]="dsb_DE",e[e.lb_LU=1134]="lb_LU",e[e.mk_MK=1071]="mk_MK",e[e.ms_BN=2110]="ms_BN",e[e.ms_MY=1086]="ms_MY",e[e.ml_IN=1100]="ml_IN",e[e.mt_MT=1082]="mt_MT",e[e.mni_IN=1112]="mni_IN",e[e.mi_NZ=1153]="mi_NZ",e[e.mr_IN=1102]="mr_IN",e[e.arn_CL=1146]="arn_CL",e[e.mn_MN=1104]="mn_MN",e[e.mn_Mong_CN=2128]="mn_Mong_CN",e[e.ne_NP=1121]="ne_NP",e[e.ne_IN=2145]="ne_IN",e[e.nb_NO=1044]="nb_NO",e[e.nn_NO=2068]="nn_NO",e[e.oc_FR=1154]="oc_FR",e[e.or_IN=1096]="or_IN",e[e.om_Ethi_ET=1138]="om_Ethi_ET",e[e.pap_AN=1145]="pap_AN",e[e.ps_AF=1123]="ps_AF",e[e.fa_IR=1065]="fa_IR",e[e.pl_PL=1045]="pl_PL",e[e.pt_BR=1046]="pt_BR",e[e.pt_PT=2070]="pt_PT",e[e.pa_IN=1094]="pa_IN",e[e.pa_PK=2118]="pa_PK",e[e.quz_BO=1131]="quz_BO",e[e.guz_EC=2155]="guz_EC",e[e.guz_PE=3179]="guz_PE",e[e.ro_RO=1048]="ro_RO",e[e.ro_MO=2072]="ro_MO",e[e.rm_CH=1047]="rm_CH",e[e.ru_RU=1049]="ru_RU",e[e.ru_MO=2073]="ru_MO",e[e.smn_FI=9275]="smn_FI",e[e.smj_NO=4155]="smj_NO",e[e.smj_SE=5179]="smj_SE",e[e.se_FI=3131]="se_FI",e[e.se_NO=1083]="se_NO",e[e.se_SE=2107]="se_SE",e[e.sms_FI=8251]="sms_FI",e[e.sma_NO=6203]="sma_NO",e[e.sma_SE=7227]="sma_SE",e[e.sa_IN=1103]="sa_IN",e[e.sr_Cyrl_BA=7194]="sr_Cyrl_BA",e[e.sr_Cyrl_CS=3098]="sr_Cyrl_CS",e[e.sr_Latn_BA=6170]="sr_Latn_BA",e[e.sr_Latn_CS=2074]="sr_Latn_CS",e[e.nso_ZA=1132]="nso_ZA",e[e.tn_ZA=1074]="tn_ZA",e[e.sd_Arab_PK=2137]="sd_Arab_PK",e[e.sd_Deva_IN=1113]="sd_Deva_IN",e[e.si_LK=1115]="si_LK",e[e.sk_SK=1051]="sk_SK",e[e.sl_SI=1060]="sl_SI",e[e.so_SO=1143]="so_SO",e[e.es_AR=11274]="es_AR",e[e.es_BO=16394]="es_BO",e[e.es_CL=13322]="es_CL",e[e.es_CO=9226]="es_CO",e[e.es_CR=5130]="es_CR",e[e.es_DO=7178]="es_DO",e[e.es_EC=12298]="es_EC",e[e.es_SV=17418]="es_SV",e[e.es_GT=4106]="es_GT",e[e.es_HN=18442]="es_HN";e[e.es_MX=2058]="es_MX",e[e.es_NI=19466]="es_NI",e[e.es_PA=6154]="es_PA",e[e.es_PY=15370]="es_PY",e[e.es_PE=10250]="es_PE",e[e.es_PR=20490]="es_PR",e[e.es_ES=3082]="es_ES",e[e.es_ES_tradnl=1034]="es_ES_tradnl",e[e.es_US=21514]="es_US",e[e.es_UY=14346]="es_UY",e[e.es_VE=8202]="es_VE",e[e.st_ZA=1072]="st_ZA",e[e.sw_KE=1089]="sw_KE",e[e.sv_FI=2077]="sv_FI",e[e.sv_SE=1053]="sv_SE",e[e.syr_SY=1114]="syr_SY",e[e.tg_Cyrl_TJ=1064]="tg_Cyrl_TJ",e[e.tzm_Arab_MA=1119]="tzm_Arab_MA",e[e.tzm_Latn_DZ=2143]="tzm_Latn_DZ",e[e.ta_IN=1097]="ta_IN",e[e.tt_RU=1092]="tt_RU",e[e.te_IN=1098]="te_IN",e[e.th_TH=1054]="th_TH",e[e.bo_CN=1105]="bo_CN",e[e.ti_ER=2163]="ti_ER",e[e.ti_ET=1139]="ti_ET",e[e.ts_ZA=1073]="ts_ZA",e[e.tr_TR=1055]="tr_TR",e[e.tk_TM=1090]="tk_TM",e[e.ug_CN=1152]="ug_CN",e[e.uk_UA=1058]="uk_UA",e[e.hsb_DE=1070]="hsb_DE",e[e.ur_PK=1056]="ur_PK",e[e.uz_Cyrl_UZ=2115]="uz_Cyrl_UZ",e[e.uz_Latn_UZ=1091]="uz_Latn_UZ",e[e.ve_ZA=1075]="ve_ZA",e[e.vi_VN=1066]="vi_VN",e[e.cy_GB=1106]="cy_GB",e[e.wo_SN=1160]="wo_SN",e[e.sah_RU=1157]="sah_RU",e[e.ii_CN=1144]="ii_CN",e[e.yi_Hebr=1085]="yi_Hebr",e[e.yo_NG=1130]="yo_NG",e[e.ja_JP=1041]="ja_JP"}(s||(s={}));var a;!function(e){e.EvenPage="EvenPage",e.NewPage="NewPage",e.Continuous="NoBreak",e.OddPage="OddPage"}(a||(a={}));var l={Tab:"\t",Paragraph:"\n",LineBreak:"\v",PageBreak:"\f",ColumnBreak:"",Image:"",Table:"",Row:"",Cell:"",Marker_Start:"",Marker_End:"",Field_Separator:"",Section_Break:""}},function(e,t,i){"use strict";i.d(t,"b",function(){return c}),i.d(t,"a",function(){return p});var n=i(0),r=(i.n(n),i(6)),o=i(27),s=i(12),a=i(13),l=i(30),d=i(2),h=i(22),c=function(){function e(){}return Object.defineProperty(e.prototype,"position",{get:function(){return this.positionIn},set:function(e){this.positionIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"deletePosition",{get:function(){return this.deletePositionIn},set:function(e){this.deletePositionIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tabJustification",{get:function(){return this.justification},set:function(e){this.justification=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tabLeader",{get:function(){return this.leader},set:function(e){this.leader=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.deletePosition=this.deletePosition,t.position=this.position,t.tabJustification=this.tabJustification,t.tabLeader=this.tabLeader,t},e.prototype.equals=function(e){return this.position===e.position&&this.deletePosition===e.deletePosition&&this.tabJustification===e.tabJustification&&this.tabLeader===e.tabLeader},e.prototype.destroy=function(){this.position=void 0,this.deletePosition=void 0,this.tabJustification=void 0,this.leader=void 0},e}(),p=function(){function e(e){this.uniqueParagraphFormat=void 0,this.ownerBase=void 0,this.baseStyle=void 0,this.tabs=void 0,this.ownerBase=e,this.listFormat=new l.a(this),this.borders=new o.a(this),this.tabs=[]}return e.prototype.getUpdatedTabs=function(){for(var e=[],t=new r.a,o=this.getTabStopsFromListFormat(),s=0,a=o;s<a.length;s++){var l=a[s];t.containsKey(l.position)||t.add(l.position,l)}if(!i.i(n.isNullOrUndefined)(this.baseStyle)&&this.baseStyle instanceof h.a){for(var d=this.baseStyle;!i.i(n.isNullOrUndefined)(d);){for(var c=0,p=d.paragraphFormat.tabs;c<p.length;c++){var u=p[c];t.containsKey(u.position)||t.add(u.position,u)}d=d.basedOn}for(var g=0,f=t.keys;g<f.length;g++){var m=f[g];this.hasTabStop(parseFloat(m.toFixed(4)))||e.push(t.get(m))}}return e=e.concat(this.tabs.filter(function(e){return 0!==e.position&&0===e.deletePosition})),e=e.sort(function(e,t){return e.position-t.position})},e.prototype.getTabStopsFromListFormat=function(){if(this.listFormat.listId>-1&&this.listFormat.listLevelNumber>-1){var e=this.listFormat.listLevel;if(e&&e.paragraphFormat)return e.paragraphFormat.tabs}return[]},e.prototype.hasTabStop=function(e){for(var t=0;t<this.tabs.length;t++)if(parseFloat(this.tabs[t].position.toFixed(4))===e||parseFloat(this.tabs[t].deletePosition.toFixed(4))===e)return!0;return!1},Object.defineProperty(e.prototype,"leftIndent",{get:function(){return this.getPropertyValue("leftIndent")},set:function(e){this.setPropertyValue("leftIndent",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightIndent",{get:function(){return this.getPropertyValue("rightIndent")},set:function(e){this.setPropertyValue("rightIndent",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstLineIndent",{get:function(){return this.getPropertyValue("firstLineIndent")},set:function(e){this.setPropertyValue("firstLineIndent",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"beforeSpacing",{get:function(){return this.getPropertyValue("beforeSpacing")},set:function(e){this.setPropertyValue("beforeSpacing",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"afterSpacing",{get:function(){return this.getPropertyValue("afterSpacing")},set:function(e){this.setPropertyValue("afterSpacing",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spaceBeforeAuto",{get:function(){return this.getPropertyValue("spaceBeforeAuto")},set:function(e){this.setPropertyValue("spaceBeforeAuto",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spaceAfterAuto",{get:function(){return this.getPropertyValue("spaceAfterAuto")},set:function(e){this.setPropertyValue("spaceAfterAuto",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineSpacing",{get:function(){return this.getPropertyValue("lineSpacing")},set:function(e){this.setPropertyValue("lineSpacing",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineSpacingType",{get:function(){return this.getPropertyValue("lineSpacingType")},set:function(e){this.setPropertyValue("lineSpacingType",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textAlignment",{get:function(){var e=this.getPropertyValue("textAlignment");return this.bidi&&("Left"===e?e="Right":"Right"===e&&(e="Left")),e},set:function(e){this.setPropertyValue("textAlignment",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"keepWithNext",{get:function(){return this.getPropertyValue("keepWithNext")},set:function(e){this.setPropertyValue("keepWithNext",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"keepLinesTogether",{get:function(){return this.getPropertyValue("keepLinesTogether")},set:function(e){this.setPropertyValue("keepLinesTogether",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"widowControl",{get:function(){return this.getPropertyValue("widowControl")},set:function(e){this.setPropertyValue("widowControl",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outlineLevel",{get:function(){return this.getPropertyValue("outlineLevel")},set:function(e){this.setPropertyValue("outlineLevel",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bidi",{get:function(){return this.getPropertyValue("bidi")},set:function(e){this.setPropertyValue("bidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contextualSpacing",{get:function(){return this.getPropertyValue("contextualSpacing")},set:function(e){this.setPropertyValue("contextualSpacing",e)},enumerable:!0,configurable:!0}),e.prototype.getListFormatParagraphFormat=function(t){var r=this.getListPargaraphFormat(t);if(!i.i(n.isNullOrUndefined)(r))return r.uniqueParagraphFormat.propertiesHash.get(s.a.getPropertyType(e.uniqueFormatType,t))},e.prototype.getListPargaraphFormat=function(t){if(this.listFormat.listId>-1&&this.listFormat.listLevelNumber>-1){var r=this.listFormat.listLevel,o=s.a.getPropertyType(e.uniqueFormatType,t);return i.i(n.isNullOrUndefined)(r)||i.i(n.isNullOrUndefined)(r.paragraphFormat.uniqueParagraphFormat)||!r.paragraphFormat.uniqueParagraphFormat.propertiesHash.containsKey(o)?void 0:r.paragraphFormat}if(this.listFormat.hasValue("listId")&&-1===this.listFormat.listId&&("leftIndent"===t||"firstLineIndent"===t)){var a=new e;return this.hasValue("leftIndent")||(a.leftIndent=0),this.hasValue("firstLineIndent")||(a.firstLineIndent=0),a}},e.prototype.getPropertyValue=function(t){if(this.hasValue(t)){var r=s.a.getPropertyType(e.uniqueFormatType,t);if(!i.i(n.isNullOrUndefined)(this.uniqueParagraphFormat)&&this.uniqueParagraphFormat.propertiesHash.containsKey(r))return this.uniqueParagraphFormat.propertiesHash.get(r)}else{var o=this.getListFormatParagraphFormat(t);if(this.baseStyle instanceof h.a){for(var a=this,l=this.baseStyle;!i.i(n.isNullOrUndefined)(l);){var d=void 0;if(this.listFormat.hasValue("listId")||(d=l.paragraphFormat.getListPargaraphFormat(t)),l.paragraphFormat.hasValue(t)){a=l.paragraphFormat;break}if(!i.i(n.isNullOrUndefined)(d)&&d.hasValue(t)){a=d;break}l=l.basedOn}if(!i.i(n.isNullOrUndefined)(l)){if(!i.i(n.isNullOrUndefined)(o)&&this.listFormat.hasValue("listId")&&-1===a.listFormat.listId&&a.listFormat.listLevelNumber<=1||!i.i(n.isNullOrUndefined)(o)&&this.listFormat.listId!==a.listFormat.listId&&a.listFormat.listLevelNumber<=1)return o;var r=s.a.getPropertyType(e.uniqueFormatType,t);return a.uniqueParagraphFormat.propertiesHash.get(r)}}if(!i.i(n.isNullOrUndefined)(o))return o}return this.getDefaultValue(t)},e.prototype.getDefaultValue=function(t){var r=s.a.getPropertyType(e.uniqueFormatType,t),o=this.getDocumentParagraphFormat(),a=!0;this.ownerBase&&this.ownerBase instanceof d.g&&(a=this.ownerBase.containerWidget instanceof d.h||this.ownerBase.containerWidget instanceof d.i||this.ownerBase.containerWidget instanceof d.j);var l=!i.i(n.isNullOrUndefined)(this.ownerBase)&&!i.i(n.isNullOrUndefined)(this.ownerBase.bodyWidget)&&this.ownerBase.bodyWidget.page&&!i.i(n.isNullOrUndefined)(this.ownerBase.bodyWidget.page.documentHelper)&&this.ownerBase.bodyWidget.page.documentHelper.owner.editor&&this.ownerBase.bodyWidget.page.documentHelper.owner.editor.isPaste;if(a&&!l&&!i.i(n.isNullOrUndefined)(o)&&!i.i(n.isNullOrUndefined)(o.uniqueParagraphFormat)){var h=o.uniqueParagraphFormat.propertiesHash.get(r);if(!i.i(n.isNullOrUndefined)(h))return h}return e.getPropertyDefaultValue(t)},e.prototype.getDocumentParagraphFormat=function(){var e;if(!i.i(n.isNullOrUndefined)(this.ownerBase)){var t=this.getDocumentHelperObject();i.i(n.isNullOrUndefined)(t)||(e=t.paragraphFormat)}return e},e.prototype.getDocumentHelperObject=function(){var e;if(this.ownerBase instanceof d.g){var t=this.ownerBase.bodyWidget;i.i(n.isNullOrUndefined)(t)||i.i(n.isNullOrUndefined)(t.page)||i.i(n.isNullOrUndefined)(t.page.documentHelper)||(e=t.page.documentHelper)}return e},e.prototype.setPropertyValue=function(t,r,o){if((i.i(n.isNullOrUndefined)(r)||""===r&&!o)&&(r=e.getPropertyDefaultValue(t)),i.i(n.isNullOrUndefined)(this.uniqueParagraphFormat))this.initializeUniqueParagraphFormat(t,r);else{var a=s.a.getPropertyType(this.uniqueParagraphFormat.uniqueFormatType,t);if(this.uniqueParagraphFormat.propertiesHash.containsKey(a)&&this.uniqueParagraphFormat.propertiesHash.get(a)===r)return;this.uniqueParagraphFormat=e.uniqueParagraphFormats.updateUniqueFormat(this.uniqueParagraphFormat,t,r)}},e.prototype.initializeUniqueParagraphFormat=function(t,i){var n=new r.a;this.addUniqueParaFormat("leftIndent",t,i,n),this.addUniqueParaFormat("rightIndent",t,i,n),this.addUniqueParaFormat("firstLineIndent",t,i,n),this.addUniqueParaFormat("textAlignment",t,i,n),this.addUniqueParaFormat("beforeSpacing",t,i,n),this.addUniqueParaFormat("afterSpacing",t,i,n),this.addUniqueParaFormat("spaceBeforeAuto",t,i,n),this.addUniqueParaFormat("spaceAfterAuto",t,i,n),this.addUniqueParaFormat("lineSpacing",t,i,n),this.addUniqueParaFormat("lineSpacingType",t,i,n),this.addUniqueParaFormat("outlineLevel",t,i,n),this.addUniqueParaFormat("bidi",t,i,n),this.addUniqueParaFormat("contextualSpacing",t,i,n),this.addUniqueParaFormat("keepWithNext",t,i,n),this.addUniqueParaFormat("keepLinesTogether",t,i,n),this.addUniqueParaFormat("widowControl",t,i,n),this.uniqueParagraphFormat=e.uniqueParagraphFormats.addUniqueFormat(n,e.uniqueFormatType)},e.prototype.addUniqueParaFormat=function(t,i,n,r){var o=s.a.getPropertyType(e.uniqueFormatType,t);t===i&&r.add(o,n)},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"leftIndent":case"rightIndent":case"firstLineIndent":t=0;break;case"textAlignment":t="Left";break;case"beforeSpacing":case"afterSpacing":t=0;break;case"spaceBeforeAuto":case"spaceAfterAuto":t=!1;break;case"lineSpacing":t=1;break;case"lineSpacingType":t="Multiple";break;case"styleName":t="Normal";break;case"outlineLevel":t="BodyText";break;case"bidi":case"contextualSpacing":case"keepWithNext":case"keepLinesTogether":t=!1;break;case"widowControl":t=!0}return t},e.prototype.clearIndent=function(){this.clearPropertyValue("leftIndent"),this.clearPropertyValue("firstLineIndent")},e.prototype.clearPropertyValue=function(e){if(this.setPropertyValue(e,void 0,!0),!i.i(n.isNullOrUndefined)(this.uniqueParagraphFormat)){var t=s.a.getPropertyType(this.uniqueParagraphFormat.uniqueFormatType,e);this.uniqueParagraphFormat.propertiesHash.containsKey(t)&&this.uniqueParagraphFormat.propertiesHash.remove(t)}},e.prototype.clearFormat=function(){i.i(n.isNullOrUndefined)(this.listFormat)||this.listFormat.clearFormat(),i.i(n.isNullOrUndefined)(this.borders)||this.borders.clearFormat(),i.i(n.isNullOrUndefined)(this.uniqueParagraphFormat)||0!==this.uniqueParagraphFormat.referenceCount||e.uniqueParagraphFormats.remove(this.uniqueParagraphFormat),this.uniqueParagraphFormat=void 0,i.i(n.isNullOrUndefined)(this.getDocumentHelperObject())||(this.baseStyle=this.getDocumentHelperObject().styles.findByName("Normal"))},e.prototype.destroy=function(){if(i.i(n.isNullOrUndefined)(this.uniqueParagraphFormat)||e.uniqueParagraphFormats.remove(this.uniqueParagraphFormat),this.uniqueParagraphFormat=void 0,i.i(n.isNullOrUndefined)(this.listFormat)||this.listFormat.destroy(),this.listFormat=void 0,this.tabs&&this.tabs.length>0){for(var t=0;t<this.tabs.length;t++)this.tabs[t].destroy();this.tabs=[],this.tabs=void 0}i.i(n.isNullOrUndefined)(this.borders)||this.borders.destroy(),this.borders=void 0,this.baseStyle=void 0,this.ownerBase=void 0},e.prototype.copyFormat=function(e){if(!i.i(n.isNullOrUndefined)(e)&&(i.i(n.isNullOrUndefined)(e.uniqueParagraphFormat)||this.updateUniqueParagraphFormat(e),i.i(n.isNullOrUndefined)(e.borders)||this.borders.copyFormat(e.borders),i.i(n.isNullOrUndefined)(e.listFormat)||this.listFormat.copyFormat(e.listFormat),i.i(n.isNullOrUndefined)(e.baseStyle)||(this.baseStyle=e.baseStyle),!i.i(n.isNullOrUndefined)(e.tabs)))for(var t=0;t<e.tabs.length;t++)this.tabs[t]=e.tabs[t]},e.prototype.updateUniqueParagraphFormat=function(t){var r=void 0;this.uniqueParagraphFormat&&(r=this.uniqueParagraphFormat.mergeProperties(t.uniqueParagraphFormat),0===this.uniqueParagraphFormat.referenceCount&&(e.uniqueParagraphFormats.remove(this.uniqueParagraphFormat),this.uniqueParagraphFormat=void 0)),this.uniqueParagraphFormat=new s.a(e.uniqueFormatType),i.i(n.isNullOrUndefined)(r)&&(r=this.uniqueParagraphFormat.mergeProperties(t.uniqueParagraphFormat)),this.uniqueParagraphFormat=e.uniqueParagraphFormats.addUniqueFormat(r,e.uniqueFormatType)},e.prototype.cloneFormat=function(){var t=new e(void 0);return t.uniqueParagraphFormat=this.uniqueParagraphFormat,t.baseStyle=this.baseStyle,i.i(n.isNullOrUndefined)(this.listFormat)?t.listFormat=void 0:(t.listFormat=this.listFormat.cloneListFormat(),t.listFormat.ownerBase=t),t.borders=i.i(n.isNullOrUndefined)(this.borders)?void 0:this.borders.cloneFormat(),t},e.prototype.hasValue=function(e){if(!i.i(n.isNullOrUndefined)(this.uniqueParagraphFormat)&&!i.i(n.isNullOrUndefined)(this.uniqueParagraphFormat.propertiesHash)){var t=s.a.getPropertyType(this.uniqueParagraphFormat.uniqueFormatType,e);return this.uniqueParagraphFormat.propertiesHash.containsKey(t)}return!1},e.clear=function(){this.uniqueParagraphFormats.clear()},e.prototype.applyStyle=function(e){this.baseStyle=e,this.listFormat.applyStyle(this.baseStyle)},e.prototype.getValue=function(e){return this.hasValue(e)?this.getPropertyValue(e):void 0},e.prototype.mergeFormat=function(e,t){t=!i.i(n.isNullOrUndefined)(t)&&t,i.i(n.isNullOrUndefined)(this.getValue("leftIndent"))&&(this.leftIndent=e.getValue("leftIndent")),i.i(n.isNullOrUndefined)(this.getValue("rightIndent"))&&(this.rightIndent=e.getValue("rightIndent")),i.i(n.isNullOrUndefined)(this.getValue("firstLineIndent"))&&(this.firstLineIndent=e.getValue("firstLineIndent")),i.i(n.isNullOrUndefined)(this.getValue("beforeSpacing"))&&(this.beforeSpacing=e.getValue("beforeSpacing")),i.i(n.isNullOrUndefined)(this.getValue("afterSpacing"))&&(this.afterSpacing=e.getValue("afterSpacing")),i.i(n.isNullOrUndefined)(this.getValue("spaceBeforeAuto"))&&(this.spaceBeforeAuto=e.getValue("spaceBeforeAuto")),i.i(n.isNullOrUndefined)(this.getValue("spaceAfterAuto"))&&(this.spaceAfterAuto=e.getValue("spaceAfterAuto")),i.i(n.isNullOrUndefined)(this.getValue("lineSpacing"))&&(this.lineSpacing=e.getValue("lineSpacing")),i.i(n.isNullOrUndefined)(this.getValue("lineSpacingType"))&&(this.lineSpacingType=e.getValue("lineSpacingType")),i.i(n.isNullOrUndefined)(this.getValue("textAlignment"))&&(this.textAlignment=e.getValue("textAlignment")),i.i(n.isNullOrUndefined)(this.getValue("outlineLevel"))&&(this.outlineLevel=e.getValue("outlineLevel")),!t&&i.i(n.isNullOrUndefined)(this.getValue("bidi"))&&(this.bidi=e.getValue("bidi")),i.i(n.isNullOrUndefined)(this.getValue("contextualSpacing"))&&(this.contextualSpacing=e.getValue("contextualSpacing")),i.i(n.isNullOrUndefined)(this.getValue("keepWithNext"))&&(this.keepWithNext=e.getValue("keepWithNext")),i.i(n.isNullOrUndefined)(this.getValue("keepLinesTogether"))&&(this.keepLinesTogether=e.getValue("keepLinesTogether")),i.i(n.isNullOrUndefined)(this.getValue("widowControl"))&&(this.widowControl=e.getValue("widowControl")),i.i(n.isNullOrUndefined)(this.listFormat)&&this.listFormat.mergeFormat(e.listFormat)},e.uniqueParagraphFormats=new a.a,e.uniqueFormatType=3,e}()},function(e,t){e.exports=s},function(e,t){e.exports=a},function(e,t,i){"use strict";i.d(t,"a",function(){return o}),i.d(t,"d",function(){return s}),i.d(t,"c",function(){return a}),i.d(t,"b",function(){return l});var n=i(7),r=i(0),o=(i.n(r),function(){function e(e){this.location=new n.l(0,0),this.isUpdateLocation=!0,this.owner=e,this.documentHelper=this.owner.documentHelper}return Object.defineProperty(e.prototype,"paragraph",{get:function(){return this.currentWidget.paragraph},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAtParagraphStart",{get:function(){return this.offset===this.owner.selection.getStartOffset(this.paragraph)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAtParagraphEnd",{get:function(){return this.owner.selection.isParagraphLastLine(this.currentWidget)&&this.offset===this.owner.selection.getLineLength(this.currentWidget)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCurrentParaBidi",{get:function(){return!i.i(r.isNullOrUndefined)(this.currentWidget.paragraph)&&this.currentWidget.paragraph.paragraphFormat.bidi},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selection",{get:function(){return this.owner.selection},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hierarchicalPosition",{get:function(){return this.getHierarchicalIndexInternal()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e(this.owner);return t.currentWidget=this.currentWidget,t.offset=this.offset,t.location=this.location,t},e.prototype.containsRtlText=function(e){for(var t=0;t<e.children.length;t++)if(e.children[t].isRightToLeft)return!0;return!1},e.prototype.setPositionForSelection=function(e,t,o,s){var a=!1;i.i(r.isNullOrUndefined)(t)?this.currentWidget=e:(this.currentWidget=t.line,t.nextNode instanceof n.m&&o>t.length&&(a=this.selection.isLastRenderedInline(t,t.length))),this.location=s,this.offset=a?this.selection.getParagraphLength(this.currentWidget.paragraph)+1:this.currentWidget.getOffset(t,o)},e.prototype.setPositionFromLine=function(e,t,i){this.currentWidget=e,this.offset=t,i instanceof n.l&&this.location.copy(i)},e.prototype.setPosition=function(e,t){this.currentWidget=e,this.offset=t?this.selection.getStartOffset(e.paragraph):e.paragraph.lastChild.getEndOffset()+1,this.updatePhysicalPosition(!0)},e.prototype.setPositionInternal=function(e){this.currentWidget=e.currentWidget,this.offset=e.offset,this.location=e.location},e.prototype.setPositionForCurrentIndex=function(e){var t={index:e},i=this.getParagraphWidget(t);this.offset=parseFloat(t.index),this.setPositionParagraph(i,this.offset)},e.prototype.getPage=function(e){var t=e.index.indexOf(";"),i="0";return t>=0&&(i=e.index.substring(0,t),e.index=e.index.substring(t).replace(";","")),t=parseInt(i,10),this.documentHelper.pages[t]},e.prototype.getParagraphWidget=function(e){if(!i.i(r.isNullOrUndefined)(e.index)){var t=this.getPage(e);return this.getLineWidget(void 0,e,t)}},e.prototype.getLineWidget=function(e,t,o){if(!i.i(r.isNullOrUndefined)(t.index)){var s=t.index.indexOf(";"),a="0";if(s>=0&&(a=t.index.substring(0,s),t.index=t.index.substring(s).replace(";","")),"H"===a||"F"===a)e="H"===a?o.headerWidget:o.footerWidget;else if("FN"===a||"EN"===a){var l=t.index.indexOf(";"),d=t.index.substring(0,l);t.index=t.index.substring(l).replace(";",""),e="FN"===a?o.footnoteWidget.bodyWidgets[d]:o.endnoteWidget.bodyWidgets[d]}else i.i(r.isNullOrUndefined)(o)||(e=parseInt(a,10)<o.bodyWidgets.length?o.bodyWidgets[parseInt(a,10)]:o.bodyWidgets[0]);if(s=parseInt(a,10),e instanceof n.n&&(s=t.index.indexOf(";"),a="0",a=t.index.substring(0,s),t.index=t.index.substring(s).replace(";",""),s=parseInt(a,10)),e instanceof n.o&&s>=e.childWidgets.length&&(t.index="0;0",s=e.childWidgets.length-1),s>=0&&s<e.childWidgets.length){var h=e.childWidgets[s];if(h instanceof n.p)return t.index.indexOf(";")>0&&(t.index="0"),h;if(h instanceof n.q){if(t.index.indexOf(";")>0)return this.getLineWidget(h,t);if(h instanceof n.r)return this.getLineWidget(this.documentHelper.getFirstParagraphInFirstCell(h),t);if(h instanceof n.o&&-1===t.index.indexOf(";"))return this.documentHelper.getFirstParagraphInFirstCell(h.ownerTable).childWidgets[0];return}}else if(e.nextRenderedWidget instanceof n.q)return t.index="0",e.nextRenderedWidget instanceof n.r?this.documentHelper.getFirstParagraphInFirstCell(e.nextRenderedWidget).firstChild:this.getLineWidget(e.nextRenderedWidget,t)}},e.prototype.updatePhysicalPosition=function(e){this.currentWidget&&this.owner.isLayoutEnabled&&this.isUpdateLocation&&(this.location=this.selection.getPhysicalPositionInternal(this.currentWidget,this.offset,e))},e.prototype.isAtSamePosition=function(e){return this.currentWidget===e.currentWidget&&this.offset===e.offset},e.prototype.isInSameParagraphIndex=function(e){if(i.i(r.isNullOrUndefined)(e))throw new Error("textPosition is undefined.");return this.paragraph.index===e.paragraph.index},e.prototype.isInSameParagraph=function(e){if(i.i(r.isNullOrUndefined)(e))throw new Error("textPosition is undefined.");return this.paragraph===e.paragraph},e.prototype.isExistBefore=function(e){if(i.i(r.isNullOrUndefined)(e))throw new Error("textPosition is undefined.");if(this.currentWidget===e.currentWidget)return this.offset<e.offset;var t=this.currentWidget.paragraph,n=e.currentWidget.paragraph;return t===n?t.childWidgets.indexOf(this.currentWidget)<n.childWidgets.indexOf(e.currentWidget):t.containerWidget===n.containerWidget?t.isInsideTable?t.associatedCell.childWidgets.indexOf(t)<n.associatedCell.childWidgets.indexOf(n):t.containerWidget.childWidgets.indexOf(t)<n.containerWidget.childWidgets.indexOf(n):this.owner.selection.isExistBefore(t,n)},e.prototype.isExistAfter=function(e){if(i.i(r.isNullOrUndefined)(e))throw new Error("textPosition is undefined.");if(this.currentWidget===e.currentWidget)return this.offset>e.offset;if(this.currentWidget.paragraph===e.currentWidget.paragraph)return this.currentWidget.paragraph.childWidgets.indexOf(this.currentWidget)>e.currentWidget.paragraph.childWidgets.indexOf(e.currentWidget);var t=this.currentWidget.paragraph,o=e.currentWidget.paragraph;return!i.i(r.isNullOrUndefined)(t)&&!i.i(r.isNullOrUndefined)(o)&&(t.containerWidget instanceof n.s&&o.containerWidget instanceof n.s&&t.containerWidget===o.containerWidget?t.isInsideTable&&o.isInsideTable?t.associatedCell.childWidgets.indexOf(t)>o.associatedCell.childWidgets.indexOf(o):t.containerWidget.childWidgets.indexOf(t)>o.containerWidget.childWidgets.indexOf(o):this.owner.selection.isExistAfter(t,o))},e.prototype.getHierarchicalIndexInternal=function(){return this.getHierarchicalIndex(this.currentWidget,this.offset.toString())},e.prototype.getHierarchicalIndex=function(e,t){var i=e;return i?i.getHierarchicalIndex(t):t},e.prototype.setPositionParagraph=function(e,t){this.currentWidget=e,this.offset=t,this.updatePhysicalPosition(!0)},e.prototype.setPositionForLineWidget=function(e,t){var n=this.selection.getLineLength(e),o=e.paragraph.childWidgets.indexOf(e);if(e.isLastLine()&&(i.i(r.isNullOrUndefined)(e.paragraph.bodyWidget.footNoteReference)?n+=1:n+=e.paragraph.bodyWidget.footNoteReference.text.length),t>n){var s=void 0;if(o>=e.paragraph.childWidgets.length-1){var a=this.selection.getNextRenderedBlock(e.paragraph);a&&a.index===e.paragraph.index&&(s=a.firstChild)}else s=e.paragraph.childWidgets[o+1];return void this.setPositionForLineWidget(s,t-n)}if(t<0){var l=e.paragraph.childWidgets[o-1],d=this.selection.getLineLength(l)+t;return void this.setPositionForLineWidget(l,d)}this.currentWidget=e,this.offset=t,this.updatePhysicalPosition(!0)},e.prototype.moveNextPosition=function(t){i.i(r.isNullOrUndefined)(t)&&(t=!0);var o=this.selection.getNextStartInline(this.currentWidget,this.offset);if(o instanceof n.m&&0===o.fieldType&&!i.i(r.isNullOrUndefined)(o.fieldEnd)){if(t)return this.moveNextPositionInternal(o),void this.moveNextPosition();var s=o.fieldEnd.line,a=o.fieldEnd,l=s.getOffset(a,1),d=this.getHierarchicalIndex(s,l.toString());if(e.isForwardSelection(this.selection.end.getHierarchicalIndexInternal(),d))return void this.selection.end.moveToInline(o.fieldEnd,1);this.moveToInline(o.fieldEnd,1)}var h=this.selection.getNextValidOffset(this.currentWidget,this.offset),c=this.paragraph.childWidgets.indexOf(this.currentWidget),p=0;if(h>this.offset){this.offset=h;var u=this.currentWidget.getInline(this.offset,p);if(o=u.element,p=u.index,!i.i(r.isNullOrUndefined)(o)&&p===o.length&&(o.nextNode instanceof n.m||o.nextNode instanceof n.t)){var g=this.selection.getNextValidElement(o.nextNode);(g instanceof n.m&&1===g.fieldType||g instanceof n.t&&1===g.bookmarkType)&&(o=g,this.currentWidget=o.line,this.offset=this.currentWidget.getOffset(o,this.documentHelper.isFormFillProtectedMode?0:1))}}else if(c+1<this.paragraph.childWidgets.length){var f=this.paragraph.childWidgets[c+1];f&&(this.currentWidget=f,this.offset=this.selection.getStartLineOffset(this.currentWidget));var m=this.currentWidget.getInline(this.offset,p);o=m.element,p=m.index,o instanceof n.m&&0===o.fieldType&&this.offset++}else this.updateOffsetToNextParagraph(p,!1);this.updatePhysicalPosition(!0)},e.prototype.moveToPreviousParagraphInTable=function(e){var t,n=this.currentWidget.paragraph;t=n.isInsideTable?e.getPreviousSelectionCell(n.associatedCell):e.getPreviousParagraphBlock(n),i.i(r.isNullOrUndefined)(t)||(this.currentWidget=t.childWidgets[t.childWidgets.length-1],this.offset=this.currentWidget.getEndOffset()+1)},e.prototype.updateOffsetToNextParagraph=function(e,t){var o,s=!1,a=void 0,l=this.paragraph.childWidgets.indexOf(this.currentWidget);if(t){if(l+1<this.paragraph.childWidgets.length){var d=this.paragraph.childWidgets[l+1];d&&(this.currentWidget=d,this.offset=1)}else if(a=this.selection.getNextSelectionBlock(this.paragraph),!i.i(r.isNullOrUndefined)(a)&&a.containerWidget instanceof n.u)if(this.selection.start.paragraph.isInsideTable){var h=this.selection.getContainerCellOf(this.selection.start.paragraph.associatedCell,a.associatedCell);s=!h.ownerTable.contains(a.associatedCell)}else s=!0}else a=this.selection.getNextParagraphBlock(this.paragraph);!i.i(r.isNullOrUndefined)(a)&&a.childWidgets.length>0&&(s?(this.currentWidget=a.childWidgets[a.childWidgets.length-1],this.offset=this.selection.getLineLength(this.currentWidget)+1):(this.currentWidget=a.firstChild,this.offset=t?1:this.selection.getStartLineOffset(this.currentWidget)));var c=this.currentWidget.getInline(this.offset,e);o=c.element,e=c.index,o instanceof n.m&&0===o.fieldType&&this.offset++},e.prototype.updateOffsetToPrevPosition=function(e,t){var o,s,a=this.paragraph.childWidgets.indexOf(this.currentWidget),l=this.selection.getPreviousValidOffset(this.currentWidget.paragraph,this.offset);if(this.offset>l)this.offset=l;else if(a>0){var d=this.paragraph.childWidgets[a-1];if(d){this.currentWidget=d;var h=this.currentWidget.getEndOffset();this.offset=h>0?h-1:h}}else{var c=void 0,p=!1;if(t){if(c=this.selection.getPreviousSelectionBlock(this.paragraph),!i.i(r.isNullOrUndefined)(c)&&c.containerWidget instanceof n.u)if(this.selection.start.paragraph.isInsideTable){var u=this.selection.getContainerCellOf(this.selection.start.paragraph.associatedCell,c.associatedCell);p=!u.ownerTable.contains(c.associatedCell)}else p=!0}else c=this.selection.getPreviousParagraphBlock(this.paragraph);i.i(r.isNullOrUndefined)(c)||(p?(this.currentWidget=c.firstChild,this.offset=this.selection.getStartLineOffset(this.currentWidget)):(this.currentWidget=c.childWidgets[c.childWidgets.length-1],this.offset=this.currentWidget.isEndsWithPageBreak||this.currentWidget.isEndsWithColumnBreak?this.currentWidget.getEndOffset()-1:this.currentWidget.getEndOffset()))}if(e=0,o=this.currentWidget.getInline(this.offset,e),s=o.element,e=o.index,s instanceof n.m&&0===s.fieldType&&this.offset++,s instanceof n.m){var g=this.selection.getPreviousValidElement(s);i.i(r.isNullOrUndefined)(g)||(s=g,this.currentWidget=s.line,this.offset=this.currentWidget.getOffset(s,s.length),s instanceof n.m&&0===s.fieldType&&this.offset--)}this.updatePhysicalPosition(!0)},e.prototype.moveToNextParagraphStartInternal=function(){var e=this.currentWidget.paragraph;i.i(r.isNullOrUndefined)(this.selection.getNextParagraphBlock(e))||(this.currentWidget=this.selection.getNextParagraphBlock(e).firstChild,this.offset=this.selection.getStartOffset(e),this.updatePhysicalPosition(!0))},e.prototype.movePreviousPosition=function(){var e=0,t=this.currentWidget.getInline(this.offset,e),o=t.element;e=t.index;this.paragraph.childWidgets.indexOf(this.currentWidget);(o instanceof n.m&&1===o.fieldType&&!i.i(r.isNullOrUndefined)(o.fieldBegin)||o instanceof n.t&&1===o.bookmarkType)&&this.movePreviousPositionInternal(o),this.updateOffsetToPrevPosition(e,!1)},e.prototype.moveNextPositionInternal=function(e){var t;i.i(r.isNullOrUndefined)(e.fieldSeparator)?t=e.fieldEnd:(t=e.fieldSeparator,this.currentWidget=t.line,this.currentWidget!==e.fieldEnd.line||this.selection.hasValidInline(this.paragraph,t,e.fieldEnd)||(t=e.fieldEnd)),this.currentWidget=t.line,this.offset=this.currentWidget.getOffset(t,1)},e.prototype.moveBackward=function(){var t=0,o=this.currentWidget.getInline(this.offset,t),s=o.element;if(t=o.index,!this.owner.selection.isEmpty&&!i.i(r.isNullOrUndefined)(s)){var a=this.selection.getNextRenderedElementBox(s,t);if(a instanceof n.m&&0===a.fieldType){var l=this.owner.selection.start.getHierarchicalIndexInternal(),d=a.fieldEnd.line.getOffset(a.fieldEnd,1),h=this.getHierarchicalIndex(a.fieldEnd.line,d.toString());if(!e.isForwardSelection(h,l))return void this.owner.selection.start.setPositionParagraph(a.fieldEnd.line,d)}}if(s instanceof n.m&&1===s.fieldType&&!i.i(r.isNullOrUndefined)(s.fieldBegin)){var l=this.owner.selection.start.getHierarchicalIndexInternal(),d=s.line.getOffset(s,1),h=this.getHierarchicalIndex(s.line,d.toString());if(!e.isForwardSelection(l,h)){var c=s.fieldBegin.line.getOffset(s.fieldBegin,0);return this.currentWidget=s.fieldBegin.line,this.offset=c,void this.updatePhysicalPosition(!0)}this.movePreviousPositionInternal(s)}this.updateOffsetToPrevPosition(t,!0)},e.prototype.moveForward=function(){var t=0,o=this.currentWidget.getInline(this.offset,t),s=o.element;if(t=o.index,!i.i(r.isNullOrUndefined)(s)){if(!this.owner.selection.isEmpty&&t===s.length&&s instanceof n.m&&1===s.fieldType){var a=this.owner.selection.start.getHierarchicalIndexInternal(),l=s.fieldBegin.line.getOffset(s.fieldBegin,0),d=this.getHierarchicalIndex(s.fieldBegin.line,l.toString());if(!e.isForwardSelection(a,d))return void this.owner.selection.start.setPositionParagraph(s.fieldBegin.line,l)}s=this.selection.getNextRenderedElementBox(s,t)}if(s instanceof n.m&&!i.i(r.isNullOrUndefined)(s.fieldEnd)){var h=this.owner.selection.start.paragraph,c=0,p=h.getInline(this.owner.selection.start.offset,c),u=p.element;c=p.index;if(this.selection.getNextRenderedElementBox(u,c)!==s)return s=s.fieldEnd,this.currentWidget=s.line,this.offset=this.currentWidget.getOffset(s,1),void this.updatePhysicalPosition(!0);this.moveNextPositionInternal(s)}else s instanceof n.m&&(0===s.fieldType||1===s.fieldType)&&(this.currentWidget=s.line,this.offset=this.currentWidget.getOffset(s,1));t=0;var g=this.selection.getNextValidOffset(this.currentWidget,this.offset),f=this.selection.getLineLength(this.currentWidget),m=this.selection.isParagraphLastLine(this.currentWidget);if(this.offset<g){this.offset=g;var v=this.currentWidget.getInline(this.offset,t);if(s=v.element,t=v.index,!i.i(r.isNullOrUndefined)(s)&&t===s.length&&s.nextNode instanceof n.m){var y=this.selection.getNextValidElement(s.nextNode);y instanceof n.m&&1===y.fieldType&&(s=y,this.offset=this.currentWidget.getOffset(s,1))}}else this.offset===g&&s instanceof n.m&&1===s.fieldType&&s.previousNode instanceof n.v?this.offset=g:this.offset===g&&this.offset<f+1&&m?this.offset=f+1:this.updateOffsetToNextParagraph(t,!0);this.updatePhysicalPosition(!0)},e.prototype.moveToInline=function(e,t){this.currentWidget=e.line,this.offset=this.currentWidget.getOffset(e,t),this.updatePhysicalPosition(!0)},e.isForwardSelection=function(e,t){if(e===t)return!0;e=e.replace(/S;/g,""),t=t.replace(/S;/g,""),e=e.replace(/C;/g,""),t=t.replace(/C;/g,""),e=e.replace(/H;/g,""),t=t.replace(/H;/g,""),e=e.replace(/F;/g,""),t=t.replace(/F;/g,""),e=e.replace(/FN;/g,""),t=t.replace(/FN;/g,""),e=e.replace(/EN;/g,""),t=t.replace(/EN;/g,"");var i=e.split(";"),n=t.split(";"),r=i.length;r>n.length&&(r=n.length-1);for(var o=0;o<r;o++){var s=parseFloat(i[o]),a=parseFloat(n[o]);if(s!==a)return s<a}return!1},e.prototype.movePreviousPositionInternal=function(e){var t;t=e instanceof n.m&&i.i(r.isNullOrUndefined)(e.fieldSeparator)?this.selection.getPreviousValidElement(e.fieldBegin):this.selection.getPreviousValidElement(e),this.currentWidget=t.line;var o=t instanceof n.m||t instanceof n.t&&1===t.bookmarkType?0:t.length;this.offset=this.currentWidget.getOffset(t,o)},e.prototype.moveToWordStartInternal=function(e){var t=this.currentWidget.getEndOffset(),o=this.currentWidget.paragraph,s=this.selection;if(2!==e||this.offset!==t&&this.offset!==t+1){if(this.offset===t+1)this.offset=t;else if(this.offset===s.getStartOffset(o)&&this.currentWidget===o.childWidgets[0]){var a=s.getPreviousParagraphBlock(o);if(i.i(r.isNullOrUndefined)(a))return;this.currentWidget=a.childWidgets[a.childWidgets.length-1],this.offset=this.currentWidget.getEndOffset()}else{if(this.offset===s.getStartLineOffset(this.currentWidget)){var l=o.childWidgets.indexOf(this.currentWidget);l-1>=0&&(this.currentWidget=o.childWidgets[l-1],this.offset=this.currentWidget.getEndOffset())}var d=0,h=this.currentWidget.getInline(this.offset,d),c=h.element;d=h.index,this.getPreviousWordOffset(c,s,d,e,c instanceof n.m&&1===c.fieldType,!1,!1,this)}1===e&&this.calculateOffset(),this.updatePhysicalPosition(!0)}},e.prototype.getNextWordOffset=function(e,t,i,r,o,s,a){e instanceof n.w?this.getNextWordOffsetSpan(e,t,i,r,o,s,a):e instanceof n.v?this.getNextWordOffsetImage(e,t,i,r,o,s,a):e instanceof n.m&&0===e.fieldType?this.getNextWordOffsetFieldBegin(e,t,i,r,o,s,a):e instanceof n.m&&2===e.fieldType||e instanceof n.t?this.getNextWordOffsetFieldSeparator(e,t,i,r,o,s,a):e instanceof n.m&&1===e.fieldType?this.getNextWordOffsetFieldEnd(e,t,i,r,o,s,a):e instanceof n.x&&this.getNextWordOffsetComment(e,t,i,r,o,s,a)},e.prototype.getNextWordOffsetFieldBegin=function(e,t,n,o,s,a,l){var d=e.line.getOffset(e,0);e.length;if(i.i(r.isNullOrUndefined)(e.fieldSeparator))this.getNextWordOffsetFieldEnd(e.fieldEnd,0,n,o,s,a,l);else if(0===n)this.getNextWordOffsetFieldSeparator(e.fieldSeparator,0,n,o,s,a,l);else if(!i.i(r.isNullOrUndefined)(e.fieldEnd)){var h=e.fieldSeparator;if(h.line.paragraph!==e.fieldEnd.line.paragraph||this.selection.hasValidInline(h.line.paragraph,h,e.fieldEnd)||(h=e.fieldEnd),this.getNextWordOffset(h,0,n,!(a.paragraph===e.line.paragraph&&a.offset===d),s,a,l),s&&!i.i(r.isNullOrUndefined)(e.fieldSeparator)&&a.paragraph===e.line.paragraph&&a.offset===e.fieldSeparator.line.getOffset(e.fieldSeparator,e.fieldSeparator.length))return void a.setPositionParagraph(e.line,d);s||a.setPositionParagraph(e.fieldEnd.line,e.fieldEnd.line.getOffset(e.fieldEnd,e.fieldEnd.length))}},e.prototype.getNextWordOffsetImage=function(e,t,n,o,s,a,l){if(o)return a.setPositionParagraph(e.line,e.line.getOffset(e,t)),void(s=!1);if(0===t){var d=e.line.getOffset(e,0);s=!0,a.offset===d?i.i(r.isNullOrUndefined)(e.nextNode)?a.setPositionParagraph(e.line,d+e.length):this.getNextWordOffset(e.nextNode,0,n,o,s,a,l):a.setPositionParagraph(e.line,d)}else i.i(r.isNullOrUndefined)(e.nextNode)||this.getNextWordOffset(e.nextNode,0,n,o,s,a,l)},e.prototype.getNextWordOffsetSpan=function(e,t,o,s,a,l,d){if("\t"===e.text||"\v"===e.text){if(s)return l.setPositionParagraph(e.line,e.line.getOffset(e,t)),void(a=!1);if(0===t){a=!0;var h=e.line.getOffset(e,0);l.offset===h?l.setPositionParagraph(e.line,h+e.length):l.setPositionParagraph(e.line,h)}else i.i(r.isNullOrUndefined)(e.nextNode)||this.getNextWordOffset(e.nextNode,0,o,s,a,l,d)}else{var c=0;if(0===t&&a&&-1===n.h.wordSplitCharacters.indexOf(e.text[0])){if(l.setPositionParagraph(e.line,e.line.getOffset(e,t)),s)return}else if(t<e.length){var p=t>0&&e.text.length-1>=t?e.text.slice(t,e.length):e.text;if(c=n.h.indexOfAny(p,n.h.wordSplitCharacters),-1===c&&e.nextNode instanceof n.x&&i.i(r.isNullOrUndefined)(e.nextNode.nextNode)&&(c=e.length),-1!==c){if(s)return void(a=!1);var u=e.line.getOffset(e,c+t),g=[" ",""];if((d||-1===g.indexOf(p[c]))&&!a&&e.line.paragraph===l.paragraph&&u!==l.offset)return a=!0,void l.setPositionParagraph(e.line,u);var f=!1;for(-1!==g.indexOf(p[c])&&-1===g.indexOf(p[c+1])&&(f=!0,c++);c<p.length&&!f&&-1!==n.h.wordSplitCharacters.indexOf(p[c]);)if(c++,-1!==g.indexOf(p[c])&&-1===g.indexOf(p[c+1])&&-1!==n.h.wordSplitCharacters.indexOf(p[c+1])){c++;break}a=!0;var m=void 0;i.i(r.isNullOrUndefined)(e.nextNode)||(m=e.nextNode.text),c<p.length||!i.i(r.isNullOrUndefined)(m)&&e.line==e.nextNode.line&&-1!==g.indexOf(p[p.length-1])&&-1===g.indexOf(m[0])?l.setPositionParagraph(e.line,e.line.getOffset(e,c+t)):i.i(r.isNullOrUndefined)(e.nextNode)?l.setPositionParagraph(e.line,e.line.getOffset(e,c+t)):this.getNextWordOffset(e.nextNode,0,o,s,a,l,d)}else i.i(r.isNullOrUndefined)(e.nextNode)?l.setPositionParagraph(e.line,e.line.getEndOffset()):this.getNextWordOffset(e.nextNode,0,o,s,a,l,d)}else i.i(r.isNullOrUndefined)(e.nextNode)||this.getNextWordOffset(e.nextNode,0,o,s,a,l,d)}},e.prototype.getNextWordOffsetFieldSeparator=function(e,t,n,o,s,a,l){i.i(r.isNullOrUndefined)(e.nextNode)||this.getNextWordOffset(e.nextNode,0,n,o,s,a,l)},e.prototype.getNextWordOffsetComment=function(e,t,n,o,s,a,l){i.i(r.isNullOrUndefined)(e.nextNode)||this.getNextWordOffset(e.nextNode,0,n,o,s,a,l)},e.prototype.getNextWordOffsetFieldEnd=function(e,t,n,o,s,a,l){var d=e.line.getOffset(e,0),h=d+e.length;a.offset===d&&(a.setPositionParagraph(e.line,h),i.i(r.isNullOrUndefined)(e.nextNode))||(i.i(r.isNullOrUndefined)(e.nextNode)?a.setPositionParagraph(e.line,d):(this.getNextWordOffset(e.nextNode,0,n,!1,s,a,l),a.offset===h&&a.setPositionParagraph(e.line,d)),s=!0)},e.prototype.getPreviousWordOffset=function(e,t,i,r,o,s,a,l){e instanceof n.w?this.getPreviousWordOffsetSpan(e,t,i,r,o,s,a,l):e instanceof n.v?this.getPreviousWordOffsetImage(e,t,i,r,o,s,a,l):e instanceof n.m&&0===e.fieldType?this.getPreviousWordOffsetFieldBegin(e,t,i,r,o,s,a,l):e instanceof n.m&&2===e.fieldType?this.getPreviousWordOffsetFieldSeparator(e,t,i,r,o,s,a,l):e instanceof n.m&&1===e.fieldType?this.getPreviousWordOffsetFieldEnd(e,t,i,r,o,s,a,l):e instanceof n.t?this.getPreviousWordOffsetBookMark(e,t,i,r,o,s,a,l):e instanceof n.y&&e.previousNode?this.getPreviousWordOffsetSpan(e.previousNode,t,i,r,o,s,a,l):e instanceof n.x&&this.getPreviousWordOffsetComment(e,t,i,r,o,s,a,l)},e.prototype.getPreviousWordOffsetBookMark=function(e,t,i,r,o,s,a,l){if(e.previousNode){if(e.previousNode instanceof n.w){var d=e.previousNode;n.h.lastIndexOfAny(d.text,n.h.wordSplitCharacters)!==d.text.length-1?this.getPreviousWordOffset(d,t,i,r,o,s,a,l):l.setPositionParagraph(e.line,e.line.getOffset(e,0))}}else l.setPositionParagraph(e.line,t.getStartLineOffset(e.line))},e.prototype.getPreviousWordOffsetFieldEnd=function(e,t,o,s,a,l,d,h){var c=e.line.getOffset(e,0),p=c+e.length;if(i.i(r.isNullOrUndefined)(e.fieldSeparator))this.getPreviousWordOffsetFieldBegin(e.fieldBegin,t,0,s,a,l,d,h);else if(0!==s||i.i(r.isNullOrUndefined)(e.previousNode)){if(!i.i(r.isNullOrUndefined)(e.fieldBegin)&&0!==s){var u=e.previousNode;if((i.i(r.isNullOrUndefined)(u)||u.line.paragraph===e.fieldBegin.line.paragraph&&!t.hasValidInline(u.line.paragraph,u,e.fieldBegin))&&(u=e.fieldBegin),this.getPreviousWordOffset(u,t,u.length,s,!(h.paragraph===e.line.paragraph&&h.offset===p),l,d,h),d&&h.paragraph===e.line.paragraph&&h.offset===c)return void h.setPositionParagraph(e.line,p);d||h.setPositionParagraph(e.fieldBegin.line,e.fieldBegin.line.getOffset(e.fieldBegin,0))}}else{var u=e.previousNode;this.getPreviousWordOffset(u,t,u.length,s,u instanceof n.m&&1===u.fieldType,l,d,h)}},e.prototype.getPreviousWordOffsetFieldSeparator=function(e,t,i,n,r,o,s,a){this.getPreviousWordOffsetFieldBegin(e.fieldBegin,t,e.fieldBegin.length,n,r,o,s,a)},e.prototype.getPreviousWordOffsetComment=function(e,t,i,r,o,s,a,l){if(e.previousNode){var d=e.previousNode;e.previousNode instanceof n.w&&n.h.lastIndexOfAny(d.text,n.h.wordSplitCharacters)!==d.text.length-1?this.getPreviousWordOffset(d,t,i,r,o,s,a,l):this.getPreviousWordOffset(e.previousNode,t,e.previousNode.length,r,o,s,a,l)}else l.setPositionParagraph(e.line,t.getStartLineOffset(e.line))},e.prototype.getPreviousWordOffsetFieldBegin=function(e,t,n,o,s,a,l,d){var h=e.line.getOffset(e,0),c=h+e.length;d.offset===c&&d.setPositionParagraph(e.line,h),i.i(r.isNullOrUndefined)(e.previousNode)?e.fieldSeparator?d.setPositionParagraph(e.line,e.fieldSeparator.line.getOffset(e.fieldSeparator,e.fieldSeparator.length)):d.setPositionParagraph(e.line,t.getStartLineOffset(e.line)):(this.getPreviousWordOffset(e.previousNode,t,e.previousNode.length,o,!1,a,l,d),d.offset===h&&(0===o||i.i(r.isNullOrUndefined)(e.fieldSeparator)||d.setPositionParagraph(e.line,e.fieldSeparator.line.getOffset(e.fieldSeparator,e.fieldSeparator.length))))},e.prototype.getPreviousWordOffsetImage=function(e,t,n,o,s,a,l,d){if(s)return d.setPositionParagraph(e.line,e.line.getOffset(e,n)),void(l=!1);if(n===e.length){var h=e.line.getOffset(e,e.length);h===d.offset?d.setPositionParagraph(e.line,h-e.length):d.setPositionParagraph(e.line,h)}else i.i(r.isNullOrUndefined)(e.previousNode)||this.getPreviousWordOffset(e.previousNode,t,e.previousNode.length,o,s,a,l,d)},e.prototype.getPreviousWordOffsetSpan=function(e,t,o,s,a,l,d,h){if("\t"===e.text||"\v"===e.text){if(a)return void(d=!1);if(o===e.length){d=!0;var c=e.line.getOffset(e,e.length);c===h.offset?h.setPositionParagraph(e.line,c-e.length):h.setPositionParagraph(e.line,c)}else i.i(r.isNullOrUndefined)(e.previousNode)||this.getPreviousWordOffset(e.previousNode,t,e.previousNode.length,s,a,l,d,h)}else{var p=0;if(!l){for(;o>0&&" "===e.text[o-1];)o--;h.setPositionParagraph(e.line,e.line.getOffset(e,o))}if(o>0){if(l=!0,0===o&&d&&-1===n.h.wordSplitCharacters.indexOf(e.text[0]))return h.setPositionParagraph(e.line,e.line.getOffset(e,o)),void(d=!0);var u=e.text.length>o?e.text.slice(0,o):e.text;if(p=n.h.lastIndexOfAny(u,n.h.wordSplitCharacters),-1===p&&e.previousElement instanceof n.x&&i.i(r.isNullOrUndefined)(e.previousNode.previousNode)&&(p=e.length),-1!==p){if(a)return void(d=!1);for(;p>0&&d&&" "!==u[p]&&-1!==n.h.wordSplitCharacters.indexOf(u[p-1]);)p--;if(" "!==u[p]&&""!==u[p]&&d||p++,d=!0,p>0){var g=e.line.getOffset(e,p);e.line.paragraph===h.paragraph&&g===h.offset?this.getPreviousWordOffsetSpan(e,t,o,s,a,l,d,h):h.setPositionParagraph(e.line,g)}else if(e.previousNode instanceof n.w){var f=e.previousNode.text;if(-1!==n.h.wordSplitCharacters.indexOf(e.text[0])&&-1===n.h.wordSplitCharacters.indexOf(f[f.length-1])){var g=e.line.getOffset(e,p);return void h.setPositionParagraph(e.line,g)}this.getPreviousWordOffset(e.previousNode,t,e.previousNode.length,s,a,l,d,h)}else h.setPositionParagraph(e.line,e.line.getOffset(e,0))}else this.setPreviousWordOffset(e,t,o,s,a,l,d,h)}else this.setPreviousWordOffset(e,t,o,s,a,l,d,h)}},e.prototype.setPreviousWordOffset=function(e,t,i,r,o,s,a,l){e.previousNode instanceof n.z&&e.line===e.previousNode.line?this.getPreviousWordOffset(e.previousNode,t,e.previousNode.length,r,o,s,a,l):l.setPositionParagraph(e.line,t.getStartLineOffset(e.line))},e.prototype.validateForwardFieldSelection=function(t,o){var s=new e(this.owner);s.setPositionForCurrentIndex(t),s.isUpdateLocation=!1;var a=!1;for(this.selection.start.paragraph===this.selection.end.paragraph&&this.selection.start.offset!==this.selection.getStartOffset(this.selection.start.paragraph)||this.selection.end.offset===this.selection.end.currentWidget.getEndOffset()&&this.selection.isParagraphLastLine(this.selection.end.currentWidget)&&this.selection.end.setPositionParagraph(this.selection.end.currentWidget,this.selection.end.offset+1);t!==o&&e.isForwardSelection(t,o);){if(!a){s.moveNextPosition(!1);if(t===s.getHierarchicalIndexInternal())break}var l=0,d=s.currentWidget.getInline(s.offset,l),h=d.element;if(l=d.index,!i.i(r.isNullOrUndefined)(h)){var c=this.selection.start.getHierarchicalIndexInternal();if(l===h.length&&h instanceof n.m&&1===h.fieldType){if(h.line.getOffset(h,0)===this.offset)return;var p=h.fieldBegin.line,u=p.getOffset(h.fieldBegin,0),g=this.getHierarchicalIndex(p,u.toString());e.isForwardSelection(c,g)||this.selection.start.setPositionParagraph(p,u)}var f=this.selection.getNextRenderedElementBox(h,l);!i.i(r.isNullOrUndefined)(f)&&f instanceof n.z&&(h=f)}if(a=h instanceof n.m&&0===h.fieldType&&!i.i(r.isNullOrUndefined)(h.fieldEnd)){if(h.line.getOffset(h,0)===this.offset)return;var m=h.fieldEnd,v=(m.line.paragraph,m.line.getOffset(m,1)),y=this.getHierarchicalIndex(m.line,v.toString());if(!e.isForwardSelection(y,o))return void this.moveToInline(h.fieldEnd,1);s.moveToInline(h.fieldEnd,1)}t=s.getHierarchicalIndexInternal()}},e.prototype.validateBackwardFieldSelection=function(t,o){var s=new e(this.owner);s.setPositionForCurrentIndex(t),s.isUpdateLocation=!1;var a=!1;(this.selection.start.paragraph!==this.selection.end.paragraph&&this.selection.end.offset!==this.selection.getStartOffset(this.selection.start.paragraph)||this.documentHelper.isSelectionChangedOnMouseMoved&&this.selection.isParagraphFirstLine(this.selection.end.currentWidget)&&this.selection.end.offset===this.selection.getStartOffset(this.selection.start.paragraph)||(i.i(r.isNullOrUndefined)(this.selection.start.paragraph.previousRenderedWidget)&&this.selection.start.paragraph===this.selection.end.paragraph&&this.selection.end.offset===this.selection.getStartOffset(this.selection.end.paragraph)||this.selection.start.paragraph!==this.selection.end.paragraph)&&this.selection.start.offset===this.selection.start.currentWidget.getEndOffset()&&this.selection.start.currentWidget.isLastLine())&&(a=!0),a&&this.selection.start.offset===this.selection.start.currentWidget.getEndOffset()&&this.selection.isParagraphLastLine(this.selection.start.currentWidget)&&this.selection.start.setPositionParagraph(this.selection.start.currentWidget,this.selection.start.offset+1);for(var l=this.selection.start.getHierarchicalIndexInternal();t!==o&&e.isForwardSelection(o,t);){var d=0,h=s.currentWidget.getInline(s.offset,d),c=h.element;if(d=h.index,!i.i(r.isNullOrUndefined)(c)){var p=this.selection.getNextRenderedElementBox(c,d);if(p instanceof n.m&&0===p.fieldType){var u=p.fieldEnd.line,g=u.getOffset(p.fieldEnd,1),f=this.getHierarchicalIndex(u,g.toString());e.isForwardSelection(f,l)||(this.selection.start.setPositionParagraph(u,g),l=f)}}if(c instanceof n.m&&1===c.fieldType&&!i.i(r.isNullOrUndefined)(c.fieldBegin)){var m=c.fieldBegin.line,v=c.fieldBegin,y=m.getOffset(v,0),w=this.getHierarchicalIndex(m,y.toString());if(!e.isForwardSelection(o,w))return void this.moveToInline(c.fieldBegin,0);s.moveToInline(c.fieldBegin,0)}else s.movePreviousPosition();t=s.getHierarchicalIndexInternal()}},e.prototype.paragraphStartInternal=function(e,t){var n=e.getStartLineOffset(this.currentWidget);if(this.offset===n&&t){if(this.moveToNextParagraphInTableCheck())this.moveToPreviousParagraphInTable(e);else if(!i.i(r.isNullOrUndefined)(e.getPreviousParagraphBlock(this.currentWidget.paragraph))){var o=e.getPreviousParagraphBlock(this.currentWidget.paragraph);this.currentWidget=o.childWidgets[0],this.offset=e.getStartLineOffset(this.currentWidget)}}else this.currentWidget=this.currentWidget.paragraph.getSplitWidgets()[0].childWidgets[0],this.offset=n;this.calculateOffset()},e.prototype.calculateOffset=function(){var e=this.owner.selection.start.getHierarchicalIndexInternal(),t=this.getHierarchicalIndexInternal();e!==t&&this.validateBackwardFieldSelection(e,t),this.updatePhysicalPosition(!0)},e.prototype.moveToParagraphStartInternal=function(e,t){for(var n=this.currentWidget.paragraph;n.previousSplitWidget;)n=n.previousSplitWidget;var o=e.getStartOffset(n);if(this.offset===o&&t){this.moveToNextParagraphInTableCheck()?this.moveToPreviousParagraphInTable(e):i.i(r.isNullOrUndefined)(e.getPreviousParagraphBlock(this.paragraph))||(this.currentWidget=e.getPreviousParagraphBlock(this.paragraph).firstChild,this.offset=e.getStartOffset(this.paragraph))}else this.currentWidget=n.firstChild,this.offset=e.getStartLineOffset(this.currentWidget);var s=this.owner.selection.start.getHierarchicalIndexInternal(),a=this.getHierarchicalIndexInternal();s!==a&&this.validateBackwardFieldSelection(s,a),this.updatePhysicalPosition(!1)},e.prototype.moveToParagraphEndInternal=function(e,t){for(var n=this.currentWidget.paragraph;n.nextSplitWidget;)n=n.nextSplitWidget;this.currentWidget=n.childWidgets[n.childWidgets.length-1];var o=this.currentWidget.getEndOffset()+1;if(this.offset===o&&t){if(this.moveToNextParagraphInTableCheck())this.moveToNextParagraphInTable();else if(!i.i(r.isNullOrUndefined)(e.getNextParagraphBlock(this.currentWidget.paragraph))){var s=e.getNextParagraphBlock(this.currentWidget.paragraph);this.currentWidget=s.childWidgets[s.childWidgets.length-1],this.offset=this.currentWidget.getEndOffset()+1}}else this.offset=o;this.calculateOffset()},e.prototype.moveUp=function(e,t){var o=this.currentWidget.paragraph;this.moveToLineStartInternal(e,!0),this.movePreviousPosition();var s=void 0,a=this.currentWidget.paragraph;if(o.isInsideTable&&o!==a&&o.associatedCell!==a.associatedCell&&!i.i(r.isNullOrUndefined)(a.associatedCell)&&o.associatedCell.ownerRow===a.associatedCell.ownerRow){var l=a.associatedCell.ownerRow;if(l.previousRenderedWidget instanceof n.o){var d=e.getFirstCellInRegion(l.previousRenderedWidget,a.associatedCell,t,!0),h=e.getLastParagraph(d);this.setPosition(h.childWidgets[h.childWidgets.length-1],!1)}else{var c=l.ownerTable.previousRenderedWidget;do{c instanceof n.r&&(c=e.getLastBlockInLastCell(c))}while(c instanceof n.r);c instanceof n.A&&this.setPosition(c.childWidgets[c.childWidgets.length-1],!1)}s=e.getLineWidgetParagraph(this.offset,this.currentWidget)}else{if(!o.isInsideTable&&this.currentWidget.paragraph.isInsideTable){var d=e.getFirstCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow,this.currentWidget.paragraph.associatedCell,this.owner.selection.upDownSelectionLength,!0),h=e.getLastParagraph(d);this.setPosition(h.childWidgets[h.childWidgets.length-1],!1)}else if(o.isInsideTable&&!i.i(r.isNullOrUndefined)(this.currentWidget.paragraph.associatedCell)&&o.associatedCell.ownerRow.previousRenderedWidget!==o.associatedCell.ownerRow.previousSplitWidget&&o.associatedCell.ownerRow.previousRenderedWidget===this.currentWidget.paragraph.associatedCell.ownerRow){var d=e.getLastCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow,this.currentWidget.paragraph.associatedCell,this.owner.selection.upDownSelectionLength,!0),h=e.getLastParagraph(d);this.setPosition(h.childWidgets[h.childWidgets.length-1],!1)}s=e.getLineWidgetParagraph(this.offset,this.currentWidget)}var p=e.getTop(s);(this.currentWidget.isEndsWithPageBreak||this.currentWidget.isEndsWithColumnBreak)&&this.offset===this.currentWidget.getEndOffset()-1&&(t=this.location.x),e.updateTextPositionWidget(s,new n.l(t,p),this,!1)},e.prototype.moveDown=function(e,t){var o=this.currentWidget.paragraph,s=this.currentWidget;this.moveToLineEndInternal(e,!0);var a=this.selection.getParagraphLength(this.currentWidget.paragraph);this.offset>a&&(this.offset=a),this.moveNextPosition();var l=void 0;if(o.isInsideTable&&o!==this.currentWidget.paragraph&&o.associatedCell!==this.currentWidget.paragraph.associatedCell&&!i.i(r.isNullOrUndefined)(this.currentWidget.paragraph.associatedCell)&&o.associatedCell.ownerRow===this.currentWidget.paragraph.associatedCell.ownerRow){var d=this.currentWidget.paragraph.associatedCell.ownerRow;if(o.isInsideTable&&this.currentWidget.paragraph.isInsideTable&&o.associatedCell.cellFormat.rowSpan>1&&o.associatedCell.cellFormat.rowSpan+o.associatedCell.ownerRow.rowIndex===o.associatedCell.ownerTable.childWidgets.length&&(d=this.currentWidget.paragraph.associatedCell.ownerTable.childWidgets[this.currentWidget.paragraph.associatedCell.ownerTable.childWidgets.length-1]),d.nextRenderedWidget instanceof n.o){var h=this.selection.getLastCellInRegion(d.nextRenderedWidget,this.currentWidget.paragraph.associatedCell,t,!1);this.setPosition(this.selection.getFirstParagraph(h).childWidgets[0],!0)}else{var c=this.selection.getNextRenderedBlock(d.ownerTable);do{c instanceof n.r&&(c=this.selection.getFirstBlockInFirstCell(c))}while(c instanceof n.r);c instanceof n.A&&this.setPosition(c.childWidgets[0],!0)}l=e.getLineWidgetParagraph(this.offset,this.currentWidget)}else{if(!o.isInsideTable&&this.currentWidget.paragraph.isInsideTable){var h=this.selection.getLastCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow,this.currentWidget.paragraph.associatedCell,this.owner.selection.upDownSelectionLength,!1);this.setPosition(this.selection.getFirstParagraph(h).childWidgets[0],!0)}else if(o.isInsideTable&&!i.i(r.isNullOrUndefined)(this.currentWidget.paragraph.associatedCell)&&o.associatedCell.ownerRow.nextRenderedWidget!==o.associatedCell.ownerRow.nextSplitWidget&&o.associatedCell.ownerRow.nextRenderedWidget===this.currentWidget.paragraph.associatedCell.ownerRow){var h=e.getLastCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow,this.currentWidget.paragraph.associatedCell,this.owner.selection.upDownSelectionLength,!0);this.setPosition(e.getFirstParagraph(h).childWidgets[0],!1)}l=e.getLineWidgetParagraph(this.offset,this.currentWidget)}var p=this.selection.getTop(l);l!==s&&this.selection.updateTextPositionWidget(l,new n.l(t,p),this,!1)},e.prototype.moveToLineStartInternal=function(e,t){this.location.x>this.viewer.clientActiveArea.right&&(this.offset=this.offset-1);var o=e.getLineWidgetInternal(this.currentWidget,this.offset,t),s=e.getFirstElementInternal(o);this.documentHelper.moveCaretPosition=1;var a=e.getStartOffset(this.currentWidget.paragraph);if(i.i(r.isNullOrUndefined)(s)&&this.offset>a){var l=0,d=this.currentWidget.getInline(this.offset,l),h=d.element;l=d.index,h instanceof n.w&&"\v"!==h.text&&(this.offset=a)}else if(!i.i(r.isNullOrUndefined)(s)){var c=0;this.currentWidget=s.line,this.offset=this.currentWidget.getOffset(s,c),c=0;var d=this.currentWidget.getInline(this.offset,c),h=d.element;if(c=d.index,h instanceof n.m){var p=e.getPreviousValidElement(h);i.i(r.isNullOrUndefined)(p)||(h=p,this.currentWidget=h.line,this.offset=this.currentWidget.getOffset(h,h.length),h instanceof n.m&&this.offset--)}}this.updatePhysicalPosition(!0)},e.prototype.moveToNextParagraphInTableCheck=function(){return!(!this.selection.start.paragraph.isInsideTable&&!this.paragraph.isInsideTable||this.selection.start.paragraph.associatedCell===this.paragraph.associatedCell&&!this.selection.isCellSelected(this.selection.start.paragraph.associatedCell,this.selection.start,this))},e.prototype.moveToWordEndInternal=function(e,t){var o=0,s=this.currentWidget.getEndOffset();if(this.selection.isParagraphFirstLine(this.currentWidget)&&(this.currentWidget.children[0]instanceof n.y&&(o=1),this.currentWidget.children[1]instanceof n.y&&(o=2)),this.offset+o!==s&&this.offset!==s+1||!i.i(r.isNullOrUndefined)(this.currentWidget.nextLine)){var a=0,l=this.currentWidget.getInline(this.offset,a),d=l.element;a=l.index,this.getNextWordOffset(d,a,e,!1,!1,this,t)}else if(this.offset===s&&0!==e)this.setPositionParagraph(this.currentWidget,s+1);else{var h=this.selection.getNextParagraphBlock(this.currentWidget.paragraph);if(i.i(r.isNullOrUndefined)(h))return;if(this.currentWidget=h.childWidgets[0],this.offset=this.selection.getStartLineOffset(this.currentWidget),1===e){var c=this.moveToNextParagraphInTableCheck();c?this.moveToNextParagraphInTable():this.moveToWordEndInternal(e,t)}}if(0!==e){var p=this.owner.selection.start.getHierarchicalIndexInternal(),u=this.getHierarchicalIndexInternal();p!==u&&this.validateForwardFieldSelection(p,u)}this.updatePhysicalPosition(!0)},e.prototype.moveToNextParagraphInTable=function(){var e=this.currentWidget.paragraph,t=e.isInsideTable?this.selection.getNextSelectionCell(e.associatedCell):this.selection.getNextParagraphBlock(e);i.i(r.isNullOrUndefined)(t)||(this.currentWidget=t.childWidgets[t.childWidgets.length-1],this.offset=this.currentWidget.getEndOffset()+1)},e.prototype.moveToPreviousParagraph=function(e){var t=e.getStartOffset(this.currentWidget.paragraph);if(this.offset!==t||i.i(r.isNullOrUndefined)(e.getPreviousParagraphBlock(this.currentWidget.paragraph)))this.offset=e.getStartOffset(this.currentWidget.paragraph);else{var n=e.getPreviousParagraphBlock(this.currentWidget.paragraph);this.currentWidget=n.childWidgets[0],this.offset=e.getStartOffset(this.currentWidget.paragraph)}this.updatePhysicalPosition(!0)},e.prototype.moveToPreviousLine=function(e,t){var i=this.getHierarchicalIndexInternal(),r=e.getLineWidgetParagraph(this.offset,this.currentWidget);this.moveToLineStartInternal(e,!0),this.currentWidget.paragraph.isInsideTable?this.moveUpInTable(e):this.moveBackward();var o=e.getLineWidgetParagraph(this.offset,this.currentWidget),s=e.getLeft(o);if(e.getWidth(o,!0)+s>=t&&r!==o){var a=e.getTop(o),l=new n.l(t,a);e.updateTextPositionWidget(o,l,this,!0)}var d=this.getHierarchicalIndexInternal();this.validateBackwardFieldSelection(i,d)},e.prototype.moveToLineEndInternal=function(e,t){this.location.x>this.viewer.clientActiveArea.right&&(this.offset=this.offset-1);var o=e.getLineWidgetParagraph(this.offset,this.currentWidget),s=e.getFirstElementInternal(o),a=this.currentWidget.paragraph.paragraphFormat.bidi;if(this.documentHelper.moveCaretPosition=2,i.i(r.isNullOrUndefined)(s)&&this.offset===e.getStartLineOffset(this.currentWidget))this.offset=e.getParagraphLength(this.paragraph)+1,this.updatePhysicalPosition(!0);else if(!i.i(r.isNullOrUndefined)(s)){var l=void 0;if(a&&this.containsRtlText(o)){var d=o.getEndOffset();l=o.getInline(d,0).element}else(l=o.children[o.children.length-1])instanceof n.y&&o.children.length>2&&(l=o.children[o.children.length-3]);var h=0;if(h+=l instanceof n.w?l.length:1,this.currentWidget=l.line,h===l.length&&i.i(r.isNullOrUndefined)(l.nextNode)&&e.isParagraphLastLine(this.currentWidget)){var c=e.getLineLength(this.currentWidget);this.offset=t?c+1:c}else{for(var p=l;!i.i(r.isNullOrUndefined)(p)&&p.length===h&&p.nextNode instanceof n.m;){var u=e.getNextValidElement(p.nextNode);if(p!==u&&(p=u,h=0),p instanceof n.m&&0===p.fieldType&&!i.i(r.isNullOrUndefined)(p.fieldEnd)){var g=p;i.i(r.isNullOrUndefined)(g.fieldSeparator)?p=g.fieldEnd:(p=g.fieldSeparator,this.currentWidget=p.line,this.currentWidget!==g.fieldEnd.line||e.hasValidInline(this.currentWidget.paragraph,p,g.fieldEnd)||(p=g.fieldEnd)),this.currentWidget=p.line}p instanceof n.m&&(h=1)}h===p.length&&i.i(r.isNullOrUndefined)(p.nextNode)&&h++,!t&&p instanceof n.z&&"\v"===p.text&&h--,this.offset=this.currentWidget.getOffset(p,h)}this.updatePhysicalPosition(t)}},e.prototype.moveToNextLine=function(t){var o=this.selection,s=new e(this.owner);s.setPositionInternal(this);var a=this.getHierarchicalIndexInternal();o.getLineWidgetParagraph(this.offset,this.currentWidget);this.moveToLineEndInternal(o,!0);var l=!s.isAtSamePosition(this);if(s.setPositionInternal(this),this.currentWidget.paragraph.isInsideTable)this.moveDownInTable(o);else{this.moveNextPosition();0===this.offset||this.moveForward()}var d=o.getLineWidgetParagraph(this.offset,this.currentWidget),h=o.getLeft(d),c=o.getFirstElementInternal(d),p=i.i(r.isNullOrUndefined)(c)?o.getWidth(d,!0):o.getLeftInternal(d,c,1)-h;if(h<t&&p/2<t-h){var u=o.getTop(d),g=new n.l(t,u);o.updateTextPositionWidget(d,g,this,!0);o.getWidth(d,!0)<t-h&&this.moveToLineEndInternal(o,!0)}else l&&this.currentWidget.paragraph.isInsideTable&&this.currentWidget===this.owner.selection.start.currentWidget?this.setPositionInternal(s):l||this.moveToLineEndInternal(o,!0);var f=this.getHierarchicalIndexInternal();this.validateForwardFieldSelection(a,f)},e.prototype.moveUpInTable=function(e){var t=!1,n=this.owner.selection.end,o=!this.owner.selection.isEmpty;if(t=n.paragraph.isInsideTable){var s=this.currentWidget.paragraph.associatedCell,a=n.paragraph.associatedCell,l=e.getContainerCellOf(a,s);if(t=l.ownerTable.contains(s)){a=e.getSelectedCell(a,l),s=e.getSelectedCell(s,l);var d=e.containsCell(l,this.currentWidget.paragraph.associatedCell),h=e.isCellSelected(l,this,n);if(h||(h=this.currentWidget.paragraph===e.getFirstParagraph(l)&&this.isAtParagraphStart),(d&&h||!d)&&!i.i(r.isNullOrUndefined)(s.ownerRow.previousRenderedWidget)){var c=s.ownerRow.previousRenderedWidget,p=e.getFirstCellInRegion(c,l,this.owner.selection.upDownSelectionLength,!0),u=e.getLastParagraph(p);return void this.setPosition(u.childWidgets[0],!0)}if(d&&h&&i.i(r.isNullOrUndefined)(s.ownerRow.previousRenderedWidget)||!d)if(o){s=s.ownerRow.childWidgets[0];var u=e.getFirstParagraph(s);this.setPosition(u.childWidgets[0],!0)}else{s=s.ownerRow.childWidgets[s.ownerRow.childWidgets.length-1];var u=e.getLastParagraph(s);this.setPosition(u.childWidgets[0],!1)}}}if(!t){var p=e.getContainerCell(this.currentWidget.paragraph.associatedCell);if(o){p=p.ownerRow.childWidgets[0];var u=e.getFirstParagraph(p);this.setPosition(u.childWidgets[0],!0)}else{p=p.ownerRow.childWidgets[p.ownerRow.childWidgets.length-1];var u=e.getLastParagraph(p);this.setPosition(u.childWidgets[0],!1)}}this.moveBackward()},e.prototype.moveDownInTable=function(e){var t=!1,n=this.owner.selection.isEmpty||this.owner.selection.isForward;if(t=this.owner.selection.start.paragraph.isInsideTable){var o=this.owner.selection.start.paragraph.associatedCell,s=this.currentWidget.paragraph.associatedCell,a=e.getContainerCellOf(o,s);if(t=a.ownerTable.contains(s)){o=e.getSelectedCell(o,a),s=e.getSelectedCell(s,a);var l=e.containsCell(a,this.currentWidget.paragraph.associatedCell),d=e.isCellSelected(a,this.owner.selection.start,this);if((l&&d||!l)&&!i.i(r.isNullOrUndefined)(s.ownerRow.nextRenderedWidget)){var h=s.ownerRow.nextRenderedWidget,c=e.getLastCellInRegion(h,a,this.owner.selection.upDownSelectionLength,!1),p=e.getLastParagraph(c);return void this.setPosition(p.childWidgets[p.childWidgets.length-1],!1)}if(l&&d&&i.i(r.isNullOrUndefined)(s.ownerRow.nextRenderedWidget)||!l)if(n){s=s.ownerRow.childWidgets[s.ownerRow.childWidgets.length-1];var p=e.getLastParagraph(s);this.setPosition(p.childWidgets[p.childWidgets.length-1],!1)}else{s=s.ownerRow.childWidgets[0];var p=e.getFirstParagraph(s);this.setPosition(p.childWidgets[p.childWidgets.length-1],!0)}}}if(!t){var c=e.getContainerCell(this.currentWidget.paragraph.associatedCell);if(n){c=c.ownerRow.childWidgets[c.ownerRow.childWidgets.length-1];var p=e.getLastParagraph(c);this.setPosition(p.childWidgets[p.childWidgets.length-1],!1)}else if(c.ownerRow.nextRenderedWidget){c=c.ownerRow.nextRenderedWidget.childWidgets[0];var p=e.getFirstParagraph(c);this.setPosition(p.childWidgets[p.childWidgets.length-1],!0)}}this.moveForward()},e.prototype.destroy=function(){this.offset=void 0,this.isUpdateLocation=void 0,i.i(r.isNullOrUndefined)(this.location)||this.location.destroy(),this.location=void 0,this.currentWidget=void 0,this.owner=void 0,this.documentHelper=void 0},e}()),s=function(){function e(e,t){this.leftIn=0,this.widthIn=0,this.color="",this.leftIn=e,this.widthIn=t}return Object.defineProperty(e.prototype,"left",{get:function(){return this.leftIn},set:function(e){this.leftIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.widthIn},set:function(e){this.widthIn=e},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.widthIn=void 0,this.leftIn=void 0,this.floatingItems=[],this.floatingItems=void 0},e}(),a=function(){function e(e,t){this.linkInternal="",this.localRef="",this.opensNewWindow=!1,this.isCrossRefField=!1,this.screenTipText="";var i=t.getFieldCode(e),n=i.toLowerCase();"hyperlink"===n.substring(0,9)?this.parseFieldValues(i.substring(9).trim(),!0):0===n.indexOf("ref ")&&n.match("\\h")?(this.parseFieldValues(i.substring(4).trim(),!1),this.isCrossRefField=!0):0===n.indexOf("pageref")&&this.parseFieldValues(i.substring(7).trim(),!1)}return Object.defineProperty(e.prototype,"screenTip",{get:function(){return this.screenTipText},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"navigationLink",{get:function(){return this.linkInternal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"localReference",{get:function(){return this.localRef},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"linkType",{get:function(){return this.typeInternal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCrossRef",{get:function(){return this.isCrossRefField},enumerable:!0,configurable:!0}),e.prototype.parseFieldValues=function(e,t){var i=e.split("\\o ");2===i.length&&(this.screenTipText=this.parseFieldValue(i[1],'"'===i[1]?'"':void 0,t),this.screenTipText=this.screenTipText.substring(0,this.screenTipText.length-1),e=i[0],i=void 0),i=e.split(" ");var n=!1,r=!0;if(t)for(var o=0;o<i.length;o++){var s=i[o];s.length<1||("\\t"===s||"\\l"===s?n=!0:"\\n"===s?this.opensNewWindow=!0:(s=this.parseFieldValue(s,'"'===s[0]?'"':void 0,t),n?(this.localRef=s,n=!1,r=!1):this.linkInternal=r?this.parseFieldValue(e,'"'===e[0]?'"':void 0,t):s))}else this.localRef=i[0];this.setLinkType()},e.prototype.parseFieldValue=function(e,t,i){e=i?e.substring(1):e.substring(0);var n=t?e.indexOf(t):-1;return n<0&&(n=e.length),e.substring(0,n).trim()},e.prototype.setLinkType=function(){if(i.i(r.isNullOrUndefined)(this.linkInternal)||this.linkInternal.length<1)return void(this.typeInternal="Bookmark");"www."===this.linkInternal.substring(0,4)?this.linkInternal="http://"+this.navigationLink:"@"===this.linkInternal[0]&&(this.linkInternal="mailto:"+this.navigationLink),"http://"===this.linkInternal.substring(0,7)||"https://"===this.linkInternal.substring(0,8)?this.typeInternal="WebPage":"mailto:"===this.linkInternal.substring(0,7)?this.typeInternal="Email":this.typeInternal="File"},e.prototype.destroy=function(){this.linkInternal=void 0,this.localRef=void 0,this.typeInternal=void 0,this.opensNewWindow=void 0,this.screenTipText=void 0},e}(),l=function(){function e(e){this.width=0,this.height=0,this.width=e.width,this.height=e.height,this.alternatetext=e.alternateText}return e.prototype.destroy=function(){this.width=void 0,this.height=void 0,this.alternatetext=void 0},e}()},function(e,t,i){"use strict";i.d(t,"a",function(){return h});var n=i(2),r=i(6),o=i(12),s=i(13),a=i(22),l=i(0),d=(i.n(l),i(25)),h=function(){function e(e){this.uniqueCharacterFormat=void 0,this.ownerBase=void 0,this.baseCharStyle=void 0,this.removedIds=[],this.revisions=[],this.ownerBase=e}return Object.defineProperty(e.prototype,"bold",{get:function(){return this.getPropertyValue("bold")},set:function(e){this.setPropertyValue("bold",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"italic",{get:function(){return this.getPropertyValue("italic")},set:function(e){this.setPropertyValue("italic",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){return this.getPropertyValue("fontSize")},set:function(e){this.setPropertyValue("fontSize",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"characterSpacing",{get:function(){return this.getPropertyValue("characterSpacing")},set:function(e){this.setPropertyValue("characterSpacing",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaling",{get:function(){return this.getPropertyValue("scaling")},set:function(e){this.setPropertyValue("scaling",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontFamily",{get:function(){return this.getPropertyValue("fontFamily")},set:function(e){this.setPropertyValue("fontFamily",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"underline",{get:function(){return this.getPropertyValue("underline")},set:function(e){this.setPropertyValue("underline",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strikethrough",{get:function(){return this.getPropertyValue("strikethrough")},set:function(e){this.setPropertyValue("strikethrough",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baselineAlignment",{get:function(){return this.getPropertyValue("baselineAlignment")},set:function(e){this.setPropertyValue("baselineAlignment",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"highlightColor",{get:function(){return this.getPropertyValue("highlightColor")},set:function(e){this.setPropertyValue("highlightColor",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontColor",{get:function(){return this.getPropertyValue("fontColor")},set:function(e){this.setPropertyValue("fontColor",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bidi",{get:function(){return this.getPropertyValue("bidi")},set:function(e){this.setPropertyValue("bidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"localeIdBidi",{get:function(){return this.getPropertyValue("localeIdBidi")},set:function(e){this.setPropertyValue("localeIdBidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"localeIdFarEast",{get:function(){return this.getPropertyValue("localeIdFarEast")},set:function(e){this.setPropertyValue("localeIdFarEast",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"localeIdAscii",{get:function(){return this.getPropertyValue("localeIdAscii")},set:function(e){this.setPropertyValue("localeIdAscii",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bdo",{get:function(){return this.getPropertyValue("bdo")},set:function(e){this.setPropertyValue("bdo",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"boldBidi",{get:function(){return this.getPropertyValue("boldBidi")},set:function(e){this.setPropertyValue("boldBidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"italicBidi",{get:function(){return this.getPropertyValue("italicBidi")},set:function(e){this.setPropertyValue("italicBidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontSizeBidi",{get:function(){return this.getPropertyValue("fontSizeBidi")},set:function(e){this.setPropertyValue("fontSizeBidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontFamilyBidi",{get:function(){return this.getPropertyValue("fontFamilyBidi")},set:function(e){this.setPropertyValue("fontFamilyBidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allCaps",{get:function(){return this.getPropertyValue("allCaps")},set:function(e){this.setPropertyValue("allCaps",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"complexScript",{get:function(){return this.getPropertyValue("complexScript")},set:function(e){this.setPropertyValue("complexScript",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontFamilyFarEast",{get:function(){return this.getPropertyValue("fontFamilyFarEast")},set:function(e){this.setPropertyValue("fontFamilyFarEast",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontFamilyAscii",{get:function(){return this.getPropertyValue("fontFamilyAscii")},set:function(e){this.setPropertyValue("fontFamilyAscii",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontFamilyNonFarEast",{get:function(){return this.getPropertyValue("fontFamilyNonFarEast")},set:function(e){this.setPropertyValue("fontFamilyNonFarEast",e)},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(t){if(this.hasValue(t)){var r=o.a.getPropertyType(e.uniqueFormatType,t);if(!i.i(l.isNullOrUndefined)(this.uniqueCharacterFormat)&&this.uniqueCharacterFormat.propertiesHash.containsKey(r))return this.uniqueCharacterFormat.propertiesHash.get(r)}else{var s=this.checkCharacterStyle(t);if(!i.i(l.isNullOrUndefined)(s))return s;if(!i.i(l.isNullOrUndefined)(this.baseCharStyle)){var a=void 0,d=void 0;if(i.i(l.isNullOrUndefined)(this.ownerBase)||(a=this.ownerBase.paragraph,d=this.ownerBase.line),!i.i(l.isNullOrUndefined)(a)&&!i.i(l.isNullOrUndefined)(d))for(var h=d.children.length,c=0;c<h;c++){var p=this.ownerBase.line.children[c];if(p instanceof n.d){var u=p.text;if(u.startsWith("HYPERLINK")){var g=u.indexOf("_Toc");-1!==g&&(this.baseCharStyle=this.ownerBase.paragraph.paragraphFormat.baseStyle)}}}}var f=this.checkBaseStyle(t);if(!i.i(l.isNullOrUndefined)(f))return f}return this.getDefaultValue(t)},e.prototype.getDefaultValue=function(t){var n=o.a.getPropertyType(e.uniqueFormatType,t),r=this.documentCharacterFormat();return i.i(l.isNullOrUndefined)(r)||i.i(l.isNullOrUndefined)(r.uniqueCharacterFormat)||!r.uniqueCharacterFormat.propertiesHash.containsKey(n)?e.getPropertyDefaultValue(t):r.uniqueCharacterFormat.propertiesHash.get(n)},e.prototype.documentCharacterFormat=function(){var e;return i.i(l.isNullOrUndefined)(this.ownerBase)||(i.i(l.isNullOrUndefined)(this.ownerBase.paragraph)||i.i(l.isNullOrUndefined)(this.ownerBase.paragraph.bodyWidget)||i.i(l.isNullOrUndefined)(this.ownerBase.paragraph.bodyWidget.page)?i.i(l.isNullOrUndefined)(this.ownerBase.bodyWidget)||(e=this.ownerBase.bodyWidget.page.documentHelper.characterFormat):e=this.ownerBase.paragraph.bodyWidget.page.documentHelper.characterFormat),e},e.prototype.checkBaseStyle=function(t){var r;for(i.i(l.isNullOrUndefined)(this.ownerBase)||(i.i(l.isNullOrUndefined)(this.ownerBase.paragraph)?this.ownerBase instanceof n.g&&!i.i(l.isNullOrUndefined)(this.ownerBase.paragraphFormat)?r=this.ownerBase.paragraphFormat.baseStyle:i.i(l.isNullOrUndefined)(this.ownerBase instanceof a.a)||(r=this.ownerBase.basedOn):r=this.ownerBase.paragraph.paragraphFormat.baseStyle);!i.i(l.isNullOrUndefined)(r)&&!r.characterFormat.hasValue(t);)r=r.basedOn;if(!i.i(l.isNullOrUndefined)(r)){var s=o.a.getPropertyType(e.uniqueFormatType,t);return r.characterFormat.uniqueCharacterFormat.propertiesHash.get(s)}},e.prototype.checkCharacterStyle=function(t){var n=this.baseCharStyle;if(!i.i(l.isNullOrUndefined)(n))for(;!i.i(l.isNullOrUndefined)(n)&&"Default Paragraph Font"!==n.name;){var r=n.characterFormat.hasValue(t);if(r){var s=o.a.getPropertyType(e.uniqueFormatType,t);return n.characterFormat.uniqueCharacterFormat.propertiesHash.get(s)}n=n.basedOn}},e.prototype.setPropertyValue=function(t,n){if((i.i(l.isNullOrUndefined)(n)||""===n)&&(n=e.getPropertyDefaultValue(t)),i.i(l.isNullOrUndefined)(this.uniqueCharacterFormat))this.initializeUniqueCharacterFormat(t,n);else{var r=o.a.getPropertyType(this.uniqueCharacterFormat.uniqueFormatType,t);if(this.uniqueCharacterFormat.propertiesHash.containsKey(r)&&this.uniqueCharacterFormat.propertiesHash.get(r)===n)return;this.uniqueCharacterFormat=e.uniqueCharacterFormats.updateUniqueFormat(this.uniqueCharacterFormat,t,n)}},e.prototype.initializeUniqueCharacterFormat=function(t,i){var n=new r.a;this.addUniqueCharacterFormat("fontColor",t,i,n),this.addUniqueCharacterFormat("fontFamily",t,i,n),this.addUniqueCharacterFormat("fontSize",t,i,n),this.addUniqueCharacterFormat("bold",t,i,n),this.addUniqueCharacterFormat("italic",t,i,n),this.addUniqueCharacterFormat("underline",t,i,n),this.addUniqueCharacterFormat("strikethrough",t,i,n),this.addUniqueCharacterFormat("baselineAlignment",t,i,n),this.addUniqueCharacterFormat("highlightColor",t,i,n),this.addUniqueCharacterFormat("styleName",t,i,n),this.addUniqueCharacterFormat("bidi",t,i,n),this.addUniqueCharacterFormat("bdo",t,i,n),this.addUniqueCharacterFormat("fontFamilyBidi",t,i,n),this.addUniqueCharacterFormat("fontSizeBidi",t,i,n),this.addUniqueCharacterFormat("boldBidi",t,i,n),this.addUniqueCharacterFormat("italicBidi",t,i,n),this.addUniqueCharacterFormat("allCaps",t,i,n),this.addUniqueCharacterFormat("localeIdAscii",t,i,n),this.addUniqueCharacterFormat("localeIdFarEast",t,i,n),this.addUniqueCharacterFormat("localeIdBidi",t,i,n),this.addUniqueCharacterFormat("fontFamilyFarEast",t,i,n),this.addUniqueCharacterFormat("fontFamilyAscii",t,i,n),this.addUniqueCharacterFormat("fontFamilyNonFarEast",t,i,n),this.addUniqueCharacterFormat("complexScript",t,i,n),this.addUniqueCharacterFormat("characterSpacing",t,i,n),this.addUniqueCharacterFormat("scaling",t,i,n),this.uniqueCharacterFormat=e.uniqueCharacterFormats.addUniqueFormat(n,e.uniqueFormatType)},e.prototype.addUniqueCharacterFormat=function(t,i,n,r){var s=o.a.getPropertyType(e.uniqueFormatType,t);t===i&&r.add(s,n)},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"bold":case"italic":t=!1;break;case"fontSize":t=11;break;case"underline":case"strikethrough":t="None";break;case"baselineAlignment":t="Normal";break;case"highlightColor":t="NoColor";break;case"fontColor":t="#00000000";break;case"fontFamily":t="Calibri";break;case"styleName":t="Default Paragraph Font";break;case"bidi":t=!1;break;case"bdo":t="None";break;case"boldBidi":case"italicBidi":t=!1;break;case"fontSizeBidi":t=11;break;case"fontFamilyBidi":t="Calibri";break;case"allCaps":t=!1;break;case"localeIdAscii":case"localeIdFarEast":case"localeIdBidi":t=0;break;case"complexScript":t=!1;break;case"fontFamilyFarEast":case"fontFamilyAscii":case"fontFamilyNonFarEast":t=void 0;break;case"characterSpacing":t=0;break;case"scaling":t=100}return t},e.prototype.isEqualFormat=function(e){return this.fontSize===e.fontSize&&this.fontFamily===e.fontFamily&&this.bold===e.bold&&this.italic===e.italic&&this.baselineAlignment===e.baselineAlignment&&this.underline===e.underline&&this.fontColor===e.fontColor&&this.strikethrough===e.strikethrough&&this.highlightColor===e.highlightColor&&this.bidi===e.bidi&&this.bdo===e.bdo&&this.allCaps===e.allCaps&&this.localeIdBidi===e.localeIdBidi&&this.localeIdAscii===e.localeIdAscii&&this.localeIdFarEast===e.localeIdFarEast&&this.complexScript===e.complexScript&&this.fontFamilyAscii===e.fontFamilyAscii&&this.fontFamilyBidi===e.fontFamilyBidi&&this.fontFamilyFarEast===e.fontFamilyFarEast&&this.characterSpacing===e.characterSpacing&&this.scaling===e.scaling&&this.fontFamilyNonFarEast===e.fontFamilyNonFarEast},e.prototype.isSameFormat=function(e){return this.baseCharStyle===e.baseCharStyle&&this.uniqueCharacterFormat===e.uniqueCharacterFormat},e.prototype.cloneFormat=function(){var t=new e(void 0);return t.uniqueCharacterFormat=this.uniqueCharacterFormat,t.baseCharStyle=this.baseCharStyle,this.revisions.length>0?t.removedIds=d.b.cloneRevisions(this.revisions):t.removedIds=this.removedIds.slice(),t},e.prototype.hasValue=function(e){if(!i.i(l.isNullOrUndefined)(this.uniqueCharacterFormat)&&!i.i(l.isNullOrUndefined)(this.uniqueCharacterFormat.propertiesHash)){var t=o.a.getPropertyType(this.uniqueCharacterFormat.uniqueFormatType,e);return this.uniqueCharacterFormat.propertiesHash.containsKey(t)}return!1},e.prototype.clearFormat=function(){i.i(l.isNullOrUndefined)(this.uniqueCharacterFormat)||0!==this.uniqueCharacterFormat.referenceCount||e.uniqueCharacterFormats.remove(this.uniqueCharacterFormat),this.uniqueCharacterFormat=void 0,this.baseCharStyle=void 0},e.prototype.destroy=function(){i.i(l.isNullOrUndefined)(this.uniqueCharacterFormat)||e.uniqueCharacterFormats.remove(this.uniqueCharacterFormat),this.uniqueCharacterFormat=void 0,this.baseCharStyle=void 0,this.ownerBase=void 0},e.prototype.copyFormat=function(e){i.i(l.isNullOrUndefined)(e)||(!i.i(l.isNullOrUndefined)(e.uniqueCharacterFormat)&&e.uniqueCharacterFormat.propertiesHash&&this.updateUniqueCharacterFormat(e),i.i(l.isNullOrUndefined)(e.baseCharStyle)||(this.baseCharStyle=e.baseCharStyle),e.revisions.length>0?this.removedIds=d.b.cloneRevisions(e.revisions):this.removedIds=e.removedIds.slice())},e.prototype.isEqualTocFormat=function(e){return this.fontFamily===e.fontFamily&&this.bold===e.bold&&this.italic===e.italic&&this.strikethrough===e.strikethrough&&this.highlightColor===e.highlightColor&&this.fontFamilyAscii===e.fontFamilyAscii&&this.fontFamilyFarEast===e.fontFamilyFarEast&&this.fontFamilyNonFarEast===e.fontFamilyNonFarEast},e.prototype.copyTocFormat=function(e){i.i(l.isNullOrUndefined)(e.bold)||(this.bold=e.bold),i.i(l.isNullOrUndefined)(e.italic)||(this.italic=e.italic),i.i(l.isNullOrUndefined)(e.strikethrough)||(this.strikethrough=e.strikethrough),i.i(l.isNullOrUndefined)(e.highlightColor)||(this.highlightColor=e.highlightColor),i.i(l.isNullOrUndefined)(e.fontFamily)||(this.fontFamily=e.fontFamily,this.fontFamilyAscii=e.fontFamily,this.fontFamilyFarEast=e.fontFamily,this.fontFamilyNonFarEast=e.fontFamily)},e.prototype.updateUniqueCharacterFormat=function(t){var n=void 0;this.uniqueCharacterFormat&&(n=this.uniqueCharacterFormat.mergeProperties(t.uniqueCharacterFormat),0===this.uniqueCharacterFormat.referenceCount&&(e.uniqueCharacterFormats.remove(this.uniqueCharacterFormat),this.uniqueCharacterFormat=void 0)),this.uniqueCharacterFormat=new o.a(e.uniqueFormatType),i.i(l.isNullOrUndefined)(n)&&(n=this.uniqueCharacterFormat.mergeProperties(t.uniqueCharacterFormat)),this.uniqueCharacterFormat=e.uniqueCharacterFormats.addUniqueFormat(n,e.uniqueFormatType)},e.clear=function(){this.uniqueCharacterFormats.clear()},e.prototype.applyStyle=function(e){this.baseCharStyle=e},e.prototype.getValue=function(e){return this.hasValue(e)?this.getPropertyValue(e):void 0},e.prototype.mergeFormat=function(e){i.i(l.isNullOrUndefined)(this.getValue("bold"))&&(this.bold=e.getValue("bold")),i.i(l.isNullOrUndefined)(this.getValue("italic"))&&(this.italic=e.getValue("italic")),i.i(l.isNullOrUndefined)(this.getValue("fontSize"))&&(this.fontSize=e.getValue("fontSize")),i.i(l.isNullOrUndefined)(this.getValue("characterSpacing"))&&(this.characterSpacing=e.getValue("characterSpacing")),i.i(l.isNullOrUndefined)(this.getValue("scaling"))&&(this.scaling=e.getValue("scaling")),i.i(l.isNullOrUndefined)(this.getValue("fontFamily"))?this.fontFamily=e.getValue("fontFamily"):(i.i(l.isNullOrUndefined)(this.getValue("fontFamilyAscii"))&&(this.fontFamilyAscii=e.getValue("fontFamily")),i.i(l.isNullOrUndefined)(this.getValue("fontFamilyFarEast"))&&(this.fontFamilyFarEast=e.getValue("fontFamily")),i.i(l.isNullOrUndefined)(this.getValue("fontFamilyNonFarEast"))&&(this.fontFamilyNonFarEast=e.getValue("fontFamily"))),i.i(l.isNullOrUndefined)(this.getValue("underline"))&&(this.underline=e.getValue("underline")),i.i(l.isNullOrUndefined)(this.getValue("strikethrough"))&&(this.strikethrough=e.getValue("strikethrough")),i.i(l.isNullOrUndefined)(this.getValue("baselineAlignment"))&&(this.baselineAlignment=e.getValue("baselineAlignment")),i.i(l.isNullOrUndefined)(this.getValue("highlightColor"))&&(this.highlightColor=e.getValue("highlightColor")),i.i(l.isNullOrUndefined)(this.getValue("fontColor"))&&(this.fontColor=e.getValue("fontColor")),i.i(l.isNullOrUndefined)(this.getValue("bidi"))&&(this.bidi=e.getValue("bidi")),i.i(l.isNullOrUndefined)(this.getValue("bdo"))&&(this.bdo=e.getValue("bdo")),i.i(l.isNullOrUndefined)(this.getValue("allCaps"))&&(this.allCaps=e.getValue("allCaps")),i.i(l.isNullOrUndefined)(this.getValue("localeIdBidi"))&&(this.localeIdBidi=e.getValue("localeIdBidi")),i.i(l.isNullOrUndefined)(this.getValue("localeIdAscii"))&&(this.localeIdAscii=e.getValue("localeIdAscii")),i.i(l.isNullOrUndefined)(this.getValue("localeIdFarEast"))&&(this.localeIdFarEast=e.getValue("localeIdFarEast")),i.i(l.isNullOrUndefined)(this.getValue("complexScript"))&&(this.complexScript=e.getValue("complexScript")),i.i(l.isNullOrUndefined)(this.getValue("fontFamilyAscii"))&&(this.fontFamilyAscii=e.getValue("fontFamilyAscii")),i.i(l.isNullOrUndefined)(this.getValue("fontFamilyBidi"))&&(this.fontFamilyBidi=e.getValue("fontFamilyBidi")),i.i(l.isNullOrUndefined)(this.getValue("fontFamilyFarEast"))&&(this.fontFamilyFarEast=e.getValue("fontFamilyFarEast")),i.i(l.isNullOrUndefined)(this.getValue("fontFamilyNonFarEast"))&&(this.fontFamilyNonFarEast=e.getValue("fontFamilyNonFarEast"))},e.prototype.hasValueWithParent=function(e){var t=this.hasValue(e);!t&&!i.i(l.isNullOrUndefined)(this.baseCharStyle)&&this.baseCharStyle instanceof a.b&&(t=this.baseCharStyle.characterFormat.hasValue(e));var n=this.documentCharacterFormat();return t||i.i(l.isNullOrUndefined)(n)||(t=n.hasValue(e)),t},e.uniqueCharacterFormats=new s.a,e.uniqueFormatType=2,e}()},function(e,t,i){"use strict";i.d(t,"d",function(){return l}),i.d(t,"a",function(){return d}),i.d(t,"b",function(){return h}),i.d(t,"c",function(){return c});var n=i(17),r=i(21),o=i(4),s=i(0),a=(i.n(s),this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}()),l=function(){function e(){}return e}(),d=function(e){function t(t){var i=e.call(this)||this;return i.ownerBase=t,i.paragraphFormat=new n.a(i),i.characterFormat=new r.a(i),i}return a(t,e),t.prototype.clear=function(){this.characterFormat&&this.characterFormat.clearFormat(),this.paragraphFormat&&this.paragraphFormat.clearFormat()},t.prototype.destroy=function(){this.characterFormat&&(this.characterFormat.destroy(),this.characterFormat=void 0),this.paragraphFormat&&(this.paragraphFormat.destroy(),this.paragraphFormat=void 0),this.ownerBase=void 0,this.name=void 0,this.next=void 0,this.basedOn=void 0,this.link=void 0},t.prototype.copyStyle=function(e){this.name=e.name,this.ownerBase=e.ownerBase,this.type=e.type,this.next=e.next,this.basedOn=e.basedOn,this.link=e.link,this.characterFormat.copyFormat(e.characterFormat),this.paragraphFormat.copyFormat(e.paragraphFormat)},t}(l),h=function(e){function t(t){var i=e.call(this)||this;return i.ownerBase=t,i.characterFormat=new r.a(i),i}return a(t,e),t.prototype.clear=function(){this.characterFormat&&this.characterFormat.clearFormat()},t.prototype.destroy=function(){this.characterFormat&&(this.characterFormat.destroy(),this.characterFormat=void 0),this.ownerBase=void 0,this.name=void 0,this.next=void 0,this.basedOn=void 0,this.link=void 0},t.prototype.copyStyle=function(e){this.name=e.name,this.ownerBase=e.ownerBase,this.type=e.type,this.next=e.next,this.basedOn=e.basedOn,this.characterFormat.copyFormat(e.characterFormat)},t}(l),c=function(){function e(){this.collection=[]}return Object.defineProperty(e.prototype,"length",{get:function(){return this.collection.length},enumerable:!0,configurable:!0}),e.prototype.remove=function(e){this.collection=this.collection.filter(function(t){return t.name!==e.name})},e.prototype.push=function(e){return null!=e&&void 0!==e&&this.collection.push(e),1},e.prototype.getItem=function(e){return this.collection.length>e?this.collection[parseInt(e.toString(),10)]:null},e.prototype.indexOf=function(e){return this.collection.indexOf(e)},e.prototype.contains=function(e){var t=this.collection.indexOf(e);return t>-1&&t<this.collection.length},e.prototype.clear=function(){if(this.collection&&this.collection.length>0)for(var e=0;e<this.collection.length;e++){var t=this.collection[parseInt(e.toString(),10)];t.clear()}this.collection=[]},e.prototype.findByName=function(e,t){for(var n,r=0,o=this.collection;r<o.length;r++){var a=o[r];a.name===e&&(n=a,i.i(s.isNullOrUndefined)(t)||a.type!==t&&(n=void 0))}return n},e.prototype.getStyleNames=function(e){return this.collection.filter(function(t){return t.type===e}).map(function(e){return e.name})},e.prototype.getStyles=function(e){for(var t=this.collection.filter(function(t){return t.type===e}).map(function(e){return e}),n=[],r=0,a=t;r<a.length;r++){var l=a[r],d={},h={};"Paragraph"==e&&(h.paragraphFormat={},o.a.writeParagraphFormat(h.paragraphFormat,!0,l.paragraphFormat)),h.characterFormat={},o.a.writeCharacterFormat(h.characterFormat,!0,l.characterFormat),d.name=l.name,d.style=JSON.stringify(h),i.i(s.isNullOrUndefined)(e)||(d.type=e,"Paragraph"!=d.type||i.i(s.isNullOrUndefined)(l.link)||(d.type="Linked")),n.push(d)}return n},e.prototype.destroy=function(){if(this.collection&&this.collection.length>0)for(var e=0;e<this.collection.length;e++){var t=this.collection[parseInt(e.toString(),10)];t.destroy()}this.collection=[],this.collection=void 0},e}()},function(e,t,i){"use strict";i.d(t,"a",function(){return h});var n=i(6),r=i(12),o=i(13),s=i(21),a=i(17),l=i(14),d=i(0),h=(i.n(d),function(){function e(e){this.uniqueListLevel=void 0,this.paragraphFormat=void 0,this.characterFormat=void 0,l.a,this.ownerBase=e,this.characterFormat=new s.a(void 0),this.paragraphFormat=new a.a(void 0)}return Object.defineProperty(e.prototype,"listLevelPattern",{get:function(){return this.getPropertyValue("listLevelPattern")},set:function(e){this.setPropertyValue("listLevelPattern",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"followCharacter",{get:function(){return this.getPropertyValue("followCharacter")},set:function(e){this.setPropertyValue("followCharacter",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"startAt",{get:function(){return this.getPropertyValue("startAt")},set:function(e){this.setPropertyValue("startAt",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numberFormat",{get:function(){return this.getPropertyValue("numberFormat")},set:function(e){this.setPropertyValue("numberFormat",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"restartLevel",{get:function(){return this.getPropertyValue("restartLevel")},set:function(e){this.setPropertyValue("restartLevel",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLegalStyleNumbering",{get:function(){return this.getPropertyValue("isLegalStyleNumbering")},set:function(e){this.setPropertyValue("isLegalStyleNumbering",e)},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(t){var n=r.a.getPropertyType(e.uniqueFormatType,t);return!i.i(d.isNullOrUndefined)(this.uniqueListLevel)&&this.uniqueListLevel.propertiesHash.containsKey(n)?this.uniqueListLevel.propertiesHash.get(n):e.getPropertyDefaultValue(t)},e.prototype.setPropertyValue=function(t,n){if((i.i(d.isNullOrUndefined)(n)||""===n)&&(n=e.getPropertyDefaultValue(t)),i.i(d.isNullOrUndefined)(this.uniqueListLevel))this.initializeUniqueWListLevel(t,n);else{var o=r.a.getPropertyType(this.uniqueListLevel.uniqueFormatType,t);if(this.uniqueListLevel.propertiesHash.containsKey(o)&&this.uniqueListLevel.propertiesHash.get(o)===n)return;this.uniqueListLevel=e.uniqueListLevels.updateUniqueFormat(this.uniqueListLevel,t,n)}},e.prototype.initializeUniqueWListLevel=function(t,i){var r=new n.a;this.addUniqueWListLevel("listLevelPattern",t,i,r),this.addUniqueWListLevel("startAt",t,i,r),this.addUniqueWListLevel("followCharacter",t,i,r),this.addUniqueWListLevel("numberFormat",t,i,r),this.addUniqueWListLevel("restartLevel",t,i,r),this.addUniqueWListLevel("isLegalStyleNumbering",t,i,r),this.uniqueListLevel=e.uniqueListLevels.addUniqueFormat(r,e.uniqueFormatType)},e.prototype.addUniqueWListLevel=function(t,i,n,o){var s;s=r.a.getPropertyType(e.uniqueFormatType,t),t===i?o.add(s,n):o.add(s,e.getPropertyDefaultValue(t))},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"listLevelPattern":t="Arabic";break;case"startAt":t=0;break;case"followCharacter":t="Tab";break;case"numberFormat":t="";break;case"restartLevel":t=0;break;case"isLegalStyleNumbering":t=!1}return t},e.prototype.destroy=function(){i.i(d.isNullOrUndefined)(this.uniqueListLevel)||e.uniqueListLevels.remove(this.uniqueListLevel),this.uniqueListLevel=void 0,i.i(d.isNullOrUndefined)(this.characterFormat)||(this.characterFormat.destroy(),this.characterFormat=void 0),i.i(d.isNullOrUndefined)(this.paragraphFormat)||(this.paragraphFormat.destroy(),this.paragraphFormat=void 0)},e.prototype.clearFormat=function(){i.i(d.isNullOrUndefined)(this.uniqueListLevel)||e.uniqueListLevels.remove(this.uniqueListLevel),this.uniqueListLevel=void 0,this.characterFormat&&this.characterFormat.clearFormat(),this.characterFormat=void 0,this.paragraphFormat&&this.paragraphFormat.clearFormat(),this.paragraphFormat=void 0},e.clear=function(){this.uniqueListLevels.clear()},e.prototype.clone=function(t){var i=new e(t);return i.paragraphFormat=this.paragraphFormat.cloneFormat(),i.characterFormat=this.characterFormat.cloneFormat(),this.uniqueListLevel&&(i.uniqueListLevel=this.uniqueListLevel,i.uniqueListLevel.referenceCount++),i},e.dotBullet=String.fromCharCode(61623),e.squareBullet=String.fromCharCode(61607),e.arrowBullet=String.fromCharCode(10148),e.circleBullet=String.fromCharCode(61551)+String.fromCharCode(32),e.uniqueListLevels=new o.a,e.uniqueFormatType=9,e}())},function(e,t,i){"use strict";i.d(t,"a",function(){return o});var n=i(0),r=(i.n(n),i(26)),o=function(){function e(){this.nsid=-1,this.listId=-1,this.sourceListId=-1,this.abstractListId=-1,this.abstractList=void 0,this.levelOverrides=[]}return e.prototype.getListLevel=function(e){var t=this.getLevelOverride(e);return i.i(n.isNullOrUndefined)(t)||i.i(n.isNullOrUndefined)(t.overrideListLevel)?this.abstractList.levels[parseInt(e.toString(),10)]:t.overrideListLevel},e.prototype.getLevelOverride=function(e){for(var t=0;t<this.levelOverrides.length;t++)if(this.levelOverrides[parseInt(t.toString(),10)]instanceof r.a){var i=this.levelOverrides[parseInt(t.toString(),10)];if(i.levelNumber===e)return i}},e.prototype.clear=function(){if(!i.i(n.isNullOrUndefined)(this.levelOverrides)){for(var e=0;e<this.levelOverrides.length;e++){this.levelOverrides[parseInt(e.toString(),10)].clear()}this.levelOverrides=[]}this.abstractList&&this.abstractList.clear(),this.abstractList=void 0},e.prototype.destroy=function(){if(!i.i(n.isNullOrUndefined)(this.levelOverrides)){for(var e=0;e<this.levelOverrides.length;e++){this.levelOverrides[parseInt(e.toString(),10)].destroy()}this.levelOverrides=[]}this.levelOverrides=void 0,this.abstractList&&(this.abstractList.destroy(),this.abstractList=void 0),this.abstractListId=void 0,this.listId=void 0,this.sourceListId=void 0},e.prototype.mergeList=function(e){i.i(n.isNullOrUndefined)(this.abstractListId)||-1===this.abstractListId||(this.abstractListId=e.abstractListId),i.i(n.isNullOrUndefined)(this.listId)||-1===this.listId||(this.listId=e.listId),i.i(n.isNullOrUndefined)(this.sourceListId)||-1===this.sourceListId||(this.sourceListId=e.sourceListId),i.i(n.isNullOrUndefined)(this.levelOverrides)||0===this.levelOverrides.length||(this.levelOverrides=e.levelOverrides)},e.prototype.clone=function(){for(var t=new e,i=0;i<this.levelOverrides.length;i++)t.levelOverrides.push(this.levelOverrides[parseInt(i.toString(),10)].clone());return t},e}()},function(e,t,i){"use strict";i.d(t,"b",function(){return l}),i.d(t,"a",function(){return d});var n=i(0),r=(i.n(n),i(2)),o=i(21),s=i(56),a=i(11),l=function(){function e(e,t,r){this.author=null,this.date=null,this.range=[],this.revisionID="",this.isContentRemoved=!1,this.isTableRevision=!1,this.canSkipTableItems=!1,this.skipUnLinkElement=!1,this.author=t,i.i(n.isNullOrUndefined)(this.author)&&(this.author="Unknown"),this.date=r,this.owner=e}return e.prototype.handleAcceptReject=function(e){this.owner.selection.selectRevision(this);var t=this.owner.selection,i=t.start,n=t.end;t.start.isExistBefore(t.end)||(i=t.end,n=t.start);var a=t.getParagraphInfo(i);if(this.owner.editor.initHistory(e?"Accept Change":"Reject Change"),this.owner.editorHistory.currentBaseHistoryInfo.markerData.push(this.owner.editor.getMarkerData(void 0,void 0,this)),"Deletion"===this.revisionType?(a=t.getParagraphInfo(this.owner.selection.start),t.editPosition=this.owner.selection.getHierarchicalIndex(a.paragraph,a.offset.toString())):t.editPosition=this.owner.selection.getHierarchicalIndex(a.paragraph,a.offset.toString()),this.owner.editor.updateInsertPosition(),this.isContentRemoved=!1,this.canSkipTableItems=!1,this.skipUnLinkElement=!1,"Insertion"===this.revisionType||"Deletion"===this.revisionType||"MoveFrom"===this.revisionType||"MoveTo"===this.revisionType){this.owner.isShiftingEnabled=!0;for(var l=0;this.range.length>0&&(this.range[l]instanceof r.c||this.range[l]instanceof o.a||this.range[l]instanceof s.a);){if(this.range[l]instanceof r.e&&e&&"Deletion"===this.revisionType){var d=this.range[l];this.owner.documentHelper.bookmarks.containsKey(d.name)&&this.owner.documentHelper.bookmarks.remove(d.name)}this.unlinkRangeItem(this.range[l],this,e,i,n)?l++:l=0}}if(this.isTableRevision=!1,this.isContentRemoved){var h=t.getTextPosBasedOnLogicalIndex(t.editPosition);this.owner.selection.selectContent(h,!0),this.owner.editor.updateEndPosition()}else t.selectRange(i,n),this.owner.editor.updateHistoryPosition(n,!1);if(this.owner.editorHistory&&"BackSpace"!==this.owner.editorHistory.currentBaseHistoryInfo.action&&this.owner.editorHistory.currentBaseHistoryInfo.removedNodes.reverse(),this.owner.editorHistory){this.owner.trackChangesPane.isTrackingPageBreak&&(this.owner.editorHistory.currentBaseHistoryInfo.action="TrackingPageBreak");var c=this.owner.editorHistory;!c.currentHistoryInfo||"Accept All"!==c.currentHistoryInfo.action&&"Reject All"!==c.currentHistoryInfo.action||this.owner.documentHelper.blockToShift&&this.owner.documentHelper.layout.shiftLayoutedItems(!1),c.updateHistory()}this.owner.editor.reLayout(this.owner.selection),a.paragraph.isInHeaderFooter&&this.owner.editor.updateHeaderFooterWidget()},e.prototype.handleGroupAcceptReject=function(e){if(this.owner.trackChangesPane.tableRevisions.containsKey(this)){this.owner.editor.initComplexHistory(e?"Accept All":"Reject All");for(var t=this.owner.trackChangesPane.tableRevisions.get(this),i=t.length-1;i>=0;i--)e?t[i].handleAcceptReject(!0):t[i].handleAcceptReject(!1);this.owner.editorHistory&&this.owner.editorHistory.updateComplexHistory()}},e.prototype.accept=function(){var e={author:this.author,cancel:!1,revisionType:this.revisionType,actionType:"Accept"};this.owner.trigger(a.a,e),e.cancel||this.owner.documentHelper.isTrackedOnlyMode||(!this.owner.revisions.skipGroupAcceptReject&&this.range[0]instanceof s.a&&this.owner.trackChangesPane.tableRevisions.containsKey(this)?this.handleGroupAcceptReject(!0):this.handleAcceptReject(!0))},e.prototype.reject=function(){var e={author:this.author,cancel:!1,revisionType:this.revisionType,actionType:"Reject"};this.owner.trigger(a.a,e),e.cancel||this.owner.documentHelper.isTrackedOnlyMode||(!this.owner.revisions.skipGroupAcceptReject&&this.range[0]instanceof s.a&&this.owner.trackChangesPane.tableRevisions.containsKey(this)?this.handleGroupAcceptReject(!1):this.handleAcceptReject(!1))},e.prototype.unlinkRangeItem=function(e,t,a,l,d){if(this.isTableRevision)return this.removeRangeRevisionForItem(e),0===t.range.length&&this.owner.revisions.remove(t),!1;var h=!i.i(n.isNullOrUndefined)(a)&&("MoveFrom"===t.revisionType||"Deletion"===t.revisionType)&&a||("Insertion"===t.revisionType||"MoveTo"===t.revisionType)&&!a;if(this.owner.selection.isTOC()){if(h)this.owner.editor.deleteSelectedContents(this.owner.selection,!0),0===t.range.length&&this.owner.revisions.remove(t),this.isContentRemoved=!0,this.owner.editorHistory.currentBaseHistoryInfo.action="BackSpace";else{for(;this.range.length>0;){var c=this.range[0];this.removeRangeRevisionForItem(c),0===t.range.length&&this.owner.revisions.remove(t)}this.owner.editor.addRemovedNodes(this.revisionID),this.owner.editorHistory.currentBaseHistoryInfo.action="AcceptTOC"}return!1}if(e instanceof r.c&&!this.canSkipTableItems)if(h){if(this.skipeElementRemoval(e))return this.skipUnLinkElement=!0,!0;this.owner.editor.addRemovedNodes(e.clone())}else this.owner.editorHistory.currentBaseHistoryInfo.action="ClearRevisions",this.updateRevisionID(),this.removeRevisionFromPara(l,d),this.owner.trackChangesPane.isTrackingPageBreak=!1;else if(!this.canSkipTableItems&&e instanceof o.a&&!h)this.owner.editorHistory.currentBaseHistoryInfo.action="ClearRevisions",this.updateRevisionID(),this.removeRevisionFromPara(l,d);else if(e instanceof s.a&&!h){this.isTableRevision=!0;var p=e.ownerBase.ownerTable,u=e.ownerBase;this.owner.editorHistory.currentBaseHistoryInfo.action="RemoveRowTrack",this.owner.editor.cloneTableToHistoryInfo(p)}if(h=h&&!this.canSkipTableItems,e instanceof r.c&&h){var g=e.line.paragraph;if(this.removeRevisionItemsFromRange(e),e instanceof r.f&&"Footnote"===e.footnoteType&&this.owner.editor.removeFootnote(e),this.removeItem(e),this.isContentRemoved=!0,this.owner.documentHelper.layout.reLayoutParagraph(g,0,0),i.i(n.isNullOrUndefined)(g.childWidgets)){var f=this.owner.selection.getTextPosBasedOnLogicalIndex(this.owner.selection.editPosition);this.owner.selection.selectContent(f,!0)}}else if(e instanceof o.a&&h){if(this.isContentRemoved=!0,this.skipUnLinkElement=!1,this.removeRevisionItemsFromRange(e),1===t.range.length)this.owner.editor.deleteSelectedContents(this.owner.selection,!0);else{this.owner.editor.deleteSelectedContents(this.owner.selection,!0),this.removeRevisionFromPara(l,d);var m=t.range.indexOf(e);for(t.range.splice(m,1),this.owner.trackChangesPane.updateCurrentTrackChanges(t);this.range.length>0;)this.removeRangeRevisionForItem(this.range[0])}this.owner.editorHistory.currentBaseHistoryInfo.action="BackSpace",this.owner.editorHistory.currentBaseHistoryInfo.isAcceptOrReject=a?"Accept":"Reject"}else if(e instanceof s.a&&h){var p=e.ownerBase.ownerTable;p=p.combineWidget(this.owner.viewer);var u=e.ownerBase;this.removeRevisionItemsFromRange(e),this.owner.editorHistory.currentBaseHistoryInfo.action="DeleteCells",this.owner.editor.cloneTableToHistoryInfo(p),this.owner.editor.removeDeletedCellRevision(u),this.isContentRemoved=!0,p.removeChild(p.childWidgets.indexOf(u)),this.canSkipTableItems=!0,this.owner.editor.removeFieldInBlock(u),this.owner.editor.removeFieldInBlock(u,!0),this.owner.editor.removeFieldInBlock(u,void 0,!0),u.destroy(),0===p.childWidgets.length?(this.owner.selection.editPosition=this.owner.selection.getHierarchicalIndex(p,"0"),this.owner.editor.removeBlock(p),p.destroy()):this.owner.editor.updateTable(p,!0)}return e instanceof s.a&&h||this.skipUnLinkElement||this.removeRangeRevisionForItem(e),0===t.range.length&&this.owner.revisions.remove(t),!1},e.prototype.removeRevisionFromPara=function(e,t){for(var i=this.owner.selection.getParagraphInfo(e),n=this.owner.selection.getParagraphInfo(t),o=i.paragraph;o instanceof r.g;){if(o.characterFormat.revisions.length>0)for(var s=0;s<o.characterFormat.revisions.length;s++)if(0===o.characterFormat.revisions[s].range.length){var a=o.characterFormat.revisions.indexOf(o.characterFormat.revisions[s]);o.characterFormat.revisions.splice(a,1),s--}o=n.paragraph===o?void 0:o.nextWidget}},e.prototype.updateRevisionID=function(){for(this.owner.editor.addRemovedNodes(this.revisionID);this.range.length>0;)this.removeRangeRevisionForItem(this.range[0])},e.prototype.removeRevisionItemsFromRange=function(e){if(e.revisions.length>0)for(var t=0;t<e.revisions.length;t++){var i=e.revisions[t];if(this.revisionID!==i.revisionID){var n=i.range.indexOf(e);e.revisions[t].range.splice(n,1),this.owner.trackChangesPane.updateCurrentTrackChanges(e.revisions[t])}0===i.range.length&&this.owner.revisions.remove(i)}},e.prototype.removeRangeRevisionForItem=function(e){var t=e.revisions.indexOf(this);if(t>=0){e.revisions.splice(t,1);var i=this.range.indexOf(e);this.range.splice(i,1),this.owner.trackChangesPane.updateCurrentTrackChanges(this)}},e.prototype.skipeElementRemoval=function(e){var t=e.paragraph;if(t.characterFormat.revisions.length>0)for(var i=0;i<t.characterFormat.revisions.length;i++){var n=t.characterFormat.revisions[i],r=n.range.indexOf(e);if(r>=0)return!0}return!1},e.prototype.removeRevisionFromRow=function(e){this.owner.editor.unlinkRangeFromRevision(e.rowFormat);for(var t=0;t<e.childWidgets.length;t++){var i=e.childWidgets[t];this.owner.editor.removeRevisionForCell(i,!1)}},e.prototype.removeItem=function(e){var t=e.line.paragraph;this.owner.editor.unLinkFieldCharacter(e);var i=e.line.children.indexOf(e);e.line.children.splice(i,1);var n=e.line.paragraph.floatingElements.indexOf(e);e.line.paragraph.floatingElements.splice(n,1);var r=e.line.paragraph.bodyWidget.floatingElements.indexOf(e);r>-1&&e.line.paragraph.bodyWidget.floatingElements.splice(r,1),this.owner.editor.removeEmptyLine(t)},e.prototype.canSkipCloning=function(){if(!i.i(n.isNullOrUndefined)(this.owner)&&this.owner.editorHistory&&this.owner.editorHistory.currentBaseHistoryInfo){if("DeleteCells"===this.owner.editorHistory.currentBaseHistoryInfo.action)return!0}return!1},e.prototype.destroy=function(){this.author=void 0,this.revisionType=void 0,this.revisionID=void 0,this.date=void 0,this.range=[],this.range=void 0,this.owner=void 0},e.prototype.clone=function(){if(this.canSkipCloning())return this;var t=new e(void 0,this.author,this.date);return t.revisionID=this.revisionID,t.revisionType=this.revisionType,t},e.cloneRevisions=function(e){for(var t=[],i=0;i<e.length;i++)t.push(e[i].revisionID);return t},e}(),d=function(){function e(e){this.changes=[],this.skipGroupAcceptReject=!1,this.owner=e}return e.prototype.get=function(e){if(e>=this.changes.length||e<0)throw new ReferenceError("Provided index is not within the range");return this.changes[e]},Object.defineProperty(e.prototype,"length",{get:function(){return this.changes.length},enumerable:!0,configurable:!0}),e.prototype.remove=function(e){if(!(i.i(n.isNullOrUndefined)(e)||this.changes.indexOf(e)<0)&&(this.changes.splice(this.changes.indexOf(e),1),-1!==this.owner.trackChangesPane.revisions.indexOf(e))){var t=this.owner.trackChangesPane.revisions.indexOf(e),r=!(this.owner.trackChangesPane.tableRevisions.containsKey(e)&&this.owner.trackChangesPane.tableRevisions.get(e)[this.owner.trackChangesPane.tableRevisions.get(e).length-1]!==e),o=this.owner.trackChangesPane.changes.get(e);r&&this.owner.trackChangesPane.changesInfoDiv.removeChild(o.outerSingleDiv),this.owner.trackChangesPane.revisions.splice(t,1),this.owner.trackChangesPane.changes.remove(e),this.owner.trackChangesPane.renderedChanges.containsKey(e)&&this.owner.trackChangesPane.renderedChanges.remove(e),this.owner.trackChangesPane.tableRevisions.containsKey(e)&&this.owner.trackChangesPane.tableRevisions.remove(e)}},e.prototype.acceptAll=function(){this.owner.isReadOnly||this.owner.documentHelper.isTrackedOnlyMode||this.handleRevisionCollection(!0)},e.prototype.rejectAll=function(){this.owner.isReadOnly||this.owner.documentHelper.isTrackedOnlyMode||this.handleRevisionCollection(!1)},e.prototype.handleRevisionCollection=function(e,t){this.skipGroupAcceptReject=!0;var r=this.owner.selection,o=r.start,s=r.end,a=t||this.changes;if(!(a.length<=0)){for(r.start.isExistBefore(r.end)||(o=r.end,s=r.start),o=o.clone(),s=s.clone(),e?this.owner.editor.initComplexHistory("Accept All"):this.owner.editor.initComplexHistory("Reject All");a.length>0;)e?a[0].accept():a[0].reject(),t&&a.splice(0,1),this.owner.enableHeaderAndFooter&&this.owner.editor.updateHeaderFooterWidget();if(!i.i(n.isNullOrUndefined)(r.editPosition)){var l=r.getTextPosBasedOnLogicalIndex(r.editPosition);this.owner.selection.selectContent(l,!0)}this.owner.editorHistory&&(this.owner.editorHistory.updateComplexHistory(),i.i(n.isNullOrUndefined)(r.editPosition)&&this.owner.editorHistory.undoStack.pop()),this.owner.editor.isSkipOperationsBuild=!0,this.owner.editor.reLayout(this.owner.selection,!1),this.owner.editor.isSkipOperationsBuild=!1,this.skipGroupAcceptReject=!1}},e.prototype.clear=function(){this.changes=[]},e.prototype.destroy=function(){if(this.changes){for(var e=0;e<this.changes.length;e++){this.changes[e].destroy()}this.changes=[]}this.changes=void 0,this.owner=void 0},e}()},function(e,t,i){"use strict";i.d(t,"a",function(){return r});var n=i(0),r=(i.n(n),function(){function e(){}return e.prototype.clear=function(){i.i(n.isNullOrUndefined)(this.overrideListLevel)||this.overrideListLevel.clearFormat(),this.overrideListLevel=void 0},e.prototype.destroy=function(){i.i(n.isNullOrUndefined)(this.overrideListLevel)||this.overrideListLevel.destroy(),this.levelNumber=void 0,this.startAt=void 0,this.overrideListLevel=void 0},e.prototype.clone=function(){var t=new e;return t.startAt=this.startAt,t.levelNumber=this.levelNumber,i.i(n.isNullOrUndefined)(this.overrideListLevel)||(t.overrideListLevel=this.overrideListLevel.clone(t)),t},e}())},function(e,t,i){"use strict";i.d(t,"a",function(){return s});var n=i(55),r=i(0),o=(i.n(r),i(17)),s=function(){function e(e){this.leftIn=new n.a(this),this.rightIn=new n.a(this),this.topIn=new n.a(this),this.bottomIn=new n.a(this),this.horizontalIn=new n.a(this),this.verticalIn=new n.a(this),this.diagonalUpIn=new n.a(this),this.diagonalDownIn=new n.a(this),this.isParsing=!1,this.ownerBase=e}return Object.defineProperty(e.prototype,"left",{get:function(){return this.ownerBase instanceof o.a?this.getPropertyValue("left"):this.leftIn},set:function(e){this.leftIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.ownerBase instanceof o.a?this.getPropertyValue("right"):this.rightIn},set:function(e){this.rightIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.ownerBase instanceof o.a?this.getPropertyValue("top"):this.topIn},set:function(e){this.topIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.ownerBase instanceof o.a?this.getPropertyValue("bottom"):this.bottomIn},set:function(e){this.bottomIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"horizontal",{get:function(){return this.ownerBase instanceof o.a?this.getPropertyValue("horizontal"):this.horizontalIn},set:function(e){this.horizontalIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vertical",{get:function(){return this.ownerBase instanceof o.a?this.getPropertyValue("vertical"):this.verticalIn},set:function(e){this.verticalIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"diagonalUp",{get:function(){return this.diagonalUpIn},set:function(e){this.diagonalUpIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"diagonalDown",{get:function(){return this.diagonalDownIn},set:function(e){this.diagonalDownIn=e},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(e){var t=this.getBorder(e);if(this.isParsing)return t;if(t.hasValues())return t;var n=this.ownerBase.baseStyle;if(!i.i(r.isNullOrUndefined)(n)){for(var o=this;!i.i(r.isNullOrUndefined)(n);){var s=void 0;if(this.ownerBase.listFormat.hasValue("listId")||(s=n.paragraphFormat.getListPargaraphFormat(e)),n.paragraphFormat.borders.getBorder(e).hasValues()){o=n.paragraphFormat.borders;break}if(!i.i(r.isNullOrUndefined)(s)&&s.borders.getBorder(e).hasValues()){o=s.borders;break}n=n.basedOn}if(!i.i(r.isNullOrUndefined)(n))return o.getBorder(e)}return this.getDefaultValue(e)},e.prototype.getDefaultValue=function(e){var t,n=this.documentParagraphFormat();return i.i(r.isNullOrUndefined)(n)||i.i(r.isNullOrUndefined)(n.borders)||(t=n.borders.getBorder(e)),t},e.prototype.documentParagraphFormat=function(){var e;return this.ownerBase instanceof o.a&&(e=this.ownerBase.getDocumentParagraphFormat()),e},e.prototype.getBorder=function(e){switch(e){case"left":return this.leftIn;case"right":return this.rightIn;case"top":return this.topIn;case"bottom":return this.bottomIn;case"vertical":return this.verticalIn;case"horizontal":return this.horizontalIn}},e.prototype.clearFormat=function(){i.i(r.isNullOrUndefined)(this.leftIn)||this.leftIn.clearFormat(),i.i(r.isNullOrUndefined)(this.topIn)||this.topIn.clearFormat(),i.i(r.isNullOrUndefined)(this.bottomIn)||this.bottomIn.clearFormat(),i.i(r.isNullOrUndefined)(this.rightIn)||this.rightIn.clearFormat(),i.i(r.isNullOrUndefined)(this.horizontalIn)||this.horizontalIn.clearFormat(),i.i(r.isNullOrUndefined)(this.verticalIn)||this.verticalIn.clearFormat(),i.i(r.isNullOrUndefined)(this.diagonalDown)||this.diagonalDown.clearFormat(),i.i(r.isNullOrUndefined)(this.diagonalUp)||this.diagonalUp.clearFormat()},e.prototype.destroy=function(){i.i(r.isNullOrUndefined)(this.leftIn)||this.leftIn.destroy(),i.i(r.isNullOrUndefined)(this.topIn)||this.topIn.destroy(),i.i(r.isNullOrUndefined)(this.bottomIn)||this.bottomIn.destroy(),i.i(r.isNullOrUndefined)(this.rightIn)||this.rightIn.destroy(),i.i(r.isNullOrUndefined)(this.horizontalIn)||this.horizontalIn.destroy(),i.i(r.isNullOrUndefined)(this.verticalIn)||this.verticalIn.destroy(),i.i(r.isNullOrUndefined)(this.diagonalDown)||this.diagonalDown.destroy(),i.i(r.isNullOrUndefined)(this.diagonalUp)||this.diagonalUp.destroy(),this.topIn=void 0,this.bottomIn=void 0,this.leftIn=void 0,this.rightIn=void 0,this.horizontalIn=void 0,this.verticalIn=void 0,this.diagonalDownIn=void 0,this.diagonalUpIn=void 0,this.ownerBase=void 0},e.prototype.cloneFormat=function(){var t=new e(void 0);return t.top=i.i(r.isNullOrUndefined)(this.topIn)?void 0:this.topIn.cloneFormat(),t.bottom=i.i(r.isNullOrUndefined)(this.bottomIn)?void 0:this.bottomIn.cloneFormat(),t.left=i.i(r.isNullOrUndefined)(this.leftIn)?void 0:this.leftIn.cloneFormat(),t.right=i.i(r.isNullOrUndefined)(this.rightIn)?void 0:this.rightIn.cloneFormat(),t.horizontal=i.i(r.isNullOrUndefined)(this.horizontalIn)?void 0:this.horizontalIn.cloneFormat(),t.vertical=i.i(r.isNullOrUndefined)(this.verticalIn)?void 0:this.verticalIn.cloneFormat(),t.diagonalUp=i.i(r.isNullOrUndefined)(this.diagonalUp)?void 0:this.diagonalUp.cloneFormat(),t.diagonalDown=i.i(r.isNullOrUndefined)(this.diagonalDown)?void 0:this.diagonalDown.cloneFormat(),t},e.prototype.copyFormat=function(e){if(!i.i(r.isNullOrUndefined)(e.getBorder("left"))&&e.getBorder("left")instanceof n.a){var t=new n.a(this);t.copyFormat(e.getBorder("left")),this.left=t}if(!i.i(r.isNullOrUndefined)(e.getBorder("right"))&&e.getBorder("right")instanceof n.a){var o=new n.a(this);o.copyFormat(e.getBorder("right")),this.right=o}if(!i.i(r.isNullOrUndefined)(e.getBorder("top"))&&e.getBorder("top")instanceof n.a){var s=new n.a(this);s.copyFormat(e.getBorder("top")),this.top=s}if(!i.i(r.isNullOrUndefined)(e.getBorder("bottom"))&&e.getBorder("bottom")instanceof n.a){var a=new n.a(this);a.copyFormat(e.getBorder("bottom")),this.bottom=a}if(!i.i(r.isNullOrUndefined)(e.getBorder("horizontal"))&&e.getBorder("horizontal")instanceof n.a){var l=new n.a(this);l.copyFormat(e.getBorder("horizontal")),this.horizontal=l}if(!i.i(r.isNullOrUndefined)(e.getBorder("vertical"))&&e.getBorder("vertical")instanceof n.a){var d=new n.a(this);d.copyFormat(e.getBorder("vertical")),this.vertical=d}!i.i(r.isNullOrUndefined)(e.diagonalDown)&&e.diagonalDown instanceof n.a&&(this.diagonalDown=new n.a(this),this.diagonalDown.copyFormat(e.diagonalDown)),!i.i(r.isNullOrUndefined)(e.diagonalUp)&&e.diagonalUp instanceof n.a&&(this.diagonalUp=new n.a(this),this.diagonalUp.copyFormat(e.diagonalUp))},e}()},function(e,t,i){"use strict";i.d(t,"a",function(){return n}),i.d(t,"p",function(){return r}),i.d(t,"q",function(){return o}),i.d(t,"r",function(){return s}),i.d(t,"u",function(){return a}),i.d(t,"v",function(){return l}),i.d(t,"w",function(){return d}),i.d(t,"z",function(){return h}),i.d(t,"y",function(){return c}),i.d(t,"o",function(){return p}),i.d(t,"x",function(){return u}),i.d(t,"s",function(){return g}),i.d(t,"t",function(){return f}),i.d(t,"F",function(){return m}),i.d(t,"B",function(){return v}),i.d(t,"C",function(){return y}),i.d(t,"l",function(){return w}),i.d(t,"j",function(){return b}),i.d(t,"k",function(){return x}),i.d(t,"n",function(){return C}),i.d(t,"E",function(){return I}),i.d(t,"D",function(){return F}),i.d(t,"m",function(){return k}),i.d(t,"G",function(){return P}),i.d(t,"A",function(){return T}),i.d(t,"H",function(){return S}),i.d(t,"I",function(){return W}),i.d(t,"b",function(){return N}),i.d(t,"i",function(){return H}),i.d(t,"c",function(){return E}),i.d(t,"d",function(){return O}),i.d(t,"e",function(){return _}),i.d(t,"J",function(){return B}),i.d(t,"f",function(){return L}),i.d(t,"g",function(){return R}),i.d(t,"h",function(){return A});var n="internalZoomFactorChange",r="contentChange",o="documentChange",s="selectionChange",a="zoomFactorChange",l="beforeFieldFill",d="afterFieldFill",h="afterFormFieldFill",c="beforeFormFieldFill",p="serviceFailure",u="viewChange",g="customContextMenuSelect",f="customContextMenuBeforeOpen",m="contentControl",v="commentBegin",y="commentEnd",w="beforeCommentAction",b="commentDelete",x="beforeAcceptRejectChanges",C="beforePaneSwitch",I="requestNavigate",F="actionComplete",k="trackChange",P="searchResultsChange",T="keyDown",S="toolbarClick",W="beforeFileOpen",N="internalviewChange",H="beforeXmlHttpRequestSend",E="protectionTypeChange",O="internalDocumentEditorSettingsChange",_="internalStyleCollectionChange",B="Times New Roman",L="internalAutoResize",R="beforeAutoResize",A="trackChanges"},function(e,t,i){"use strict";i.d(t,"a",function(){return m});var n=i(17),r=i(31),o=i(21),s=i(30),a=i(7),l=i(35),d=i(2),h=i(6),c=i(1),p=i(0),u=(i.n(p),i(9)),g=i(4),f=i(16),m=function(){function e(e){this.cellOperation=[],this.splittedRevisions=[],this.isremovedNodes=!1,this.markerData=[],this.ownerIn=e,this.documentHelper=e.documentHelper,this.modifiedPropertiesIn=[],this.modifiedNodeLength=[],this.removedNodesIn=[],this.insertedNodes=[]}return Object.defineProperty(e.prototype,"owner",{get:function(){return this.ownerIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"editorHistory",{get:function(){return this.owner.editorHistory},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"action",{get:function(){return this.actionIn},set:function(e){this.actionIn=e,this.owner.enableCollaborativeEditing&&!this.editorHistory.isUndoing&&0==this.cellOperation.length&&("DeleteColumn"===e||"DeleteCells"===e||"ClearCells"===e||"MergeCells"===e?(this.owner.selection.isTableSelected(!0)||this.owner.selection.isRowSelect())&&"ClearCells"!==e&&"MergeCells"!==e||(this.insertedText=f.c.Cell,this.deleteColumnOperation(this.action)):"Accept Change"===e||"Reject Change"===e?this.createAcceptRejectOperation(this.action):"SectionBreak"===e?(this.insertedText=f.c.Section_Break,this.type="NewPage"):"SectionBreakContinuous"===e&&(this.insertedText=f.c.Section_Break,this.type="Continuous"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"modifiedProperties",{get:function(){return this.modifiedPropertiesIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"removedNodes",{get:function(){return this.removedNodesIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionStart",{get:function(){return this.selectionStartIn},set:function(e){this.selectionStartIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionEnd",{get:function(){return this.selectionEndIn},set:function(e){this.selectionEndIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"insertPosition",{get:function(){return this.insertPositionIn},set:function(e){this.insertPositionIn=e,this.owner.enableCollaborativeEditing&&""!==e&&!i.i(p.isNullOrUndefined)(e)&&-1===e.indexOf("C")&&(this.insertIndex=this.owner.selection.getAbsolutePositionFromRelativePosition(e))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endPosition",{get:function(){return this.endPositionIn},set:function(e){this.endPositionIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewer",{get:function(){return this.ownerIn.viewer},enumerable:!0,configurable:!0}),e.prototype.updateSelection=function(){if(this.owner.enableCollaborativeEditing){var e=void 0,t=void 0;if("RemoveEditRange"==this.action){var i=this.owner.selection.getEditRangeStartElement(),n=this.owner.selection.getPosition(i);e=n.startPosition,t=n.endPosition}else e=this.owner.selection.start.clone(),t=this.owner.selection.end.clone(),this.updateTableSelection(e,t);this.startIndex=this.owner.selection.getAbsolutePositionFromRelativePosition(e),this.owner.selection.isEndOffset=!0,this.endIndex=this.owner.selection.getAbsolutePositionFromRelativePosition(t),this.owner.selection.isEndOffset=!1,this.owner.selection.isForward?this.startIndex-=this.owner.selection.getTableRelativeValue(e,t):this.endIndex-=this.owner.selection.getTableRelativeValue(t,e),this.splitOperationForDelete(e,t)}var r=this.owner.selection.getParagraphInfo(this.owner.selection.start);this.selectionStart=this.owner.selection.getHierarchicalIndex(r.paragraph,r.offset.toString()),r=this.owner.selection.getParagraphInfo(this.owner.selection.end),this.selectionEnd=this.owner.selection.getHierarchicalIndex(r.paragraph,r.offset.toString())},e.prototype.updateTableSelection=function(e,t){var i=e,n=t;if(this.owner.selection.isForward||(i=t,n=e),i.paragraph.isInsideTable){var r=this.owner.selection.getFirstParagraph(i.paragraph.associatedCell);if(n.paragraph.isInsideTable){if(!i.paragraph.associatedCell.equals(n.paragraph.associatedCell)){var o=this.owner.selection.getLastParagraph(n.paragraph.associatedCell);i.setPosition(r.firstChild,!0),n.setPositionParagraph(o.lastChild,o.lastChild.getEndOffset()+1)}}else i.setPosition(r.firstChild,!0)}else if(n.paragraph.isInsideTable){var o=this.owner.selection.getLastParagraph(n.paragraph.associatedCell);n.setPositionParagraph(o.lastChild,o.lastChild.getEndOffset()+1)}},e.prototype.splitOperationForDelete=function(e,t){var i=e,n=t;if(this.owner.selection.isForward||(i=t,n=e),!i.paragraph.isInsideTable&&n.paragraph.isInsideTable&&("BackSpace"===this.action||"Delete"===this.action)){if(!this.owner.selection.getLastBlockInLastCell(n.paragraph.associatedCell.ownerTable).associatedCell.equals(n.paragraph.associatedCell)){var r=this.startIndex,o=i.currentWidget,s=i.offset;i.setPosition(i.paragraph.firstChild,!0),this.startIndex=this.owner.selection.getAbsolutePositionFromRelativePosition(i);var a=this.startIndex,l=this.owner.documentHelper.layout.getParentTable(n.paragraph.associatedCell.ownerTable),d={paragraph:null,offset:0},h=this.owner.selection.getPositionInfoForHeaderFooter(d,{position:0,done:!1},l).position;this.startIndex=h+1,this.cellOperation.push(this.getDeleteOperation(this.action)),this.startIndex=h+3,0!==s&&(this.pasteContent=this.owner.sfdtExportModule.write(this.owner.documentEditorSettings.optimizeSfdt?1:0,i.currentWidget,i.offset,o,s,!1,!0),this.cellOperation.push(this.getPasteOpertion(this.pasteContent,r-a))),this.endIndex=h,this.startIndex=a,this.cellOperation.push(this.getDeleteOperation(this.action))}}},e.prototype.setBookmarkInfo=function(e){this.removedNodes.push({bookmark:e,startIndex:e.indexInOwner,endIndex:e.reference.indexInOwner})},e.prototype.setFormFieldInfo=function(e,t){this.removedNodes.push({formField:e,value:t})},e.prototype.setEditRangeInfo=function(e){this.removedNodes.push({editStart:e,startIndex:e.indexInOwner,endIndex:e.editRangeEnd.indexInOwner})},e.prototype.revertFormTextFormat=function(){var e=this.removedNodes[0],t=e.value,i=e.formField;this.editorHistory.isUndoing?(this.owner.editorModule.applyTextFormatInternal(i,t),this.editorHistory.recordChanges(this)):(t=g.a.formatText(i.formFieldData.format,t),this.owner.editorModule.applyTextFormatInternal(i,t),this.editorHistory.undoStack.push(this))},e.prototype.revertFormField=function(){var e=this.removedNodes[0],t=e.formField;t.formFieldData instanceof d.m?this.owner.editorModule.toggleCheckBoxFormField(t,!0,e.value):this.owner.editorModule.updateFormField(t,e.value)},e.prototype.revertBookmark=function(){var e=this.removedNodes[0],t=e.bookmark;if(this.editorHistory.isUndoing){var n=this.owner.editorModule.getMarkerData(t);this.documentHelper.bookmarks.add(t.name,t),this.markerData.push(n),t.line.children.splice(e.startIndex,0,t);var r=t.previousNode;r instanceof d.b&&!i.i(p.isNullOrUndefined)(r.formFieldData)&&(r.formFieldData.name=t.name),this.markerData.push(n),t.reference.line.children.splice(e.endIndex,0,t.reference),this.editorHistory.recordChanges(this),1==this.owner.documentEditorSettings.showBookmarks&&this.viewer.updateScrollBars(),this.owner.editorModule.fireContentChange()}else this.owner.editorModule.deleteBookmarkInternal(t),this.editorHistory.undoStack.push(this)},e.prototype.revertComment=function(){var e=this.insertPosition,t=this.removedNodes[0],i=!1;if("ResolveComment"===this.action)return this.editorHistory.currentBaseHistoryInfo=this,void this.owner.editor.resolveOrReopenComment(t,!t.isResolved);if("EditComment"===this.action){var n=this.modifiedProperties[0];this.editorHistory.currentBaseHistoryInfo=this;var r=this.owner.commentReviewPane.commentPane.comments.get(t);return r.commentText.innerText=n.text,n.text=t.text,t.text=r.commentText.innerText,this.owner.editorHistory.updateHistory(),void this.owner.fireContentChange()}if("InsertCommentWidget"===this.action?i=this.editorHistory.isRedoing:"DeleteCommentWidget"===this.action&&(i=this.editorHistory.isUndoing),i)t&&(this.insertedElement=t.clone(),t.isReply?this.owner.editor.addReplyComment(t,this.insertPosition):this.owner.editor.addCommentWidget(t,!1,!0,!0));else{var o=this.owner.editor.getCommentElementBox(e);this.owner.editor.deleteCommentWidget(o)}},e.prototype.revertEditRangeRegion=function(){var e=this.removedNodes[0],t=e.editStart;if(this.editorHistory.isUndoing){var i=""===t.user?t.group:t.user;this.owner.editor.updateRangeCollection(t,i),this.markerData.push(this.owner.editorModule.getMarkerData(t)),this.markerData.push(this.owner.editorModule.getMarkerData(t.editRangeEnd)),t.line.children.splice(e.startIndex,0,t),t.editRangeEnd.line.children.splice(e.endIndex,0,t.editRangeEnd),this.editorHistory.recordChanges(this)}else this.owner.editorModule.removeUserRestrictionsInternal(t),this.editorHistory.undoStack.push(this);this.owner.editor.fireContentChange()},e.prototype.revert=function(){if("FormTextFormat"===this.action)return void this.revertFormTextFormat();if("UpdateFormField"===this.action)return void this.revertFormField();if("DeleteBookmark"===this.action)return void this.revertBookmark();if("RemoveEditRange"===this.action)return void this.revertEditRangeRegion();if("InsertCommentWidget"===this.action||"DeleteCommentWidget"===this.action||"ResolveComment"===this.action||"EditComment"===this.action)return void this.revertComment();if("ListFormat"===this.action&&""!==this.owner.editor.listNumberFormat){var e=this.documentHelper.lists[0].abstractList.levels[this.owner.editor.listLevelNumber],t=e.listLevelPattern,n=e.numberFormat;e.listLevelPattern=this.owner.editor.listLevelPattern,e.numberFormat=this.owner.editor.listNumberFormat,this.owner.editor.listLevelPattern=t,this.owner.editor.listNumberFormat=n}this.owner.isShiftingEnabled=!0;var r=void 0,o=void 0,s=this.selectionStart,l=this.selectionEnd;this.collabStart=this.selectionStart,this.collabEnd=this.selectionEnd,this.owner.enableCollaborativeEditing&&(this.insertIndex=this.owner.selection.getAbsolutePositionFromRelativePosition(this.insertPosition),this.startIndex=this.insertIndex,this.endIndex=this.owner.selection.getAbsolutePositionFromRelativePosition(this.endPosition));var h=a.i.isForwardSelection(s,l);if(this.modifiedProperties.length>0||"Selection"===this.action||"ClearCharacterFormat"===this.action||"ClearParagraphFormat"===this.action)r=this.owner.selection.getTextPosBasedOnLogicalIndex(s),o=this.owner.selection.getTextPosBasedOnLogicalIndex(l),this.revertModifiedProperties(r,o);else{var c=this.owner.selection,u=this.removedNodes;this.removedNodes.length>0&&(this.isremovedNodes=!0),this.removedNodesIn=[],i.i(p.isNullOrUndefined)(this.endPosition)&&(this.endPosition=this.insertPosition);var g=a.i.isForwardSelection(this.insertPosition,this.endPosition),f=c.getTextPosBasedOnLogicalIndex(g?this.insertPosition:this.endPosition),m=c.getTextPosBasedOnLogicalIndex(g?this.endPosition:this.insertPosition);if("RemoveRowTrack"===this.action&&this.editorHistory.isUndoing&&(this.owner.selection.select(this.selectionEnd,this.selectionEnd),this.owner.selection.start.paragraph.isInsideTable&&(this.endRevisionLogicalIndex=this.selectionEnd)),this.editorHistory.isUndoing&&(this.lastElementRevision&&i.i(p.isNullOrUndefined)(this.endRevisionLogicalIndex)?this.updateEndRevisionInfo():"RemoveRowTrack"===this.action&&(this.endRevisionLogicalIndex=this.selectionEnd)),"ClearRevisions"===this.action&&(this.undoRevisionForElements(f,m,u[u.length-1]),u=[]),"Uppercase"===this.action){c.selectPosition(f,m),this.editorHistory.currentBaseHistoryInfo=this;var v=this.owner.editorModule;return v.changeSelectedTextCase(c,f,m,this.action.toString(),u),void v.reLayout(c)}if(f.isAtSamePosition(m)?c.selectContent(f,!0):c.selectPosition(f,m),"InsertHyperlink"===this.action&&this.editorHistory.isRedoing){var y=this.owner.selection.getHyperlinkField();if(!i.i(p.isNullOrUndefined)(y)){var w=y.line.getOffset(y,0);f.setPositionParagraph(y.line,w),this.owner.selection.start.setPositionInternal(f),w=y.fieldEnd.line.getOffset(y.fieldEnd,1),m.setPositionParagraph(y.fieldEnd.line,w)}}this.editorHistory.currentBaseHistoryInfo=this,this.selectionStart=this.insertPosition,this.insertPosition=void 0,this.selectionEnd=this.endPosition,this.endPosition=void 0;var b=!1;if(this.endRevisionLogicalIndex&&u.length>0){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing&&f.isAtSamePosition(m)){var x=c.getTextPosBasedOnLogicalIndex(this.endRevisionLogicalIndex);c.selectPosition(f,x)}this.editorHistory.isUndoing&&this.owner.editor.deleteSelectedContents(c,!0)}if(f.isAtSamePosition(m)){if("SectionBreakContinuous"===this.action&&f&&this.editorHistory.isUndoing&&0===f.offset&&!i.i(p.isNullOrUndefined)(f.paragraph.previousRenderedWidget)&&f.paragraph.previousRenderedWidget instanceof d.g&&f.paragraph.previousRenderedWidget.isEndsWithPageBreak&&f.paragraph.containerWidget instanceof d.o&&f.currentWidget===f.currentWidget.paragraph.firstChild&&"NoBreak"===f.paragraph.containerWidget.sectionFormat.breakCode){var C=f.paragraph.previousRenderedWidget.containerWidget;this.owner.editor.combineSectionInternal(this.owner.selection,C,f.paragraph.containerWidget),this.owner.editorModule.layoutWholeDocument()}}else{b="BackSpace"===this.action||"Delete"===this.action||"ClearCells"===this.action||"DeleteCells"===this.action;var I=u.length>0&&"ParaMarkTrack"===this.action||"ClearRevisions"===this.action||"AcceptTOC"===this.action;b||"MergeCells"===this.action||"InsertRowAbove"===this.action||"InsertRowBelow"===this.action||"InsertColumnLeft"===this.action||"InsertColumnRight"===this.action||"Borders"===this.action||"DeleteTable"===this.action||"DeleteColumn"===this.action||"DeleteRow"===this.action||(c.end.setPositionInternal(m),this.owner.selection.isEmpty||I||(this.editorHistory.isRedoing&&"Accept Change"!==this.action&&"ParaMarkTrack"!==this.action&&"ParaMarkReject"!==this.action&&"RemoveRowTrack"!==this.action?this.owner.editorModule.removeSelectedContents(c):this.owner.editorModule.deleteSelectedContents(c,!0),!i.i(p.isNullOrUndefined)(this.editorHistory.currentHistoryInfo)&&"PageBreak"===this.editorHistory.currentHistoryInfo.action&&this.documentHelper.blockToShift&&this.documentHelper.layout.shiftLayoutedItems(!1)))}var F=this.editorHistory.isRedoing&&!b;b=!this.lastElementRevision&&b,this.revertModifiedNodes(u,F,h?s:l,s===l),b&&this.removeContent(f,m,!0)}var k=!1,P=!1;i.i(p.isNullOrUndefined)(this.editorHistory.currentHistoryInfo)||"Reject All"!==this.editorHistory.currentHistoryInfo.action&&"Accept All"!==this.editorHistory.currentHistoryInfo.action&&"Paste"!==this.editorHistory.currentHistoryInfo.action||(P=!0),(!this.owner.trackChangesPane.isTrackingPageBreak&&((this.editorHistory.isUndoing||this.endRevisionLogicalIndex||"RemoveRowTrack"===this.action||P)&&i.i(p.isNullOrUndefined)(this.editorHistory.currentHistoryInfo)||P)||("InsertRowAbove"===this.action||"Borders"===this.action||"InsertRowBelow"===this.action||"InsertColumnLeft"===this.action||"InsertColumnRight"===this.action||"Accept Change"===this.action||"PasteColumn"===this.action||"PasteRow"===this.action||"PasteOverwrite"===this.action||"PasteNested"===this.action)&&(this.editorHistory.isRedoing||"Paste"===this.editorHistory.currentHistoryInfo.action))&&("RemoveRowTrack"===this.action&&this.editorHistory.isRedoing?(r=this.owner.selection.getTextPosBasedOnLogicalIndex(this.selectionStart),o=this.owner.selection.getTextPosBasedOnLogicalIndex(this.selectionEnd)):(r=this.owner.selection.getTextPosBasedOnLogicalIndex(s),o=this.owner.selection.getTextPosBasedOnLogicalIndex(l)),this.owner.selection.selectRange(r,o),this.documentHelper.updateFocus(),k=!0),this.owner.trackChangesPane.isTrackingPageBreak=!1,this.insertPosition=s,this.endPosition=l,i.i(p.isNullOrUndefined)(this.editorHistory.currentHistoryInfo)||"Accept All"!==this.editorHistory.currentHistoryInfo.action&&"Reject All"!==this.editorHistory.currentHistoryInfo.action&&"RemoveComment"!==this.editorHistory.currentHistoryInfo.action||this.owner.documentHelper.blockToShift&&this.owner.documentHelper.layout.shiftLayoutedItems(!1),this.owner.editorModule.reLayout(this.owner.selection,this.owner.selection.isEmpty),this.editorHistory.isUndoing&&"SectionBreak"===this.action&&this.owner.editorModule.layoutWholeDocument(),k&&this.documentHelper.scrollToPosition(this.owner.selection.start,this.owner.selection.end),this.highlightListText()},e.prototype.highlightListText=function(){if(!i.i(p.isNullOrUndefined)(this.editorHistory.currentHistoryInfo)&&("ListCharacterFormat"===this.action||"ListSelect"===this.editorHistory.currentHistoryInfo.action&&"ListFormat"===this.action)){var e=this.owner.selection.getTextPosBasedOnLogicalIndex(this.selectionStart),t=e.currentWidget;this.documentHelper.selection.highlightListText(t)}},e.prototype.removeContent=function(e,t,n){if(!i.i(p.isNullOrUndefined)(e.paragraph.containerWidget)&&e.paragraph.containerWidget instanceof d.o&&!i.i(p.isNullOrUndefined)(t.paragraph.containerWidget)&&t.paragraph.containerWidget instanceof d.o||!i.i(p.isNullOrUndefined)(e.paragraph.containerWidget)&&!i.i(p.isNullOrUndefined)(t.paragraph.containerWidget)&&e.paragraph.containerWidget instanceof d.j&&t.paragraph.containerWidget instanceof d.j&&!i.i(p.isNullOrUndefined)(e.paragraph.bodyWidget)||!i.i(p.isNullOrUndefined)(e.paragraph.containerWidget)&&!i.i(p.isNullOrUndefined)(t.paragraph.containerWidget)&&e.paragraph.containerWidget instanceof d.i&&t.paragraph.containerWidget instanceof d.i){this.owner.selection.selectRange(e,t),this.documentHelper.updateFocus();var r=!1;"BackSpace"!==this.action&&"Uppercase"!==this.action&&"RemoveRowTrack"!==this.action||(r=!0),this.owner.editorModule.deleteSelectedContents(this.owner.selection,r,n)}},e.prototype.updateEndRevisionInfo=function(){this.lastElementRevision=this.checkAdjacentNodeForMarkedRevision(this.lastElementRevision);var e=this.retrieveEndPosition(this.lastElementRevision),t=this.owner.selection.getParagraphInfo(e);t.paragraph.getLength()!=t.offset||t.paragraph.isInsideTable||t.offset++,this.endRevisionLogicalIndex=this.owner.selection.getHierarchicalIndex(t.paragraph,t.offset.toString()),this.lastElementRevision.isMarkedForRevision=!1},e.prototype.retrieveEndPosition=function(e){var t=new a.i(this.owner),i=e.line.getOffset(e,0)+e.length;return t.setPositionFromLine(e.line,i),t},e.prototype.checkAdjacentNodeForMarkedRevision=function(e){for(var t,n=e.nextNode;!i.i(p.isNullOrUndefined)(n)&&n.isMarkedForRevision;)t=n,n=n.nextNode;return i.i(p.isNullOrUndefined)(t)?e:t},e.prototype.revertModifiedProperties=function(e,t){"CellFormat"!==this.action&&"CellOptions"!==this.action&&"TableOptions"!==this.action||(this.owner.isShiftingEnabled=!1),this.owner.selection.selectRange(e,t),this.documentHelper.updateFocus(),"RowResizing"===this.action||"CellResizing"===this.action?this.revertResizing():"CellOptions"===this.action||"TableOptions"===this.action?this.revertTableDialogProperties(this.action):"Selection"!==this.action&&this.revertProperties()},e.prototype.redoAction=function(){var e=this.owner.editorModule;switch(this.action=this.action,this.action){case"BackSpace":e.singleBackspace(this.owner.selection,!0);break;case"Delete":e.singleDelete(this.owner.selection,!0);break;case"DeleteTable":e.deleteTable();break;case"DeleteColumn":e.deleteColumn();break;case"DeleteRow":e.deleteRow();break;case"MergeCells":e.mergeSelectedCellsInTable();break;case"InsertRowAbove":e.insertRow(!0);break;case"InsertRowBelow":e.insertRow(!1);break;case"InsertColumnLeft":case"InsertColumnRight":e.insertColumn(!0);break;case"SectionBreak":e.insertSection(this.owner.selection,!0);break;case"SectionBreakContinuous":e.insertSection(this.owner.selection,!0,void 0,!0);break;case"TableAutoFitToContents":e.autoFitTable("FitToContents");break;case"TableAutoFitToWindow":e.autoFitTable("FitToWindow");break;case"TableFixedColumnWidth":e.autoFitTable("FixedColumnWidth");break;case"RemoveRowTrack":this.owner.selection.handleAcceptReject(!0)}},e.prototype.revertModifiedNodes=function(e,t,n,r){if((!t||"BackSpace"!==this.action&&"Delete"!==this.action&&"DeleteTable"!==this.action&&"DeleteColumn"!==this.action&&"DeleteRow"!==this.action&&"InsertRowAbove"!==this.action&&"InsertRowBelow"!==this.action&&"InsertColumnLeft"!==this.action&&"InsertColumnRight"!==this.action&&"MergeCells"!==this.action&&"SectionBreak"!==this.action&&"SectionBreakContinuous"!==this.action&&"TableAutoFitToContents"!==this.action&&"TableAutoFitToWindow"!==this.action&&"TableFixedColumnWidth"!==this.action&&"PasteColumn"!==this.action&&"PasteOverwrite"!==this.action&&"PasteNested"!==this.action||(this.redoAction(),"SectionBreak"!==this.action&&"SectionBreakContinuous"!==this.action))&&e.length>0)if(this.editorHistory.isUndoing&&("RemoveRowTrack"===this.action||"DeleteCells"===this.action||"DeleteColumn"===this.action||"DeleteRow"===this.action||"MergeCells"===this.action)||"InsertRowAbove"===this.action||"InsertRowBelow"===this.action||"InsertColumnLeft"===this.action||"ClearCells"===this.action||"InsertColumnRight"===this.action||"Borders"===this.action||"TableAutoFitToContents"===this.action||"TableAutoFitToWindow"===this.action||"TableFixedColumnWidth"===this.action||"RemoveRowTrack"===this.action||"PasteColumn"===this.action||"PasteRow"===this.action||"PasteOverwrite"===this.action||"PasteNested"===this.action){var s=this.selectionStart,a=this.owner.editorModule.getBlock({index:s}).node,l=e[e.length-1];if((a instanceof d.u||a.previousRenderedWidget instanceof d.u||a.isInsideTable)&&l instanceof d.u){if(a instanceof d.g&&!a.isInsideTable?a=a.previousRenderedWidget:a instanceof d.g&&a.isInsideTable&&(a=a.associatedCell.ownerTable),a=a.combineWidget(this.viewer),this.owner.enableCollaborativeEditing){var h={paragraph:null,offset:0};this.startIndex=this.owner.selection.getPositionInfoForHeaderFooter(h,{position:0,done:!1},a).position,this.endIndex=this.startIndex+this.owner.selection.getBlockLength(void 0,a,0,{done:!1},!0,void 0,void 0),this.cellOperation.push(this.getDeleteOperation("Delete"))}this.owner.editorModule.insertTableInternal(a,l,!1),"PasteColumn"===this.action||"PasteRow"===this.action||"PasteOverwrite"===this.action||"PasteNested"===this.action?this.removedNodes.push(a):e.splice(e.indexOf(l),1)}else l instanceof d.u&&"RemoveRowTrack"!==this.action?this.owner.editorModule.insertBlock(l):this.insertRemovedNodes(e,e[e.length-1])}else{var c=n,a=this.owner.editorModule.getBlock({index:c}).node;if(e.length>0&&("BackSpace"===this.action&&r||!(a instanceof d.u)&&!(a instanceof d.x))){var l=e[0];if(l instanceof d.o&&!i.i(p.isNullOrUndefined)(e[1])&&(l=e[1]),("TrackingPageBreak"===this.action||("SectionBreak"===this.action||"SectionBreakContinuous"===this.action)&&l instanceof d.o||!i.i(p.isNullOrUndefined)(this.editorHistory.currentHistoryInfo)&&"PageBreak"===this.editorHistory.currentHistoryInfo.action)&&(l=e[1]),l instanceof o.a){var u=new d.g;u.characterFormat=l,this.owner.editorModule.insertNewParagraphWidget(u,!0),e.splice(e.indexOf(l),1),a=u}if(l instanceof d.g&&this.owner.selection.start.offset>0&&(this.owner.editorModule.insertNewParagraphWidget(l,!0),l.characterFormat.removedIds.length>0&&this.owner.editor.constructRevisionFromID(l.characterFormat,void 0),e.splice(e.indexOf(l),1),i.i(p.isNullOrUndefined)(a))){var g=this.documentHelper.selection.getNextParagraphBlock(l.getSplitWidgets().pop());this.owner.selection.getNextRenderedBlock(l);var f=this.owner.selection.start.paragraph;!(g&&f&&f.bodyWidget instanceof d.o)||f.isInsideTable||this.owner.selection.isinEndnote||this.owner.selection.isinFootnote||f.bodyWidget.equals(g.bodyWidget)||(g=void 0),i.i(p.isNullOrUndefined)(g)&&this.owner.selection.selectParagraphInternal(l,!0)}if(l instanceof d.u&&this.owner.selection.start.offset>0){var m=e[e.length-1];if(m instanceof d.g&&(this.owner.editorModule.insertNewParagraphWidget(m,!0),e.splice(e.indexOf(m),1),i.i(p.isNullOrUndefined)(a))){var g=this.documentHelper.selection.getNextParagraphBlock(m.getSplitWidgets().pop());i.i(p.isNullOrUndefined)(g)&&this.owner.selection.selectParagraphInternal(m,!0)}}}if(e.length>0){var v=e[e.length-1];if(a instanceof d.u&&(a=a.combineWidget(this.viewer),v instanceof d.u)){this.owner.editorModule.insertTableInternal(a,v,!0),e.splice(e.indexOf(v),1),this.insertPosition=n;var y=v.getSplitWidgets().pop();y.nextRenderedWidget instanceof d.u?a=y.nextRenderedWidget:(c=n,a=this.owner.editorModule.getBlock({index:c}).node)}if(v instanceof d.g&&this.owner.selection.start.offset>0&&this.owner.selection.start.offset===this.owner.selection.getLineLength(this.owner.selection.start.paragraph.lastChild)){var w=this.owner.editorModule;w.insertNewParagraphWidget(v,!1),v.characterFormat.removedIds.length>0&&this.owner.editor.constructRevisionFromID(v.characterFormat,void 0),e.splice(e.indexOf(v),1),"Paste"!==this.action&&w.removeBlock(this.owner.selection.start.paragraph);var b=this.documentHelper.selection.getNextParagraphBlock(v.getSplitWidgets().pop());i.i(p.isNullOrUndefined)(b)||this.owner.selection.selectParagraphInternal(b,!0)}else if(e[0]instanceof d.u&&1!==e.length){var x=e[1];x instanceof d.g&&x.isEmpty()&&e.splice(e.indexOf(x),1)}}e.length>0&&(a instanceof d.u&&(a=a.combineWidget(this.viewer)),this.insertRemovedNodes(e,a))}},e.prototype.insertRemovedNodes=function(e,t){for(var n=e.length-1;n>-1;n--){var r=e[n];if(r instanceof d.c)this.owner.editorModule.insertInlineInSelection(this.owner.selection,r);else if(r instanceof d.C)r instanceof d.z?t instanceof d.u&&(t.childWidgets.splice(0,0,r),this.owner.editorModule.updateNextBlocksIndex(r,!0),0!==n&&e[n-1]instanceof d.z||this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1)):t instanceof d.u&&"RemoveRowTrack"!==this.action?this.owner.editorModule.insertBlockTable(this.owner.selection,r,t):r instanceof d.g&&!r.isInsideTable&&"RemoveRowTrack"===this.action?this.owner.editorModule.insertNewParagraphWidget(r,!1):r instanceof d.u&&"RemoveRowTrack"===this.action?(this.owner.editorModule.insertTableInternal(r,r,!1,!0),!i.i(p.isNullOrUndefined)(e[n-1])&&!i.i(p.isNullOrUndefined)(r.nextRenderedWidget)&&r.nextRenderedWidget instanceof d.g&&(this.owner.selection.start.setPositionParagraph(r.nextRenderedWidget.firstChild,0),this.owner.selection.end.setPositionParagraph(r.nextRenderedWidget.firstChild,0))):this.owner.editorModule.insertBlock(r);else if(r instanceof o.a){var s=this.selectionStart,a=this.owner.editorModule.getBlock({index:s}).node;a instanceof d.g&&(r.removedIds.length>0?(a.characterFormat.removedIds=r.removedIds.slice(),this.owner.editor.constructRevisionFromID(a.characterFormat,!0)):a.characterFormat.revisions.length>0&&(a.characterFormat=r.cloneFormat()))}else if(r instanceof d.o)i.i(p.isNullOrUndefined)(r.removedHeaderFooters)||0===r.removedHeaderFooters.length||(this.owner.documentHelper.headersFooters.splice(r.sectionIndex,0,r.removedHeaderFooters[0]),r.removedHeaderFooters=void 0),this.owner.editorModule.insertSection(this.owner.selection,!1,!0,void 0,void 0,r.sectionFormat);else if("string"==typeof r&&"AcceptTOC"===this.action){var s=this.selectionStart,l=this.owner.editorModule.getBlock({index:s}).node,h=this.owner.editorModule.getBlock({index:this.selectionEnd}).node,c=this.owner.documentHelper.revisionsInternal.get(r);if(this.editorHistory.isUndoing){for(;l instanceof d.g&&l!==h;)this.owner.editor.insertRevisionForBlock(l,c.revisionType,!0,c),l=this.documentHelper.selection.getNextParagraphBlock(l.getSplitWidgets().pop());this.owner.editor.insertRevisionForBlock(h,c.revisionType,!0,c)}else for(;c.range.length>0;){var u=c.range[0],g=u.revisions.indexOf(c);if(g>=0){u.revisions.splice(g,1);var f=c.range.indexOf(u);c.range.splice(f,1),this.owner.trackChangesPane.updateCurrentTrackChanges(c)}0===c.range.length&&this.owner.revisions.remove(c)}this.owner.editor.addRemovedNodes(c.revisionID)}}e=[]},e.prototype.undoRevisionForElements=function(e,t,n){var r=e.paragraph,o=t.paragraph,s=this.documentHelper.revisionsInternal.get(n),a=this.owner.selection.getParagraphInfo(e).offset,l=this.owner.selection.getParagraphInfo(t).offset,h=e.paragraph===t.paragraph,c=!1;if(this.editorHistory.isUndoing){for(;r!==o;)c=!1,this.owner.editor.applyRevisionForCurrentPara(r,a,r.getLength(),n,!0),r=this.documentHelper.selection.getNextParagraphBlock(r),!i.i(p.isNullOrUndefined)(r)&&!i.i(p.isNullOrUndefined)(r.previousRenderedWidget)&&r.previousRenderedWidget instanceof d.g&&r.previousRenderedWidget.nextSplitWidget&&r===o&&(c=!0),r!==o&&(a=0);r===o&&(h||(a=0),c&&(a=r.previousRenderedWidget.getLength()),this.owner.editor.applyRevisionForCurrentPara(r,a,l,n,!1))}else for(;s.range.length>0;){var u=s.range[0],g=u.revisions.indexOf(s);if(g>=0){u.revisions.splice(g,1);var f=s.range.indexOf(u);s.range.splice(f,1),this.owner.trackChangesPane.updateCurrentTrackChanges(s)}if(0===s.range.length&&this.owner.revisions.remove(s),r.characterFormat.revisions.length>0&&this.editorHistory.isRedoing)for(var m=0;m<r.characterFormat.revisions.length;m++){var v=r.characterFormat.revisions[m];0===v.range.length&&(r.characterFormat.revisions.splice(m,1),m--)}}this.removedNodes.push(n)},e.prototype.revertResizing=function(){if(this.editorHistory.currentBaseHistoryInfo=this,"RowResizing"===this.action){if(this.modifiedProperties[0]instanceof l.a){var e=this.modifiedProperties[0],t=e.tableHierarchicalIndex,i=this.owner.editorModule.getBlock({index:t}).node;i instanceof d.u&&this.modifiedProperties[0].revertChanges(this.editorHistory.isRedoing,this.owner,i)}}else if(this.modifiedProperties[0]instanceof l.b){0===this.owner.selection.selectedWidgets.length&&this.owner.selection.highlightSelection(!0);var n=this.modifiedProperties[0],t=n.tableHierarchicalIndex,i=this.owner.editorModule.getBlock({index:t}).node;if(i instanceof d.u){var r=this.owner.editorModule.tableResize;if(this.owner.editor.setOffsetValue(this.owner.selection),i=i.combineWidget(this.owner.viewer),r.currentResizingTable=i,this.modifiedProperties.splice(0,1),this.editorHistory.isUndoing||this.editorHistory.isRedoing){var o=new l.b(i,this.owner);this.modifiedProperties.splice(0,0,o),this.owner.isLayoutEnabled=!1,r.applyProperties(r.currentResizingTable,n),r.currentResizingTable.isGridUpdated=!0,this.owner.isLayoutEnabled=!0,r.updateGridValue(r.currentResizingTable,!1),n.destroy(),n=void 0}}}},e.prototype.revertTableDialogProperties=function(e){if(this.owner.isShiftingEnabled=!1,this.editorHistory.currentBaseHistoryInfo=this,this.currentPropertyIndex=0,"CellOptions"===e){var t=this.owner.selection,i=this.modifiedProperties[0];this.owner.editorModule.updateCellMargins(t,i)}else"TableOptions"===e&&this.owner.tableOptionsDialogModule.applyTableOptionsHelper(this.modifiedProperties[0]);this.currentPropertyIndex=0,this.owner.isShiftingEnabled=!0},e.prototype.addModifiedPropertiesForSection=function(e,t,n){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var o=this.modifiedProperties,s=this.currentPropertyIndex<o.length?o[this.currentPropertyIndex]:o[o.length-1];i.i(p.isNullOrUndefined)(t)?(n=s,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat()):(n=s.getPropertyValue(t),s.copyFormat(e)),this.currentPropertyIndex++}else if(i.i(p.isNullOrUndefined)(t))this.modifiedProperties.push(e.cloneFormat());else{var a=new r.a;a.copyFormat(e),this.modifiedProperties.push(a)}return n},e.prototype.addModifiedProperties=function(e,t,n){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var r=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1],s=!1;if(e.ownerBase instanceof d.c){var a=this.modifiedNodeLength[this.currentPropertyIndex];if(e.ownerBase.length<a){s=!0,this.modifiedNodeLength[this.currentPropertyIndex]=e.ownerBase.length,this.modifiedNodeLength.splice(this.currentPropertyIndex+1,0,a-e.ownerBase.length);var l=new o.a(void 0);l.copyFormat(r),this.modifiedProperties.splice(this.currentPropertyIndex+1,0,l)}}"ClearCharacterFormat"===this.action?this.editorHistory.isUndoing?(n=r,s||(this.modifiedProperties.splice(this.currentPropertyIndex,1),this.currentPropertyIndex--)):this.modifiedProperties.push(e.cloneFormat()):(n=r,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat()),this.currentPropertyIndex++}else{if(i.i(p.isNullOrUndefined)(t))this.modifiedProperties.push(e.cloneFormat());else{var h=new o.a(void 0);h.copyFormat(e),this.modifiedProperties.push(h)}e.ownerBase instanceof d.c?this.modifiedNodeLength.push(e.ownerBase.length):this.modifiedNodeLength.push(0)}return n},e.prototype.addModifiedPropertiesForParagraphFormat=function(e,t,r){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var o=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1];if("ClearParagraphFormat"===this.action)return this.editorHistory.isUndoing?(r=o,this.modifiedProperties.splice(this.currentPropertyIndex,1),this.currentPropertyIndex--):this.modifiedProperties.push(e.cloneFormat()),this.currentPropertyIndex++,r;if(i.i(p.isNullOrUndefined)(t))return r=o,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat(),this.currentPropertyIndex++,r;if("listFormat"===t)return r=new n.a(void 0),r.copyFormat(o),o.listFormat=new s.a(o),o.listFormat.copyFormat(e.listFormat),this.currentPropertyIndex++,r;if("tabStop"===t){r=[];for(var a=0;a<o.tabs.length;a++)r.push(o.tabs[a]);var l=new n.a(void 0);return l.copyFormat(e),this.modifiedProperties[this.currentPropertyIndex]=l,this.currentPropertyIndex++,r}if("styleName"===t)return i.i(p.isNullOrUndefined)(o.baseStyle)?void(i.i(p.isNullOrUndefined)(e.baseStyle)||(o.baseStyle=new u.k,o.baseStyle.copyStyle(e.baseStyle))):(r=new u.k,r.copyStyle(o.baseStyle),this.currentPropertyIndex++,i.i(p.isNullOrUndefined)(e.baseStyle)||(o.baseStyle=new u.k,o.baseStyle.copyStyle(e.baseStyle)),r);r="borders"===t?o.borders.cloneFormat():this.action.indexOf("Border")>=0?o.borders.getBorder(t.replace("Border","")):o.getPropertyValue(t),o.copyFormat(e),this.currentPropertyIndex++}else if(i.i(p.isNullOrUndefined)(t))this.modifiedProperties.push(e.cloneFormat());else{var l=new n.a(void 0);l.copyFormat(e),this.modifiedProperties.push(l)}return r},e.prototype.addModifiedPropertiesForContinueNumbering=function(e,t){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){return t=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1],this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat(),this.currentPropertyIndex++,t}var i=new n.a;return i.copyFormat(e),this.modifiedProperties.push(i),t},e.prototype.addModifiedPropertiesForRestartNumbering=function(e,t){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){return t=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1],this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.listId:this.modifiedProperties[this.modifiedProperties.length-1]=e.listId,this.currentPropertyIndex++,t}return this.modifiedProperties.push(e.listId),t},e.prototype.addModifiedPropertiesForList=function(e){var t;if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var i=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1];t=i,i=new l.c(e,this.owner.editorModule.cloneListLevel(e)),this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=i:this.modifiedProperties[this.modifiedProperties.length-1]=i,this.currentPropertyIndex++}else this.modifiedProperties.push(new l.c(e,this.owner.editorModule.cloneListLevel(e))),t=e;return t},e.prototype.revertProperties=function(){this.editorHistory.currentBaseHistoryInfo=this,this.currentPropertyIndex=0;var e=this.getProperty();if(this.viewer.owner.editorModule.setOffsetValue(this.documentHelper.selection),"ClearCharacterFormat"===this.action||this.modifiedProperties[0]instanceof o.a){if("ListCharacterFormat"===this.action)return void this.owner.editorModule.updateListCharacterFormat(this.documentHelper.selection,e,void 0);this.owner.editorModule.updateSelectionCharacterFormatting(e,void 0,!1)}else if("ClearParagraphFormat"===this.action||this.modifiedProperties[0]instanceof n.a){if("ContinueNumbering"===this.action)return void this.owner.editorModule.revertContinueNumbering(this.owner.selection,this.modifiedProperties[0]);if("StyleName"===this.action&&this.modifiedProperties[0]instanceof n.a)return void this.owner.editorModule.updateSelectionParagraphFormatting(e,this.modifiedProperties[0].baseStyle,!1);this.owner.editor.setPreviousBlockToLayout(),this.owner.editorModule.updateSelectionParagraphFormatting(e,void 0,!1)}else if("LinkToPrevious"===this.action&&this.modifiedProperties[0]instanceof r.a){var t=parseInt(this.selectionStart.split(";")[0]);this.owner.editorModule.updateHeaderFooters(e,void 0,t,this.modifiedProperties[0].removedHeaderFooters[0])}else if(this.modifiedProperties[0]instanceof r.a)this.owner.editorModule.updateSectionFormat(e,void 0);else{if("RestartNumbering"===this.action)return void this.owner.editorModule.restartListAtInternal(this.owner.selection,this.modifiedProperties[0]);if(this.modifiedProperties[0]instanceof a.j)this.owner.selection.updateImageSize(this.modifiedProperties[0]);else if(this.modifiedProperties[0]instanceof l.c){for(var i=new h.a,s=0;s<this.modifiedProperties.length;s++){var d=this.modifiedProperties[s];i.add(s,d)}this.editorHistory.updateListChanges(i),i.destroy(),i=void 0}else this.modifiedProperties[0]instanceof u.b?this.owner.editorModule.updateTableFormat(this.owner.selection,e,void 0):this.modifiedProperties[0]instanceof u.f?(this.owner.isShiftingEnabled=!0,this.owner.editorModule.updateCellFormat(this.owner.selection,e,void 0)):this.modifiedProperties[0]instanceof u.e&&this.owner.editorModule.updateRowFormat(this.owner.selection,e,void 0)}this.currentPropertyIndex=0,"ClearCharacterFormat"!==this.action&&"ClearParagraphFormat"!==this.action||this.owner.editorModule.getOffsetValue(this.documentHelper.selection)},e.prototype.addModifiedCellOptions=function(e,t,n){var r;if(r=i.i(p.isNullOrUndefined)(e.bottomMargin)&&i.i(p.isNullOrUndefined)(e.topMargin)&&i.i(p.isNullOrUndefined)(e.rightMargin)&&i.i(p.isNullOrUndefined)(e.leftMargin)?this.copyCellOptions(n.tableFormat):this.copyCellOptions(e),this.editorHistory.isUndoing||this.editorHistory.isRedoing){return t=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1],this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=this.copyCellOptions(e):this.modifiedProperties[this.modifiedProperties.length-1]=this.copyCellOptions(e),this.currentPropertyIndex++,t}return this.modifiedProperties.push(r),t},e.prototype.copyCellOptions=function(e){var t=new u.f;return t.topMargin=e.topMargin,t.rightMargin=e.rightMargin,t.bottomMargin=e.bottomMargin,t.leftMargin=e.leftMargin,t},e.prototype.addModifiedTableOptions=function(e){var t=this.copyTableOptions(e);if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1];this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties.splice(this.currentPropertyIndex,1,t):this.modifiedProperties.splice(this.modifiedProperties.length-1,1,t),this.currentPropertyIndex++}else this.modifiedProperties.push(t)},e.prototype.copyTableOptions=function(e){var t=new u.b;return t.topMargin=e.topMargin,t.rightMargin=e.rightMargin,t.bottomMargin=e.bottomMargin,t.leftMargin=e.leftMargin,t.cellSpacing=e.cellSpacing,t},e.prototype.getProperty=function(){switch(this.action){case"Bold":return"bold";case"Italic":return"italic";case"FontColor":return"fontColor";case"FontFamily":return"fontFamily";case"FontSize":return"fontSize";case"HighlightColor":return"highlightColor";case"BaselineAlignment":return"baselineAlignment";case"Strikethrough":return"strikethrough";case"Underline":return"underline";case"AfterSpacing":return"afterSpacing";case"BeforeSpacing":return"beforeSpacing";case"LeftIndent":return"leftIndent";case"RightIndent":return"rightIndent";case"FirstLineIndent":return"firstLineIndent";case"LineSpacingType":return"lineSpacingType";case"LineSpacing":return"lineSpacing";case"TextAlignment":return"textAlignment";case"ListFormat":return"listFormat";case"PageHeight":return"pageHeight";case"PageWidth":return"pageWidth";case"DifferentOddAndEvenPages":return"differentOddAndEvenPages";case"TableAlignment":return"tableAlignment";case"TableLeftIndent":return"leftIndent";case"DefaultCellSpacing":return"cellSpacing";case"LeftMargin":case"CellLeftMargin":case"DefaultCellLeftMargin":return"leftMargin";case"RightMargin":case"CellRightMargin":case"DefaultCellRightMargin":return"rightMargin";case"TopMargin":case"CellTopMargin":case"DefaultCellTopMargin":return"topMargin";case"BottomMargin":case"CellBottomMargin":case"DefaultCellBottomMargin":return"bottomMargin";case"CellContentVerticalAlignment":return"verticalAlignment";case"RowHeight":return"height";case"RowHeightType":return"heightType";case"RowHeader":return"isHeader";case"AllowBreakAcrossPages":return"allowBreakAcrossPages";case"TablePreferredWidth":case"CellPreferredWidth":return"preferredWidth";case"TablePreferredWidthType":case"CellPreferredWidthType":return"preferredWidthType";case"Shading":return"shading";case"StyleName":return"styleName";case"ParagraphBidi":case"TableBidi":return"bidi";case"ContextualSpacing":return"contextualSpacing";case"LinkToPrevious":return"linkToPrevious";case"LeftBorder":case"TopBorder":case"RightBorder":case"BottomBorder":case"HorizontalBorder":case"VerticalBorder":case"Borders":return this.action[0].toLowerCase()+this.action.slice(1);case"TabStop":return"tabStop"}},e.prototype.getCharacterPropertyValue=function(e,t){var i;return"bold"===e?i=t.bold:"italic"===e?i=t.italic:"fontColor"===e?i=t.fontColor:"fontFamily"===e?i=t.fontFamily:"fontSize"===e?i=t.fontSize:"highlightColor"===e?i=t.highlightColor:"baselineAlignment"===e?i=t.baselineAlignment:"strikethrough"===e?i=t.strikethrough:"underline"===e&&(i=t.underline),i},e.prototype.addModifiedTableProperties=function(e,t,n){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var r=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1];if(i.i(p.isNullOrUndefined)(t))return n=r,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat(),this.currentPropertyIndex++,n;n="shading"===t?r.shading:r.getPropertyValue(t),r.copyFormat(e),this.currentPropertyIndex++}else{var o=new u.b;o.copyFormat(e),this.modifiedProperties.push(o)}return n},e.prototype.addModifiedRowProperties=function(e,t,n){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var r=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1];if(i.i(p.isNullOrUndefined)(t))return n=r,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat(),this.currentPropertyIndex++,n;n=r.getPropertyValue(t),r.copyFormat(e),this.currentPropertyIndex++}else{var o=new u.e;o.copyFormat(e),this.modifiedProperties.push(o)}return n},e.prototype.addModifiedCellProperties=function(e,t,n){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var r=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1];if(i.i(p.isNullOrUndefined)(t))return n=r,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat(),this.currentPropertyIndex++,n;n="shading"===t?r.shading:r.getPropertyValue(t),r.copyFormat(e),this.currentPropertyIndex++}else{var o=new u.f;o.copyFormat(e),this.modifiedProperties.push(o)}return n},e.prototype.destroy=function(){if(this.selectionStart=void 0,this.selectionEnd=void 0,this.insertPosition=void 0,this.endPosition=void 0,i.i(p.isNullOrUndefined)(this.modifiedNodeLength)||(this.modifiedNodeLength=[],this.modifiedNodeLength=void 0),!i.i(p.isNullOrUndefined)(this.modifiedProperties)){for(var e=0;e<this.modifiedProperties.length;e++){var t=this.modifiedProperties[e];t instanceof o.a?t.destroy():t instanceof n.a?t.destroy():t instanceof r.a?t.destroy():t instanceof l.c&&t.destroy(),this.modifiedProperties.splice(this.modifiedProperties.indexOf(t),1),e--}this.modifiedPropertiesIn=void 0}if(!i.i(p.isNullOrUndefined)(this.removedNodes)){for(var e=0;e<this.removedNodes.length;e++){var s=this.removedNodes[e];s instanceof d.g?s.destroyInternal(this.viewer):s instanceof d.c&&!(s instanceof d.B)&&s.destroy(),this.removedNodes.splice(this.removedNodes.indexOf(s),1),e--}this.removedNodesIn=void 0}if(!i.i(p.isNullOrUndefined)(this.insertedNodes)){for(var e=0;e<this.insertedNodes.length;e++){var s=this.insertedNodes[e];s instanceof d.g?s.destroyInternal(this.viewer):s instanceof d.c&&!(s instanceof d.B)&&s.destroy(),this.insertedNodes.splice(this.insertedNodes.indexOf(s),1),e--}this.insertedNodes=void 0}this.ownerIn=void 0},e.prototype.getDeleteOperationsForTrackChanges=function(){for(var e=[],t=this.removedNodes.length-1;t>=0;t--){var n=this.removedNodes[t],r=this.getDeleteOperationForTrackChanges(n);i.i(p.isNullOrUndefined)(r)||e.push(r)}return e},e.prototype.getDeleteOperationForTrackChanges=function(e){var t;if(e instanceof d.d||e instanceof d.r||e instanceof d.b||e instanceof d.e){if(0===e.removedIds.length)t=this.getFormatOperation(e);else if(e.removedIds.length>0){var n=e.removedIds[0],r=this.owner.editor.getRevision(n),o=""===this.owner.currentUser?"Guest user":this.owner.currentUser;if("Insertion"===r.revisionType&&r.author!==o)t=this.getFormatOperation(e);else if("Insertion"===r.revisionType)t=this.getDeleteOperation(this.action,void 0,this.getRemovedText(e));else if("Deletion"===r.revisionType&&r.author!==o&&(t=this.getFormatOperation(e),e.removedIds.length>0))for(var s=0;s<e.removedIds.length;s++)i.i(p.isNullOrUndefined)(t.markerData.removedIds)||(t.markerData.removedIds=[]),t.markerData.removedIds.push(e.removedIds[s])}}else e instanceof d.g&&(e.characterFormat.revisions.length>0?t=this.getDeleteOperation(this.action):e.characterFormat.removedIds.length>0?t=this.getDeleteOperation(this.action):0===e.characterFormat.revisions.length&&(t=this.getFormatOperation()),this.startIndex++);return"Enter"===this.action||e instanceof d.g||!i.i(p.isNullOrUndefined)(t)&&"Delete"===t.action||(this.startIndex+=e.length),t},e.prototype.getActionInfo=function(e){var t=this.action;i.i(p.isNullOrUndefined)(this.isAcceptOrReject)||"Reject"!==this.isAcceptOrReject||(t="Reject Change");var n=[];switch(t.toString()){case"Insert":case"Enter":case"InsertInline":case"SectionBreak":case"SectionBreakContinuous":if(this.removedNodes.length>0&&i.i(p.isNullOrUndefined)(this.dropDownIndex)&&(this.owner.enableTrackChanges?(n=this.getDeleteOperationsForTrackChanges(),"InsertInline"!==t&&(this.insertIndex=this.startIndex)):n.push(this.getDeleteOperation(t))),"Enter"===t||this.insertedText.length>0)if(this.editorHistory.isUndoing||this.editorHistory.isRedoing&&"Enter"!==t){if(this.isremovedNodes){var r=this.getDeleteContent(t);n=n.concat(r)}}else{var o=this.getInsertOperation(t);if(this.owner.enableTrackChanges&&"Enter"!==this.action){this.insertedElement instanceof d.f&&(o.markerData=this.markerData[0],this.markerData.splice(0,1),o.text=f.c.Marker_Start,o.markerData.type=this.insertedElement.footnoteType,o.markerData.revisionForFootnoteEndnoteContent=this.markerData.pop()),n.push(o);for(var s=0;s<this.splittedRevisions.length;s++)i.i(p.isNullOrUndefined)(o.markerData)&&(o.markerData={}),i.i(p.isNullOrUndefined)(o.markerData.splittedRevisions)&&(o.markerData.splittedRevisions=[]),o.markerData.splittedRevisions.push(this.splittedRevisions[s])}else n.push(o)}var a=n[n.length-1];"Insert"!==t||i.i(p.isNullOrUndefined)(a.text)||(a.length=a.text.length),i.i(p.isNullOrUndefined)(this.dropDownIndex)||(a.markerData={type:"Field",dropDownIndex:this.dropDownIndex},a.offset=this.getElementAbsolutePosition(this.fieldBegin),a.type="DropDown");break;case"InsertTable":case"InsertTableBelow":case"InsertRowAbove":case"InsertRowBelow":if(this.removedNodes.length>0&&("InsertTable"===t||"InsertTableBelow"===t)&&(n.push(this.getDeleteOperation(t)),this.editorHistory.isUndoing&&(this.endIndex=this.startIndex,n.push(this.getDeleteOperation("Delete")))),!this.editorHistory.isUndoing){this.editorHistory.isRedoing&&"InsertTable"===t&&(this.insertedNodes.reverse(),this.insertedNodes.splice(0,1));for(var l=this.buildTableRowCellOperation(t),s=0;s<l.length;s++)n.push(l[s])}if(this.editorHistory.isUndoing)if("InsertRowAbove"==t||"InsertRowBelow"==t){for(var s=0;s<this.cellOperation.length;s++)n.push(this.cellOperation[s]);n.push(this.getUndoRedoOperation(!0))}else n.push(this.getUndoRedoOperation());break;case"InsertColumnLeft":case"InsertColumnRight":if(this.editorHistory.isUndoing){for(var s=0;s<this.cellOperation.length;s++)n.push(this.cellOperation[s]);n.push(this.getUndoRedoOperation(!0))}else{n=this.buildTableRowCellOperation(t).reverse().slice()}break;case"BackSpace":case"Delete":case"Cut":case"DeleteBookmark":case"RemoveEditRange":if(this.editorHistory.isUndoing)if("DeleteBookmark"==t||"RemoveEditRange"==t){if(this.startIndex-=1,this.insertIndex=this.startIndex,this.insertedText=f.c.Marker_Start,n.push(this.getInsertOperation(t)),this.insertedText=f.c.Marker_End,n.push(this.getInsertOperation(t,!0)),"RemoveEditRange"===t){var h=n[n.length-1];h.offset-=1}this.startIndex+=1}else{var r=this.getDeleteContent(t);n=n.concat(r)}else if(this.cellOperation.length>0)n=this.cellOperation,this.cellOperation=[];else if(this.removedNodes.length>0)if(this.owner.enableTrackChanges)n=this.getDeleteOperationsForTrackChanges();else{var c=this.getDeleteOperation(t);n.push(c);for(var s=0;s<this.removedNodes.length;s++){var u=this.removedNodes[s];if(u instanceof d.o)for(var g=u.removedHeaderFooters,m=0;m<g.length;m++){var v=g[m],y=Object.keys(v).length;if(y>0){n.push(this.getDeleteOperation("DeleteHeaderFooter",void 0));break}}}if(("DeleteBookmark"===t||"RemoveEditRange"===t)&&(n.push(this.getDeleteOperation(t,!0)),"RemoveEditRange"===t)){var w=n[n.length-1];w.offset-=1}}break;case"ResolveComment":case"EditComment":for(var s=0;s<this.removedNodes.length;s++){var b=this.getUpdateOperation();n.push(this.getCommentOperation(b,t,this.removedNodes[s]))}break;case"ClearRevisions":case"TrackingPageBreak":if(this.removedNodes.length>0){var x=this.owner.editor.getRevision(this.removedNodes[0]);if("TrackingPageBreak"===t&&"string"!=typeof this.removedNodes[0]){var C=this.getDeleteOperation(t);C.markerData.isAcceptOrReject="Reject",n.push(C);break}if("Insertion"===x.revisionType){this.markerData.push(this.owner.editor.getMarkerData(void 0,void 0,x,"Accept"));var I=this.getFormatOperation();n.push(I)}else if("Deletion"===x.revisionType){this.markerData.push(this.owner.editor.getMarkerData(void 0,void 0,x,"Reject"));var F=this.getFormatOperation();n.push(F)}}break;case"Reject Change":var k=this.getDeleteOperation(t);k.markerData.isAcceptOrReject="Reject",n.push(k);break;case"Accept Change":var P=this.getDeleteOperation(t);P.markerData.isAcceptOrReject="Accept",n.push(P);break;case"Paste":if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var T=!1;if(this.removedNodes.length>0){for(var s=this.removedNodes.length-1;s>=0;s--)T=this.removedNodes[s]instanceof d.g;n.push(this.getDeleteOperation(t)),T&&(this.endIndex=this.startIndex,n.push(this.getDeleteOperation("Delete")))}this.isremovedNodes&&n.push(this.getUndoRedoOperation())}else if(this.removedNodes.length>0&&n.push(this.getDeleteOperation("Delete")),!this.editorHistory.isUndoing){var S={action:"Insert",offset:this.startIndex,length:this.getPasteContentLength(),pasteContent:JSON.stringify(this.pasteContent),type:this.type};n.push(S)}break;case"InsertHyperlink":if(this.editorHistory.isUndoing){if(n.push(this.getDeleteOperation("BackSpace")),this.isremovedNodes){var r=this.getDeleteContent(t);n=n.concat(r),this.insertedNodes=[]}}else n=this.isEditHyperlink?this.getEditHyperlinkOperation():this.getFieldOperation();break;case"UpdateFormField":this.insertedText="";var W=this.getInsertOperation("UpdateFormField");W.text=f.c.Marker_Start,W.markerData={type:"Field",checkBoxValue:this.fieldBegin.formFieldData.checked},W.offset=this.getElementAbsolutePosition(this.fieldBegin),n.push(W);break;case"DeleteRow":case"DeleteCells":case"DeleteColumn":case"DeleteTable":case"ClearCells":case"MergeCells":if(this.editorHistory.isUndoing)"DeleteTable"==t?n.push(this.getUndoRedoOperation()):(n=this.cellOperation.slice(),this.insertIndex=this.startIndex,n.push(this.getUndoRedoOperation(!0)),this.cellOperation=[]);else if(this.removedNodes.length>0){if(this.cellOperation.length>0){for(var s=0;s<this.cellOperation.length;s++)n.push(this.cellOperation[s]);"MergeCells"===t?(n.push(this.getPasteMergeOperation()),n.push(this.getFormatOperation()),this.type=void 0):n.reverse()}else this.owner.enableTrackChanges?n.push(this.getFormatOperation(void 0,t)):n.push(this.getDeleteOperation(t));this.cellOperation=[]}break;case"RemoveRowTrack":this.removedNodes.length>0&&this.removedNodes[0]instanceof d.u&&(n=this.cellOperation.slice());break;case"RowResizing":case"CellResizing":n=this.getResizingOperation(t);break;case"ImageResizing":n.push(this.getFormatOperation());break;case"Bold":case"Italic":case"Underline":case"FontSize":case"Strikethrough":case"BaselineAlignment":case"HighlightColor":case"FontColor":case"FontFamily":case"Uppercase":case"CharacterFormat":n=this.buildFormatOperation(t,!0).slice();break;case"AfterSpacing":case"BeforeSpacing":case"RightIndent":case"LeftIndent":case"FirstLineIndent":case"LineSpacing":case"LineSpacingType":case"TextAlignment":case"Borders":case"TopBorder":case"BottomBorder":case"LeftBorder":case"RightBorder":case"HorizontalBorder":case"VerticalBorder":case"ListFormat":case"ParagraphFormat":case"StyleName":case"ClearParagraphFormat":case"SpaceBeforeAuto":case"SpaceAfterAuto":case"ParagraphBidi":case"ContextualSpacing":case"ContinueNumbering":case"List":if("ContinueNumbering"===t&&(this.type=t.toString()),"Borders"===t&&this.removedNodes[this.removedNodes.length-1]instanceof d.u){this.insertedText=f.c.Cell,this.type="CellFormat",this.createCellFormat(t),n=this.getSelectedCellOperation(t,void 0,!0);break}n=this.buildFormatOperation(t,!1).slice();break;case"TableAlignment":case"DefaultCellSpacing":case"TableLeftIndent":case"DefaultCellLeftMargin":case"DefaultCellRightMargin":case"DefaultCellTopMargin":case"DefaultCellBottomMargin":case"TablePreferredWidth":case"TablePreferredWidthType":case"TableBidi":this.createTableFormat(t),this.type="TableFormat",n.push(this.getFormatOperation()),this.format=void 0;break;case"RestartNumbering":this.type=t.toString();var N=this.getFormatOperation(void 0,t);this.createListFormat(t,N),n.push(N);break;case"Shading":this.createCellFormat(t),this.type="CellFormat",n=this.getSelectedCellOperation(t,void 0,void 0,!0);break;case"TableAutoFitToContents":case"TableAutoFitToWindow":case"TableFixedColumnWidth":this.createTableFormat(t),this.type="TableFormat",this.insertedText=t.toString(),n.push(this.getFormatOperation()),this.format=void 0;break;case"SectionFormat":case"HeaderDistance":case"FooterDistance":case"DifferentFirstPage":case"DifferentOddAndEvenPages":case"PageWidth":case"PageHeight":case"LeftMargin":case"TopMargin":case"RightMargin":case"BottomMargin":case"RestartPageNumbering":case"PageStartingNumber":case"EndnoteNumberFormat":case"FootNoteNumberFormat":case"RestartIndexForEndnotes":case"RestartIndexForFootnotes":case"InitialFootNoteNumber":case"InitialEndNoteNumber":case"LineBetweenColumns":case"EqualWidth":case"BreakCode":case"LinkToPrevious":if(this.createSectionFormat(t),this.type="SectionFormat",n.push(this.getFormatOperation(void 0)),"LinkToPrevious"===t){n[n.length-1].offset=this.insertIndex}break;case"RowHeight":case"RowHeightType":case"AllowBreakAcrossPages":case"RowHeader":this.createRowFormat(t),this.type="RowFormat",n.push(this.getFormatOperation(void 0,t)),this.format=void 0;break;case"CellContentVerticalAlignment":case"CellLeftMargin":case"CellRightMargin":case"CellBottomMargin":case"CellTopMargin":case"CellPreferredWidth":case"CellPreferredWidthType":this.createCellFormat(t),this.type="CellFormat",n=this.getSelectedCellOperation(t).slice(),this.format=void 0}return this.isremovedNodes=!1,n},e.prototype.getElementAbsolutePosition=function(e){if(e){var t=e.line.getOffset(e,e.length),i=this.owner.selection.getHierarchicalIndex(e.line.paragraph,t.toString());return this.owner.selection.getAbsolutePositionFromRelativePosition(i)}},e.prototype.getFieldOperation=function(){var e=[],t=this.fieldBegin,n=!1,r=this.insertIndex;if(!i.i(p.isNullOrUndefined)(t))do{var o=void 0,s=void 0,a=void 0,l=void 0,h=void 0;if(t instanceof d.b){if(0===t.fieldType&&""!==this.getRemovedText()){e.push(this.getDeleteOperation("Delete"));var c=e[e.length-1];c.offset=r,!i.i(p.isNullOrUndefined)(c.markerData)&&this.owner.enableTrackChanges&&(c.markerData.isSkipTracking=!0)}o=0===t.fieldType?f.c.Marker_Start:1===t.fieldType?f.c.Marker_End:2===t.fieldType?f.c.Field_Separator:"",0===t.fieldType&&t.formFieldData?(h=this.formFieldType,s=this.markerData.pop(),i.i(p.isNullOrUndefined)(s)&&(s={}),s.type="Field",s.formFieldData=t.formFieldData):(s=this.markerData.pop(),i.i(p.isNullOrUndefined)(s)&&(s={}),s.type="Field"),a=t.length}else this.fieldBegin.formFieldData&&t instanceof d.e?(o=0===t.bookmarkType?f.c.Marker_Start:f.c.Marker_End,s={bookmarkName:t.name,type:"Bookmark"},a=t.length):t instanceof d.d&&(o=t.text,a=t.length,s=this.markerData.pop());if(!(t instanceof d.e)){var u={};g.a.writeCharacterFormat(u,!0,t.characterFormat,void 0,!0),l=JSON.stringify(u)}var m={action:"Insert",offset:r,type:h,text:o,length:a,markerData:s,format:l};if(e.push(m),r+=t.length,s=void 0,h=void 0,l=void 0,t instanceof d.b&&1===t.fieldType&&(n=!0,this.fieldBegin.formFieldData&&t.nextNode instanceof d.e)){var v=t.nextNode;o=0===v.bookmarkType?f.c.Marker_Start:f.c.Marker_End,s={bookmarkName:v.name,type:"Bookmark"},a=v.length;var y={action:"Insert",offset:r,text:o,length:a,markerData:s};e.push(y)}t=t.nextNode}while(!n&&!i.i(p.isNullOrUndefined)(t));return e},e.prototype.getDeleteContent=function(e){var t=[],i=this.owner.selection.getTextPosBasedOnLogicalIndex(this.collabStart),n=this.owner.selection.getTextPosBasedOnLogicalIndex(this.collabEnd),r=n.clone();return r.offset=n.offset-1,i.isAtParagraphStart&&r.isAtParagraphEnd?(t.push(this.getUndoRedoOperation()),this.insertIndex=this.startIndex+this.getPasteContentLength()-1,t.push(this.getInsertOperation("Enter"))):i.paragraph==n.paragraph?i.isAtSamePosition(n)?(this.owner.selection.isEmpty&&"BackSpace"===e&&(this.insertIndex-=1),t.push(this.getUndoRedoOperation(!1,!0))):t.push(this.getUndoRedoOperation()):(t.push(this.getUndoRedoOperation()),this.startIndex=this.endIndex=this.owner.selection.getAbsolutePositionFromRelativePosition(this.collabEnd),t.push(this.getDeleteOperation("Delete"))),t},e.prototype.getEditHyperlinkOperation=function(){var e=[],t=this.fieldBegin;if(t){var i=this.getElementAbsolutePosition(t);e.push(this.getDeleteOperation("Delete"));var n=e[e.length-1];n.offset=i;var r=this.getRemovedFieldCode();n.length=r.length,n.text=r,e.push(this.getInsertOperation("InsertHyperlink")),n=e[e.length-1],n.offset=i,r=this.owner.selection.getFieldCode(t,!0),n.text=r,n.length=r.length}return e},e.prototype.getPasteContentLength=function(){for(var e=0,t=0;t<this.insertedNodes.length;t++){var i=this.insertedNodes[t];i instanceof d.d?e+=i.length:e+=this.owner.selection.getBlockLength(void 0,i,0,{done:!1},!0,void 0,void 0)}return this.insertedNodes=[],e},e.prototype.getUpdateOperation=function(){return{action:"Update"}},e.prototype.getResizingOperation=function(e){var t=[],n=this.owner.editor.tableResize,r=n.currentResizingTable;if(!i.i(p.isNullOrUndefined)(r.childWidgets)){r=r.combineWidget(this.owner.viewer);var o=n.resizerPosition,s={paragraph:null,offset:0};if("RowResizing"==e){var a=r.childWidgets[o];this.startIndex=this.owner.selection.getPositionInfoForHeaderFooter(s,{position:0,done:!1},a).position;for(var l=0,d=0;d<a.childWidgets.length;d++)l+=this.owner.selection.calculateCellLength(a.childWidgets[d])+1;this.endIndex=this.startIndex,this.endIndex+=l;var h={};i.i(p.isNullOrUndefined)(this.owner.sfdtExportModule)||this.owner.sfdtExportModule.assignRowFormat(h,a.rowFormat,0),this.format=JSON.stringify(h),this.insertedText=f.c.Row,t.push(this.getFormatOperation())}else{var c=o,u=o-1;if(this.insertedText=f.c.Cell,this.owner.selection.isEmpty)for(var a=r.firstChild;a;){for(var g=a.firstChild;g;){if(g.index==c||g.index==u){var m={};i.i(p.isNullOrUndefined)(this.owner.sfdtExportModule)||(m=this.owner.sfdtExportModule.writeCellFormat(g.cellFormat,0)),this.startIndex=this.owner.selection.getPositionInfoForHeaderFooter(s,{position:0,done:!1},g).position,this.type="CellFormat",this.format=JSON.stringify(m),t.push(this.getFormatOperation())}g=g.nextWidget}var h={};i.i(p.isNullOrUndefined)(this.owner.sfdtExportModule)||this.owner.sfdtExportModule.assignRowFormat(h,a.rowFormat,0),this.format=JSON.stringify(h),this.type="RowFormat",this.startIndex=this.owner.selection.getPositionInfoForHeaderFooter(s,{position:0,done:!1},a).position,t.push(this.getFormatOperation()),a=a.getSplitWidgets().pop().nextRenderedWidget}else for(var v=this.owner.selection.getSelectedCells(),y=v[0],w=v[v.length-1],b=r.childWidgets.indexOf(y.ownerRow),x=r.childWidgets.indexOf(w.ownerRow),a=r.childWidgets[b];a&&a.index<=x;){for(var g=a.firstChild;g;){if(g.index==c||g.index==u){var m={};i.i(p.isNullOrUndefined)(this.owner.sfdtExportModule)||(m=this.owner.sfdtExportModule.writeCellFormat(g.cellFormat,0)),this.startIndex=this.owner.selection.getPositionInfoForHeaderFooter(s,{position:0,done:!1},g).position,this.type="CellFormat",this.format=JSON.stringify(m),t.push(this.getFormatOperation())}g=g.nextWidget}var h={};i.i(p.isNullOrUndefined)(this.owner.sfdtExportModule)||this.owner.sfdtExportModule.assignRowFormat(h,a.rowFormat,0),this.format=JSON.stringify(h),this.type="RowFormat",this.startIndex=this.owner.selection.getPositionInfoForHeaderFooter(s,{position:0,done:!1},a).position,t.push(this.getFormatOperation()),a=a.getSplitWidgets().pop().nextRenderedWidget}var C={};C=this.owner.sfdtExportModule?this.owner.sfdtExportModule.writeTableFormat(r.tableFormat,0):{},this.format=JSON.stringify(C),this.type="TableFormat",this.startIndex=this.owner.selection.getPositionInfoForHeaderFooter(s,{position:0,done:!1},r).position,t.push(this.getFormatOperation())}this.owner.documentHelper.layout.reLayoutTable(r)}return this.format=void 0,t},e.prototype.getDeleteOperation=function(e,t,n){var r;if(this.startIndex>this.endIndex&&(r=[this.endIndex,this.startIndex],this.startIndex=r[0],this.endIndex=r[1]),"Delete"===e&&this.endIndex<this.startIndex){var o=this.startIndex;this.startIndex=this.endIndex,this.endIndex=o}this.endIndex===this.startIndex&&"DeleteBookmark"!==e&&"RemoveEditRange"!==e&&"InsertHyperlink"!==this.action&&("BackSpace"===e?this.startIndex--:this.endIndex++),"DeleteHeaderFooter"===e&&(this.startIndex=this.headerFooterStart,this.endIndex=this.headerFooterEnd);var s,a=i.i(p.isNullOrUndefined)(n)?this.endIndex-this.startIndex:n.length;"DeleteBookmark"===e||"RemoveEditRange"===e?(s=this.insertedText,a=1):"DeleteHeaderFooter"===e||("DeleteTable"===e||"DeleteRow"===e||"DeleteColumn"===e||"MergeCells"===e||"RemoveRowTrack"===e?(s=this.insertedText,"DeleteTable"!==e&&"DeleteRow"!==e&&(a=this.tableRelatedLength)):s=i.i(p.isNullOrUndefined)(n)?this.getRemovedText():n),"Cut"===e&&" "===s[s.length-1]&&a<s.length&&(a=s.length);var l={action:"Delete",offset:t?this.endIndex:this.startIndex,text:s,length:"Paste"===e||0===a?s.length:a,skipOperation:"DeleteHeaderFooter"===e||void 0,markerData:this.markerData[0]};if(this.removedNodes[0]instanceof d.f){var h=this.removedNodes[0],c=h.bodyWidget.lastChild,u={position:0,done:!1},g={paragraph:c,offset:this.owner.selection.getParagraphLength(c)+1};this.owner.selection.getPositionInfoForBodyContent(g,u,h.bodyWidget.firstChild),l.length+=u.position}return l},e.prototype.getInsertOperation=function(e,t){var n,r="Enter"===e?"\n":this.insertedText;"InsertTable"===e||"InsertTableBelow"===e||"InsertRowAbove"===e||"InsertRowBelow"===e||"InsertColumnLeft"===e||"InsertColumnRight"===e||"MergeCells"===e||"RemoveRowTrack"===e?(n=this.tableRelatedLength,"InsertTable"!==this.action&&"InsertTableBelow"!==this.action||(this.insertIndex=this.startIndex)):i.i(p.isNullOrUndefined)(r)||(n=r.length);var o={action:"Insert",offset:t?this.endIndex:this.insertIndex,text:r,type:this.type,length:n,skipOperation:!1,imageData:this.insertedData,format:this.format};if(i.i(p.isNullOrUndefined)(this.markerData)||(o.markerData=this.markerData.pop()),this.insertedElement instanceof d.f){var s=this.insertedElement.bodyWidget.lastChild,a={position:0,done:!1},l={paragraph:s,offset:this.owner.selection.getParagraphLength(s)+1};this.owner.selection.getPositionInfoForBodyContent(l,a,this.insertedElement.bodyWidget.firstChild),o.length+=a.position}return o},e.prototype.getUndoRedoOperation=function(e,t){var i,n,r,o,s,a;if(e)i=this.owner.selection.start.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer),n=this.documentHelper.getLastParagraphBlock(i),r=this.documentHelper.getFirstParagraphBlock(i).firstChild,o=n.lastChild,s=n.lastChild.getEndOffset(),a=0;else{var l=this.owner.selection.getTextPosBasedOnLogicalIndex(this.collabStart),d=this.owner.selection.getTextPosBasedOnLogicalIndex(this.collabEnd);r=l.currentWidget,o=d.currentWidget,s=t?d.offset+1:d.offset,a=l.offset}return this.pasteContent=this.owner.sfdtExportModule.write(this.owner.documentEditorSettings.optimizeSfdt?1:0,r,a,o,s,!1,!0),this.getPasteOpertion(this.pasteContent,this.getPasteContentLength())},e.prototype.getPasteOpertion=function(e,t){return{action:"Insert",offset:this.startIndex,length:t,pasteContent:JSON.stringify(e),type:"Paste"}},e.prototype.buildTableRowCellOperation=function(e){var t=[];if(this.insertedNodes.length>0){if(this.insertedNodes[0]instanceof d.z){var n=this.insertedNodes[0],r={paragraph:null,offset:0};this.insertIndex=this.owner.selection.getPositionInfoForHeaderFooter(r,{position:0,done:!1},this.insertedNodes[0]).position;var o=this.insertedNodes.length;n.ownerTable.childWidgets.length===n.indexInOwner+o&&(this.insertIndex-=1)}for(var s=0;s<this.insertedNodes.length;s++)if(this.insertedNodes[s]instanceof d.g&&"InsertTable"===e){var a=this.getInsertOperation("Enter");i.i(p.isNullOrUndefined)(a.markerData)&&(a.markerData={}),a.markerData.isSkipTracking=!0,t.push(a)}else if(this.insertedNodes[s]instanceof d.u){var l=this.insertedNodes[s].combineWidget(this.owner.viewer);this.tableRelatedLength="InsertTableBelow"===e?0:1,this.insertedText=f.c.Table;var h=this.owner.sfdtExportModule?this.owner.sfdtExportModule.writeTableFormat(l.tableFormat,0):{};this.format=JSON.stringify(h),t.push(this.getInsertOperation(e));for(var c=0;c<l.childWidgets.length;c++){var n=l.childWidgets[c];t.push(this.buildRowOperation(n,e));for(var u=0;u<n.childWidgets.length;u++)for(var g=n.childWidgets[u],m=this.buildCellOperation(g,e,!0),v=0;v<m.length;v++)t.push(m[v])}}else if(this.insertedNodes[s]instanceof d.z){var n=this.insertedNodes[s];t.push(this.buildRowOperation(n,e));for(var c=0;c<n.childWidgets.length;c++)for(var g=n.childWidgets[c],m=this.buildCellOperation(g,e,!0),v=0;v<m.length;v++)t.push(m[v])}else if(this.insertedNodes[s]instanceof d.j)for(var g=this.insertedNodes[s],y=g.ownerTable.combineWidget(this.owner.viewer),w=0,c=0;c<y.childWidgets.length;c++){s=this.insertedNodes.length;for(var n=y.childWidgets[c],u=0;u<n.childWidgets.length;u++){var b=n.childWidgets[u],r={paragraph:null,offset:0};if(-1!==this.insertedNodes.indexOf(b)){var x=this.owner.selection.getPositionInfoForHeaderFooter(r,{position:0,done:!1},b).position;this.insertIndex=x-w,b.ownerTable.childWidgets.length===b.ownerRow.indexInOwner+1&&-1!==this.insertedNodes.indexOf(n.childWidgets[n.childWidgets.length-1])&&(this.insertIndex-=1);for(var m=this.buildCellOperation(b,e,!0),v=0;v<m.length;v++)t.push(m[v]);w+=2}else{var x=this.owner.selection.getPositionInfoForHeaderFooter(r,{position:0,done:!1},b).position;this.insertIndex=x-w;for(var m=this.buildCellOperation(b,e,!1),v=0;v<m.length;v++)t.push(m[v])}}}this.insertedNodes=[]}return t},e.prototype.assignRevisionData=function(e,t,i,n){return{revisionType:e,author:t,date:i,revisionId:n}},e.prototype.createAcceptRejectOperation=function(e){var t=this.owner.selection.start;if(t.paragraph.isInsideTable){var i=t.paragraph.associatedCell.ownerRow,n=0;if(this.insertedText=f.c.Row,i.rowFormat.revisions.length>0){var r=i.rowFormat.revisions[0],o=void 0;"Accept Change"===e?o="Accept":"Reject Change"===e&&(o="Reject"),this.markerData.push(this.owner.editor.getMarkerData(void 0,void 0,r,o))}var s={paragraph:null,offset:0},a=this.owner.selection.getPositionInfoForHeaderFooter(s,{position:0,done:!1},i).position;if(i.rowFormat.revisions.length>0){if("Insertion"===i.rowFormat.revisions[0].revisionType){if("Accept Change"===e)this.startIndex=a,this.tableRelatedLength=1,this.cellOperation.push(this.getFormatOperation(void 0,"RemoveRowTrack"));else if("Reject Change"===e){this.startIndex=a;for(var l=0;l<i.childWidgets.length;l++)n+=this.owner.selection.calculateCellLength(i.childWidgets[l])+1;this.tableRelatedLength=n,this.cellOperation.push(this.getDeleteOperation("RemoveRowTrack"))}}else if("Deletion"===i.rowFormat.revisions[0].revisionType)if("Accept Change"===e){this.startIndex=a;for(var l=0;l<i.childWidgets.length;l++)n+=this.owner.selection.calculateCellLength(i.childWidgets[l])+1;this.tableRelatedLength=n,this.cellOperation.push(this.getDeleteOperation("RemoveRowTrack"))}else if("Reject Change"===e){this.startIndex=a;for(var l=0;l<i.childWidgets.length;l++)n+=this.owner.selection.calculateCellLength(i.childWidgets[l])+1;this.tableRelatedLength=n,this.cellOperation.push(this.getFormatOperation(void 0,"RemoveRowTrack"))}this.markerData=[]}}},e.prototype.beforeInsertTableRevision=function(){for(var e=this.owner.selection.start,t=e.paragraph.associatedCell.ownerTable,i=0;i<t.childWidgets.length;i++){for(var n=t.childWidgets[i],r=0,o=0;o<n.childWidgets.length;o++)r+=this.owner.selection.calculateCellLength(n.childWidgets[o])+1;this.tableRelatedLength=r+1,this.insertedText=f.c.Row;var s={paragraph:null,offset:0};if(this.startIndex=this.owner.selection.getPositionInfoForHeaderFooter(s,{position:0,done:!1},n).position,n.rowFormat.revisions.length>0){var a=n.rowFormat.revisions[0];this.markerData.push(this.owner.editor.getMarkerData(void 0,void 0,a))}this.cellOperation.push(this.getDeleteOperation("RemoveRowTrack")),this.markerData=[]}this.cellOperation.reverse()},e.prototype.afterInsertTableRrevision=function(){for(var e=this.owner.selection.start,t=e.paragraph.associatedCell.ownerTable,i=0;i<t.childWidgets.length;i++){for(var n=t.childWidgets[i],r=0,o=0;o<n.childWidgets.length;o++)r+=this.owner.selection.calculateCellLength(n.childWidgets[o])+1;this.tableRelatedLength=r+1,this.insertedText=f.c.Row;var s={paragraph:null,offset:0};if(this.insertIndex=this.owner.selection.getPositionInfoForHeaderFooter(s,{position:0,done:!1},n).position,n.rowFormat.revisions.length>0){var a=n.rowFormat.revisions[0];this.markerData.push(this.owner.editor.getMarkerData(void 0,void 0,a))}var l=this.getInsertOperation("RemoveRowTrack");l.skipOperation=!0,this.cellOperation.push(l),this.markerData=[]}},e.prototype.buildRowOperation=function(e,t){this.insertedText=f.c.Row;var n={};if(i.i(p.isNullOrUndefined)(this.owner.sfdtExportModule)||this.owner.sfdtExportModule.assignRowFormat(n,e.rowFormat,0),this.format=JSON.stringify(n),e.rowFormat.revisions.length>0){var r=e.rowFormat.revisions[e.rowFormat.revisions.length-1],o=this.markerData[this.markerData.length-1];(i.i(p.isNullOrUndefined)(o)||o.revisionId!==r.revisionID)&&this.markerData.push(this.owner.editor.getMarkerData(void 0,void 0,r))}this.tableRelatedLength=1;var s=this.getInsertOperation(t);return this.format=void 0,this.markerData=[],s},e.prototype.buildRowOperationForTrackChanges=function(e,t){var i={paragraph:null,offset:0},n=0,r=this.owner.selection.getPositionInfoForHeaderFooter(i,{position:0,done:!1},e).position;this.startIndex=r;for(var o=0;o<e.childWidgets.length;o++)n+=this.owner.selection.calculateCellLength(e.childWidgets[o])+1;this.tableRelatedLength=n,this.insertedText=f.c.Row,this.cellOperation.push(this.getFormatOperation(void 0,t))},e.prototype.buildCellOperation=function(e,t,n){var r=[];this.tableRelatedLength=n?1:0,this.insertedText=f.c.Cell,this.type="CellFormat";var o=i.i(p.isNullOrUndefined)(this.owner.sfdtExportModule)?{}:this.owner.sfdtExportModule.writeCellFormat(e.cellFormat,0);if(this.format=JSON.stringify(o),r.push(this.getInsertOperation(t)),!n)return r;var s={};this.tableRelatedLength=n?1:0,this.type="ParagraphFormat",g.a.writeParagraphFormat(s,!0,e.childWidgets[0].paragraphFormat),this.format=JSON.stringify(s),r.push(this.getInsertOperation(t));var a={};return this.tableRelatedLength=0,this.type="CharacterFormat",g.a.writeCharacterFormat(a,!0,e.childWidgets[0].characterFormat),this.format=JSON.stringify(a),r.push(this.getInsertOperation(t)),this.format=void 0,this.type=void 0,r},e.prototype.deleteColumnOperation=function(e){var t=this.owner.editor.getOwnerCell(this.owner.selection.isForward),i=this.owner.editor.getOwnerCell(!this.owner.selection.isForward),n=t.ownerTable.combineWidget(this.owner.viewer),r=[],o=0,s=0;if("DeleteColumn"===e)r=n.getColumnCellsForSelection(t,i);else{var a=this.owner.selection.getCellLeft(t.ownerRow,t),l=a+t.cellFormat.cellWidth,d=this.owner.selection.getCellLeft(i.ownerRow,i),h=d+i.cellFormat.cellWidth,c=this.owner.editor.updateSelectedCellsInTable(a,l,d,h);a=c.start,l=c.end,s=n.childWidgets.indexOf(i.ownerRow),o=n.childWidgets.indexOf(t.ownerRow);for(var p=o;p<=s;p++)for(var u=n.childWidgets[p],f=0;f<u.childWidgets.length;f++){var m=u.childWidgets[f],v=this.owner.selection.getCellLeft(u,m);g.a.round(a,2)<=g.a.round(v,2)&&g.a.round(v,2)<g.a.round(l,2)&&r.push(m)}}for(var y=this.owner.selection.isRowSelect()&&o!=s,p=0;p<r.length;p++)if("ClearCells"===e)this.deleteCell(e,r[p],!1);else if("MergeCells"===e){if(0!==p){var w=y&&!r[0].ownerRow.equals(r[p].ownerRow)&&0==r[p].index;this.deleteCell(e,r[p],w)}}else this.deleteCell("DeleteColumn",r[p],!1);"MergeCells"===e&&(this.cellOperation.reverse(),this.deleteCell("ClearCells",r[0],!1))},e.prototype.getPasteMergeOperation=function(){var e=this.owner.selection.start.paragraph.associatedCell,t={paragraph:null,offset:0},i=this.owner.selection.getPositionInfoForHeaderFooter(t,{position:0,done:!1},e).position,n=this.owner.selection.calculateCellLength(e)-1,r=this.owner.selection.getFirstParagraph(e),o=this.owner.selection.getLastParagraph(e),s=r.firstChild,a=o.lastChild;this.pasteContent=this.owner.sfdtExportModule.write(this.owner.documentEditorSettings.optimizeSfdt?1:0,s,0,a,a.getEndOffset(),!1,!0),this.startIndex=i+1;var l={action:"Insert",offset:this.startIndex,length:n,pasteContent:JSON.stringify(this.pasteContent),type:"Paste"};return this.insertedText=f.c.Cell,this.type="CellFormat",this.startIndex=i,this.endIndex=i,this.format=JSON.stringify(this.owner.sfdtExportModule.writeCellFormat(e.cellFormat,0)),l},e.prototype.deleteCell=function(e,t,i){this.tableRelatedLength=this.owner.selection.calculateCellLength(t)+1;var n={paragraph:null,offset:0};if(this.startIndex=this.owner.selection.getPositionInfoForHeaderFooter(n,{position:0,done:!1},t).position,this.startIndex-=i?1:0,this.tableRelatedLength+=i?1:0,!this.owner.enableTrackChanges)if("ClearCells"===e){var r=t.childWidgets[0];if(1===t.childWidgets.length&&r instanceof d.g&&r.isEmpty())return;this.endIndex=this.startIndex+this.tableRelatedLength-1,this.startIndex+=1,this.cellOperation.push(this.getDeleteOperation("ClearCells"))}else this.cellOperation.push(this.getDeleteOperation("DeleteColumn"))},e.prototype.getFormatOperation=function(e,t){var n;this.startIndex>this.endIndex&&(n=[this.endIndex,this.startIndex],this.startIndex=n[0],this.endIndex=n[1]);var r=0;this.endIndex===this.startIndex&&"DeleteBookmark"!==this.action&&"RemoveEditRange"!==this.action&&"InsertHyperlink"!==this.action&&("BackSpace"===this.action?this.startIndex--:this.endIndex++),r="RemoveRowTrack"===t?this.tableRelatedLength:"RowResizing"===t||"CellResizing"===t||"ImageResizing"===t?this.insertedText.length:i.i(p.isNullOrUndefined)(e)?this.endIndex-this.startIndex:e.length;var o={action:"Format",offset:this.startIndex,length:r,markerData:this.markerData[this.markerData.length-1],imageData:this.insertedData,text:this.insertedText,format:this.format};return this.markerData.pop(),i.i(p.isNullOrUndefined)(t)?o.type=this.type:o.type=t.toString(),o},e.prototype.getRemovedText=function(e){var t="";if(i.i(p.isNullOrUndefined)(e))for(var n=this.removedNodes.length-1;n>=0;n--){var r=this.removedNodes[n];r instanceof d.g?t+=this.getParagraphText(r):r instanceof d.c?r instanceof d.d?t+=r.text:t+=d.c.objectCharacter:r instanceof d.u?t+=this.getTableText(r):r instanceof d.z&&(t+=this.getRowText(r))}else{var r=e;r instanceof d.g?t+=this.getParagraphText(r):r instanceof d.c?r instanceof d.d?t+=r.text:t+=d.c.objectCharacter:r instanceof d.u?t+=this.getTableText(r):r instanceof d.z&&(t+=this.getRowText(r))}return t},e.prototype.getRemovedFieldCode=function(){for(var e="",t=!1,i=this.removedNodes.length-1;i>=0;i--){var n=this.removedNodes[i];if(n instanceof d.c){if(n instanceof d.b&&0===n.fieldType&&(t=!0),n&&n instanceof d.d&&t&&(e+=n.text),n instanceof d.b&&(2===n.fieldType||1===n.fieldType))return e}else if(n instanceof d.g)for(var r=0;r<n.childWidgets.length;r++)for(var o=n.childWidgets[r],s=0;s<o.children.length;s++){var a=o.children[s];if(a instanceof d.b&&0===a.fieldType&&(t=!0),a instanceof d.d&&t&&(e+=a.text),a instanceof d.b&&(2===a.fieldType||1===a.fieldType))return e}}},e.prototype.getParagraphText=function(e){var t="";if(!i.i(p.isNullOrUndefined)(e)&&!i.i(p.isNullOrUndefined)(e.childWidgets)){for(var n=0;n<e.childWidgets.length;n++)for(var r=e.childWidgets[n],o=0;o<r.children.length;o++)r.children[o]instanceof d.d?t+=r.children[o].text:t+=d.c.objectCharacter;return t+"\n"}return t},e.prototype.getTableText=function(e){for(var t="",i=0;i<e.childWidgets.length;i++){var n=e.childWidgets[i];t+=this.getRowText(n)}return t},e.prototype.getRowText=function(e){for(var t="",i=0;i<e.childWidgets.length;i++)for(var n=e.childWidgets[i],r=0;r<n.childWidgets.length;r++){var o=n.childWidgets[r];o instanceof d.g?t+=this.getParagraphText(o):t+=this.getTableText(o)}return t},e.prototype.getCommentOperation=function(e,t,n){if("InsertInline"===t||"RemoveInline"===t){var r="RemoveInline"===t?this.removedNodes[0]:this.insertedElement,o=r.comment;e.text=0===r.commentType?f.c.Marker_Start:f.c.Marker_End,e.markerData={type:"Comment",commentId:r.commentId,ownerCommentId:o.isReply?o.ownerComment.commentId:void 0}}else"InsertCommentWidget"===t||"DeleteCommentWidget"===t?(i.i(p.isNullOrUndefined)(n)&&(n=this.removedNodes[0]),e.length=void 0,e.action="Update",e.offset=void 0,e.text=f.c.Marker_Start+f.c.Marker_End,e.markerData={type:"Comment",commentId:n.commentId,author:n.author,date:n.date,commentIndex:n.isReply?n.ownerComment.replyComments.indexOf(n):this.owner.documentHelper.comments.indexOf(n),initial:n.initial,done:n.isResolved,text:n.text,isReply:n.isReply},i.i(p.isNullOrUndefined)(n.ownerComment)||(e.markerData.ownerCommentId=n.ownerComment.commentId),"DeleteCommentWidget"===t?e.markerData.commentAction="remove":"InsertCommentWidget"===t&&(e.markerData.commentAction="add")):"ResolveComment"===t?(e.text=f.c.Marker_Start+f.c.Marker_End,e.markerData={type:"Comment",commentId:n.commentId,done:n.isResolved}):"EditComment"===t&&(e.text=f.c.Marker_Start+f.c.Marker_End,e.markerData={type:"Comment",commentId:n.commentId,text:n.text,isReply:n.isReply,ownerCommentId:n.isReply?n.ownerComment.commentId:void 0});return e},e.prototype.getDeleteCommentOperation=function(e,t){for(var i=0;i<e.length;i++){var n=e[i];if(n instanceof a.k&&"DeleteComment"===n.action)this.getDeleteCommentOperation(n.modifiedActions,t);else{var r=n.getDeleteOperation(n.action);t.push(n.getCommentOperation(r,n.action))}}},e.prototype.buildFormatOperation=function(e,t){var i=[];return("ApplyStyle"===e||"StyleName"===e)&&this.insertedFormat instanceof u.k?(this.insertedFormat=this.insertedFormat.name,this.type="ParagraphFormat",this.createParagraphFormat(e)):("ApplyStyle"!==e&&"StyleName"!==e||(this.insertedFormat=this.insertedFormat.name),t?(this.type="CharacterFormat",this.createCharacterFormat(e)):(this.type="ParagraphFormat",this.createParagraphFormat(e))),i=this.getSelectedCellOperation(e,t),this.format=void 0,i},e.prototype.getSelectedCellOperation=function(e,t,i,n){var r=[],o=this.owner.selection.start,s=this.owner.selection.end;if(o.paragraph.isInsideTable&&s.paragraph.isInsideTable&&o.paragraph.associatedCell.ownerTable.equals(s.paragraph.associatedCell.ownerTable)&&this.owner.selection.isCellSelected(o.paragraph.associatedCell,o,s))for(var a=this.owner.selection.getSelectedCells(),l=0;l<a.length;l++){var d=a[l],h={paragraph:null,offset:0};this.startIndex=this.owner.selection.getPositionInfoForHeaderFooter(h,{position:0,done:!1},d).position+1;var c=this.owner.selection.calculateCellLength(d)-1;if(this.endIndex=this.startIndex+c,0!==c||!t){var p={};i&&(p.borders=g.a.writeBorders(d.cellFormat.borders,0),this.format=JSON.stringify(p)),n&&(p.shading=this.owner.sfdtExportModule?this.owner.sfdtExportModule.writeShading(d.cellFormat.shading,0):{},this.format=JSON.stringify(p));var u=void 0;"ListFormat"===e?(u=this.getFormatOperation(void 0,e),this.createListFormat(e,u)):u=this.getFormatOperation(),r.push(u)}}else{var f=void 0;"ListFormat"===e?(f=this.getFormatOperation(void 0,e),this.createListFormat(e,f)):f=this.getFormatOperation(),r.push(f)}return r},e.prototype.createListFormat=function(e,t){var n,r;if("ListFormat"===e?(n=this.insertedFormat.listId,t.text=e.toString().charAt(0).toLowerCase()+e.toString().slice(1)):(n=this.insertedFormat.listId,r=this.insertedFormat.nsid),n>-1){var o=this.owner.documentHelper.getListById(n),s={};s.optimizeSfdt=this.owner.documentEditorSettings.optimizeSfdt,i.i(p.isNullOrUndefined)(this.owner.sfdtExportModule)||(this.owner.sfdtExportModule.keywordIndex=this.owner.documentEditorSettings.optimizeSfdt?1:0,s[c._6[this.owner.sfdtExportModule.keywordIndex]]=[],s[c._6[this.owner.sfdtExportModule.keywordIndex]].push(this.owner.sfdtExportModule.writeList(o)),s[c._7[this.owner.sfdtExportModule.keywordIndex]]=[],i.i(p.isNullOrUndefined)(o)||s[c._7[this.owner.sfdtExportModule.keywordIndex]].push(this.owner.sfdtExportModule.writeAbstractList(o.abstractList)),"RestartNumbering"==e&&(s[c._65[this.owner.sfdtExportModule.keywordIndex]]=n,s[c._330]=r)),t.listData=JSON.stringify(s)}},e.prototype.createCharacterFormat=function(e){var t={};if("Uppercase"===e)t.allCaps=!0;else if("ApplyStyle"===e||"StyleName"===e)t.styleName=this.insertedFormat;else if("CharacterFormat"===e){var i=this.insertedFormat;t.bold=i.hasValue("bold")?i.bold:t.bold,t.italic=i.hasValue("italic")?i.italic:t.italic,t.fontSize=i.hasValue("fontSize")?i.fontSize:t.fontSize,t.underline=i.hasValue("underline")?i.underline:t.underline,t.strikethrough=i.hasValue("strikethrough")?i.strikethrough:t.strikethrough,t.baselineAlignment=i.hasValue("baselineAlignment")?i.baselineAlignment:t.baselineAlignment,t.highlightColor=i.hasValue("highlightColor")?i.highlightColor:t.highlightColor,t.fontColor=i.hasValue("fontColor")?i.fontColor:t.fontColor,t.fontFamily=i.hasValue("fontFamily")?i.fontFamily:t.fontFamily,t.allCaps=i.hasValue("allCaps")?i.allCaps:t.allCaps}else"increment"===this.insertedFormat||"decrement"===this.insertedFormat?(this.type=this.insertedFormat,t.fontSize=0):"ClearFormat"!==e&&(t[e.toString().charAt(0).toLowerCase()+e.toString().slice(1)]=this.insertedFormat);this.format=JSON.stringify(t)},e.prototype.createParagraphFormat=function(e){var t={};if("ParagraphFormat"===e||"ContinueNumbering"===e){var i=this.insertedFormat;if(t.afterSpacing=i.hasValue("afterSpacing")?i.afterSpacing:void 0,t.beforeSpacing=i.hasValue("beforeSpacing")?i.beforeSpacing:void 0,t.spaceAfterAuto=i.hasValue("spaceAfterAuto")?i.spaceAfterAuto:t.spaceAfterAuto,t.spaceBeforeAuto=i.hasValue("spaceBeforeAuto")?i.spaceBeforeAuto:t.spaceBeforeAuto,t.rightIndent=i.hasValue("rightIndent")?i.rightIndent:t.rightIndent,t.leftIndent=i.hasValue("leftIndent")?i.leftIndent:t.leftIndent,t.firstLineIndent=i.hasValue("firstLineIndent")?i.firstLineIndent:t.firstLineIndent,t.lineSpacing=i.hasValue("lineSpacing")?i.lineSpacing:t.lineSpacing,t.lineSpacingType=i.hasValue("lineSpacingType")?i.lineSpacingType:t.lineSpacingType,t.textAlignment=i.hasValue("textAlignment")?i.textAlignment:t.textAlignment,t.outlineLevel=i.hasValue("outlineLevel")?i.outlineLevel:t.outlineLevel,t.borders=i.hasValue("borders")?i.borders:t.borders,-1!==i.listFormat.listId){var r={};r.listId=i.listFormat.listId,r.listLevelNumber=i.listFormat.listLevelNumber,r.nsid=i.listFormat.nsid,t.listFormat=r}t.styleName=i.hasValue("styleName")?t.styleName.name:void 0,t.contextualSpacing=i.hasValue("contextualSpacing")?i.contextualSpacing:t.contextualSpacing,t.keepWithNext=i.hasValue("keepWithNext")?i.keepWithNext:t.keepWithNext,t.keepLinesTogether=i.hasValue("keepLinesTogether")?i.keepLinesTogether:t.keepLinesTogether,t.widowControl=i.hasValue("contextualSpacing")?i.widowControl:t.widowControl}else if("ListFormat"===e){var r={};r.listId=this.insertedFormat.listId,r.nsid=this.insertedFormat.nsid,r.listLevelNumber=this.insertedFormat.listLevelNumber,t.listFormat=r}else if("ApplyStyle"===e||"StyleName"===e)t.styleName=this.insertedFormat;else if("ParagraphBidi"===e)t.bidi=this.insertedFormat;else if("Borders"===e)t.borders=g.a.writeBorders(this.insertedFormat,0);else if(this.insertedFormat instanceof n.a){var i=this.owner.sfdtExportModule.writeParagraphFormat(this.insertedFormat);t[e.toString().charAt(0).toLowerCase()+e.toString().slice(1)]=i}else"List"===e?t=this.insertedFormat:t[e.toString().charAt(0).toLowerCase()+e.toString().slice(1)]=this.insertedFormat;this.format=JSON.stringify(t)},e.prototype.createTableFormat=function(e){var t={paragraph:null,offset:0};this.startIndex=this.owner.selection.getPositionInfoForHeaderFooter(t,{position:0,done:!1},this.owner.selection.start.paragraph.associatedCell.ownerTable).position,this.endIndex=this.startIndex,this.endIndex+=this.owner.selection.getBlockLength(void 0,this.owner.selection.start.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer),0,{done:!1},!0,void 0,void 0)-1;var n={};if("TableFormat"===e){var r=this.insertedFormat;i.i(p.isNullOrUndefined)(r)||(n.bidi=r.hasValue("bidi")?r.bidi:void 0,n.preferredWidth=r.hasValue("preferredWidth")?r.preferredWidth:void 0,n.preferredWidthType=r.hasValue("preferredWidthType")?r.preferredWidthType:void 0,n.tableAlignment=r.hasValue("tableAlignment")?r.tableAlignment:void 0,n.leftIndent=r.hasValue("leftIndent")?r.leftIndent:void 0)}else if("TableOptions"===e){var o=this.owner.selection.start.paragraph.associatedCell.ownerTable.tableFormat;i.i(p.isNullOrUndefined)(o)||(n.cellSpacing=o.hasValue("cellSpacing")?o.cellSpacing:void 0,n.leftMargin=o.hasValue("leftMargin")?o.leftMargin:void 0,n.topMargin=o.hasValue("topMargin")?o.topMargin:void 0,n.rightMargin=o.hasValue("rightMargin")?o.rightMargin:void 0,n.bottomMargin=o.hasValue("bottomMargin")?o.bottomMargin:void 0)}else if("BordersAndShading"===e){var s=this.insertedFormat;n=i.i(p.isNullOrUndefined)(this.owner.sfdtExportModule)?{}:this.owner.sfdtExportModule.writeTableFormat(s,0)}else n[this.getTableFormatString(e)]=this.insertedFormat;this.format=JSON.stringify(n)},e.prototype.createRowFormat=function(e){var t={};if("RowFormat"===e){var n=this.insertedFormat;i.i(p.isNullOrUndefined)(n)||(t.height=n.hasValue("height")?n.height:void 0,t.heightType=n.hasValue("heightType")?n.heightType:void 0,t.isHeader=n.hasValue("isHeader")?n.isHeader:void 0,t.allowBreakAcrossPages=n.hasValue("allowBreakAcrossPages")?n.allowBreakAcrossPages:void 0)}else t[this.getRowString(e)]=this.insertedFormat;this.format=JSON.stringify(t)},e.prototype.createCellFormat=function(e){var t={};if("CellFormat"===e){var n=this.insertedFormat;t.preferredWidth=n.hasValue("preferredWidth")?n.preferredWidth:void 0,t.preferredWidthType=n.hasValue("preferredWidthType")?n.preferredWidthType:void 0,t.verticalAlignment=n.hasValue("verticalAlignment")?n.verticalAlignment:void 0}else if("CellOptions"===e){var r=this.insertedFormat;t.leftMargin=r.leftMargin,t.rightMargin=r.rightMargin,t.bottomMargin=r.bottomMargin,t.topMargin=r.topMargin}else"Shading"===e?t[this.getCellString(e)]=i.i(p.isNullOrUndefined)(this.owner.sfdtExportModule)?{}:this.owner.sfdtExportModule.writeShading(this.insertedFormat,0):"Borders"===e?t.borders=g.a.writeBorders(this.insertedFormat,0):"BordersAndShading"===e?(t.shading=i.i(p.isNullOrUndefined)(this.owner.sfdtExportModule)?{}:this.owner.sfdtExportModule.writeShading(this.insertedFormat,0),t.borders=g.a.writeBorders(this.insertedFormat.borders,0)):t[this.getCellString(e)]=this.insertedFormat;this.format=JSON.stringify(t)},e.prototype.getTableFormatString=function(e){switch(e){case"TableAlignment":return"tableAlignment";case"TableLeftIndent":return"leftIndent";case"DefaultCellLeftMargin":return"leftMargin";case"DefaultCellRightMargin":return"rightMargin";case"DefaultCellBottomMargin":return"bottomMargin";case"DefaultCellTopMargin":return"topMargin";case"TablePreferredWidth":return"preferredWidth";case"TablePreferredWidthType":return"preferredWidthType";case"Shading":return"shading";case"TableBidi":return"bidi";default:return"cellSpacing"}},e.prototype.createSectionFormat=function(e){var t={};switch(e){case"SectionFormat":var i=this.insertedFormat;this.owner.sfdtExportModule.writeSectionFormat(i,t,0);break;case"LinkToPrevious":var n=this.owner.selection.start.paragraph.bodyWidget,r=n.sectionIndex,o=n.headerFooterType;return void(this.format=JSON.stringify({linkToPrevious:this.insertedFormat,sectionIndex:r,headerFooterType:o}));default:t[e[0].toLowerCase()+e.slice(1)]=this.insertedFormat}this.format=JSON.stringify(t)},e.prototype.getRowString=function(e){switch(e){case"RowHeight":return"height";case"RowHeightType":return"heightType";case"RowHeader":return"isHeader";default:return"allowBreakAcrossPages"}},e.prototype.getCellString=function(e){switch(e){case"CellContentVerticalAlignment":return"verticalAlignment";case"CellLeftMargin":return"leftMargin";case"CellRightMargin":return"rightMargin";case"CellBottomMargin":return"bottomMargin";case"CellTopMargin":return"topMargin";case"CellPreferredWidth":return"preferredWidth";case"Shading":return"shading";default:return"cellPreferredWidthType"}},e}()},function(e,t,i){"use strict";i.d(t,"a",function(){return d});var n=i(0),r=(i.n(n),i(6)),o=i(12),s=i(13),a=i(22),l=i(24),d=function(){function e(e){this.uniqueListFormat=void 0,this.ownerBase=void 0,this.baseStyle=void 0,this.list=void 0,this.ownerBase=e}return Object.defineProperty(e.prototype,"nsid",{get:function(){return this.getPropertyValue("nsid")},set:function(e){this.setPropertyValue("nsid",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"listId",{get:function(){return this.getPropertyValue("listId")},set:function(e){if(e>=0){if(!i.i(n.isNullOrUndefined)(this.ownerBase)){var t=this.ownerBase.getDocumentHelperObject();i.i(n.isNullOrUndefined)(t)||(this.list=t.getListById(e))}}else!i.i(n.isNullOrUndefined)(this.list)&&e<0&&(this.list=void 0);this.setPropertyValue("listId",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"listLevelNumber",{get:function(){return this.getPropertyValue("listLevelNumber")},set:function(e){this.setPropertyValue("listLevelNumber",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"listLevel",{get:function(){var e=void 0;if(i.i(n.isNullOrUndefined)(this.list))for(var t=this.baseStyle;!i.i(n.isNullOrUndefined)(t)&&t instanceof a.a;){if(t.paragraphFormat.listFormat.list){e=t.paragraphFormat.listFormat.list;break}t=t.basedOn}else e=this.list;return i.i(n.isNullOrUndefined)(e)?void 0:e.getListLevel(this.listLevelNumber)},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(t){if(this.hasValue(t)){var r=o.a.getPropertyType(e.uniqueFormatType,t);if(!i.i(n.isNullOrUndefined)(this.uniqueListFormat)&&this.uniqueListFormat.propertiesHash.containsKey(r))return this.uniqueListFormat.propertiesHash.get(r)}else if(this.baseStyle instanceof a.a){for(var s=this.baseStyle;!i.i(n.isNullOrUndefined)(s)&&!s.paragraphFormat.listFormat.hasValue(t);)s=s.basedOn;if(!i.i(n.isNullOrUndefined)(s)){var r=o.a.getPropertyType(e.uniqueFormatType,t);return s.paragraphFormat.listFormat.uniqueListFormat.propertiesHash.get(r)}}return e.getPropertyDefaultValue(t)},e.prototype.setPropertyValue=function(t,r){if((i.i(n.isNullOrUndefined)(r)||""===r)&&(r=e.getPropertyDefaultValue(t)),i.i(n.isNullOrUndefined)(this.uniqueListFormat))this.initializeUniqueListFormat(t,r);else{var s=o.a.getPropertyType(this.uniqueListFormat.uniqueFormatType,t);if(this.uniqueListFormat.propertiesHash.containsKey(s)&&this.uniqueListFormat.propertiesHash.get(s)===r)return;this.uniqueListFormat=e.uniqueListFormats.updateUniqueFormat(this.uniqueListFormat,t,r)}},e.prototype.initializeUniqueListFormat=function(t,i){var n=new r.a;this.addUniqueListFormat("listId",t,i,n),this.addUniqueListFormat("listLevelNumber",t,i,n),this.addUniqueListFormat("nsid",t,i,n),this.uniqueListFormat=e.uniqueListFormats.addUniqueFormat(n,e.uniqueFormatType)},e.prototype.addUniqueListFormat=function(t,i,n,r){var s=o.a.getPropertyType(e.uniqueFormatType,t);t===i&&r.add(s,n)},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"listId":t=-1;break;case"listLevelNumber":t=0;break;case"nsid":t=-1}return t},e.prototype.copyFormat=function(e){i.i(n.isNullOrUndefined)(e)||(i.i(n.isNullOrUndefined)(e.uniqueListFormat)||(this.listId=e.listId,this.listLevelNumber=e.listLevelNumber,this.nsid=e.nsid),i.i(n.isNullOrUndefined)(e.baseStyle)||(this.baseStyle=e.baseStyle),i.i(n.isNullOrUndefined)(e.list)||(this.list=e.list))},e.prototype.hasValue=function(e){if(!i.i(n.isNullOrUndefined)(this.uniqueListFormat)){var t=o.a.getPropertyType(this.uniqueListFormat.uniqueFormatType,e);return this.uniqueListFormat.propertiesHash.containsKey(t)}return!1},e.prototype.clearFormat=function(){i.i(n.isNullOrUndefined)(this.uniqueListFormat)||0!==this.uniqueListFormat.referenceCount||e.uniqueListFormats.remove(this.uniqueListFormat),this.uniqueListFormat=void 0,this.list=void 0},e.prototype.destroy=function(){i.i(n.isNullOrUndefined)(this.uniqueListFormat)||e.uniqueListFormats.remove(this.uniqueListFormat),this.uniqueListFormat=void 0,this.list=void 0,this.ownerBase=void 0,this.baseStyle=void 0},e.clear=function(){this.uniqueListFormats.clear()},e.prototype.applyStyle=function(e){this.baseStyle=e},e.prototype.getValue=function(e){return this.hasValue(e)?this.getPropertyValue(e):void 0},e.prototype.mergeFormat=function(e){i.i(n.isNullOrUndefined)(this.getValue("listId"))&&(this.listId=e.getValue("listId")),i.i(n.isNullOrUndefined)(this.getValue("listLevelNumber"))&&(this.listLevelNumber=e.getValue("listLevelNumber")),i.i(n.isNullOrUndefined)(this.getValue("nsid"))&&(this.nsid=e.getValue("nsid")),i.i(n.isNullOrUndefined)(e.list)||(i.i(n.isNullOrUndefined)(this.list)&&(this.list=new l.a),this.list.mergeList(e.list))},e.prototype.cloneListFormat=function(){var t=new e(void 0);return t.list=this.list,t.listId=this.listId,t.nsid=this.nsid,t.baseStyle=this.baseStyle,t.listLevelNumber=this.listLevelNumber,t.uniqueListFormat=this.uniqueListFormat,t},e.uniqueListFormats=new s.a,e.uniqueFormatType=7,e}()},function(e,t,i){"use strict";i.d(t,"a",function(){return a}),i.d(t,"b",function(){return l});var n=i(0),r=(i.n(n),i(6)),o=i(12),s=i(13),a=function(){function e(e){this.uniqueSectionFormat=void 0,this.columns=[],this.ownerBase=e,this.columns=[],this.removedHeaderFooters=[]}return Object.defineProperty(e.prototype,"headerDistance",{get:function(){return this.getPropertyValue("headerDistance")},set:function(e){this.setPropertyValue("headerDistance",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"footerDistance",{get:function(){return this.getPropertyValue("footerDistance")},set:function(e){this.setPropertyValue("footerDistance",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"differentFirstPage",{get:function(){return this.getPropertyValue("differentFirstPage")},set:function(e){this.setPropertyValue("differentFirstPage",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"differentOddAndEvenPages",{get:function(){return this.getPropertyValue("differentOddAndEvenPages")},set:function(e){this.setPropertyValue("differentOddAndEvenPages",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageHeight",{get:function(){return this.getPropertyValue("pageHeight")},set:function(e){this.setPropertyValue("pageHeight",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightMargin",{get:function(){return this.getPropertyValue("rightMargin")},set:function(e){this.setPropertyValue("rightMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageWidth",{get:function(){return this.getPropertyValue("pageWidth")},set:function(e){this.setPropertyValue("pageWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftMargin",{get:function(){return this.getPropertyValue("leftMargin")},set:function(e){this.setPropertyValue("leftMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomMargin",{get:function(){return this.getPropertyValue("bottomMargin")},set:function(e){this.setPropertyValue("bottomMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topMargin",{get:function(){return this.getPropertyValue("topMargin")},set:function(e){this.setPropertyValue("topMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bidi",{get:function(){return this.getPropertyValue("bidi")},set:function(e){this.setPropertyValue("bidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"restartPageNumbering",{get:function(){return this.getPropertyValue("restartPageNumbering")},set:function(e){this.setPropertyValue("restartPageNumbering",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageStartingNumber",{get:function(){return this.getPropertyValue("pageStartingNumber")},set:function(e){this.setPropertyValue("pageStartingNumber",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endnoteNumberFormat",{get:function(){return this.getPropertyValue("endnoteNumberFormat")},set:function(e){this.setPropertyValue("endnoteNumberFormat",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"restartIndexForEndnotes",{get:function(){return this.getPropertyValue("restartIndexForEndnotes")},set:function(e){this.setPropertyValue("restartIndexForEndnotes",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"restartIndexForFootnotes",{get:function(){return this.getPropertyValue("restartIndexForFootnotes")},set:function(e){this.setPropertyValue("restartIndexForFootnotes",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"footNoteNumberFormat",{get:function(){return this.getPropertyValue("footNoteNumberFormat")},set:function(e){this.setPropertyValue("footNoteNumberFormat",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"initialFootNoteNumber",{get:function(){return this.getPropertyValue("initialFootNoteNumber")},set:function(e){this.setPropertyValue("initialFootNoteNumber",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"initialEndNoteNumber",{get:function(){return this.getPropertyValue("initialEndNoteNumber")},set:function(e){this.setPropertyValue("initialEndNoteNumber",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageNumberStyle",{get:function(){return this.getPropertyValue("pageNumberStyle")},set:function(e){this.setPropertyValue("pageNumberStyle",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numberOfColumns",{get:function(){return this.getPropertyValue("numberOfColumns")},set:function(e){this.setPropertyValue("numberOfColumns",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"equalWidth",{get:function(){return this.getPropertyValue("equalWidth")},set:function(e){this.setPropertyValue("equalWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineBetweenColumns",{get:function(){return this.getPropertyValue("lineBetweenColumns")},set:function(e){this.setPropertyValue("lineBetweenColumns",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"breakCode",{get:function(){return this.getPropertyValue("breakCode")},set:function(e){this.setPropertyValue("breakCode",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstPageHeader",{get:function(){return this.getPropertyValue("firstPageHeader")},set:function(e){this.setPropertyValue("firstPageHeader",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstPageFooter",{get:function(){return this.getPropertyValue("firstPageFooter")},set:function(e){this.setPropertyValue("firstPageFooter",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"oddPageHeader",{get:function(){return this.getPropertyValue("oddPageHeader")},set:function(e){this.setPropertyValue("oddPageHeader",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"oddPageFooter",{get:function(){return this.getPropertyValue("oddPageFooter")},set:function(e){this.setPropertyValue("oddPageFooter",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"evenPageHeader",{get:function(){return this.getPropertyValue("evenPageHeader")},set:function(e){this.setPropertyValue("evenPageHeader",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"evenPageFooter",{get:function(){return this.getPropertyValue("evenPageFooter")},set:function(e){this.setPropertyValue("evenPageFooter",e)},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){i.i(n.isNullOrUndefined)(this.uniqueSectionFormat)||e.uniqueSectionFormats.remove(this.uniqueSectionFormat),this.uniqueSectionFormat=void 0,this.ownerBase=void 0,this.columns=void 0,this.removedHeaderFooters=void 0},e.prototype.hasValue=function(e){if(!i.i(n.isNullOrUndefined)(this.uniqueSectionFormat)){var t=o.a.getPropertyType(this.uniqueSectionFormat.uniqueFormatType,e);return this.uniqueSectionFormat.propertiesHash.containsKey(t)}return!1},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"headerDistance":case"footerDistance":t=36;break;case"differentFirstPage":case"differentOddAndEvenPages":t=!1;break;case"pageWidth":t=612;break;case"pageHeight":t=792;break;case"leftMargin":case"topMargin":case"rightMargin":case"bottomMargin":t=72;break;case"bidi":case"restartPageNumbering":t=!1;break;case"pageStartingNumber":t=1;break;case"footnotePosition":t="PrintAtBottomOfPage";break;case"endnoteNumberFormat":t="LowerCaseRoman";break;case"endnotePosition":t="DisplayEndOfDocument";break;case"restartIndexForEndnotes":case"restartIndexForFootnotes":t="DoNotRestart";break;case"footNoteNumberFormat":t="Arabic";break;case"initialFootNoteNumber":case"initialEndNoteNumber":t=1;break;case"pageNumberStyle":t="Arabic";break;case"numberOfColumns":t=1;break;case"equalWidth":t=!0;break;case"lineBetweenColumns":t=!1;break;case"breakCode":t="NewPage";break;case"firstPageHeader":case"firstPageFooter":case"oddPageHeader":case"oddPageFooter":case"evenPageHeader":case"evenPageFooter":t=void 0}return t},e.prototype.getPropertyValue=function(t){if(this.hasValue(t)){var r=o.a.getPropertyType(e.uniqueFormatType,t);if(!i.i(n.isNullOrUndefined)(this.uniqueSectionFormat)&&this.uniqueSectionFormat.propertiesHash.containsKey(r))return this.uniqueSectionFormat.propertiesHash.get(r)}return e.getPropertyDefaultValue(t)},e.prototype.setPropertyValue=function(t,r){if((i.i(n.isNullOrUndefined)(r)||""===r)&&(r=e.getPropertyDefaultValue(t)),i.i(n.isNullOrUndefined)(this.uniqueSectionFormat))this.initializeUniqueSectionFormat(t,r);else{var s=o.a.getPropertyType(this.uniqueSectionFormat.uniqueFormatType,t);if(this.uniqueSectionFormat.propertiesHash.containsKey(s)&&this.uniqueSectionFormat.propertiesHash.get(s)===r)return;this.uniqueSectionFormat=e.uniqueSectionFormats.updateUniqueFormat(this.uniqueSectionFormat,t,r)}},e.prototype.initializeUniqueSectionFormat=function(t,i){var n=new r.a;this.addUniqueSectionFormat("headerDistance",t,i,n),this.addUniqueSectionFormat("footerDistance",t,i,n),this.addUniqueSectionFormat("differentFirstPage",t,i,n),this.addUniqueSectionFormat("differentOddAndEvenPages",t,i,n),this.addUniqueSectionFormat("pageWidth",t,i,n),this.addUniqueSectionFormat("pageHeight",t,i,n),this.addUniqueSectionFormat("leftMargin",t,i,n),this.addUniqueSectionFormat("topMargin",t,i,n),this.addUniqueSectionFormat("rightMargin",t,i,n),this.addUniqueSectionFormat("bottomMargin",t,i,n),this.addUniqueSectionFormat("bidi",t,i,n),this.addUniqueSectionFormat("restartPageNumbering",t,i,n),this.addUniqueSectionFormat("pageStartingNumber",t,i,n),this.addUniqueSectionFormat("endnoteNumberFormat",t,i,n),this.addUniqueSectionFormat("endnotePosition",t,i,n),this.addUniqueSectionFormat("footNoteNumberFormat",t,i,n),this.addUniqueSectionFormat("footnotePosition",t,i,n),this.addUniqueSectionFormat("restartIndexForEndnotes",t,i,n),this.addUniqueSectionFormat("restartIndexForFootnotes",t,i,n),this.addUniqueSectionFormat("initialFootNoteNumber",t,i,n),this.addUniqueSectionFormat("initialEndNoteNumber",t,i,n),this.addUniqueSectionFormat("pageNumberStyle",t,i,n),this.addUniqueSectionFormat("numberOfColumns",t,i,n),this.addUniqueSectionFormat("equalWidth",t,i,n),this.addUniqueSectionFormat("lineBetweenColumns",t,i,n),this.addUniqueSectionFormat("breakCode",t,i,n),this.uniqueSectionFormat=e.uniqueSectionFormats.addUniqueFormat(n,e.uniqueFormatType)},e.prototype.addUniqueSectionFormat=function(t,i,n,r){var s=o.a.getPropertyType(e.uniqueFormatType,t);t===i?r.add(s,n):r.add(s,e.getPropertyDefaultValue(t))},e.prototype.copyFormat=function(e,t){t&&(t.isUndoing||t.isRedoing)?(this.uniqueSectionFormat=e.uniqueSectionFormat,this.columns=e.columns,this.removedHeaderFooters=e.removedHeaderFooters):i.i(n.isNullOrUndefined)(e)||(this.removedHeaderFooters=e.removedHeaderFooters,!i.i(n.isNullOrUndefined)(e.uniqueSectionFormat)&&e.uniqueSectionFormat.propertiesHash&&(this.updateUniqueSectionFormat(e),this.columns=e.columns))},e.prototype.updateUniqueSectionFormat=function(t){var r=void 0;this.uniqueSectionFormat&&(r=this.uniqueSectionFormat.mergeProperties(t.uniqueSectionFormat),0===this.uniqueSectionFormat.referenceCount&&(e.uniqueSectionFormats.remove(this.uniqueSectionFormat),this.uniqueSectionFormat=void 0)),this.uniqueSectionFormat=new o.a(e.uniqueFormatType),i.i(n.isNullOrUndefined)(r)&&(r=this.uniqueSectionFormat.mergeProperties(t.uniqueSectionFormat)),this.uniqueSectionFormat=e.uniqueSectionFormats.addUniqueFormat(r,e.uniqueFormatType)},e.prototype.cloneFormat=function(){var t=new e;return t.uniqueSectionFormat=this.uniqueSectionFormat,t.columns=this.columns,t},e.clear=function(){this.uniqueSectionFormats.clear()},e.uniqueSectionFormats=new s.a,e.uniqueFormatType=10,e}(),l=function(){function e(e){this.uniqueColumnFormat=void 0,this.ownerBase=e}return e.prototype.destroy=function(){i.i(n.isNullOrUndefined)(this.uniqueColumnFormat)||e.uniqueColumnFormats.remove(this.uniqueColumnFormat),this.uniqueColumnFormat=void 0,this.ownerBase=void 0},e.prototype.hasValue=function(e){if(!i.i(n.isNullOrUndefined)(this.uniqueColumnFormat)){var t=o.a.getPropertyType(this.uniqueColumnFormat.uniqueFormatType,e);return this.uniqueColumnFormat.propertiesHash.containsKey(t)}return!1},Object.defineProperty(e.prototype,"index",{get:function(){return this.indexIn},set:function(e){this.indexIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.getPropertyValue("width")},set:function(e){this.setPropertyValue("width",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"space",{get:function(){return this.getPropertyValue("space")},set:function(e){this.setPropertyValue("space",e)},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(t){if(this.hasValue(t)){var r=o.a.getPropertyType(e.uniqueFormatType,t);if(!i.i(n.isNullOrUndefined)(this.uniqueColumnFormat)&&this.uniqueColumnFormat.propertiesHash.containsKey(r))return this.uniqueColumnFormat.propertiesHash.get(r)}return e.getPropertyDefaultValue(t)},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"width":t=36;break;case"space":t=0}return t},e.prototype.setPropertyValue=function(t,r){if((i.i(n.isNullOrUndefined)(r)||""===r)&&(r=e.getPropertyDefaultValue(t)),i.i(n.isNullOrUndefined)(this.uniqueColumnFormat))this.initializeUniqueColumnFormat(t,r);else{var s=o.a.getPropertyType(this.uniqueColumnFormat.uniqueFormatType,t);if(this.uniqueColumnFormat.propertiesHash.containsKey(s)&&this.uniqueColumnFormat.propertiesHash.get(s)===r)return;this.uniqueColumnFormat=e.uniqueColumnFormats.updateUniqueFormat(this.uniqueColumnFormat,t,r)}},e.prototype.initializeUniqueColumnFormat=function(t,i){var n=new r.a;this.addUniqueColumnFormat("width",t,i,n),this.addUniqueColumnFormat("space",t,i,n),this.uniqueColumnFormat=e.uniqueColumnFormats.addUniqueFormat(n,e.uniqueFormatType)},e.prototype.addUniqueColumnFormat=function(t,i,n,r){var s=o.a.getPropertyType(e.uniqueFormatType,t);t===i?r.add(s,n):r.add(s,e.getPropertyDefaultValue(t))},e.prototype.updateUniqueColumnFormat=function(t){var r=void 0;this.uniqueColumnFormat&&(r=this.uniqueColumnFormat.mergeProperties(t.uniqueColumnFormat),0===this.uniqueColumnFormat.referenceCount&&(e.uniqueColumnFormats.remove(this.uniqueColumnFormat),this.uniqueColumnFormat=void 0)),this.uniqueColumnFormat=new o.a(e.uniqueFormatType),i.i(n.isNullOrUndefined)(r)&&(r=this.uniqueColumnFormat.mergeProperties(t.uniqueColumnFormat)),this.uniqueColumnFormat=e.uniqueColumnFormats.addUniqueFormat(r,e.uniqueFormatType)},e.prototype.cloneFormat=function(){var t=new e(void 0);return t.width=this.width,t.space=this.space,t},e.prototype.copyFormat=function(e){i.i(n.isNullOrUndefined)(e)||i.i(n.isNullOrUndefined)(e.uniqueColumnFormat)||(this.width=e.width,this.space=e.space)},e.clear=function(){this.uniqueColumnFormats.clear()},e.uniqueColumnFormats=new s.a,e.uniqueFormatType=11,e}()},function(e,t,i){"use strict";i.d(t,"c",function(){return k}),i.d(t,"d",function(){return P}),i.d(t,"b",function(){return T}),i.d(t,"a",function(){return S}),i.d(t,"e",function(){return W});var n=i(6),r=i(14),o=i(26),s=i(9),a=i(40),l=i(67),d=i(0),h=(i.n(d),i(2)),c=i(4),p=i(41),u=i(7),g=i(68),f=i(8),m=(i.n(f),i(11)),v=i(59),y=i(49),w=i(39),b=i(66),x=i(28),C=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),I=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){e.done?r(e.value):new i(function(t){t(e.value)}).then(s,a)}l((n=n.apply(e,t||[])).next())})},F=this&&this.__generator||function(e,t){function i(e){return function(t){return n([e,t])}}function n(i){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,o&&(s=2&i[0]?o.return:i[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,i[1])).done)return s;switch(o=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,o=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(s=l.trys,!(s=s.length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){l.label=i[1];break}if(6===i[0]&&l.label<s[1]){l.label=s[1],s=i;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(i);break}s[2]&&l.ops.pop(),l.trys.pop();continue}i=t.call(e,l)}catch(e){i=[6,e],o=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,o,s,a,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},k=function(){function e(e){var t=this;this.isCompleted=!0,this.isSelectionCompleted=!0,this.scrollbarWidth=0,this.isWebPrinting=!1,this.isHeaderFooter=!1,this.currentPage=void 0,this.selectionStartPageIn=void 0,this.selectionEndPageIn=void 0,this.fieldStacks=[],this.showRevision=!1,this.splittedCellWidgets=[],this.tableLefts=[],this.tapCount=0,this.timer=-1,this.isTimerStarted=!1,this.isFirstLineFitInShiftWidgets=!1,this.preZoomFactor=0,this.preDifference=-1,this.fieldEndParagraph=void 0,this.fieldToLayout=void 0,this.backgroundColor="#FFFFFF",this.isMouseDown=!1,this.isMouseEntered=!1,this.scrollMoveTimer=0,this.isSelectionChangedOnMouseMoved=!1,this.isControlPressed=!1,this.isTouchInput=!1,this.isTouchMoved=!1,this.useTouchSelectionMark=!1,this.touchDownOnSelectionMark=0,this.isComposingIME=!1,this.lastComposedText="",this.isCompositionStart=!1,this.isCompositionUpdated=!1,this.isCompositionCanceled=!1,this.isCompositionEnd=!1,this.prefix="",this.suffix="",this.fields=[],this.heightInfoCollection={},this.defaultTabWidth=36,this.dontUseHtmlParagraphAutoSpacing=!1,this.allowSpaceOfSameStyleInTable=!1,this.alignTablesRowByRow=!1,this.compatibilityMode="Word2013",this.lists=[],this.comments=[],this.authors=new n.a,this.revisionsInternal=new n.a,this.commentUserOptionId=1,this.abstractLists=[],this.styles=new s.h,this.stylesMap=new n.a,this.preDefinedStyles=void 0,this.isRowOrCellResizing=!1,this.endBookmarksUpdated=[],this.formFields=[],this.isMouseDownInFooterRegion=!1,this.pageFitTypeIn="None",this.fieldCollection=[],this.isPageField=!1,this.mouseDownOffset=new c.b(0,0),this.zoomFactorInternal=1,this.moveCaretPosition=0,this.isTextInput=!1,this.isTextFormEmpty=!1,this.isScrollHandler=!1,this.triggerElementsOnLoading=!1,this.triggerSpellCheck=!1,this.restrictFormatting=!1,this.protectionType="NoProtection",this.isDocumentProtected=!1,this.hashValue="",this.saltValue="",this.userCollection=[],this.cachedPages=[],this.skipScrollToPosition=!1,this.isIosDevice=!1,this.isMobileDevice=!1,this.isFormFilling=!1,this.themes=new b.a,this.hasThemes=!1,this.footnotes=new h.k,this.endnotes=new h.k,this.isFootnoteWidget=!1,this.isDragStarted=!1,this.isMouseDownInSelection=!1,this.isBookmarkInserted=!0,this.isAutoResizeCanStart=!1,this.isRestartNumbering=!1,this.onTextInput=function(e){if(!t.isComposingIME){e.preventDefault();var i=e.data;t.owner.editor.handleTextInput(i)}},this.compositionStart=function(){d.Browser.isDevice||t.owner.isReadOnlyMode||(t.isComposingIME=!0,t.positionEditableTarget(),t.owner.editorHistory&&t.owner.editor.initComplexHistory("IMEInput")),t.isCompositionStart=!0},this.compositionUpdated=function(){t.isComposingIME&&!t.owner.isReadOnlyMode&&setTimeout(function(){t.owner.editor.insertIMEText(t.getEditableDivTextContent(),!0)},0),t.isCompositionUpdated=!0},this.compositionEnd=function(e){if(t.isComposingIME&&!t.owner.isReadOnlyMode){var i=t.getEditableDivTextContent();""!==i&&t.owner.editor.insertIMEText(i,!1),t.isComposingIME=!1,t.lastComposedText="",t.iframe.setAttribute("style","pointer-events:none;position:absolute;left:"+t.owner.viewer.containerLeft+"px;top:"+t.owner.viewer.containerTop+"px;outline:none;background-color:transparent;width:0px;height:0px;overflow:hidden"),t.editableDiv.innerHTML="",t.owner.editorHistory&&(""!==i&&(t.owner.editor.isSkipOperationsBuild=!0),t.owner.editorHistory.updateComplexHistory(),""===i&&(t.owner.editor.isSkipOperationsBuild=!0,t.owner.editorHistory.undo(),t.owner.editorHistory.redoStack.pop()),t.owner.editor.isSkipOperationsBuild=!1)}e.preventDefault(),t.isCompositionUpdated=!1,t.isCompositionEnd=!0},this.onImageResizer=function(e){!i.i(d.isNullOrUndefined)(t.owner)&&!i.i(d.isNullOrUndefined)(t.owner.imageResizerModule)&&t.owner.imageResizerModule.isImageResizerVisible&&t.owner.imageResizerModule.isImageResizing&&(e instanceof MouseEvent?t.onMouseUpInternal(e):e instanceof TouchEvent&&t.onTouchUpInternal(e)),t.scrollMoveTimer&&(t.isMouseEntered=!0,clearInterval(t.scrollMoveTimer))},this.onKeyPressInternal=function(e){var i=e.which||e.keyCode;t.triggerElementsOnLoading=!1;var n=!(!e.ctrlKey&&!e.metaKey)||17===i,r=e.altKey?e.altKey:18===i;if(d.Browser.isIE&&r&&n&&(n=!1),n&&"v"===e.key||n&&"a"===e.key||(n||t.isControlPressed&&d.Browser.isIE)&&"p"===e.key)return void(d.Browser.isIE&&(t.isControlPressed=!1));if(!t.owner.isReadOnlyMode||t.selection&&t.selection.isInlineFormFillMode()){var o=e.keyCode||e.charCode,s="";o?s=String.fromCharCode(o):e.key&&(s=e.key)," "===s||"\r"===s||"\b"===s||s===String.fromCharCode(27)||n?" "===s&&(t.triggerSpellCheck=!0,t.owner.editorModule.handleTextInput(" "),t.triggerSpellCheck=!1):t.owner.editorModule.handleTextInput(s),e.preventDefault()}t.owner.focusIn()},this.onTextInputInternal=function(e){t.owner.isReadOnlyMode?t.editableDiv.innerText="":t.owner.editorModule.onTextInputInternal()},this.onPaste=function(e){(!t.owner.isReadOnlyMode&&t.owner.editor.canEditContentControl||t.selection.isInlineFormFillMode())&&t.owner.editorModule.pasteInternal(e),t.editableDiv.innerText="",e.preventDefault()},this.onFocusOut=function(){if(!i.i(d.isNullOrUndefined)(t.selection)){if(t.owner.contextMenuModule&&t.owner.contextMenuModule.contextMenuInstance&&"block"===t.owner.contextMenuModule.contextMenuInstance.element.style.display)return;t.selection.hideCaret()}},this.updateFocus=function(){if(!t.owner.enableCollaborativeEditing||!t.owner.editor.isRemoteAction)return i.i(d.isNullOrUndefined)(t.currentSelectedComment)||t.owner.commentReviewPane.commentPane.isEditMode?void(!t.selection||t.isMobileDevice&&t.owner.isReadOnly||(void 0===navigator||d.Browser.isDevice||d.Browser.isIE||navigator.userAgent.match("Edge")||i.i(d.isNullOrUndefined)(t.iframe)||t.iframe.focus(),i.i(d.isNullOrUndefined)(t.editableDiv)||t.editableDiv.focus(),t.selection.showCaret())):(t.owner.commentReviewPane&&t.owner.commentReviewPane.commentPane.isEditMode&&t.owner.commentReviewPane.commentPane.selectComment(t.currentSelectedComment),void t.selection.hideCaret())},this.scrollHandler=function(){if(t.scrollTimer&&clearTimeout(t.scrollTimer),t.clearContent(),t.isScrollHandler=!0,d.Browser.isDevice||t.isComposingIME||(t.iframe.style.top=t.owner.viewer.containerTop+"px",t.iframe.style.left=t.owner.viewer.containerLeft+"px"),t.owner.hRuler){document.getElementById(t.owner.element.id+"_hRulerBottom").style.top=t.viewerContainer.scrollTop+"px";var e=document.getElementById(t.owner.element.id+"_markIndicator");e&&(e.style.top=t.viewerContainer.scrollTop+"px")}if(t.owner.vRuler){document.getElementById(t.owner.element.id+"_vRulerBottom").style.left=t.viewerContainer.scrollLeft+"px";var e=document.getElementById(t.owner.element.id+"_markIndicator");e&&(e.style.left=t.viewerContainer.scrollLeft+"px")}t.owner.rulerHelper&&!i.i(d.isNullOrUndefined)(t.owner.rulerHelper.vRulerBottom)&&(t.owner.rulerHelper.vRulerBottom.style.height=t.pageContainer.offsetHeight+"px"),t.owner.viewer.updateScrollBars();var n=t.owner.viewer.containerTop+t.visibleBounds.height-(t.owner.viewer.padding.top+t.owner.viewer.padding.bottom);n>t.pageContainer.offsetHeight&&(t.viewerContainer.scrollTop=t.owner.viewer.containerTop-(n-t.pageContainer.offsetHeight)),t.owner.viewer instanceof T&&!i.i(d.isNullOrUndefined)(t.owner)&&t.owner.fireViewChange(),t.isScrollHandler=!1,t.scrollTimer=setTimeout(function(){t.isScrollHandler||i.i(d.isNullOrUndefined)(t.owner)||!t.owner.isSpellCheck||(t.isScrollToSpellCheck=!0,t.owner.viewer.updateScrollBars())},200)},this.onWindowResize=function(){t.resizeTimer&&clearTimeout(t.resizeTimer),t.resizeTimer=setTimeout(function(){i.i(d.isNullOrUndefined)(t.owner)||i.i(d.isNullOrUndefined)(t.owner.element)||(t.updateViewerSize(),t.owner.rulerHelper&&t.owner.documentEditorSettings&&t.owner.documentEditorSettings.showRuler&&t.owner.rulerHelper.updateRuler(t.owner,!0),t.clearContent(),t.owner.viewer.updateScrollBars(),i.i(d.isNullOrUndefined)(t.selection)||t.selection.updateCaretPosition(),t.updateTouchMarkPosition(),t.owner.contextMenuModule&&t.owner.contextMenuModule.contextMenuInstance&&t.owner.contextMenuModule.contextMenuInstance.close(),t.resizeTimer&&clearTimeout(t.resizeTimer))},200)},this.onContextMenu=function(e){t.owner.contextMenuModule&&(t.isMouseDown&&(t.isMouseDown=!1),t.owner.contextMenuModule.onContextMenuInternal(e),t.updateFocus())},this.onMouseDownInternal=function(e){var n=e.target;if(t.owner.focusIn(),!(!i.i(d.isNullOrUndefined)(n)&&n!==t.viewerContainer||t.owner.isTableMarkerDragging||t.isTouchInput||e.offsetX>t.visibleBounds.width-(t.visibleBounds.width-t.viewerContainer.clientWidth)||e.offsetY>t.visibleBounds.height-(t.visibleBounds.height-t.viewerContainer.clientHeight)||(t.isFootnoteWidget=!1,i.i(d.isNullOrUndefined)(t.selection)))){if(t.updateCursor(e),t.formFillPopup&&t.formFillPopup.hidePopup(),t.isLeftButtonPressed(e)&&!t.owner.isReadOnlyMode&&t.owner.enableImageResizerMode&&!i.i(d.isNullOrUndefined)(t.owner.imageResizerModule.selectedResizeElement)){if(t.selection.isInShape){var r=t.owner.selection.getCurrentTextFrame(),o=r.containerShape;t.selection.selectShape(o)}t.owner.imageResizerModule.isImageResizing=!0}e.preventDefault(),t.isTouchInput||t.selection.hideCaret();var s=new c.b(e.offsetX,e.offsetY),a=t.owner.viewer.findFocusedPage(s,!0,!0);if(t.mouseDownOffset.x=a.x,t.mouseDownOffset.y=a.y,t.isMouseDownInFooterRegion=t.selection.isCursorInsidePageRect(s,t.currentPage)&&t.selection.isCursorInFooterRegion(s,t.currentPage),t.isSelectionChangedOnMouseMoved=!1,!t.owner.isReadOnlyMode&&(t.owner.editorModule.tableResize.isInCellResizerArea(a)||t.owner.editorModule.tableResize.isInRowResizerArea(a)))return t.selection.hideCaret(),t.isMouseDown=!0,t.isSelectionChangedOnMouseMoved=!1,void(t.isLeftButtonPressed(e)&&(t.owner.editorModule.tableResize.startingPoint.x=a.x,t.owner.editorModule.tableResize.startingPoint.y=a.y,t.owner.editorModule.tableResize.handleResize(a)));e.ctrlKey&&(t.isControlPressed=!0),t.owner.selection.isEmpty&&(t.useTouchSelectionMark=!1);var l=t.getLineWidget(a);if(3===e.which&&!t.owner.selection.isEmpty&&t.selection.checkCursorIsInSelection(l,a))return void e.preventDefault();t.owner&&t.owner.documentEditorSettings&&t.owner.documentEditorSettings.allowDragAndDrop&&!t.owner.selection.isEmpty&&t.selection.checkCursorIsInSelection(l,a)&&(t.isMouseDownInSelection=!0),t.isTouchInput=!1,t.isMouseDown=!0,t.updateFocus(),t.timer=setTimeout(function(){t.tapCount++,t.tapCount>1&&(t.tapCount=1),t.isScrollHandler||i.i(d.isNullOrUndefined)(t.owner)||!t.owner.isSpellCheck||(t.isScrollToSpellCheck=!0,t.owner.viewer.updateScrollBars())},100)}},this.onMouseMoveInternal=function(e){if((i.i(d.isNullOrUndefined)(e.target)||e.target===t.viewerContainer)&&!t.owner.isTableMarkerDragging&&(e.preventDefault(),!i.i(d.isNullOrUndefined)(t.selection))){if(!t.owner.isReadOnlyMode&&t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizing)return void(t.owner.imageResizerModule.isImageMoveToNextPage||t.owner.imageResizerModule.handleImageResizingOnMouse(e));var n=new c.b(e.offsetX,e.offsetY),r=t.owner.viewer.findFocusedPage(n,!t.owner.enableHeaderAndFooter),o=t.getLineWidget(r);if(t.isMouseDown){if(!i.i(d.isNullOrUndefined)(t.currentPage)){var s=r.x,a=r.y;if(!t.owner.isReadOnlyMode&&t.isRowOrCellResizing){var l=t.owner.editorModule.tableResize.currentResizingTable,h=t.selection.setPositionForBlock(l,!0),p=t.selection.setPositionForBlock(l,!1);t.owner.documentHelper.isDocumentProtected&&!t.selection.checkSelectionIsAtEditRegion(h,p)||t.owner.editorModule.tableResize.handleResizing(r)}else{if((!t.isDragStarted&&t.isMouseDownInSelection&&t.isLeftButtonPressed(e)&&!t.owner.selection.isEmpty&&t.selection.checkCursorIsInSelection(o,r)||!t.owner.isReadOnlyMode&&t.owner.enableImageResizerMode&&!t.isDragStarted&&t.isLeftButtonPressed(e)&&!t.owner.selection.isEmpty&&!i.i(d.isNullOrUndefined)(o)&&t.owner.imageResizerModule.selectedImageWidget.containsKey(o)&&!t.owner.imageResizerModule.isImageResizing)&&(t.isDragStarted=!0,t.isMouseDownInSelection=!1,t.selection.isForward?(t.dragStartParaInfo=t.selection.getParagraphInfo(t.selection.start),t.dragEndParaInfo=t.selection.getParagraphInfo(t.selection.end)):(t.dragStartParaInfo=t.selection.getParagraphInfo(t.selection.end),t.dragEndParaInfo=t.selection.getParagraphInfo(t.selection.start)),t.selection.caret.classList.remove("e-de-cursor-animation")),t.isTouchInput||t.isSelectionChangedOnMouseMoved||t.touchDownOnSelectionMark>0||t.isDragStarted||t.updateTextPositionForSelection(r,1),t.isLeftButtonPressed(e)&&!t.isDragStarted){e.preventDefault();var u=a,g=t.owner.selection.end,f=new c.b(s,u);t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizerVisible&&!t.owner.imageResizerModule.isShapeResize||(t.isCompleted=!1,t.owner.selection.moveTextPosition(f,g)),t.isSelectionChangedOnMouseMoved=!0}t.isDragStarted&&t.isLeftButtonPressed(e)&&(t.autoScrollOnSelection(n),t.selection.updateTextPosition(o,r))}}t.selection.checkForCursorVisibility()}t.isRowOrCellResizing||t.isSelectionChangedOnMouseMoved||t.updateCursor(e),t.isRowOrCellResizing&&t.selection.hideCaret()}},this.onMouseLeaveInternal=function(e){e.preventDefault();var i=new c.b(e.offsetX,e.offsetY);if(t.isMouseDown){var n=t.viewerContainer.scrollTop;clearInterval(t.scrollMoveTimer),e.offsetY+n>n?t.scrollMoveTimer=setInterval(function(){t.scrollForwardOnSelection(i)},100):t.scrollMoveTimer=setInterval(function(){t.scrollBackwardOnSelection(i)},100),t.isMouseEntered&&(t.isMouseEntered=!1)}t.isDragStarted&&(t.selection.hideCaret(),t.scrollMoveTimer&&(clearInterval(t.scrollMoveTimer),t.scrollMoveTimer=0))},this.onMouseEnterInternal=function(e){t.isMouseEntered||t.owner.viewer.updateScrollBars(),t.isMouseEntered=!0,t.scrollMoveTimer&&clearInterval(t.scrollMoveTimer),!t.isLeftButtonPressed(e)&&t.isDragStarted&&(t.selection.caret.classList.contains("e-de-cursor-animation")||t.selection.caret.classList.add("e-de-cursor-animation"),t.isDragStarted=!1),!t.isLeftButtonPressed(e)&&t.isMouseDown&&t.onMouseUpInternal(e)},this.onDoubleTap=function(e){if(t.owner.focusIn(),(i.i(d.isNullOrUndefined)(e.target)||e.target===t.viewerContainer)&&!i.i(d.isNullOrUndefined)(t.selection)){t.isTouchInput=!1;var n=new c.b(e.offsetX,e.offsetY),r=t.owner.viewer.findFocusedPage(n,!0);if(t.selection.checkAndEnableHeaderFooter(n,t.owner.viewer.findFocusedPage(n,!0)))return;var o=t.getLineWidget(r),s=t.selection.getHyperLinkFieldInCurrentSelection(o,r,!0);if(i.i(d.isNullOrUndefined)(s)&&(s=t.selection.getCurrentFormField()),!t.isDocumentProtected&&t.owner.enableFormField){var a=t.selection.getFormFieldType(s);if(a)switch(""!==a.toString()&&t.selection.selectField(s),a){case"Text":t.owner.textFormFieldDialogModule.show();break;case"CheckBox":t.owner.checkBoxFormFieldDialogModule.show();break;case"DropDown":t.owner.dropDownFormFieldDialogModule.show()}}else t.isDocumentProtected&&s&&s.formFieldData instanceof h.l&&"Text"===s.formFieldData.type&&t.selection.selectField();var l=t.selection.start.clone(),p=t.selection.end.clone(),u=l.currentWidget.getInline(l.offset,0),g=u.element;if("Pages"===t.owner.layoutType)if(g instanceof h.f)if("Footnote"===g.footnoteType){var f=t.currentPage.footnoteWidget,m=void 0;for(m=0;m<=f.bodyWidgets.length;m++){var v=f.bodyWidgets[m].footNoteReference;if(g.text===v.text)break}l.setPositionParagraph(f.bodyWidgets[m].childWidgets[0].childWidgets[0],0),p.setPositionParagraph(f.bodyWidgets[m].childWidgets[0].childWidgets[0],0),t.selection.selectRange(l,p)}else{var y=t.pages[t.pages.length-1].endnoteWidget,m=void 0;if(!i.i(d.isNullOrUndefined)(y))for(m=0;m<=y.childWidgets.length;m++){var w=y.bodyWidgets[m].footNoteReference;if(g.text===w.text)break}l.setPositionParagraph(y.bodyWidgets[m].childWidgets[0].childWidgets[0],0),p.setPositionParagraph(y.bodyWidgets[m].childWidgets[0].childWidgets[0],0),t.selection.selectRange(l,p)}else g instanceof h.d&&(t.selection.isinEndnote||t.selection.isinFootnote)&&t.selection.footnoteReferenceElement(l,p,g);!t.selection.isEmpty||i.i(d.isNullOrUndefined)(t.currentPage)||i.i(d.isNullOrUndefined)(t.owner.selection.start)||(t.owner.selection.selectCurrentWord(),t.selection.checkForCursorVisibility(),t.tapCount=2)}},this.onMouseUpInternal=function(e){if((i.i(d.isNullOrUndefined)(e.target)||e.target===t.viewerContainer)&&!t.owner.isTableMarkerDragging){e.preventDefault(),t.isListTextSelected=!1;var n=new c.b(e.offsetX,e.offsetY),r=t.owner.viewer.findFocusedPage(n,!0);if(!i.i(d.isNullOrUndefined)(t.selection)){var o=1;if(d.Browser.isIE?o=t.tapCount:e.detail>2&&(o=e.detail),t.isRowOrCellResizing&&t.owner.editorModule.tableResize.updateResizingHistory(r),t.isMouseDown&&!t.isSelectionChangedOnMouseMoved&&!i.i(d.isNullOrUndefined)(t.currentPage)&&!i.i(d.isNullOrUndefined)(t.owner.selection.start)&&(!t.owner.enableImageResizerMode||!t.owner.imageResizerModule.isImageResizing)){if(0===t.touchDownOnSelectionMark&&!t.isRowOrCellResizing){if(e.shiftKey){var s=t.owner.selection.end;t.owner.selection.moveTextPosition(r,s)}else t.updateTextPositionForSelection(r,o);d.Browser.isIE&&2===o&&t.selection.checkAndEnableHeaderFooter(n,r)}t.selection.checkForCursorVisibility(),i.i(d.isNullOrUndefined)(t.currentSelectedComment)||!t.owner.commentReviewPane||t.owner.commentReviewPane.commentPane.isEditMode||(t.currentSelectedComment=void 0)}var a=t.isIosDevice?e.metaKey:e.ctrlKey;if(i.i(d.isNullOrUndefined)(t.currentPage)||i.i(d.isNullOrUndefined)(t.owner.selection.start)||!t.owner.selection.isEmpty&&!t.owner.selection.isImageSelected||!(a&&t.owner.useCtrlClickToFollowHyperlink||!t.owner.useCtrlClickToFollowHyperlink)||!0!==t.isLeftButtonPressed(e)||t.selection.navigateHyperLinkOnEvent(r,!1),t.isMouseDown&&t.isLeftButtonPressed(e)&&t.isDocumentProtected&&"FormFieldsOnly"===t.protectionType&&t.selection){var l=t.getLineWidget(r),p=t.selection.getHyperLinkFieldInCurrentSelection(l,r,!0);if(i.i(d.isNullOrUndefined)(p)&&(p=t.selection.getCurrentFormField(!0)),p&&p.formFieldData&&p.formFieldData.enabled&&!t.selection.isInlineFormFillMode(p)){var u={fieldName:p.formFieldData.name};p.formFieldData instanceof h.l?u.value=p.resultText:p.formFieldData instanceof h.m?u.value=p.formFieldData.checked:u.value=p.formFieldData.selectedIndex,u.isCanceled=!1,"Popup"===t.owner.documentEditorSettings.formFieldSettings.formFillingMode&&(t.selection.previousSelectedFormField,t.selection.getCurrentFormField()),t.owner.trigger(m.b,u),u.isCanceled||("Popup"===t.owner.documentEditorSettings.formFieldSettings.formFillingMode&&!(p.formFieldData instanceof h.m)||p.formFieldData instanceof h.l&&"Text"!==p.formFieldData.type||p.formFieldData instanceof h.n?t.formFillPopup.showPopUp(p):(t.owner.editor.toggleCheckBoxFormField(p),u.value=p.formFieldData.checked,u.isCanceled=!1,t.owner.trigger(m.c,u)))}!p&&t.isFormFillProtectedMode&&t.selection.navigateToNextFormField()}else if(t.isMouseDown){if(t.formFields.length>0){var p=t.selection.getCurrentFormField(!0);if(p&&p.formFieldData instanceof h.l)t.selection.selectField();else if(t.isLeftButtonPressed(e)&&p&&p.formFieldData instanceof h.n){var g=p.line.getOffset(p,0),f=t.selection.getPhysicalPositionInternal(p.line,g,!1);t.selection.selectInternal(p.line,p,0,f)}}t.isSelectionChangedOnMouseMoved&&t.selection.fireSelectionChanged(!0)}if(!t.owner.isReadOnlyMode&&t.isSelectionInListText(r)&&t.selection.selectListText(),!t.owner.isReadOnlyMode&&t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizing&&(t.owner.imageResizerModule.mouseUpInternal(),t.scrollToPosition(t.owner.selection.start,t.owner.selection.end),t.owner.imageResizerModule.isImageResizing=!1),t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizerVisible&&!i.i(d.isNullOrUndefined)(t.selection.caret)&&(t.selection.caret.style.display="none"),t.isDragStarted&&t.moveSelectedContent(),t.isMouseDown&&t.updateFocus(),t.isMouseDownInSelection=!1,t.isMouseDown=!1,t.isFootnoteWidget=!1,t.isSelectionChangedOnMouseMoved=!1,t.isTouchInput=!1,t.useTouchSelectionMark=!0,t.isControlPressed=!1,t.isListTextSelected&&t.selection.hideCaret(),t.owner.enableImageResizerMode){var v=t.owner.imageResizerModule;v.isImageResizing=!1,v.isImageMoveToNextPage=!1,v.leftValue=void 0,v.topValue=void 0}t.isMouseDownInFooterRegion=!1}t.selection&&(t.selection.isCellPrevSelected=!1)}},this.onTouchStartInternal=function(e){if(t.selection){if(t.isTouchMoved=!1,t.isCompositionStart=!1,t.isCompositionEnd=!1,t.isCompositionUpdated=!1,t.isCompositionCanceled=!0,t.isTouchInput=!0,t.isTimerStarted?1===t.tapCount?t.tapCount=2:(t.tapCount=3,t.isTimerStarted=!1):(t.isTimerStarted=!0,t.tapCount=1),1===e.touches.length){t.zoomX=e.touches[0].clientX,t.zoomY=e.touches[0].clientY,t.owner.selection.isEmpty&&(t.useTouchSelectionMark=!1),t.isMouseDown=!0,t.isSelectionChangedOnMouseMoved=!1;var n=void 0;if(t.isMouseDown&&(n=t.getTouchOffsetValue(e)),n=t.owner.viewer.findFocusedPage(n,!0,!0),t.owner.enableImageResizerMode){var r=t.owner.imageResizerModule.getImagePointOnTouch(n);t.owner.imageResizerModule.selectedResizeElement=r.selectedElement}t.owner.enableImageResizerMode&&!i.i(d.isNullOrUndefined)(t.owner.imageResizerModule.selectedResizeElement)&&(t.owner.imageResizerModule.isImageResizing=!0),d.Browser.isDevice&&(t.editableDiv.contentEditable=t.owner.isReadOnlyMode?"false":"true");var o=t.owner.selection.end.location.x,s=t.selection.getCaretBottom(t.owner.selection.end,t.owner.selection.isEmpty)+9;t.touchDownOnSelectionMark=(n.y<=s&&n.y>=s-20||n.y>=s&&n.y<=s+20)&&(n.x<=o&&n.x>=o-20||n.x>=o&&n.x<=o+20)?1:0,t.owner.selection.isEmpty||0!==t.touchDownOnSelectionMark||(o=t.owner.selection.start.location.x,s=t.selection.getCaretBottom(t.owner.selection.start,!1)+9,t.touchDownOnSelectionMark=(n.y<=s&&n.y>=s-20||n.y>=s&&n.y<=s+20)&&(n.x<=o&&n.x>=o-20||n.x>=o&&n.x<=o+20)?2:0)}!i.i(d.isNullOrUndefined)(t.owner.contextMenuModule)&&t.owner.contextMenuModule.contextMenuInstance&&t.owner.contextMenuModule.contextMenuInstance.close(),(t.touchDownOnSelectionMark||e.touches.length>1)&&e.preventDefault(),t.longTouchTimer=setTimeout(t.onLongTouch,500,e),t.timer=setTimeout(function(){t.isTimerStarted=!1},200),t.owner.focusIn()}},this.onLongTouch=function(e){if(!(i.i(d.isNullOrUndefined)(t.owner)||i.i(d.isNullOrUndefined)(t.viewerContainer)||t.isTouchMoved||1!==e.touches.length)){var n=t.getTouchOffsetValue(e),r=t.owner.viewer.findFocusedPage(n,!0),o=t.selection.start,s=t.selection.end,a=!1;t.selection.isForward||(o=t.selection.end,s=t.selection.start);var l=o.location,h=s.location;a=o.currentWidget!==s.currentWidget?!(r.x>=l.x&&r.x<=h.x||r.y>=l.y&&r.y<=h.y):!(r.x>=l.x&&r.x<=h.x&&r.y>=l.y&&r.y<=h.y),1===e.changedTouches.length&&a&&(t.updateSelectionOnTouch(n,r),t.isMouseDown=!1,t.touchDownOnSelectionMark=0,t.useTouchSelectionMark=!0,t.isSelectionChangedOnMouseMoved=!1),t.selection.isEmpty&&t.selection.selectCurrentWord(),!i.i(d.isNullOrUndefined)(t.owner.contextMenuModule)&&t.owner.contextMenuModule.contextMenuInstance&&t.owner.contextMenuModule.onContextMenuInternal(e)}},this.onTouchMoveInternal=function(e){t.isTouchMoved=!0;var n,r=e.touches;if(!i.i(d.isNullOrUndefined)(t.selection)){if(t.owner.editorModule&&t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizing)return e.preventDefault(),void(t.owner.imageResizerModule.isImageMoveToNextPage||(t.owner.imageResizerModule.handleImageResizingOnTouch(e),t.selection.caret.style.display="none"));if(t.isMouseDown){n=t.getTouchOffsetValue(e);var o=t.owner.viewer.findFocusedPage(n,!0);if(t.touchDownOnSelectionMark>0){t.isCompleted=!1,e.preventDefault();var s=o.y,a=t.owner.selection.end;o.y<=26?s-=o.y<0?0:o.y+.5:s-=36.5,a=2===t.touchDownOnSelectionMark?t.selection.start:t.selection.end,o=new c.b(o.x,s),t.owner.selection.moveTextPosition(o,a),t.isSelectionChangedOnMouseMoved=!0}t.selection.checkForCursorVisibility(),t.updateTouchMarkPosition()}}if(r.length>1){e.preventDefault(),t.isMouseDown=!1,t.zoomX=(r[0].clientX+r[1].clientX)/2,t.zoomY=(r[0].clientY+r[1].clientY)/2;var l=Math.sqrt(Math.pow(r[0].clientX-r[1].clientX,2)+Math.pow(r[0].clientY-r[1].clientY,2));t.preDifference>-1?l>t.preDifference?t.onPinchOutInternal(e):l<t.preDifference&&t.onPinchInInternal(e):t.zoomFactor<2?-1!==t.preDifference&&l>t.preDifference&&t.onPinchInInternal(e):-1===t.preDifference&&t.zoomFactor>2&&l>t.preDifference&&t.onPinchInInternal(e),t.preDifference=l}t.longTouchTimer&&(clearTimeout(t.longTouchTimer),t.longTouchTimer=void 0)},this.onTouchUpInternal=function(e){if(!i.i(d.isNullOrUndefined)(t.selection)){var n=t.getTouchOffsetValue(e),r=t.owner.viewer.findFocusedPage(n,!0);1===e.changedTouches.length&&((!t.isTouchMoved||t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizing)&&(t.updateSelectionOnTouch(n,r),i.i(d.isNullOrUndefined)(t.currentPage)||i.i(d.isNullOrUndefined)(t.selection.start)||t.isSelectionChangedOnMouseMoved||!(t.selection.isEmpty||t.selection.isImageField()&&(!t.owner.enableImageResizerMode||t.owner.enableImageResizerMode&&!t.owner.imageResizerModule.isImageResizing))||t.selection.navigateHyperLinkOnEvent(r,!0)),t.isSelectionChangedOnMouseMoved&&t.selection.fireSelectionChanged(!0),t.isMouseDown=!1,t.touchDownOnSelectionMark=0,t.useTouchSelectionMark=!0,t.isSelectionChangedOnMouseMoved=!1),t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizing&&(t.owner.imageResizerModule.mouseUpInternal(),t.owner.imageResizerModule.isImageResizing=!1,t.owner.imageResizerModule.isImageMoveToNextPage=!1,t.scrollToPosition(t.owner.selection.start,t.owner.selection.end)),t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizerVisible&&t.isTouchInput&&(t.touchStart.style.display="none",t.touchEnd.style.display="none"),e.preventDefault()}t.preDifference=-1,t.isTouchInput=!1,t.longTouchTimer&&(clearTimeout(t.longTouchTimer),t.longTouchTimer=void 0),t.isTimerStarted||(t.tapCount=1),t.isListTextSelected&&t.selection.hideCaret(),t.owner.focusIn()},this.onKeyUpInternal=function(e){d.Browser.isDevice&&e.target===t.editableDiv&&window.getSelection().anchorOffset!==t.prefix.length&&t.selection.setEditableDivCaretPosition(t.editableDiv.innerText.length),(e.ctrlKey||17===e.keyCode||17===e.which)&&(t.isControlPressed=!1)},this.onKeyDownInternal=function(e){if(i.i(d.isNullOrUndefined)(e.target)||e.target===t.editableDiv){t.owner.focusIn();var n=!1,r={event:e,isHandled:!1,source:t.owner};if(t.owner.trigger(m.d,r),!r.isHandled){var o=e.which||e.keyCode,s=!(!e.ctrlKey&&!e.metaKey)||17===o,a=e.shiftKey?e.shiftKey:16===o,l=e.altKey?e.altKey:18===o;if(s&&!a&&!l)switch(o){case 80:e.preventDefault(),t.owner.print(),n=!0;break;case 83:e.preventDefault(),t.owner.save(""===t.owner.documentName?"sample":t.owner.documentName,"Sfdt"),n=!0}n||i.i(d.isNullOrUndefined)(t.selection)||t.selection.onKeyDownInternal(e,s,a,l),n&&e.preventDefault(),t.timer=setTimeout(function(){t.isScrollHandler||i.i(d.isNullOrUndefined)(t.owner)||!t.owner.isSpellCheck||(t.isScrollToSpellCheck=!0,t.owner.viewer.updateScrollBars())},100)}}},this.owner=e,this.pages=[],this.lists=[],this.abstractLists=[],this.render=new l.a(this),this.characterFormat=new s.c(this),this.themeFontLanguage=new s.c(this),this.paragraphFormat=new s.a(this),this.renderedLists=new n.a,this.renderedLevelOverrides=[],this.headersFooters=[],this.styles=new s.h,this.stylesMap=new n.a,this.owner&&(this.L10n=new d.L10n("documenteditor",this.owner.defaultLocale),this.L10n.setLocale(this.owner.locale)),this.preDefinedStyles=new n.a,this.initalizeStyles(),this.bookmarks=new n.a,this.editRanges=new n.a,this.isIosDevice="undefined"!=typeof window&&/Mac|iPad|iPod/i.test(navigator.userAgent),this.isMobileDevice="undefined"!=typeof window&&/Android|Windows Phone|webOS/i.test(navigator.userAgent),this.formFillPopup=new y.a(this.owner),this.customXmlData=new n.a,this.contentControlCollection=[],this.footnoteCollection=[],this.endnoteCollection=[],this.themes=new b.a,this.images=new n.a}return Object.defineProperty(e.prototype,"visibleBounds",{get:function(){return this.visibleBoundsIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"containerCanvas",{get:function(){return i.i(d.isNullOrUndefined)(this.containerCanvasIn)&&(this.containerCanvasIn=document.createElement("canvas"),this.containerCanvasIn.getContext("2d").save()),i.i(d.isNullOrUndefined)(this.pageContainer)||this.containerCanvasIn.parentElement===this.pageContainer||this.pageContainer.appendChild(this.containerCanvasIn),this.containerCanvasIn},enumerable:!0,configurable:!0}),e.prototype.openTextFile=function(e){this.layout.isTextFormat=!0;var t=[];e=e.replace(/\r\n/g,"\n"),t=e.split("\n");var i=[],n=new h.o;n.sectionFormat=new s.i(n),n.childWidgets=i;for(var r=new h.g,o=new h.p(r),a=0;a<t.length;a++)if(a!==t.length-1||0!==t[a].length){var l=new h.g,d=new h.p(l);if(t[a].length>0){if(t[a].length>90)for(var c=0,p=90,u=void 0,g=t[a].length/90+1,f=0;f<g;){g-1!=f?u=t[a].substring(c,p):(p=t[a].length%90,u=t[a].substring(c,p));var m=new h.d;m.text=u,d.children.push(m),m.line=d,f++,p+=90,c+=90}else{var m=new h.d;m.text=t[a],d.children.push(m),m.line=d}}l.childWidgets.push(d),l.containerWidget=n,n.childWidgets.push(l)}else r.childWidgets.push(o),r.containerWidget=n,n.childWidgets.push(r);this.onDocumentChanged([n],{}),this.layout.isTextFormat=!1},Object.defineProperty(e.prototype,"selectionCanvas",{get:function(){return i.i(d.isNullOrUndefined)(this.selectionCanvasIn)&&(this.selectionCanvasIn=document.createElement("canvas"),this.selectionCanvas.getContext("2d").save()),i.i(d.isNullOrUndefined)(this.pageContainer)||this.selectionCanvasIn.parentElement===this.pageContainer||this.pageContainer.appendChild(this.selectionCanvasIn),this.selectionCanvasIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"containerContext",{get:function(){return this.containerCanvas.getContext("2d")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionContext",{get:function(){return this.selectionCanvas.getContext("2d")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentRenderingPage",{get:function(){if(0!==this.pages.length)return this.pages[this.pages.length-1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"zoomFactor",{get:function(){return this.zoomFactorInternal},set:function(e){this.zoomFactorInternal!==e&&(this.preZoomFactor=this.zoomFactor,this.zoomFactorInternal=e,this.zoomModule.setZoomFactor(),this.owner.zoomFactor=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selection",{get:function(){return this.owner.selection},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionStartPage",{get:function(){return this.selectionStartPageIn},set:function(e){this.selectionStartPageIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionEndPage",{get:function(){return this.selectionEndPageIn},set:function(e){this.selectionEndPageIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dialog",{get:function(){return this.dialogInternal||this.initDialog(this.owner.enableRtl),this.dialogInternal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dialog2",{get:function(){return this.dialogInternal2||this.initDialog2(this.owner.enableRtl),this.dialogInternal2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dialog3",{get:function(){return this.dialogInternal3||this.initDialog3(this.owner.enableRtl),this.dialogInternal3},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentSelectedComment",{get:function(){return this.currentSelectedCommentInternal},set:function(e){this.owner&&this.owner.commentReviewPane&&(this.owner.commentReviewPane.previousSelectedComment=this.currentSelectedCommentInternal),this.currentSelectedCommentInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentSelectedRevision",{get:function(){return this.currentSelectedRevisionInternal},set:function(e){this.currentSelectedRevisionInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isInlineFormFillProtectedMode",{get:function(){return this.isFormFillProtectedMode&&"Inline"===this.owner.documentEditorSettings.formFieldSettings.formFillingMode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isFormFillProtectedMode",{get:function(){return this.isDocumentProtected&&"FormFieldsOnly"===this.protectionType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCommentOnlyMode",{get:function(){return this.isDocumentProtected&&"CommentsOnly"===this.protectionType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isTrackedOnlyMode",{get:function(){return this.isDocumentProtected&&"RevisionsOnly"===this.protectionType},enumerable:!0,configurable:!0}),e.prototype.initalizeStyles=function(){this.preDefinedStyles.add("Normal",'{"type":"Paragraph","name":"Normal","next":"Normal"}'),this.preDefinedStyles.add("Heading 1",'{"type":"Paragraph","name":"Heading 1","basedOn":"Normal","next":"Normal","link":"Heading 1 Char","characterFormat":{"fontSize":16.0,"fontFamily":"Calibri Light","fontColor":"#2F5496"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":12.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level1"}}'),this.preDefinedStyles.add("Heading 2",'{"type":"Paragraph","name":"Heading 2","basedOn":"Normal","next":"Normal","link":"Heading 2 Char","characterFormat":{"fontSize":13.0,"fontFamily":"Calibri Light","fontColor":"#2F5496"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level2"}}'),this.preDefinedStyles.add("Heading 3",'{"type":"Paragraph","name":"Heading 3","basedOn":"Normal","next":"Normal","link":"Heading 3 Char","characterFormat":{"fontSize":12.0,"fontFamily":"Calibri Light","fontColor":"#1F3763"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level3"}}'),this.preDefinedStyles.add("Heading 4",'{"type":"Paragraph","name":"Heading 4","basedOn":"Normal","next":"Normal","link":"Heading 4 Char","characterFormat":{"italic":true,"fontFamily":"Calibri Light","fontColor":"#2F5496"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level4"}}'),this.preDefinedStyles.add("Heading 5",'{"type":"Paragraph","name":"Heading 5","basedOn":"Normal","next":"Normal","link":"Heading 5 Char","characterFormat":{"fontFamily":"Calibri Light","fontColor":"#2F5496"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level5"}}'),this.preDefinedStyles.add("Heading 6",'{"type":"Paragraph","name":"Heading 6","basedOn":"Normal","next":"Normal","link":"Heading 6 Char","characterFormat":{"fontFamily":"Calibri Light","fontColor":"#1F3763"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level6"}}'),this.preDefinedStyles.add("Default Paragraph Font",'{"type":"Character","name":"Default Paragraph Font"}'),this.preDefinedStyles.add("Heading 1 Char",'{"type":"Character","name":"Heading 1 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontSize":16.0,"fontFamily":"Calibri Light","fontColor":"#2F5496"}}'),this.preDefinedStyles.add("Heading 2 Char",'{"type":"Character","name":"Heading 2 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontSize":13.0,"fontFamily":"Calibri Light","fontColor":"#2F5496"}}'),this.preDefinedStyles.add("Heading 3 Char",'{"type":"Character","name":"Heading 3 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontSize":12.0,"fontFamily":"Calibri Light","fontColor": "#1F3763"}}'),this.preDefinedStyles.add("Heading 4 Char",'{"type":"Character","name":"Heading 4 Char","basedOn":"Default Paragraph Font","characterFormat":{"italic":true,"fontFamily":"Calibri Light","fontColor":"#2F5496"}}'),this.preDefinedStyles.add("Heading 5 Char",'{"type":"Character","name":"Heading 5 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontFamily":"Calibri Light","fontColor":"#2F5496"}}'),this.preDefinedStyles.add("Heading 6 Char",'{"type":"Character","name":"Heading 6 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontFamily":"Calibri Light","fontColor":"#1F3763"}}'),this.preDefinedStyles.add("Hyperlink",'{"type":"Character","name":"Hyperlink","basedOn":"Default Paragraph Font","next":"Normal","characterFormat":{"fontColor":"#0563C1","underline": "Single"}}'),this.preDefinedStyles.add("TOC 1",'{"type":"Paragraph","name":"TOC 1","basedOn":"Normal","next":"Normal","paragraphFormat":{"afterSpacing":5.0}}'),this.preDefinedStyles.add("TOC 2",'{"type":"Paragraph","name":"TOC 2","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :11.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("TOC 3",'{"type":"Paragraph","name":"TOC 3","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :22.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("TOC 4",'{"type":"Paragraph","name":"TOC 4","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :33.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("TOC 5",'{"type":"Paragraph","name":"TOC 5","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :44.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("TOC 6",'{"type":"Paragraph","name":"TOC 6","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :55.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("TOC 7",'{"type":"Paragraph","name":"TOC 7","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :66.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("TOC 8",'{"type":"Paragraph","name":"TOC 8","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :77.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("TOC 9",'{"type":"Paragraph","name":"TOC 9","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :88.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("Header",'{"type":"Paragraph","name":"Header","basedOn":"Normal","next":"Header","paragraphFormat":{"afterSpacing":0,"lineSpacing":1,"lineSpacingType":"Multiple"}}'),this.preDefinedStyles.add("Footer",'{"type":"Paragraph","name":"Footer","basedOn":"Normal","next":"Footer","paragraphFormat":{"afterSpacing":0,"lineSpacing":1,"lineSpacingType":"Multiple"}}')},e.prototype.clearDocumentItems=function(){this.owner.editor&&this.owner.editor.clear(),this.owner.search&&this.owner.search.clearSearchHighlight(),this.owner.selection&&this.owner.selection.clear(),this.editRanges.clear(),this.headersFooters=[],this.fields=[],this.formFields=[],this.currentSelectedComment=void 0,this.currentSelectedRevision=void 0;for(var e=0;e<this.comments.length;e++){var t=this.comments[e].commentStart;t&&t.destroy()}if(this.comments=[],this.bookmarks.clear(),this.endBookmarksUpdated=[],this.styles.clear(),this.stylesMap.clear(),this.pages&&this.pages.length>0){for(var e=0;e<this.pages.length;e++){this.pages[e].componentDestroy()}this.pages=[]}if(this.authors.clear(),this.revisionsInternal.clear(),this.owner.revisions.clear(),this.characterFormat.clearFormat(),this.themeFontLanguage.clearFormat(),this.paragraphFormat.clearFormat(),this.owner.trackChangesPane&&this.owner.trackChangesPane.clear(),this.setDefaultCharacterValue(this.characterFormat),this.setDefaultParagraphValue(this.paragraphFormat),this.owner.commentReviewPane&&this.owner.commentReviewPane.clear(),this.isHeaderFooter=!1,this.defaultTabWidth=36,this.isDocumentProtected=!1,this.protectionType="NoProtection",this.restrictFormatting=!1,this.hashValue="",this.saltValue="",this.userCollection=[],this.formFillPopup&&this.formFillPopup.hidePopup(),this.customXmlData.clear(),this.images.clear(),this.contentControlCollection=[],this.backgroundColor="#FFFFFF",this.endnotes.clear(),this.footnotes.clear(),this.footnoteCollection=[],this.endnoteCollection=[],this.lists&&this.lists.length>0)for(var e=0;e<this.lists.length;e++){var i=this.lists[e];i.clear()}this.lists=[],this.abstractLists=[],this.themes=new b.a,this.hasThemes=!1,this.isRestartNumbering=!1},e.prototype.setDefaultDocumentFormat=function(){this.owner.parser.parseCharacterFormat(0,this.owner.characterFormat,this.characterFormat),this.owner.parser.parseParagraphFormat(0,this.owner.paragraphFormat,this.paragraphFormat)},e.prototype.setDefaultCharacterValue=function(e){e.bold=!1,e.italic=!1,e.fontFamily="Calibri",e.fontSize=11,e.underline="None",e.strikethrough="None",e.fontSizeBidi=11,e.fontFamilyBidi="Calibri",e.baselineAlignment="Normal",e.highlightColor="NoColor",e.fontColor="#00000000",e.allCaps=!1},e.prototype.setDefaultParagraphValue=function(e){e.leftIndent=0,e.rightIndent=0,e.firstLineIndent=0,e.textAlignment="Left",e.beforeSpacing=0,e.afterSpacing=0,e.lineSpacing=1,e.lineSpacingType="Multiple",e.bidi=!1,e.keepWithNext=!1,e.keepLinesTogether=!1,e.widowControl=!0,e.outlineLevel="BodyText"},e.prototype.getAbstractListById=function(e,t){if(!i.i(d.isNullOrUndefined)(this.abstractLists))for(var n=0;n<this.abstractLists.length;n++){var r=this.abstractLists[n];if(!i.i(d.isNullOrUndefined)(r)){if(t&&r.nsid===e)return r;if(r.abstractListId===e)return r}}},e.prototype.getListById=function(e,t){if(!i.i(d.isNullOrUndefined)(this.lists))for(var n=0;n<this.lists.length;n++){var r=this.lists[n];if(!i.i(d.isNullOrUndefined)(r)){if(t&&r.nsid===e)return r;if(r.listId===e)return r}}},e.getListLevelNumber=function(e){return e.ownerBase instanceof o.a?e.ownerBase.levelNumber:e.ownerBase instanceof r.a&&!i.i(d.isNullOrUndefined)(e.ownerBase.levels)?e.ownerBase.levels.indexOf(e):-1},e.prototype.getImageString=function(e){var t=this.images.get(parseInt(e.imageString));return e.isMetaFile&&".svg"!==c.a.formatClippedString(t[0]).extension?t[1]:".tif"===c.a.formatClippedString(t[0]).extension?t[1]:t[0]},e.prototype.addBase64StringInCollection=function(e){return I(this,void 0,void 0,function(){var t,i,n,r,o;return F(this,function(s){for(t=this.images.length,i=!0,n=[],r=0;r<this.images.length;r++){if(o=this.images.get(r),e.isMetaFile&&e.metaFileImageString===o[0]){t=r,i=!1;break}if(e.imageString===o[0]){t=r,i=!1;break}}return i&&(e.isMetaFile?(n.push(e.metaFileImageString),n.push(""===e.imageString?e.metaFileImageString:e.imageString)):n.push(e.imageString),this.images.add(this.images.length,n)),e.isMetaFile&&(e.metaFileImageString=t.toString()),e.imageString=t.toString(),[2]})})},e.prototype.getBookmarks=function(e){for(var t=[],i=0;i<this.bookmarks.keys.length;i++){var n=this.bookmarks.keys[i];(e||0!==n.indexOf("_"))&&t.push(n)}return t},e.prototype.selectComment=function(e){var t=this;this.owner.selection&&this.owner.commentReviewPane&&(this.owner.showComments=!0,setTimeout(function(){t.owner&&t.owner.selection&&t.owner.selection.selectComment(e)}))},e.prototype.showComments=function(e){if(this.owner&&e&&this.owner.enableComment){var t={type:"Comment"};this.owner.trigger(m.e,t)}this.owner.commentReviewPane.reviewTab.hideTab(0,!1),this.owner.commentReviewPane.reviewTab.hideTab(1,!1),this.owner.commentReviewPane.showHidePane(e&&this.owner.enableComment,"Comments")},e.prototype.showRevisions=function(e){if(this.showRevision=e,this.owner&&e){var t={type:"comment"};this.owner.trigger(m.e,t)}!e&&this.owner.showComments?(this.owner.commentReviewPane.reviewTab.hideTab(0,!1),this.owner.commentReviewPane.showHidePane(!0,"Comments")):(this.owner.commentReviewPane.showHidePane(e,"Changes"),this.owner.enableComment||!0,this.showRevision=!1),e&&this.owner.trackChangesPane.enableDisableButton(!this.owner.isReadOnly&&!this.isDocumentProtected)},e.prototype.initializeComponents=function(){var e=this.owner.element;if(!i.i(d.isNullOrUndefined)(e)){this.optionsPaneContainer=i.i(d.createElement)("div",{className:"e-documenteditor-optionspane"}),this.optionsPaneContainer.contentEditable="false",e.appendChild(this.optionsPaneContainer);var t,n=this.owner.enableRtl;n&&(t="direction:ltr;"),this.viewerContainer=i.i(d.createElement)("div",{id:this.owner.containerId+"_viewerContainer"}),this.viewerContainer.style.cssText="position:relative;backgroundColor:#FBFBFB;overflow:auto;"+t,this.optionsPaneContainer.appendChild(this.viewerContainer),this.viewerContainer.tabIndex=-1,this.viewerContainer.style.outline="none",this.pageContainer=i.i(d.createElement)("div",{id:this.owner.containerId+"_pageContainer",className:"e-de-background"}),this.viewerContainer.appendChild(this.pageContainer),this.pageContainer.style.top="0px",this.pageContainer.style.left="0px",this.pageContainer.style.position="relative",this.pageContainer.style.pointerEvents="none",d.Browser.isDevice?this.createEditableDiv(e):this.createEditableIFrame(),this.owner.enableImageResizerMode&&this.owner.imageResizerModule.initializeImageResizer(),this.updateViewerSizeInternal(e),this.layout=new a.a(this),this.textHelper=new p.a(this),this.zoomModule=new g.a(this),this.initTouchEllipse(),this.wireEvent(),this.restrictEditingPane=new v.a(this),this.owner.commentReviewPane=new u.e(this.owner),this.owner.trackChangesPane=new w.a(this.owner,this.owner.commentReviewPane),i.i(f.createSpinner)({target:this.owner.element,cssClass:"e-spin-overlay"})}},e.prototype.measureScrollbarWidth=function(e){var t=document.createElement("div");t.setAttribute("style","visibility:hidden;overflow:scroll"),e.appendChild(t);var i=document.createElement("div");t.appendChild(i),this.scrollbarWidth=t.getBoundingClientRect().width-i.getBoundingClientRect().width,t.parentNode.removeChild(t)},e.prototype.createEditableDiv=function(e){this.editableDiv=document.createElement("div"),this.editableDiv.contentEditable=this.owner.isReadOnlyMode?"false":"true",this.editableDiv.style.position="fixed",this.editableDiv.style.left="-150em",this.editableDiv.style.width="100%",this.editableDiv.style.height="100%",this.editableDiv.id=e.id+"_editableDiv",document.body.appendChild(this.editableDiv)},e.prototype.createEditableIFrame=function(){this.iframe=i.i(d.createElement)("iframe",{attrs:{scrolling:"no",title:"Document Editor",style:"pointer-events:none;position:absolute;left:0px;top:0px;outline:none;background-color:transparent;width:0px;height:0px;overflow:hidden",tabindex:"0"},className:"e-de-text-target"}),this.viewerContainer.appendChild(this.iframe),this.initIframeContent()},e.prototype.initIframeContent=function(){var e="background-color:transparent;width:100%;height:100%;padding: 0px; margin: 0px;",t='<!DOCTYPE html><html lang="'+this.owner.locale+'"><head></head><body spellcheck="false" style='+e+' ><div contenteditable="true" style='+e+"></div></body></html>";i.i(d.isNullOrUndefined)(this.iframe.contentDocument)||(this.iframe.contentDocument.open(),this.iframe.contentDocument.write(t),this.iframe.contentDocument.close(),this.editableDiv=this.iframe.contentDocument.body.children[0])},e.prototype.wireEvent=function(){i.i(d.isNullOrUndefined)(this.selection)||this.selection.initCaret(),this.wireInputEvents(),i.i(d.isNullOrUndefined)(this.iframe)||this.iframe.addEventListener("load",this.onIframeLoad.bind(this)),this.viewerContainer.addEventListener("scroll",this.scrollHandler),this.viewerContainer.addEventListener("mousedown",this.onMouseDownInternal),this.viewerContainer.addEventListener("keydown",this.onKeyDownInternal),this.viewerContainer.addEventListener("mousemove",this.onMouseMoveInternal),this.viewerContainer.addEventListener("mouseleave",this.onMouseLeaveInternal),this.viewerContainer.addEventListener("mouseenter",this.onMouseEnterInternal),this.viewerContainer.addEventListener("contextmenu",this.onContextMenu),this.viewerContainer.addEventListener("dblclick",this.onDoubleTap),this.viewerContainer.addEventListener("mouseup",this.onMouseUpInternal),window.addEventListener("resize",this.onWindowResize),window.addEventListener("keyup",this.onKeyUpInternal),window.addEventListener("mouseup",this.onImageResizer),window.addEventListener("touchend",this.onImageResizer),this.viewerContainer.addEventListener("touchstart",this.onTouchStartInternal),this.viewerContainer.addEventListener("touchmove",this.onTouchMoveInternal),this.viewerContainer.addEventListener("touchend",this.onTouchUpInternal),void 0!==navigator&&navigator.userAgent.match("Firefox")&&this.viewerContainer.addEventListener("DOMMouseScroll",this.zoomModule.onMouseWheelInternal),this.viewerContainer.addEventListener("mousewheel",this.zoomModule.onMouseWheelInternal),this.editableDiv.addEventListener("focus",this.updateFocus)},e.prototype.wireInputEvents=function(){i.i(d.isNullOrUndefined)(this.editableDiv)||(this.editableDiv.addEventListener("paste",this.onPaste),d.Browser.isDevice?this.editableDiv.addEventListener("input",this.onTextInputInternal):(this.editableDiv.addEventListener("keypress",this.onKeyPressInternal),"chrome"===d.Browser.info.name&&this.editableDiv.addEventListener("textInput",this.onTextInput)),this.editableDiv.addEventListener("blur",this.onFocusOut),this.editableDiv.addEventListener("keydown",this.onKeyDownInternal),this.editableDiv.addEventListener("compositionstart",this.compositionStart),this.editableDiv.addEventListener("compositionupdate",this.compositionUpdated),this.editableDiv.addEventListener("compositionend",this.compositionEnd))},e.prototype.onIframeLoad=function(){i.i(d.isNullOrUndefined)(this.iframe)||0!==this.iframe.contentDocument.body.children.length||(this.initIframeContent(),this.wireInputEvents())},e.prototype.getEditableDivTextContent=function(){return this.editableDiv.textContent},e.prototype.updateAuthorIdentity=function(){for(var e=this.owner.revisions.changes,t=0;t<e.length;t++)this.getAuthorColor(e[t].author)},e.prototype.getAvatar=function(e,t,n,r){var o,s;if(i.i(d.isNullOrUndefined)(n)?o=r.author:(o=n.author,s=n.initial),!i.i(d.isNullOrUndefined)(o)){var a=i.i(d.createElement)("div",{className:"e-de-cmt-avatar"}),l=i.i(d.createElement)("div",{className:"e-de-ff-cmt-avatar"});if(l.style.backgroundColor=this.owner.documentHelper.getAuthorColor(o),""===s||i.i(d.isNullOrUndefined)(s)){var h=o.split(" "),c=h[0].charAt(0);h.length>1&&(c+=h[h.length-1][0]),l.innerText=c.toUpperCase()}else s.length>2?l.innerText=s.substring(0,2):l.innerText=s;a.appendChild(l),a.appendChild(t),e.appendChild(a)}},e.prototype.getAuthorColor=function(e){if(this.authors.containsKey(e))return this.authors.get(e);var t;return t=0===this.authors.length?"#b5082e":this.generateRandomColor(),this.authors.add(e,t),t},e.prototype.generateRandomColor=function(){return["#b5082e","#2e97d3","#bb00ff","#f37e43","#03a60b","#881824","#e09a2b","#50565e"][this.authors.length%8]},e.prototype.positionEditableTarget=function(){var e=this.selection.getRect(this.selection.start),t=this.selection.getSelectionPage(this.selection.start),i=t.bodyWidgets[0].sectionFormat,n=t.boundingRectangle.x+c.a.convertPointToPixel(i.leftMargin)*this.zoomFactor,r=e.y,o=i.pageWidth-i.leftMargin-i.rightMargin,s="left:"+n+"px;";s+="top:"+r+"px;",s+="width:"+c.a.convertPointToPixel(o)*this.zoomFactor+"px;",s+="height:250px;outline-style:none;position:absolute",this.iframe.setAttribute("style",s);var a="background-color:transparent;width:100%;height:250px;padding: 0px; margin: 0px;";a+="text-indent:"+(e.x-n)+"px;",a+="color:transparent;pointer-events:none;outline-style:none;",a+="font-size:"+c.a.convertPointToPixel(this.selection.characterFormat.fontSize)*this.zoomFactor+"px;",a+="font-family"+this.selection.characterFormat.fontFamily+";",a+="overflow:hidden;text-decoration:none;white-space:normal;",this.editableDiv.setAttribute("style",a)},e.prototype.initDialog=function(e){this.dialogInternal||(this.dialogTarget1=i.i(d.createElement)("div",{className:"e-de-dlg-target"}),this.dialogTarget1.contentEditable="false",document.body.appendChild(this.dialogTarget1),e&&this.dialogTarget1.classList.add("e-de-rtl"),this.dialogInternal=new f.Dialog({target:this.owner.documentEditorSettings.popupTarget,showCloseIcon:!0,allowDragging:!0,enableRtl:e,visible:!1,width:"1px",isModal:!0,position:{X:"center",Y:"center"},zIndex:this.owner.zIndex+20,animationSettings:{effect:"None"}}),this.dialogInternal.isStringTemplate=!0,this.dialogInternal.open=this.selection.hideCaret,this.dialogInternal.beforeClose=this.updateFocus,this.dialogInternal.appendTo(this.dialogTarget1))},e.prototype.initDialog3=function(e){this.dialogInternal3||(this.dialogTarget3=i.i(d.createElement)("div",{className:"e-de-dlg-target"}),this.dialogTarget3.contentEditable="false",document.body.appendChild(this.dialogTarget3),e&&this.dialogTarget3.classList.add("e-de-rtl"),this.dialogInternal3=new f.Dialog({target:this.owner.documentEditorSettings.popupTarget,showCloseIcon:!0,allowDragging:!0,enableRtl:e,visible:!1,width:"1px",isModal:!0,position:{X:"center",Y:"center"},zIndex:this.owner.zIndex,animationSettings:{effect:"None"}}),this.dialogInternal3.isStringTemplate=!0,this.dialogInternal3.open=this.selection.hideCaret,this.dialogInternal3.beforeClose=this.updateFocus,this.dialogInternal3.appendTo(this.dialogTarget3))},e.prototype.hideDialog=function(){this.dialog.hide(),this.updateFocus()},e.prototype.initDialog2=function(e){this.dialogInternal2||(this.dialogTarget2=i.i(d.createElement)("div",{className:"e-de-dlg-target"}),this.dialogTarget2.contentEditable="false",document.body.appendChild(this.dialogTarget2),e&&this.dialogTarget2.classList.add("e-de-rtl"),this.dialogInternal2=new f.Dialog({target:this.owner.documentEditorSettings.popupTarget,showCloseIcon:!0,allowDragging:!0,enableRtl:e,visible:!1,width:"1px",isModal:!0,position:{X:"center",Y:"Top"},zIndex:this.owner.zIndex+10}),this.dialogInternal2.isStringTemplate=!0,this.dialogInternal2.appendTo(this.dialogTarget2))},e.prototype.getBase64=function(e,t,i){return I(this,void 0,void 0,function(){return F(this,function(n){return[2,new Promise(function(n,r){var o="",s=new Image;s.onload=function(){var e=Math.max(1,window.devicePixelRatio||1),r=document.createElement("canvas");r.width=t*e,r.height=i*e;var a=r.getContext("2d");a.scale(e,e),a.drawImage(s,0,0,t,i),o=r.toDataURL("image/png",1),n(o)},e&&(c.a.startsWith(e,"http://")||c.a.startsWith(e,"https://"))&&fetch(e).then(function(e){return e.blob()}).then(function(e){return new Promise(function(t,i){var n=new FileReader;n.onloadend=function(){return t(n.result)},n.onerror=i,n.readAsDataURL(e)})}).then(function(e){s.src=e})})]})})},e.prototype.clearContent=function(){if(this.containerContext.clearRect(0,0,this.containerCanvas.width,this.containerCanvas.height),this.selectionContext.clearRect(0,0,this.selectionCanvas.width,this.selectionCanvas.height),this.pageContainer)for(var e=this.pageContainer.getElementsByClassName("e-de-cmt-mark"),t=0;t<e.length;t++)e[t].style.display="none";if(this.pageContainer)for(var i=this.pageContainer.getElementsByClassName("e-de-lock-mark"),t=0;t<i.length;t++)i[t].style.display="none"},e.prototype.onDocumentChanged=function(e,t){var n=this;this.clearContent(),this.owner.editorModule&&(this.owner.editorModule.tocStyles={},this.owner.editorModule.tocBookmarkId=0),this.heightInfoCollection={},this.owner.isDocumentLoaded=!1,this.viewer.columnLayoutArea.clear(),this.layout.isDocumentContainsRtl=!1,this.layout.isMultiColumnDoc=!1,this.updateAuthorIdentity();for(var r=0;r<this.pages.length;r++)for(var o=0;o<this.pages[r].bodyWidgets.length;o++)this.pages[r].bodyWidgets[o].destroy();if(this.pages=[],i.i(d.isNullOrUndefined)(this.renderedLists)||this.renderedLists.clear(),i.i(d.isNullOrUndefined)(this.renderedLevelOverrides)||(this.renderedLevelOverrides=[]),i.i(d.isNullOrUndefined)(this.owner.editorHistory)||this.owner.editorHistory.destroy(),this.owner.isDocumentLoaded=!0,this.layout.isInitialLoad=!0,this.layout.footHeight=0,this.layout.footnoteHeight=0,this.layout.layoutItems(e,!1),this.owner.selection&&(this.selection.previousSelectedFormField=void 0,this.formFields.length>0&&this.owner.selection.highlightFormFields(),this.owner.selection.editRangeCollection=[],this.owner.selection.selectRange(this.owner.documentStart,this.owner.documentStart),this.isDocumentProtected&&"FormFieldsOnly"==this.protectionType&&this.owner.selection.navigateToNextFormField(),this.isDocumentProtected&&this.restrictEditingPane.showHideRestrictPane(!0)),this.owner.enableCollaborativeEditing&&this.owner.collaborativeEditingHandlerModule&&this.owner.enableEditor){if(this.owner.editor.isRemoteAction=!0,this.owner.editor.isIncrementalSave=!0,t&&!i.i(d.isNullOrUndefined)(t[m.f[0]])&&!i.i(d.isNullOrUndefined)(t[m.f[0]].length>0))for(var s=0;s<t[m.f[0]].length;s++)this.owner.collaborativeEditingHandlerModule.applyRemoteAction("action",t[m.f[0]][s]);this.owner.editor.isRemoteAction=!1,this.owner.editor.isIncrementalSave=!1,this.owner.selection.selectRange(this.owner.documentStart,this.owner.documentStart)}this.owner.optionsPaneModule&&this.owner.optionsPaneModule.showHideOptionsPane(!1),this.restrictEditingPane.restrictPane&&!this.isDocumentProtected&&this.restrictEditingPane.showHideRestrictPane(!1),!i.i(d.isNullOrUndefined)(this.owner.selection)&&this.owner.selection.isViewPasteOptions&&(this.owner.selection.isViewPasteOptions=!1,this.owner.selection.showHidePasteOptions(void 0,void 0)),this.owner.fireDocumentChange(),setTimeout(function(){!i.i(d.isNullOrUndefined)(n.owner)&&n.owner.showRevisions&&n.showRevisions(!0)})},e.prototype.initTouchEllipse=function(){var e="height: 30px;width: 30px;position: absolute;background-color: transparent;margin: 0px;padding: 0px;z-index:5",t=" height: 12px;width: 12px;border-radius: 50%;background-color: white;position: absolute;margin: 0px 6px 0px 6px;border-width: 2px;border-style: solid;border-color: #000000;box-sizing: unset;";this.touchStart=i.i(d.createElement)("div",{className:"e-touch-ellipse",styles:e});var n=i.i(d.createElement)("div",{styles:t});this.touchEnd=i.i(d.createElement)("div",{className:"e-touch-ellipse",styles:e}),this.touchStart.style.display="none";var r=i.i(d.createElement)("div",{styles:t});this.touchStart.appendChild(n),this.touchEnd.appendChild(r),this.touchEnd.style.display="none",this.viewerContainer.appendChild(this.touchStart),this.viewerContainer.appendChild(this.touchEnd)},e.prototype.updateTouchMarkPosition=function(){if("none"!==this.touchStart.style.display&&!i.i(d.isNullOrUndefined)(this.selection))if(this.selection.isEmpty)this.selection.updateCaretPosition();else{var e=this.selection.getCaretBottom(this.selection.start,!1),t=this.selection.getPage(this.selection.start.paragraph),n=t.boundingRectangle.y-this.owner.viewer.pageGap*(this.pages.indexOf(t)+1)*this.zoomFactor+this.owner.viewer.pageGap*(this.pages.indexOf(t)+1);this.touchStart.style.left=t.boundingRectangle.x+(Math.round(this.selection.start.location.x)*this.zoomFactor-14)+"px",this.touchStart.style.top=n+e*this.zoomFactor+"px",this.selection.isEmpty||(e=this.selection.getCaretBottom(this.selection.end,!1),t=this.selection.getPage(this.selection.end.paragraph)),this.touchEnd.style.left=t.boundingRectangle.x+(Math.round(this.selection.end.location.x)*this.zoomFactor-14)+"px",this.touchEnd.style.top=n+e*this.zoomFactor+"px"}},e.prototype.autoScrollOnSelection=function(e){var t=this;this.scrollMoveTimer&&(e.y<=0||e.y>50||e.y<this.viewerContainer.offsetHeight-50)?(clearInterval(this.scrollMoveTimer),this.scrollMoveTimer=0):e.y<60?(clearInterval(this.scrollMoveTimer),this.scrollMoveTimer=setInterval(function(){t.viewerContainer.scrollTop-=20,setTimeout(function(){var i=t.owner.viewer.findFocusedPage(e,!t.owner.enableHeaderAndFooter),n=t.getLineWidget(i);t.selection.updateTextPosition(n,i)},200)},200)):e.y>this.viewerContainer.offsetHeight-70&&(clearInterval(this.scrollMoveTimer),this.scrollMoveTimer=setInterval(function(){t.viewerContainer.scrollTop+=20,setTimeout(function(){var i=t.owner.viewer.findFocusedPage(e,!t.owner.enableHeaderAndFooter),n=t.getLineWidget(i);t.selection.updateTextPosition(n,i)},200)},200))},e.prototype.scrollForwardOnSelection=function(e){if(this.viewerContainer){this.viewerContainer.scrollTop=this.viewerContainer.scrollTop+200;var t=this.owner.viewer.findFocusedPage(e,!this.owner.enableHeaderAndFooter),i=this.owner.selection.end;this.owner.enableImageResizerMode&&this.owner.imageResizerModule.isImageResizerVisible&&!this.owner.imageResizerModule.isShapeResize||(this.skipScrollToPosition=!0,this.owner.selection.moveTextPosition(t,i,!0))}},e.prototype.scrollBackwardOnSelection=function(e){this.viewerContainer.scrollTop=this.viewerContainer.scrollTop-200;var t=this.owner.viewer.findFocusedPage(e,!this.owner.enableHeaderAndFooter),i=this.owner.selection.end;this.owner.enableImageResizerMode&&this.owner.imageResizerModule.isImageResizerVisible&&!this.owner.imageResizerModule.isShapeResize||(this.skipScrollToPosition=!0,this.owner.selection.moveTextPosition(t,i,!0))},e.prototype.moveSelectedContent=function(){this.isDragStarted=!1;var e=this.selection.getParagraphInfo(this.selection.start),t=this.selection.getParagraphInfo(this.selection.end),i=this.selection.getHierarchicalIndex(e.paragraph,e.offset.toString()),n=this.selection.getHierarchicalIndex(t.paragraph,t.offset.toString()),r=this.selection.getTextPosBasedOnLogicalIndex(i),o=this.selection.getTextPosBasedOnLogicalIndex(n),s=this.selection.getHierarchicalIndex(this.dragStartParaInfo.paragraph,this.dragStartParaInfo.offset.toString()),a=this.selection.getHierarchicalIndex(this.dragEndParaInfo.paragraph,this.dragEndParaInfo.offset.toString()),l=this.selection.getTextPosBasedOnLogicalIndex(s),d=this.selection.getTextPosBasedOnLogicalIndex(a);if(r.isExistBefore(l)||o.isExistAfter(d)){this.owner.editor.initComplexHistory("DragAndDropContent"),this.selection.start=l,this.selection.end=d;var h=this.owner.enableLocalPaste;h||(this.owner.enableLocalPaste=!0);var c=this.dragEndParaInfo.paragraph.getLength(),p=!1;(c<this.dragEndParaInfo.offset||!this.dragStartParaInfo.paragraph.equals(this.dragEndParaInfo.paragraph))&&(p=!0),this.owner.editor.cut(),this.dragEndParaInfo.paragraph.equals(e.paragraph)&&this.dragEndParaInfo.offset<e.offset&&!this.owner.enableTrackChanges&&(c-=this.dragEndParaInfo.paragraph.getLength(),e.offset-=c,t.offset-=c,i=this.selection.getHierarchicalIndex(e.paragraph,e.offset.toString()),n=this.selection.getHierarchicalIndex(t.paragraph,t.offset.toString())),p&&this.dragEndParaInfo.paragraph.equals(t.paragraph)||(i=this.selection.getHierarchicalIndex(e.paragraph,e.offset.toString()),n=this.selection.getHierarchicalIndex(t.paragraph,t.offset.toString())),r=this.selection.getTextPosBasedOnLogicalIndex(i),o=this.selection.getTextPosBasedOnLogicalIndex(n),this.selection.start=r,this.selection.end=o,this.owner.editor.copiedTextContent="",this.owner.editor.paste(),h||(this.owner.enableLocalPaste=!1),this.owner.editorHistory.updateComplexHistory()}else this.owner.selection.selectPosition(l,d);this.dragStartParaInfo=void 0,this.dragEndParaInfo=void 0,this.selection.caret.classList.add("e-de-cursor-animation")},e.prototype.isSelectionInListText=function(e){var t=this.getLineWidget(e);if(!i.i(d.isNullOrUndefined)(t)&&t.children[0]instanceof h.q){var n=this.getLeftValue(t),r=t.children[0].width,o=t.children[0].height;if(this.isInsideRect(n,t.paragraph.y,r,o,e))return this.selectionLineWidget=t,!0}return!1},e.prototype.isInShapeBorder=function(e,t){if(!i.i(d.isNullOrUndefined)(e)){var n=e.width,r=e.height;if(this.isInsideRect(e.x-e.margin.left,e.y-e.margin.top,n,r,t)){if(e instanceof h.r)return!0;if(e instanceof h.s){var o=e.lineFormat.weight;if(!this.isInsideRect(e.x+o,e.y+o+e.textFrame.marginTop,n-2*o,r-(2*o+e.textFrame.marginTop+e.textFrame.marginBottom),t))return!0}}}return!1},e.prototype.isInsideRect=function(e,t,i,n,r){return r.x>e&&r.x<=e+i&&r.y>t&&r.y<=t+n},e.prototype.getLeftValue=function(e){var t=e.paragraph.x,i=e.paragraph.paragraphFormat;this.selection.isParagraphFirstLine(e)&&("Right"===i.textAlignment?(t-=c.a.convertPointToPixel(i.firstLineIndent),t-=c.a.convertPointToPixel(i.leftIndent)):t+=c.a.convertPointToPixel(i.firstLineIndent));var n=e.children[0];return n instanceof h.q&&(t+=n.margin.left),t},e.prototype.isLeftButtonPressed=function(e){return this.isTouchInput=!1,1===(e.which||e.button)},e.prototype.updateSelectionOnTouch=function(e,t){this.zoomX=void 0,this.zoomY=void 0,!this.isMouseDown||this.isSelectionChangedOnMouseMoved||i.i(d.isNullOrUndefined)(this.currentPage)||i.i(d.isNullOrUndefined)(this.owner.selection.start)||(i.i(d.isNullOrUndefined)(this.currentSelectedComment)||!this.owner.commentReviewPane||this.owner.commentReviewPane.commentPane.isEditMode||(this.currentSelectedComment=void 0),0===this.touchDownOnSelectionMark&&(this.updateTextPositionForSelection(new c.b(t.x,t.y),this.tapCount),2===this.tapCount&&this.selection.checkAndEnableHeaderFooter(e,t)),this.owner.selection.isEmpty&&this.selection.updateCaretPosition(),this.selection.checkForCursorVisibility())},e.prototype.getTouchOffsetValue=function(e){var t=this.viewerContainer,n=t.getBoundingClientRect(),r=e.touches[0];i.i(d.isNullOrUndefined)(r)&&(r=e.changedTouches[0]);var o=r.pageX-n.left,s=r.pageY-n.top;return new c.b(o,s)},e.prototype.onPinchInInternal=function(e){this.preZoomFactor=this.zoomFactor;var t=this.zoomFactor-.01;t<5&&t>2&&(t-=.01),t<.1&&(t=.1),this.zoomFactor=t},e.prototype.onPinchOutInternal=function(e){this.preZoomFactor=this.zoomFactor;var t=this.zoomFactor+.01;t>2&&(t+=.01),t>5&&(t=5),this.zoomFactor=t},e.prototype.getPageWidth=function(e){return e.boundingRectangle.width},e.prototype.removePage=function(e){this.currentPage===e&&(this.currentPage=void 0),e.headerWidgetIn&&(e.headerWidgetIn.page=void 0),e.footerWidgetIn&&(e.footerWidgetIn.page=void 0);var t=this.pages.indexOf(e);if(t>-1&&this.pages.splice(t,1),!i.i(d.isNullOrUndefined)(this.owner.viewer.visiblePages)&&this.owner.viewer.visiblePages.indexOf(e)>-1){var n=this.owner.viewer.visiblePages.indexOf(e);this.owner.viewer.visiblePages.splice(n,1)}for(var r=0,o=0;o<this.pages.length;o++)r+=this.pages[o].boundingRectangle.height;r-=e.boundingRectangle.height+20;var s=20;if(t>0&&(s+=this.pages[t-1].boundingRectangle.bottom),-1!==t)for(var o=t;o<this.pages.length;o++)e=this.pages[o],e.boundingRectangle=new h.t(e.boundingRectangle.x,s,e.boundingRectangle.width,e.boundingRectangle.height),s=e.boundingRectangle.bottom+20,i.i(d.isNullOrUndefined)(e.bodyWidgets[0].firstChild)||e.bodyWidgets[0].firstChild instanceof h.u&&e.bodyWidgets[0].firstChild.header||(e.repeatHeaderRowTableWidget=!1)},e.prototype.updateViewerSize=function(){var e=this,t=this.owner.getDocumentEditorElement();this.updateViewerSizeInternal(t),this.owner.viewer.updateScrollBars(),this.owner.viewer instanceof S&&!i.i(d.isNullOrUndefined)(this.owner)&&!i.i(d.isNullOrUndefined)(t)&&(this.resizerTimer&&clearTimeout(this.resizerTimer),this.resizerTimer=setTimeout(function(){if(!i.i(d.isNullOrUndefined)(e.owner)){var t=void 0;t=i.i(d.isNullOrUndefined)(e.visibleBounds)?0:e.visibleBounds.width,i.i(d.isNullOrUndefined)(e.owner.viewer.preVisibleWidth)&&(e.owner.viewer.preVisibleWidth=0),i.i(d.isNullOrUndefined)(e.visibleBounds)||t===e.owner.viewer.preVisibleWidth||(e.owner.editorModule.layoutWholeDocument(),e.owner.viewer.preVisibleWidth=t),e.resizerTimer&&clearTimeout(e.resizerTimer)}},50)),i.i(d.isNullOrUndefined)(this.selection)||this.selection.updateCaretPosition()},e.prototype.triggerAutoResizeInterval=function(){var e=this,t=0,n=this.owner.element,r={cancel:!1};this.owner.notify(x.g,r),i.i(d.isNullOrUndefined)(r.element)||(n=r.element),n.style.visibility="hidden",i.i(f.showSpinner)(n);var o=0,s=this.owner.documentEditorSettings.autoResizeSettings.interval;this.isAutoResizeCanStart?t=setInterval(function(){o++;var r=e.owner.element.getBoundingClientRect();if(0!==r.width&&0!==r.height){e.isAutoResizeCanStart=!1;var s={cancel:!1};e.owner.notify(x.f,s),clearInterval(t),s.cancel||e.owner.resize(),i.i(f.hideSpinner)(n),n.style.visibility="visible"}else o>e.owner.documentEditorSettings.autoResizeSettings.iterationCount&&(clearInterval(t),i.i(f.hideSpinner)(n),n.style.visibility="visible")},s):(i.i(f.hideSpinner)(n),n.style.visibility="visible")},e.prototype.updateViewerSizeInternal=function(e){if(!i.i(d.isNullOrUndefined)(e)){var t=e.getBoundingClientRect();0===t.width&&0===t.height?this.isAutoResizeCanStart=!0:this.isAutoResizeCanStart=!1;var n=0,r=0;r=t.height>0?t.height:200;var o=this.restrictEditingPane&&this.restrictEditingPane.isShowRestrictPane?this.restrictEditingPane.restrictPane.getBoundingClientRect():void 0,s=this.owner.optionsPaneModule&&this.owner.optionsPaneModule.isOptionsPaneShow?this.owner.optionsPaneModule.optionsPane.getBoundingClientRect():void 0,a=this.owner.commentReviewPane&&this.owner.commentReviewPane.parentPaneElement?this.owner.commentReviewPane.parentPaneElement.getBoundingClientRect():void 0;if(o||s||a){var l=o?o.width:0;l+=s?s.width:0,l+=a?a.width:0,n=t.width-l>0?t.width-l:200}else n=t.width>0?t.width:200;this.viewerContainer.style.height=r.toString()+"px",this.viewerContainer.style.width=Math.ceil(n)+"px",this.visibleBoundsIn=new h.t(0,0,n,r),this.containerCanvas.width=n,this.containerCanvas.height=r,this.selectionCanvas.width=n,this.selectionCanvas.height=r,this.measureScrollbarWidth(e)}},e.prototype.insertPage=function(e,t){this.pages.indexOf(t)>-1&&this.pages.splice(this.pages.indexOf(t),1),this.pages.splice(e,0,t);var i=20;e>0&&(i+=this.pages[e-1].boundingRectangle.bottom);for(var n=e;n<this.pages.length;n++)t=this.pages[n],t.boundingRectangle=new h.t(t.boundingRectangle.x,i,t.boundingRectangle.width,t.boundingRectangle.height),i=t.boundingRectangle.bottom+20},e.prototype.updateTextPositionForSelection=function(e,t){var n=this.getLineWidget(e);if(i.i(d.isNullOrUndefined)(n)||this.selection.updateTextPosition(n,e),t>1){if(this.isMouseDown=!1,this.useTouchSelectionMark=!1,0===this.pages.length)return;i.i(d.isNullOrUndefined)(this.currentPage)||i.i(d.isNullOrUndefined)(this.owner.selection.start)||(t%2==0?this.owner.selection.selectCurrentWord():this.isDragStarted||this.owner.selection.selectParagraph())}},e.prototype.scrollToPosition=function(e,t,n,r){if(this.skipScrollToPosition||this.isWebPrinting||this.owner.editor&&this.owner.editor.isRemoteAction)return void(this.skipScrollToPosition=!1);if(!(this.owner.enableImageResizerMode&&this.owner.imageResizerModule.isImageResizing||this.isMouseDownInFooterRegion||this.isRowOrCellResizing)){var o=this.selection.getLineWidgetInternal(t.currentWidget,t.offset,!0);if(!i.i(d.isNullOrUndefined)(o)){this.selection.getTop(o);if(this.isMouseDown){var s=this.selection.getLineWidgetInternal(t.currentWidget,t.offset,!1),a=this.selection.getTop(s);s!==o&&t.location.y>=a&&(o=s)}var l=(o.height,this.selection.getPage(o.paragraph));this.currentPage=l;var h=0,c=0;this.owner.viewer,this.owner.viewer;if(!i.i(d.isNullOrUndefined)(l)){var p=l.boundingRectangle.width;h=(this.visibleBounds.width-p*this.zoomFactor)/2,h<30&&(h=30),c=l.boundingRectangle.y*this.zoomFactor+(this.pages.indexOf(l)+1)*this.owner.viewer.pageGap*(1-this.zoomFactor);var u=this.owner.viewer.containerTop,g=this.owner.viewer.containerLeft,f=this.visibleBounds.height,m=this.selection.updateCaretSize(this.owner.selection.end,!0),v=m.topMargin,y=m.height;h+=t.location.x*this.zoomFactor,c+=(t.location.y+v)*this.zoomFactor,r?this.viewerContainer.scrollTop=c-96:u+20>c?this.viewerContainer.scrollTop=c-10:u+f<c+y&&(this.viewerContainer.scrollTop=c+y-f+10),n||this.selection.updateCaretToPage(e,l);var w=this.viewerContainer.offsetWidth-this.viewerContainer.clientWidth;if(g>h)this.viewerContainer.scrollLeft=h-this.pageContainer.offsetWidth/100*20;else if(g+this.visibleBounds.width<h+w)for(this.viewerContainer.scrollLeft=g+this.pageContainer.offsetWidth/100*15+w;h<this.owner.viewer.containerWidth&&this.viewerContainer.scrollLeft+this.visibleBounds.width<h+w;)this.viewerContainer.scrollLeft=this.viewerContainer.scrollLeft+this.pageContainer.offsetWidth/100*15+w}}}},e.prototype.getLineWidget=function(e){return this.getLineWidgetInternal(e,!1)},e.prototype.getLineWidgetInternal=function(e,t){var n=void 0;if(!i.i(d.isNullOrUndefined)(this.currentPage)){var r=void 0;if(this.owner.enableHeaderAndFooter){var o=this.currentPage,s=o.boundingRectangle.height,a=Math.max(o.headerWidget.y+o.headerWidget.height,c.a.convertPointToPixel(o.bodyWidgets[0].sectionFormat.topMargin))*this.zoomFactor,l=c.a.convertPointToPixel(o.bodyWidgets[0].sectionFormat.footerDistance),p=o.boundingRectangle.height-Math.max(o.footerWidget.height+l,2*l);if(t?r=this.isBlockInHeader(this.selection.start.paragraph)?this.currentPage.headerWidget:this.currentPage.footerWidget:e.y<=s&&e.y>=p?r=this.currentPage.footerWidget:e.y>=0&&e.y<=a&&(r=this.currentPage.headerWidget),i.i(d.isNullOrUndefined)(r))return;var u=this.checkFloatingItems(r,e,t);return u.isShapeSelected?u.isInShapeBorder?u.element.line:this.selection.getLineWidgetBodyWidget(u.element.textFrame,e):this.selection.getLineWidgetBodyWidget(r,e)}for(var g=void 0,f=void 0,m=0;m<this.currentPage.bodyWidgets.length;m++){var v=this.currentPage.bodyWidgets[m];if(g=this.checkFloatingItems(v,e,t,!1),f=this.checkFloatingItems(v,e,t,!0),g.isShapeSelected||f.isShapeSelected)break}if(g.isShapeSelected&&!this.isEmptyShape(g)){if(g.isInShapeBorder)return g.element.line;g.element instanceof h.s&&(n=this.selection.getLineWidgetBodyWidget(g.element.textFrame,e))}else if(t&&this.isFootnoteWidget){if(void 0!==this.selection.start.paragraph.bodyWidget.footNoteReference&&this.selection.start.paragraph.bodyWidget.containerWidget instanceof h.a&&"Footnote"===this.selection.start.paragraph.bodyWidget.containerWidget.footNoteType)return this.selection.getLineWidgetBodyWidget(this.currentPage.footnoteWidget,e);if(void 0!==this.selection.start.paragraph.bodyWidget.footNoteReference&&this.selection.start.paragraph.bodyWidget.containerWidget instanceof h.a&&"Endnote"===this.selection.start.paragraph.bodyWidget.containerWidget.footNoteType)return this.selection.getLineWidgetBodyWidget(this.currentPage.endnoteWidget,e)}else{if(!t&&this.currentPage.footnoteWidget&&this.isInFootnoteWidget(this.currentPage.footnoteWidget,e))(n=this.selection.getLineWidgetBodyWidget(this.currentPage.footnoteWidget,e))&&(this.isFootnoteWidget=!0);else if(!t&&this.currentPage.endnoteWidget&&this.isInFootnoteWidget(this.currentPage.endnoteWidget,e))(n=this.selection.getLineWidgetBodyWidget(this.currentPage.endnoteWidget,e))&&(this.isFootnoteWidget=!0);else for(var y=0;y<this.currentPage.bodyWidgets.length;y++){var w=this.currentPage.bodyWidgets[y];if(y<this.currentPage.bodyWidgets.length-1&&e.x<=w.x+w.width&&(n=this.selection.getLineWidgetBodyWidget(w,e,!0),!i.i(d.isNullOrUndefined)(n)&&n.paragraph.y<=e.y&&n.paragraph.y+n.paragraph.height>=e.y)){this.isFootnoteWidget=!1;break}if(e.x>w.x+w.width&&this.layout.getNextWidgetHeight(w)>=e.y&&w.y<=e.y&&(i.i(d.isNullOrUndefined)(w.nextRenderedWidget)||!(this.layout.getNextWidgetHeight(w.nextRenderedWidget)>=e.y&&w.nextRenderedWidget.y<=e.y))&&(n=this.selection.getLineWidgetBodyWidget(w,e,!0),!i.i(d.isNullOrUndefined)(n)&&n.paragraph.y<=e.y&&n.paragraph.y+n.paragraph.height>=e.y)){this.isFootnoteWidget=!1;break}if(y==this.currentPage.bodyWidgets.length-1&&(n=this.selection.getLineWidgetBodyWidget(w,e,!0),!i.i(d.isNullOrUndefined)(n)&&n.paragraph.y<=e.y&&n.paragraph.y+n.paragraph.height>=e.y)){this.isFootnoteWidget=!1;break}if(e.x<w.x&&y<this.currentPage.bodyWidgets.length-1){if(n=this.selection.getLineWidgetBodyWidget(w,e,!0),!i.i(d.isNullOrUndefined)(n)&&n.paragraph.y<=e.y&&n.paragraph.y+n.paragraph.height>=e.y){this.isFootnoteWidget=!1;break}if(!i.i(d.isNullOrUndefined)(n)&&y===this.currentPage.bodyWidgets.length-1){this.isFootnoteWidget=!1;break}}}var b=this.checkInlineShapeItems(n,e,t);if(b.isShapeSelected){if(b.isInShapeBorder)return b.element.line;b.element instanceof h.s&&(n=this.selection.getLineWidgetBodyWidget(b.element.textFrame,e))}else if(!this.checkPointIsInLine(n,e)&&f.isShapeSelected){if(f.isInShapeBorder)return f.element.line;f.element instanceof h.s&&(n=this.selection.getLineWidgetBodyWidget(f.element.textFrame,e))}}}return n},e.prototype.checkInlineShapeItems=function(e,t,n){var r,o=!1,s=!1,a=this.selection.isInShape,l=n&&a;if(!i.i(d.isNullOrUndefined)(e)&&e.children.length>0)if(l){var c=this.owner.selection.getCurrentTextFrame();c&&(r=c.containerShape,o=!0)}else{for(var p=0;p<e.children.length;p++)if(e.children[p]instanceof h.s&&"Inline"===e.children[p].textWrappingStyle&&(r=e.children[p],t.x<r.x+r.margin.left+r.width&&t.x>r.x&&t.y<r.y+r.margin.top+r.height&&t.y>r.y)){o=!0,this.isInShapeBorder(r,t)&&(s=!0);break}n&&!a&&(o=!1)}return{element:r,caretPosition:t,isInShapeBorder:s,isShapeSelected:o}},e.prototype.checkPointIsInLine=function(e,t){if(!i.i(d.isNullOrUndefined)(e)&&e.children.length>0)for(var n=void 0,r=e.paragraph.x,o=this.selection.getTop(e),s=e.children.indexOf(e.children[0]);s<e.children.length;s++)if(!((n=e.children[s])instanceof h.v&&"Inline"!==n.textWrappingStyle)){if(t.x<r+n.margin.left+n.width+n.padding.left&&t.x>r&&t.y<o+e.height&&t.y>o)return!0;r+=n.margin.left+n.width+n.padding.left}return!1},e.prototype.isInFootnoteWidget=function(e,t){for(var i=0;i<e.bodyWidgets.length;i++)for(var n=0;n<e.bodyWidgets[i].childWidgets.length;n++){var r=e.bodyWidgets[i].childWidgets[n];if(r instanceof h.w&&r.y<=t.y&&r.y+r.height>=t.y)return!0}return!1},e.prototype.checkFloatingItems=function(e,t,n,r){var o,s=!1,a=!1,l=this.selection.isInShape,c=n&&l;if(e.floatingElements.length>0){this.currentPage;if(e.floatingElements.sort(function(e,t){return e instanceof h.u||t instanceof h.u?0:e.zOrderPosition-t.zOrderPosition}),c){var p=this.owner.selection.getCurrentTextFrame();p&&(o=p.containerShape,s=!0)}else{for(var u=e.floatingElements.length-1;u>=0;u--)if(!(e.floatingElements[u]instanceof h.u||(!i.i(d.isNullOrUndefined)(r)&&r?"Behind"!==e.floatingElements[u].textWrappingStyle:"Behind"===e.floatingElements[u].textWrappingStyle))&&(o=e.floatingElements[u],t.x<o.x+o.margin.left+o.width&&t.x>o.x&&t.y<o.y+o.margin.top+o.height&&t.y>o.y)){s=!0,this.isInShapeBorder(o,t)&&(a=!0);break}n&&!l&&(s=!1)}}return{element:o,caretPosition:t,isShapeSelected:s,isInShapeBorder:a}},e.prototype.isBlockInHeader=function(e){for(;!(e.containerWidget instanceof h.x);){if(!e.containerWidget)return!1;e=e.containerWidget,e instanceof h.i&&(e=e.containerShape.paragraph)}return-1!==e.containerWidget.headerFooterType.indexOf("Header")},e.prototype.clearSelectionHighlight=function(){!this.isControlPressed||this.isMouseDown,this.owner.selection.clearSelectionHighlightInSelectedWidgets()&&this.selectionContext.clearRect(0,0,this.selectionCanvas.width,this.selectionCanvas.height)},e.prototype.removeEmptyPages=function(){for(var e=!1,t=this.selection.startPage-1,n=0;n<this.pages.length;n++){for(var r=this.pages[n],o=0;o<r.bodyWidgets.length;o++)if((0===r.bodyWidgets.length||0===r.bodyWidgets[o].childWidgets.length)&&r.bodyWidgets.length>=1){var s=r.bodyWidgets.indexOf(r.bodyWidgets[o]);r.bodyWidgets.splice(s,1),o--}r.bodyWidgets.length<=0&&(n===this.pages.length-1&&this.owner.viewer instanceof T&&-1!==this.owner.viewer.visiblePages.indexOf(this.pages[n])&&(e=!0),this.removePage(this.pages[n]),n--)}if(!i.i(d.isNullOrUndefined)(this.pages[t])){var r=this.pages[t];r.headerWidget&&(r.headerWidget.page=r),r.footerWidget&&(r.footerWidget.page=r)}e&&this.scrollToBottom()},e.prototype.scrollToBottom=function(){if(this.selection.start.paragraph&&this.selection.start.paragraph.bodyWidget){var e=this.selection.start.paragraph.bodyWidget.page,t=this.visibleBounds.height;this.viewerContainer.scrollTop=e.boundingRectangle.bottom-t}},e.prototype.getFieldResult=function(e,t){if(!i.i(d.isNullOrUndefined)(t)&&!i.i(d.isNullOrUndefined)(this.selection)&&!i.i(d.isNullOrUndefined)(e)){var n=this.selection.getFieldCode(e),r=n.split("*"),o=r[0].replace(/[^\w\s]/gi,"").trim().toLowerCase(),s="";switch(r.length>1&&" MERGEFORMAT"!==r[1]&&(s=r[1].replace(/[^\w\s]/gi,"").trim()),""==s&&(s=t.bodyWidgets[0].sectionFormat.pageNumberStyle),-1!==o.indexOf(" ")&&(o=o.split(" ")[0]),o){case"page":if(t.bodyWidgets[0].sectionFormat.restartPageNumbering&&0!==t.sectionIndex){var a=t.sectionIndex,l=t.previousPage;return this.isRestartNumbering=!0,a!==l.sectionIndex&&l.bodyWidgets[l.bodyWidgets.length-1].sectionIndex!==a?(t.currentPageNum=t.bodyWidgets[0].sectionFormat.pageStartingNumber,this.getFieldText(s,t.currentPageNum)):(1===l.currentPageNum&&a!==l.sectionIndex&&(l.currentPageNum=t.bodyWidgets[0].sectionFormat.pageStartingNumber),t.currentPageNum=l.currentPageNum+1,this.getFieldText(s,t.currentPageNum))}return t.bodyWidgets[0].sectionFormat.restartPageNumbering&&0===t.sectionIndex?(t.currentPageNum=t.bodyWidgets[0].sectionFormat.pageStartingNumber+t.index,this.getFieldText(s,t.currentPageNum)):(!i.i(d.isNullOrUndefined)(t.previousPage)&&(t.previousPage.bodyWidgets[0].sectionFormat.restartPageNumbering&&1===t.previousPage.currentPageNum||this.isRestartNumbering&&1!==t.previousPage.currentPageNum)?(t.previousPage.bodyWidgets[0].sectionFormat.restartPageNumbering&&(this.isRestartNumbering=!0),t.currentPageNum=t.previousPage.currentPageNum+1):t.currentPageNum=t.index+1,this.getFieldText(s,t.currentPageNum));case"numpages":return this.getFieldText(s,t.documentHelper.pages.length);case"sectionpages":for(var h=t.sectionIndex,c=0,p=0;p<t.documentHelper.pages.length;p++)if(t.documentHelper.pages[p].sectionIndex===h)c++;else if(0!==c)break;return this.getFieldText(s,c)}}return""},e.prototype.getFieldText=function(e,t){switch(e){case"ALPHABETIC":return this.layout.getAsLetter(t).toUpperCase();case"alphabetic":return this.layout.getAsLetter(t).toLowerCase();case"roman":return this.layout.getAsRoman(t).toLowerCase();case"ROMAN":case"RomanUpper":return this.layout.getAsRoman(t).toUpperCase();case"RomanLower":return this.layout.getAsRoman(t).toLowerCase();case"LetterUpper":return this.layout.getAsLetter(t).toUpperCase();case"LetterLower":return this.layout.getAsLetter(t).toLowerCase();default:return t.toString()}},e.prototype.isEmptyShape=function(e){return e.element instanceof h.r||0===e.element.textFrame.childWidgets.length},e.prototype.destroy=function(){if(i.i(d.isNullOrUndefined)(this.owner)||this.unWireEvent(),this.styles&&(this.styles.destroy(),this.styles=void 0),this.stylesMap&&(this.stylesMap.destroy(),this.stylesMap=void 0),this.characterFormat&&(this.characterFormat.destroy(),this.characterFormat=void 0),this.themeFontLanguage&&(this.themeFontLanguage.destroy(),this.themeFontLanguage=void 0),this.paragraphFormat&&(this.paragraphFormat.destroy(),this.paragraphFormat=void 0),this.pages&&this.pages.length>0){for(var e=0;e<this.pages.length;e++){this.pages[e].componentDestroy()}this.pages=[]}if(this.pages=void 0,this.lists&&this.lists.length>0){for(var e=0;e<this.lists.length;e++){this.lists[e].destroy()}this.lists=[]}if(this.lists=void 0,this.formFillPopup&&(this.formFillPopup.destroy(),this.formFillPopup=void 0),this.L10n=void 0,this.currentPage=void 0,this.selectionStartPageIn=void 0,this.selectionEndPageIn=void 0,this.fieldStacks=[],this.fieldStacks=void 0,this.splittedCellWidgets=[],this.splittedCellWidgets=void 0,this.fields=[],this.fields=void 0,this.abstractLists=[],this.abstractLists=void 0,i.i(d.isNullOrUndefined)(this.owner)||this.renderedLists.destroy(),this.renderedLists=void 0,i.i(d.isNullOrUndefined)(this.owner)||this.authors.destroy(),this.authors=void 0,i.i(d.isNullOrUndefined)(this.owner)||this.revisionsInternal.destroy(),this.revisionsInternal=void 0,i.i(d.isNullOrUndefined)(this.owner)||this.preDefinedStyles.destroy(),this.preDefinedStyles=void 0,i.i(d.isNullOrUndefined)(this.owner)||this.bookmarks.destroy(),this.bookmarks=void 0,i.i(d.isNullOrUndefined)(this.owner)||this.editRanges.destroy(),this.editRanges=void 0,i.i(d.isNullOrUndefined)(this.owner)||this.customXmlData.destroy(),i.i(d.isNullOrUndefined)(this.owner)||this.images.destroy(),this.customXmlData=void 0,this.images=void 0,this.blockToShift=void 0,this.cachedPages=[],this.cachedPages=void 0,this.comments&&this.comments.length>0){for(var e=0;e<this.comments.length;e++){this.comments[e].destroy()}this.comments=[]}this.comments=void 0,this.compositionEnd=void 0,this.compositionStart=void 0,this.compositionUpdated=void 0,this.contentControlCollection=[],this.contentControlCollection=void 0,this.renderedLevelOverrides=[],this.renderedLevelOverrides=void 0,this.headersFooters=[],this.headersFooters=void 0,this.listParagraphs=[],this.listParagraphs=void 0,this.formFields=[],this.formFields=void 0,this.fieldCollection=[],this.fieldCollection=void 0,this.userCollection=[],this.userCollection=void 0,this.footnotes&&(this.footnotes.componentDestroy(),this.footnotes=void 0),this.endnotes&&(this.endnotes.componentDestroy(),this.endnotes=void 0),this.zoomModule&&(this.zoomModule.destroy(),this.zoomModule=void 0),this.footnoteCollection=[],this.footnoteCollection=void 0,this.endnoteCollection=[],this.endnoteCollection=void 0,this.restrictEditingPane&&(this.restrictEditingPane.destroy(),this.restrictEditingPane=void 0),this.layout&&this.layout.destroy(),this.layout=void 0,i.i(d.isNullOrUndefined)(this.render)||this.render.destroy(),this.render=void 0,this.dialogInternal&&this.dialogInternal.destroy(),this.dialogInternal=void 0,this.dialogInternal2&&(this.dialogInternal2.destroy(),this.dialogInternal2=void 0),this.dialogInternal3&&(this.dialogInternal3.destroy(),this.dialogInternal3=void 0),this.dialogTarget1&&this.dialogTarget1.parentElement&&this.dialogTarget1.parentElement.removeChild(this.dialogTarget1),this.dialogTarget1=void 0,this.dialogTarget2&&this.dialogTarget2.parentElement&&this.dialogTarget2.parentElement.removeChild(this.dialogTarget2),this.dialogTarget2=void 0,this.dialogTarget3&&this.dialogTarget3.parentElement&&this.dialogTarget3.parentElement.removeChild(this.dialogTarget3),this.dialogTarget3=void 0,i.i(d.isNullOrUndefined)(this.touchStart)||(this.touchStart.innerHTML="",i.i(d.isNullOrUndefined)(this.touchStart.parentElement)||this.touchStart.parentElement.removeChild(this.touchStart)),this.touchStart=void 0,this.textHelper&&this.textHelper.destroy(),this.textHelper=void 0,i.i(d.isNullOrUndefined)(this.touchEnd)||(this.touchEnd.innerHTML="",i.i(d.isNullOrUndefined)(this.touchEnd.parentElement)||this.touchEnd.parentElement.removeChild(this.touchEnd)),this.touchEnd=void 0,i.i(d.isNullOrUndefined)(this.containerCanvasIn)||(this.containerCanvasIn.innerHTML="",i.i(d.isNullOrUndefined)(this.containerCanvasIn.parentElement)||this.containerCanvasIn.parentElement.removeChild(this.containerCanvasIn)),this.containerCanvasIn=void 0,i.i(d.isNullOrUndefined)(this.selectionCanvasIn)||(this.selectionCanvasIn.innerHTML="",i.i(d.isNullOrUndefined)(this.selectionCanvasIn.parentElement)||this.selectionCanvasIn.parentElement.removeChild(this.selectionCanvasIn)),this.selectionCanvasIn=void 0,i.i(d.isNullOrUndefined)(this.editableDiv)||(this.editableDiv.innerHTML="",i.i(d.isNullOrUndefined)(this.editableDiv.parentElement)||this.editableDiv.parentElement.removeChild(this.editableDiv)),this.editableDiv=void 0,i.i(d.isNullOrUndefined)(this.pageContainer)||(this.pageContainer.innerHTML="",i.i(d.isNullOrUndefined)(this.pageContainer.parentElement)||this.pageContainer.parentElement.removeChild(this.pageContainer)),this.pageContainer=void 0,i.i(d.isNullOrUndefined)(this.viewerContainer)||(this.viewerContainer.innerHTML="",i.i(d.isNullOrUndefined)(this.viewerContainer.parentElement)||this.viewerContainer.parentElement.removeChild(this.viewerContainer)),i.i(d.isNullOrUndefined)(this.iframe)||(this.iframe.innerHTML="",i.i(d.isNullOrUndefined)(this.iframe.parentElement)||this.iframe.parentElement.removeChild(this.iframe),this.iframe=void 0),this.optionsPaneContainer&&(this.optionsPaneContainer.innerHTML="",i.i(d.isNullOrUndefined)(this.optionsPaneContainer.parentElement)||this.optionsPaneContainer.parentElement.removeChild(this.optionsPaneContainer)),this.optionsPaneContainer=void 0,this.visibleBoundsIn=void 0,this.mouseDownOffset=void 0,this.viewerContainer=void 0,this.currentPage=void 0,this.selectionStartPageIn=void 0,this.selectionEndPageIn=void 0,this.currentSelectedCommentInternal=void 0,this.currentSelectedRevisionInternal=void 0,this.owner=void 0,this.heightInfoCollection=void 0,this.isRestartNumbering=!1},e.prototype.unWireEvent=function(){this.viewerContainer.removeEventListener("scroll",this.scrollHandler),this.viewerContainer.removeEventListener("mousedown",this.onMouseDownInternal),this.viewerContainer.removeEventListener("mousemove",this.onMouseMoveInternal),d.Browser.isDevice?this.editableDiv.removeEventListener("input",this.onTextInputInternal):(this.editableDiv.removeEventListener("keypress",this.onKeyPressInternal),"chrome"===d.Browser.info.name&&this.editableDiv.removeEventListener("textInput",this.onTextInput)),this.editableDiv.removeEventListener("paste",this.onPaste),this.viewerContainer.removeEventListener("contextmenu",this.onContextMenu),this.editableDiv.removeEventListener("blur",this.onFocusOut),this.editableDiv.removeEventListener("keydown",this.onKeyDownInternal),this.editableDiv.removeEventListener("compositionstart",this.compositionStart),this.editableDiv.removeEventListener("compositionupdate",this.compositionUpdated),this.editableDiv.removeEventListener("compositionend",this.compositionEnd),this.viewerContainer.removeEventListener("mouseup",this.onMouseUpInternal),i.i(d.isNullOrUndefined)(this.iframe)||this.iframe.removeEventListener("load",this.onIframeLoad),this.viewerContainer.removeEventListener("dblclick",this.onDoubleTap),window.removeEventListener("resize",this.onWindowResize),window.removeEventListener("keyup",this.onKeyUpInternal),window.removeEventListener("mouseup",this.onImageResizer),window.removeEventListener("touchend",this.onImageResizer),void 0!==navigator&&navigator.userAgent.match("Firefox")&&this.viewerContainer.removeEventListener("DOMMouseScroll",this.zoomModule.onMouseWheelInternal),this.viewerContainer.removeEventListener("mousewheel",this.zoomModule.onMouseWheelInternal)},e.prototype.updateCursor=function(e){var t,n,r,o=void 0,s=void 0,a=this.viewerContainer,l=new c.b(e.offsetX,e.offsetY),p=this.owner.viewer.findFocusedPage(l,!0),u=this.getLineWidget(p),g=this.owner.isReadOnlyMode?void 0:this.owner.editorModule,f=!!g&&g.tableResize.isInRowResizerArea(p),m=!!g&&g.tableResize.isInCellResizerArea(p),v=this.selection.checkAllFloatingElements(u,p),y="";if(this.owner.enableImageResizerMode){var w=this.owner.imageResizerModule.getImagePoint(p);this.owner.imageResizerModule.selectedResizeElement=w.selectedElement,y=w.resizePosition}var b=0,x=void 0,C=this.checkPointIsInLine(u,p);if(!i.i(d.isNullOrUndefined)(u)){if(b=this.selection.getLineStartLeft(u),o=this.selection.getHyperLinkFieldInCurrentSelection(u,p),i.i(d.isNullOrUndefined)(o)&&(x=this.selection.getHyperLinkFieldInCurrentSelection(u,p,!0)),!i.i(d.isNullOrUndefined)(o)){var I=this.selection.getFieldCode(o);0!==I.toLowerCase().indexOf("ref ")||I.match("\\h")||(o=void 0)}if(t=this.selection.updateTextPositionIn(u,void 0,0,p,!0),n=this.selection.getLeft(u),r=this.selection.getTop(u),i.i(d.isNullOrUndefined)(o)&&!i.i(d.isNullOrUndefined)(x)&&this.isDocumentProtected&&"FormFieldsOnly"===this.protectionType&&!this.isFormFilling?this.selection.setHyperlinkContentToToolTip(x,u,p.x,!0):this.selection.setHyperlinkContentToToolTip(o,u,p.x,!1),x){var F=x.formFieldData instanceof h.l&&"Text"===x.formFieldData.type;"Inline"===this.owner.documentEditorSettings.formFieldSettings.formFillingMode&&F&&(x=void 0)}if(this.owner.enableLockAndEdit){var k=!1,P=u.paragraph;P.isInsideTable&&(P=this.layout.getParentTable(P)),P.locked&&P.lockedBy!==this.owner.currentUser&&(k=!0);var T=u.paragraph.bodyWidget.sectionFormat,W=T.pageWidth-T.rightMargin-T.leftMargin;W=c.a.convertPointToPixel(W)*this.zoomFactor,this.viewer instanceof S&&(W=(this.visibleBounds.width-5*this.viewer.padding.right)/this.zoomFactor),k&&p.x>=b&&p.x<b+W?this.selection.setLockInfoTooptip(u,p.x,P.lockedBy):this.selection.setLockInfoTooptip(void 0,p.x,"")}}i.i(d.isNullOrUndefined)(u)||i.i(d.isNullOrUndefined)(s)&&"Pages"==this.owner.layoutType&&(s=this.selection.getFootNoteElementInCurrentSelection(u,p))instanceof h.f&&this.selection.setFootnoteContentToToolTip(s,u,p.x);var N=this.isIosDevice?e.metaKey:e.ctrlKey;if(!i.i(d.isNullOrUndefined)(o)&&(N&&this.owner.useCtrlClickToFollowHyperlink||!this.owner.useCtrlClickToFollowHyperlink)||x)return void(i.i(d.isNullOrUndefined)(x)?a.style.cursor="pointer":this.isFormFillProtectedMode&&(a.style.cursor="default"));p.x>=b&&e.offsetX<this.visibleBounds.width-(this.visibleBounds.width-this.viewerContainer.clientWidth)&&e.offsetY<this.visibleBounds.height-(this.visibleBounds.height-this.viewerContainer.clientHeight)?this.selection.isEmpty?a.style.cursor="text":a.style.cursor=this.selection.checkCursorIsInSelection(u,p)?"default":"text":a.style.cursor="default",i.i(d.isNullOrUndefined)(y)||""===y?!i.i(d.isNullOrUndefined)(t)&&t.isImageSelected&&n<p.x&&r<p.y&&n+u.width>p.x&&r+u.height>p.y&&(a.style.cursor="move"):(!this.owner.imageResizerModule.isShapeResize||this.owner.imageResizerModule.isShapeResize&&"move"!==y)&&(a.style.cursor=y),f?a.style.cursor="row-resize":m&&(a.style.cursor="col-resize"),v.isInShapeBorder&&!C&&(a.style.cursor="all-scroll")},e.prototype.updateDialogTabHeight=function(e,t){var i=e.getElementsByClassName("e-dlg-header-content")[0],n=e.getElementsByClassName("e-dlg-content")[0],r=e.getElementsByClassName("e-footer-content")[0],o=getComputedStyle(n),s=getComputedStyle(e),a=parseInt(o.paddingTop,10),l=parseInt(o.paddingBottom,10),d=(isNaN(a)?0:a)+(isNaN(l)?0:l),h=parseInt(s.borderTop,10),c=parseInt(s.borderBottom,10),p=(isNaN(h)?0:h)+(isNaN(c)?0:c),u=e.offsetHeight-(i.offsetHeight+r.offsetHeight+d+p);t.style.height=u+"px";var g=parseInt(o.paddingLeft,10),f=parseInt(o.paddingRight,10),m=(isNaN(g)?0:g)+(isNaN(f)?0:f),v=parseInt(s.borderLeft,10),y=parseInt(s.borderRight,10),w=(isNaN(v)?0:v)+(isNaN(y)?0:y);return e.offsetWidth-(m+w)},e.prototype.canRenderBorder=function(e){var t,n,r,o,s=!1,a=!1,l=e.previousRenderedWidget,c=e.nextRenderedWidget,p=this.getParagraphLeftPosition(e),u=0,g=0;return!i.i(d.isNullOrUndefined)(l)&&l instanceof h.g&&(u=this.getParagraphLeftPosition(l)),!i.i(d.isNullOrUndefined)(c)&&c instanceof h.g&&(g=this.getParagraphLeftPosition(c)),!i.i(d.isNullOrUndefined)(l)&&l instanceof h.g&&p===u&&(t=this.checkEqualBorder(e.paragraphFormat.borders.top,l.paragraphFormat.borders.top),n=this.checkEqualBorder(e.paragraphFormat.borders.bottom,l.paragraphFormat.borders.bottom),r=this.checkEqualBorder(e.paragraphFormat.borders.left,l.paragraphFormat.borders.left),o=this.checkEqualBorder(e.paragraphFormat.borders.right,l.paragraphFormat.borders.right),t&&n&&r&&o&&!i.i(d.isNullOrUndefined)(l.paragraphFormat.borders.horizontal)&&"None"===l.paragraphFormat.borders.horizontal.lineStyle&&(s=!0)),!i.i(d.isNullOrUndefined)(c)&&c instanceof h.g&&(p===g||this.owner.documentHelper.layout.isInitialLoad&&this.skipBottomBorder(e,c))&&(t=this.checkEqualBorder(e.paragraphFormat.borders.top,c.paragraphFormat.borders.top),n=this.checkEqualBorder(e.paragraphFormat.borders.bottom,c.paragraphFormat.borders.bottom),r=this.checkEqualBorder(e.paragraphFormat.borders.left,c.paragraphFormat.borders.left),o=this.checkEqualBorder(e.paragraphFormat.borders.right,c.paragraphFormat.borders.right),n&&t&&r&&o&&(a=!0)),{skipTopBorder:s,skipBottomBorder:a}},e.prototype.checkEqualBorder=function(e,t){return i.i(d.isNullOrUndefined)(e)||i.i(d.isNullOrUndefined)(t)?!(!i.i(d.isNullOrUndefined)(e)||!i.i(d.isNullOrUndefined)(t)):e.isEqualFormat(t)},e.prototype.getParagraphLeftPosition=function(e){var t=0;return e.paragraphFormat.firstLineIndent<0&&(t=c.a.convertPointToPixel(Math.abs(e.paragraphFormat.firstLineIndent)),t=parseFloat(t.toFixed(5))),e.isEmpty()&&("Left"!==e.paragraphFormat.textAlignment&&"Justify"!==e.paragraphFormat.textAlignment||"Justify"===e.paragraphFormat.textAlignment&&e.paragraphFormat.bidi)?e.clientX>t?e.clientX-t:e.clientX:e.x>t?e.x-t:e.x},e.prototype.skipBottomBorder=function(e,t){var i=0,n=0;return e.paragraphFormat.leftIndent===t.paragraphFormat.leftIndent||(i=e.paragraphFormat.firstLineIndent<0?Math.abs(e.paragraphFormat.firstLineIndent):0,n=t.paragraphFormat.firstLineIndent<0?Math.abs(t.paragraphFormat.firstLineIndent):0,i=e.paragraphFormat.leftIndent>i?e.paragraphFormat.leftIndent-i:0,n=t.paragraphFormat.leftIndent>n?t.paragraphFormat.leftIndent-n:0,i===n)},e.prototype.isPageInVisibleBound=function(e,t){var i=this.visibleBounds.height,n=this.viewerContainer.scrollTop,r=e.boundingRectangle.height*this.zoomFactor,o=t>=n&&t<=n+i,s=t+r>=n&&t+r<=n+i,a=t<=n&&t+r>=n+i;return o||s||a},e.prototype.getFirstParagraphInCell=function(e){var t=e.childWidgets[0];return t instanceof h.g?t:this.getFirstParagraphInFirstCell(t)},e.prototype.getFirstParagraphInFirstCell=function(e){if(!i.i(d.isNullOrUndefined)(e.childWidgets)&&e.childWidgets.length>0){var t=e.childWidgets[0],n=t.childWidgets[0],r=n.childWidgets[0];return this.getFirstParagraphBlock(r)}},e.prototype.getLastParagraphInLastCell=function(e){if(!i.i(d.isNullOrUndefined)(e.childWidgets)&&e.childWidgets.length>0){var t=e.lastChild,n=t.lastChild,r=n.lastChild;return this.getLastParagraphBlock(r)}},e.prototype.getFirstParagraphBlock=function(e){return e instanceof h.g?e:e instanceof h.u?this.getFirstParagraphInFirstCell(e):void 0},e.prototype.getLastParagraphBlock=function(e){return e instanceof h.g?e:e instanceof h.u?this.getLastParagraphInLastCell(e):void 0},e.prototype.getLastParagraphInFirstRow=function(e){if(e.childWidgets.length>0){var t=e.firstChild,i=t.lastChild,n=i.lastChild;return this.getLastParagraphBlock(n)}},e.prototype.getFirstParagraphInLastRow=function(e){if(e.childWidgets.length>0){var t=e.childWidgets[e.childWidgets.length-1],i=t.childWidgets[0],n=i.childWidgets[0];return this.getFirstParagraphBlock(n)}},e.prototype.addToStylesMap=function(e){var t={},n={};if(!i.i(d.isNullOrUndefined)(e)){var r=this.owner?this.L10n.getConstant(e.name):e.name;t.StyleName=""===r?e.name:r,"Paragraph"==e.type&&(n.paragraphFormat={},c.a.writeParagraphFormat(n.paragraphFormat,!0,e.paragraphFormat)),n.characterFormat={},c.a.writeCharacterFormat(n.characterFormat,!0,e.characterFormat),t.Style=this.parseStyle(JSON.stringify(n)),i.i(d.isNullOrUndefined)(e.type)||(t.type=e.type,"Paragraph"!=t.type||i.i(d.isNullOrUndefined)(e.link)||(t.type="Linked")),"Paragraph"==t.type?t.IconClass="e-list-icon e-de-listview-icon e-de-e-paragraph-style-mark e-icons":"Character"==t.type?t.IconClass="e-list-icon e-de-listview-icon e-de-e-character-style-mark e-icons":t.IconClass="e-list-icon e-de-listview-icon e-de-e-linked-style-mark e-icons",this.stylesMap.get(t.type)?this.stylesMap.get(t.type).push(t):this.stylesMap.add(t.type,[t])}},e.prototype.parseStyle=function(e){var t="",n=JSON.parse(e),r="";if(!i.i(d.isNullOrUndefined)(n.characterFormat.baselineAlignment)&&"Normal"!==n.characterFormat.baselineAlignment){var o="";switch(n.characterFormat.baselineAlignment){case"Superscript":o="super";break;case"Subscript":o="sub"}o.length>1&&(t+="vertical-align:"+o+";")}return i.i(d.isNullOrUndefined)(n.characterFormat.underline)||"None"===n.characterFormat.underline||(r+="underline "),i.i(d.isNullOrUndefined)(n.characterFormat.strikethrough)||"None"===n.characterFormat.strikethrough||(r+="line-through "),i.i(d.isNullOrUndefined)(n.characterFormat.fontSize)||(t+="font-size:"+n.characterFormat.fontSize+"px;"),i.i(d.isNullOrUndefined)(n.characterFormat.fontFamily)||(t+="font-family:"+n.characterFormat.fontFamily+";"),!i.i(d.isNullOrUndefined)(n.characterFormat.bold)&&n.characterFormat.bold&&(t+="font-weight:bold;"),!i.i(d.isNullOrUndefined)(n.characterFormat.italic)&&n.characterFormat.italic&&(t+="font-style:italic;"),r.length>1&&(t+="text-decoration:"+r+";"),t},e}(),P=function(){function e(e){this.visiblePages=[],this.padding=new h.y(10,10,30,10),this.textWrap=!0,this.pageFitTypeIn="None",this.containerTop=0,this.containerWidth=0,this.containerLeft=0,this.owner=e,this.columnLayoutArea=new W(this)}return Object.defineProperty(e.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageFitType",{get:function(){return this.pageFitTypeIn},set:function(e){this.pageFitTypeIn=e,this.onPageFitTypeChanged(this.pageFitTypeIn)},enumerable:!0,configurable:!0}),e.prototype.updateClientArea=function(e,t,n){var r;i.i(d.isNullOrUndefined)(e)||(r=e.sectionFormat,this.columnLayoutArea.setColumns(r));var o=0,s=0;if(this instanceof S){o=(this.documentHelper.visibleBounds.width-4*this.padding.right-2*this.padding.left)/this.documentHelper.zoomFactor,o<0&&(o=0),s=Number.POSITIVE_INFINITY,this.clientArea=new h.t(this.padding.left/this.documentHelper.zoomFactor,0,o,s),this.clientActiveArea=new h.t(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height)}else{var a=0,l=48,p=48,u=c.a.convertPointToPixel(r.pageHeight),g=c.a.convertPointToPixel(r.bottomMargin);i.i(d.isNullOrUndefined)(r)||(a=c.a.convertPointToPixel(r.topMargin),l=c.a.convertPointToPixel(r.headerDistance),p=c.a.convertPointToPixel(r.footerDistance));var f=!1;i.i(d.isNullOrUndefined)(t.headerWidget)||(f=t.headerWidget.isEmpty,a>=0?(!f||f&&this.owner.enableHeaderAndFooter)&&(a=Math.min(Math.max(l+t.headerWidget.height,a),u/100*40)):a=Math.abs(a));var m=.667+g;if(!i.i(d.isNullOrUndefined)(t.footerWidget)){f=t.footerWidget.isEmpty;var v=i.i(d.isNullOrUndefined)(t.footnoteWidget)?0:t.footnoteWidget.height;v=Math.min(v,(u-a-m)/100*90),m>=0?(!f||f&&this.owner.enableHeaderAndFooter)&&(m=.667+Math.min(u/100*40,Math.max(p+t.footerWidget.height,g))):m=Math.abs(m),m+=v}i.i(d.isNullOrUndefined)(r)||(o=c.a.convertPointToPixel(r.pageWidth-r.leftMargin-r.rightMargin),s=u-a-m),o<0&&(o=0);var y=new h.t(c.a.convertPointToPixel(r.leftMargin),a,o,u-a-m);if(t.footnoteWidget&&n&&!this.documentHelper.owner.editor.isFootNote&&0!==t.footnoteWidget.y&&this.clientArea.y+this.clientArea.height>t.footnoteWidget.y){var w=this.clientArea.y+this.clientArea.height-t.footnoteWidget.y;this.clientArea.height-=w/2}0!==e.page.bodyWidgets[0].columnIndex&&this.owner.editor.updateColumnIndex(e,!1),this.setClientArea(e,y),this.clientActiveArea=new h.t(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height)}},e.prototype.setClientArea=function(e,t){this.clientArea=this.columnLayoutArea.getColumnBoundsByBodyWidget(e,t),e.x=this.clientArea.x,e.width=this.clientArea.width},e.prototype.updateClientAreaTopOrLeft=function(e,t){t&&(this.clientActiveArea.y=this.clientActiveArea.y+e.topBorderWidth,this.clientActiveArea.x=this.clientActiveArea.x+e.leftBorderWidth)},e.prototype.updateClientAreaForTable=function(e){this.clientActiveArea.x=this.clientArea.x=e.x,this.clientActiveArea.width=this.clientArea.width=e.width},e.prototype.updateClientAreaForRow=function(e,t){var i=e.ownerTable;t||(this.clientActiveArea.x=this.clientArea.x=i.x,this.clientActiveArea.width=this.clientArea.width=i.width,this.clientArea=new h.t(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height),this.clientActiveArea=new h.t(this.clientActiveArea.x,this.clientActiveArea.y,this.clientActiveArea.width,this.clientActiveArea.height))},e.prototype.updateClientAreaForCell=function(e,t){var i=e.ownerRow,n=e;if(t)this.clientActiveArea.x=this.clientArea.x=n.x,this.clientActiveArea.y=n.y,this.clientActiveArea.width=this.clientArea.width=n.width>0?n.width:0,this instanceof T&&(this.clientActiveArea.height=Number.POSITIVE_INFINITY),this.clientArea=new h.t(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height),this.clientActiveArea=new h.t(this.clientActiveArea.x,this.clientActiveArea.y,this.clientActiveArea.width,this.clientActiveArea.height);else{if(this.clientActiveArea.x=this.clientArea.x=n.x+n.width+n.margin.right,i.x+i.width-this.clientArea.x<0?this.clientActiveArea.width=this.clientArea.width=0:this.clientActiveArea.width=this.clientArea.width=i.x+i.width-this.clientArea.x,this.clientActiveArea.y=n.y-n.margin.top-c.a.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing),!e.ownerTable.isInsideTable&&(this.clientActiveArea.height=this.clientArea.bottom-i.y>0?this.clientArea.bottom-i.y:0,!e.ownerTable.wrapTextAround&&this.documentHelper.layout.existFootnoteHeight>0)){var r=this.clientActiveArea.height-this.documentHelper.layout.existFootnoteHeight;this.clientActiveArea.height=r<0?0:r}this.clientArea=new h.t(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height),this.clientActiveArea=new h.t(this.clientActiveArea.x,this.clientActiveArea.y,this.clientActiveArea.width,this.clientActiveArea.height)}},e.prototype.updateClientAreaForTextBoxShape=function(e,t,i){if("Inline"!==e.textWrappingStyle||i||(e.y=this.clientActiveArea.y,e.x=this.clientActiveArea.x),t){var n=c.a.convertPointToPixel(e.textFrame.marginLeft),r=c.a.convertPointToPixel(e.textFrame.marginRight),o=c.a.convertPointToPixel(e.textFrame.marginTop),s=c.a.convertPointToPixel(e.textFrame.marginBottom),a=e.width,l=Number.POSITIVE_INFINITY;this.clientArea=new h.t(e.x+n,e.y+o,a-n-r,l-o-s),this.clientActiveArea=new h.t(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height)}},e.prototype.updateClientAreaByWidgetFootNote=function(e){this.clientArea.x=e.x,this.clientArea.y=e.y,this.clientActiveArea.x=e.x,this.clientActiveArea.y=e.y},e.prototype.updateClientAreaForTextWrap=function(e){this.clientActiveArea=new h.t(e.x,e.y,e.width,e.height)},e.prototype.updateBoundsBasedOnTextWrap=function(e){var t=e-this.clientActiveArea.y;this.clientActiveArea.y=e,this.clientActiveArea.height=this.clientActiveArea.height-t},e.prototype.updateBoundsBasedOnTextWrapTable=function(e){var t=e-this.clientArea.y;this.clientArea.y=e,this.clientArea.height=this.clientArea.height-t,this.clientActiveArea=new h.t(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height)},e.prototype.updateClientAreaByWidget=function(e){this.clientArea.x=e.x,this.clientArea.y=e.y,this.clientActiveArea.x=e.x,this.clientActiveArea.y=e.y},e.prototype.updateClientAreaLocation=function(e,t){e.x=t.x,e.y=t.y,e.width=t.width},e.prototype.updateClientAreaForBlock=function(e,t,n,r,o){var s=c.a.convertPointToPixel(e.leftIndent),a=c.a.convertPointToPixel(e.rightIndent),l=e.bidi,p=0;if(t)if(e instanceof h.u&&n){var u=n[0];e.bodyWidget.sectionFormat.columns.length<=1&&(this.clientActiveArea.x=this.clientArea.x=u.x,this.clientActiveArea.width=this.clientArea.width=u.width),u=n[n.length-1],u.x=this.clientActiveArea.x,u.y=this.clientActiveArea.y}else{if(e instanceof h.u&&!i.i(d.isNullOrUndefined)(e.tableFormat)){e.isGridUpdated||(e.buildTableColumns(),e.isGridUpdated=!0);var g=this.tableAlignmentForBidi(e,l);if("Left"!==g){var f=0;f=c.a.convertPointToPixel(e.tableHolder.getTotalWidth(0)),f=0===f?0===e.tableHolder.tableWidth?e.getTableClientWidth(e.getOwnerWidth(!1)):e.tableHolder.tableWidth:f,this.owner.editor&&this.owner.editor.tableResize.currentResizingTable===e&&0===this.owner.editor.tableResize.resizerPosition&&(f=c.a.convertPointToPixel(e.tableHolder.tableWidth)),"Center"===g?(this.documentHelper.isRowOrCellResizing||(f=e.getTableCellWidth()),s=(this.clientArea.width-f)/2):s=this.clientArea.width-f,l&&(s-=c.a.convertPointToPixel(e.leftIndent),a=s),e.isInsideTable,this.documentHelper.tableLefts.push(s)}}p=this.clientArea.width-(s+c.a.convertPointToPixel(e.rightIndent));var m=this.clientArea.x+(l?a:s);p=p>0?p:0,this.clientActiveArea.x=this.clientArea.x=m,this.clientActiveArea.width=this.clientArea.width=p,r&&this.updateParagraphYPositionBasedonTextWrap(e,new h.t(this.clientActiveArea.x,this.clientActiveArea.y,this.clientActiveArea.width,this.clientActiveArea.height)),o&&(e instanceof h.g?this.updateParagraphXPositionBasedOnTextWrap(e):this.updateTableXPositionBasedOnTextWrap(e))}else{if(e instanceof h.u&&!i.i(d.isNullOrUndefined)(e.tableFormat)){var g=this.tableAlignmentForBidi(e,l);e.isGridUpdated||(e.buildTableColumns(),e.isGridUpdated=!0),"Left"!==g&&this.documentHelper.tableLefts.length>0&&(s=this.documentHelper.tableLefts.pop(),l&&(a=s))}p=this.clientArea.width+s+c.a.convertPointToPixel(e.rightIndent);var m=this.clientArea.x-(l?a:s);p=p>0?p:0,this.clientActiveArea.x=this.clientArea.x=m,this.clientActiveArea.width=this.clientArea.width=p}this.clientArea=new h.t(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height),this.clientActiveArea=new h.t(this.clientActiveArea.x,this.clientActiveArea.y,this.clientActiveArea.width,this.clientActiveArea.height)},e.prototype.updateParagraphYPositionBasedonTextWrap=function(e,t){var n=e.bodyWidget,r=this.clientActiveArea;if(n&&n.floatingElements.length>0&&e instanceof h.g&&!(e.containerWidget instanceof h.i)&&!e.isInsideTable&&!(e.containerWidget instanceof h.a)){var o="Word2013"===this.documentHelper.compatibilityMode,s=e,a=s.isEmpty(),l=s.height;if(0===l&&(l=this.documentHelper.textHelper.getParagraphMarkSize(s.characterFormat).Height),!s.isInHeaderFooter||s.isInsideTable||o){var p=t.y,u=!1;n.floatingElements.sort(function(e,t){return e.y-t.y}),n.floatingElements.sort(function(e,t){return e.x-t.x});var g=s.previousRenderedWidget;g&&g instanceof h.u&&g.wrapTextAround&&!a&&!s.isContainsShapeAlone()&&o&&t.y<g.y&&(t.y=g.y);for(var f=0;f<n.floatingElements.length;f++){var m=n.floatingElements[f],v=!1;if(v=m instanceof h.v?m.paragraph.isInHeaderFooter:m.bodyWidget instanceof h.x,!(s.isInsideTable&&m instanceof h.u)||m.isInsideTable){var y=this.getTextWrappingBound(m),w=m instanceof h.u?"Square":m.textWrappingStyle,b=m instanceof h.u?"Both":m.textWrappingType;if(!(r.x>y.right+24||r.right<y.x-24))if((t.y+(m instanceof h.u&&!a&&0===s.floatingElements.length?l:s.height)>y.y||u)&&t.y<y.bottom&&"Inline"!==w&&"TopAndBottom"!==w&&"InFrontOfText"!==w&&"Behind"!==w){var x=0,C=c.a.convertPointToPixel(s.paragraphFormat.rightIndent),I=c.a.convertPointToPixel(s.paragraphFormat.firstLineIndent);if(I=!a&&s.childWidgets[0].isFirstLine()&&I>0?I:0,t.x>=y.x&&"Left"!==b&&(x=C),x=x<0?x:0,t.x<y.x&&t.x>y.x&&"Left"!==b)t.right>y.x&&(t.width=t.width-(t.right-y.right)),t.width<24?(!o&&m instanceof h.u&&g===m||(this.updateBoundsBasedOnTextWrap(y.bottom),t=this.clientActiveArea),((!a&&s.childWidgets[0].isFirstLine()||a)&&o||!v)&&(s.y=this.clientActiveArea.y)):t.x=y.right;else if(t.x>=y.x&&t.x<y.right)if(t.width=t.width-(y.right-t.x)-x,t.width<24||u){t.width=this.clientActiveArea.right-y.right-x;var F=!1;if(t.width<24||u){if(this.clientActiveArea.x+24<y.x){var k=this.getIntersectingItemBounds(n.floatingElements,m,p);!i.i(d.isNullOrUndefined)(k)&&k.bottom<=y.bottom&&(this.updateBoundsBasedOnTextWrap(k.bottom),t=this.clientActiveArea,F=!0,s.x=k.x)}o&&!F&&(m instanceof h.u&&g===m?this.updateBoundsBasedOnTextWrapTable(y.bottom):this.updateBoundsBasedOnTextWrap(y.bottom),t=this.clientActiveArea),((!a&&s.childWidgets[0].isFirstLine()||a)&&o||!v)&&(s.y=this.clientActiveArea.y)}else t.x=y.right}else t.x=y.right;else y.x>t.x&&t.right>y.x&&(t.width=y.x-t.x,t.width<24&&(t.width=this.clientActiveArea.right-y.right-x,t.width<24?(!o&&m instanceof h.u&&g===m||(this.updateBoundsBasedOnTextWrap(y.bottom),t=this.clientActiveArea),((!a&&s.childWidgets[0].isFirstLine()||a)&&o||!v)&&(s.y=this.clientActiveArea.y)):t.x=y.right))}else n.floatingElements.length>0&&(t.y>=y.y&&t.y<y.bottom||t.y+l>=y.y&&t.y+l<y.bottom)&&"TopAndBottom"===w&&(!o&&m instanceof h.u&&g===m||(this.updateBoundsBasedOnTextWrap(y.bottom),!o&&(!a&&s.childWidgets[0].isFirstLine()||a)&&(u=!0)),((!a&&s.childWidgets[0].isFirstLine()||a)&&o||!v)&&(s.y=this.clientActiveArea.y))}}}}},e.prototype.updateParagraphXPositionBasedOnTextWrap=function(e){var t="Word2013"===this.documentHelper.compatibilityMode,n=e.containerWidget,r=this.clientActiveArea;if(this instanceof T&&!i.i(d.isNullOrUndefined)(n)&&e instanceof h.g&&!i.i(d.isNullOrUndefined)(n.page)&&!i.i(d.isNullOrUndefined)(n.page.headerWidget)){var o=n.page.headerWidget.floatingElements;if(o.length>0&&(!e.isInHeaderFooter||e.isInsideTable||t)&&!(e.containerWidget instanceof h.a)&&!(e.bodyWidget instanceof h.i))for(var s=e,a=0;a<o.length;a++){var l=o[a];if(!(s.isInsideTable&&l instanceof h.u)||l.isInsideTable){var p=this.getTextWrappingBound(l),u=l instanceof h.u?"Square":l.textWrappingStyle;l instanceof h.u||l.textWrappingType;if(!s.isInsideTable&&!(r.x>p.right+24||r.right<p.x-24)&&o.length>0&&r.y+s.height>p.y&&r.y<p.bottom&&"Inline"!==u&&"TopAndBottom"!==u&&"InFrontOfText"!==u&&"Behind"!==u){var g=c.a.convertPointToPixel(s.paragraphFormat.rightIndent);if("Left"!=s.paragraphFormat.textAlignment&&r.x<p.x&&r.x+s.width>p.x)s.x=r.x;else if(r.x>=p.x&&r.x<p.right&&!s.paragraphFormat.bidi){if(r.width=r.width-(p.right-r.x)-g,r.width<24)r.width=this.clientActiveArea.right-p.right-g,r.width<24?(s.x=r.x,r.width=r.width,r.height=p.bottom-r.x,r.y=p.bottom):r.x=p.right;else if("Word2007"===this.documentHelper.compatibilityMode||r.y<=p.bottom){var f=c.a.convertPointToPixel(s.paragraphFormat.leftIndent),m=c.a.convertPointToPixel(s.paragraphFormat.firstLineIndent);f+m+r.x<p.right&&(r.x=p.right)}}else(p.x-24>r.x&&r.right>p.x||r.x>p.x&&r.x>p.right)&&(s.x=r.x)}}}}},e.prototype.updateTableXPositionBasedOnTextWrap=function(e){var t=c.a.convertPointToPixel(e.childWidgets[0].getFirstRowWidth()),n=e.bodyWidget;if(this instanceof T&&!i.i(d.isNullOrUndefined)(n)&&!i.i(d.isNullOrUndefined)(n.page)&&!i.i(d.isNullOrUndefined)(n.page.headerWidget)){var r=n.page.headerWidget.floatingElements;if(!(!(r.length>0)||e.isInHeaderFooter&&e.isInsideTable&&"Word2013"!==this.documentHelper.compatibilityMode||e.containerWidget instanceof h.i))for(var o=this.clientActiveArea,s=0;s<r.length;s++){var a=r[s],l=this.getTextWrappingBound(a),p=a instanceof h.u?"Square":a.textWrappingStyle,u=a instanceof h.u?a.positioning.allowOverlap:a.allowOverlap,g=this.documentHelper.getFirstParagraphInFirstCell(e),f=this.documentHelper.textHelper.getParagraphMarkSize(g.characterFormat).Height,m=e.childWidgets[0]instanceof h.z?e.childWidgets[0].height:0;m>f&&(f=m);var v=c.a.convertPointToPixel(e.getTableClientWidth(e.getContainerWidth()));if(!(this.clientArea.x>l.right+24||this.clientArea.right<l.x-24)&&this.isFloatingItemIntersect(e,o,l,p,u,f,v)&&o.x>=l.x&&o.x<l.right)if(o.width=o.width-(l.right-o.x),o.width<24||o.width<t&&t>0)if(o.width=this.clientActiveArea.right-l.right,o.width<24||o.width<t&&t>0&&this.clientArea.right<=t+l.right){var y=l.bottom>o.y?l.bottom-o.y:0;o.y=l.bottom,o.width=this.clientArea.width,o.height=o.height-y,this.updateClientAreaForTextWrap(o)}else o.x=l.right,this.updateClientAreaForTextWrap(o);else o.x=l.right,this.updateClientAreaForTextWrap(o)}}},e.prototype.isFloatingItemIntersect=function(e,t,i,n,r,o,s){return(Math.round(t.y+o)>=Math.round(i.y)&&Math.round(t.y)<Math.round(i.bottom)||Math.round(t.y+o)<=Math.round(i.bottom)&&Math.round(t.y+o)>=Math.round(i.y))&&"Inline"!==n&&"TopAndBottom"!==n&&"InFrontOfText"!==n&&"Behind"!==n&&!(r&&null!==e.tableFormat&&e.wrapTextAround&&e.positioning.allowOverlap)},e.prototype.getIntersectingItemBounds=function(e,t,n){var r=this.getMinBottomFloatingItem(e,this.getIntersectingFloatingItems(e,t,n));if(!i.i(d.isNullOrUndefined)(r)){return this.getTextWrappingBound(r)}},e.prototype.getMinBottomFloatingItem=function(e,t){var i=-1,n=Number.MAX_VALUE,r=0;e.sort(function(e,t){return e.x-t.x});for(var o=0;o<t.length;o++){var s=e[o],a=this.getTextWrappingBound(s);n>a.bottom&&(s&&t.indexOf(s)+1<t.length?r++:(n=a.bottom,i=t.indexOf(s)))}return i-r==0?t[i]:null},e.prototype.getIntersectingFloatingItems=function(e,t,i){for(var n=[],r=0;r<e.length;r++){var o=e[r],s=this.getTextWrappingBound(o),a=this.getTextWrappingBound(t);i<=s.bottom&&a.bottom>=s.bottom&&s.right>this.clientActiveArea.x&&s.x<a.x&&n.push(o)}return n},e.prototype.getTextWrappingBound=function(e){var t=0,i=0,n=0,r=0,o=0;return e instanceof h.v?(t=e.distanceLeft,i=e.distanceTop,n=e.distanceRight,r=e.distanceBottom,o=e.width):(o=e.getTableCellWidth(),t=e.positioning.distanceLeft,i=e.positioning.distanceTop,n=e.positioning.distanceRight,r=e.positioning.distanceBottom),new h.t(e.x-t,e.y-i,o+t+n,e.height+i+r)},e.prototype.tableAlignmentForBidi=function(e,t){var i=e.tableFormat.tableAlignment;return t&&("Left"===i?i="Right":"Right"===i&&(i="Left")),i},e.prototype.cutFromLeft=function(e){e<this.clientActiveArea.x&&(e=this.clientActiveArea.x),e>this.clientActiveArea.right&&this.textWrap&&(e=this.clientActiveArea.right),this.clientActiveArea.width=this.clientActiveArea.right>e?this.clientActiveArea.right-e:0,this.clientActiveArea.x=e},e.prototype.cutFromTop=function(e){e<this.clientActiveArea.y&&(e=this.clientActiveArea.y),e>this.clientActiveArea.bottom&&(e=this.clientActiveArea.bottom),this.clientActiveArea.height=this.clientActiveArea.bottom-e,this.clientActiveArea.x=this.clientArea.x,this.clientActiveArea.width=this.clientArea.width,this.clientActiveArea.y=e},e.prototype.updateClientWidth=function(e){this.clientActiveArea.x-=e,this.clientActiveArea.width+e>0?this.clientActiveArea.width+=e:this.clientActiveArea.width=0},e.prototype.findFocusedPage=function(e,t,n){var r=new c.b(e.x,e.y);r.x+=this.documentHelper.viewerContainer.scrollLeft,r.y+=this.documentHelper.viewerContainer.scrollTop;for(var o=0;o<this.documentHelper.pages.length;o++){var s=this.documentHelper.pages[o],a=(s.boundingRectangle.y-this.pageGap*(o+1))*this.documentHelper.zoomFactor+this.pageGap*(o+1),l=s.boundingRectangle.height*this.documentHelper.zoomFactor+this.pageGap,h=s.boundingRectangle.x,p=void 0;if(p=this instanceof T?(s.boundingRectangle.right-h)*this.documentHelper.zoomFactor+h:s.boundingRectangle.right+h,a<=r.y&&a+l>=r.y)return t&&(this.documentHelper.currentPage=s,n&&(i.i(d.isNullOrUndefined)(s.headerWidget)||(s.headerWidget.page=s),i.i(d.isNullOrUndefined)(s.footerWidget)||(s.footerWidget.page=s))),r.y=(r.y-a)/this.documentHelper.zoomFactor,r.x>p?r.x=s.boundingRectangle.right:r.x<h?r.x=0:r.x=(r.x-h)/this.documentHelper.zoomFactor,r}return r},e.prototype.getPageHeightAndWidth=function(e,t,i,n){e=0;for(var r=0;r<this.documentHelper.pages.length;r++)e+=this.documentHelper.pages[r].boundingRectangle.height;t=0;for(var r=0;r<this.documentHelper.pages.length;r++)t<this.documentHelper.pages[r].boundingRectangle.width&&(t=this.documentHelper.pages[r].boundingRectangle.width);return i=this.documentHelper.visibleBounds.width,n=this.documentHelper.visibleBounds.height,{height:e,width:t,viewerWidth:i,viewerHeight:n}},e.prototype.renderVisiblePages=function(){if(!(i.i(d.isNullOrUndefined)(this.visiblePages)||this.visiblePages.length<1)){this.documentHelper.clearContent();for(var e=0;e<this.visiblePages.length;e++){var t=this.visiblePages[e],n=t.boundingRectangle.width*this.documentHelper.zoomFactor,r=t.boundingRectangle.height*this.documentHelper.zoomFactor,o=t.boundingRectangle.x,s=(t.boundingRectangle.y-this.pageGap*(e+1))*this.documentHelper.zoomFactor+this.pageGap*(e+1);this.owner.viewer.renderPage(t,o,s,n,r)}}},e.prototype.handleZoom=function(){var e=this.documentHelper.preZoomFactor,t=null,n=0,r=!1;if(this.documentHelper.selection&&i.i(d.isNullOrUndefined)(this.documentHelper.zoomX&&i.i(d.isNullOrUndefined)(this.documentHelper.zoomY))){var o=0,s=0,a=this.documentHelper.selection.getPage(this.documentHelper.selection.end.currentWidget.paragraph);o=(this.documentHelper.visibleBounds.width-a.boundingRectangle.width*e)/2,o<30&&(o=30),s=a.boundingRectangle.y*e+(this.documentHelper.pages.indexOf(a)+1)*this.pageGap*(1-e);var l=this.documentHelper.selection.updateCaretSize(this.owner.selection.end,!0),h=l.topMargin;l.height;o+=this.documentHelper.selection.end.location.x*e,s+=(this.documentHelper.selection.end.location.y+h)*e,o>=this.containerLeft&&o<=this.documentHelper.visibleBounds.width&&s>=this.containerTop&&s<=this.containerTop+this.documentHelper.visibleBounds.height&&(r=!0)}for(var c=0;c<this.documentHelper.pages.length;c++)n+=this.documentHelper.pages[c].boundingRectangle.height;for(var p=0,c=0;c<this.documentHelper.pages.length;c++)p<this.documentHelper.pages[c].boundingRectangle.width&&(p=this.documentHelper.pages[c].boundingRectangle.width);var u=n*this.documentHelper.zoomFactor+(this.documentHelper.pages.length+1)*this.pageGap*(1-this.documentHelper.zoomFactor)-this.documentHelper.visibleBounds.height,g=p*this.documentHelper.zoomFactor-this.documentHelper.visibleBounds.width;if(this.documentHelper.visibleBounds.width-p*this.documentHelper.zoomFactor<60&&(g+=60),u>0){var f=this.containerTop;if(this.visiblePages.length>0){t=this.visiblePages[0];var m=(t.boundingRectangle.y-(t.index+1)*this.pageGap)*e+(t.index+1)*this.pageGap,v=this.documentHelper.zoomY;d.isNullOrUndefined&&(v=this.documentHelper.visibleBounds.height/2);for(var y=f+v;y>m+t.boundingRectangle.height*e;){var w=t.index+1;if(w===this.documentHelper.pages.length)break;t=this.documentHelper.pages[w],m=(t.boundingRectangle.y-(t.index+1)*this.pageGap)*e+(t.index+1)*this.pageGap}f=(t.boundingRectangle.y-(t.index+1)*this.pageGap)*this.documentHelper.zoomFactor+(t.index+1)*this.pageGap+(y-m<0?y-m:(y-m)*(this.documentHelper.zoomFactor/e))-v,v=this.documentHelper.visibleBounds.height/2}this.documentHelper.viewerContainer.scrollTop=f}else this.documentHelper.viewerContainer.scrollTop=0;if(g>0){var f=this.containerLeft;if(this.visiblePages.length>0){null===t&&(t=this.visiblePages[0]);var b=this.documentHelper.zoomX;i.i(d.isNullOrUndefined)(b)&&(b=this.documentHelper.visibleBounds.width/2);var x=t.boundingRectangle.width*e/t.boundingRectangle.width,C=f+b;f=t.boundingRectangle.x+(C-t.boundingRectangle.x<0?C-t.boundingRectangle.x:(C-t.boundingRectangle.x)*(this.documentHelper.zoomFactor/x))-b,b=this.documentHelper.visibleBounds.width/2}this.documentHelper.viewerContainer.scrollLeft=f}else this.documentHelper.viewerContainer.scrollLeft=0;this.updateScrollBars(),r&&this.documentHelper.scrollToPosition(this.documentHelper.selection.start,this.documentHelper.selection.end),this instanceof S&&this.owner.editorModule.layoutWholeDocument()},e.prototype.updateCanvasWidthAndHeight=function(e,t,i,n,r,o){this instanceof T?this.documentHelper.visibleBounds.width!==this.documentHelper.viewerContainer.clientWidth?e-=this.documentHelper.visibleBounds.width-this.documentHelper.viewerContainer.clientWidth:i>t&&(e-=this.documentHelper.viewerContainer.offsetWidth-this.documentHelper.viewerContainer.clientWidth):i>t&&(e-=this.documentHelper.scrollbarWidth,n-=this.documentHelper.scrollbarWidth),n>e&&(t-=this.documentHelper.scrollbarWidth),r=n>e?n:e,o=i>t?i:t,parseInt(this.documentHelper.pageContainer.style.width.replace("px",""),10)===r&&parseInt(this.documentHelper.pageContainer.style.height.replace("px",""),10)===r||(this.documentHelper.pageContainer.style.width=r.toString()+"px",this.documentHelper.pageContainer.style.height=o.toString()+"px");var s=Math.max(1,window.devicePixelRatio||1);return this.documentHelper.containerCanvas.width===Math.floor(e*s)&&this.documentHelper.containerCanvas.height===Math.floor(t*s)||(this.documentHelper.containerCanvas.width=e*s,this.documentHelper.containerCanvas.height=t*s,this.documentHelper.containerCanvas.style.width=e+"px",this.documentHelper.containerCanvas.style.height=t+"px",this.documentHelper.containerContext.scale(s,s),this.documentHelper.selectionCanvas.width=e*s,this.documentHelper.selectionCanvas.height=t*s,this.documentHelper.selectionCanvas.style.width=e+"px",this.documentHelper.selectionCanvas.style.height=t+"px",this.documentHelper.selectionContext.scale(s,s)),{height:o,width:r,viewerWidth:e,viewerHeight:t,containerHeight:i,containerWidth:n}},e.prototype.updateScrollBarPosition=function(e,t,i,n,r,o){this.owner.viewer.containerTop=this.documentHelper.viewerContainer.scrollTop,this.owner.viewer.containerWidth=e,this.documentHelper.containerCanvas.style.position="absolute",this.documentHelper.containerCanvas.style.top=this.owner.viewer.containerTop.toString()+"px",this.documentHelper.selectionCanvas.style.position="absolute",this.documentHelper.selectionCanvas.style.top=this.owner.viewer.containerTop.toString()+"px",this.owner.viewer.containerLeft=this.documentHelper.viewerContainer.scrollLeft,this.documentHelper.containerCanvas.style.left=this.owner.viewer.containerLeft+"px",this.documentHelper.selectionCanvas.style.left=this.owner.viewer.containerLeft+"px"},e.prototype.destroy=function(){this.clientArea=void 0,this.clientActiveArea=void 0},e.prototype.componentDestroy=function(){this.clientArea=void 0,this.clientActiveArea=void 0,this.owner=void 0},e}(),T=function(e){function t(t){var i=e.call(this,t)||this;return i.pageLeft=30,i.owner=t,i}return C(t,e),Object.defineProperty(t.prototype,"pageGap",{get:function(){return this.owner.pageGap},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),t.prototype.createNewPage=function(e,t){var n=this,r=this.pageGap;this.documentHelper.pages.length>0&&(r=this.documentHelper.pages[this.documentHelper.pages.length-1].boundingRectangle.bottom+this.pageGap);var o=new h.A(this.documentHelper);return this.updatePageBoundingRectangle(e,o,r),i.i(d.isNullOrUndefined)(t)?this.documentHelper.pages.push(o):this.documentHelper.pages.splice(t,0,o),o.bodyWidgets.push(e),o.bodyWidgets[o.bodyWidgets.length-1].page=o,this.updateClientArea(e,o),this.documentHelper.layout.layoutHeaderFooter(e,n,o),this.updateClientArea(e,o),this.documentHelper.layout.footnoteHeight=0,o},t.prototype.updatePageBoundingRectangle=function(e,t,n){var r=i.i(d.isNullOrUndefined)(e.sectionFormat)?816:c.a.convertPointToPixel(e.sectionFormat.pageWidth),o=i.i(d.isNullOrUndefined)(e.sectionFormat)?1056:c.a.convertPointToPixel(e.sectionFormat.pageHeight),s=(this.documentHelper.visibleBounds.width-r*this.documentHelper.zoomFactor)/2;s<this.pageLeft&&(s=this.pageLeft),t.boundingRectangle=new h.t(s,n,r,o)},t.prototype.onPageFitTypeChanged=function(e){var t=this.documentHelper.visibleBounds.width,n=this.documentHelper.visibleBounds.height,r=this.visiblePages[0].bodyWidgets[0],o=c.a.convertPointToPixel(r.sectionFormat.pageWidth),s=c.a.convertPointToPixel(r.sectionFormat.pageHeight);switch(e){case"FitOnePage":if(n>0&&s>0){var a=(this.documentHelper.visibleBounds.height-2*this.pageGap-(this.pageGap-2))/s;a===this.documentHelper.zoomFactor?i.i(d.isNullOrUndefined)(this.owner.selection)||i.i(d.isNullOrUndefined)(this.owner.selection.start)||i.i(d.isNullOrUndefined)(this.owner.selection.end)||this.documentHelper.scrollToPosition(this.owner.selection.start,this.owner.selection.end):this.documentHelper.zoomFactor=a}break;case"FitPageWidth":t>0&&o>0&&(this.documentHelper.zoomFactor=(this.documentHelper.visibleBounds.width-80)/o);break;default:this.documentHelper.zoomFactor=1}},t.prototype.getCurrentPageHeaderFooter=function(e,t){return this.getCurrentHeaderFooter(this.getHeaderFooterType(e,t),e.index)},t.prototype.getHeaderFooterType=function(e,t){var n;n=t?"OddHeader":"OddFooter";var r=e.page;return e.sectionFormat.differentFirstPage&&(i.i(d.isNullOrUndefined)(r.previousPage)||!i.i(d.isNullOrUndefined)(r.previousPage)&&r.sectionIndex!==r.previousPage.sectionIndex&&r.previousPage.bodyWidgets[r.previousPage.bodyWidgets.length-1].sectionIndex!==r.bodyWidgets[0].sectionIndex)?n=t?"FirstPageHeader":"FirstPageFooter":e.sectionFormat.differentOddAndEvenPages&&(r.index+1)%2==0&&(n=t?"EvenHeader":"EvenFooter"),n},t.prototype.getCurrentHeaderFooter=function(e,t){if(this.documentHelper.headersFooters[t]){var i=this.getHeaderFooter(e),n=this.documentHelper.headersFooters[t][i];if(!n){for(var r=t>0?t-1:t;!n&&-1!==r;)n=this.documentHelper.headersFooters[r][i],r--;n||(n=this.createHeaderFooterWidget(e),n.isEmpty=!0),0==t&&(this.documentHelper.headersFooters[t][i]=n)}return n}if(t>0)return this.getCurrentHeaderFooter(e,t-1)},t.prototype.createHeaderFooterWidget=function(e){var t=new h.x(e),i=new h.g;i.childWidgets.push(new h.p(i));var n;return n=-1!==e.indexOf("Header")?this.documentHelper.styles.findByName("Header"):this.documentHelper.styles.findByName("Footer"),i.paragraphFormat.baseStyle=n,i.paragraphFormat.listFormat.baseStyle=n,t.childWidgets.push(i),i.containerWidget=t,t},t.prototype.getHeaderFooter=function(e){switch(e){case"OddHeader":return 0;case"OddFooter":return 1;case"EvenHeader":return 2;case"EvenFooter":return 3;case"FirstPageHeader":return 4;case"FirstPageFooter":return 5}},t.prototype.updateHFClientArea=function(e,t){var i=c.a.convertPointToPixel(e.pageWidth-e.leftMargin-e.rightMargin);i<0&&(i=0),this.clientArea=t?new h.t(c.a.convertPointToPixel(e.leftMargin),c.a.convertPointToPixel(e.headerDistance),i,Number.POSITIVE_INFINITY):new h.t(c.a.convertPointToPixel(e.leftMargin),c.a.convertPointToPixel(e.pageHeight-e.footerDistance),i,Number.POSITIVE_INFINITY),this.clientActiveArea=new h.t(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height)},t.prototype.updateHeaderFooterClientAreaWithTop=function(e,t,i){this.updateHFClientArea(e,t),t||i.footerWidget.y<this.clientActiveArea.y&&(this.clientActiveArea.y=i.footerWidget.y,this.clientActiveArea.height=Number.POSITIVE_INFINITY)},t.prototype.updateFootnoteClientArea=function(e,t,i,n){var r=c.a.convertPointToPixel(e.pageWidth-e.leftMargin-e.rightMargin),o=c.a.convertPointToPixel(e.leftMargin),s=c.a.convertPointToPixel(e.bottomMargin),a=c.a.convertPointToPixel(e.footerDistance),l=c.a.convertPointToPixel(e.pageHeight)-Math.max(a+t.page.footerWidget.height,s);this.clientArea=new h.t(o,l,r,Number.POSITIVE_INFINITY),this.clientActiveArea=new h.t(this.clientArea.x,this.clientArea.y,this.clientArea.width,Number.POSITIVE_INFINITY)},t.prototype.scrollToPage=function(e){for(var t=0,i=0;i<this.documentHelper.pages.length&&(t=this.documentHelper.pages[i].boundingRectangle.y-this.pageGap/2,i!==e);i++);this.documentHelper.viewerContainer.scrollTop=t,this.updateScrollBars()},t.prototype.updateScrollBars=function(){var e;e=this.getPageHeightAndWidth(0,0,0,0);var t,i=e.width*this.documentHelper.zoomFactor+2*this.pageLeft,n=e.height*this.documentHelper.zoomFactor+(this.documentHelper.pages.length+1)*this.pageGap;t=this.updateCanvasWidthAndHeight(e.viewerWidth,e.viewerHeight,n,i,e.width,e.height),n=t.containerHeight,i=t.containerWidth,this.documentHelper.containerContext.globalAlpha=1,this.documentHelper.selectionContext.globalAlpha=.4;for(var r=0;r<this.documentHelper.pages.length;r++){var o=(t.width-this.documentHelper.pages[r].boundingRectangle.width*this.documentHelper.zoomFactor)/2;o>this.pageLeft?this.documentHelper.pages[r].boundingRectangle=new h.t(o,this.documentHelper.pages[r].boundingRectangle.y,this.documentHelper.pages[r].boundingRectangle.width,this.documentHelper.pages[r].boundingRectangle.height):this.documentHelper.pages[r].boundingRectangle=new h.t(this.pageLeft,this.documentHelper.pages[r].boundingRectangle.y,this.documentHelper.pages[r].boundingRectangle.width,this.documentHelper.pages[r].boundingRectangle.height)}this.updateScrollBarPosition(i,n,t.viewerWidth,t.viewerHeight,t.width,t.height),this.updateVisiblePages(),this.documentHelper.isScrollToSpellCheck=!1},t.prototype.updateVisiblePages=function(){this.visiblePages=[];for(var e=0;e<this.documentHelper.pages.length;e++){var t=this.documentHelper.pages[e],i=(t.boundingRectangle.y-this.pageGap*(e+1))*this.documentHelper.zoomFactor+this.pageGap*(e+1),n=t.boundingRectangle.x;this.documentHelper.isPageInVisibleBound(t,i)&&this.addVisiblePage(t,n,i)}},t.prototype.addVisiblePage=function(e,t,n){var r=this,o=e.boundingRectangle.width*this.documentHelper.zoomFactor,s=e.boundingRectangle.height*this.documentHelper.zoomFactor;if(this.owner.enableImageResizerMode&&void 0!==this.owner.imageResizerModule.currentPage&&this.owner.imageResizerModule.currentPage===e&&this.owner.imageResizerModule.isImageResizerVisible&&this.owner.imageResizerModule.setImageResizerPositions(t,n,o,s),this.visiblePages.push(e),this.documentHelper.owner.isSpellCheck&&this.documentHelper.owner.spellChecker.enableOptimizedSpellCheck&&(this.owner.documentHelper.triggerElementsOnLoading||this.owner.documentHelper.isScrollHandler)&&(this.documentHelper.cachedPages.indexOf(e.index)<0||this.owner.editor.isPasteContentCheck)){this.owner.documentHelper.cachedPages.push(e.index);var a=void 0;a=this.owner.editor.isPasteContentCheck?i.i(d.isNullOrUndefined)(this.owner.editor.copiedTextContent)?"":this.owner.editor.copiedTextContent:this.documentHelper.owner.spellChecker.getPageContent(e),a.trim().length>0?(e.allowNextPageRendering=!1,i.i(d.isNullOrUndefined)(this.owner)||i.i(d.isNullOrUndefined)(this.owner.spellChecker)||this.owner.spellChecker.updateUniqueWords(c.a.getSpellCheckData(a)),this.owner.spellChecker.callSpellChecker(this.owner.spellChecker.languageID,a,!0,!1,!1,!0).then(function(a){var l=JSON.parse(a);i.i(d.isNullOrUndefined)(r.owner)||i.i(d.isNullOrUndefined)(r.owner.spellChecker)||r.owner.spellChecker.updateUniqueWords(l.SpellCollection),e.allowNextPageRendering=!0,r.documentHelper.triggerElementsOnLoading=!0,r.documentHelper.triggerSpellCheck=!0,r.documentHelper.triggerElementsOnLoading=!0,r.renderPage(e,t,n,o,s),r.documentHelper.triggerSpellCheck=!1,r.documentHelper.triggerElementsOnLoading=!1})):this.renderPage(e,t,n,o,s)}else this.renderPage(e,t,n,o,s)},t.prototype.renderPage=function(e,t,i,n,r){this.documentHelper.render.renderWidgets(e,t-this.owner.viewer.containerLeft,i-this.owner.viewer.containerTop,n,r)},t}(P),S=function(e){function t(t){var i=e.call(this,t)||this;return i.visiblePages=[],i.owner=t,i}return C(t,e),Object.defineProperty(t.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageGap",{get:function(){return 0},enumerable:!0,configurable:!0}),t.prototype.createNewPage=function(e,t){var i,n=0;return this.documentHelper.pages.length>0&&(n=this.documentHelper.pages[this.documentHelper.pages.length-1].boundingRectangle.bottom),i=new h.A(this.documentHelper),0===this.documentHelper.pages.length?i.boundingRectangle=new h.t(10,n,this.documentHelper.visibleBounds.width,this.documentHelper.visibleBounds.height):i.boundingRectangle=new h.t(10,n-20,this.documentHelper.visibleBounds.width,this.documentHelper.visibleBounds.height),this.documentHelper.pages.push(i),this.updateClientArea(void 0,i),i.bodyWidgets.push(e),i.bodyWidgets[i.bodyWidgets.length-1].page=i,i},t.prototype.onPageFitTypeChanged=function(e){this.documentHelper.zoomFactor=1},t.prototype.scrollToPage=function(e){this.updateScrollBars()},t.prototype.getContentHeight=function(){for(var e=0,t=0;t<this.documentHelper.pages.length;t++){var i=this.documentHelper.pages[t];0===t?(e+=this.padding.top,i.boundingRectangle.y=this.padding.top):i.boundingRectangle.y=this.documentHelper.pages[t-1].boundingRectangle.bottom,i.boundingRectangle.height=i.bodyWidgets[0].height,e+=i.bodyWidgets[0].height,t===this.documentHelper.pages.length-1&&(e+=this.padding.bottom)}return e},t.prototype.getContentWidth=function(){for(var e=this.documentHelper.visibleBounds.width,t=e,i=0;i<this.documentHelper.pages.length;i++){for(var n=this.documentHelper.pages[i],r=0;r<n.bodyWidgets[0].childWidgets.length;r++)if(n.bodyWidgets[0].childWidgets[r]instanceof h.u){var o=n.bodyWidgets[0].childWidgets[r],s=c.a.convertPointToPixel(o.getTableWidth())*this.documentHelper.zoomFactor+4*this.padding.left+4*this.padding.right+n.boundingRectangle.x;t<s&&(e=s,t=s)}n.boundingRectangle.width=e}return e},t.prototype.updateScrollBars=function(){var e;e=this.getPageHeightAndWidth(0,0,0,0);var t,i=this.getContentWidth()*this.documentHelper.zoomFactor+this.padding.left+this.padding.right,n=this.getContentHeight()*this.documentHelper.zoomFactor+this.padding.top+this.padding.bottom;t=this.updateCanvasWidthAndHeight(e.viewerWidth,e.viewerHeight,n,i,e.width,e.height),this.documentHelper.containerContext.globalAlpha=1,this.documentHelper.selectionContext.globalAlpha=.4,this.updateScrollBarPosition(i,n,t.viewerWidth,t.viewerHeight,t.width,t.height),this.updateVisiblePages(),this.documentHelper.isScrollToSpellCheck=!1},t.prototype.updateVisiblePages=function(){this.visiblePages=[];for(var e,t,i=this.documentHelper.visibleBounds.height,n=this.documentHelper.viewerContainer.scrollTop,r=0;r<this.documentHelper.pages.length;r++){e=this.documentHelper.pages[r],t=e.boundingRectangle.y*this.documentHelper.zoomFactor;var o=e.boundingRectangle.height*this.documentHelper.zoomFactor,s=t>=n&&t<=n+i,a=t+o>=n&&t+o<=n+i,l=t<=n&&t+o>=n+i;(s||a||l)&&this.addVisiblePage(e,this.padding.left,t)}},t.prototype.addVisiblePage=function(e,t,n){var r=this,o=this.getContentWidth(),s=this.getContentHeight()*this.documentHelper.zoomFactor+this.padding.top+this.padding.bottom;if(this.owner.enableImageResizerMode&&void 0!==this.owner.imageResizerModule.currentPage&&this.owner.imageResizerModule.currentPage===e&&this.owner.imageResizerModule.isImageResizerVisible&&this.owner.imageResizerModule.setImageResizerPositions(t,n,o,s),this.visiblePages.push(e),this.documentHelper.owner.isSpellCheck&&this.documentHelper.owner.spellChecker.enableOptimizedSpellCheck&&(this.owner.documentHelper.triggerElementsOnLoading||this.owner.documentHelper.isScrollHandler)&&(this.documentHelper.cachedPages.indexOf(e.index)<0||this.owner.editor.isPasteContentCheck)){this.owner.documentHelper.cachedPages.push(e.index);var a=void 0;a=this.owner.editor.isPasteContentCheck?i.i(d.isNullOrUndefined)(this.owner.editor.copiedTextContent)?"":this.owner.editor.copiedTextContent:this.documentHelper.owner.spellChecker.getPageContent(e),a.trim().length>0?(e.allowNextPageRendering=!1,i.i(d.isNullOrUndefined)(this.owner)||i.i(d.isNullOrUndefined)(this.owner.spellChecker)||this.owner.spellChecker.updateUniqueWords(c.a.getSpellCheckData(a)),this.owner.spellChecker.callSpellChecker(this.owner.spellChecker.languageID,a,!0,!1,!1,!0).then(function(a){var l=JSON.parse(a);i.i(d.isNullOrUndefined)(r.owner)||i.i(d.isNullOrUndefined)(r.owner.spellChecker)||r.owner.spellChecker.updateUniqueWords(l.SpellCollection),e.allowNextPageRendering=!0,r.owner.documentHelper.triggerSpellCheck=!0,r.owner.documentHelper.triggerElementsOnLoading=!0,r.renderPage(e,t,n,o,s),r.owner.documentHelper.triggerSpellCheck=!1,r.owner.documentHelper.triggerElementsOnLoading=!1})):this.renderPage(e,t,n,o,s)}else this.renderPage(e,t,n,o,s)},t.prototype.renderPage=function(e,t,i,n,r){this.documentHelper.render.renderWidgets(e,t-this.owner.viewer.containerLeft,i-this.owner.viewer.containerTop,n,r)},t}(P),W=function(){function e(e){this.viewerIn=e,this.clear()}return Object.defineProperty(e.prototype,"currentIndex",{get:function(){return this.currentIndexIn},set:function(e){e>=0&&(this.currentIndexIn=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columnCount",{get:function(){var e;return i.i(d.isNullOrUndefined)(this.columnIn)||(e=this.numberOfColumnsIn),e=e>0?e:1},enumerable:!0,configurable:!0}),e.prototype.setColumns=function(e){if(this.pageWidth=c.a.convertPointToPixel(e.pageWidth-e.leftMargin-e.rightMargin),this.numberOfColumnsIn=e.numberOfColumns,!i.i(d.isNullOrUndefined)(e.columns)){for(var t=e.columns,n=[],r=0;r<e.numberOfColumns;r++){var o=this.defaultSpaceIn,s=0;!i.i(d.isNullOrUndefined)(t)&&t.length>0&&(o=t[r].space,s=t[r].width);var a=this.getColumnObj(s,o,e.numberOfColumns,e.equalWidth);a.index=r,n.push(a)}this.columnIn=n}},e.prototype.clear=function(){this.currentIndexIn=0,this.defaultSpaceIn=36,this.columnIn=null,this.pageWidth=0},e.prototype.reset=function(){this.currentIndex=0},e.prototype.getColumnBounds=function(e,t){var i=this.currentIndexIn;return this.getColumnBoundsByIndex(i,t)},e.prototype.getColumnBoundsByBodyWidget=function(e,t){var i=e.columnIndex;return this.getColumnBoundsByIndex(i,t)},e.prototype.getNextColumnByBodyWidget=function(e){var t=e.columnIndex;return this.getColumnByIndex(t+1)},e.prototype.getColumnByIndex=function(e){if(e>=0&&e<this.columnCount&&!i.i(d.isNullOrUndefined)(this.columnIn)&&this.columnIn.length>0)return this.columnIn[e]},e.prototype.getColumnObj=function(e,t,n,r){var o=(n-1)*t,a=new s.j;return!r&&0!==e||i.i(d.isNullOrUndefined)(this.pageWidth)||(e=(this.pageWidth-o)/n),a.width=e,a.space=t,a},e.prototype.getColumnBoundsByIndex=function(e,t){var n=new h.t(t.x,t.y,t.width,t.height);if(e>=0&&this.columnIn.length>0){var r=void 0,o=void 0;if(!i.i(d.isNullOrUndefined)(this.columnIn[e])){r=this.getColumnByIndex(e),n.width=r.width;for(var s=0;s<e;s++)o=this.columnIn[s],n.x+=o.width,n.x+=o.space}}return n},e}()},function(e,t){e.exports=l},function(e,t,i){"use strict";var n=i(94);i.d(t,"d",function(){return n.a});var r=i(102);i.d(t,"e",function(){return r.a});var o=i(88);i.d(t,"f",function(){return o.a});var s=i(103);i.d(t,"g",function(){return s.a});var a=i(98);i.d(t,"h",function(){return a.a});var l=i(99);i.d(t,"i",function(){return l.a});var d=i(95);i.d(t,"j",function(){return d.a});var h=i(100);i.d(t,"k",function(){return h.a});var c=i(90);i.d(t,"c",function(){return c.a});var p=i(92);i.d(t,"l",function(){return p.a});var u=i(105);i.d(t,"m",function(){return u.a});var g=i(89);i.d(t,"n",function(){return g.a});var f=i(104);i.d(t,"o",function(){return f.a});var m=i(91);i.d(t,"b",function(){return m.a});var v=i(101);i.d(t,"p",function(){return v.a});var y=i(51);i.d(t,"q",function(){return y.a});var w=i(93);i.d(t,"a",function(){return w.a});var b=i(50);i.d(t,"r",function(){return b.a});var x=i(48);i.d(t,"s",function(){return x.a});var C=i(49);i.d(t,"t",function(){return C.a});var I=i(47);i.d(t,"u",function(){return I.a});var F=i(52);i.d(t,"v",function(){return F.a})},function(e,t,i){"use strict";i.d(t,"c",function(){return r}),i.d(t,"d",function(){return o}),i.d(t,"a",function(){return s}),i.d(t,"b",function(){return a}),i.d(t,"e",function(){return l}),i.d(t,"f",function(){return d}),i.d(t,"g",function(){return h}),i.d(t,"h",function(){return c});var n=i(2),r=function(){function e(e,t){this.ownerListLevelIn=void 0,this.modifiedListLevelIn=void 0,this.ownerListLevel=e,this.modifiedListLevel=t}return Object.defineProperty(e.prototype,"ownerListLevel",{get:function(){return this.ownerListLevelIn},set:function(e){this.ownerListLevelIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"modifiedListLevel",{get:function(){return this.modifiedListLevelIn},set:function(e){this.modifiedListLevelIn=e},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.ownerListLevel=void 0,this.modifiedListLevel=void 0},e}(),o=function(){function e(e,t){this.ownerFormatIn=void 0,this.modifiedFormatIn=void 0,this.ownerFormat=e,this.modifiedFormat=t}return Object.defineProperty(e.prototype,"ownerFormat",{get:function(){return this.ownerFormatIn},set:function(e){this.ownerFormatIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"modifiedFormat",{get:function(){return this.modifiedFormatIn},set:function(e){this.modifiedFormatIn=e},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.modifiedFormat&&this.modifiedFormat.destroy(),this.modifiedFormat=void 0,this.ownerFormat=void 0},e}(),s=function(){function e(e,t,i,n){this.startingPoint=t,this.rowFormat=i,this.rowHeightType=i.heightType,this.tableHierarchicalIndex=n.selection.getHierarchicalIndex(e,"0")}return e.prototype.revertChanges=function(e,t,i){var n=this.rowFormat.heightType,r=i.childWidgets[this.rowFormat.ownerBase.index];t.editorModule.tableResize.updateRowHeight(r,e?this.displacement:-this.displacement),t.documentHelper.layout.reLayoutTable(i),this.rowFormat.heightType!==this.rowHeightType&&(this.rowFormat.heightType=this.rowHeightType),this.rowHeightType=n},e}(),a=function(){function e(e,t){this.tableHolder=new n.L,this.tableFormat=new l,this.rows=[],this.owner=t,this.copyProperties(e)}return e.prototype.copyProperties=function(e){e.tableHolder&&(this.tableHolder=e.tableHolder.clone()),e.tableFormat&&(this.tableFormat.leftIndent=e.tableFormat.leftIndent,this.tableFormat.preferredWidth=e.tableFormat.preferredWidth,this.tableFormat.preferredWidthType=e.tableFormat.preferredWidthType,this.tableFormat.allowAutoFit=e.tableFormat.allowAutoFit);for(var t=0;t<e.childWidgets.length;t++){var i=e.childWidgets[parseInt(t.toString(),10)],n=new d;n.gridBefore=i.rowFormat.gridBefore,n.gridBeforeWidth=i.rowFormat.gridBeforeWidth,n.gridBeforeWidthType=i.rowFormat.gridBeforeWidthType,n.gridAfter=i.rowFormat.gridAfter,n.gridAfterWidth=i.rowFormat.gridAfterWidth,n.gridAfterWidthType=i.rowFormat.gridAfterWidthType;for(var r=0;r<i.childWidgets.length;r++){var o=i.childWidgets[parseInt(r.toString(),10)],s=new h;s.columnIndex=o.columnIndex,s.columnSpan=o.cellFormat.columnSpan,s.preferredWidth=o.cellFormat.preferredWidth,s.preferredWidthType=o.cellFormat.preferredWidthType,n.cells.push(s)}this.rows.push(n)}this.tableHierarchicalIndex=this.owner.selection.getHierarchicalIndex(e,"0")},e.prototype.destroy=function(){this.tableHierarchicalIndex=void 0,this.tableHolder&&(this.tableHolder.destroy(),this.tableHolder=void 0),this.tableFormat&&(this.tableFormat=null),this.rows&&(this.rows=[],this.rows=void 0)},e}(),l=function(){function e(){}return e}(),d=function(){function e(){this.cells=[]}return e}(),h=function(){function e(){}return e}(),c=function(){function e(e){this.startingPoint=e}return e}()},function(e,t,i){"use strict";var n=i(106);i.d(t,"b",function(){return n.a});var r=i(29);i.d(t,"c",function(){return r.a});var o=i(53);i.d(t,"a",function(){return o.a});var s=i(35);i.d(t,"d",function(){return s.c}),i.d(t,"e",function(){return s.d}),i.d(t,"f",function(){return s.a}),i.d(t,"g",function(){return s.b}),i.d(t,"h",function(){return s.e}),i.d(t,"i",function(){return s.f}),i.d(t,"j",function(){return s.g}),i.d(t,"k",function(){return s.h})},function(e,t,i){"use strict";i.d(t,"a",function(){return a});var n=i(0),r=(i.n(n),i(12)),o=i(13),s=i(6),a=function(){function e(e){this.uniqueShadingFormat=void 0,this.ownerBase=void 0,this.ownerBase=e}return Object.defineProperty(e.prototype,"backgroundColor",{get:function(){return this.getPropertyValue("backgroundColor")},set:function(e){this.setPropertyValue("backgroundColor",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"foregroundColor",{get:function(){return this.getPropertyValue("foregroundColor")},set:function(e){this.setPropertyValue("foregroundColor",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textureStyle",{get:function(){return this.getPropertyValue("textureStyle")},set:function(e){this.setPropertyValue("textureStyle",e)},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(t){if(this.hasValue(t)){var o=r.a.getPropertyType(e.uniqueFormatType,t);if(!i.i(n.isNullOrUndefined)(this.uniqueShadingFormat)&&this.uniqueShadingFormat.propertiesHash.containsKey(o))return this.uniqueShadingFormat.propertiesHash.get(o)}return e.getPropertyDefaultValue(t)},e.prototype.setPropertyValue=function(t,o){if((i.i(n.isNullOrUndefined)(o)||""===o)&&(o=e.getPropertyDefaultValue(t)),i.i(n.isNullOrUndefined)(this.uniqueShadingFormat))this.initializeUniqueShading(t,o);else{var s=r.a.getPropertyType(this.uniqueShadingFormat.uniqueFormatType,t);if(this.uniqueShadingFormat.propertiesHash.containsKey(s)&&this.uniqueShadingFormat.propertiesHash.get(s)===o)return;this.uniqueShadingFormat=e.uniqueShadingFormats.updateUniqueFormat(this.uniqueShadingFormat,t,o)}},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"backgroundColor":case"foregroundColor":t="empty";break;case"textureStyle":t="TextureNone"}return t},e.prototype.initializeUniqueShading=function(t,i){var n=new s.a;this.addUniqueShading("backgroundColor",t,i,n),this.addUniqueShading("foregroundColor",t,i,n),this.addUniqueShading("textureStyle",t,i,n),this.uniqueShadingFormat=e.uniqueShadingFormats.addUniqueFormat(n,e.uniqueFormatType)},e.prototype.addUniqueShading=function(t,i,n,o){var s=r.a.getPropertyType(e.uniqueFormatType,t);t===i?o.add(s,n):o.add(s,e.getPropertyDefaultValue(t))},e.prototype.destroy=function(){i.i(n.isNullOrUndefined)(this.uniqueShadingFormat)||e.uniqueShadingFormats.remove(this.uniqueShadingFormat),this.uniqueShadingFormat=void 0},e.prototype.cloneFormat=function(){var t=new e(void 0);return t.backgroundColor=this.backgroundColor,t.foregroundColor=this.foregroundColor,t.textureStyle=this.textureStyle,t},e.prototype.copyFormat=function(e){i.i(n.isNullOrUndefined)(e)||i.i(n.isNullOrUndefined)(e.uniqueShadingFormat)||(this.backgroundColor=e.backgroundColor,this.foregroundColor=e.foregroundColor,this.textureStyle=e.textureStyle)},e.prototype.hasValue=function(e){if(!i.i(n.isNullOrUndefined)(this.uniqueShadingFormat)){var t=r.a.getPropertyType(this.uniqueShadingFormat.uniqueFormatType,e);return this.uniqueShadingFormat.propertiesHash.containsKey(t)}return!1},e.clear=function(){this.uniqueShadingFormats.clear()},e.uniqueShadingFormats=new o.a,e.uniqueFormatType=5,e}()},function(e,t,i){"use strict";i.d(t,"a",function(){return l}),i.d(t,"b",function(){return d});var n=i(6),r=i(0),o=(i.n(r),i(20)),s=i(2),a=i(11),l=function(){function e(e){this.wordBefore="\\b",this.wordAfter="\\b",this.owner=e,this.documentHelper=this.owner.documentHelper}return e.prototype.find=function(e,t){return this.findNext(e,t,"0;0;0")},e.prototype.findNext=function(e,t,i){"string"==typeof e&&(e=this.stringToRegex(e,t)),void 0===i&&(i="0;0;0"),this.owner.searchModule.textSearchResults.clearResults();var n=this.owner.searchModule.textSearchResults;return this.findDocument(n,e,!0,t,i),n.length,n.currentSearchResult},e.prototype.stringToRegex=function(e,t){if(e.indexOf("\\")>-1&&(e=e.split("\\").join("\\\\")),e.indexOf("(")>-1||e.indexOf(")")>-1||e.indexOf(".")>-1||e.indexOf("[")>-1||e.indexOf("]")>-1||e.indexOf("$")>-1||e.indexOf("{")>-1||e.indexOf("}")>-1||e.indexOf("*")>-1||e.indexOf("|")>-1||e.indexOf("^")>-1||e.indexOf("?")>-1){for(var i="",n=0;n<e.length;n++)"("===e[parseInt(n.toString(),10)]||")"===e[parseInt(n.toString(),10)]||"."===e[parseInt(n.toString(),10)]||"["===e[parseInt(n.toString(),10)]||"]"===e[parseInt(n.toString(),10)]||"$"===e[parseInt(n.toString(),10)]||"{"===e[parseInt(n.toString(),10)]||"}"===e[parseInt(n.toString(),10)]||"*"===e[parseInt(n.toString(),10)]||"|"===e[parseInt(n.toString(),10)]||"^"===e[parseInt(n.toString(),10)]||"?"===e[parseInt(n.toString(),10)]?i+="\\"+e[parseInt(n.toString(),10)]:i+=e[parseInt(n.toString(),10)];e=i}return"WholeWord"!==t&&"CaseSensitiveWholeWord"!==t||(e=this.wordBefore+e+this.wordAfter),RegExp(e,"CaseSensitive"===t||"CaseSensitiveWholeWord"===t?"g":"ig")},e.prototype.isPatternEmpty=function(e){var t=this.wordBefore+this.wordAfter,i=e.toString();return 0===i.length||i===t},e.prototype.findAll=function(e,t,n){"string"==typeof e&&(e=this.stringToRegex(e,t)),void 0===n&&(n="0;0;0"),this.owner.searchModule.textSearchResults.clearResults();var o=this.owner.searchModule.textSearchResults;if(this.findDocument(o,e,!1,t,n),o.length>0&&o.currentIndex<0&&(o.currentIndex=0),!i.i(r.isNullOrUndefined)(o.currentSearchResult)){var s={source:this.documentHelper.owner};return this.documentHelper.owner.trigger(a.w,s),o}},e.prototype.getElementInfo=function(e,t,o,a,l,d,h,c,p){for(var u=e,g="",f=new n.a,m=0;;){if(e instanceof s.d&&!i.i(r.isNullOrUndefined)(e.text)&&""!==e.text)f.add(e,p?g.length+m:g.length),m=0,g+=e===u?e.text.substring(t):e.text;else if(e instanceof s.b){var v=e;i.i(r.isNullOrUndefined)(v.fieldEnd)||(e=i.i(r.isNullOrUndefined)(v.fieldSeparator)?v.fieldEnd:v.fieldSeparator)}else e instanceof s.s&&!i.i(r.isNullOrUndefined)(e.textFrame)&&e.textFrame.childWidgets.length>0&&this.findInlineText(e.textFrame,a,l,d,h,c);if(e instanceof s.d||(m+=e.length),!i.i(r.isNullOrUndefined)(e)&&i.i(r.isNullOrUndefined)(e.nextNode))break;if(!i.i(r.isNullOrUndefined)(e))if(i.i(r.isNullOrUndefined)(o)||o)e=e.nextNode;else{var y=e.line.children,w=e.line.children.length;if(!(y.indexOf(e)<w-1)){e=void 0;break}e=e.nextNode}}return{elementsWithOffset:f,fullText:g.toString()}},e.prototype.updateMatchedTextLocation=function(e,t,n,o,s,a,l,d){for(var h=0;h<e.length;h++){var c=e[parseInt(h.toString(),10)],p=void 0;if(i.i(r.isNullOrUndefined)(d)||!(c.index<d)){for(var u=t.addResult(),g=n.keys,f=0;f<g.length;f++){var m=g[parseInt(f.toString(),10)],v=n.get(m),y=m.length;if(m===s&&(y-=o),i.i(r.isNullOrUndefined)(u.start)&&c.index<v+y){var w=c.index-v;m===s&&(w+=o);var b=m.line.getOffset(m,w);u.start=this.getTextPosition(m.line,b.toString()),u.start.location=this.owner.selection.getPhysicalPositionInternal(m.line,b,!0),u.start.setPositionParagraph(m.line,b)}if(c.index+c[0].length<=v+y){var w=c.index+c[0].length-v;m===s&&(w+=o);var b=m.line.getOffset(m,w);u.end=this.getTextPosition(m.line,b.toString()),u.end.location=this.owner.selection.getPhysicalPositionInternal(m.line,b,!0),u.end.setPositionParagraph(m.line,b),p=!0;break}}if(a){t.currentIndex=0;break}if(t.currentIndex<0&&!i.i(r.isNullOrUndefined)(l)&&(l.isExistBefore(u.start)||l.isAtSamePosition(u.start))&&(t.currentIndex=t.indexOf(u)),!i.i(r.isNullOrUndefined)(d)&&p)break}}},e.prototype.findDocument=function(e,t,n,o,a){if(!this.isPatternEmpty(t)){void 0===o&&(o="None");var l=void 0,d=void 0;if(void 0!==a&&(d=this.owner.selection.end),void 0!==a&&n&&void 0!==d&&void 0!==d.paragraph&&d.paragraph instanceof s.g){var h=0,c=d.currentWidget.getInline(this.owner.selection.start.offset,h);if(l=c.element,h=c.index,!i.i(r.isNullOrUndefined)(l)){var p=void 0;for(p=this.findInline(l,t,o,h,n,e,d);0===e.length&&!i.i(r.isNullOrUndefined)(p);){for(;!i.i(r.isNullOrUndefined)(p)&&0===p.childWidgets.length;)p=this.owner.selection.getNextParagraph(p.containerWidget);if(i.i(r.isNullOrUndefined)(p))break;var u=p.childWidgets[0];if(l=u.children[0]instanceof s.q?u.children[2]instanceof s.d?u.children[2]:void 0:u.children[0],i.i(r.isNullOrUndefined)(l))break;p=this.findInline(l,t,o,0,n,e,d)}if(e.length>0)return}}var g;for(g=this.documentHelper.pages[0].bodyWidgets[0];!i.i(r.isNullOrUndefined)(g)&&0===g.childWidgets.length;)g=g.nextWidget;if(!i.i(r.isNullOrUndefined)(g)&&0!==g.childWidgets.length){this.findInlineText(g,t,o,n,e,d);for(var f=this.documentHelper.headersFooters,m=0;m<f.length;m++){var v=f[parseInt(m.toString(),10)];if(v)for(var y in v){var w=v[parseInt(y.toString(),10)];i.i(r.isNullOrUndefined)(w)||i.i(r.isNullOrUndefined)(w.page)||this.findInlineText(w,t,o,n,e,d)}}for(var b=this.documentHelper.endnoteCollection,m=0;m<b.length;m++){var x=b[parseInt(m.toString(),10)];x&&(i.i(r.isNullOrUndefined)(x)||i.i(r.isNullOrUndefined)(x.bodyWidget.page)||this.findInlineText(x.bodyWidget,t,o,n,e,d))}for(var C=this.documentHelper.footnoteCollection,m=0;m<C.length;m++){var I=C[parseInt(m.toString(),10)];I&&(i.i(r.isNullOrUndefined)(I)||i.i(r.isNullOrUndefined)(I.bodyWidget.page)||this.findInlineText(I.bodyWidget,t,o,n,e,d))}n&&!i.i(r.isNullOrUndefined)(e)&&e.length}}},e.prototype.findInlineText=function(e,t,n,o,s,a){for(var l=this.owner.documentHelper.getFirstParagraphBlock(e.childWidgets[0]);!i.i(r.isNullOrUndefined)(l)&&1===l.childWidgets.length&&0===l.childWidgets[0].children.length;)l=this.owner.selection.getNextParagraphBlock(l);for(;!i.i(r.isNullOrUndefined)(l)&&l.childWidgets.length>0;){var d=l.childWidgets[0],h=d.children[0];if(i.i(r.isNullOrUndefined)(h))break;for(this.findInline(h,t,n,0,o,s,a),l=this.owner.selection.getNextParagraphBlock(l);!i.i(r.isNullOrUndefined)(l)&&1===l.childWidgets.length&&0===l.childWidgets[0].children.length;)l=this.owner.selection.getNextParagraphBlock(l)}o&&!i.i(r.isNullOrUndefined)(s)&&s.length},e.prototype.findInline=function(e,t,n,o,s,a,l){for(var d,h=e,c=this.getElementInfo(e,o,void 0,t,n,s,a,l),p=c.fullText,u=[],g=c.elementsWithOffset;!i.i(r.isNullOrUndefined)(d=t.exec(p));)u.push(d);if(this.updateMatchedTextLocation(u,a,g,o,h,s,l),!s){return this.owner.selection.getNextParagraphBlock(e.line.paragraph)}},e.prototype.getTextPosition=function(e,t){var i=new o.a(this.owner),n=i.getHierarchicalIndex(e,t);return i.setPositionForCurrentIndex(n),i},e}(),d=function(){function e(e,t){this.leftInternal=0,this.widthInternal=0,this.leftInternal=e,this.widthInternal=t}return Object.defineProperty(e.prototype,"left",{get:function(){return this.leftInternal},set:function(e){this.leftInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.widthInternal},set:function(e){this.widthInternal=e},enumerable:!0,configurable:!0}),e}()},function(e,t,i){"use strict";i.d(t,"a",function(){return c}),i.d(t,"b",function(){return p});var n=i(0),r=(i.n(n),i(15)),o=(i.n(r),i(3)),s=(i.n(o),i(19)),a=(i.n(s),i(2)),l=i(7),d=i(4),h=i(11),c=function(){function e(e,t){this.users=[],this.enableButtons=!0,this.viewTypeitems=[],this.sortedRevisions=[],this.noChangesVisibleInternal=!0,this.isTrackingPageBreak=!1,this.tableRevisions=new h.g,this.owner=e,this.commentReviewPane=t,this.locale=new n.L10n("documenteditor",this.owner.defaultLocale),this.locale.setLocale(this.owner.locale),this.selectedUser=this.locale.getConstant("All"),this.selectedType=this.locale.getConstant("All"),this.initTrackChangePane(),this.commentReviewPane.reviewTab.items[1].content=this.trackChangeDiv,n.Browser.isIE||this.commentReviewPane.reviewTab.refresh(),this.owner.enableRtl?this.closeButton=i.i(n.createElement)("button",{className:"e-de-close-icon e-btn e-flat e-icon-btn",id:"close",attrs:{type:"button",style:"position:absolute;top:6px;left:1px"}}):this.closeButton=i.i(n.createElement)("button",{className:"e-de-close-icon e-btn e-flat e-icon-btn",id:"close",attrs:{type:"button",style:"position:absolute;top:6px;right:1px"}}),this.closeButton.title=this.locale.getConstant("Close"),this.closeButton.setAttribute("aria-label",this.locale.getConstant("Close"));var r=i.i(n.createElement)("span",{className:"e-de-op-close-icon e-de-close-icon e-btn-icon e-icons"});this.closeButton.appendChild(r),this.commentReviewPane.reviewTab.element.appendChild(this.closeButton),this.closeButton.addEventListener("click",this.commentReviewPane.closePane.bind(this.commentReviewPane))}return Object.defineProperty(e.prototype,"setNoChangesVisibility",{get:function(){return this.noChangesVisibleInternal},set:function(e){this.isChangesTabVisible=!e,this.noChangeDivElement.style.display=e?"block":"none",this.noChangesVisibleInternal=e,this.enableDisableToolbarItem(!e),this.commentReviewPane.reviewTab.hideTab(1,e),this.owner.notify("reviewPane",{changes:!e,comment:this.commentReviewPane.isCommentTabVisible})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentSelectedRevision",{get:function(){return this.currentSelectedRevisionInternal},set:function(e){var t=i.i(n.select)(".e-de-trckchanges-inner-select",this.changesInfoDiv);if(i.i(n.isNullOrUndefined)(e))i.i(n.isNullOrUndefined)(t)||t.classList.remove("e-de-trckchanges-inner-select");else if((e!==this.currentSelectedRevisionInternal||i.i(n.isNullOrUndefined)(t))&&(t&&t.classList.remove("e-de-trckchanges-inner-select"),this.changes.length>0&&this.changes.containsKey(e))){var r=this.changes.get(e);r.singleInnerDiv.classList.add("e-de-trckchanges-inner-select")}this.currentSelectedRevisionInternal=e,t=i.i(n.select)(".e-de-trckchanges-inner-select",this.changesInfoDiv),i.i(n.isNullOrUndefined)(t)||t.parentElement.scrollIntoView({block:"nearest"})},enumerable:!0,configurable:!0}),e.prototype.initTrackChangePane=function(){this.changes=new h.g,this.renderedChanges=new h.g,this.trackChangeDiv=i.i(n.createElement)("div",{className:"e-de-tc-pane"}),this.trackChangeDiv.appendChild(this.initPaneHeader()),this.changesInfoDiv=i.i(n.createElement)("div",{id:"e-de-tc-pane-revision",styles:"overflow:auto"}),this.trackChangeDiv.appendChild(this.changesInfoDiv),this.noChangeDivElement=i.i(n.createElement)("div",{styles:"display:none;",className:"e-de-tc-no-chng"}),this.noChangeDivElement.textContent=this.locale.getConstant("No changes"),this.changesInfoDiv.appendChild(this.noChangeDivElement),this.updateTrackChanges()},e.prototype.initPaneHeader=function(){var e=this;this.toolbarElement=i.i(n.createElement)("div",{className:"e-de-track-toolbar"}),this.toolbar=new r.Toolbar({enableRtl:this.owner.enableRtl,items:[{text:this.locale.getConstant("User")+":",cssClass:"e-de-track-toolbar-overlay",disabled:!0},{template:i.i(n.createElement)("div",{id:"e-de-user-list",attrs:{role:"button"}})},{type:"Separator"},{text:this.locale.getConstant("View")+":",cssClass:"e-de-track-toolbar-overlay",disabled:!0},{template:i.i(n.createElement)("div",{id:"e-de-revision-list",attrs:{role:"button"}})},{prefixIcon:"e-de-nav-left-arrow e-de-tc-tbr",align:"Right",cssClass:"e-de-nvgte-left",tooltipText:this.locale.getConstant("Previous Changes"),click:this.navigatePreviousChanges.bind(this)},{prefixIcon:"e-de-nav-right-arrow e-de-tc-tbr",align:"Right",cssClass:"e-de-nvgte-right",tooltipText:this.locale.getConstant("Next Changes"),click:this.navigateNextChanges.bind(this)},{template:i.i(n.createElement)("div",{id:"e-de-menu-option",attrs:{role:"button"}}),align:"Right",cssClass:"e-de-tc-tbr",tooltipText:this.locale.getConstant("More Options")+"..."}]}),this.toolbar.appendTo(this.toolbarElement),i.i(n.select)(".e-de-nvgte-left",this.toolbarElement).firstChild.classList.add("e-tc-nvgte"),i.i(n.select)(".e-de-nvgte-right",this.toolbarElement).firstChild.classList.add("e-tc-nvgte");var t=i.i(n.select)("#e-de-user-list",this.toolbarElement);this.userDropDownitems=[{text:this.locale.getConstant("All")}],this.userDropDown={items:this.userDropDownitems,cssClass:"e-de-track-pane-drop-btn e-tc-btn-bg-clr",select:this.onUserSelect.bind(this),beforeOpen:this.onUserOpen.bind(this),beforeItemRender:function(t){e.beforeDropDownItemRender(t,e.selectedUser)}},this.userDropDownButton=new s.DropDownButton(this.userDropDown),this.userDropDownButton.appendTo(t),this.userDropDownButton.content=this.getSpanView(this.userDropDown.items[0].text,0);var o=i.i(n.select)("#e-de-revision-list",this.toolbarElement);this.viewTypeitems=[{text:this.locale.getConstant("All")},{text:this.locale.getConstant("Inserted")},{text:this.locale.getConstant("Deleted")}],this.viewTypeDropDownButton=new s.DropDownButton({items:this.viewTypeitems,cssClass:"e-de-track-pane-drop-btn e-tc-btn-bg-clr",select:this.onTypeSelect.bind(this),beforeItemRender:function(t){e.beforeDropDownItemRender(t,e.selectedType)}}),this.viewTypeDropDownButton.content=this.getSpanView(this.viewTypeitems[0].text,1),this.viewTypeDropDownButton.appendTo(o),this.menuoptionEle=i.i(n.select)("#e-de-menu-option",this.toolbarElement);var a=[{text:this.locale.getConstant("Accept all")},{text:this.locale.getConstant("Reject all")}],l={items:a,select:this.onMenuSelect.bind(this),iconCss:"e-de-menu-icon",cssClass:"e-caret-hide e-tc-btn-bg-clr"};return this.menuDropDownButton=new s.DropDownButton(l),this.menuDropDownButton.appendTo(this.menuoptionEle),this.toolbarElement},e.prototype.beforeDropDownItemRender=function(e,t){e.element.innerHTML="<span></span>"+e.item.text;var i=e.element.children[0];e.item.text===t?(i.style.marginRight="10px",i.style.alignSelf="center",i.setAttribute("class","e-de-selected-item e-icons")):(e.element.children[0].style.marginRight="25px",e.element.children[0].classList.remove("e-de-selected-item"))},e.prototype.onUserOpen=function(e){var t=e.element;t.style.maxHeight="200px",t.style.overflowY="auto"},e.prototype.enableDisableToolbarItem=function(e){var t=this.toolbar.element.querySelectorAll(".e-de-tc-tbr");this.owner&&this.owner.viewer&&(this.toolbar.enableItems(t[0].parentElement.parentElement,e),this.toolbar.enableItems(t[1].parentElement.parentElement,e),this.toolbar.enableItems(t[2],e))},e.prototype.getSpanView=function(e,t){return(0===t?'<span class="e-de-track-span-user">':'<span class="e-de-track-span-view">')+e+"</span>"},e.prototype.onMenuSelect=function(e){var t=this,i=e.item.text;i.match(this.locale.getConstant("Accept all"))?setTimeout(function(){t.owner.revisionsInternal.handleRevisionCollection(!0,t.sortedRevisions)},0):i.match(this.locale.getConstant("Reject all"))&&setTimeout(function(){t.owner.revisionsInternal.handleRevisionCollection(!1,t.sortedRevisions)},0),this.updateUsers()},e.prototype.onSelection=function(e){this.currentSelectedRevision=e},e.prototype.onUserSelect=function(e){var t=e.item.text;this.selectedUser=t,this.userDropDownButton.content=this.getSpanView(t,0),this.sortCollectionToDisplay()},e.prototype.onTypeSelect=function(e){var t=e.item.text;this.selectedType=t,this.viewTypeDropDownButton.content=this.getSpanView(t,1),this.sortCollectionToDisplay()},e.prototype.updateMenuOptions=function(){var e;this.selectedType!==this.locale.getConstant("All")&&(e=this.selectedType===this.locale.getConstant("Inserted")?this.locale.getConstant("Insertion"):this.locale.getConstant("Deletion")),this.selectedUser===this.locale.getConstant("All")&&this.selectedType===this.locale.getConstant("All")?(this.menuDropDownButton.items[0].text=this.locale.getConstant("Accept all")+" "+this.locale.getConstant("Changes"),this.menuDropDownButton.items[1].text=this.locale.getConstant("Reject all")+" "+this.locale.getConstant("Changes")):this.selectedUser===this.locale.getConstant("All")&&this.selectedType!==this.locale.getConstant("All")?(this.menuDropDownButton.items[0].text=this.locale.getConstant("Accept all")+" "+e,this.menuDropDownButton.items[1].text=this.locale.getConstant("Reject all")+" "+e):this.selectedUser!==this.locale.getConstant("All")&&this.selectedType===this.locale.getConstant("All")?(this.menuDropDownButton.items[0].text=this.locale.getConstant("Accept all")+" "+this.locale.getConstant("Changes")+" "+this.locale.getConstant("By").toLowerCase()+" "+this.selectedUser,this.menuDropDownButton.items[1].text=this.locale.getConstant("Reject all")+" "+this.locale.getConstant("Changes")+" "+this.locale.getConstant("By").toLowerCase()+" "+this.selectedUser):(this.menuDropDownButton.items[0].text=this.locale.getConstant("Accept all")+" "+e+" "+this.locale.getConstant("By").toLowerCase()+" "+this.selectedUser,this.menuDropDownButton.items[1].text=this.locale.getConstant("Reject all")+" "+e+" "+this.locale.getConstant("By").toLowerCase()+" "+this.selectedUser),this.owner.documentHelper.isDocumentProtected||this.owner.isReadOnly?this.menuDropDownButton.disabled=!0:this.menuDropDownButton.disabled=!1},e.prototype.sortCollectionToDisplay=function(){var e=!1;this.sortedRevisions=[],this.updateMenuOptions();for(var t=0;t<this.changes.length;t++){var i=this.changes.get(this.revisions[t]),n=i.outerSingleDiv;this.selectedUser===this.locale.getConstant("All")&&this.selectedType===this.locale.getConstant("All")?n.style.display="block":this.selectedUser===this.locale.getConstant("All")&&this.selectedType!==this.locale.getConstant("All")?this.locale.getConstant(i.revisionType)===this.selectedType?n.style.display="block":n.style.display="none":this.selectedUser!==this.locale.getConstant("All")&&this.selectedType===this.locale.getConstant("All")?i.user===this.selectedUser?n.style.display="block":n.style.display="none":i.user===this.selectedUser&&this.locale.getConstant(i.revisionType)===this.selectedType?n.style.display="block":n.style.display="none","block"===n.style.display&&this.sortedRevisions.push(this.revisions[t]),e=!0}this.setNoChangesVisibility=!e},e.prototype.enableDisableButton=function(e){this.enableButtons=e,this.updateTrackChanges()},e.prototype.isUpdateTrackChanges=function(e){var t=!1,r=!1;return i.i(n.isNullOrUndefined)(this.changesInfoDiv)||(1===this.changesInfoDiv.childNodes.length&&"e-de-tc-no-chng"==this.changesInfoDiv.childNodes[0].className?r=!0:e!==this.changesInfoDiv.childNodes.length&&(t=!0)),(r||e>0)&&(t=!0),t},e.prototype.updateCurrentTrackChanges=function(e){var t;if(i.i(n.isNullOrUndefined)(e)||(t=this.owner.trackChangesPane.changes.get(e)),!i.i(n.isNullOrUndefined)(t)&&e.range.length>0){for(var r=t.singleInnerDiv.querySelector("#textDiv");r.firstChild;)r.removeChild(r.firstChild);t.layoutElementText(e.range,r)}i.i(n.isNullOrUndefined)(e)||0!==e.range.length||this.owner.revisions.remove(e)},e.prototype.updateTrackChanges=function(e){if(e||i.i(n.isNullOrUndefined)(e)){if(this.owner.documentHelper.layout.isInitialLoad)this.tableRevisions.clear(),this.renderedChanges.clear(),this.removeAllChanges();else{for(var t=0;t<this.tableRevisions.keys.length;t++){var r=this.tableRevisions.keys[t],o=this.revisions.indexOf(r),s=this.tableRevisions.get(r)[this.tableRevisions.get(r).length-1]===r;!i.i(n.isNullOrUndefined)(this.changesInfoDiv.childNodes[o+1])&&s&&this.changesInfoDiv.removeChild(this.changesInfoDiv.childNodes[o+1]),this.renderedChanges.containsKey(r)&&this.renderedChanges.remove(r),this.changes.containsKey(r)&&this.changes.remove(r),this.revisions.splice(o,1)}this.tableRevisions.clear()}if(this.enableButtons||this.menuoptionEle.classList.contains("e-de-overlay")?!this.menuoptionEle.classList.contains("e-de-overlay")||this.owner.documentHelper.isDocumentProtected||this.owner.isReadOnly||this.menuoptionEle.classList.remove("e-de-overlay"):this.menuoptionEle.classList.add("e-de-overlay"),this.isChangesTabVisible=!0,this.owner.notify("reviewPane",{comment:this.commentReviewPane.isCommentTabVisible,changes:this.isChangesTabVisible}),this.owner.documentHelper.layout.isInitialLoad){for(var t=0;t<this.owner.revisions.changes.length;t++){var r=this.owner.revisions.changes[t],d=this.owner.revisions.changes[t].range[0];if(!((d instanceof a.d||d instanceof a.b)&&d.paragraph.containerWidget instanceof a.x&&i.i(n.isNullOrUndefined)(d.paragraph.containerWidget.sectionFormat))){if(d instanceof a.d&&d.paragraph.containerWidget instanceof a.x){var h=d.paragraph.containerWidget.headerFooterType,c=this.owner.selection.sectionFormat;if(!("EvenFooter"!==h&&"EvenHeader"!==h&&"OddFooter"!==h&&"OddHeader"!==h||c.differentOddAndEvenPages))continue;if(("FirstPageHeader"===h||"FirstPageFooter"===h)&&!c.differentFirstPage)continue}if(!this.changes.containsKey(r))if(d instanceof l.f){var u=this.groupTableRevisions(this.owner.revisions.changes,t);if(u.length>1)for(var g=void 0,f=0;f<u.length;f++){var m=u[f];if(0===f)this.addChanges(m),g=this.changes.get(r);else{var v=m.range[0];g.appendRowToTable(v,f),this.revisions.push(m),this.changes.add(m,g)}this.tableRevisions.add(m,u)}else this.addChanges(r)}else this.addChanges(r)}}for(var t=0;t<this.renderedChanges.keys.length;t++){var g=this.renderedChanges.get(this.renderedChanges.keys[t]);g.updateRevisionIndexAndCount(t+1,this.renderedChanges.keys.length)}}else{for(var t=0;t<this.owner.revisions.changes.length;t++){var r=this.owner.revisions.changes[t],d=this.owner.revisions.changes[t].range[0];if(this.changes.containsKey(r)){var y=this.renderedChanges.get(r);if(i.i(n.isNullOrUndefined)(y))continue;this.enableButtons?y.acceptButtonElement.classList.contains("e-de-overlay")&&!this.owner.documentHelper.isTrackedOnlyMode&&(y.acceptButtonElement.classList.remove("e-de-overlay"),y.rejectButtonElement.classList.remove("e-de-overlay")):y.acceptButtonElement.classList.contains("e-de-overlay")||(y.acceptButtonElement.classList.add("e-de-overlay"),y.rejectButtonElement.classList.add("e-de-overlay"))}else if(d instanceof l.f){var u=this.groupTableRevisions(this.owner.revisions.changes,t);if(u.length>1)for(var g=void 0,f=0;f<u.length;f++){var m=u[f];if(0===f){var y=new p(this.owner,this);this.changesInfoDiv.insertBefore(y.createSingleChangesDiv(m),this.changesInfoDiv.children[t+1]),this.revisions.splice(t,0,m),this.changes.add(m,y),this.renderedChanges.add(m,y),g=this.changes.get(r)}else{var v=m.range[0];g.appendRowToTable(v,f),this.revisions.splice(t,0,m),this.changes.add(m,g)}this.tableRevisions.add(m,u)}else{var y=new p(this.owner,this);this.changesInfoDiv.insertBefore(y.createSingleChangesDiv(r),this.changesInfoDiv.children[t+1]),this.revisions.splice(t,0,r),this.changes.add(r,y),this.renderedChanges.add(r,y)}}}for(var w=document.getElementsByClassName("e-de-track-chngs-count").length,t=0;t<w;t++){document.getElementsByClassName("e-de-track-chngs-count")[t].innerHTML=this.locale.getConstant("Changes")+" "+(t+1).toString()+" "+this.locale.getConstant("of")+" "+w.toString()}}this.sortCollectionToDisplay(),this.updateUsers(),e&&(this.currentSelectedRevision=this.currentSelectedRevisionInternal,this.updateHeight(),this.owner.resize())}else this.currentSelectedRevision=void 0},e.prototype.groupTableRevisions=function(e,t){for(var r=e[t],o=[r],s=r.revisionType,d=r.range[0].ownerBase,h=d.ownerTable,c=d.index,p=this.owner.documentHelper.layout.getParentTable(h),u=t+1;u<e.length;u++){var g=e[u],f=g.revisionType,m=g.range[0];if(!(m instanceof l.f)){var v=void 0;if(m instanceof l.g?v=m.ownerBase:m instanceof a.c&&(v=m.line.paragraph),v instanceof a.g&&v.isInsideTable){var y=v.associatedCell.ownerTable,w=this.owner.documentHelper.layout.getParentTable(y);if(h.equals(y)||!h.equals(y)&&!i.i(n.isNullOrUndefined)(p)&&p.equals(w))continue}break}var b=m.ownerBase,y=b.ownerTable,x=b.index;if(h.equals(y)||i.i(n.isNullOrUndefined)(p)||!p.equals(this.owner.documentHelper.layout.getParentTable(y))){if(s!==f||r.author!==g.author||!h.equals(y)||c+1!==x)break;o.push(g),c=x}}return o},e.prototype.updateUsers=function(){this.users.length>0&&(this.userDropDownButton.removeItems(this.users),this.users=[]);for(var e=0;e<this.revisions.length;e++)-1===this.users.indexOf(this.revisions[e].author)&&(this.users.push(this.revisions[e].author),this.userDropDownButton.items.push({text:this.revisions[e].author}))},e.prototype.updateHeight=function(){var e=this.commentReviewPane.reviewTab.getRootElement().getElementsByClassName("e-tab-header")[0].getBoundingClientRect().height;this.changesInfoDiv.style.height=this.commentReviewPane.parentPaneElement.clientHeight-this.toolbarElement.clientHeight-e-2+"px"},e.prototype.removeAllChanges=function(){for(;this.changesInfoDiv.childNodes.length>1;)this.changesInfoDiv.removeChild(this.changesInfoDiv.lastChild);if(this.revisions=[],this.changes&&this.changes.length>0){for(var e=0;e<this.changes.length;e++){var t=this.changes.keys[e];this.changes.get(t).clear()}this.changes.clear()}},e.prototype.clear=function(){this.removeAllChanges(),this.selectedUser=this.locale.getConstant("All"),this.userDropDownButton.content=this.getSpanView(this.selectedUser,0),this.selectedType=this.locale.getConstant("All"),this.viewTypeDropDownButton.content=this.getSpanView(this.selectedType,1),this.currentSelectedRevision=void 0},e.prototype.destroy=function(){if(this.changes&&this.changes.length>0){for(var e=0;e<this.changes.length;e++){var t=this.changes.keys[e];this.changes.get(t).destroy()}this.changes.clear()}this.changes=void 0,this.toolbar&&(this.toolbar.destroy(),this.toolbar=void 0),this.closeButton&&this.closeButton.parentElement&&this.closeButton.parentElement.removeChild(this.closeButton),this.closeButton=void 0,this.userDropDownButton&&(this.userDropDownButton.destroy(),this.userDropDownButton=void 0),this.menuDropDownButton&&(this.menuDropDownButton.destroy(),this.menuDropDownButton=void 0),this.viewTypeDropDownButton&&(this.viewTypeDropDownButton.destroy(),this.viewTypeDropDownButton=void 0),this.userDropDown&&(this.userDropDown=void 0),this.users.length>0&&(this.users=[],this.users=void 0),this.trackChangeDiv&&(this.trackChangeDiv.innerHTML="",this.trackChangeDiv.parentElement&&this.trackChangeDiv.parentElement.removeChild(this.trackChangeDiv)),this.trackChangeDiv=void 0,this.changesInfoDiv&&(this.changesInfoDiv.innerHTML="",this.changesInfoDiv.parentElement&&this.changesInfoDiv.parentElement.removeChild(this.changesInfoDiv)),this.changesInfoDiv=void 0,this.commentReviewPane&&(this.commentReviewPane=void 0),this.tableRevisions&&(this.tableRevisions.destroy(),this.tableRevisions=void 0),this.renderedChanges&&(this.renderedChanges.destroy(),this.renderedChanges=void 0),this.currentSelectedRevisionInternal=void 0,this.selectedUser=void 0,this.selectedType=void 0,this.sortedRevisions=[],this.sortedRevisions=void 0,this.viewTypeitems=[],this.viewTypeitems=void 0,this.userDropDownitems=[],this.userDropDownitems=void 0,this.revisions=[],this.revisions=void 0,this.owner=void 0},e.prototype.addChanges=function(e){var t=new p(this.owner,this);this.changesInfoDiv.appendChild(t.createSingleChangesDiv(e)),this.enableButtons?t.acceptButtonElement.classList.contains("e-de-overlay")&&!this.owner.documentHelper.isTrackedOnlyMode&&(t.acceptButtonElement.classList.remove("e-de-overlay"),t.rejectButtonElement.classList.remove("e-de-overlay")):t.acceptButtonElement.classList.contains("e-de-overlay")||(t.acceptButtonElement.classList.add("e-de-overlay"),t.rejectButtonElement.classList.add("e-de-overlay")),this.revisions.push(e),this.changes.add(e,t),this.renderedChanges.add(e,t)},e.prototype.navigatePreviousChanges=function(){this.revisionNavigateInternal(!1)},e.prototype.navigateNextChanges=function(){this.revisionNavigateInternal(!0)},e.prototype.revisionNavigateInternal=function(e){var t=this.renderedChanges.keys;if(!this.currentSelectedRevisionInternal){if(0===t.length)return;this.currentSelectedRevision=t[0]}if(this.currentSelectedRevision){var i=t,n=this.currentSelectedRevision,r=i.indexOf(n);n=e?r===i.length-1?i[0]:i[r+1]:0===r?i[i.length-1]:i[r-1],this.owner.documentHelper.currentSelectedRevision=n;if(n.range[0]instanceof l.f){var o=this.groupTableRevisions(this.owner.revisions.changes,this.owner.revisions.changes.indexOf(n));this.owner.selection.selectTableRevision(o)}else this.owner.selection.selectRevision(n)}this.currentSelectedRevision=this.owner.documentHelper.currentSelectedRevision},e}(),p=function(){function e(e,t){this.owner=e,this.locale=new n.L10n("documenteditor",this.owner.defaultLocale),this.locale.setLocale(this.owner.locale),this.trackChangesPane=t}return e.prototype.updateRevisionIndexAndCount=function(e,t){this.changesCount.innerHTML=this.locale.getConstant("Changes")+" "+e.toString()+" "+this.locale.getConstant("of")+" "+t.toString()},e.prototype.createSingleChangesDiv=function(e){this.revision=e,this.user=e.author,this.outerSingleDiv=i.i(n.createElement)("div",{className:"e-de-tc-outer"}),this.singleInnerDiv=i.i(n.createElement)("div",{className:"e-de-trckchanges-inner"}),this.singleInnerDiv.addEventListener("click",this.selectRevision.bind(this)),this.outerSingleDiv.appendChild(this.singleInnerDiv);var t=i.i(n.createElement)("div",{className:"e-de-track-usernme-div"}),r=i.i(n.createElement)("div",{innerHTML:e.author,className:"e-de-track-user-nme"});i.i(n.isNullOrUndefined)(e.author)||(t.style.display="flex",this.owner.documentHelper.getAvatar(t,r,void 0,e));var s=i.i(n.createElement)("div");"Insertion"===e.revisionType?(this.revisionType="Inserted",s.innerHTML=this.locale.getConstant("Inserted").toUpperCase(),s.classList.add("e-de-track-insert")):"Deletion"===e.revisionType?(this.revisionType="Deleted",s.innerHTML=this.locale.getConstant("Deleted").toUpperCase(),s.classList.add("e-de-track-delete")):"MoveFrom"===e.revisionType?(this.revisionType="MoveFrom",s.innerHTML=this.locale.getConstant("Move From").toUpperCase(),s.classList.add("e-de-track-delete"),s.style.whiteSpace="nowrap"):"MoveTo"===e.revisionType&&(this.revisionType="MoveTo",s.innerHTML=this.locale.getConstant("Move To").toUpperCase(),s.classList.add("e-de-track-insert"),s.style.whiteSpace="nowrap"),t.appendChild(s),this.singleInnerDiv.appendChild(t);var a=i.i(n.createElement)("div",{className:"e-de-track-date",innerHTML:d.a.getModifiedDate(e.date)});this.singleInnerDiv.appendChild(a);var l=i.i(n.createElement)("div",{id:"textDiv",className:"e-de-track-chngs-text"});this.layoutElementText(e.range,l),this.singleInnerDiv.appendChild(l);var h=i.i(n.createElement)("div",{styles:"display:inline-block;width:100%"});this.singleInnerDiv.appendChild(h);var c=i.i(n.createElement)("div",{styles:"float:left;"});this.acceptButtonElement=i.i(n.createElement)("button",{className:"e-de-track-accept-button"}),this.acceptButton=new o.Button({cssClass:"e-outline e-success",content:this.locale.getConstant("Accept")}),this.acceptButtonElement.setAttribute("aria-label",this.locale.getConstant("Accept")),c.appendChild(this.acceptButtonElement),h.appendChild(c),this.acceptButton.appendTo(this.acceptButtonElement),this.owner.documentHelper.isTrackedOnlyMode&&this.acceptButtonElement.classList.add("e-de-overlay"),this.acceptButtonElement.addEventListener("click",this.acceptButtonClick.bind(this)),c=i.i(n.createElement)("div",{styles:"float:left;"}),this.rejectButtonElement=i.i(n.createElement)("button",{className:"e-de-track-reject-button"}),this.rejectButton=new o.Button({cssClass:"e-outline e-danger",content:this.locale.getConstant("Reject")}),this.rejectButtonElement.setAttribute("aria-label",this.locale.getConstant("Reject")),c.appendChild(this.rejectButtonElement),h.appendChild(c),this.rejectButton.appendTo(this.rejectButtonElement),this.owner.documentHelper.isTrackedOnlyMode&&this.rejectButtonElement.classList.add("e-de-overlay"),this.rejectButtonElement.addEventListener("click",this.rejectButtonClick.bind(this)),this.changesCount=i.i(n.createElement)("div",{className:"e-de-track-chngs-count",styles:"float:right;"});var p=this.owner.revisions.changes.indexOf(e)+1,u=this.owner.revisions.changes.length;return this.changesCount.innerHTML=this.locale.getConstant("Changes")+" "+p.toString()+" "+this.locale.getConstant("of")+" "+u.toString(),h.appendChild(this.changesCount),this.outerSingleDiv},e.prototype.appendRowToTable=function(e,t){this.tableElement.insertRow();for(var i=0;i<e.ownerBase.childWidgets.length;i++)this.tableElement.rows[t].insertCell(),this.tableElement.rows[t].cells[i].classList.add("e-de-tc-tble-cell")},e.prototype.selectRevision=function(){if(this.revision.range[0]instanceof l.f){var e=this.trackChangesPane.groupTableRevisions(this.owner.revisions.changes,this.owner.revisions.changes.indexOf(this.revision));this.owner.selection.selectTableRevision(e)}else this.owner.selection.selectRevision(this.revision),this.trackChangesPane.onSelection(this.revision)},e.prototype.layoutElementText=function(e,t){t.style.width="100%";for(var r="",o=!1,s=0;s<e.length;s++){var d=e[s];if(d instanceof a.b&&1===d.fieldType)o=!1;else if(!o)if(d instanceof a.b&&0===d.fieldType&&(o=!0),d instanceof a.d)r+=d.text;else if(d instanceof a.b&&0===d.fieldType){var h=this.owner.selection.getFieldCode(d);if(h.match("TOC ")||h.match("Toc"))return r+="<Table of Content>",void t.appendChild(this.addSpan(r));if(h.match("HYPERLINK ")||h.match("MERGEFIELD")||h.match("FORMTEXT")||h.match("PAGE "))r+=this.owner.editor.retrieveFieldResultantText(d.fieldEnd);else if(d.formFieldData){var c=this.owner.documentHelper.textHelper.repeatChar(this.owner.documentHelper.textHelper.getEnSpaceCharacter(),5);""!==r&&(t.appendChild(this.addSpan(r)),r=""),d.formFieldData instanceof a.l?t.appendChild(this.addSpan(""===d.formFieldData.defaultValue?c:d.formFieldData.defaultValue,"e-de-tc-field")):d.formFieldData instanceof a.n?t.appendChild(this.addSpan(d.formFieldData.dropdownItems.length>0?d.formFieldData.dropdownItems[0]:c,"e-de-tc-field")):t.appendChild(this.addSpan(d.formFieldData.checked?String.fromCharCode(9745):String.fromCharCode(9744),"e-de-tc-field"))}}else if(d instanceof a.r){""!==r&&(t.appendChild(this.addSpan(r)),r="");var p=i.i(n.createElement)("img");p.setAttribute("src",this.owner.documentHelper.getImageString(d)),p.classList.add("e-de-tc-shrink-img"),t.appendChild(p)}else{if(d instanceof l.f){this.tableElement=i.i(n.createElement)("table"),this.tableElement.classList.add("e-de-track-chng-table"),this.tableElement.insertRow();for(var u=0;u<d.ownerBase.childWidgets.length;u++)this.tableElement.rows[0].insertCell(),this.tableElement.rows[0].cells[u].classList.add("e-de-tc-tble-cell");return void t.appendChild(this.tableElement)}if(d instanceof l.g){""!==r&&(t.appendChild(this.addSpan(r)),r="");var g="";d.ownerBase instanceof a.g&&d.ownerBase.isEndsWithPageBreak&&(g="............Page Break............"+g),t.appendChild(this.addSpan(g,"e-de-tc-pmark")),t.appendChild(i.i(n.createElement)("br"))}}}t.appendChild(this.addSpan(r))},e.prototype.addSpan=function(e,t){var r=i.i(n.createElement)("span");return r.textContent=e,t&&r.classList.add(t),r},e.prototype.acceptButtonClick=function(){this.revision.accept(),this.owner.enableHeaderAndFooter&&this.owner.editor.updateHeaderFooterWidget()},e.prototype.rejectButtonClick=function(){this.revision.reject(),this.owner.enableHeaderAndFooter&&this.owner.editor.updateHeaderFooterWidget()},e.prototype.removeFromParentCollec=function(){this.trackChangesPane.changes.containsKey(this.revision)&&this.trackChangesPane.changes.remove(this.revision),-1!==this.trackChangesPane.revisions.indexOf(this.revision)&&this.trackChangesPane.revisions.splice(this.trackChangesPane.revisions.indexOf(this.revision),1),0===this.trackChangesPane.changes.length&&(this.trackChangesPane.setNoChangesVisibility=!0),this.trackChangesPane.updateUsers()},e.prototype.clear=function(){this.removeFromParentCollec(),this.acceptButton&&(this.acceptButton.destroy(),this.acceptButton=void 0),this.rejectButton&&(this.rejectButton.destroy(),this.rejectButton=void 0),this.acceptButtonElement&&(this.acceptButtonElement.innerHTML="",this.acceptButtonElement.parentElement&&this.acceptButtonElement.parentElement.removeChild(this.acceptButtonElement),this.acceptButtonElement=void 0),this.rejectButtonElement&&(this.rejectButtonElement.innerHTML="",this.rejectButtonElement.parentElement&&this.rejectButtonElement.parentElement.removeChild(this.rejectButtonElement),this.rejectButtonElement=void 0),this.tableElement&&(this.tableElement.innerHTML="",this.tableElement.parentElement&&this.tableElement.parentElement.removeChild(this.tableElement),this.tableElement=void 0),this.singleInnerDiv&&(this.singleInnerDiv.innerHTML="",this.singleInnerDiv.parentElement&&this.singleInnerDiv.parentElement.removeChild(this.singleInnerDiv),this.singleInnerDiv=void 0),this.outerSingleDiv&&(this.outerSingleDiv.innerHTML="",this.outerSingleDiv.parentElement&&this.outerSingleDiv.parentElement.removeChild(this.outerSingleDiv),this.outerSingleDiv=void 0)},e.prototype.destroy=function(){this.acceptButton&&(this.acceptButton.destroy(),this.acceptButton=void 0),this.rejectButton&&(this.rejectButton.destroy(),this.rejectButton=void 0),this.acceptButtonElement&&(this.acceptButtonElement.innerHTML="",this.acceptButtonElement.parentElement&&this.acceptButtonElement.parentElement.removeChild(this.acceptButtonElement),this.acceptButtonElement=void 0),this.rejectButtonElement&&(this.rejectButtonElement.innerHTML="",this.rejectButtonElement.parentElement&&this.rejectButtonElement.parentElement.removeChild(this.rejectButtonElement),this.rejectButtonElement=void 0),this.tableElement&&(this.tableElement.innerHTML="",this.tableElement.parentElement&&this.tableElement.parentElement.removeChild(this.tableElement),this.tableElement=void 0),this.singleInnerDiv&&(this.singleInnerDiv.innerHTML="",this.singleInnerDiv.parentElement&&this.singleInnerDiv.parentElement.removeChild(this.singleInnerDiv),this.singleInnerDiv=void 0),this.outerSingleDiv&&(this.outerSingleDiv.innerHTML="",this.outerSingleDiv.parentElement&&this.outerSingleDiv.parentElement.removeChild(this.outerSingleDiv),this.outerSingleDiv=void 0),this.revision=void 0,this.user=void 0,this.revisionType=void 0,this.trackChangesPane=void 0,this.owner=void 0},e}()},function(e,t,i){"use strict";i.d(t,"a",function(){return p});var n=i(0),r=(i.n(n),i(6)),o=i(16),s=i(4),a=i(9),l=i(23),d=i(2),h=i(32),c=i(41),p=function(){function e(e){this.islayoutFootnote=!1,this.isMultiColumnDoc=!1,this.allowLayout=!0,this.isReplaceAll=!1,this.isTextFormat=!1,this.isSectionBreakCont=!1,this.isReplacingAll=!1,this.footHeight=0,this.existFootnoteHeight=0,this.isfootMove=!1,this.footnoteHeight=0,this.isTableFootNote=!1,this.isRelayout=!1,this.isRelayoutneed=!1,this.isOverlapFloatTable=!1,this.isInitialLoad=!0,this.isInsertFormField=!1,this.fieldBegin=void 0,this.maxTextHeight=0,this.maxBaseline=0,this.maxTextBaseline=0,this.isFieldCode=!1,this.isRtlFieldCode=!1,this.isRTLLayout=!1,this.isSkipFirstLineIndent=!1,this.currentCell=void 0,this.isFootnoteContentChanged=!1,this.isEndnoteContentChanged=!1,this.keepWithNext=!1,this.is2013Justification=!1,this.nextElementToLayout=void 0,this.endNoteHeight=0,this.isMultiColumnSplit=!1,this.skipUpdateContainerWidget=!1,this.isIFfield=!1,this.isLayoutWhole=!1,this.isBidiReLayout=!1,this.defaultTabWidthPixel=48,this.isRelayoutFootnote=!1,this.isRelayoutOverlap=!1,this.skipRelayoutOverlap=!1,this.isWrapText=!1,this.isYPositionUpdated=!1,this.isXPositionUpdated=!1,this.hasFloatingElement=!1,this.isFootNoteLayoutStart=!1,this.wrapPosition=[],this.shiftedFloatingItemsFromTable=[],this.isDocumentContainsRtl=!1,this.layoutedFootnoteElement=[],this.documentHelper=e}return e.prototype.isSameStyle=function(e,t){var r=void 0;if(t?e.nextWidget instanceof d.g&&(r=e.nextWidget):e.previousWidget instanceof d.g&&(r=e.previousWidget),i.i(n.isNullOrUndefined)(r)){if(e.paragraphFormat.contextualSpacing&&e.isInsideTable&&(!this.documentHelper.allowSpaceOfSameStyleInTable||"Word2013"===this.documentHelper.compatibilityMode))if(0===e.index)r=this.updateFirstParagraphSpacingBasedOnContextualSpacing(e,t);else if(e.index===e.associatedCell.childWidgets.length-1&&(r=this.updateLastParagraphSpacingBasedOnContextualSpacing(e))===e)return!0;if(i.i(n.isNullOrUndefined)(r))return!1}if(r instanceof d.g&&e.paragraphFormat.baseStyle===r.paragraphFormat.baseStyle&&(!e.isInsideTable||!this.documentHelper.allowSpaceOfSameStyleInTable)){if(e.paragraphFormat.listFormat.listId>=0&&r.paragraphFormat.listFormat.listId>=0&&!e.paragraphFormat.contextualSpacing){if(t&&e.paragraphFormat.spaceAfterAuto)return!0;if(!t&&e.paragraphFormat.spaceBeforeAuto)return!0}return e.paragraphFormat.contextualSpacing}return!1},e.prototype.updateFirstParagraphSpacingBasedOnContextualSpacing=function(e,t){var r,o=e.associatedCell,s=o.ownerRow,a=s.ownerTable;if(r=t?i.i(n.isNullOrUndefined)(e.nextRenderedWidget)?i.i(n.isNullOrUndefined)(o.nextRenderedWidget)?void 0:o.nextRenderedWidget.firstChild:e.nextRenderedWidget:i.i(n.isNullOrUndefined)(e.previousRenderedWidget)?i.i(n.isNullOrUndefined)(o.previousRenderedWidget)?void 0:o.previousRenderedWidget.firstChild:e.previousRenderedWidget,0===o.index&&0===e.index){if(0!==s.index)return r;if(!a.isInsideTable||0!=a.index){return a.previousRenderedWidget}r=this.checkOwnerTablePrevItem(a,e)}else if(0===e.index&&!t){var l=s.childWidgets[o.index-1],h=l.childWidgets[l.childWidgets.length-1];if(h instanceof d.u&&"Normal"===e.paragraphFormat.baseStyle.name&&e.paragraphFormat.listFormat.listId<0)return e}return r},e.prototype.updateLastParagraphSpacingBasedOnContextualSpacing=function(e){var t,i=e.associatedCell,n=i.ownerRow;if(i.index===n.childWidgets.length-1&&e.index===i.childWidgets.length-1){if("Normal"===e.paragraphFormat.baseStyle.name&&e.paragraphFormat.listFormat.listId<0)return e}else if(e.index===i.childWidgets.length-1){var r=n.childWidgets[i.index+1];for(t=r.firstChild;t instanceof d.u;)t=t.childWidgets[0].childWidgets[0].childWidgets[0]}return t},e.prototype.checkOwnerTablePrevItem=function(e,t){var i=e.associatedCell.ownerRow;if(i.index>0){if("Normal"===t.paragraphFormat.baseStyle.name&&t.paragraphFormat.listFormat.listId<0)return t}else{if(!i.ownerTable.isInsideTable||0!==i.ownerTable.index){return i.ownerTable.previousRenderedWidget}this.checkOwnerTablePrevItem(i.ownerTable,t)}},Object.defineProperty(e.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.layout=function(){},e.prototype.destroy=function(){this.documentHelper=void 0,this.value=void 0,this.allowLayout=void 0,this.isInitialLoad=void 0,this.fieldBegin=void 0,this.maxTextHeight=void 0,this.maxBaseline=void 0,this.maxTextBaseline=void 0,this.isFieldCode=void 0,this.footnoteHeight=void 0,this.isMultiColumnDoc=void 0,this.isSkipFirstLineIndent=void 0,this.isIFfield=void 0},e.prototype.layoutItems=function(e,t,r){for(var o,s=this,a=0,l=0,h=0;h<e.length;h++){var c=e[h];c.sectionFormat.numberOfColumns>1&&(this.isMultiColumnDoc=!0);var p=e[h+1];this.viewer.columnLayoutArea.setColumns(c.sectionFormat);var u=this.documentHelper.pages[this.documentHelper.pages.length-1],g=void 0;if(i.i(n.isNullOrUndefined)(u)||i.i(n.isNullOrUndefined)(u.bodyWidgets[u.bodyWidgets.length-1])||0!==u.bodyWidgets[u.bodyWidgets.length-1].childWidgets.length||i.i(n.isNullOrUndefined)(u.bodyWidgets[u.bodyWidgets.length-1].previousSplitWidget)||(g=u.bodyWidgets[u.bodyWidgets.length-1].previousSplitWidget),h>0&&!i.i(n.isNullOrUndefined)(g)&&!i.i(n.isNullOrUndefined)(g.lastChild)&&!(g.lastChild instanceof d.u)&&("Word2013"===this.documentHelper.compatibilityMode&&g.lastChild.isEndsWithPageBreak||g.lastChild.isEndsWithColumnBreak)&&0===u.bodyWidgets[0].childWidgets.length){this.documentHelper.pages.splice(this.documentHelper.pages.length-1,1)[0].destroy(),u=this.documentHelper.pages[this.documentHelper.pages.length-1]}if(0===h&&!r||0!==h&&(i.i(n.isNullOrUndefined)(c.sectionFormat.breakCode)||"NewPage"===c.sectionFormat.breakCode||a!==c.sectionFormat.pageHeight||l!==c.sectionFormat.pageWidth||!i.i(n.isNullOrUndefined)(u.bodyWidgets[u.bodyWidgets.length-1].lastChild)&&u.bodyWidgets[u.bodyWidgets.length-1].lastChild.isEndsWithPageBreak))o=this.viewer.createNewPage(c);else{var f=this.documentHelper.viewer.clientActiveArea.y,m=this.documentHelper.viewer.clientActiveArea.height;if(r){var v=this.getBodyWidget(u.bodyWidgets[u.bodyWidgets.length-1],!0),y=this.getNextWidgetHeight(v);this.viewer.updateClientArea(v,v.page),m=this.viewer.clientActiveArea.height-(y-this.viewer.clientActiveArea.y),f=y,r=!1}o=u,o.bodyWidgets.push(c),o.bodyWidgets[o.bodyWidgets.length-1].page=o,this.documentHelper.viewer.updateClientArea(c,o),this.documentHelper.viewer.clientActiveArea.y=f,this.documentHelper.viewer.clientActiveArea.height=m}if(a=c.sectionFormat.pageHeight,l=c.sectionFormat.pageWidth,this.addBodyWidget(this.viewer.clientActiveArea,c),this.documentHelper.pages.length>1){for(var w=0,b=0;b<this.documentHelper.pages.length;b++){var x=this.documentHelper.pages[b];if(x.sectionIndex>c.index||x===o)break;w++}w<this.documentHelper.pages.length-1&&this.documentHelper.insertPage(w,o)}this.layoutSection(c,0,p)}t||this.layoutComments(this.documentHelper.comments),this.updateFieldElements(),"Pages"===this.documentHelper.owner.layoutType&&this.layoutEndNoteElement(),setTimeout(function(){s.documentHelper&&(s.documentHelper.isScrollHandler=!0,s.documentHelper.clearContent(),s.viewer.updateScrollBars(),s.documentHelper.isScrollHandler=!1,s.isInitialLoad=!1)},50)},e.prototype.layoutComments=function(e){i.i(n.isNullOrUndefined)(e)||this.viewer.owner.commentReviewPane.layoutComments()},e.prototype.layoutSection=function(e,t,r){var o,s=e.firstChild;do{if(s instanceof d.u&&"Auto"===s.tableFormat.preferredWidthType&&!s.tableFormat.allowAutoFit&&s.calculateGrid(),!i.i(n.isNullOrUndefined)(s)){this.viewer.updateClientAreaForBlock(s,!0,void 0,!0,!0);s.containerWidget.indexInOwner;o=this.layoutBlock(s,t),t=0,this.viewer.updateClientAreaForBlock(s,!1),s,s=o}}while(s);if(s=e.firstChild,this.viewer instanceof h.b&&e.sectionFormat.numberOfColumns>1&&!i.i(n.isNullOrUndefined)(r)&&"NoBreak"===r.sectionFormat.breakCode&&("NoBreak"===e.sectionFormat.breakCode||e.sectionIndex===e.page.bodyWidgets[0].sectionIndex))if(this.getColumnBreak(e)){var a=e.getSplitWidgets(),l=a[a.length-1];if(i.i(n.isNullOrUndefined)(e.page.nextPage)){var c=this.getBodyWidget(l,!0);this.viewer.updateClientArea(c,c.page);var p=this.getNextWidgetHeight(c);this.viewer.clientActiveArea.height-=p-this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.y=p}else this.splitBodyWidgetBasedOnColumn(l)}else i.i(n.isNullOrUndefined)(e.page.nextPage)||(e=this.documentHelper.pages[this.documentHelper.pages.length-1].bodyWidgets[0]),this.splitBodyWidgetBasedOnColumn(e);var u;for(s&&s.bodyWidget&&s.bodyWidget.page&&(u=s.bodyWidget.page);u;)u.footnoteWidget?(this.layoutfootNote(u.footnoteWidget),u=u.nextPage):u=u.nextPage;u=void 0,s=void 0},e.prototype.reLayoutMultiColumn=function(e,t){this.isInitialLoad=!0,e=e.getSplitWidgets()[0],this.combineMultiColumnForRelayout(e),e.sectionFormat.numberOfColumns>1&&(this.isMultiColumnDoc=!0),this.isMultiColumnSplit=!1;var r=e.previousRenderedWidget,o=e.nextRenderedWidget,a=!1;if(!t&&!i.i(n.isNullOrUndefined)(e.firstChild)&&e.firstChild instanceof d.g&&e.y!==e.firstChild.y&&(e.y=e.firstChild.y),t&&o&&e.page!==o.page&&e.firstChild instanceof d.g){var l=e.firstChild,h=0;if(l.isEmpty())h=this.documentHelper.textHelper.getParagraphMarkSize(l.characterFormat).Height;else{var c=l.childWidgets[0];h=this.getMaxElementHeight(c)}var p=l.previousRenderedWidget;e.y===this.viewer.clientActiveArea.y&&h>this.viewer.clientActiveArea.height&&(p=i.i(n.isNullOrUndefined)(p)?l:p,this.moveBlocksToNextPage(p),this.viewer.columnLayoutArea.setColumns(e.sectionFormat),this.viewer.updateClientArea(e,e.page),a=!0)}else if(!i.i(n.isNullOrUndefined)(r)&&r.page!==e.page&&e.firstChild instanceof d.g&&r.lastChild instanceof d.g){var u=r.lastChild,l=e.firstChild;if(e instanceof d.o&&r.lastChild&&u instanceof d.g&&"NoBreak"===r.sectionFormat.breakCode&&e.page.index!==r.page.index&&e.index!==r.index){var g=r;g.sectionFormat.columns.length>1&&(g=this.getBodyWidget(g,!0));var f=s.a.round(this.getNextWidgetHeight(g)+l.height,2);if(!r.lastChild.isEndsWithPageBreak&&!r.lastChild.isEndsWithColumnBreak&&f<=s.a.round(this.viewer.clientActiveArea.bottom,2)){for(var m=r.page,v=e.page,y=0;y<v.bodyWidgets.length;y++){var w=v.bodyWidgets[y];v.bodyWidgets.splice(v.bodyWidgets.indexOf(w),1),m.bodyWidgets.splice(m.bodyWidgets.length,0,w),w.page=m,y--}e.y=this.viewer.clientActiveArea.y,this.documentHelper.removeEmptyPages()}}}a||(this.viewer.columnLayoutArea.setColumns(e.sectionFormat),this.viewer.updateClientArea(e,e.page),this.viewer.clientActiveArea.height-=e.y-this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.y=e.y),this.addBodyWidget(this.viewer.clientActiveArea,e),this.clearBlockWidget(e.childWidgets,!0,!0,!0),this.reLayoutMultiColumBlock(e,o),this.isInitialLoad=!1;var b=e.getSplitWidgets(),x=b[b.length-1],C=this.getBodyWidget(x,!0);this.viewer.updateClientArea(C,C.page);var I=this.getNextWidgetHeight(C);if(this.viewer.clientActiveArea.height-=I-this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.y=I,!i.i(n.isNullOrUndefined)(x)&&!i.i(n.isNullOrUndefined)(x.nextRenderedWidget)){o=x.nextRenderedWidget;var F=this.documentHelper.viewer.clientActiveArea.y,k=this.documentHelper.viewer.clientActiveArea.height;this.documentHelper.viewer.updateClientArea(o,o.page),this.documentHelper.viewer.clientActiveArea.y=F,this.documentHelper.viewer.clientActiveArea.height=k,this.documentHelper.blockToShift=o.firstChild}(i.i(n.isNullOrUndefined)(x.nextRenderedWidget)||!i.i(n.isNullOrUndefined)(x.nextRenderedWidget)&&"NoBreak"!==x.sectionFormat.breakCode&&x.nextRenderedWidget.sectionFormat.pageHeight!==x.sectionFormat.pageHeight&&x.nextRenderedWidget.sectionFormat.pageWidth!==x.sectionFormat.pageWidth)&&(this.documentHelper.blockToShift=void 0)},e.prototype.combineMultiColumnForRelayout=function(e){var t=e.getSplitWidgets(),r=t[0];for(e=t[t.length-1];e!==r;){for(var o=e.previousRenderedWidget,s=!1,a=0;a<e.childWidgets.length;a++)e.childWidgets[a]instanceof d.C&&!i.i(n.isNullOrUndefined)(e.childWidgets[a].previousSplitWidget)&&!i.i(n.isNullOrUndefined)(e.childWidgets[a].previousSplitWidget.previousSplitWidget)&&e.childWidgets[a].previousSplitWidget.bodyWidget.page!==e.childWidgets[a].previousSplitWidget.previousSplitWidget.bodyWidget.page&&(s=!0),e.childWidgets[a]instanceof d.C&&!i.i(n.isNullOrUndefined)(e.childWidgets[a].previousSplitWidget)&&e.childWidgets[a].previousSplitWidget.bodyWidget.page===e.childWidgets[a].bodyWidget.page&&!s?(e.childWidgets[a].combineWidget(this.viewer),o.lastChild instanceof d.u&&this.updateCellHeightInCombinedTable(o.lastChild),a--):(o.childWidgets.push(e.childWidgets[a]),e.childWidgets[a].containerWidget=o,e.childWidgets[a].containerWidget.page=o.page,e.childWidgets.splice(0,1),a--);e=e.previousRenderedWidget}this.documentHelper.removeEmptyPages()},e.prototype.reLayoutMultiColumBlock=function(e,t){var r,o=e.firstChild;do{o instanceof d.u&&"Auto"===o.tableFormat.preferredWidthType&&!o.tableFormat.allowAutoFit&&o.calculateGrid(),i.i(n.isNullOrUndefined)(o)||(this.viewer.updateClientAreaForBlock(o,!0,void 0,!0),r=this.layoutBlock(o,0),this.viewer.updateClientAreaForBlock(o,!1),o=r)}while(o&&-1!==e.getSplitWidgets().indexOf(o.bodyWidget));if(o=e.firstChild,this.viewer instanceof h.b&&e.sectionFormat.numberOfColumns>1&&!i.i(n.isNullOrUndefined)(t)&&"NoBreak"===t.sectionFormat.breakCode&&("NoBreak"===e.sectionFormat.breakCode||e.sectionIndex===e.page.bodyWidgets[0].sectionIndex)){var s=e.getSplitWidgets(),a=s[s.length-1];if(this.getColumnBreak(e))if(e.page!==a.page)this.splitBodyWidgetBasedOnColumn(a);else{var l=this.getBodyWidget(a,!0);this.viewer.updateClientArea(l,l.page);var c=this.getNextWidgetHeight(l);this.viewer.clientActiveArea.height-=c-this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.y=c}else i.i(n.isNullOrUndefined)(e.page.nextPage)||this.splitBodyWidgetBasedOnColumn(a)}},e.prototype.splitBodyWidgetBasedOnColumn=function(e){e=this.getBodyWidget(e,!0);var t=e;if(this.isMultiColumnSplit=!0,!this.isInitialLoad&&e.sectionFormat.equalWidth){var r=this.documentHelper.selection.startOffset,o=this.documentHelper.selection.endOffset;this.combineMultiColumn(e),this.layoutMultiColumnBody(e,!1),r!==this.documentHelper.selection.startOffset&&this.documentHelper.selection.select(r,o)}this.combineMultiColumn(e);for(var s=this.getCountOrLine(e,void 0,void 0,!0),a=s.lineCount,l=Math.round(a/e.sectionFormat.numberOfColumns);e;){var h=this.getCountOrLine(e,l,!0,!1),c=h.lineWidget,p=h.lineCount;if(!i.i(n.isNullOrUndefined)(c)){if(c.paragraph.containerWidget instanceof d.o)this.moveToNextLine(c,!0,c.indexInOwner);else if(c.paragraph.containerWidget instanceof d.j){var u=[c.paragraph.containerWidget.ownerTable],g=[c.paragraph.containerWidget.ownerRow],f=c.paragraph.containerWidget.index;u[u.length-1].isInsideTable&&(u[u.length-1]=this.getParentTable(u[u.length-1]),g[g.length-1]=this.getParentRow(g[g.length-1])),this.updateWidgetsToTable(u,g,g[g.length-1],!1,p,f,!0);for(var m=u[u.length-1],v=g[g.length-1],y=v.nextRenderedWidget;y;)this.clearRowWidget(y,!0,!0,!1),y=this.layoutRow(u,y),y=y.nextRenderedWidget;!i.i(n.isNullOrUndefined)(m.nextRenderedWidget)&&e.sectionFormat.equalWidth&&(this.documentHelper.blockToShift=m.nextRenderedWidget,this.documentHelper.layout.shiftLayoutedItems(!1))}var w=this.getBodyWidget(c.paragraph.bodyWidget,!0),b=this.getBodyWidget(w,!1);if(!w.sectionFormat.equalWidth&&b.sectionFormat.numberOfColumns-1===b.columnIndex){var x=w,C=this.getCountOrLine(w).lineCount;this.layoutMultiColumnBody(x,!0);C!==this.getCountOrLine(w).lineCount&&this.splitBodyWidgetBasedOnColumn(w)}this.viewer.updateClientArea(w,w.page);var I=this.getNextWidgetHeight(w);this.viewer.clientActiveArea.height-=I-this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.y=I,this.viewer.clientArea.y=this.viewer.clientActiveArea.y,this.viewer.clientArea.height=this.viewer.clientActiveArea.height}if(e=e.nextRenderedWidget,!i.i(n.isNullOrUndefined)(e)&&e.columnIndex===e.sectionFormat.numberOfColumns-1)break}this.isMultiColumnSplit=!1,this.isInitialLoad||(e=this.getBodyWidget(t,!1),i.i(n.isNullOrUndefined)(e.nextRenderedWidget)||(this.documentHelper.blockToShift=e.nextRenderedWidget.firstChild))},e.prototype.getColumnBreak=function(e){var t=this.getBodyWidget(e,!0);if(t.sectionFormat.numberOfColumns<=1)return!1;for(;t;){if(t.lastChild instanceof d.g&&t.lastChild.isEndsWithColumnBreak)return!0;if(i.i(n.isNullOrUndefined)(t.nextRenderedWidget)||t.index!==t.nextRenderedWidget.index)break;t=t.nextRenderedWidget}return!1},e.prototype.layoutMultiColumnBody=function(e,t){for(var r=!1;e;){r||(this.viewer.updateClientArea(e,e.page),this.viewer.clientActiveArea.height-=e.y-this.viewer.clientActiveArea.y,e instanceof d.a?(this.viewer.clientArea.height=Number.POSITIVE_INFINITY,this.viewer.clientActiveArea.height=Number.POSITIVE_INFINITY):this.viewer.clientActiveArea.y=e.y),r=!t;for(var o=0;o<e.childWidgets.length;o++){var s=e.childWidgets[o];s instanceof d.u&&this.clearTableWidget(s,!0,!0,!0),this.viewer.updateClientAreaForBlock(s,!0),this.layoutBlock(s,0),this.viewer.updateClientAreaForBlock(s,!1)}if(e.columnIndex===e.sectionFormat.numberOfColumns-1||!i.i(n.isNullOrUndefined)(e.nextRenderedWidget)&&e.sectionIndex!==e.nextRenderedWidget.sectionIndex)break;e=e.nextRenderedWidget}},e.prototype.getNextWidgetHeight=function(e){for(var t=0,r=0;e&&e.childWidgets.length>0&&(t=e.lastChild.height,e.lastChild instanceof d.u&&(t=this.getHeight(e.lastChild)),t+=e.lastChild.y,t>r&&(r=t),(i.i(n.isNullOrUndefined)(e)||e.columnIndex!==e.sectionFormat.numberOfColumns-1)&&0!==e.sectionFormat.numberOfColumns&&(i.i(n.isNullOrUndefined)(e.nextRenderedWidget)||e.sectionIndex===e.nextRenderedWidget.sectionIndex));)e=e.nextRenderedWidget;return r},e.prototype.getHeight=function(e){for(var t=0,i=0;i<e.childWidgets.length;i++)t+=e.childWidgets[i].height;return t},e.prototype.getCountOrLine=function(e,t,r,o){for(var s,a,l=0,h=0,c=!1,p=0,u=0,g=0;e;){for(var f=0;f<e.childWidgets.length;f++){var m=e.childWidgets[f];if(m instanceof d.g)for(var v=0;v<m.childWidgets.length;v++){var y=m.childWidgets[v];if(g=0,i.i(n.isNullOrUndefined)(y.margin)||(g=y.margin.top+y.margin.bottom),r){if(p+=y.height-g,Math.round(t)<Math.round(p)){s=m.childWidgets[v],c=!0,h=0;break}h++}else l++,p+=y.height-g}else m instanceof d.u&&(a=this.getCountOrLineTable(m,t,r,p,!1,o),o?p+=a.lineCount:r?i.i(n.isNullOrUndefined)(a.lineWidget)?p=a.lineCount:(s=a.lineWidget,u=a.lineCount,c=!0):l+=a.lineCount);if(c&&r)break}if(c&&r)break;if(!i.i(n.isNullOrUndefined)(e.nextRenderedWidget)&&e.index!==e.nextRenderedWidget.index)break;e=e.nextRenderedWidget}return o?{lineWidget:void 0,lineCount:p}:r?{lineWidget:s,lineCount:u}:{lineWidget:void 0,lineCount:l}},e.prototype.getCountOrLineTable=function(e,t,r,o,s,a){for(var l,h,c=0,p=!1,u=0,g=0,f=0,m=0,v=0,y=0,w=0;w<e.childWidgets.length;w++){var b=e.childWidgets[w],x=void 0,C=void 0;f=0,m=0,v=0,y=0;for(var I=0;I<b.childWidgets.length;I++){for(var F=b.childWidgets[I],k=0;k<F.childWidgets.length;k++){var P=F.childWidgets[k];if(P instanceof d.g&&P.childWidgets.length>0)for(var T=0;T<P.childWidgets.length;T++)f++,x=F,v+=P.childWidgets[T].height;else h=this.getCountOrLineTable(P,t,r,o,!0,a),f+=h.lineCount,v+=h.lineCount}m<f&&(m=f),y<v&&(y=v,C=x),f=0,v=0}if(!r||s)u+=m,g+=y;else for(var S=0,W=0;W<C.childWidgets.length;W++){var P=C.childWidgets[W];if(P instanceof d.g)for(var I=0;I<P.childWidgets.length;I++){if(o+=P.childWidgets[I].height,Math.round(t)<Math.round(o)){l=P.childWidgets[I],p=!0,o=0,c=S;break}if(S++,p&&r)break}else{if(h=this.getCountOrLineTable(P,t,r,o,!1,a),!i.i(n.isNullOrUndefined)(h.lineWidget)){p=!0,o=0,l=h.lineWidget,S+=h.lineCount,c=S;break}S+=h.lineCount,o+=P.height}if(p&&r)break}if(m=0,p&&r)break}return a?{lineWidget:void 0,lineCount:g}:r?r&&i.i(n.isNullOrUndefined)(l)&&s?{lineWidget:void 0,lineCount:u}:r&&i.i(n.isNullOrUndefined)(l)&&!s?{lineWidget:void 0,lineCount:o}:{lineWidget:l,lineCount:c}:{lineWidget:void 0,lineCount:u}},e.prototype.combineMultiColumn=function(e){for(e=this.getBodyWidget(e,!1);e&&0!==e.columnIndex;){var t=e.previousRenderedWidget;if(t.lastChild instanceof d.g&&t.lastChild.isEndsWithColumnBreak)break;for(var r=!1,o=0;o<e.childWidgets.length;o++)e.childWidgets[o]instanceof d.C&&!i.i(n.isNullOrUndefined)(e.childWidgets[o].previousSplitWidget)&&!i.i(n.isNullOrUndefined)(e.childWidgets[o].previousSplitWidget.previousSplitWidget)&&e.childWidgets[o].previousSplitWidget.bodyWidget.page!==e.childWidgets[o].previousSplitWidget.previousSplitWidget.bodyWidget.page&&(r=!0),e.childWidgets[o]instanceof d.C&&!i.i(n.isNullOrUndefined)(e.childWidgets[o].previousSplitWidget)&&e.childWidgets[o].previousSplitWidget.bodyWidget.page===e.childWidgets[o].bodyWidget.page&&!r?(e.childWidgets[o].combineWidget(this.viewer),t.lastChild instanceof d.u&&this.updateCellHeightInCombinedTable(t.lastChild),o--):(t.childWidgets.push(e.childWidgets[o]),e.childWidgets[o].containerWidget=t,e.childWidgets[o].containerWidget.page=t.page,e.childWidgets.splice(0,1),o--);e=e.previousRenderedWidget}this.documentHelper.removeEmptyPages()},e.prototype.updateCellHeightInCombinedTable=function(e){for(var t=0,i=0,n=0;n<e.childWidgets.length;n++){for(var r=e.childWidgets[n],o=0;o<r.childWidgets.length;o++){for(var s=r.childWidgets[o],a=0;a<s.childWidgets.length;a++)i+=s.childWidgets[a].height;i>t&&(t=i),i=0;for(var l=0;l<r.childWidgets.length;l++)r.childWidgets[l].height=t}t=0}},e.prototype.layoutHeaderFooter=function(e,t,r){var o=t.getCurrentPageHeaderFooter(e,!0);if(o){var s=o;i.i(n.isNullOrUndefined)(o.page)&&(o.page=r,o.height=0,this.clearBlockWidget(o.childWidgets,!0,!0,!0),t.updateHFClientArea(e.sectionFormat,!0),this.layoutHeaderFooterItems(t,o)),o=s.clone(),o.parentHeaderFooter=s,this.clearBlockWidget(o.childWidgets,!0,!0,!0);var a=o;a.page=r,a.height=0,this.updateRevisionsToHeaderFooter(a,r),t.updateHFClientArea(e.sectionFormat,!0),r.headerWidget=this.layoutHeaderFooterItems(t,a),e.sectionFormat.topMargin<r.boundingRectangle.bottom&&r.headerWidget.floatingElements.length>0&&"Behind"!==r.headerWidget.floatingElements[0].textWrappingStyle&&(r.headerWidget=this.shiftItemsForVerticalAlignment(a))}if(o=t.getCurrentPageHeaderFooter(e,!1)){var s=o;i.i(n.isNullOrUndefined)(o.page)&&(o.page=r,o.height=0,this.clearBlockWidget(o.childWidgets,!0,!0,!0),t.updateHFClientArea(e.sectionFormat,!1),this.layoutHeaderFooterItems(t,o)),o=s.clone(),o.parentHeaderFooter=s,this.clearBlockWidget(o.childWidgets,!0,!0,!0);var l=o;l.page=r,l.height=0,t.updateHFClientArea(e.sectionFormat,!1),this.updateRevisionsToHeaderFooter(l,r),r.footerWidget=this.layoutHeaderFooterItems(t,l)}},e.prototype.shiftItemsForVerticalAlignment=function(e){for(var t=e.floatingElements,i=0;i<t.length;i++){var n=t[i],r=n.verticalOrigin,o=n.paragraph;if("Margin"===r&&!o.isInsideTable){var s=n.verticalPosition;if(0!=s){s+=this.viewer.clientActiveArea.y;var a=s-n.y;if(n.y=s,n instanceof d.s)for(var l=0;l<n.textFrame.childWidgets.length;l++){var h=n.textFrame.childWidgets[l];h instanceof d.g&&(h.y=h.y+a)}}}}return e},e.prototype.updateHeaderFooterToParent=function(e){var t=e.page.sectionIndex,i=this.viewer.getHeaderFooter(e.headerFooterType),n=e.clone();this.documentHelper.headersFooters[t][i]=n;for(var r=0;r<n.childWidgets.length;r++){var o=n.childWidgets[r];o instanceof d.u&&this.clearTableWidget(o,!1,!0)}return n},e.prototype.updateRevisionsToHeaderFooter=function(e,t){var i=e.childWidgets;if(e instanceof d.x&&i.length>0)for(var n=0;n<i.length;n++)if(i[n].childWidgets.length>0)for(var r=i[n].childWidgets,o=0;o<r.length;o++){var s=r[o].children;if(s)for(var a=0;a<s.length;a++)if(s[a].removedIds.length>0)for(var l=s[a].removedIds,h=0;h<l.length;h++){var c=this.documentHelper.revisionsInternal.get(l[h]);s[a].revisions[h]=c,this.updateRevisionRange(c,t)}}},e.prototype.updateRevisionRange=function(e,t){for(var i=0;i<e.range.length;i++){var n=e.range[i];n.line.paragraph.bodyWidget.page||(n.line.paragraph.bodyWidget.page=t)}},e.prototype.linkFieldInHeaderFooter=function(e){var t=e.firstChild;do{t instanceof d.g?this.linkFieldInParagraph(t):this.linkFieldInTable(t)}while(t=t.nextWidget)},e.prototype.linkFieldInParagraph=function(e){for(var t=0;t<e.childWidgets.length;t++)for(var r=e.childWidgets[t],o=0;o<r.children.length;o++){var s=r.children[o];if(s instanceof d.b&&(0!==s.fieldType||0===s.fieldType&&-1===this.documentHelper.fields.indexOf(s))&&s.linkFieldCharacter(this.documentHelper),s instanceof d.D&&!i.i(n.isNullOrUndefined)(s.previousElement)&&s.previousElement instanceof d.b&&s.fieldBegin!==s.previousElement.fieldBegin&&(s.fieldBegin=s.previousElement.fieldBegin),s instanceof d.s){var a=s.textFrame.firstChild;if(a)do{a instanceof d.g?this.linkFieldInParagraph(a):this.linkFieldInTable(a)}while(a=a.nextWidget)}else if(s instanceof d.B){var l=this.getCommentById(this.documentHelper.comments,s.commentId);i.i(n.isNullOrUndefined)(l)||(0===s.commentType?l.commentStart=s:l.commentEnd=s,s.comment=l)}}},e.prototype.getCommentById=function(e,t){for(var i=0;i<e.length;i++){var n=e[i];if(n.commentId===t)return n}},e.prototype.linkFieldInTable=function(e){for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],n=0;n<i.childWidgets.length;n++)for(var r=i.childWidgets[n],o=0;o<r.childWidgets.length;o++){var s=r.childWidgets[o];s instanceof d.g?this.linkFieldInParagraph(s):this.linkFieldInTable(s)}},e.prototype.layoutHeaderFooterItems=function(e,t){if(this.viewer.updateClientAreaLocation(t,e.clientActiveArea),0===t.childWidgets.length){var i=new d.g,n=new d.p(i);i.childWidgets.push(n),t.childWidgets.push(i),i.containerWidget=t}this.linkFieldInHeaderFooter(t);for(var r=0;r<t.childWidgets.length;r++){var o=t.childWidgets[r];o instanceof d.u&&"Auto"===o.tableFormat.preferredWidthType&&!o.tableFormat.allowAutoFit&&!o.isGridUpdated&&o.calculateGrid(),e.updateClientAreaForBlock(o,!0),this.layoutBlock(o,0),e.updateClientAreaForBlock(o,!1)}var s=t.headerFooterType;return"OddFooter"!==s&&"EvenFooter"!==s&&"FirstPageFooter"!==s||this.shiftChildLocation(e.clientArea.y-e.clientActiveArea.y,t),t},e.prototype.shiftChildLocation=function(e,t){var i=t.y+e,n=t.page.boundingRectangle.height-t.page.boundingRectangle.height/100*40;i=Math.max(i,n),e=i-t.y;for(var r=t.y=i,o=0;o<t.childWidgets.length;o++){var s=t.childWidgets[o];if(s instanceof d.g){s.x=s.x,s.y=0===o?s.y+e:r,r+=s.height;for(var a=0;a<s.childWidgets.length;a++)for(var l=s.childWidgets[a],h=0;h<l.children.length;h++){var c=l.children[h];if(c instanceof d.v&&"Inline"!==c.textWrappingStyle){if("Paragraph"===c.verticalOrigin||"Line"===c.verticalOrigin)c.y=s.y+c.verticalPosition;else{var p=this.getFloatingItemPoints(c);c.y=p.y}if(c instanceof d.s){var u=c.textFrame.marginTop;this.updateChildLocationForCellOrShape(c.y+u,c)}}}}else this.shiftChildLocationForTableWidget(s,e),r+=s.height}},e.prototype.shiftChildLocationForTableWidget=function(e,t){e.y=e.y+t;for(var i=0;i<e.childWidgets.length;i++){var n=e.childWidgets[i];n instanceof d.z&&this.shiftChildLocationForTableRowWidget(n,t)}},e.prototype.shiftChildLocationForTableRowWidget=function(e,t){e.y=e.y+t;for(var i=0;i<e.childWidgets.length;i++)this.shiftChildLocationForTableCellWidget(e.childWidgets[i],t)},e.prototype.shiftChildLocationForTableCellWidget=function(e,t){e.y=e.y+t;for(var i=0;i<e.childWidgets.length;i++)e.childWidgets[i]instanceof d.g?(e.childWidgets[i].x=e.childWidgets[i].x,e.childWidgets[i].y=e.childWidgets[i].y+t):this.shiftChildLocationForTableWidget(e.childWidgets[i],t)},e.prototype.layoutBlock=function(e,t,i){var n;if(e instanceof d.g){e.splitTextRangeByScriptType(0),e.splitLtrAndRtlText(0),e.combineconsecutiveRTL(0),n=this.layoutParagraph(e,t,i);var r=this.checkAndRelayoutPreviousOverlappingBlock(e);r&&(n=r)}else n=this.layoutTable(e,t),this.checkAndRelayoutPreviousOverlappingBlock(e),this.updateTableYPositionBasedonTextWrap(n);return n.nextRenderedWidget},e.prototype.updateTableYPositionBasedonTextWrap=function(e){var t=this;if(!(i.i(n.isNullOrUndefined)(e.bodyWidget)||e.containerWidget instanceof d.i)){var r=e.y,o=new d.t(e.x,e.y,e.width,e.height);e.bodyWidget.floatingElements.forEach(function(i){if(i instanceof d.s&&!i.paragraph.isInsideTable){var n=new d.t(i.x,i.y,i.width,i.height);if(("TopAndBottom"===i.textWrappingStyle||"Square"===i.textWrappingStyle)&&o.isIntersecting(n)){e.y=i.y+i.height+i.distanceBottom,t.updateChildLocationForTable(e.y,e);var s=e.y-r;t.viewer.cutFromTop(t.viewer.clientActiveArea.y+s)}}})}},e.prototype.checkAndRelayoutPreviousOverlappingBlock=function(e){if(!(e.containerWidget instanceof d.i||this.isRelayoutOverlap)){var t=e.previousWidget;if(e instanceof d.g)if(e.floatingElements.length>0)for(var i=0,n=0;n<e.floatingElements.length;n++){var r=e.floatingElements[n];if("InFrontOfText"!==r.textWrappingStyle&&"Behind"!==r.textWrappingStyle&&"Inline"!==r.textWrappingStyle){for(var o=new d.t(r.x,r.y,r.width,r.height);t;){if(e.isInsideTable&&i>this.viewer.clientArea.height){this.startOverlapWidget=void 0,this.endOverlapWidget=void 0;break}if(t instanceof d.g){var s=new d.t(t.x,t.y,t.width,t.height);o.isIntersecting(s)&&this.startOverlapWidget!==t&&(this.startOverlapWidget=t,this.endOverlapWidget=e)}i+=t.height,t=t.previousWidget}t=e.previousWidget}}else{var a=e.getSplitWidgets();if(a)return a[a.length-1]}else{var l=e;if(!l.wrapTextAround)return l;for(var h=new d.t(l.x,l.y,l.getTableCellWidth(),l.height);t;){if(t instanceof d.g){var c=new d.t(t.x,t.y,t.width,t.height);h.isIntersecting(c)&&this.startOverlapWidget!==t&&(this.startOverlapWidget=t,this.endOverlapWidget=e)}t=t.previousWidget}t=e.previousWidget}this.startOverlapWidget&&(this.isRelayoutOverlap=!0,this.skipRelayoutOverlap=!0,this.layoutStartEndBlocks(this.startOverlapWidget,e),this.isRelayoutOverlap=!1,this.skipRelayoutOverlap=!1),this.startOverlapWidget=void 0,this.endOverlapWidget=void 0}return e},e.prototype.addParagraphWidget=function(e,t){return t.isEmpty()&&!i.i(n.isNullOrUndefined)(t.paragraphFormat)&&("Center"===t.paragraphFormat.textAlignment||"Right"===t.paragraphFormat.textAlignment||"Justify"===t.paragraphFormat.textAlignment&&t.paragraphFormat.bidi)&&-1===t.paragraphFormat.listFormat.listId?(this.updateXPositionForEmptyParagraph(e,t),t.y=e.y):(this.viewer.clientActiveArea.width<=0&&this.viewer instanceof h.a?t.x=this.previousPara:(t.x=e.x,this.previousPara=t.x),t.width=e.width,t.y=e.y,t.clientX=void 0,t.hasOwnProperty("absoluteXPosition")&&delete t.absoluteXPosition),t},e.prototype.updateXPositionForEmptyParagraph=function(e,t){if(t.isEmpty()&&!i.i(n.isNullOrUndefined)(t.paragraphFormat)){var r=this.documentHelper.textHelper.getParagraphMarkWidth(t.characterFormat);t.clientX=e.x;var o=e.x;t.absoluteXPosition={width:e.width,x:e.x},"Center"===t.paragraphFormat.textAlignment?o+=(e.width-r)/2:o+=e.width-r,t.width=r,t.x=o}},e.prototype.addLineWidget=function(e){var t=void 0;return t=new d.p(e),t.width=e.width,e.childWidgets.push(t),t.paragraph=e,t},e.prototype.isFirstElementWithPageBreak=function(e){var t=!1;if(this.viewer instanceof h.b){var i=e.childWidgets[0];if(i)for(var n=i.children[0];n;){if(!(n instanceof d.e&&n.name.indexOf("_")>=0)){n instanceof d.d&&("\f"===n.text||n.text===String.fromCharCode(14))&&(t=!0);break}n=n.nextElement}}return t},e.prototype.layoutfootNote=function(e){if("Pages"===this.documentHelper.owner.layoutType){var t=this.viewer.clientActiveArea.clone(),i=this.viewer.clientArea.clone();"Footnote"===e.footNoteType&&e.sectionFormat.columns.length>1&&!this.isInitialLoad&&(this.updateColumnIndex(e.bodyWidgets[0],!1),this.layoutMultiColumnBody(e.bodyWidgets[0],!0)),"Endnote"===e.footNoteType&&e.bodyWidgets[0].sectionFormat.numberOfColumns>1&&(this.isInitialLoad||this.updateColumnIndex(e.bodyWidgets[0],!1),this.layoutMultiColumnBody(e.bodyWidgets[0],!0),this.viewer.clientActiveArea=t);var n=0;e.sectionFormat.columns.length>1&&"Footnote"===e.footNoteType&&(this.viewer.updateClientArea(e,e.page),n=this.viewer.clientActiveArea.width),"Footnote"===e.footNoteType&&(this.viewer.updateFootnoteClientArea(e.sectionFormat,e),e.sectionFormat.columns.length>1&&(this.viewer.clientActiveArea.width=n,this.viewer.clientArea.width=n)),e.height=0;var r=void 0,o=0;this.isRelayoutFootnote=!1;var s=0;this.viewer instanceof h.b&&e.bodyWidgets.length>0&&("Footnote"===e.footNoteType&&e.sectionFormat.columns.length>1||"Endnote"===e.footNoteType&&e.bodyWidgets[0].sectionFormat.columns.length>1)&&this.splitFootNoteWidgetBasedOnColumn(e.bodyWidgets[0]);for(var l=e.bodyWidgets[0],c=0,p=0;p<e.bodyWidgets.length;p++){if(e.bodyWidgets[p].columnIndex!==l.columnIndex&&("Footnote"===e.footNoteType&&e.sectionFormat.columns.length>1||"Endnote"===e.footNoteType&&e.bodyWidgets[p].sectionFormat.columns.length>1)&&(this.viewer.updateClientArea(e.bodyWidgets[p],e.bodyWidgets[p].page),n=this.viewer.clientActiveArea.width,c=this.viewer.clientActiveArea.x,"Footnote"===e.footNoteType&&this.viewer.updateFootnoteClientArea(e.sectionFormat,e),this.viewer.clientActiveArea.x=c,this.viewer.clientArea.x=c,this.viewer.clientActiveArea.width=n,this.viewer.clientArea.width=n,this.viewer.cutFromTop(e.y+o)),0===p){var u=new d.g;u.characterFormat=new a.c,u.paragraphFormat=new a.a,u.index=0;var g=new d.p(u);u.childWidgets.push(g),o=this.documentHelper.textHelper.getParagraphMarkSize(u.characterFormat).Height,e.height+=o,e.y=this.viewer.clientActiveArea.y,"Endnote"===e.footNoteType&&this.viewer.updateClientArea(e.bodyWidgets[p],e.bodyWidgets[p].page,!0),this.viewer.cutFromTop(e.y+o),e.margin=new d.E(0,o,0,0)}for(var f=0;f<e.bodyWidgets[p].childWidgets.length;f++)r=e.bodyWidgets[p].childWidgets[f],r.index=s,s++,r.containerWidget=e.bodyWidgets[p],r.containerWidget.page=e.page,r.containerWidget.containerWidget=e,this.viewer.updateClientAreaForBlock(r,!0),r instanceof d.u&&(this.clearTableWidget(r,!0,!0,!0),this.isRelayoutFootnote=!0,this.viewer.clientArea.height=Number.POSITIVE_INFINITY,this.viewer.clientActiveArea.height=Number.POSITIVE_INFINITY),this.layoutBlock(r,0),"Footnote"===e.footNoteType&&e.bodyWidgets[p].columnIndex===l.columnIndex&&(e.height+=r.height),this.viewer.updateClientAreaForBlock(r,!1);l=e.bodyWidgets[p]}if(e.sectionFormat.columns.length>1){var m=this.getFootNoteBodyHeight(e.bodyWidgets[0]);e.height=m+o}if("Footnote"===e.footNoteType&&this.shiftChildWidgetInFootnote(e),"Footnote"===e.footNoteType&&e.sectionFormat.columns.length>1&&e.page.bodyWidgets[e.page.bodyWidgets.length-1].sectionFormat.columns.length>1){var v=this.getBodyWidget(e.page.bodyWidgets[e.page.bodyWidgets.length-1],!0);this.getNextWidgetHeight(v)>e.y&&(this.footnoteHeight=e.height,this.layoutMultiColumnBody(v,!0))}if(this.viewer.clientActiveArea=t,this.viewer.clientArea=i,!this.islayoutFootnote&&this.viewer.clientActiveArea.y+this.viewer.clientActiveArea.height>e.y){this.viewer.clientActiveArea.height-=e.height;var y=this.viewer.clientActiveArea.y+this.viewer.clientActiveArea.height-e.y;this.viewer.clientActiveArea.height-=y}}return this.footnoteHeight=0,e},e.prototype.getFootNoteBodyHeight=function(e){for(var t=0;e&&0===e.columnIndex;){for(var i=0;i<e.childWidgets.length;i++)t+=e.childWidgets[i].height;e=e.nextRenderedWidget}return t},e.prototype.splitFootNoteWidgetBasedOnColumn=function(e){for(var t=this.getCountOrLine(e,void 0,void 0,!0),r=t.lineCount,o=Math.round(r/e.sectionFormat.numberOfColumns);e;){var s=this.getCountOrLine(e,o,!0,!1),a=this.viewer.clientActiveArea.clone(),l=this.viewer.clientArea.clone();if(0===s.lineWidget.paragraph.indexInOwner&&0===s.lineWidget.indexInOwner)this.updateColumnIndex(s.lineWidget.paragraph.bodyWidget,!0);else{this.splitParagraph(s.lineWidget.paragraph,s.lineWidget.indexInOwner,void 0);var d=this.moveBlocksToNextPage(s.lineWidget.paragraph.previousRenderedWidget);this.viewer.clientActiveArea=a,this.viewer.clientArea=l,i.i(n.isNullOrUndefined)(d.nextRenderedWidget)||this.updateColumnIndex(d.nextRenderedWidget,!0)}if(s.lineWidget.paragraph.bodyWidget.columnIndex===s.lineWidget.paragraph.bodyWidget.sectionFormat.numberOfColumns-1)break;e=e.nextRenderedWidget}},e.prototype.updateColumnIndex=function(e,t){for(;e;)t?e.columnIndex++:e.columnIndex=0,e=e.nextRenderedWidget},e.prototype.shiftChildWidgetInFootnote=function(e){var t=e.page,i=e.y-e.height;if(1===t.bodyWidgets[0].childWidgets.length&&t.bodyWidgets[0].firstChild){var n=t.bodyWidgets[0].firstChild.y,r=this.getBodyWidgetHeight(t.bodyWidgets[0]);i<n+r&&(i=n+r)}e.y=i,i+=e.margin.top;for(var o=i,s=e.bodyWidgets[0],a=0;a<e.bodyWidgets.length;a++){e.bodyWidgets[a].columnIndex!==s.columnIndex&&(i=o),s=e.bodyWidgets[a];for(var l=0;l<e.bodyWidgets[a].childWidgets.length;l++){var h=e.bodyWidgets[a].childWidgets[l];h instanceof d.g?(h.y=i,i+=h.height):(this.shiftChildLocationForTableWidget(h,i-h.y),i+=h.height)}}},e.prototype.getBodyWidgetHeight=function(e){for(var t=0,i=0;i<e.childWidgets.length;i++)t+=e.childWidgets[i].height;return t},e.prototype.checkParaHasField=function(e){for(var t=!1,i=0;i<e.childWidgets.length;i++)for(var n=e.childWidgets[i],r=0;r<n.children.length;r++){var o=n.children[r];if(o instanceof d.b&&(2===o.fieldType||1===o.fieldType)&&this.documentHelper.fieldStacks.length>0&&o.fieldBegin===this.documentHelper.fieldStacks[this.documentHelper.fieldStacks.length-1]){t=!0;break}}return t},e.prototype.checkTableHasField=function(e){for(var t=!1,i=0;i<e.childWidgets.length;i++)for(var n=e.childWidgets[i],r=0;r<n.childWidgets.length;r++)for(var o=n.childWidgets[r],s=0;s<o.childWidgets.length;s++){var a=o.childWidgets[s];if(t=a instanceof d.g?this.checkParaHasField(a):this.checkTableHasField(a))break}return t},e.prototype.layoutParagraph=function(e,t,r){if(this.isFieldCode&&!this.checkParaHasField(e))return e.isFieldCodeBlock=!0,e;this.addParagraphWidget(this.viewer.clientActiveArea,e);var o=!0;if(this.isFirstElementWithPageBreak(e)||(this.layoutListItems(e,r),o=!1),e.isEmpty())this.layoutEmptyLineWidget(e,!0);else{var a=t<e.childWidgets.length?e.childWidgets[t]:void 0;for(this.isRelayoutOverlap||e.containerWidget instanceof d.i||this.layoutFloatElements(e);a instanceof d.p;){if(e!==a.paragraph&&0===a.indexInOwner&&o&&(a.previousLine.isEndsWithColumnBreak?(this.viewer.updateClientAreaForBlock(e,!0),this.layoutListItems(a.paragraph),this.viewer.updateClientAreaForBlock(e,!1)):this.layoutListItems(a.paragraph)),a.isFirstLine()&&i.i(n.isNullOrUndefined)(this.fieldBegin)&&!i.i(n.isNullOrUndefined)(e.paragraphFormat)){var l=-s.a.convertPointToPixel(e.paragraphFormat.firstLineIndent);this.viewer.updateClientWidth(l)}a.marginTop=0,a=this.layoutLine(a,0),e=a.paragraph,a=a.nextLine}}return this.updateWidgetToPage(this.viewer,e),e.isLayouted=!0,e.isFieldCodeBlock=!1,e},e.prototype.clearLineMeasures=function(){this.maxBaseline=0,this.maxTextBaseline=0,this.maxTextHeight=0},e.prototype.layoutFloatElements=function(e){var t=this;e.floatingElements.forEach(function(e){e instanceof d.v&&"Inline"!==e.textWrappingStyle&&(t.isRelayoutOverlap||t.layoutShape(e))})},e.prototype.layoutShape=function(e){if(!(e instanceof d.s&&e.isHorizontalRule)){if("Inline"!==e.textWrappingStyle){var t=this.getFloatingItemPoints(e);e.x=t.x,e.y=t.y,!e.paragraph.isInsideTable&&0!==e.paragraph.indexInOwner&&e.verticalPosition>=0&&Math.round(e.paragraph.y)>=Math.round(e.y)&&this.viewer.clientArea.bottom<=e.y+e.height&&("Line"==e.verticalOrigin||"Paragraph"==e.verticalOrigin)&&"InFrontOfText"!==e.textWrappingStyle&&"Behind"!==e.textWrappingStyle&&(this.moveToNextPage(this.viewer,e.line),this.updateShapeBaseLocation(e.line.paragraph));var i=e.paragraph.bodyWidget;-1===i.floatingElements.indexOf(e)&&(i.floatingElements.push(e),i.floatingElements.sort(function(e,t){return e.y-t.y})),-1===e.paragraph.floatingElements.indexOf(e)&&e.paragraph.floatingElements.push(e)}else if(0===e.width&&0!==e.widthScale){var n=s.a.convertPointToPixel(e.line.paragraph.getContainerWidth());e.width=n/100*e.widthScale}var r=this.viewer.clientArea,o=this.viewer.clientActiveArea;if(e instanceof d.s){var a=e.textFrame.childWidgets;this.viewer.updateClientAreaForTextBoxShape(e,!0);for(var l=0;l<a.length;l++){var h=a[l];this.viewer.updateClientAreaForBlock(h,!0),h instanceof d.u&&this.clearTableWidget(h,!0,!0),this.layoutBlock(h,0),this.viewer.updateClientAreaForBlock(h,!1)}}this.viewer.clientActiveArea=o,this.viewer.clientArea=r}},e.prototype.moveElementFromNextLine=function(e){var t=e.nextLine;for(t&&!e.paragraph.bodyWidget.sectionFormat.equalWidth&&e.paragraph.bodyWidget.columnIndex!==t.paragraph.bodyWidget.columnIndex&&(t=void 0);t instanceof d.p;){if(t.children.length>0){var i=t.children.splice(0,1)[0];e.children.push(i),i.line=e;break}1===t.paragraph.childWidgets.length?t.paragraph.destroy():t.paragraph.childWidgets.splice(t.paragraph.childWidgets.indexOf(t),1),t=e.nextLine}},e.prototype.layoutLine=function(e,t){var r=e.paragraph;0===e.children.length&&this.moveElementFromNextLine(e);var o=e.children[t],s=!0;if(o instanceof d.b&&e.children[e.children.length-1]instanceof d.b){s=!1;for(var a=0;a<e.children.length;a++)if(2==e.children[a].fieldType&&void 0!=e.children[a].nextElement&&!(e.children[a].nextElement instanceof d.b)){s=!0;break}}this.clearLineMeasures(),e.marginTop=0;for(r.bodyWidget.indexInOwner,e.indexInOwner;o instanceof d.c;){if(o.padding.left=0,s?this.layoutElement(o,r):(this.layoutElement(o,r,!0),s=!0),e=o.line,o instanceof d.d){var l=o;!i.i(n.isNullOrUndefined)(l.errorCollection)&&l.errorCollection.length>0&&(l.ischangeDetected=!0)}if(this.isRTLLayout)o=void 0,this.isRTLLayout=!1;else{var h=r.childWidgets.indexOf(o.line);if(h>0&&this.hasFloatingElement)this.hasFloatingElement=!1,r.bodyWidget.floatingElements.length>0&&o instanceof d.d&&!(r.containerWidget instanceof d.j)&&(o=r.childWidgets[h].children[0]);else{if(this.hasFloatingElement=!1,this.is2013Justification&&!i.i(n.isNullOrUndefined)(this.nextElementToLayout))o=this.nextElementToLayout;else if((o=o.nextElement)instanceof d.d&&0==o.text.indexOf(" ")&&o.text.length>2&&i.i(n.isNullOrUndefined)(o.nextElement)&&o.text.trim().length>0){o.text=o.text.substring(1,o.text.length);var c=o.line.children.indexOf(o);o.line.children.splice(c,1);var l=new d.d;if(l.text=" ",l.line=o.line,l.characterFormat.copyFormat(o.characterFormat),o.revisions.length>0)for(var p=0;p<o.revisions.length;p++){var u=o.revisions[p];l.revisions.push(u);var g=u.range.indexOf(o);g<0?u.range.push(l):u.range.splice(g,0,l)}o.line.children.splice(c,0,l),o.line.children.splice(c+1,0,o),o=l}this.nextElementToLayout=void 0}}}return e},e.prototype.layoutElement=function(e,t,r){if(!(e.isPageBreak&&t.isInHeaderFooter||e instanceof d.s&&e.isHorizontalRule)){var o=e.line,a="",l=e.indexInOwner;if(this.viewer.owner.editor&&this.viewer.owner.editorHistory&&this.viewer.owner.editorHistory.isRedoing&&!i.i(n.isNullOrUndefined)(e.paragraph.containerWidget.footNoteReference)&&this.viewer.owner.enableTrackChanges&&e.removedIds.length>0&&this.viewer.owner.editor.constructRevisionFromID(e,!0),e instanceof d.b){if(0===e.fieldType&&(-1===this.documentHelper.fields.indexOf(e)&&this.documentHelper.fields.push(e),i.i(n.isNullOrUndefined)(e.formFieldData)||-1!==this.documentHelper.formFields.indexOf(e)||this.isInsertFormField||this.documentHelper.formFields.push(e)),this.layoutFieldCharacters(e),e.line.isLastLine()&&i.i(n.isNullOrUndefined)(e.nextNode)&&!this.isFieldCode)this.moveToNextLine(o);else if(i.i(n.isNullOrUndefined)(e.nextElement)&&this.viewer.clientActiveArea.width>0&&!e.line.isLastLine())this.moveElementFromNextLine(o),e.line.isLastLine()&&i.i(n.isNullOrUndefined)(e.nextNode)&&!this.isFieldCode&&(2!==e.fieldType&&i.i(n.isNullOrUndefined)(e.fieldSeparator)&&this.layoutEmptyLineWidget(t,!1,e.line),this.moveToNextLine(o));else if(i.i(n.isNullOrUndefined)(e.nextElement)&&0===this.viewer.clientActiveArea.width)this.moveToNextLine(o),o.paragraph.lastChild===o&&!i.i(n.isNullOrUndefined)(o.nextLine)&&this.viewer.clientActiveArea.height>=0&&this.moveFromNextPage(o);else if(r){var c=this.documentHelper.textHelper.getHeight(t.characterFormat);e.height=c.Height}}else{if(e instanceof d.q||this.isFieldCode||e instanceof d.e||e instanceof d.F||e instanceof d.G||e instanceof d.H||e instanceof d.v&&"Inline"!==e.textWrappingStyle){if(e instanceof d.e)if(0!==e.bookmarkType||this.documentHelper.bookmarks.containsKey(e.name)){if(1===e.bookmarkType&&this.documentHelper.bookmarks.containsKey(e.name)){var p=this.documentHelper.bookmarks.get(e.name);if((i.i(n.isNullOrUndefined)(p.reference)||i.i(n.isNullOrUndefined)(p.reference.paragraph)||i.i(n.isNullOrUndefined)(p.reference.paragraph.bodyWidget))&&(p.reference=e,e.reference=p),i.i(n.isNullOrUndefined)(p.properties)){if(!i.i(n.isNullOrUndefined)(this.documentHelper.selection)&&this.documentHelper.selection.isRenderBookmarkAtEnd(p.reference)){var u=p.reference.paragraph.associatedCell.ownerRow;u.isRenderBookmarkEnd=!0}}else if(!i.i(n.isNullOrUndefined)(e.paragraph.associatedCell)){var g=this.documentHelper.selection.getLastParagraph(e.paragraph.associatedCell),f=g.lastChild;if(!i.i(n.isNullOrUndefined)(f)){var m=f.children[f.children.length-1];if(m==e){for(var v=parseInt(e.reference.properties.columnLast),y=e.paragraph.associatedCell.ownerRow,w=void 0,b=v;i.i(n.isNullOrUndefined)(w)&&b>-1;)w=y.getCellUsingColumnIndex(y.rowIndex,b),i.i(n.isNullOrUndefined)(w)&&b--;i.i(n.isNullOrUndefined)(w)||(w.isRenderBookmarkEnd=!0)}}}}else if(0===e.bookmarkType&&this.documentHelper.bookmarks.containsKey(e.name)&&(i.i(n.isNullOrUndefined)(e.reference)&&this.documentHelper.bookmarks.remove(e.name),!i.i(n.isNullOrUndefined)(e.properties))){var x=parseInt(e.properties.columnFirst);if(e.paragraph.isInsideTable){var C=e.paragraph.associatedCell.ownerRow,I=C.getCellUsingColumnIndex(C.rowIndex,x);i.i(n.isNullOrUndefined)(I)||(I.isRenderBookmarkStart=!0)}}}else if(this.documentHelper.bookmarks.add(e.name,e),!i.i(n.isNullOrUndefined)(e.properties)){var x=parseInt(e.properties.columnFirst);if(e.paragraph.isInsideTable){var F=e.paragraph.associatedCell.ownerRow,I=F.getCellUsingColumnIndex(F.rowIndex,x);i.i(n.isNullOrUndefined)(I)||(I.isRenderBookmarkStart=!0)}}if(e instanceof d.G||e instanceof d.F)if(e instanceof d.G&&(this.documentHelper.owner.currentUser===e.user||"Everyone"===e.group&&""===e.user)){if(-1!=e.columnFirst&&-1!=e.columnLast){var k=e.paragraph.associatedCell.ownerRow,I=k.getCellUsingColumnIndex(k.rowIndex,e.columnFirst);i.i(n.isNullOrUndefined)(I)||(I.isRenderEditRangeStart=!0,k.editRangeID.add(e.editRangeId,e))}}else if(e instanceof d.F&&(this.documentHelper.owner.currentUser===e.editRangeStart.user||"Everyone"===e.editRangeStart.group&&""===e.editRangeStart.user)&&-1!=e.editRangeStart.columnFirst&&-1!=e.editRangeStart.columnLast){var P=e.paragraph.associatedCell.ownerRow;if(P.editRangeID.containsKey(e.editRangeStart.editRangeId)){var I=P.getCellUsingColumnIndex(P.rowIndex,e.editRangeStart.columnFirst);i.i(n.isNullOrUndefined)(I)||I.isRenderEditRangeStart&&(I.isRenderEditRangeEnd=!0)}else for(var T=e.paragraph.associatedCell.ownerTable,S=P.rowIndex-1;S>=0;S--){var W=T.childWidgets[S];if(W.editRangeID.containsKey(e.editRangeStart.editRangeId)){var N=W.getCellUsingColumnIndex(W.rowIndex,e.editRangeStart.columnFirst);if(!i.i(n.isNullOrUndefined)(N)&&N.isRenderEditRangeStart){N.isRenderEditRangeEnd=!0;break}}}}if(e instanceof d.v&&"Inline"!==e.textWrappingStyle&&-1==t.floatingElements.indexOf(e)&&e instanceof d.s&&(-1===t.floatingElements.indexOf(e)&&t.floatingElements.push(e),-1===t.bodyWidget.floatingElements.indexOf(e)&&t.bodyWidget.floatingElements.push(e)),e instanceof d.H&&-1===this.documentHelper.contentControlCollection.indexOf(e))if(0===e.type)this.documentHelper.contentControlCollection.push(e);else if(1===e.type)for(var H=e.paragraph.bodyWidget.page,S=0;S<this.documentHelper.contentControlCollection.length;S++){var E=this.documentHelper.contentControlCollection[S],O=E.line.paragraph.isInHeaderFooter;O&&e.contentControlProperties===E.contentControlProperties&&H===E.line.paragraph.bodyWidget.page?(e.reference=E,E.reference=e):O||e.contentControlProperties!==E.contentControlProperties||(e.reference=E,E.reference=e)}return i.i(n.isNullOrUndefined)(e.nextElement)&&this.viewer.clientActiveArea.width>0&&!e.line.isLastLine()&&this.moveElementFromNextLine(o),void(e.line.isLastLine()&&i.i(n.isNullOrUndefined)(e.nextElement)&&(this.hasValidElement(o.paragraph)&&!t.isContainsShapeAlone()?this.moveToNextLine(o):this.isInitialLoad||this.hasValidElement(o.paragraph)||!o.paragraph.paragraphFormat.bidi||-1===o.paragraph.paragraphFormat.listFormat.listId?this.layoutEmptyLineWidget(o.paragraph,!1,o,!1):this.moveToNextLine(o)))}if(e instanceof d.d&&"NoColor"!=e.characterFormat.highlightColor&&""!=e.text.trim()&&e.text!=e.text.trim()){var _=t.firstChild,f=t.lastChild;!i.i(n.isNullOrUndefined)(_)&&_ instanceof d.p&&_.children.length>0&&e===_.children[0]&&s.a.splitSpaceInTextElementBox(e,!0),!i.i(n.isNullOrUndefined)(f)&&f instanceof d.p&&f.children.length>0&&e===f.children[f.children.length-1]&&s.a.splitSpaceInTextElementBox(e,!1)}var B=e.width;if(e instanceof d.D&&!this.isTocField(e.fieldBegin)?(a=this.documentHelper.getFieldResult(e.fieldBegin,e.paragraph.bodyWidget.page),""!==a?e.text=a:a=e.text):e instanceof d.f?""!==(a=this.startAt(e,a))&&(e.text=a):e instanceof d.d&&(i.i(n.isNullOrUndefined)(e.paragraph.containerWidget.footNoteReference)||!e.line.isFirstLine()||0!==e.paragraph.index||0!==e.indexInOwner||this.documentHelper.owner.editor.handleEnterKey||(e.text=e.paragraph.containerWidget.footNoteReference.text),this.checkAndSplitTabOrLineBreakCharacter(e.text,e),a=e.text),e instanceof d.d&&(B=this.documentHelper.textHelper.getTextSize(e,e.characterFormat),"\t"===e.text?(B=this.getTabWidth(t,this.viewer,l,o,e),e.width=B):e.text!==String.fromCharCode(31)&&e.text!==String.fromCharCode(14)||(e.width=B=0)),i.i(n.isNullOrUndefined)(t.containerWidget)||!(t.bodyWidget.floatingElements.length>0)||e instanceof d.s&&"Inline"==e.textWrappingStyle||t.containerWidget instanceof d.i&&!(e instanceof d.B)||t.containerWidget instanceof d.j&&t.containerWidget.ownerTable.containerWidget instanceof d.i||this.adjustPosition(e,e.line.paragraph.bodyWidget),this.viewer instanceof h.b&&(e instanceof d.s&&"Inline"===e.textWrappingStyle||!(e instanceof d.s))&&this.viewer.clientActiveArea.height<e.height&&this.viewer.clientActiveArea.y!==this.viewer.clientArea.y&&(!(e instanceof d.d&&("\f"!==e.text&&e.text!==String.fromCharCode(14)||"\f"===e.text&&t.isPageBreak()&&"Word2013"===this.documentHelper.compatibilityMode))&&e instanceof d.d||this.moveToNextPage(this.viewer,o),e instanceof d.D&&this.updateFieldText(e),!e.previousElement||!(e.previousElement instanceof d.s&&"Inline"===e.previousElement.textWrappingStyle)&&e.previousElement instanceof d.s||this.cutClientWidth(e.previousElement)),e instanceof d.s&&"Inline"===e.textWrappingStyle&&(-1===t.floatingElements.indexOf(e)&&t.floatingElements.push(e),e.width>this.viewer.clientActiveArea.width&&(this.splitElementForClientArea(t,e),this.checkLineWidgetWithClientArea(o,e)),this.layoutShape(e)),e instanceof d.f&&(!e.isLayout||this.isLayoutWhole)&&"Pages"===this.documentHelper.owner.layoutType&&this.layoutFootEndNoteElement(e),e instanceof d.f&&(this.isfootMove&&(this.moveToNextPage(this.viewer,e.line),!e.previousElement||!(e.previousElement instanceof d.s&&"Inline"===e.previousElement.textWrappingStyle)&&e.previousElement instanceof d.s||this.cutClientWidth(e.previousElement),this.isfootMove=!1),t.paragraphFormat.keepWithNext&&t.paragraphFormat.keepLinesTogether&&e.isLayout&&!this.isLayoutWhole&&!i.i(n.isNullOrUndefined)(t.bodyWidget.page.footnoteWidget)&&0!==t.bodyWidget.page.footnoteWidget.y&&t.bodyWidget.page.footnoteWidget.y<this.viewer.clientActiveArea.y+this.viewer.clientActiveArea.height)){var L=this.viewer.clientActiveArea.y+this.viewer.clientActiveArea.height-t.bodyWidget.page.footnoteWidget.y;this.viewer.clientActiveArea.height-=L}if(parseFloat(B.toFixed(4))<=parseFloat(this.viewer.clientActiveArea.width.toFixed(4))||!this.viewer.textWrap){if(this.addElementToLine(t,e),i.i(n.isNullOrUndefined)(e.nextElement)&&!e.line.isLastLine()){var R=e.line.nextLine,A=R.children[0];A instanceof d.d&&0==A.text.indexOf(" ")&&this.moveElementFromNextLine(o)}i.i(n.isNullOrUndefined)(e.nextElement)&&this.viewer.clientActiveArea.width>0&&!e.line.isLastLine()?this.moveElementFromNextLine(o):!e.line.isLastLine()&&i.i(n.isNullOrUndefined)(e.nextElement)&&0===this.viewer.clientActiveArea.width&&(this.moveToNextLine(o),o.paragraph.lastChild===o&&this.viewer.clientActiveArea.height>=0&&this.moveFromNextPage(o))}else if(e instanceof d.d){if("\t"===e.text){var D=e.line,U=!1;if(0!==e.indexInOwner&&e instanceof d.I?(U=!0,this.addSplittedLineWidget(D,D.children.indexOf(e)-1)):(this.isWrapText&&this.viewer.clientActiveArea.x+this.viewer.clientActiveArea.width===this.viewer.clientActiveArea.right&&(this.isWrapText=!1),this.addSplittedLineWidget(D,D.children.indexOf(e))),this.moveToNextLine(D),D.paragraph.bodyWidget.floatingElements.length>0&&U)return this.nextElementToLayout=e,void(this.hasFloatingElement=!0);e.width=this.getTabWidth(t,this.viewer,l,e.line,e),U&&(this.addElementToLine(t,e),i.i(n.isNullOrUndefined)(e.nextElement)&&this.viewer.clientActiveArea.width>0&&!e.line.isLastLine()&&this.moveElementFromNextLine(e.line))}else do{if(o=e.line,e.previousElement instanceof d.b&&2==e.previousElement.fieldType&&!i.i(n.isNullOrUndefined)(e.previousElement.fieldBeginInternal)&&e.previousElement.fieldBeginInternal.formFieldData instanceof d.n||this.splitTextForClientArea(o,e,e.text,e.trimEndWidth,e.characterFormat),this.checkLineWidgetWithClientArea(o,e),e instanceof d.D&&!this.isInitialLoad&&this.updateFieldText(e),e.line!==o&&!i.i(n.isNullOrUndefined)(this.nextElementToLayout)&&this.is2013Justification)return}while(e.line!==o&&this.cutClientWidth(e))}else do{o=e.line,this.splitElementForClientArea(t,e),this.checkLineWidgetWithClientArea(o,e),e instanceof d.D&&this.updateFieldText(e)}while(e.line!==o&&this.cutClientWidth(e));var M;if(!i.i(n.isNullOrUndefined)(e.nextNode)&&e.nextNode instanceof d.H&&(M=e.nextNode),("\v"===a||"\f"===a||"\r"===a||a===String.fromCharCode(14))&&!M){var V=o.children.indexOf(e);V>-1&&this.addSplittedLineWidget(o,V)}if(e.line.isLastLine()&&i.i(n.isNullOrUndefined)(e.nextElement)||"\v"===a||"\f"===a||"\r"===a||a===String.fromCharCode(14)){if(this.isXPositionUpdated)return void(this.isXPositionUpdated=!1);if(this.moveToNextLine(e.line),"\v"===a&&i.i(n.isNullOrUndefined)(e.nextNode))this.layoutEmptyLineWidget(t,!0,o,!0);else if(("\f"===a||a===String.fromCharCode(14))&&this.viewer instanceof h.b&&!(e.line.paragraph.containerWidget instanceof d.j)){var z=this.isRTLLayout;this.isRTLLayout=!1,i.i(n.isNullOrUndefined)(e.nextNode)||e.nextNode instanceof d.H?a===String.fromCharCode(14)?(this.moveToNextPage(this.viewer,e.line.nextLine,!1),this.layoutEmptyLineWidget(e.line.nextLine.paragraph,!1,e.line.nextLine,!0)):this.moveToNextPage(this.viewer,e.line,!0):i.i(n.isNullOrUndefined)(e.line.nextLine)||this.moveToNextPage(this.viewer,e.line.nextLine,!1),this.isRTLLayout=z}}this.isXPositionUpdated=!1}}},e.prototype.adjustPosition=function(e,t){var r=this.viewer.clientActiveArea,o=this.viewer.clientActiveArea.x,a=this.viewer.clientActiveArea.y,l=this.viewer.clientActiveArea.width,h=this.adjustClientAreaBasedOnTextWrap(e,new d.t(r.x,r.y,r.width,r.height));this.viewer.clientActiveArea.width=h.width;var c=this.viewer.clientActiveArea.x-o;if(e.line.isFirstLine()&&this.getFirstElement(e.line)===e&&c>0&&!this.isSkipFirstLineIndent){var p=e.line.paragraph.paragraphFormat.firstLineIndent;c+=s.a.convertPointToPixel(p>0?p:0)}if(this.isSkipFirstLineIndent=!1,e.padding.left=c>0?c:0,l!==this.viewer.clientActiveArea.width){var u=new s.d(this.viewer.clientActiveArea.x,this.viewer.clientActiveArea.width);this.updateWrapPosition(u)}if(0===this.viewer.clientActiveArea.width&&(this.isWrapText=!1),this.isYPositionUpdated){if(e.line.isFirstLine()){if(!i.i(n.isNullOrUndefined)(e.line.paragraph.associatedCell)){var g=e.line.paragraph.previousRenderedWidget;i.i(n.isNullOrUndefined)(g)?e.line.paragraph.associatedCell.height+=this.viewer.clientActiveArea.y-a:e.line.paragraph.associatedCell.height+=this.viewer.clientActiveArea.y-g.y+g.height}e.line.paragraph.y=this.viewer.clientActiveArea.y}else e.line.children[0]===e&&(e.line.marginTop+=this.viewer.clientActiveArea.y-a);e.line.paragraph.containerWidget instanceof d.x&&(e.line.paragraph.containerWidget.height+=this.viewer.clientActiveArea.y-a),e instanceof d.q||(this.isYPositionUpdated=!1)}},e.prototype.getFirstElement=function(e){for(var t=0;t<e.children.length;t++){var i=e.children[t];if(!(i instanceof d.v&&"Inline"!==i.textWrappingStyle))return i}},e.prototype.updateWrapPosition=function(e){for(var t=0;t<this.wrapPosition.length;t++){var i=this.wrapPosition[t];if(!(Math.abs(i.right-e.right)>1))return}this.wrapPosition.push(e)},e.prototype.isFirstitemInPage=function(e,t){return!e.line.paragraph.isInHeaderFooter&&Math.round(t)===this.viewer.clientArea.y},e.prototype.isTextFitBelow=function(e,t,i){return!1},e.prototype.isNeedToWrapForSquareTightAndThrough=function(e,t,i,n,r,o,s,a,l,h,c,p,u){return e.floatingElements.length>0&&i!==a&&n!==a&&"Inline"!==r&&"Behind"!==r&&"TopAndBottom"!==r&&"InFrontOfText"!==r&&(Math.round(c.y+u)>Math.round(o.y)||this.isTextFitBelow(o,c.y+u,l))&&Math.round(c.y)<Math.round(o.y+o.height)&&!(s&&(h||t instanceof d.r&&"Inline"!==t.textWrappingStyle&&t.allowOverlap))},e.prototype.isNeedToWrapForTopAndBottom=function(e,t,r,o,s,a,l,h,c,p,u,g,f){if(e.isInsideTable&&"TopAndBottom"===s&&!(c instanceof d.u)){var m=c.paragraph;if(!i.i(n.isNullOrUndefined)(m)&&!i.i(n.isNullOrUndefined)(m.associatedCell)){var v=m.isInsideTable,y=m.associatedCell,w=e.associatedCell;if(!i.i(n.isNullOrUndefined)(y)&&!i.i(n.isNullOrUndefined)(w)&&y!==w||!v&&"Word2013"!==this.documentHelper.compatibilityMode)return!1}}return r!==h&&o!==h&&"TopAndBottom"===s&&(u.y>=a.y&&u.y<a.bottom||(u.y+f>a.y||this.isTextFitBelow(a,u.y+f,c))&&u.y+f<a.bottom||u.y<a.y&&u.y+f>a.bottom&&a.height>0)&&!(l&&(p||t instanceof d.r&&"Inline"!==t.textWrappingStyle&&t.allowOverlap))},e.prototype.isNeedToWrapForSquareTightAndThroughForTable=function(e,t,i,n,r,o,s,a,l,d,h,c,p){return e.floatingElements.length>0&&i!==a&&n!==a&&"Inline"!==r&&"Behind"!==r&&"TopAndBottom"!==r&&"InFrontOfText"!==r&&(Math.round(h.y+p)>=Math.round(o.y)&&Math.round(h.y)<Math.round(o.bottom)||Math.round(h.y+p)<=Math.round(o.bottom)&&Math.round(h.y+p)>=Math.round(o.y))&&!(s&&d)},e.prototype.isNeedToWrapLeafWidget=function(e,t){return e.bodyWidget.floatingElements.length>0&&!0&&!(t instanceof d.v&&("InFrontOfText"===t.textWrappingStyle||"Behind"===t.textWrappingStyle))},e.prototype.getMinWidth=function(e,t,i,n){var r=e.text,o=r.split(" ");""!==r&&""===r.trim()&&e&&e.line.paragraph&&e.previousNode&&e.nextNode&&e.line.paragraph.isEmpty&&(o=[""]);var s=this.documentHelper.textHelper.measureText(o[0],e.characterFormat,e.scriptType).Width,a=this.getNextSibling(e);if(1===o.length&&a){var l=a.text;s+=this.getNextTextRangeWidth(a,l,t,i,n)}return s},e.prototype.getNextTextRangeWidth=function(e,t,i,n,r){for(var o=e,s=new d.t(0,0,0,0),a=this.isNextSibligSizeNeedToBeMeasure(s,e,r,i,n);a&&this.isLeafWidgetNextSiblingIsTextRange(o)&&i+s.width<r.width&&(o=this.getNextSibling(o),this.isNextSibligSizeNeedToBeMeasure(s,o,r,i,n));)t+=o.text;return s.width},e.prototype.isLeafWidgetNextSiblingIsTextRange=function(e){var t=this.getNextSibling(e);return!!(t&&t instanceof d.d)},e.prototype.isNextSibligSizeNeedToBeMeasure=function(e,t,i,n,r){var o=null,s=t;if(s){if(o=s.text,-1!==o.indexOf(" ")||-1!==o.indexOf("-")||-1!==o.indexOf("_")&&n+e.width+this.documentHelper.textHelper.measureText(o.split("-")[0],s.characterFormat,s.scriptType).Width<i.width||"\t"===s.text){var a=s.width;return o!==o.split(" ")[0]&&(a=this.documentHelper.textHelper.measureText(o.split(" ")[0],s.characterFormat,s.scriptType).Width),n+e.width+a>i.width&&o.indexOf("-")&&o!==o.split("-")[0]+"-"&&(a=this.documentHelper.textHelper.measureText(o.split("-")[0]+"-",s.characterFormat,s.scriptType).Width),e.width+=a,!1}if(s.text.length>0){var l=this.documentHelper.textHelper.measureText(s.text,s.characterFormat,s.scriptType);e.height+=l.Height,e.width+=l.Width}}return!0},e.prototype.isNeedDoIntermediateWrapping=function(e,t,i,n,r,o,s,a,l){return e>l&&((Math.round(i.width)<=Math.round(a)||i.width<n&&s.paragraph.isInsideTable)&&"Left"!==t&&"Largest"!==t||"Right"===t||i.width<e&&"Largest"===t)||(Math.round(o.x-r.x+r.leftIndent)<l||s instanceof d.d&&this.isFloatingItemOnLeft(i,a,o))&&("Left"!==t||e<l)},e.prototype.isFloatingItemOnLeft=function(e,t,i){return!1},e.prototype.getNextSibling=function(e){for(var t=e.nextNode,i=!1;t;){if(t instanceof d.b||t instanceof d.e||i||t instanceof d.q)t instanceof d.b&&(0===t.fieldType?i=!0:2===t.fieldType&&(i=!1));else if(t instanceof d.d)break;t=t.nextNode}return t},e.prototype.adjustClientAreaBasedOnTextWrap=function(e,t){var r=e.line.paragraph,o=r.bodyWidget,a=this.viewer,l=t.y,h=this.isFirstitemInPage(e,l);if(h&&l,h=i.i(n.isNullOrUndefined)(r.previousWidget),this.isNeedToWrapLeafWidget(r,e)){var c=a.clientArea;o.floatingElements.sort(function(e,t){return e.y-t.y}),o.floatingElements.sort(function(e,t){return e.x-t.x});for(var p=0;p<o.floatingElements.length;p++){var u=o.floatingElements[p],g=!1;if(g=u instanceof d.v?u.allowOverlap:u.positioning.allowOverlap,(!(r.isInsideTable&&u instanceof d.u)||u.isInsideTable)&&!(this.isRelayout&&!this.isRelayoutOverlap&&this.viewer.documentHelper.selection.isExistAfter(u instanceof d.u?u:u.line.paragraph,e.line.paragraph)||this.isRelayout&&this.isRelayoutOverlap&&this.viewer.documentHelper.selection.isExistAfter(u instanceof d.u?u:u.line.paragraph,this.endOverlapWidget))){var f=(u.x,0),m=0,v=0,y=0,w=0;u instanceof d.v?(f=u.distanceLeft,m=u.distanceTop,v=u.distanceRight,y=u.distanceBottom,w=u.width):(w=u.getTableCellWidth(),f=u.positioning.distanceLeft,m=u.positioning.distanceTop,v=u.positioning.distanceRight,y=u.positioning.distanceBottom);var b=new d.t(u.x-f,u.y-m,w+f+v,u.height+m+y),x=u instanceof d.u?"Square":u.textWrappingStyle,C=u instanceof d.u?"Both":u.textWrappingType,I=24;a.clientArea.y,u.height;if(!(c.x>b.right+I||c.right<b.x-I))if(this.isNeedToWrapForSquareTightAndThrough(o,e,-1,-1,x,b,g,1,u,!1,t,e.width,e.height)){var F=0,k=0,P=0,T=s.a.convertPointToPixel(e.paragraph.paragraphFormat.firstLineIndent),S=s.a.convertPointToPixel(r.paragraphFormat.leftIndent),W=s.a.convertPointToPixel(r.paragraphFormat.rightIndent);T=0===e.indexInOwner&&e.line.isFirstLine()&&T>0?T:0;var N=e instanceof d.d||e instanceof d.q?e:null,H=u instanceof d.u?u.containerWidget:u.line.paragraph.containerWidget,E=!1;if(e.line.paragraph){t.x>=b.x&&"Left"!==C&&(F=W),t.x<b.x&&"Right"!==C&&(k=S);var O=r.paragraphFormat.listFormat,_=this.getListLevel(O.list,O.listLevelNumber);t.x===c.x+S&&O&&O.baseStyle&&_&&0!==_.paragraphFormat.leftIndent&&(P=S,E=!0)}var B=0,L=!1,R=void 0,A=0,D=void 0;if(u instanceof d.u&&(R=u,D=u.positioning.horizontalAlignment,B=this.getMaximumRightCellBorderWidth(u),L=this.getDefaultBorderSpacingValue(B,L,D),A=u.tableFormat.borders.left.lineWidth/2),t.x+A>=b.x&&t.x<b.right&&"Left"!==C){t.width=t.width-(b.right-t.x)-F,this.isWrapText=!0;if(i.i(n.isNullOrUndefined)(R)||(I=this.getMinimumWidthRequiredForTable(L,D,B)),Math.round(t.width)<I||t.width<e.width&&"\t"===e.text||b.x<r.x+S){t.width=this.viewer.clientArea.right-b.right-(E?P:0);var U=0;if(U=i.i(n.isNullOrUndefined)(N)?e.width:this.getMinWidth(e,e.width,e.height,t),Math.round(t.width)<I||t.width<U){if(b.x-(r.x+r.leftIndent)>I&&this.viewer.clientArea.right-b.right>I)t.width=0;else{var M=0;this.isYPositionUpdated=!0,t.width=this.viewer.clientArea.width,t.height-=b.bottom+M-t.y,t.y=b.bottom+M}this.viewer.updateClientAreaForTextWrap(t),this.isWrapText=!1}else{var V=t.x;if(t.x=b.right+(E?P:0)+T,t.width-=T,"Square"===x&&t.width<0&&e.width>0){var M=0;this.isYPositionUpdated=!0,t.width=this.viewer.clientArea.width,t.height-=b.bottom+M-t.y,t.y=b.bottom+M,t.x=V}this.viewer.updateClientAreaForTextWrap(t)}}else{var V=t.x;if(t.x=b.right+(E?P:0)+T,t.width=this.viewer.clientArea.right-b.right-(E?P:0)-T,this.isSkipFirstLineIndent=!0,"Square"===x&&t.width<0&&e.width>0){var M=0;this.isYPositionUpdated=!0,t.width=this.viewer.clientArea.width,t.height-=b.bottom+M-t.y,t.y=b.bottom+M,t.x=V}this.isWrapText=!0,this.viewer.updateClientAreaForTextWrap(t)}}else if(b.x>=t.x&&t.right>b.x){t.width=b.x-t.x-F;var z=this.viewer.clientArea.right-b.right;z=z>0?z:0,this.isWrapText=!0;var j=!1,U=0;if(U=i.i(n.isNullOrUndefined)(N)?e.width:this.getMinWidth(N,e.width,e.height,t),i.i(n.isNullOrUndefined)(R)||(I=this.getMinimumWidthRequiredForTable(L,D,B)),this.isNeedDoIntermediateWrapping(z,C,t,e.width,e.paragraph,b,e,U,I)){if(t.width=z,this.isWrapText=!0,(t.x+U>b.x||"Right"===C||c.x>b.x-24)&&(t.x=b.right,t.width>U||"Right"===C?this.viewer.updateClientAreaForTextWrap(t):t.width<U&&e.line.children[0]!==e&&"Both"===C&&u instanceof d.v&&(this.viewer.updateClientAreaForTextWrap(t),j=!0)),t.width<I&&!(U<z&&"Tight"===x)||t.width<U&&Math.round(t.right)===Math.round(this.viewer.clientArea.right)&&"Both"===C){var q=b;if(Math.round(t.x)===Math.round(o.sectionFormat.leftMargin+r.paragraphFormat.leftIndent)){var M=0;t.y=q.bottom+M,this.isYPositionUpdated=!0,t.width=this.viewer.clientArea.width,t.height=t.height-(q.height+M),this.viewer.updateClientAreaForTextWrap(t),this.isWrapText=!1}else if(!j&&Math.round(t.right)>=Math.round(this.viewer.clientArea.right)&&"Both"===C){var M=0;t.y=q.bottom+M,t.width=this.viewer.clientArea.width,t.height=t.height-(q.height+M),t.x=this.viewer.clientArea.x+k,this.viewer.updateClientAreaForTextWrap(t),this.isYPositionUpdated=!0,this.isWrapText=!1}else t.width=0,this.viewer.updateClientAreaForTextWrap(t)}}else(e.line.isFirstLine()&&0===e.indexInOwner||0===z&&e.line.children[0]===e)&&"Square"===x&&Math.round(t.width)<=Math.round(U)&&r.containerWidget===H?(t.x=c.x,t.y=b.bottom,t.width=c.width,t.height-=b.bottom-t.y,this.isYPositionUpdated=!0):Math.round(t.width)<=Math.round(U)&&Math.round(t.x-k)!==Math.round(this.viewer.clientArea.x)&&(t.width=0),this.viewer.updateClientAreaForTextWrap(t)}"Both"!==C&&(this.isWrapText=!1)}else if(this.isNeedToWrapForTopAndBottom(r,e,-1,-1,x,b,g,1,u,!1,t,e.width,e.height)){var M=0,G=t.y;t.y=b.bottom+M,this.isYPositionUpdated=!0,t.height=t.height-(b.bottom-G+M),t.y!==l&&e instanceof d.d&&!(u instanceof d.u)&&e.line.isFirstLine()&&(t.y+=e.margin.top,l=t.y),this.viewer.updateClientAreaForTextWrap(t)}}}}return t},e.prototype.adjustClientAreaBasedOnTextWrapForTable=function(e,t){if(i.i(n.isNullOrUndefined)(e.containerWidget)||i.i(n.isNullOrUndefined)(e.bodyWidget))return t;var r=e.bodyWidget,o=this.viewer,s=t.y;if(i.i(n.isNullOrUndefined)(e.previousWidget),r.floatingElements.length>0){var a=o.clientActiveArea;r.floatingElements.sort(function(e,t){return e.y-t.y}),r.floatingElements.sort(function(e,t){return e.x-t.x});for(var l=0;l<r.floatingElements.length;l++){var h=r.floatingElements[l],c=!1;if(c=h instanceof d.v?h.allowOverlap:h.positioning.allowOverlap,(!(e.isInsideTable&&h instanceof d.u)||h.isInsideTable)&&!(h instanceof d.u&&h.wrapTextAround&&h.positioning.allowOverlap&&e.wrapTextAround&&e.positioning.allowOverlap)){var p=e.getTableCellWidth(),u=h instanceof d.v,g=u?h.distanceLeft:h.positioning.distanceLeft,f=u?h.distanceTop:h.positioning.distanceTop,m=u?h.distanceRight:h.positioning.distanceRight,v=u?h.distanceBottom:h.positioning.distanceBottom,y=u?h.width:h.getTableCellWidth(),w=new d.t(h.x-g,h.y-f,y+g+m,h.height+f+v),b=h instanceof d.u?"Square":h.textWrappingStyle,x=h instanceof d.u?"Both":h.textWrappingType,C=e.childWidgets.length>0?e.childWidgets[0].rowFormat.height:0,I=this.getNestedTable(e),F=I.firstChild.firstChild.firstChild.characterFormat,k=this.documentHelper.textHelper.measureText(" ",F);if(C<k.Height&&(C=k.Height),!(a.x>w.right+24||a.right<w.x-24)&&this.isNeedToWrapForSquareTightAndThroughForTable(r,e,-1,-1,b,w,c,1,h,!1,t,p,C)&&t.x>=w.x&&t.x<w.right&&"Left"!==x)if(t.width=t.width-(w.right-t.x),this.isWrapText=!0,Math.round(t.width)<24||t.width<p||w.x<e.x){t.width=this.viewer.clientArea.right-w.right;var P=p;if(Math.round(t.width)<24||t.width<P){if(w.x-e.x>24&&this.viewer.clientArea.right-w.right>24)t.width=0;else{var T=0;this.isYPositionUpdated=!0,t.width=this.viewer.clientArea.width,t.height-=w.bottom+T-t.y,t.y=w.bottom+T}this.viewer.updateClientAreaForTextWrap(t),this.isWrapText=!1}else{var S=t.x;t.x=w.right,"Square"===b&&t.width<0&&p>0&&(this.isYPositionUpdated=!0,t.height-=w.bottom+0-t.y,t.width=this.viewer.clientArea.width,t.y=w.bottom+0,t.x=S),this.viewer.updateClientAreaForTextWrap(t)}}else{var S=t.x;if(t.x=w.right+e.firstChild.firstChild.leftMargin,t.width=this.viewer.clientArea.right-w.right,"Square"===b&&t.width<0&&p>0){var T=0;this.isYPositionUpdated=!0,t.width=this.viewer.clientArea.width,t.height-=w.bottom+T-t.y,t.y=w.bottom+T,t.x=S}this.viewer.updateClientAreaForTextWrap(t)}}}}return t},e.prototype.getNestedTable=function(e){for(var t=e;t.firstChild.firstChild.firstChild instanceof d.u;)t=t.firstChild.firstChild.firstChild;return t},e.prototype.startAt=function(e,t){return"Footnote"===e.footnoteType?(this.startat=e.paragraph.bodyWidget.sectionFormat.initialFootNoteNumber,t=this.getFootEndNote(e.paragraph.bodyWidget.sectionFormat.footNoteNumberFormat,this.documentHelper.footnoteCollection.indexOf(e)+this.startat)):(this.startat=e.paragraph.bodyWidget.sectionFormat.initialEndNoteNumber,t=this.getFootEndNote(e.paragraph.bodyWidget.sectionFormat.endnoteNumberFormat,this.documentHelper.endnoteCollection.indexOf(e)+this.startat)),t},e.prototype.layoutFootEndNoteElement=function(e){this.isFootnoteContentChanged=!0;var t,r=!1,o=this.documentHelper.footnoteCollection.indexOf(e),s=1;this.islayoutFootnote=!0;var l,h=new d.t(this.viewer.clientArea.x,this.viewer.clientArea.y,this.viewer.clientArea.width,this.viewer.clientArea.height),c=new d.t(this.viewer.clientActiveArea.x,this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.width,this.viewer.clientActiveArea.height),p=e.paragraph.bodyWidget,u=!1,g=0;if(p.page.footnoteWidget)for(var f=0;f<p.page.footnoteWidget.bodyWidgets.length;f++){s=p.page.footnoteWidget.bodyWidgets.length;var m=this.documentHelper.footnoteCollection.indexOf(p.page.footnoteWidget.bodyWidgets[f].footNoteReference);if(m>o&&m-o==1){s=f,r=!0;break}}if(e.isLayout=!0,"Footnote"===e.footnoteType){if(p.page.footnoteWidget&&p.page.footnoteWidget instanceof d.a)t=p.page.footnoteWidget;else{u=!0,t=new d.a,t.footNoteType="Footnote",t.page=p.page;var v=new d.g;v.characterFormat=new a.c,v.paragraphFormat=new a.a,v.index=0;var y=new d.p(v);v.childWidgets.push(y),g=this.documentHelper.textHelper.getParagraphMarkSize(v.characterFormat).Height,t.margin=new d.E(0,g,0,0)}this.isFootNoteLayoutStart=!0,u&&(p.page.footnoteWidget=t);var w=e.bodyWidget;this.viewer.updateClientArea(t,t.page),this.viewer.clientArea.y=h.y,this.viewer.clientActiveArea.y=c.y;for(var b=0;b<e.bodyWidget.childWidgets.length;b++){var x=e.bodyWidget.childWidgets[b];x.containerWidget=w,w.page=p.page,w.sectionFormat=t.sectionFormat,x.containerWidget.containerWidget=t,this.viewer.updateClientAreaForBlock(x,!0),x instanceof d.u&&this.clearTableWidget(x,!0,!0),this.layoutBlock(x,0),g+=x.height,x.y=0,this.viewer.updateClientAreaForBlock(x,!1),w.height+=x.height}if(t.sectionFormat.columns.length>1&&!(0===t.bodyWidgets.length&&w.childWidgets.length<=1&&w.childWidgets[0].childWidgets.length<=1)&&(g/=t.sectionFormat.numberOfColumns),this.isFootNoteLayoutStart=!1,l=!1,g>=c.height&&(this.isfootMove=!0),r?t.bodyWidgets.splice(s,0,w):t.bodyWidgets.push(w),e.line.paragraph.isInsideTable){var C=this.getParentTable(e.line.paragraph.associatedCell.ownerTable);i.i(n.isNullOrUndefined)(C.footnoteElement)&&(C.footnoteElement=[]),-1==C.footnoteElement.indexOf(e)&&(C.footnoteElement.push(e),this.layoutedFootnoteElement.push(e))}t.height+=g,l=!0,this.viewer.clientActiveArea=c,this.viewer.clientActiveArea.height-=g,this.footnoteHeight+=g,this.viewer.clientArea=h}return l},e.prototype.layoutEndNoteElement=function(){var e=this.documentHelper.pages.length;if(this.documentHelper.endnoteCollection.length>0){var t=void 0,i=void 0,n=void 0,r=this.documentHelper.pages[e-1],o=r.bodyWidgets[0],s=r.bodyWidgets[r.bodyWidgets.length-1];if(this.viewer instanceof h.b&&s.sectionFormat.numberOfColumns>1){var a=this.getBodyWidget(s,!0);this.splitBodyWidgetBasedOnColumn(a)}for(var l=0;l<this.documentHelper.endnoteCollection.length;l++){t=this.documentHelper.endnoteCollection[l],o.page.endnoteWidget instanceof d.a&&"Endnote"===o.page.endnoteWidget.footNoteType?i=o.page.endnoteWidget:(n=!0,i=new d.a,i.footNoteType="Endnote",i.page=o.page);var c=t.bodyWidget;c.page=i.page;for(var p=0;p<t.bodyWidget.childWidgets.length;p++){var u=t.bodyWidget.childWidgets[p];u.containerWidget=c,u.containerWidget.containerWidget=i}-1===i.bodyWidgets.indexOf(c)&&(i.bodyWidgets.push(c),c.sectionFormat=i.page.bodyWidgets[i.page.bodyWidgets.length-1].sectionFormat),n&&(o.page.endnoteWidget=i)}this.layoutfootNote(i)}},e.prototype.hasValidElement=function(e){var t=e.firstChild;if(t&&!i.i(n.isNullOrUndefined)(this.documentHelper.selection))for(var r=t.children[0];r;){if(r instanceof d.b&&(r=this.documentHelper.selection.getNextValidElementForField(r),!i.i(n.isNullOrUndefined)(r)&&!r.line.paragraph.equals(e)))return!1;if(r instanceof d.d||r instanceof d.r)return!0;i.i(n.isNullOrUndefined)(r)||(r=r.nextNode)}return!1},e.prototype.updateFieldText=function(e){var t=this.documentHelper.getFieldResult(e.fieldBegin,e.paragraph.bodyWidget.page);""!==t&&(e.text=t,this.documentHelper.textHelper.getTextSize(e,e.characterFormat))},e.prototype.checkLineWidgetWithClientArea=function(e,t){if(e!==t.line||t.line===e&&i.i(n.isNullOrUndefined)(t.nextElement)&&!t.line.isLastLine()){if(this.moveToNextLine(e),"Word2013"!==this.documentHelper.compatibilityMode&&this.isOverlapFloatTable){var r=void 0;t.line.paragraph.previousRenderedWidget instanceof d.u&&t.line.paragraph.previousRenderedWidget.wrapTextAround&&(r=t.line.paragraph.previousRenderedWidget,this.viewer.clientActiveArea.x=this.viewer.clientActiveArea.x-s.a.convertPointToPixel(r.firstChild.firstChild.leftMargin)),this.viewer.clientActiveArea.x+=e.paragraph.leftIndent,this.isOverlapFloatTable=!1}e!==t.line&&(this.isRTLLayout=!1)}t.line!==e&&this.viewer instanceof h.b&&this.viewer.clientActiveArea.height<t.height&&this.viewer.clientActiveArea.y!==this.viewer.clientArea.y?this.moveToNextPage(this.viewer,t.line):t.line===e&&i.i(n.isNullOrUndefined)(t.nextElement)&&e.paragraph.lastChild===e&&!e.isLastLine()&&this.viewer.clientActiveArea.height>=0&&this.moveFromNextPage(e)},e.prototype.checkAndSplitTabOrLineBreakCharacter=function(e,t){var i=["\t","\v","\f"],n=s.a.indexOfAny(e,i);if(n>-1){var r=e[n];("\t"===r&&"\t"!==e||"\v"===r&&"\v"!==e||"\f"===r&&"\f"!==e)&&this.splitByLineBreakOrTab(this.viewer,t,n,r)}},e.prototype.moveFromNextPage=function(e){var t=e.nextLine;if(t&&-1===e.paragraph.childWidgets.indexOf(t)){var i=t.paragraph;t.paragraph.childWidgets.splice(t.indexInOwner,1),e.paragraph.childWidgets.push(t),t.paragraph=e.paragraph,0===i.childWidgets.length&&i.destroy()}},e.prototype.cutClientWidth=function(e){if(this.is2013Justification)return!1;this.clearLineMeasures();var t=e.line;t.marginTop=0;for(var r=0,o=0;o<t.children.length;o++){var s=t.children[o];if(r+=s.width,e===s)break}var a=this.viewer.clientActiveArea.width-r<0,l=e.line.paragraph,h=l.bodyWidget;return h&&h.floatingElements.length>0?(this.hasFloatingElement=!0,this.isXPositionUpdated=!0,!1):(a?e.previousElement&&this.cutClientWidth(e.previousElement):(this.viewer.cutFromLeft(this.viewer.clientActiveArea.x+r),"Justify"===e.line.paragraph.paragraphFormat.textAlignment&&e instanceof d.d&&this.splitTextElementWordByWord(e),i.i(n.isNullOrUndefined)(e.nextElement)&&this.viewer.clientActiveArea.width>0&&!e.line.isLastLine()&&this.moveElementFromNextLine(t)),a)},e.prototype.layoutFieldCharacters=function(e){if(0===e.fieldType){if(!i.i(n.isNullOrUndefined)(e.formFieldData)&&this.isInitialLoad&&this.checkAndUpdateFieldData(e),!this.isFieldCode&&(!i.i(n.isNullOrUndefined)(e.fieldEnd)||e.hasFieldEnd)){if(-1===this.documentHelper.fieldStacks.indexOf(e)&&this.documentHelper.fieldStacks.push(e),this.isRelayout){var t=s.a.trimEnd(this.documentHelper.selection.getFieldCode(e));this.isIFfield=s.a.startsWith(t,"IF")}this.isFieldCode=!0,e.hasFieldEnd=!0}}else if(this.documentHelper.fieldStacks.length>0)if(2===e.fieldType){var r=this.documentHelper.fieldStacks[this.documentHelper.fieldStacks.length-1];r.fieldSeparator!==e||i.i(n.isNullOrUndefined)(r.fieldEnd)&&!r.hasFieldEnd||(this.isFieldCode=!1)}else{var r=this.documentHelper.fieldStacks[this.documentHelper.fieldStacks.length-1];e===r.fieldEnd&&(this.documentHelper.fieldStacks.pop(),this.isFieldCode=!1,this.isIFfield=!1)}},e.prototype.checkAndUpdateFieldData=function(e){if(e.hasFieldEnd&&!i.i(n.isNullOrUndefined)(e.fieldEnd)){if(i.i(n.isNullOrUndefined)(e.fieldSeparator)){var t=new d.b(2);t.fieldBegin=e,t.fieldEnd=e.fieldEnd,t.line=e.line,e.line.children.splice(e.fieldEnd.indexInOwner,0,t),e.fieldSeparator=t,e.fieldEnd.fieldSeparator=t}var r=e.fieldEnd.previousNode;if(r instanceof d.b&&2===r.fieldType){var o=e.formFieldData;if(o instanceof d.m){var s=new d.d;s.line=e.line;var a=e.line.children.indexOf(e.fieldEnd);e.line.children.splice(a,0,s),s.characterFormat.copyFormat(e.characterFormat),o.checked?s.text=String.fromCharCode(9745):s.text=String.fromCharCode(9744),"Auto"!==o.sizeType?s.characterFormat.fontSize=1.35*o.size:s.characterFormat.fontSize=1.35*s.characterFormat.fontSize}else if(o instanceof d.n){var l=new d.d;l.characterFormat.copyFormat(e.characterFormat),l.line=e.line,o.dropdownItems.length>0?l.text=o.dropdownItems[o.selectedIndex]:l.text=this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5);var a=e.line.children.indexOf(e.fieldEnd);e.line.children.splice(a,0,l)}}}},e.prototype.layoutEmptyLineWidget=function(e,t,r,o){this.clearLineMeasures();var a=e.paragraphFormat,l=0,c=0;o=!i.i(n.isNullOrUndefined)(o)&&o;var p,u=a.borders,g=this.documentHelper.canRenderBorder(e),f=this.documentHelper.textHelper.getParagraphMarkSize(e.characterFormat),m=f.Height,v=this.getBeforeSpacing(e);if(e.childWidgets.length>0&&!o){if(this.isUpdateMarginForCurrentLine(r),p=e.childWidgets[0],p.children.length>0){(a.bidi||this.isContainsRtl(p))&&this.shiftElementsForRTLLayouting(p,a.bidi);var y=p.isFirstLine(),w=p.isLastLine(),b=0;y&&(v=this.getBeforeSpacing(e),b=s.a.convertPointToPixel(a.firstLineIndent));var x=a.textAlignment;if("Left"!==x&&this.viewer.textWrap&&("Justify"!==x||!w||"Justify"===x&&a.bidi)){var C=this.getSubWidth(p,"Justify"===x,c,b,w);l=C[0].subWidth,c=C[0].spaceCount}}}else p=t?this.addLineWidget(e):r;if(!(i.i(n.isNullOrUndefined)(e.containerWidget)||!(e.bodyWidget.floatingElements.length>0)||e.containerWidget instanceof d.i||e.containerWidget instanceof d.j&&e.containerWidget.ownerTable.containerWidget instanceof d.i)){var I=new d.d;I.line=p,p.children.push(I),I.text="",I.characterFormat=e.characterFormat,I.width=this.documentHelper.textHelper.getTextSize(I,I.characterFormat),this.adjustPosition(I,e.bodyWidget),e.x+=I.padding.left,t&&this.checkInbetweenShapeOverlap(p),p.children.splice(I.indexInOwner,1)}!(this.viewer instanceof h.b&&this.viewer.clientActiveArea.height<v+m&&this.viewer.clientActiveArea.y!==this.viewer.clientArea.y)||p.isFirstLine()&&i.i(n.isNullOrUndefined)(p.paragraph.previousWidget)||e.isSectionBreak||this.moveToNextPage(this.viewer,p);var F=this.getLineSpacing(e,m);!isNaN(this.maxTextHeight)&&m<this.maxTextHeight&&(m=this.maxTextHeight);var k=0,P=0,T=0,S=m,W=e.paragraphFormat.lineSpacingType;"Multiple"===W?F>m?P+=F-m:k+=F-m:"Exactly"===W?k+=F-(k+S+P):F>k+S+P&&(k+=F-(k+S+P)),k+=v,P+=s.a.convertPointToPixel(this.getAfterSpacing(e)),"None"!=u.top.lineStyle&&p.isFirstLine()&&!g.skipTopBorder&&(k+=s.a.convertPointToPixel(u.top.lineWidth+u.top.space)),"None"!=u.bottom.lineStyle&&p.isLastLine()&&!g.skipBottomBorder&&(P+=s.a.convertPointToPixel(u.bottom.lineWidth+u.bottom.space));for(var N=p.renderedElements,H=0;H<N.length;H++){var E=N[H];if(0===H&&E instanceof d.q||e.paragraphFormat.bidi&&N[N.length-1]instanceof d.q){var x=e.paragraphFormat.textAlignment;"Right"===x?T=l:"Center"===x&&(T=l/2),E.margin=new d.E(T,k,0,P),E.line=p,p.height=k+S+P;break}}p.margin=new d.E(0,k,0,P),p.height=k+S+P,this.adjustPositionBasedOnTopAndBottom(p),i.i(n.isNullOrUndefined)(e.nextRenderedWidget)&&e.isInsideTable&&e.previousRenderedWidget instanceof d.u&&1==e.childWidgets.length&&(p.height=0),this.viewer.cutFromTop(this.viewer.clientActiveArea.y+p.height),this.wrapPosition=[]},e.prototype.isUpdateMarginForCurrentLine=function(e){var t=!0;if(!i.i(n.isNullOrUndefined)(e)&&!e.isFirstLine()){for(var r=0;r<e.children.length;r++)if(!(e.children[r]instanceof d.G||e.children[r]instanceof d.F)){t=!1;break}t&&(e.margin=new d.E(0,0,0,0))}},e.prototype.adjustPositionBasedOnTopAndBottom=function(e){!i.i(n.isNullOrUndefined)(e.paragraph.bodyWidget)&&!i.i(n.isNullOrUndefined)(e.paragraph.bodyWidget.page.headerWidget)&&e.paragraph.bodyWidget.page.headerWidget.floatingElements.length>0&&e.paragraph===e.paragraph.bodyWidget.childWidgets[0]&&0===e.indexInOwner&&this.checkInbetweenShapeOverlap(e,e.paragraph.bodyWidget.page.headerWidget.floatingElements)},e.prototype.layoutListItems=function(e,t){this.isFieldCode||(!i.i(n.isNullOrUndefined)(e.paragraphFormat)&&!i.i(n.isNullOrUndefined)(e.paragraphFormat.listFormat)&&!i.i(n.isNullOrUndefined)(this.documentHelper.getListById(e.paragraphFormat.listFormat.listId))&&e.paragraphFormat.listFormat.listLevelNumber>=0&&e.paragraphFormat.listFormat.listLevelNumber<9&&!t?(this.clearListElementBox(e),this.layoutList(e,this.documentHelper)):e.paragraphFormat.listFormat&&-1===e.paragraphFormat.listFormat.listId&&this.clearListElementBox(e))},e.prototype.layoutList=function(e,t){var r=t.getListById(e.paragraphFormat.listFormat.listId),o=e.paragraphFormat.listFormat.listLevelNumber,a=this.getListLevel(r,o);if(!i.i(n.isNullOrUndefined)(a)&&!i.i(n.isNullOrUndefined)(a.numberFormat)){var l=e.childWidgets[0];i.i(n.isNullOrUndefined)(l)&&(l=new d.p(e),e.childWidgets.push(l));var c=new d.q(a,!1);if(c.line=l,"Bullet"===a.listLevelPattern?(c.text=a.numberFormat,this.updateListValues(r,o)):c.text=this.getListNumber(e.paragraphFormat.listFormat),""!==a.numberFormat){if(this.viewer.updateClientWidth(-s.a.convertPointToPixel(e.paragraphFormat.firstLineIndent)),this.documentHelper.isIosDevice){var p=c.text;p=p===String.fromCharCode(61623)?String.fromCharCode(9679):p===String.fromCharCode(61551)+String.fromCharCode(32)?String.fromCharCode(9675):p,p!==c.text&&(c.text=p)}t.textHelper.updateTextSize(c,e);var u;this.viewer instanceof h.b&&this.viewer.clientActiveArea.height<c.height&&this.viewer.clientActiveArea.y!==this.viewer.clientArea.y&&(u=!0),this.viewer.cutFromLeft(this.viewer.clientActiveArea.x+c.width);var g=c;if(l.children.splice(0,0,c),"None"!==a.followCharacter){if(c=new d.q(a,!0),"Tab"===a.followCharacter){c.text="\t";var f=l.children.indexOf(c),m=this.getTabWidth(e,this.viewer,f,l,c);t.textHelper.updateTextSize(c,e),c.width=m}else c.text=" ",t.textHelper.updateTextSize(c,e);this.viewer.cutFromLeft(this.viewer.clientActiveArea.x+c.width),l.children.splice(1,0,c),c.line=l}if(i.i(n.isNullOrUndefined)(e.containerWidget)||!(e.bodyWidget.floatingElements.length>0)||g instanceof d.s||e.containerWidget instanceof d.i||(this.adjustPosition(g,g.line.paragraph.bodyWidget),this.isYPositionUpdated&&(this.viewer.clientActiveArea.width>g.width+c.width&&(this.viewer.clientActiveArea.width-=g.width+c.width),this.isYPositionUpdated=!1)),u)return this.moveToNextPage(this.viewer,l,void 0,!0),this.cutClientWidth(c),this.hasFloatingElement=!1,void(this.isXPositionUpdated=!1);"None"!==a.followCharacter&&this.viewer.updateClientWidth(s.a.convertPointToPixel(e.paragraphFormat.firstLineIndent))}}},e.prototype.addBodyWidget=function(e,t){var i;return i=t||new d.o,i.width=e.width,i.x=e.x,i.y=e.y,i},e.prototype.addListLevels=function(e){for(var t=e.levels.length;t<9;t++){var i=new l.a(e),n=t%3;"Bullet"===e.levels[0].listLevelPattern?(i.listLevelPattern="Bullet",i.numberFormat=0===n?String.fromCharCode(61623):1===n?String.fromCharCode(61551)+String.fromCharCode(32):String.fromCharCode(61607),i.characterFormat.fontFamily=i.numberFormat===String.fromCharCode(61607)?"Wingdings":"Symbol"):(i.listLevelPattern=this.getListLevelPattern(n),i.numberFormat="%"+(t+1).toString()+".",i.startAt=1,i.restartLevel=t),i.paragraphFormat=new a.a(void 0),i.paragraphFormat.leftIndent=48*(t+1),i.paragraphFormat.firstLineIndent=-24,e.levels.push(i)}},e.prototype.addSplittedLineWidget=function(e,t,r){var o=t;if(this.isWrapText)return void(i.i(n.isNullOrUndefined)(r)||(e.children.splice(o+1,0,r),r.line=e));var s=!1,a=e.paragraph,l=[],h=a.childWidgets.indexOf(e);i.i(n.isNullOrUndefined)(r)||l.push(r);var c=void 0,p=e.children[o];p instanceof d.B&&0===p.commentType&&0!=o?o-=1:p.isColumnBreak&&i.i(n.isNullOrUndefined)(p.nextNode)&&(s=!0);for(var u=o+1;u<e.children.length;u++)l.push(e.children[u]);if(l.length>0||s){c=h===a.childWidgets.length-1?new d.p(a):a.childWidgets[h+1];for(var g=0;g<l.length;g++)l[g].line=c;l.length>0&&(e.children.splice(o+1,e.children.length-1),!i.i(n.isNullOrUndefined)(e.layoutedElements)&&e.layoutedElements.length>0&&e.layoutedElements.splice(o+1,e.layoutedElements.length-1),c.children=l.concat(c.children)),-1===a.childWidgets.indexOf(c)&&a.childWidgets.splice(h+1,0,c)}},e.prototype.addElementToLine=function(e,t){t instanceof d.v&&"Inline"!==t.textWrappingStyle||(this.isWrapText&&(this.isWrapText=!1,this.viewer.clientActiveArea.width=this.viewer.clientArea.right-this.viewer.clientActiveArea.x),this.viewer.cutFromLeft(this.viewer.clientActiveArea.x+t.width)),"Justify"===e.paragraphFormat.textAlignment&&t instanceof d.d&&this.splitTextElementWordByWord(t),t instanceof d.r&&(t.line.skipClipImage=!t.isInlineImage)},e.prototype.splitElementForClientArea=function(e,t){if(t.line.children.length>0){var i=t.previousElement,n=t.indexInOwner;t.line.children.length>1&&i&&this.viewer.clientActiveArea.x!==this.viewer.clientArea.x&&(n-=1),this.addSplittedLineWidget(t.line,n)}},e.prototype.splitByWord=function(e,t,i,n,r,a){var l=this.getSplitIndexByWord(this.viewer.clientActiveArea.width,n,r,a,i.scriptType);if(l>0&&l<i.length){var h=e.children.indexOf(i),c=new d.d;if(n=n.substring(l),c.text=n," "===n[0]){var p=n.length;n=s.a.trimStart(n),l+=p-n.length}if(c.characterFormat.copyFormat(i.characterFormat),c.width=this.documentHelper.textHelper.getWidth(c.text,a,c.scriptType),c.trimEndWidth=c.width,c.characterRange=i.characterRange,i.text=i.text.substr(0,l)," "!==i.text&&s.a.endsWith(i.text)&&a.bidi&&i.characterRange===o.b.RightToLeft&&!this.isWrapText){var u=this.spitTextElementByWhitespace(i,a);h=e.children.indexOf(u)}i.width=this.documentHelper.textHelper.getWidth(i.text,i.characterFormat,i.scriptType),i.trimEndWidth=this.documentHelper.textHelper.getWidth(s.a.trimEnd(i.text),i.characterFormat,i.scriptType),i.revisions.length>0&&(this.updateRevisionForSplittedElement(i,c,!0),c.isMarkedForRevision=i.isMarkedForRevision),c.height=i.height,c.baselineOffset=i.baselineOffset,this.splitErrorCollection(i,c),this.addSplittedLineWidget(e,h,c),this.addElementToLine(t,i),0===i.width&&e.children.splice(h,1)}},e.prototype.spitTextElementByWhitespace=function(e,t){var i=e.line,n=i.children.indexOf(e),r=e.text,s=new d.d,a=r.length-1;return e.text=r.substring(0,a),s.text=r.substring(a),s.characterFormat.copyFormat(e.characterFormat),s.line=i,s.characterRange=o.b.WordSplit,s.scriptType=o.a.English,s.height=e.height,s.baselineOffset=e.baselineOffset,s.width=this.documentHelper.textHelper.getWidth(s.text,t,s.scriptType),i.children.splice(n+1,0,s),e.revisions.length>0&&(this.updateRevisionForSplittedElement(e,s,a>0,!0),s.isMarkedForRevision=e.isMarkedForRevision),s},e.prototype.splitErrorCollection=function(e,t){if(e.errorCollection.length>0){for(var i=[],n=e.ignoreOnceItems,r=0;r<e.errorCollection.length;r++)i.push(e.errorCollection[r]);for(var o=0;o<e.errorCollection.length;o++){var s=e.text.indexOf(e.errorCollection[o].text),a=e.errorCollection[o];s<0?(i.splice(0,1),t.errorCollection.push(a)):t.text.indexOf(a.text)>0&&t.errorCollection.push(a)}t.ignoreOnceItems=n,e.ignoreOnceItems=[],e.errorCollection=i}},e.prototype.splitByCharacter=function(e,t,r,o,s){var a=e.paragraph,l="AtLeast"===a.paragraphFormat.lineSpacingType?a.paragraphFormat.afterSpacing:0,h=this.getTextSplitIndexByCharacter(this.viewer.clientArea.width,this.viewer.clientActiveArea.width,r,o,s,t.scriptType);if(!(0===h&&t.previousNode instanceof d.r&&"Right"===t.previousNode.textWrappingType)){0===h&&!i.i(n.isNullOrUndefined)(t)&&t.length>0&&Math.max(t.height,l)<=this.viewer.clientArea.height&&0===this.viewer.clientActiveArea.width&&0===e.children.indexOf(t)&&(h=1);var c=0;if(h<t.length&&(c=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(r.substring(0,h),s,t.scriptType),r=r.substring(h)),c>this.viewer.clientActiveArea.width&&t.indexInOwner>0)return void this.addSplittedLineWidget(e,t.indexInOwner-1);var p=e.children.indexOf(t);if(h<t.length){var u=new d.d;u.text=r,u.errorCollection=t.errorCollection,t.text=t.text.substr(0,h),u.characterFormat.copyFormat(t.characterFormat),u.width=this.documentHelper.textHelper.getWidth(u.text,s,u.scriptType),u.trimEndWidth=u.width,u.characterRange=t.characterRange,t.width=this.documentHelper.textHelper.getWidth(t.text,s,t.scriptType),t.trimEndWidth=t.width,u.height=t.height,u.baselineOffset=t.baselineOffset,e.children.splice(t.indexInOwner+1,0,u),t.revisions.length>0&&(this.updateRevisionForSplittedElement(t,u,h>0),u.isMarkedForRevision=t.isMarkedForRevision),this.addElementToLine(a,t),this.addSplittedLineWidget(e,p),0===t.width&&e.children.splice(p,1)}else this.addSplittedLineWidget(e,p),this.addElementToLine(a,t)}},e.prototype.updateRevisionForSplittedElement=function(e,t,i,n){if(e.revisions.length>0)for(var r=0;r<e.revisions.length;r++){var o=e.revisions[r];if(i){t.revisions.push(o);var s=o.range.indexOf(e);s<0?o.range.push(t):n?o.range.splice(s,0,t):o.range.splice(s+1,0,t)}else{var s=o.range.indexOf(e);o.range.splice(s,1),o.range.splice(s,0,t),t.revisions.push(o)}}},e.prototype.splitTextElementWordByWord=function(e){var t=e.line,i=t.children.indexOf(e),n=i,r=e.padding.left;e.padding.left=0;var a,l=e.text;if(l.trim().indexOf(" ")>=0){t.children.splice(i,1),a=e.characterFormat;for(var h=e.length-s.a.trimStart(l).length;h<e.length&&0!==(h=this.getTextIndexAfterSpace(l,h))&&h!==e.length;)if(h<e.length){var c=new d.d,p=l.substring(0,h);if(l=l.substring(h)," "===l.substring(0,1)&&(h+=l.length-s.a.trimStart(l).length),c.text=p,c.characterFormat.copyFormat(e.characterFormat),c.line=t,c.height=e.height,c.baselineOffset=e.baselineOffset,c.characterRange=e.characterRange,t.children.splice(i,0,c),e.revisions.length>0&&(this.updateRevisionForSplittedElement(e,c,h>0,!0),c.isMarkedForRevision=e.isMarkedForRevision)," "!==c.text&&s.a.endsWith(c.text)&&a.bidi&&c.characterRange===o.b.RightToLeft){var u=this.spitTextElementByWhitespace(c,a);i=t.children.indexOf(u)}c.width=this.documentHelper.textHelper.getWidth(c.text,a,c.scriptType),c.trimEndWidth=c.width,e.text=l,e.width=this.documentHelper.textHelper.getWidth(e.text,e.characterFormat,e.scriptType),e.trimEndWidth=e.width,0===e.width&&-1!==t.children.indexOf(e)&&t.children.splice(t.children.indexOf(e),1),h=0,i++}e.text=l,t.children.splice(i,0,e)}t.children[n].padding.left=r},e.prototype.isSplitByHyphen=function(e,t){if(!i.i(n.isNullOrUndefined)(e.previousElement)&&(e.previousElement instanceof d.d||e.previousElement instanceof d.q)){var r=e.previousElement.text;return"-"===t.substring(0,1)&&" "!==r.substring(r.length-1,r.length)}return"-"===t.substring(0,1)},e.prototype.splitTextForClientArea=function(e,t,i,n,r){var o=e.paragraph,a=!0,l=-1;if(" "===i.substring(0,1)||this.isSplitByHyphen(t,i))l=1;else{var d=n,h=0;if(h=s.a.trimEnd(i).indexOf(" ")+1,0==h&&(h=s.a.trimEnd(i).indexOf("-")+1),l=h,l>0&&(d=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(i.slice(0,l),r,t.scriptType)),this.viewer.clientActiveArea.width<d&&!this.documentHelper.textHelper.isUnicodeText(i,t.scriptType)&&!this.isWordFittedByJustification(t,d)&&(a=this.checkPreviousElement(e,e.children.indexOf(t))))return}n<=this.viewer.clientActiveArea.width?this.addElementToLine(o,t):a&&(l>0||-1!==i.indexOf(" ")||-1!==i.indexOf("-"))?this.splitByWord(e,o,t,i,n,r):this.splitByCharacter(e,t,i,n,r)},e.prototype.splitByLineBreakOrTab=function(e,t,i,n){var r=t.line.children.indexOf(t),o=t.text,s=o.substring(i),a="\t"===n?new d.I:new d.d;if(a.line=t.line,this.updateRevisionForSplittedElement(t,a,!0),a.characterFormat.copyFormat(t.characterFormat),a.characterRange=t.characterRange,t.line.children.splice(r+1,0,a),i>0&&1===s.length)a.text=o.substring(i),t.text=o.substring(0,i);else if(i>0){a.text=n;var l=new d.d;l.line=t.line,l.text=o.substring(i+1),this.updateRevisionForSplittedElement(t,l,!0),l.characterFormat.copyFormat(t.characterFormat),l.characterRange=t.characterRange,t.line.children.splice(r+2,0,l),t.text=o.substring(0,i)}else""!==s&&(a.text=o.substring(i+1),t.text=n)},e.prototype.moveToNextLine=function(e,t,r){var o=e.paragraph,a=o.paragraphFormat,l=e.isFirstLine(),h=e.isLastLine(),c=0,p=0,u=0,g=0,f=0,m=0,v=a.borders;this.updateLineWidget(e),c=this.maxTextHeight,p=c-this.maxTextBaseline;var y=0,w=!1,b=this.documentHelper.canRenderBorder(o);if(!o.bodyWidget||o.bodyWidget instanceof d.x||(y=this.documentHelper.pages.indexOf(o.bodyWidget.page)),l&&(g=this.getBeforeSpacing(o,y),m=s.a.convertPointToPixel(a.firstLineIndent)),h&&(u=s.a.convertPointToPixel(this.getAfterSpacing(o))),(a.bidi||this.isContainsRtl(e))&&(this.shiftElementsForRTLLayouting(e,a.bidi),this.isRTLLayout=!0),isNaN(this.maxTextHeight)){var x=this.documentHelper.textHelper.measureText("a",o.characterFormat);c=x.Height,p=c-x.BaselineOffset}else c=this.maxTextHeight,p=c-this.maxTextBaseline;f=this.getLineSpacing(o,c),"Exactly"===a.lineSpacingType&&f<p+this.maxBaseline&&(f=p+this.maxBaseline);var C,I=0,F=0,k=a.textAlignment,P=0,T=0;if("Left"!==k&&this.viewer.textWrap&&("Justify"!==k||!h||"Justify"===k&&a.bidi||this.is2013Justification&&h)&&(C=this.getSubWidth(e,"Justify"===k,F,m,h),I=C[0].subWidth,F=C[0].spaceCount,P=C[0].totalSpaceCount,T=C[0].trimmedSpaceWidth,w=e.isEndsWithPageBreak||e.isEndsWithColumnBreak||e.isEndsWithLineBreak||e.paragraph.bidi||this.isRTLLayout),!w&&C&&1===C.length&&this.viewer.clientActiveArea.width>0&&!h&&!this.is2013Justification&&"Justify"===k&&"Word2013"===this.documentHelper.compatibilityMode){var S=this.viewer.clientActiveArea.width,W=this.getTotalSpaceWidth(e),N=W/P,H=S/P,E=H/N*100,O=0;return O=E<=33?W/8:W/4,this.viewer.clientActiveArea.x-=O,this.viewer.clientActiveArea.width+=O,this.is2013Justification=!0,void(t?this.splitParagraphForMultiColumn(e,r):(this.moveElementFromNextLine(e),this.nextElementToLayout=e.children[e.children.length-1]))}this.is2013Justification&&h&&I>0&&(I=0,F=0),this.is2013Justification=!1,this.nextElementToLayout=void 0;for(var _=!1,B=0,L=a.lineSpacingType,R=!1,A=e.renderedElements,D=0,U=0,M=0,V=this.viewer.clientArea.x,z=0;z<A.length;z++){var j=0,q=0,G=0,K=A[z];if(!i.i(n.isNullOrUndefined)(C)&&R&&K.padding.left>0&&C.length>B+1){var Z=I;"Justify"===k?Z=I*C[B].spaceCount:"Center"===k&&(Z=I/2),K.padding.left=K.padding.left-Z;var X=C[++B];I=X.subWidth,F=X.spaceCount}if(!(K instanceof d.v&&"Inline"!==K.textWrappingStyle)){R=!0;var J=this.alignLineElements(K,j,q,p,_,I,k,F,z===A.length-1);if("Justify"===k&&K instanceof d.v&&"Inline"===K.textWrappingStyle&&0!==I&&(K.x=V,K instanceof d.s))for(var Y=0;Y<K.textFrame.childWidgets.length;Y++){var Q=K.textFrame.childWidgets[Y],$=Q.bidi?Q.rightIndent:Q.leftIndent;Q.x=V+s.a.convertPointToPixel($+K.textFrame.marginLeft)}V+=K.width,e.maxBaseLine=this.maxBaseline,j=J.topMargin,q=J.bottomMargin,_=J.addSubWidth,F=J.whiteSpaceCount,"Multiple"===L?f>c?q+=f-c:j+=f-c:"Exactly"===L?j+=f-(j+K.height+q):f>j+K.height+q&&(j+=f-(j+K.height+q)),y>0&&o===o.bodyWidget.childWidgets[0]&&this.documentHelper.pages[y].sectionIndex===this.documentHelper.pages[y-1].sectionIndex?j+=0:j+=g,"None"!=v.top.lineStyle&&e.isFirstLine()&&!b.skipTopBorder&&(j+=s.a.convertPointToPixel(v.top.lineWidth+v.top.space)),"None"!=v.bottom.lineStyle&&e.isLastLine()&&!b.skipBottomBorder&&(q+=s.a.convertPointToPixel(v.bottom.lineWidth+v.bottom.space)),q+=u;var ee=z>0?A[z-1]:void 0;if((0===z||!(K instanceof d.v&&"Inline"!==K.textWrappingStyle)&&ee instanceof d.v&&"Inline"!==ee.textWrappingStyle&&ee.indexInOwner<K.indexInOwner||K.padding.left>0)&&(e.height=j+K.height+q,"Right"===k||"Justify"===k&&a.bidi&&(h||T<0)?G=T<0?T:I:"Center"===k&&(G=I<0?I:I/2)),K.margin=new d.E(G,j,0,q),K.line=e,D<K.height&&(D=K.height,U=K.margin.bottom,M=K.margin.top),K instanceof d.s&&"Inline"===K.textWrappingStyle){if(0!==z||K.margin.left>0){var te=A[0].margin.left;K.x+=te;for(var ie=0;ie<K.textFrame.childWidgets.length;ie++){var Q=K.textFrame.childWidgets[ie];Q instanceof d.u?Q.updateChildWidgetLeft(Q.x+te,!0):Q.x+=te}}this.updateShapeYPosition(K)}}}if(e.margin=new d.E(0,M,0,U),this.adjustPositionBasedOnTopAndBottom(e),this.checkInbetweenShapeOverlap(e),!t&&e.isLastLine()&&0===e.indexInOwner&&e.paragraph.paragraphFormat.widowControl){var ne=e.paragraph.previousSplitWidget;if(!i.i(n.isNullOrUndefined)(ne)&&!ne.isEndsWithPageBreak&&!ne.isEndsWithColumnBreak&&0!==ne.indexInOwner){var re=ne.childWidgets.length-1;2===ne.childWidgets.length&&(re=0),this.splitParagraph(ne,re,e.paragraph),this.updateClientAreaForNextBlock(e,e.paragraph)}}else t&&this.splitParagraphForMultiColumn(e,r);t||this.viewer.cutFromTop(this.viewer.clientActiveArea.y+e.height),this.wrapPosition=[]},e.prototype.updateShapeYPosition=function(e){if(e.margin.top>0){e.y+=e.margin.top;for(var t=0;t<e.textFrame.childWidgets.length;t++)e.textFrame.childWidgets[t].y+=e.margin.top}},e.prototype.getBodyWidget=function(e,t){if(t)for(;e&&0!==e.columnIndex;)e=e.previousRenderedWidget;else for(;e&&!i.i(n.isNullOrUndefined)(e.nextRenderedWidget)&&e.columnIndex!==e.sectionFormat.numberOfColumns-1&&e.index===e.nextRenderedWidget.index;)e=e.nextRenderedWidget;return e},e.prototype.splitParagraphForMultiColumn=function(e,t){if(this.splitParagraph(e.paragraph,t,void 0),i.i(n.isNullOrUndefined)(e.paragraph.previousRenderedWidget)&&0==t||!i.i(n.isNullOrUndefined)(e.paragraph.previousRenderedWidget)&&e.paragraph.previousRenderedWidget.bodyWidget.sectionIndex!==e.paragraph.bodyWidget.sectionIndex?this.moveBlocksToNextPage(e.paragraph):this.moveBlocksToNextPage(e.paragraph.previousRenderedWidget),this.viewer.updateClientArea(e.paragraph.bodyWidget,e.paragraph.bodyWidget.page),this.viewer.clientActiveArea.y=e.paragraph.bodyWidget.y,e.paragraph.bodyWidget.sectionFormat.equalWidth){var r=e.paragraph;this.documentHelper.blockToShift=r,this.shiftLayoutedItems(!1)}},e.prototype.checkInbetweenShapeOverlap=function(e,t){var r=this;if(!(e.paragraph.containerWidget instanceof d.i)&&e.paragraph.bodyWidget){var o,s=this.getLineY(e),a=e.paragraph.isInsideTable,l=e.paragraph.y,h=!0;i.i(n.isNullOrUndefined)(t)&&(h=!1,t=e.paragraph.bodyWidget.floatingElements),t.sort(function(e,t){return e.y-t.y}),t.forEach(function(t){if(!(a&&t.line&&!t.line.paragraph.isInsideTable||i.i(n.isNullOrUndefined)(t.line))){var c;c="TopAndBottom"===t.textWrappingStyle&&t instanceof d.r&&!e.paragraph.isEmpty()?new d.t(e.paragraph.x,r.viewer.clientActiveArea.y,e.paragraph.width,e.children[0].height):new d.t(e.paragraph.x,r.viewer.clientActiveArea.y,e.paragraph.width,e.height);var p=new d.t(t.x,t.y-t.distanceTop,t.width,t.height);if(!(t.line&&r.isRelayout&&!r.isRelayoutOverlap&&r.viewer.documentHelper.selection.isExistAfter(t.line.paragraph,e.paragraph)||r.isRelayout&&r.isRelayoutOverlap&&r.viewer.documentHelper.selection.isExistAfter(t.line.paragraph,r.endOverlapWidget))){var u="TopAndBottom"===t.textWrappingStyle,g=t.y+t.height+t.distanceBottom-s;o&&u&&o.y+o.height+o.distanceBottom+e.height>t.y-t.distanceTop&&o.y-o.distanceTop<t.y-t.distanceTop&&t.y+t.height+t.distanceBottom>o.y+o.height+o.distanceBottom?(o=t,e.paragraph.isEmpty()&&h?(e.paragraph.y=l,e.paragraph.y+=g):e.marginTop=g):u&&!o&&c.isIntersecting(p)&&(o=t,e.paragraph.isEmpty()&&h?e.paragraph.y+=g:e.marginTop=g)}}}),o?this.viewer.cutFromTop(o.y+o.height+o.distanceBottom):this.isRelayoutOverlap&&(e.marginTop=0)}},e.prototype.getLineY=function(e){var t=e.paragraph,i=t.y;if(!t.isEmpty())for(var n=t.firstChild;n!==e;)i=i+n.height+n.marginTop,n=n.nextLine;return i},e.prototype.updateLineWidget=function(e){for(var t=0,r=0,o=!1,s=!1,a=0;a<e.children.length;a++){var l=e.children[a];if(l instanceof d.b&&2===l.fieldType&&(s=!1),!(s||(l instanceof d.b&&0===l.fieldType&&(s=!0),l instanceof d.v&&"Inline"!==l.textWrappingStyle)))if(l instanceof d.d&&0===l.text.replace(/\s+/g,"").length&&l.text!==String.fromCharCode(160))t<l.height&&(t=l.height,r=l.baselineOffset);else if(l instanceof d.d||l instanceof d.q){var h=l.height,c=l.baselineOffset,p=!1;l instanceof d.d&&l.isCheckBoxElement&&!i.i(n.isNullOrUndefined)(l.previousNode)&&l.previousNode instanceof d.H&&("Cell"===l.previousNode.contentControlWidgetType||"Inline"===l.previousNode.contentControlWidgetType)&&(p=!0),l instanceof d.d&&l.isCheckBoxElement&&!p&&(h/=1.35,c/=1.35),this.maxTextHeight<h&&(this.maxTextHeight=h,this.maxTextBaseline=c),this.maxBaseline<this.maxTextBaseline&&(this.maxBaseline=this.maxTextBaseline)}else this.maxBaseline<l.height&&(this.maxBaseline=l.height,l instanceof d.r&&(o=!0))}if(0===this.maxTextHeight&&0!==t)if(o)this.maxTextHeight=0,this.maxTextBaseline=0;else{if(e.isLastLine()&&this.documentHelper.selection){var u=this.documentHelper.selection.getParagraphMarkSize(e.paragraph,0,0);this.maxTextHeight=u.height,this.maxTextBaseline=r}else this.maxTextHeight=t,this.maxTextBaseline=r;this.maxBaseline<this.maxTextBaseline&&(this.maxBaseline=this.maxTextBaseline)}},e.prototype.moveToNextPage=function(e,t,r,o){if(!this.isFootNoteLayoutStart){var a,l=t.paragraph,h=0,c=!1,p=!1;if(l&&(i.i(n.isNullOrUndefined)(l.containerWidget)||i.i(n.isNullOrUndefined)(l.containerWidget.containerWidget)||!(l.containerWidget.containerWidget instanceof d.a))){var u=0;if(l instanceof d.a)return;if(!i.i(n.isNullOrUndefined)(t)&&(u=l.childWidgets.indexOf(t),0!==u&&(!l.paragraphFormat.keepLinesTogether||i.i(n.isNullOrUndefined)(l.previousWidget)||t.previousLine.isEndsWithColumnBreak?1!=u||t.previousLine.isEndsWithPageBreak||t.previousLine.isEndsWithColumnBreak||!l.paragraphFormat.widowControl||i.i(n.isNullOrUndefined)(l.previousWidget)||(u=0,c=!0):(u=0,c=!0)),(u>0||r)&&(l.height=e.clientActiveArea.y-l.y),0===u&&!l.isEndsWithPageBreak&&!l.isEndsWithColumnBreak)){var g=this.alignBlockElement(l);i.i(n.isNullOrUndefined)(g.node)||(a=g.node instanceof d.z?this.splitRow(g.node):g.node,h=a instanceof d.u?0:parseInt(g.position.index,10),l=a,u=h,c=!1,p=!0,l instanceof d.g?this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule&&!l.paragraphFormat.keepWithNext&&!o&&this.viewer.owner.editorModule.updateWholeListItems(l):this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule&&!o&&this.viewer.owner.editorModule.updateWholeListItems(l))}if(i.i(n.isNullOrUndefined)(l.bodyWidget)||i.i(n.isNullOrUndefined)(l.bodyWidget.containerWidget)||l.bodyWidget.containerWidget instanceof d.a||void 0===l.bodyWidget.page.footnoteWidget||this.layoutfootNote(l.bodyWidget.page.footnoteWidget),this.isMultiColumnSplit){var f=this.viewer.columnLayoutArea.getNextColumnByBodyWidget(l.bodyWidget);if(i.i(n.isNullOrUndefined)(f))return}var m=l.bodyWidget.page;r&&0===u&&!i.i(n.isNullOrUndefined)(l.bodyWidget.lastChild)&&l===l.bodyWidget.lastChild&&this.endOverlapWidget&&(this.isRelayoutOverlap=!1);var v=this.moveBlocksToNextPage(l,0===u,u);if(m!==v.page&&this.viewer.updateClientArea(v,v.page),this.viewer.updateClientAreaForBlock(l,!0),u>0){if(t.isLastLine()&&r)return;var y=void 0;y=v.firstChild instanceof d.g&&v.firstChild.equals(l)?v.firstChild:new d.g,y=this.moveChildsToParagraph(l,u,y),y.containerWidget=v;for(var w=0;w<y.floatingElements.length;w++){var b=y.floatingElements[w];b.line.paragraph.bodyWidget!==l.bodyWidget&&"Inline"!==b.textWrappingStyle&&l.bodyWidget.floatingElements.splice(l.bodyWidget.floatingElements.indexOf(b),1)}var x=this.getFootNoteWidgetsOf(y);this.moveFootNotesToPage(x,l.bodyWidget,v),l=y,this.viewer.clientActiveArea.height-=this.getFootNoteHeight(x)}else r||(l.containerWidget.removeChild(l.indexInOwner),l instanceof d.g&&l.floatingElements.length>0&&this.addRemoveFloatElementsFromBody(l,l.containerWidget,!1));if(!r){if(-1===v.childWidgets.indexOf(l)&&(v.childWidgets.splice(0,0,l),l instanceof d.g&&l.floatingElements.length>0&&this.addRemoveFloatElementsFromBody(l,v,!0)),l.containerWidget=v,this.viewer.updateClientAreaLocation(l,this.viewer.clientActiveArea),c||p){l.bodyWidget.page.footnoteWidget&&this.layoutfootNote(l.bodyWidget.page.footnoteWidget),(t.paragraph!==l||l.paragraphFormat.widowControl&&this.isImagePresent(l))&&(l instanceof d.u&&this.clearTableWidget(l,!0,!0,!1),this.layoutBlock(l,0,!0),e.updateClientAreaForBlock(l,!1));var C=t.paragraph;if(p){var I=l.nextWidget;if(!i.i(n.isNullOrUndefined)(I))do{if(e.updateClientAreaForBlock(I,!0),I===C){this.viewer.updateClientAreaLocation(I,this.viewer.clientActiveArea);break}I instanceof d.u&&this.clearTableWidget(I,!0,!0,!1),this.layoutBlock(I,0,!0),e.updateClientAreaForBlock(I,!1),I=I.nextWidget}while(I)}this.updateClientAreaForNextBlock(t,C)}if(t.isFirstLine()&&0===t.indexInOwner&&!(t.children[0]instanceof d.q)){var F=-s.a.convertPointToPixel(t.paragraph.paragraphFormat.firstLineIndent);this.viewer.updateClientWidth(F)}}}if(r||this.updateShapeBaseLocation(l),this.isRelayoutOverlap&&this.endOverlapWidget&&(!this.skipRelayoutOverlap||this.endOverlapWidget instanceof d.u&&this.endOverlapWidget.wrapTextAround)){var k=this.endOverlapWidget.previousRenderedWidget,P=t.paragraph;for(this.startOverlapWidget=P,t=this.endOverlapWidget.childWidgets[0],P=t.paragraph;P;)P.floatingElements.forEach(function(e){-1!==k.bodyWidget.floatingElements.indexOf(e)&&"Inline"!==e.textWrappingStyle&&(k.bodyWidget.floatingElements.splice(k.bodyWidget.floatingElements.indexOf(e),1),t.paragraph.bodyWidget.floatingElements.push(e))}),P=P!==this.endOverlapWidget?P.nextWidget:void 0;this.layoutStartEndBlocks(this.startOverlapWidget,this.endOverlapWidget),this.startOverlapWidget=void 0,this.viewer.clientActiveArea.height=this.viewer.clientActiveArea.bottom-this.endOverlapWidget.y,this.viewer.clientActiveArea.y=this.endOverlapWidget.y}}},e.prototype.isImagePresent=function(e){for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],n=0;n<i.children.length;n++)if(i.children[n]instanceof d.r)return!0;return!1},e.prototype.updateShapeBaseLocation=function(e){if(e instanceof d.g&&e.floatingElements.length>0)for(var t=0;t<e.floatingElements.length;t++){var i=e.floatingElements[t],n=this.getFloatingItemPoints(i);i.y=n.y,i.x=n.x,i instanceof d.s&&this.updateChildLocationForCellOrShape(i.y,i)}},e.prototype.moveChildsToParagraph=function(e,t,i){i=this.addParagraphWidget(this.viewer.clientActiveArea,i);for(var n=0,r=t;r<e.childWidgets.length;r++){var o=e.childWidgets[r];o.paragraph=i,i.childWidgets.splice(n,0,o),o.paragraph=i,n++}i.paragraphFormat=e.paragraphFormat,i.characterFormat=e.characterFormat,i.index=e.index,e.childWidgets.splice(t);for(var r=0;r<e.floatingElements.length;r++){var s=e.floatingElements[r];s.line.paragraph!==e&&(i.floatingElements.push(s),e.floatingElements.splice(e.floatingElements.indexOf(s),1),r--)}return i},e.prototype.addRemoveFloatElementsFromBody=function(e,t,i){if(e.floatingElements.length>0)for(var n=0;n<e.floatingElements.length;n++)i?-1===t.floatingElements.indexOf(e.floatingElements[n])&&"Inline"!==e.floatingElements[n].textWrappingStyle&&t.floatingElements.push(e.floatingElements[n]):-1!==t.floatingElements.indexOf(e.floatingElements[n])&&t.floatingElements.splice(t.floatingElements.indexOf(e.floatingElements[n]),1)},e.prototype.alignBlockElement=function(e){if(e instanceof d.g&&(e.isEndsWithPageBreak||e.isEndsWithColumnBreak))return{node:void 0,position:{index:""}};for(var t,r=0,o=this.getPreviousBlock(e);o;){if(o instanceof d.g){if(!o.paragraphFormat.keepWithNext||o.isEndsWithPageBreak||o.isEndsWithColumnBreak)break;if(t=o,o.paragraphFormat.keepLinesTogether)i.i(n.isNullOrUndefined)(this.getPreviousBlock(o))?t=void 0:r=0;else if(i.i(n.isNullOrUndefined)(this.getPreviousBlock(o))&&1===o.childWidgets.length)t=void 0;else if(o.paragraphFormat.widowControl){if(r=o.lastChild.indexInOwner-1,(1===r||r<0)&&(r=0),0!==r)break}else r=o.lastChild.indexInOwner}else if(o instanceof d.z){var s=o.childWidgets[0];if(!(s.childWidgets.length>0))break;var a=this.documentHelper.getFirstParagraphInCell(s);if(!a.paragraphFormat.keepWithNext)break;a.paragraphFormat.keepWithNext&&(i.i(n.isNullOrUndefined)(this.getPreviousBlock(o))?t=void 0:(t=o,r=t.indexInOwner))}o=this.getPreviousBlock(o)}return!i.i(n.isNullOrUndefined)(t)&&t instanceof d.g&&0===t.indexInOwner&&t.paragraphFormat.keepWithNext&&t.paragraphFormat.widowControl&&(t=e),{node:t,position:{index:r.toString()}}},e.prototype.getPreviousBlock=function(e){var t;return e instanceof d.g?(t=e.previousWidget,!this.isInitialLoad&&i.i(n.isNullOrUndefined)(t)&&e.containerWidget instanceof d.o&&!i.i(n.isNullOrUndefined)(e.containerWidget.previousRenderedWidget)&&e.containerWidget.sectionIndex===e.containerWidget.previousRenderedWidget.sectionIndex&&!i.i(n.isNullOrUndefined)(e.previousRenderedWidget)&&e.previousRenderedWidget instanceof d.g&&(t=e.previousRenderedWidget)):e instanceof d.z&&(t=e.previousWidget,i.i(n.isNullOrUndefined)(t)&&(t=e.ownerTable.previousWidget)),t instanceof d.u&&(t=t.lastChild),t},e.prototype.splitRow=function(e){var t=e.ownerTable;if(0===e.indexInOwner)return t;for(var i=this.createTableWidget(t),n=e.indexInOwner;n<t.childWidgets.length;){var r=t.childWidgets.splice(n,1)[0];i.childWidgets.push(r),r.containerWidget=i,t.height-=r.height,i.height+=r.height}return t.containerWidget.childWidgets.splice(t.indexInOwner+1,0,i),i.containerWidget=t.containerWidget,i},e.prototype.splitParagraph=function(e,t,r){if(0===t&&i.i(n.isNullOrUndefined)(r))return e;var o=!1;if(i.i(n.isNullOrUndefined)(r))r=new d.g,r.containerWidget=e.containerWidget,e.containerWidget.childWidgets.splice(e.indexInOwner+1,0,r),r.paragraphFormat=e.paragraphFormat,r.characterFormat=e.characterFormat,r.index=e.index;else if(0===t){o=!0;var s=e;e=r,r=s}for(var a=0,l=t;l<e.childWidgets.length;l++){var h=e.childWidgets[l];h.paragraph=r,o?r.childWidgets.push(h):r.childWidgets.splice(a,0,h),r.height+=h.height,e.height-=h.height,h.paragraph=r,a++}return r.width=e.width,o?(r.containerWidget.childWidgets.splice(r.indexInOwner,1),r.y=e.y,r.x=e.x,r.containerWidget=e.containerWidget,e.containerWidget.childWidgets.unshift(r)):e.childWidgets.splice(t),(0===e.childWidgets.length||o)&&e.containerWidget.childWidgets.splice(e.indexInOwner,1),r},e.prototype.updateClientPositionForBlock=function(e,t){var r=e instanceof d.z?e.ownerTable:e,o=!1;do{if(this.viewer.updateClientAreaForBlock(r,!0),r instanceof d.g){if(t instanceof d.g&&t.equals(r)){o=!0;break}this.addParagraphWidget(this.viewer.clientActiveArea,r),this.viewer.cutFromTop(this.viewer.clientActiveArea.y+r.height),this.viewer.updateClientAreaForBlock(r,!1)}else if(r instanceof d.u){"Word2013"===this.documentHelper.compatibilityMode||r.isInsideTable||(this.viewer.clientActiveArea.x=this.viewer.clientActiveArea.x-s.a.convertPointToPixel(r.firstChild.firstChild.leftMargin)),this.addTableWidget(this.viewer.clientActiveArea,[r]);var a=r.firstChild;if(t instanceof d.z&&r.equals(t.ownerTable)&&!i.i(n.isNullOrUndefined)(a))do{if(a.equals(t)){o=!0;break}this.addTableRowWidget(this.viewer.clientActiveArea,[a]),this.updateChildLocationForRow(this.viewer.clientActiveArea.y,a),this.viewer.cutFromTop(this.viewer.clientActiveArea.y+a.height),r.height+=a.height,a=a.nextWidget}while(a);else this.updateChildLocationForTable(r.y,r),this.viewer.cutFromTop(this.viewer.clientActiveArea.y+r.height),this.viewer.updateClientAreaForBlock(r,!1)}r=r.nextWidget}while(r&&!o)},e.prototype.updateClientAreaForNextBlock=function(e,t){for(var i=0;i<t.childWidgets.length;i++){var n=t.childWidgets[i];if(e===n)break;this.updateShapeBaseLocation(t),this.checkInbetweenShapeOverlap(n),this.viewer.cutFromTop(this.viewer.clientActiveArea.y+n.height)}},e.prototype.layoutStartEndBlocks=function(e,t){var r=e;this.isOverlapFloatTable=!0,this.viewer.clientActiveArea.height=this.viewer.clientActiveArea.bottom-e.y,this.viewer.clientActiveArea.y=e.y;var o;for(o=e instanceof d.u?this.documentHelper.getFirstParagraphInFirstCell(e):e,this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule&&this.viewer.owner.editorModule.updateWholeListItems(o);r;){this.viewer.updateClientAreaForBlock(r,!0),r instanceof d.g?this.layoutParagraph(r,0):(this.clearTableWidget(r,!0,!0,!0),this.layoutTable(r,0)),this.viewer.updateClientAreaForBlock(r,!1);var s=!i.i(n.isNullOrUndefined)(r.nextWidget)&&r.nextWidget instanceof d.u&&r.nextWidget===t&&"Paragraph"===r.nextWidget.positioning.verticalOrigin;r=r===t||s?void 0:r.nextWidget}},e.prototype.alignLineElements=function(e,t,r,o,a,l,h,c,p){if(e.width>0&&(e instanceof d.d||e instanceof d.q)){var u=e instanceof d.d?e:void 0,g=e instanceof d.d?u.baselineOffset:e.baselineOffset;if(t+=this.maxBaseline-g,r+=o-(e.height-g),!i.i(n.isNullOrUndefined)(u)&&"Justify"===h&&c>0){var f=u.width,m=u.text;if(a||(m=s.a.trimStart(m),a=m.length>0),a){var v=m.length-s.a.removeSpace(m).length;p&&(v-=m.length-s.a.trimEnd(m).length),c<v&&(f=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(m,u.characterFormat,u.scriptType),v=c),v>0&&(u.width=f+l*v,c-=v)}}}else a=!0,t+=this.maxBaseline-e.height,r+=o;return{topMargin:t,bottomMargin:r,addSubWidth:a,whiteSpaceCount:c}},e.prototype.updateWidgetToPage=function(e,t){if(t.isInsideTable){var r=t.associatedCell;if(t.height=e.clientActiveArea.y-t.y,i.i(n.isNullOrUndefined)(t.associatedCell)||i.i(n.isNullOrUndefined)(t.associatedCell.ownerRow)||i.i(n.isNullOrUndefined)(t.associatedCell.ownerRow.rowFormat))return;"Exactly"===t.associatedCell.ownerRow.rowFormat.heightType?r.height=s.a.convertPointToPixel(t.associatedCell.ownerRow.rowFormat.height):[r].length<=1&&"AtLeast"===t.associatedCell.ownerRow.rowFormat.heightType?r.height=Math.max(s.a.convertPointToPixel(t.associatedCell.ownerRow.rowFormat.height),this.getCellContentHeight(r)):r.height=r.height+t.height,t.containerWidget=r}else(!t.isEndsWithPageBreak&&!t.isEndsWithColumnBreak||e instanceof h.a)&&(t.height=e.clientActiveArea.y-t.y);this.isRelayoutFootnote&&t.bodyWidget instanceof d.a&&(t.isInsideTable||(t.containerWidget.height+=t.height),this.shiftFootnoteChildLocation(t.bodyWidget,this.viewer)),t.bodyWidget instanceof d.x&&(t.isInsideTable||(t.containerWidget.height+=t.height),this.viewer.owner.enableHeaderAndFooter&&-1!==t.bodyWidget.headerFooterType.indexOf("Footer")&&this.shiftFooterChildLocation(t.bodyWidget,this.viewer)),e instanceof h.a&&t.containerWidget instanceof d.o&&(t.containerWidget.height+=t.height)},e.prototype.shiftFooterChildLocation=function(e,t){var r=e.page.bodyWidgets[0].sectionFormat.pageHeight;if(-1!==e.headerFooterType.indexOf("Footer")){var o,a=e.page.bodyWidgets[0].sectionFormat.footerDistance,l=s.a.convertPointToPixel(r-a);e.y+e.height>l?o=l-(e.y+e.height):e.y+e.height<l&&(o=e.y+e.height-l),i.i(n.isNullOrUndefined)(o)||(o=l-(e.y+e.height),this.shiftChildLocation(o,e),t.clientActiveArea.y+=o)}},e.prototype.shiftFootnoteChildLocation=function(e,t){var r,o=e.page.bodyWidgets[0].sectionFormat.pageHeight,a=(e.page.bodyWidgets[0].sectionFormat.footerDistance,e.page.bodyWidgets[0].sectionFormat.bottomMargin),l=s.a.convertPointToPixel(o-a);e.y+e.height>l?r=l-(e.y+e.height):e.y+e.height<l&&(r=e.y+e.height-l),i.i(n.isNullOrUndefined)(r)||(r=l-(e.y+e.height),this.shiftChildLocation(r,e),t.clientActiveArea.y+=r)},e.prototype.checkPreviousElement=function(e,t){for(var r=e.paragraph,o=!1,s=0,a=t-1;a>=0;a--){var l=e.children[a];if(l instanceof d.d&&l.width>0){var h=l.text;if(s=a,h.length>0&&(" "===h[h.length-1]||"-"===h[h.length-1])){if(a===t-1)return this.addSplittedLineWidget(e,t-1),!0;o=!0;break}if("\t"===h||this.documentHelper.textHelper.isUnicodeText(h,l.scriptType))return!1;if(h.indexOf(" ")>=0){o=!0;var c=h.lastIndexOf(" ")+1,p=new d.d;p.text=h.substr(c),p.characterFormat.copyFormat(l.characterFormat),p.characterRange=l.characterRange,l.revisions.length>0&&(this.updateRevisionForSplittedElement(l,p,c>0),p.isMarkedForRevision=l.isMarkedForRevision),l.text=h.substr(0,c),this.documentHelper.textHelper.getTextSize(p,l.characterFormat),l.width-=p.width,l.trimEndWidth=l.width,l.height=p.height,0===l.width&&(e.children.splice(a,1),!i.i(n.isNullOrUndefined)(e.layoutedElements)&&e.layoutedElements.length>0&&e.layoutedElements.splice(a,1)),e.children.splice(a+1,0,p),i.i(n.isNullOrUndefined)(e.layoutedElements)||e.layoutedElements.splice(a+1,0,p);break}}else if(!(l instanceof d.q||l instanceof d.b||l instanceof d.d&&0===l.width||l instanceof d.B||l instanceof d.H)){s=a,o=!0;break}}if(o&&++s<e.children.length){for(var u=0,a=s;a<e.children.length;a++)u+=e.children[a].width,this.addSplittedLineWidget(e,a-1),a--;"Justify"===r.paragraphFormat.textAlignment&&"Word2013"===this.documentHelper.compatibilityMode||this.viewer.updateClientWidth(u)}return o},e.prototype.clearListElementBox=function(e){if(0!==e.childWidgets.length){var t=e.childWidgets[0];if(!i.i(n.isNullOrUndefined)(t.children)){for(var r=t.children.length-1;r>0&&t.children[r]instanceof d.q;r--)t.children.splice(r,1);for(var r=0;r<t.children.length&&t.children[r]instanceof d.q;r++)t.children.splice(r,1),r--}}},e.prototype.clearInvalidList=function(e){e&&(-1===e.abstractListId&&-1!==this.documentHelper.abstractLists.indexOf(e.abstractList)&&this.documentHelper.abstractLists.splice(this.documentHelper.abstractLists.indexOf(e.abstractList),1),-1===e.listId&&-1!==this.documentHelper.lists.indexOf(e)&&this.documentHelper.lists.splice(this.documentHelper.lists.indexOf(e),1))},e.prototype.getListNumber=function(e,t){var r=this.documentHelper.getListById(e.listId),o=e.listLevelNumber,s=this.getListLevel(r,e.listLevelNumber),a=i.i(n.isNullOrUndefined)(r.levelOverrides)?void 0:r.levelOverrides[o];if(!i.i(n.isNullOrUndefined)(a)&&-1===this.documentHelper.renderedLevelOverrides.indexOf(a)&&i.i(n.isNullOrUndefined)(a.overrideListLevel)){this.documentHelper.renderedLevelOverrides.push(a);var l=this.documentHelper.getAbstractListById(r.abstractListId);if(this.documentHelper.renderedLists.containsKey(l)){var d=this.documentHelper.renderedLists.get(l);d.containsKey(o)&&(d.remove(o),this.ClearSubListLevelValues(r,l,o))}}return i.i(n.isNullOrUndefined)(t)&&this.updateListValues(r,o),this.getListText(r,o,s)},e.prototype.ClearSubListLevelValues=function(e,t,i){for(var n=this.documentHelper.renderedLists.get(t),r=i+1;r<t.levels.length;){var o=this.getListLevel(e,r);n.containsKey(r)&&o.restartLevel>i&&n.remove(r),r++}},e.prototype.getListStartValue=function(e,t){var r=i.i(n.isNullOrUndefined)(t.levelOverrides)?void 0:t.levelOverrides[e];if(!i.i(n.isNullOrUndefined)(r)&&i.i(n.isNullOrUndefined)(r.overrideListLevel))return r.startAt;var o=this.getListLevel(t,e);return i.i(n.isNullOrUndefined)(o)?0:o.startAt},e.prototype.updateListValues=function(e,t){var i=this.documentHelper.getAbstractListById(e.abstractListId),n=this.getListLevel(e,t);if(this.documentHelper.renderedLists.containsKey(i)){var o=this.documentHelper.renderedLists.get(i);if(o.containsKey(t)){var s=o.get(t);o.set(t,s+1);for(var a=t+1;a<this.documentHelper.getAbstractListById(e.abstractListId).levels.length;){var l=this.getListLevel(e,a);o.containsKey(a)&&(l.restartLevel>t||"Bullet"===n.listLevelPattern)&&o.remove(a),a++}}else{for(var a=t;!o.containsKey(a-1)&&a>0;){var l=this.getListLevel(e,a-1);o.add(a-1,this.getListStartValue(a-1,e)),a--}var s=this.getListStartValue(t,e);o.add(t,s)}}else{var d=new r.a;this.documentHelper.renderedLists.add(i,d);for(var l=this.getListLevel(e,t),h=0;h<=t;h++)d.add(h,this.getListStartValue(h,e))}},e.prototype.getListText=function(e,t,r){var o=r.numberFormat;if(this.documentHelper.renderedLists.containsKey(this.documentHelper.getAbstractListById(e.abstractListId)))for(var s=this.documentHelper.renderedLists.get(this.documentHelper.getAbstractListById(e.abstractListId)),a=s.keys,l=0;l<a.length;l++){var d=a[l],h="%"+(d+1).toString(),c=this.getListLevel(e,d),p=l<t?"LeadingZero"!==c.listLevelPattern?"Arabic":c.listLevelPattern:void 0;if(o.match(h)){if(d>t)return"";o=s.containsKey(d)&&!i.i(n.isNullOrUndefined)(c)?o.replace(h,this.getListTextListLevel(c,s.get(d),r.isLegalStyleNumbering?p:void 0)):o.replace(h,"0")}}return o},e.prototype.getAsLetter=function(e){var t=e/26,i=e%26;0===i&&(i=26,t--);for(var n=String.fromCharCode(64+i),r="";t>=0;)r+=n.toString(),t--;return r},e.prototype.getListTextListLevel=function(e,t,r){switch(i.i(n.isNullOrUndefined)(r)?e.listLevelPattern:r){case"UpRoman":return this.getAsRoman(t).toUpperCase();case"LowRoman":return this.getAsRoman(t).toLowerCase();case"UpLetter":return this.getAsLetter(t).toUpperCase();case"LowLetter":return this.getAsLetter(t).toLowerCase();case"Arabic":return t.toString();case"LeadingZero":return this.getAsLeadingZero(t);case"Number":case"OrdinalText":return t.toString();case"Ordinal":return this.getAsOrdinal(t,e.characterFormat).toString();case"FarEast":case"Special":return t.toString();default:return""}},e.prototype.getFootEndNote=function(e,t){switch(e){case"UpperCaseRoman":return this.getAsRoman(t).toUpperCase();case"LowerCaseRoman":return this.getAsRoman(t).toLowerCase();case"UpperCaseLetter":return this.getAsLetter(t).toUpperCase();case"LowerCaseLetter":return this.getAsLetter(t).toLowerCase();default:return t.toString()}},e.prototype.generateNumber=function(e,t,i){for(var n="";e>=t;)e-=t,n+=i,this.value=e;return n.toString()},e.prototype.getAsLeadingZero=function(e){return e<10?"0"+e.toString():e.toString()},e.prototype.getAsRoman=function(e){var t="";return this.value=e,t+=this.generateNumber(this.value,1e3,"M"),t+=this.generateNumber(this.value,900,"CM"),t+=this.generateNumber(this.value,500,"D"),t+=this.generateNumber(this.value,400,"CD"),t+=this.generateNumber(this.value,100,"C"),t+=this.generateNumber(this.value,90,"XC"),t+=this.generateNumber(this.value,50,"L"),t+=this.generateNumber(this.value,40,"XL"),t+=this.generateNumber(this.value,10,"X"),t+=this.generateNumber(this.value,9,"IX"),t+=this.generateNumber(this.value,5,"V"),t+=this.generateNumber(this.value,4,"IV"),t+=this.generateNumber(this.value,1,"I"),t.toString()},e.prototype.getAsOrdinal=function(e,t){switch(t.localeIdAscii){case 1069:case 8218:case 5146:case 4122:case 1050:case 1029:case 1061:case 1035:case 3079:case 1031:case 5127:case 4103:case 2055:case 1038:case 1060:case 1055:case 1044:case 2068:case 1045:case 6170:case 2074:return e.toString()+".";case 2060:case 11276:case 3084:case 9228:case 12300:case 1036:case 15372:case 5132:case 13324:case 6156:case 14348:case 8204:case 10252:case 4108:return 1==e?e.toString()+"er":e.toString()+"e";case 2067:case 1043:return e.toString()+"e";case 1032:return e.toString()+"o";case 1040:case 2064:return e.toString()+String.fromCharCode(176);case 5130:case 7178:case 12298:case 17418:case 4106:case 1046:case 2070:case 11274:case 16394:case 13322:case 9226:case 18442:case 2058:case 19466:case 6154:case 15370:case 10250:case 20490:case 3082:case 1034:case 21514:case 14346:case 8202:return e.toString()+String.fromCharCode(186);case 1049:case 2073:return e.toString()+"-"+String.fromCharCode(1081);case 2077:case 1053:return this.getOrdinalInSwedish(e);case 1027:return this.getOrdinalInCatalan(e);case 1030:return this.getOrdinalInDanish(e);default:return this.getOrdinalInEnglish(e)}},e.prototype.getOrdinalInEnglish=function(e){switch(e%100){case 11:case 12:case 13:return e.toString()+"th"}switch(e%10){case 1:return e.toString()+"st";case 2:return e.toString()+"nd";case 3:return e.toString()+"rd";default:return e.toString()+"th"}},e.prototype.getOrdinalInSwedish=function(e){return 11==e||12==e?e.toString()+":e":e%10==1||e%10==2?e.toString()+":a":e.toString()+":e"},e.prototype.getOrdinalInCatalan=function(e){switch(e){case 1:return e.toString()+".";case 2:return e.toString()+"n";case 3:return e.toString()+"r";case 4:return e.toString()+"t";case 14:return e.toString()+String.fromCharCode(232)+"h";default:return e.toString()+String.fromCharCode(232)}},e.prototype.getOrdinalInDanish=function(e){if(0==e)return e.toString()+"te";switch(e%100){case 0:return e.toString()+"ende";case 1:return e.toString()+"ste";case 2:return e.toString()+"nden";case 3:return e.toString()+"dje";case 4:return e.toString()+"rde";case 5:case 6:case 11:case 12:case 30:return e.toString()+"te";default:return e.toString()+"nde"}},e.prototype.getListLevel=function(e,t){if(!i.i(n.isNullOrUndefined)(e)){var r=this.documentHelper.getAbstractListById(e.abstractListId);!i.i(n.isNullOrUndefined)(e)&&r.levels.length<=t&&t>=0&&t<9&&this.addListLevels(r);var o=void 0;if(!i.i(n.isNullOrUndefined)(e.levelOverrides)&&!i.i(n.isNullOrUndefined)(o=this.getOverrideListLevel(e.levelOverrides,t))&&!i.i(n.isNullOrUndefined)(o.overrideListLevel))return i.i(n.isNullOrUndefined)(o.startAt)&&(o.overrideListLevel.startAt=r.levels[t].startAt),o.overrideListLevel;if(!i.i(n.isNullOrUndefined)(r)&&t>=0&&t<r.levels.length)return r.levels[t]}},e.prototype.getOverrideListLevel=function(e,t){for(var i=0;i<e.length;i++)if(e[i].levelNumber==t)return e[i]},e.prototype.getTabWidth=function(e,t,r,o,a){var l=0,h=!1,c=e.paragraphFormat.getUpdatedTabs(),p=!1,u=e.bodyWidget.sectionFormat,g=(s.a.convertPointToPixel(u.leftMargin),!1);if(!i.i(n.isNullOrUndefined)(e.paragraphFormat.listFormat.listLevel)&&!i.i(n.isNullOrUndefined)(e.paragraphFormat.listFormat.listLevel.paragraphFormat)){var f=e.paragraphFormat.listFormat.listLevel.paragraphFormat;e.paragraphFormat.leftIndent!==f.leftIndent&&(p=!0)}var m=0,v=t.clientActiveArea.x,y=s.a.convertPointToPixel(e.paragraphFormat.firstLineIndent),w=s.a.convertPointToPixel(e.paragraphFormat.leftIndent);if(!i.i(n.isNullOrUndefined)(a)&&o.isFirstLine()?(m=this.viewer.clientArea.x+y,p&&(v+=y)):m=this.viewer.clientArea.x,v<m&&("Word2003"!==this.documentHelper.compatibilityMode||0===c.length))return t.clientArea.x-t.clientActiveArea.x;for(var b=t.clientActiveArea.x-(t.clientArea.x-s.a.convertPointToPixel(e.paragraphFormat.leftIndent)),x=0;x<c.length;x++){var C=c[x],I=s.a.convertPointToPixel(C.position);I<w&&(g=parseFloat(b.toFixed(2))<parseFloat(I.toFixed(2)))}if(o.isFirstLine()&&w>0&&y<0&&(a instanceof d.q||!g)){if(t.clientArea.x-t.clientActiveArea.x>0)return t.clientArea.x-t.clientActiveArea.x;0===c.length&&e.paragraphFormat.listFormat&&e.paragraphFormat.listFormat.listLevel&&(c=e.paragraphFormat.listFormat.listLevel.paragraphFormat.tabs)}var F=s.a.convertPointToPixel(this.documentHelper.defaultTabWidth);if(0===c.length&&(b>0&&F>Math.round(b)&&p||F===this.defaultTabWidthPixel&&F>Math.round(b)))return F-b;var k=!1;if(c.length>0){for(var x=c.length-1;x>-1;x--){var C=c[x],P=s.a.convertPointToPixel(C.position);if(!(parseFloat(P.toFixed(2))>parseFloat(b.toFixed(2)))){if(x>0&&s.a.convertPointToPixel(c[x-1].position)>parseFloat(b.toFixed(2)))continue;if(x!=c.length-1){var T=this.getJustificationTabWidth(c[x+1],a,o,e,F,b,l);F=T.defaultTabWidth,l=T.fPosition,b=T.position,h=!0}k=!0;break}}if(!k){var S=this.getJustificationTabWidth(c[0],a,o,e,F,b,l);F=S.defaultTabWidth,l=S.fPosition,b=S.position,h=!0}}if(!h){l=((b-parseFloat((100*b%(100*F)/100).toFixed(2)))/F+1)*F}return parseFloat(l.toFixed(1))===parseFloat(b.toFixed(1))?F:l-b>0?l-b:F},e.prototype.getJustificationTabWidth=function(e,t,r,o,a,l,h){var c=t?this.documentHelper.textHelper.getTextSize(t,t.characterFormat):0;if("Left"===e.tabJustification||"List"===e.tabJustification)h=s.a.convertPointToPixel(e.position),t instanceof d.I&&(t.tabLeader=e.tabLeader,t.tabText="");else{var p=s.a.convertPointToPixel(e.position)-l,u=this.getRightTabWidth(t.indexInOwner+1,r,o);if(u<p&&"Decimal"!=e.tabJustification)if("Right"===e.tabJustification){a=p-u;var g=s.a.convertPointToPixel(o.rightIndent),f=this.viewer.clientActiveArea.width+g-a;this.viewer.clientActiveArea.width+=g,f<0?a+=f-u:u>f&&(a-=u-f)}else a=p-u/2;else if("Center"===e.tabJustification&&u/2<p)a=p-u/2;else if("Decimal"===e.tabJustification)if(!i.i(n.isNullOrUndefined)(t.nextElement)&&t.nextElement instanceof d.d){var m=t.nextElement;if(-1!=m.text.indexOf(".")){var v=m.text.indexOf("."),y=m.text.substring(0,v),w=this.documentHelper.textHelper.getWidth(y,m.characterFormat,m.scriptType);a=p-w}else a=u<p?p-u:p}else a=p;else a="Right"===e.tabJustification?0:c;h=l,t instanceof d.I&&(t.tabLeader=e.tabLeader,t.tabText="")}return{defaultTabWidth:a,fPosition:h,position:l}},e.prototype.getRightTabWidth=function(e,t,i){for(var n=0,r=!1,o=t.children[e];o;){if(o instanceof d.b||o instanceof d.e||r)o instanceof d.b&&(0===o.fieldType?r=!0:2===o.fieldType&&(r=!1)),o.width=0;else{if(o instanceof d.D&&!this.isTocField(o.fieldBegin)){var s=this.documentHelper.getFieldResult(o.fieldBegin,o.paragraph.bodyWidget.page);""!==s&&(o.text=s)}o instanceof d.d&&this.documentHelper.textHelper.getTextSize(o,o.characterFormat)}if(o instanceof d.d&&"\t"===o.text)return n;n+=o.width,o=o.nextNode}return n},e.prototype.getSplitIndexByWord=function(e,t,i,n,r){for(var o=0,s=t.length;o<s;){var a=this.getTextIndexAfterSpace(t,o);0!==a&&a!==s||(a=s-1);var l=i;if((a<s-1||a===s-1&&" "===t[a-1])&&o!==a&&(l=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(t.slice(0,a),n,r)),!(l<=e)){0===o&&" "===t[0]&&(o=this.getTextIndexAfterSpace(t,0));break}o=a}return o},e.prototype.getTextSplitIndexByCharacter=function(e,t,i,n,r,o){for(var s=i.length,a=0;a<s;a++){var l=n;if(a+1<s&&(l=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(i.substring(0,a+1),r,o)),l>t)return 0===a&&l>e?s>1&&" "===i[1]?this.getTextIndexAfterSpace(i,1):1:" "===i[a]?this.getTextIndexAfterSpace(i,a):a}return 0},e.prototype.getSubWidth=function(e,t,i,n,r){var o=0,a=!0,l="",h=0,c=e.paragraph.paragraphFormat.bidi;if(this.wrapPosition.length>0){var p=this.getSubWidthBasedOnTextWrap(e,t,i,n,r);if(p.length>0)return p}for(var u=e.renderedElements,g=u.length-1;g>=0;g--){var f=u[g];if(f.width>0&&f instanceof d.d){var m=f.text;if(l=m+l,t&&c&&(a=" "===m&&g-1>=0&&" "===u[g-1].text),!a||""===m.trim()&&"\t"!==m)a?h+=f.width:o+=f.width;else{if(s.a.endsWith(m)){var v=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(m,f.characterFormat,f.scriptType);o+=v,h+=f.width-v}else o+=f.width;a=!1}}else{if(l="a"+l,a=!1,f instanceof d.v&&"Inline"!==f.textWrappingStyle)continue;o+=f.width}o=t?o:Math.round(o)}var y=l.length-s.a.removeSpace(l).length;l=l.trim(),i=l.length-s.a.removeSpace(l).length;var w=this.viewer.clientArea.width-n-o,b=this.viewer.clientArea.width-n-(o+h);return c&&t&&(b<0?h=-h:w=b),w<=0&&!this.is2013Justification||0===i&&t&&!c?(i=0,w=0):t?!r&&i>0||r&&this.is2013Justification&&i>0?w/=i:i=0:h>0&&c&&r&&(w-=h),[{trimmedSpaceWidth:h,subWidth:w,spaceCount:i,totalSpaceCount:y}]},e.prototype.getSubWidthBasedOnTextWrap=function(e,t,r,o,a){for(var l=[],h=0,c="",p=this.wrapPosition.length-1,u=!0,g=e.children.length-1;g>=0;g--){var f=e.children[g];if(f.width>0&&f instanceof d.d){var m=f.text;c=m+c,!u||""===m.trim()&&"\t"!==m?u||(h+=f.width):(s.a.endsWith(m)?h+=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(m,f.characterFormat,f.scriptType):h+=f.width,u=!1)}else c="a"+c,u=!1,f instanceof d.v&&"Inline"!==f.textWrappingStyle||(h+=f.width);if((f.padding.left>0||0===g)&&p>=0){for(var v=this.wrapPosition[p--];v.width<=0&&p>=0;)v=this.wrapPosition[p--];var y=this.getSubWidthInfo(e,v.width,h,c,r,t,a);i.i(n.isNullOrUndefined)(y)||(h=0,c="",l.unshift(y))}}return l},e.prototype.isWordFittedByJustification=function(e,t){var r=e.line,o=r.paragraph,a=o.paragraphFormat,l=a.textAlignment,d=r.isLastLine(),h=0;r.isFirstLine()&&(h=s.a.convertPointToPixel(a.firstLineIndent));var c=this.viewer.clientActiveArea.width;if(0!=t&&c>=t/2){var p=0,u=void 0,g=0;if("Left"!==l&&this.viewer.textWrap&&("Justify"!==l||!d||"Justify"===l&&a.bidi||this.is2013Justification&&d)&&(u=this.getSubWidth(r,"Justify"===l,p,h,d),p=u[0].spaceCount,g=u[0].totalSpaceCount),!i.i(n.isNullOrUndefined)(u)&&1==u.length&&c>0&&"Justify"===l&&"Word2013"===this.documentHelper.compatibilityMode&&!this.is2013Justification&&0===a.rightIndent&&0===a.leftIndent){var f=0,m=this.getTotalSpaceWidth(r,g),v=m/g;if(f=((c+m)/g-v)/v*100<=33?m/8:m/4,c+f>=t)return this.viewer.clientActiveArea.x-=f,this.viewer.clientActiveArea.width+=f,this.is2013Justification=!0,!0}}return!1},e.prototype.getTotalSpaceWidth=function(e,t){var r=0,o=0;if(e)for(var a=0;a<e.children.length;a++){var l=e.children[a];if(l instanceof d.d){var h=l.text.length-s.a.removeSpace(l.text).length;if(h>0){var c=this.documentHelper.textHelper.getWidth(" ",l.characterFormat,l.scriptType);r+=h*c,o+=h}}if(!i.i(n.isNullOrUndefined)(t)&&o>=t)break}return r},e.prototype.getSubWidthInfo=function(e,t,i,n,r,o,a){if(t>0){var l=t-i;n=n.trim(),r=n.length-s.a.removeSpace(n).length;var d=l;return d<=0||0===r&&o&&!e.paragraph.paragraphFormat.bidi?(r=0,d=0):o&&(!a&&r>0?d/=r:r=0),{trimmedSpaceWidth:0,subWidth:d,spaceCount:r,totalSpaceCount:r}}},e.prototype.getBeforeSpacing=function(e,t){var i=0;if(this.documentHelper.dontUseHtmlParagraphAutoSpacing)i=e.paragraphFormat.beforeSpacing;else{var n=e.previousWidget;if(n instanceof d.g){var r=this.getAfterSpacing(n),o=e.paragraphFormat.beforeSpacing;e.paragraphFormat.spaceBeforeAuto&&(o=14),r<o&&(i=o-r)}else n instanceof d.u?i=e.paragraphFormat.spaceBeforeAuto?14:e.paragraphFormat.beforeSpacing:t>0&&e===e.bodyWidget.childWidgets[0]?this.documentHelper.pages[t].sectionIndex!==this.documentHelper.pages[t-1].sectionIndex&&(i=e.paragraphFormat.spaceBeforeAuto?14:e.paragraphFormat.beforeSpacing):i=e.paragraphFormat.spaceBeforeAuto?0:e.paragraphFormat.beforeSpacing}return this.isSameStyle(e,!1)?0:s.a.convertPointToPixel(i)},e.prototype.getAfterSpacing=function(e){var t=e.paragraphFormat.afterSpacing;return!this.documentHelper.dontUseHtmlParagraphAutoSpacing&&e.paragraphFormat.spaceAfterAuto&&(t=i.i(n.isNullOrUndefined)(e.nextWidget)&&e.isInsideTable?0:14),this.isSameStyle(e,!0)?0:t},e.prototype.getLineSpacing=function(e,t,r){if(i.i(n.isNullOrUndefined)(e.paragraphFormat))return 0;var o=0;switch(e.paragraphFormat.lineSpacingType){case"AtLeast":case"Exactly":o=s.a.convertPointToPixel(e.paragraphFormat.lineSpacing);break;default:o=e.paragraphFormat.lineSpacing,r&&(o-=1),o*=t}return o},e.prototype.isParagraphFirstLine=function(e,t){var r=e;return!(!i.i(n.isNullOrUndefined)(r.childWidgets)&&0!==r.childWidgets.indexOf(t))&&(!(t.children.length>0&&!i.i(n.isNullOrUndefined)(e.previousWidget)&&e.previousWidget instanceof d.g)||t.paragraph.index!==e.previousWidget.index)},e.prototype.isParagraphLastLine=function(e){var t=e.line.paragraph,i=t.childWidgets[t.childWidgets.length-1],n=i.children[i.children.length-1];return e===n&&(n instanceof d.b||!(n instanceof d.d&&"\v"===n.text))},e.prototype.getTextIndexAfterSpace=function(e,t){var i=e.length,n=0,r=0;n=e.indexOf(" ",t)+1,r=e.indexOf("-",t)+1,1==r&&(r=e.indexOf("-",r+1)+1),r>0&&n>0?n=Math.min(n,r):r>0&&0==n&&(n=r);var o=n;if(0===o||o===i)return o;for(;" "===e[o]&&++o!==i;);return o},e.prototype.moveNextWidgetsToTable=function(e,t,i){var n=t.indexInOwner,r=e[e.length-1];i&&(n+=1);for(var o=t.containerWidget.childWidgets.splice(n),s=0;s<o.length;s++)r.childWidgets.push(o[s]),o[s].containerWidget=r},e.prototype.addTableCellWidget=function(e,t,r,o){var a=0,l=0,h=0,c=r,p=0,u=o;i.i(n.isNullOrUndefined)(e.cellFormat)||(e.cellFormat.containsMargins()?(h=i.i(n.isNullOrUndefined)(e.cellFormat.leftMargin)?s.a.convertPointToPixel(e.ownerTable.tableFormat.leftMargin):s.a.convertPointToPixel(e.cellFormat.leftMargin),p=i.i(n.isNullOrUndefined)(e.cellFormat.rightMargin)?s.a.convertPointToPixel(e.ownerTable.tableFormat.rightMargin):s.a.convertPointToPixel(e.cellFormat.rightMargin)):(h=0===e.columnIndex&&e.ownerRow.rowFormat.hasValue("leftMargin")?s.a.convertPointToPixel(e.ownerRow.rowFormat.leftMargin):s.a.convertPointToPixel(e.ownerTable.tableFormat.leftMargin),p=e.columnIndex===e.ownerTable.tableHolder.columns.length-1&&e.ownerRow.rowFormat.hasValue("rightMargin")?s.a.convertPointToPixel(e.ownerRow.rowFormat.rightMargin):s.a.convertPointToPixel(e.ownerTable.tableFormat.rightMargin))),e.margin=new d.E(h,c,p,u);var g=(e.ownerTable.tableFormat.allowAutoFit,e.cellFormat.cellWidth);if("Percent"===e.cellFormat.preferredWidthType&&0!==e.cellFormat.preferredWidth&&g<=0){var f=s.a.convertPointToPixel(e.ownerTable.getTableClientWidth(e.ownerTable.getContainerWidth()));g=e.ownerTable.getCellWidth(e.cellFormat.preferredWidth,e.cellFormat.preferredWidthType,f,e)}e.width=s.a.convertPointToPixel(g),i.i(n.isNullOrUndefined)(e.previousWidget)||(a=e.previousWidget.columnIndex+e.previousWidget.cellFormat.columnSpan),l=i.i(n.isNullOrUndefined)(e.ownerTable)||i.i(n.isNullOrUndefined)(e.ownerTable.tableFormat)?0:s.a.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing);var m=0;a<e.columnIndex&&(m=s.a.convertPointToPixel(e.ownerTable.tableHolder.getPreviousSpannedCellWidth(a,e.columnIndex)),0===a&&(m-=l/2)),e.x=t.x+m+e.margin.left,e.y=t.y+e.margin.top+l,e.width=e.width-e.margin.left-e.margin.right,l>0&&(e.x+=l,1===e.ownerTable.tableHolder.columns.length?e.width-=2*l:0===e.columnIndex||e.columnIndex===e.ownerTable.tableHolder.columns.length-1?e.width-=2*l-l/2:e.width-=l);var v=s.a.convertPointToPixel(d.j.getCellLeftBorder(e).getLineWidth()),y=s.a.convertPointToPixel(d.j.getCellRightBorder(e).getLineWidth()),w=!1;e.leftBorderWidth=e.ownerTable.isBidiTable?y:v;var b="None"===e.cellFormat.borders.left.lineStyle,x="None"===e.cellFormat.borders.right.lineStyle;e.x+=b?e.leftBorderWidth>0?0:e.leftBorderWidth:0,e.width-=b?e.leftBorderWidth>0?0:e.leftBorderWidth:0;e.ownerTable.isBidiTable?e.cellIndex:(e.cellIndex,e.ownerRow.childWidgets.length);return(l>0||e.columnIndex===e.ownerTable.tableHolder.columns.length-1||e.index===e.containerWidget.childWidgets.length-1)&&(e.rightBorderWidth=e.ownerTable.isBidiTable?v:y,e.ownerTable.tableFormat.allowAutoFit||(e.width-=e.rightBorderWidth),this.isInsertTable()||(w=this.checkPreviousMargins(e.ownerTable))),e.margin.right+=x&&!w?0:e.rightBorderWidth,e.width<e.sizeInfo.minimumWidth/2&&!this.isInitialLoad&&(e.width=e.sizeInfo.minimumWidth/2),e},e.prototype.checkPreviousMargins=function(e){for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],n=0;n<i.childWidgets.length;n++){var r=i.childWidgets[i.childWidgets.length-1];if("None"!==r.cellFormat.borders.right.lineStyle)return!0}return!1},e.prototype.addWidgetToTable=function(e,t,r,o,s,a,l,c,p){var u=t[0],g=u.childWidgets.length,f=void 0,m=r.indexOf(o),v=[];if(m>0?f=r[m-1]:o.previousRenderedWidget instanceof d.z&&o.previousRenderedWidget.ownerTable.equals(o.ownerTable)&&(f=o.previousRenderedWidget),!i.i(n.isNullOrUndefined)(f)){if(u=f.containerWidget,g=u.childWidgets.indexOf(f)+1,Math.round(o.y)!==Math.round(f.y+f.height)){var y=t.indexOf(u);y+1>=t.length&&this.addTableWidget(e.clientActiveArea,t,!0),u=t[y+1],g=u.childWidgets.length}m>0&&(g=0)}if(this.updateRowHeightBySpannedCell(u,o,g),this.updateRowHeightByCellSpacing(t,o,e),o.containerWidget&&o.containerWidget!==u&&-1!==o.containerWidget.childWidgets.indexOf(o)&&o.containerWidget.childWidgets.splice(o.containerWidget.childWidgets.indexOf(o),1),-1===u.childWidgets.indexOf(o)&&(u.childWidgets.splice(g,0,o),p&&(u.bodyWidget.page.repeatHeaderRowTableWidget=!0)),o.containerWidget=u,!o.ownerTable.isInsideTable){if(s.length>0)i.i(n.isNullOrUndefined)(s)||(v=this.getFootnoteBody(s));else if(!i.i(n.isNullOrUndefined)(o))for(var w=0;w<o.childWidgets.length;w++)for(var b=o.childWidgets[w],x=0;x<b.childWidgets.length;x++)for(var C=this.getFootNoteWidgetsOf(b.childWidgets[x],!0),I=0;I<C.length;I++)v.splice(v.length,0,C[I]);v.length>0&&i.i(n.isNullOrUndefined)(v[0].containerWidget)?this.layoutFootnoteInSplittedRow(o,v):!i.i(n.isNullOrUndefined)(v)&&v.length>0&&void 0!==o.bodyWidget.previousRenderedWidget&&c!==o.bodyWidget.page.index&&v[0].containerWidget.page.index!==o.bodyWidget.page.index?this.moveFootNotesToPage(v,v[0].containerWidget.page.bodyWidgets[0],o.bodyWidget):this.isInitialLoad||i.i(n.isNullOrUndefined)(o.bodyWidget.page.footnoteWidget)||this.layoutfootNote(o.bodyWidget.page.footnoteWidget),s.length=0}u.height=u.height+o.height,this.viewer instanceof h.b&&(i.i(n.isNullOrUndefined)(u.containerWidget)||!(u.containerWidget.childWidgets.indexOf(u)>=0)||u.containerWidget instanceof d.x||(u.containerWidget.height+=o.height)),this.updateHeightForRowWidget(e,!1,t,r,o,!1,a,l),e.cutFromTop(o.y+o.height),this.viewer.clientActiveArea.height-=this.getFootNoteHeight(v),this.existFootnoteHeight=0},e.prototype.layoutFootnoteInSplittedRow=function(e,t){if(t&&t.length>0){i.i(n.isNullOrUndefined)(e.ownerTable.bodyWidget.page.footnoteWidget)&&this.addEmptyFootNoteToBody(e.ownerTable.bodyWidget);var r=e.ownerTable.bodyWidget.page.footnoteWidget;if(r){for(var o=0;o<t.length;o++)r.bodyWidgets.push(t[o]),t[o].containerWidget=r;this.layoutfootNote(r)}}},e.prototype.getFootNoteHeight=function(e){var t=0;if(Array.isArray(e))for(var i=0;i<e.length;i++)t+=this.getFootnoteHeightInternal(e[i]);else t=this.getFootnoteHeightInternal(e);return t},e.prototype.getFootnoteHeightInternal=function(e){for(var t=0,i=0;i<e.childWidgets.length;i++)t+=e.childWidgets[i].height,0===e.indexInOwner&&0===i&&(t+=e.containerWidget.margin.top);return t},e.prototype.updateRowHeightBySpannedCell=function(e,t,r){var o=1;if(0===e.childWidgets.length||0===r)return void this.updateRowHeight(t,t);for(var s=0;s<t.childWidgets.length;s++){var a=t.childWidgets[s];o=i.i(n.isNullOrUndefined)(a)||i.i(n.isNullOrUndefined)(a.cellFormat)?o:a.cellFormat.rowSpan,this.updateSpannedRowCollection(o,t,a)}if(!i.i(n.isNullOrUndefined)(t.ownerTable))for(var s=0;s<t.ownerTable.spannedRowCollection.length;s++)if(t.ownerTable.spannedRowCollection.keys[s]===t.index){for(var l=0;l<r;l++){var d=e.childWidgets[l];this.updateRowHeight(d,t)}t.ownerTable.spannedRowCollection.remove(t.ownerTable.spannedRowCollection.keys[s]);break}},e.prototype.updateRowHeight=function(e,t){for(var r=t.index,o=1,s=0;s<e.childWidgets.length;s++){var a=e.childWidgets[s];if(o=i.i(n.isNullOrUndefined)(a)||i.i(n.isNullOrUndefined)(a.cellFormat)?o:a.cellFormat.rowSpan,this.updateSpannedRowCollection(o,t,a),r-a.rowIndex==o-1){var l=a.y+a.height+a.margin.bottom-t.y;("Exactly"!==t.rowFormat.heightType||"Exactly"===t.rowFormat.heightType&&t.rowFormat.height>l)&&t.height<l&&(t.height=l)}}},e.prototype.updateSpannedRowCollection=function(e,t,r){e>1&&!i.i(n.isNullOrUndefined)(t.ownerTable)&&(t.ownerTable.spannedRowCollection.containsKey(t.index+e-1)||t.ownerTable.spannedRowCollection.add(t.index+e-1,t.index))},e.prototype.updateRowHeightByCellSpacing=function(e,t,i){t.ownerTable.tableFormat.cellSpacing>0&&e.length>1&&t.y===i.clientArea.y&&i instanceof h.b&&(t.height=t.height-s.a.convertPointToPixel(t.ownerTable.tableFormat.cellSpacing)/2)},e.prototype.isRowSpanEnd=function(e,t){for(var r=e.index,o=1,s=0;s<this.documentHelper.splittedCellWidgets.length;s++){var a=this.documentHelper.splittedCellWidgets[s];if(o=i.i(n.isNullOrUndefined)(a)||i.i(n.isNullOrUndefined)(a.cellFormat)?o:a.cellFormat.rowSpan,r-a.rowIndex==o-1)return!0}return!1},e.prototype.isVerticalMergedCellContinue=function(e){for(var t=0,i=0;i<e.childWidgets.length;i++){var n=e.childWidgets[i];if(t<n.columnIndex)return!0;t+=n.cellFormat.columnSpan}return t<e.ownerTable.tableHolder.columns.length},e.prototype.splitWidgets=function(e,t,i,n,r,o,s,a,l,d,h){if((!d||0!==a)&&this.isFirstLineFitForRow(t.clientArea.bottom,e)&&e.childWidgets.length>0){if(r=this.getSplittedWidgetForRow(t.clientArea.bottom,i,n,e,s,a,d,void 0,h),this.documentHelper.splittedCellWidgets.length>0||r!==e){if(o)for(var c=0;c<r.childWidgets.length;c++){var p=r.childWidgets[c];p.rowIndex!==r.index&&(r.childWidgets.splice(c,1),c--)}this.insertSplittedCellWidgets(t,i,r,e.index-1)}}else this.insertSplittedCellWidgets(t,i,r,e.index-1);return r},e.prototype.getSplittedWidgetForRow=function(e,t,r,o,s,a,l,h,c){var p=void 0,u=o.index;this.isRelayoutneed=!1;for(var g=!1,f=o.height,m=f,v=0,y=0;y<o.childWidgets.length;y++){var w=o.childWidgets[y],b=this.getSplittedWidget(e,!0,t,r,w,s,a,l,h);if(l&&!i.i(n.isNullOrUndefined)(b)&&0!==b.childWidgets.length&&f>w.height&&(f=w.height),s=[],i.i(n.isNullOrUndefined)(b)&&w===o.childWidgets[o.childWidgets.length-1]&&this.isVerticalMergedCellContinue(o)&&this.isRowSpanEnd(o,this.viewer)&&this.documentHelper.splittedCellWidgets.length>0&&c&&(p=this.getSplittedWidgetForSpannedRow(e,o,t,r,s),b=void 0),!i.i(n.isNullOrUndefined)(b)){if(b===w)return o;w.height>v&&(v=w.height),-1!==o.childWidgets.indexOf(b)&&o.childWidgets.splice(o.childWidgets.indexOf(b),1),o.height-=b.height,(0===y||o.height<v+w.margin.top+w.margin.bottom)&&(o.height=v+w.margin.top+w.margin.bottom),i.i(n.isNullOrUndefined)(p)&&(p=new d.z,p.containerWidget=o.containerWidget,p.index=o.index,p.rowFormat=o.rowFormat,p.isRenderBookmarkEnd=o.isRenderBookmarkEnd,this.updateWidgetLocation(o,p),r.push(p));var x=1;x=i.i(n.isNullOrUndefined)(b)||i.i(n.isNullOrUndefined)(b.cellFormat)?x:b.cellFormat.rowSpan,u-b.rowIndex==x-1&&p.height<b.height+b.margin.top+b.margin.bottom?p.height=b.height+b.margin.top+b.margin.bottom:("Exactly"===o.rowFormat.heightType||"AtLeast"===o.rowFormat.heightType&&p.height<o.rowFormat.height)&&(p.height=o.rowFormat.height),p.childWidgets.push(b),b.containerWidget=p,this.isRelayoutneed=!0;for(var C=y;C>0&&!g;){var I=o.childWidgets[C-1];b=this.getSplittedWidget(e,!0,t,r,I,s),p.childWidgets.splice(0,0,b),b.containerWidget=p,C--}g=!0}}if(l&&f!==m){for(var y=0;y<o.childWidgets.length;y++)o.childWidgets[y].height=f;o.height=f}return p},e.prototype.getSplittedWidgetForSpannedRow=function(e,t,r,o,s){for(var a=void 0,l=void 0,h=!1,c=0;c<this.documentHelper.splittedCellWidgets.length&&(l=this.documentHelper.splittedCellWidgets[c],!(t.childWidgets.length<l.index));c++){i.i(n.isNullOrUndefined)(a)&&(a=new d.z,a.containerWidget=t.containerWidget,a.index=t.index,a.rowFormat=t.rowFormat,a.isRenderBookmarkEnd=t.isRenderBookmarkEnd,this.updateWidgetLocation(t,a),o.push(a)),a.childWidgets.push(l),l.containerWidget=a,this.isRelayoutneed=!0;for(var p=this.documentHelper.splittedCellWidgets[c].index;p>0&&!h;){var u=t.childWidgets[p-1];l=this.getSplittedWidget(e,!0,r,o,u,s),a.childWidgets.splice(0,0,l),l.containerWidget=a,p--}h=!0}return a},e.prototype.getFootNoteHeightInLine=function(e){for(var t=0,i=0;i<e.children.length;i++){var n=e.children[i];n instanceof d.f&&(t+=this.getFootNoteHeight(n.bodyWidget))}return t},e.prototype.getFootnoteFromLine=function(e,t){for(var i=0;i<e.children.length;i++)e.children[i]instanceof d.f&&t.push(e.children[i])},e.prototype.updateWidgetsToTable=function(e,t,r,o,a,l,c){var p=r.bodyWidget.page.index,u=this.getRowHeight(r,[r]),g=this.viewer,f=r.rowFormat.isHeader,m=void 0,v=r.rowFormat.allowBreakAcrossPages,y=r.rowFormat.heightType,w=0,b=0,x=r,C=!1,I=this.layoutedFootnoteElement,F=!1;void 0!==x.bodyWidget.page.footnoteWidget?(this.footHeight=x.bodyWidget.page.footnoteWidget.height,0===this.footnoteHeight&&(this.footnoteHeight=this.footHeight)):this.footHeight=0,r.ownerTable.continueHeader&&!f&&(r.ownerTable.continueHeader=!1);var k=r.ownerTable.isInsideTable,P=!1;for(w=i.i(n.isNullOrUndefined)(r.ownerTable)||i.i(n.isNullOrUndefined)(r.ownerTable.tableFormat)?0:s.a.convertPointToPixel(r.ownerTable.tableFormat.cellSpacing);b<t.length;){if(b=t.length,this.isRowSpanEnd(r,g)&&"Exactly"===r.rowFormat.heightType&&1===this.documentHelper.splittedCellWidgets.length&&(this.documentHelper.splittedCellWidgets=[]),!c&&(r.ownerTable.isInsideTable||0===this.documentHelper.splittedCellWidgets.length&&x.y+x.height+w+this.footnoteHeight<=g.clientArea.bottom))!this.isVerticalMergedCellContinue(r)||x.y!==g.clientArea.y&&x.y!==this.viewer.clientArea.y+x.ownerTable.headerHeight||this.insertSplittedCellWidgets(g,e,x,x.index-1),this.addWidgetToTable(g,e,t,x,I,void 0,k,p,F),this.documentHelper.splittedCellWidgets.length>0&&i.i(n.isNullOrUndefined)(t[t.length-1].nextRow)&&(b--,P=!0),k=!1;else{if(I=[],k=!1,this.documentHelper.splittedCellWidgets.length>0&&x.y+x.height+this.footHeight<=g.clientArea.bottom){if(!this.isRowSpanEnd(r,g)){!this.isVerticalMergedCellContinue(r)||x.y!==g.clientArea.y&&x.y!==this.viewer.clientArea.y+x.ownerTable.headerHeight||this.insertSplittedCellWidgets(g,e,x,x.indexInOwner-1),this.addWidgetToTable(g,e,t,x,I);continue}}var T=x,S=e[e.length-1];if(c||u+x.y+this.footHeight>g.clientArea.bottom)if(!v||f&&r.ownerTable.continueHeader||"AtLeast"===y&&s.a.convertPointToPixel(r.rowFormat.height)<g.clientArea.bottom){if(("AtLeast"===y&&s.a.convertPointToPixel(r.rowFormat.height)<g.clientActiveArea.height&&v||"Exactly"!==y&&x.y===g.clientArea.y||"Auto"===y&&v)&&(T=this.splitWidgets(x,g,e,t,T,P,I,a,l,c),i.i(n.isNullOrUndefined)(T)&&x.y===g.clientArea.y?this.addWidgetToTable(g,e,t,x,I):i.i(n.isNullOrUndefined)(T)&&"AtLeast"===y&&x.containerWidget.lastChild!==x&&(T=x)),"Exactly"===y&&x.y===g.clientArea.y&&(this.addWidgetToTable(g,e,t,x,I),b++),f&&r.ownerTable.continueHeader){r.ownerTable.header=!1,r.ownerTable.headerHeight=0;var W=void 0;if(g instanceof h.b&&(W=this.documentHelper.pages),!i.i(n.isNullOrUndefined)(W))for(var N=0;N<W.length;N++)!W[N].repeatHeaderRowTableWidget||i.i(n.isNullOrUndefined)(W[N].bodyWidgets[0].firstChild)||W[N].bodyWidgets[0].firstChild instanceof d.u&&W[N].bodyWidgets[0].firstChild.header||(W[N].repeatHeaderRowTableWidget=!1,r.ownerTable.continueHeader=!1)}}else"Auto"!==y&&"AtLeast"!==y||!v?"Exactly"===y&&x.y===g.clientArea.y&&(this.addWidgetToTable(g,e,t,x,I),b++):s.a.convertPointToPixel(r.rowFormat.height)>g.clientArea.bottom&&x.y!==g.clientArea.y||(T=this.splitWidgets(x,g,e,t,T,P,I,a,l,c),i.i(n.isNullOrUndefined)(T)&&x.y===g.clientArea.y&&this.addWidgetToTable(g,e,t,x,I));else{var H=!1,E=0;if(i.i(n.isNullOrUndefined)(x.ownerTable.headerHeight)||(E=x.ownerTable.headerHeight),this.isVerticalMergedCellContinue(r)&&(v||(H=x.y===g.clientArea.y||x.y===this.viewer.clientArea.y+E))){if(H)this.insertSplittedCellWidgets(g,e,T,x.indexInOwner-1);else if(T=this.splitWidgets(x,g,e,t,T,P,I,void 0,void 0,void 0,!0),i.i(n.isNullOrUndefined)(T)){if(H=x.y===g.clientArea.y||x.y===this.viewer.clientArea.y+E){this.insertSplittedCellWidgets(g,e,x,x.indexInOwner-1),b--;continue}this.isRowSpanEnd(r,g)&&(T=x)}}else P&&!v?T=this.splitWidgets(x,g,e,t,T,P,I):this.isRowSpanEnd(r,g)&&!v&&("AtLeast"===y&&r.ownerTable.spannedRowCollection.keys.length>0&&(T=this.splitWidgets(x,g,e,t,T,P,I,a,l,c,!0)),i.i(n.isNullOrUndefined)(T)&&this.addWidgetToTable(g,e,t,x,I))}if(!i.i(n.isNullOrUndefined)(T)&&(i.i(n.isNullOrUndefined)(this.documentHelper.owner.editor)||this.documentHelper.owner.editor&&!this.documentHelper.owner.editor.isTableInsert)&&!(T.bodyWidget.containerWidget instanceof d.a)){if(T!==x){this.addWidgetToTable(g,e,t,x,I,x.nextRow,void 0,void 0,F),this.updateWidgetsToPage(e,t,r.ownerTable,o,x.nextRow);e.indexOf(x.containerWidget)+1>=e.length&&this.addTableWidget(g.clientActiveArea,e,!0),x=T}else{if(r.index>0)if(this.updateWidgetsToPage(e,t,r.ownerTable,o,r),r.previousRenderedWidget instanceof d.z){var O=r.previousRenderedWidget;if(s.a.round(x.y,2)===s.a.round(O.y+O.height,2)){var _=e.indexOf(O.containerWidget);_+1>=e.length&&this.addTableWidget(g.clientActiveArea,e,!0)}else this.addTableWidget(g.clientActiveArea,e,!0)}else this.addTableWidget(g.clientActiveArea,e,!0);else if("Exactly"===y&&u+x.y+this.footHeight<g.clientArea.bottom&&x.y>=g.clientArea.y){this.addWidgetToTable(g,e,t,x,I),b++;continue}C=!0,b--}S=e[e.length-1];var B=r,L=!1,R=(r.ownerTable.containerWidget.index,!1),A=void 0,D=void 0;D=C&&1===e.length?e[e.length-1]:e[e.length-2];var U=!0;if(C&&1===t.length){var M=this.alignBlockElement(r);if(!i.i(n.isNullOrUndefined)(M.node)){var V=M.node;if(V instanceof d.z&&0===V.indexInOwner)e.length>1&&0===e[e.length-1].childWidgets.length&&(e.pop(),S=e[e.length-1],S.height=0);else if(M.node instanceof d.g){var z=this.splitParagraph(M.node,parseInt(M.position.index,10));D=z,e.length>1&&0===e[e.length-1].childWidgets.length&&(e.pop(),S=e[e.length-1]),U=!1}V instanceof d.z&&(R=0===V.indexInOwner,B=V,B.ownerTable.equals(r.ownerTable)||(D=B.ownerTable,U=!1)),L=!0}}A=this.moveBlocksToNextPage(D instanceof d.g?D.previousWidget:L&&R?i.i(n.isNullOrUndefined)(D.previousWidget)?D:D.previousWidget:D,L);var j=e[e.length-1];if(C&&U&&0===B.index&&j.containerWidget&&-1!==j.containerWidget.childWidgets.indexOf(j)&&j.containerWidget.childWidgets.splice(j.containerWidget.childWidgets.indexOf(j),1),U&&(-1!==A.childWidgets.indexOf(j)&&A.childWidgets.splice(A.childWidgets.indexOf(j),1),A.childWidgets.unshift(j),this.shiftFloatingItemsFromTable(j,A)),j.containerWidget=A,C&&B.index>0||t.length>1){var q=C?t[t.length-1]:t[t.length-2];L&&(q=B),this.moveNextWidgetsToTable(e,q,!C),B=r}L&&this.updateClientPositionForBlock(U?j:D,r),C=!1;var G=!1,K=this.documentHelper.viewer.clientArea.bottom-x.bottomBorderWidth-w;if(B.ownerTable.header&&(T.x=T.x,T.y=this.viewer.clientArea.y+S.headerHeight,this.updateChildLocationForRow(T.y,T),G=this.isFirstLineFitForRow(K,T)),G&&B.ownerTable.header&&!L){g instanceof h.b&&(x.bodyWidget.page.repeatHeaderRowTableWidget=!0,F=!0),g.updateClientAreaForBlock(B.ownerTable,!0,e),T.x=T.x,T.y=S.y+B.ownerTable.headerHeight;var Z=w/2;this.updateChildLocationForRow(S.y+B.ownerTable.headerHeight-Z,T,S.containerWidget)}else{if(g.updateClientAreaForBlock(B.ownerTable,!0,e),T.bodyWidget.sectionFormat.columns.length>1){var X=new d.t(this.viewer.clientArea.x,this.viewer.clientArea.y,this.viewer.clientArea.width,this.viewer.clientArea.height),J=new d.t(this.viewer.clientActiveArea.x,this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.width,this.viewer.clientActiveArea.height);T.x=this.viewer.clientActiveArea.x,T.y=this.viewer.clientActiveArea.y;for(var Y=this.getMaxTopCellMargin(T),Q=this.getMaxBottomCellMargin(T),N=0;N<T.childWidgets.length;N++){var $=T.childWidgets[N];$.height=0,this.addTableCellWidget($,this.viewer.clientActiveArea,Y+T.topBorderWidth,Q+T.bottomBorderWidth),this.viewer.updateClientAreaForCell($,!0);for(var ee=0;ee<$.childWidgets.length;ee++){var te=$.childWidgets[ee];g.updateClientAreaForBlock(te,!0),te.containerWidget=$,this.layoutBlock(te,0),g.updateClientAreaForBlock(te,!1)}this.viewer.updateClientAreaForCell($,!1)}this.viewer.clientActiveArea=J,this.viewer.clientArea=X}T.x=T.x,T.y=S.y;var Z=w/2;this.updateChildLocationForRow(S.y-Z,T,S.containerWidget,!0)}if(U&&this.shiftedFloatingItemsFromTable.length>0){for(var N=0;N<this.shiftedFloatingItemsFromTable.length;N++){var ie=this.shiftedFloatingItemsFromTable[N],ne=this.getFloatingItemPoints(ie);ie.y=ne.y,ie.x=ne.x,ie instanceof d.s&&this.updateChildLocationForCellOrShape(ie.y,ie)}this.shiftedFloatingItemsFromTable=[]}}P=!1}if(f&&(r.ownerTable.continueHeader&&(r.ownerTable.header=!0,r.ownerTable.headerHeight=u+r.ownerTable.headerHeight),m=this.getHeader(r.ownerTable),!i.i(n.isNullOrUndefined)(m)&&r.index===m.index)){var E=this.getHeaderHeight(r.ownerTable,r,t);if((E>r.ownerTable.headerHeight||E>r.ownerTable.headerHeight)&&(r.ownerTable.headerHeight=E),r.ownerTable.headerHeight>g.clientArea.height){r.ownerTable.header=!1,r.ownerTable.continueHeader=!1,r.ownerTable.headerHeight=0;for(var W=this.documentHelper.pages,N=0;N<W.length;N++)W[N].repeatHeaderRowTableWidget&&(W[N].repeatHeaderRowTableWidget=!1)}}c=!1,e.length>2&&r.ownerTable.header&&x.height<g.clientActiveArea.bottom&&!g.documentHelper.currentRenderingPage.repeatHeaderRowTableWidget&&(g.documentHelper.currentRenderingPage.repeatHeaderRowTableWidget=!0)}},e.prototype.getHeader=function(e){var t=void 0,i=!0;e=e.getSplitWidgets()[0];for(var n=0;n<e.childWidgets.length;n++){var r=e.childWidgets[n];if(r.rowFormat.isHeader?t=r:i=!1,!i)break}return t},e.prototype.getHeaderHeight=function(e,t,i){var n=0;if(t.ownerTable.childWidgets.length>0&&e.childWidgets[0].rowFormat.isHeader)for(var r=0;r<e.childWidgets.length;r++){var o=e.childWidgets[r];if(!o.rowFormat.isHeader)break;n+=o.height}return n},e.prototype.updateWidgetToRow=function(e){var t=e.ownerRow;if(e.containerWidget=t,!i.i(n.isNullOrUndefined)(e.ownerRow)&&"Exactly"!==e.ownerRow.rowFormat.heightType&&s.a.convertPointToPixel(e.ownerRow.rowFormat.height)>0&&0===e.cellIndex&&(t.height=t.height+s.a.convertPointToPixel(e.ownerRow.rowFormat.height)),1===e.cellFormat.rowSpan){var r=void 0;r="Exactly"===t.rowFormat.heightType?e.height+e.margin.bottom:e.height+e.margin.top+e.margin.bottom,t.height-s.a.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing)<r&&(t.height=r+s.a.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing))}},e.prototype.updateHeightForRowWidget=function(e,t,i,n,r,o,a,l){for(var c=0;c<r.childWidgets.length;c++){var p=0,u=void 0;u=r.childWidgets[c];var g=1;if(g=u.cellFormat.rowSpan,p=s.a.convertPointToPixel(u.ownerTable.tableFormat.cellSpacing),g>1){var f=r.containerWidget.childWidgets.indexOf(r),m=f+g-1-(r.index-u.rowIndex);!l&&(e.clientArea.bottom<u.y+u.height+u.margin.bottom||m>=f+1)&&(1===n.length||n.length>=1&&r===n[n.length-1])&&this.splitSpannedCellWidget(u,i,n,e);var v=r;if(m>0)if(m<r.containerWidget.childWidgets.length){var y=r.containerWidget.childWidgets[m];y instanceof d.z&&(v=y)===a&&(v=r)}else v=r.containerWidget.childWidgets[r.containerWidget.childWidgets.length-1];u.y+u.height+u.margin.bottom<v.y+v.height?u.height=v.y+v.height-u.y-u.margin.bottom:o&&v&&0!==v.y&&0!==v.height&&u.y+u.height+u.margin.bottom>v.y+v.height&&("Exactly"!==v.rowFormat.heightType||"Exactly"===v.rowFormat.heightType&&v.rowFormat.height>u.y+u.height+u.margin.bottom-v.y?v.height=u.y+u.height+u.margin.bottom-v.y:u.height=v.y-u.y+v.height)}else p>0&&i.length>1&&r.y===e.clientArea.y&&e instanceof h.b&&(p/=2),u.height=r.height-u.margin.top-u.margin.bottom-p;this.updateHeightForCellWidget(e,i,n,u);for(var w=r.containerWidget;w.containerWidget instanceof d.w;)w=w.containerWidget;var b=void 0;w instanceof d.o&&(b=w.page),(e instanceof h.b&&-1!==e.visiblePages.indexOf(b)||t)&&this.updateCellVerticalPosition(u,!1,u.ownerTable.isInsideTable)}},e.prototype.updateHeightForCellWidget=function(e,t,i,n){for(var r=0;r<n.childWidgets.length;r++)n.childWidgets[r]instanceof d.u&&this.updateHeightForTableWidget(t,i,n.childWidgets[r])},e.prototype.getRowHeight=function(e,t){var i=0;if("Exactly"===e.rowFormat.heightType)i=e.rowFormat.height;else{for(var n=0;n<t.length;n++)t[n]instanceof d.z&&(i=t[n].height+i);i=Math.max(i,e.rowFormat.height)}return i},e.prototype.splitSpannedCellWidget=function(e,t,r,o){var s=this.getSplittedWidget(o.clientArea.bottom,!1,t,r,e,void 0,void 0,void 0,void 0,!0);i.i(n.isNullOrUndefined)(s)||(this.documentHelper.splittedCellWidgets.push(s),s.isSplittedCell=!0)},e.prototype.insertSplittedCellWidgets=function(e,t,r,o){if(!i.i(n.isNullOrUndefined)(r)){var a=r.x,l=0,d=0,h=0,c=!1;l=s.a.convertPointToPixel(r.ownerTable.tableHolder.tableWidth);for(var p=0;p<r.childWidgets.length;p++){var u=r.childWidgets[p],g="None"===u.cellFormat.borders.right.lineStyle;if(h=i.i(n.isNullOrUndefined)(u.ownerTable)||i.i(n.isNullOrUndefined)(u.ownerTable.tableFormat)?0:s.a.convertPointToPixel(u.ownerTable.tableFormat.cellSpacing),Math.round(a)<Math.round(u.x-u.margin.left)){if(this.insertRowSpannedWidget(r,e,a,p)){p--;continue}var f=r.childWidgets.length;if(this.insertEmptySplittedCellWidget(r,t,a,p,o),f<r.childWidgets.length){if(p===d)break;p--;continue}}if(a+=u.margin.left+u.width+u.margin.right,(h>0||u.columnIndex===u.ownerTable.tableHolder.columns.length-1||u.index===u.containerWidget.childWidgets.length-1)&&(u.ownerTable.tableFormat.allowAutoFit||(a+=u.rightBorderWidth),this.isInsertTable()||(c=this.checkPreviousMargins(u.ownerTable))),a-=g&&!c?0:u.rightBorderWidth,d++,p===r.childWidgets.length-1&&Math.round(a)<Math.round(r.x+l)){if(this.insertRowSpannedWidget(r,e,a,p+1))continue;this.insertEmptySplittedCellWidget(r,t,a,p+1,o)}else;}if((i.i(n.isNullOrUndefined)(r.childWidgets)||0===r.childWidgets.length)&&this.documentHelper.splittedCellWidgets.length>0)for(var m=0;m<this.documentHelper.splittedCellWidgets.length;m++){var v=this.documentHelper.splittedCellWidgets[m];if(Math.round(a)<=Math.round(v.x-v.margin.left)){if(this.insertRowSpannedWidget(r,e,a,m)){m--;continue}var y=r.childWidgets.length;if(this.insertEmptySplittedCellWidget(r,t,a,m,o),y<r.childWidgets.length){m--;continue}}if(a+=v.margin.left+v.width+v.margin.right,m===r.childWidgets.length-1&&Math.round(a)<Math.round(r.x+l)){if(this.insertRowSpannedWidget(r,e,a,m+1))continue;this.insertEmptySplittedCellWidget(r,t,a,m+1,o)}else;}this.documentHelper.splittedCellWidgets.length>0&&(this.documentHelper.splittedCellWidgets=[])}},e.prototype.insertRowSpannedWidget=function(e,t,i,n){var r=0;e.ownerTable.tableFormat.cellSpacing>0&&(r=s.a.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing));for(var o=0;o<this.documentHelper.splittedCellWidgets.length;o++){var a=this.documentHelper.splittedCellWidgets[o];if(Math.round(i)===Math.round(a.x-a.margin.left))return e.childWidgets.splice(n,0,a),a.containerWidget=e,a.height>e.height&&(e.height=a.height),a.y!==e.y+a.margin.top+r&&this.updateChildLocationForRow(e.y,e),this.documentHelper.splittedCellWidgets.splice(o,1),!0}return!1},e.prototype.insertEmptySplittedCellWidget=function(e,t,r,o,s){for(var a,l=t[t.length-1],d=t.length-1;d>=0;d--)for(var h=t[d],c=h.childWidgets.length-1;c>=0;c--){var p=h.childWidgets[c];if(p.index===s){a=p;break}}a&&(l=a.ownerTable,s=a.indexInOwner);for(var u=s;u>=0;u--)for(var g=l.childWidgets[u],f=g.x,d=0;d<g.childWidgets.length;d++){var m=1,v=g.childWidgets[d];if(Math.round(r)===Math.round(f)&&(m=i.i(n.isNullOrUndefined)(v)||i.i(n.isNullOrUndefined)(v.cellFormat)?m:v.cellFormat.rowSpan)>1){var y=this.createCellWidget(v);return e.childWidgets.splice(o,0,y),y.containerWidget=e,void this.updateChildLocationForRow(e.y,e)}f+=v.margin.left+v.width+v.margin.right}},e.prototype.getSplittedWidget=function(e,t,r,o,s,a,l,h,c,p){var u=void 0,g=0;if(h||s.y+s.height>e-this.footHeight-s.margin.bottom){for(var f=0;f<s.ownerRow.childWidgets.length;f++){var m=s.ownerRow.childWidgets[f];if(m.y+m.height<e-this.footHeight-m.margin.bottom)for(var v=0;v<m.childWidgets.length;v++)if(m.childWidgets[v]instanceof d.g)for(var y=m.childWidgets[v],w=0;w<y.childWidgets.length;w++){var b=y.childWidgets[w],x=this.getFootNoteHeightInLine(b);this.existFootnoteHeight+=x,g+=x}}var C=0;s.ownerTable.isInsideTable&&(C=c);for(var I=!1,f=0;f<s.childWidgets.length;f++)if(s.childWidgets[f]instanceof d.g){var y=s.childWidgets[f],F=this.getSplittedWidgetForPara(e-s.margin.bottom,y,a,l,h,C,I);if(h&&(C+=y.childWidgets.length),!i.i(n.isNullOrUndefined)(F)){if(I=!0,0===f&&F===y&&!p)return t&&this.isRelayoutneed?u=this.createCellWidget(s):s;-1!==s.childWidgets.indexOf(F)&&(s.childWidgets.splice(s.childWidgets.indexOf(F),1),f--),s.height-=F.height,i.i(n.isNullOrUndefined)(u)&&(u=this.createCellWidget(s)),u.height+=F.height,u.childWidgets.push(F),F.containerWidget=u}}else{var k=s.childWidgets[f],P=[k];if(h||e-s.margin.bottom<k.y+k.height){var T=k.height,S=this.getSplittedWidgetForTable(e-s.margin.bottom,P,k,a,l,h,C);if(i.i(n.isNullOrUndefined)(S)&&!k.childWidgets[0].rowFormat.allowBreakAcrossPages&&(S=k),!i.i(n.isNullOrUndefined)(S)){if(0===f&&S===k)return s;-1!==s.childWidgets.indexOf(S)?(s.childWidgets.splice(s.childWidgets.indexOf(S),1),f--,s.height-=S.height):s.height-=T-k.height,i.i(n.isNullOrUndefined)(u)&&(u=this.createCellWidget(s)),u.height+=S.height,u.childWidgets.push(S),S.containerWidget=u}}}}return this.existFootnoteHeight-=g,i.i(n.isNullOrUndefined)(u)&&t&&this.isRelayoutneed&&(u=this.createCellWidget(s)),u},e.prototype.getListLevelPattern=function(e){switch(e){case 0:return"Arabic";case 1:return"LowLetter";case 2:return"LowRoman";case 3:return"UpLetter";case 4:return"UpRoman";case 5:return"Ordinal";case 6:return"Number";case 7:return"OrdinalText";case 8:return"LeadingZero";case 9:return"Bullet";case 10:return"FarEast";case 11:return"Special";default:return"None"}},e.prototype.createCellWidget=function(e){var t=new d.j;return t.cellFormat=e.cellFormat,t.index=e.index,t.rowIndex=e.rowIndex,t.columnIndex=e.columnIndex,t.containerWidget=e.containerWidget,this.updateWidgetLocation(e,t),t.margin=e.margin,t.leftBorderWidth=e.leftBorderWidth,t.rightBorderWidth=e.rightBorderWidth,t},e.prototype.createTableWidget=function(e){var t=new d.u;return e.header&&(t.header=e.header,t.headerHeight=e.headerHeight),t.index=e.index,t.tableFormat=e.tableFormat,t.tableHolder=e.tableHolder,t.footnoteElement=e.footnoteElement,t.isGridUpdated=e.isGridUpdated,t.wrapTextAround=e.wrapTextAround,t.positioning=e.positioning,t.isContainInsideTable=e.isContainInsideTable,t.isBidiTable=e.isBidiTable,t},e.prototype.getSplittedWidgetForPara=function(e,t,r,o,s,a,l){for(var h=t.y,c=void 0,p=!1,u=0;u<t.childWidgets.length;u++){var g=t.childWidgets[u],f=this.getFootNoteHeightInLine(g);if(f+=this.existFootnoteHeight,!i.i(n.isNullOrUndefined)(r))for(var m=0;m<r.length;m++)f+=this.getFootNoteHeight(r[m].bodyWidget);var v=0;if(v=g.children[0]instanceof d.v?g.children[0].height:g.height,s&&a>=o||e<h+f+v||l){if(t.paragraphFormat.keepLinesTogether&&(0!==t.index||0===t.index&&!i.i(n.isNullOrUndefined)(t.associatedCell.ownerRow.previousWidget))?(p=!0,u=0,g=t.childWidgets[0]):t.paragraphFormat.widowControl&&1===u&&(p=!0,u=0,g=t.childWidgets[0]),0===u){if(g.paragraph.containerWidget instanceof d.j&&!p&&!s&&g.paragraph.containerWidget.y===t.y){h+=g.height;continue}c=t;break}-1!==t.childWidgets.indexOf(g)&&(t.childWidgets.splice(t.childWidgets.indexOf(g),1),u--),t.height-=g.height,i.i(n.isNullOrUndefined)(c)?(c=new d.g,c.characterFormat=t.characterFormat,c.paragraphFormat=t.paragraphFormat,c.index=t.index,this.updateWidgetLocation(t,c),c.height=g.height):c.height+=g.height,c.childWidgets.push(g),g.paragraph=c}this.getFootnoteFromLine(g,r),h+=g.height,a++}return c},e.prototype.getSplittedWidgetForTable=function(e,t,r,o,s,a,l){for(var d=r.y,h=void 0,c=0;c<r.childWidgets.length;c++){var p=void 0;p=r.childWidgets[c];var u=p.height;if(a||e<d+u||!i.i(n.isNullOrUndefined)(h)){var g=void 0,f=!0;if(i.i(n.isNullOrUndefined)(p)||i.i(n.isNullOrUndefined)(p.rowFormat)||(f=p.rowFormat.allowBreakAcrossPages),f?g=i.i(n.isNullOrUndefined)(h)&&this.isFirstLineFitForRow(e,p)?this.getSplittedWidgetForRow(e,t,[p],p,o,s,a,l):p:i.i(n.isNullOrUndefined)(r.containerWidget.containerWidget.previousWidget)&&this.isFirstLineFitForRow(e,p)||r.isInsideTable&&!r.containerWidget.containerWidget.rowFormat.allowBreakAcrossPages?g=this.getSplittedWidgetForRow(e,t,[p],p,o,s,a,l):i.i(n.isNullOrUndefined)(r.containerWidget.containerWidget.previousWidget)||(g=p),!i.i(n.isNullOrUndefined)(g)){if(0===c&&g===p)return r;-1!==r.childWidgets.indexOf(g)?(r.childWidgets.splice(r.childWidgets.indexOf(g),1),c--,r.height-=g.height):r.height-=u-p.height,i.i(n.isNullOrUndefined)(h)?(h=this.createTableWidget(r),this.updateWidgetLocation(r,h),h.height=g.height):h.height+=g.height,h.childWidgets.push(g),g.containerWidget=h}}d+=p.height}return h},e.prototype.isFirstLineFitForPara=function(e,t){var i=t.childWidgets[0],n=i.height,r=this.getFootNoteHeightInLine(i);r+=this.existFootnoteHeight,n+=r;var o=i.paragraph.containerWidget;if(t.paragraphFormat.keepLinesTogether&&Math.floor(o.containerWidget.y)!==this.viewer.clientArea.y&&(n=t.height),this.documentHelper.isFirstLineFitInShiftWidgets){if(this.viewer.clientActiveArea.y===this.viewer.clientArea.y&&t.y+n>=e)return!0}else if(!o.ownerTable.isInsideTable&&o.containerWidget.y===this.viewer.clientArea.y&&t.y+n>=e)return!0;return t.y+n<=e},e.prototype.isFirstLineFitForTable=function(e,t){var r=void 0,o=!1;return r=t.childWidgets[0],i.i(n.isNullOrUndefined)(r)||(o=this.isFirstLineFitForRow(e,r)),o},e.prototype.isFirstLineFitForRow=function(e,t){for(var i=0;i<t.childWidgets.length;i++){var n=t.childWidgets[i];if(!this.isFirstLineFitForCell(e,n))return!1}return!0},e.prototype.isFirstLineFitForCell=function(e,t){if(0===t.childWidgets.length)return!0;if(t.childWidgets[0]instanceof d.g){var i=t.childWidgets[0];return this.isFirstLineFitForPara(e-t.margin.bottom,i)}var n=t.childWidgets[0];return this.isFirstLineFitForTable(e-t.margin.bottom,n)},e.prototype.updateWidgetLocation=function(e,t){t.x=e.x,t.y=e.y,t.width=e.width},e.prototype.updateChildLocationForTable=function(e,t,i,n){for(var r=0;r<t.childWidgets.length;r++){var o=t.childWidgets[r];o.y=e,this.updateChildLocationForRow(e,o,i,n),e+=o.height}},e.prototype.updateChildLocationForRow=function(e,t,i,n){var r=0;t.ownerTable.tableFormat.cellSpacing>0&&(r=s.a.convertPointToPixel(t.ownerTable.tableFormat.cellSpacing));for(var o=0;o<t.childWidgets.length;o++){var a=t.childWidgets[o];a.index=a.cellIndex,a.y=e+a.margin.top+r,this.updateChildLocationForCellOrShape(a.y,a,i,n)}},e.prototype.updateChildLocationForCellOrShape=function(e,t,r,o,s){var a=t;t instanceof d.s&&(a=t.textFrame);for(var l=0;l<a.childWidgets.length;l++){var h=!1;if(a.childWidgets[l]instanceof d.u&&a.childWidgets[l].wrapTextAround&&!i.i(n.isNullOrUndefined)(a.childWidgets[l+1])&&a.childWidgets[l+1].y>a.childWidgets[l].y&&a.childWidgets[l+1].y<a.childWidgets[l].y+a.childWidgets[l].height&&(h=!0),!i.i(n.isNullOrUndefined)(a.childWidgets[l].floatingElements)&&a.childWidgets[l].floatingElements.length>0&&o&&(this.viewer.clientActiveArea.height=this.viewer.clientActiveArea.bottom-e,this.viewer.clientActiveArea.y=e),a.childWidgets[l].x=a.childWidgets[l].x,a.childWidgets[l].y=e,t instanceof d.s&&"Inline"==t.textWrappingStyle&&s&&this.updateShapeYPosition(t),!i.i(n.isNullOrUndefined)(r)&&t instanceof d.j&&a.childWidgets[l]instanceof d.g){var c=a.childWidgets[l],p=t.ownerTable.bodyWidget.floatingElements,u=!1;if(t.ownerTable.bodyWidget!==r||i.i(n.isNullOrUndefined)(t.ownerTable.previousSplitWidget)||(p=t.ownerTable.previousSplitWidget.bodyWidget.floatingElements,u=!0),c.floatingElements.length>0)for(var g=0;g<c.floatingElements.length;g++){var f=c.floatingElements[g],m=this.viewer.clientActiveArea.x;if(this.viewer.clientActiveArea.x=f.x,this.layoutShape(f),this.viewer.clientActiveArea.x=m,!i.i(n.isNullOrUndefined)(c.firstChild))for(var v=c.childWidgets[0],y=0;y<v.children.length;y++){var w=v.children[y];w instanceof d.v&&"Inline"==w.textWrappingStyle&&(this.adjustPosition(w,t.ownerTable.bodyWidget),e=c.y)}if(p.indexOf(f)>-1&&"Inline"!==f.textWrappingStyle){if(!u){r.floatingElements.push(f);var b=r.previousSplitWidget;i.i(n.isNullOrUndefined)(b)||-1===b.floatingElements.indexOf(f)||b.floatingElements.splice(b.floatingElements.indexOf(f),1)}-1!==p.indexOf(f)&&p.splice(p.indexOf(f),1)}}}a.childWidgets[l]instanceof d.u&&this.updateChildLocationForTable(e,a.childWidgets[l],r,o),h||(e+=a.childWidgets[l].height)}},e.prototype.updateCellVerticalPosition=function(e,t,i){var n=e.ownerTable.containerWidget;if(n instanceof d.h||n instanceof d.i||i){var r=this.getDisplacement(e,t);this.updateCellContentVerticalPosition(e,r,t)}},e.prototype.updateCellContentVerticalPosition=function(e,t,i){if(0!==t)for(var n=e.y+t,r=0;r<e.childWidgets.length;r++){if(e.childWidgets[r]instanceof d.g){var o=e.childWidgets[r];o.y=n,this.updateShapeInsideCell(o,t)}else this.updateTableWidgetLocation(e.childWidgets[r],n,i);n+=e.childWidgets[r].height}},e.prototype.updateShapeInsideCell=function(e,t){for(var i=0;i<e.floatingElements.length;i++){var n=e.floatingElements[i];n.y+=t,n instanceof d.s&&this.updateChildLocationForCellOrShape(n.y,n)}},e.prototype.updateTableWidgetLocation=function(e,t,i){e.y=t+=e.topBorderWidth;for(var n=0;n<e.childWidgets.length;n++){var r=e.childWidgets[n];r.y=t;for(var o=0;o<r.childWidgets.length;o++){var s=r.childWidgets[o];s.y=t+s.margin.top+0,this.updateCellVerticalPosition(s,i,!0)}t+=r.height}return t},e.prototype.getDisplacement=function(e,t){var r=0,o=e.containerWidget,s=e.margin.top+e.margin.bottom;r=!i.i(n.isNullOrUndefined)(e.cellFormat)&&e.cellFormat.rowSpan>1?e.height:(i.i(n.isNullOrUndefined)(o)?0:o.height)-s;var a=this.getCellContentHeight(e,!0),l=0;return r>a&&r<=this.viewer.clientArea.height&&(l=r-a,"Center"===e.cellFormat.verticalAlignment?l/=2:("Top"===e.cellFormat.verticalAlignment||t)&&(l=0)),l},e.prototype.getCellContentHeight=function(e,t){if(i.i(n.isNullOrUndefined)(e.childWidgets))return 0;for(var r=0,o=e.y,s=0,a=0,l=!1,h=!1,c=0;c<e.childWidgets.length;c++)if(e.childWidgets[c]instanceof d.g){var p=e.childWidgets[c];if(r+=e.childWidgets[c].height,!t){var u=this.getFloatingItemsHeight(p,e);r+=u}for(var g=0;g<p.floatingElements.length;g++){l=!0;var f=p.floatingElements[g],m=f.textWrappingStyle,v=f.y+f.height,y=p.y+p.height;if(o+e.containerWidget.height>v&&v>a)s=Math.abs(o-v),a=v,h=!1;else if(v>y&&p.x+p.width>f.x&&v>a&&"InFrontOfText"!==m&&"Behind"!==m&&("Word2013"===this.documentHelper.compatibilityMode||p.floatingElements[g].layoutInCell)){var w=0===a?v-y:v-a;r+=w,a=v}else h=!0}}else this.considerPositionTableHeight(e,e.childWidgets[c])&&(r+=e.childWidgets[c].height);return o+r>a&&(l=!1),t&&l?s:t&&h?e.ownerRow.height:r},e.prototype.getFloatingItemsHeight=function(e,t){for(var i=0,n=0,r=0;r<e.floatingElements.length;r++){var o=e.floatingElements[r],s=o.textWrappingStyle,a=o.y+o.height,l=e.y+e.height;if(a<this.viewer.clientArea.bottom&&o.y!==e.y&&l>a&&e.x+e.width>o.x&&a>i&&"InFrontOfText"!==s&&"Behind"!==s&&"Inline"!==s&&("Word2013"===this.documentHelper.compatibilityMode||e.floatingElements[r].layoutInCell)){n+=0===i?a-t.y:a-i,i=a}}return n},e.prototype.considerPositionTableHeight=function(e,t){if(t.isLayouted&&t.wrapTextAround)for(var i=0;i<e.childWidgets.length;i++){var n=e.childWidgets[i];if(t!==n&&(n.y===t.y||n.y+n.height<t.y))return!1}return!0},e.prototype.getTableLeftBorder=function(e){if(i.i(n.isNullOrUndefined)(e.left)){var t=new a.g(e);return t.lineStyle="Single",t.lineWidth=.66,t}return e.left},e.prototype.getTableRightBorder=function(e){if(i.i(n.isNullOrUndefined)(e.right)){var t=new a.g(e);return t.lineStyle="Single",t.lineWidth=.66,t}return e.right},e.prototype.getTableTopBorder=function(e){if(i.i(n.isNullOrUndefined)(e.top)){var t=new a.g(e);return t.lineStyle="Single",t.lineWidth=.66,t}return e.top},e.prototype.getTableBottomBorder=function(e){if(i.i(n.isNullOrUndefined)(e.bottom)){var t=new a.g(e);return t.lineStyle="Single",t.lineWidth=.66,t}return e.bottom},e.prototype.getCellDiagonalUpBorder=function(e){var t=void 0;return t=e.cellFormat.borders,t.diagonalUp},e.prototype.getCellDiagonalDownBorder=function(e){var t=void 0;return t=e.cellFormat.borders,t.diagonalDown},e.prototype.getTableWidth=function(e){for(var t=0,i=0;i<e.childWidgets.length;i++){for(var n=e.childWidgets[i],r=0,o=0;o<n.childWidgets.length;o++){var a=n.childWidgets[o];r+=s.a.convertPointToPixel(a.cellFormat.cellWidth)}t<r&&(t=r)}return t},e.prototype.layoutNextItemsBlock=function(e,t,r){var o=e.bodyWidget.sectionIndex,a=e,l=a.getSplitWidgets(),c=l[l.length-1].nextRenderedWidget;(i.i(n.isNullOrUndefined)(c)||this.documentHelper.blockToShift===a)&&(this.documentHelper.blockToShift=void 0);for(var p=!0;c instanceof d.C&&(c.bodyWidget.sectionIndex===o||"NoBreak"===c.bodyWidget.sectionFormat.breakCode&&a.bodyWidget.sectionFormat.pageWidth===c.bodyWidget.sectionFormat.pageWidth&&a.bodyWidget.sectionFormat.pageHeight===c.bodyWidget.sectionFormat.pageHeight)&&(i.i(n.isNullOrUndefined)(r)||!r||c.isLayouted||!this.isInitialLoad);){var u=void 0,g=a.getSplitWidgets();u=g[g.length-1],a=c,this.documentHelper.blockToShift===a&&(this.documentHelper.blockToShift=void 0),p=!1;var f=void 0;if(f=a.getSplitWidgets()[0],0===this.documentHelper.fieldStacks.length&&!i.i(n.isNullOrUndefined)(f)&&u.containerWidget===f.containerWidget&&s.a.round(f.y,2)===s.a.round(u.y+u.height,2)){if(!i.i(n.isNullOrUndefined)(this.documentHelper.blockToShift)||this.documentHelper.owner.editor.isFootnoteElementRemoved)this.documentHelper.blockToShift=a;else if(f.bodyWidget){var m=f.bodyWidget.floatingElements.length;(m>0||0===m&&i.i(n.isNullOrUndefined)(this.documentHelper.blockToShift)&&f instanceof d.g&&f.isEmpty()&&u instanceof d.u)&&(this.documentHelper.blockToShift=a)}break}if(p=!0,t.owner.isShiftingEnabled&&0===this.documentHelper.fieldStacks.length||this.isIFfield){this.documentHelper.blockToShift=a;break}!i.i(n.isNullOrUndefined)(this.viewer.owner.editorModule)&&this.viewer.owner.editorModule.isInsertingTOC||(a=a.combineWidget(this.viewer),u.containerWidget!==a.containerWidget&&(u instanceof d.g&&(!(u instanceof d.g)||u.isEndsWithPageBreak||u.isEndsWithColumnBreak||u.containerWidget.page===a.containerWidget.page||a.bodyWidget instanceof d.o&&"NoBreak"===a.bodyWidget.sectionFormat.breakCode)||this.updateContainerWidget(a,u.containerWidget,u.indexInOwner+1,!1)),a instanceof d.u&&(this.clearTableWidget(a,!0,!0),a.isGridUpdated=!1),t.updateClientAreaForBlock(a,!0),(this.viewer instanceof h.a||a.bodyWidget instanceof d.x)&&(a.containerWidget.height-=a.height),this.documentHelper.layout.layoutBlock(a,0),t.updateClientAreaForBlock(a,!1)),l=c.getSplitWidgets(),c=l[l.length-1].nextRenderedWidget}t.owner.isShiftingEnabled&&this.documentHelper.blockToShift===a||this.viewer.owner.editorModule.updateListItemsTillEnd(a,p)},e.prototype.updateClientAreaForLine=function(e){e.marginTop=0;var t=this.documentHelper.selection.getTop(e),i=this.viewer.clientArea.x;this.viewer.cutFromTop(t),this.viewer.cutFromLeft(i)},e.prototype.getParentTable=function(e){for(var t=e;t.containerWidget;){if(t.containerWidget instanceof d.h||t.containerWidget instanceof d.i)return t;t=t.containerWidget}},e.prototype.reLayoutParagraph=function(e,t,r,o,s){if(!this.isReplaceAll){if(this.isRelayout=!0,e.containerWidget instanceof d.i&&"Inline"===e.containerWidget.containerShape.textWrappingStyle&&(t=e.containerWidget.containerShape.line.indexInOwner,e=e.containerWidget.containerShape.paragraph),o=!i.i(n.isNullOrUndefined)(o)&&o,this.isRelayout=!0,this.documentHelper.blockToShift===e?(this.layoutBodyWidgetCollection(e.index,e.containerWidget,e,!1),this.isBidiReLayout=!0):this.isBidiReLayout&&(this.isBidiReLayout=!1),e.isInsideTable){if(this.isBidiReLayout=!0,this.isReplacingAll||this.reLayoutTable(e),this.isFootnoteContentChanged&&!i.i(n.isNullOrUndefined)(e.bodyWidget)&&!i.i(n.isNullOrUndefined)(e.bodyWidget.page.footnoteWidget)){var a=e.bodyWidget.page.footnoteWidget;this.layoutfootNote(a)}this.isBidiReLayout=!1}else this.reLayoutLine(e,t,o,s);e.bodyWidget instanceof d.x&&-1!==e.bodyWidget.headerFooterType.indexOf("Footer")&&this.shiftFooterChildLocation(e.bodyWidget,this.viewer)}},e.prototype.getParentRow=function(e){for(var t=e;null!==t.ownerTable&&t.ownerTable.isInsideTable;)t=t.ownerTable.associatedCell;return t.ownerRow},e.prototype.reLayoutRow=function(e){e instanceof d.g&&(e=e.associatedCell);var t=this.getParentRow(e).getSplitWidgets()[0];if(i.i(n.isNullOrUndefined)(t)||t.ownerTable.tableFormat.allowAutoFit)this.currentCell=e,this.reLayoutTable(e),this.currentCell=void 0;else{for(var r=t.ownerTable.getSplitWidgets()[0].combineWidget(this.viewer),o=t;this.isVerticalMergedCellContinue(o);){var s=o.previousWidget;if(i.i(n.isNullOrUndefined)(s))break;o=s}var a=r.containerWidget;this.viewer instanceof h.a&&(a.height-=r.height),!this.viewer.owner.enableHeaderAndFooter&&!e.isInHeaderFooter||a instanceof d.i?a instanceof d.i?this.viewer.updateClientAreaForTextBoxShape(a.containerShape,!0):this.viewer.updateClientArea(a,a.page):(e.bodyWidget.isEmpty=!1,a.height-=r.height,this.viewer.updateHeaderFooterClientAreaWithTop(r.bodyWidget.sectionFormat,this.documentHelper.isBlockInHeader(r),a.page));var l=new d.t(this.viewer.clientArea.x,this.viewer.clientArea.y,this.viewer.clientArea.width,this.viewer.clientArea.height),c=new d.t(l.x,l.y,l.width,l.height);if(this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule){var p=this.documentHelper.getFirstParagraphInFirstCell(r);this.viewer.owner.editorModule.updateWholeListItems(p)}this.viewer.updateClientAreaForBlock(r,!0),this.viewer.cutFromTop(o.y),this.viewer.clientActiveArea.height=Number.POSITIVE_INFINITY,r.height=0;do{if(this.clearRowWidget(t,!0,!0,!0),this.layoutRow([r],t,!0),o===t)break;o=o.nextRow}while(o&&o!==t);this.updateChildLocationForTable(r.y,r),this.viewer.clientArea=c,this.viewer.clientActiveArea=new d.t(c.x,c.y,c.width,c.height),this.viewer.updateClientAreaForBlock(r,!0),r.x-=r.leftBorderWidth,r.y-=r.topBorderWidth,this.viewer.cutFromTop(r.y),this.shiftTableWidget(r,this.viewer,!0),this.layoutNextItemsBlock(r,this.viewer)}},e.prototype.reLayoutTable=function(e,t){var i=this.getParentTable(e);if(i.header)for(var n=i.getSplitWidgets(),r=1;r<n.length;r++)n[r].bodyWidget.page.repeatHeaderRowTableWidget=!1;var o=i.combineWidget(this.viewer),s=o.containerWidget;if(this.viewer instanceof h.a&&(s.height-=o.height),!this.viewer.owner.enableHeaderAndFooter&&!e.isInHeaderFooter||s instanceof d.i?s instanceof d.i?this.viewer.updateClientAreaForTextBoxShape(s.containerShape,!0):this.viewer.updateClientArea(s,s.page):(e.bodyWidget.isEmpty=!1,s.height-=o.height,this.viewer.updateHeaderFooterClientAreaWithTop(i.bodyWidget.sectionFormat,this.documentHelper.isBlockInHeader(i),s.page)),this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule){var a=this.documentHelper.getFirstParagraphInFirstCell(o);this.viewer.owner.editorModule.updateWholeListItems(a)}this.viewer.updateClientAreaForBlock(o,!0),o.x-=o.leftBorderWidth,o.y-=o.topBorderWidth;var l=this.getYPosition(o);this.viewer.cutFromTop(l),this.clearTableWidget(o,!0,!0,!0,!0),this.isBidiReLayout=!0,this.layoutBlock(o,0),this.viewer.updateClientAreaForBlock(o,!1),this.layoutNextItemsBlock(o,this.viewer,t)},e.prototype.getYPosition=function(e){if(e.wrapTextAround){for(var t=e.previousWidget;t;){if(t instanceof d.g)return t.y+t.height;if(t instanceof d.u){if(!t.wrapTextAround)return t.y+t.height;t=t.previousWidget}}return this.viewer.clientActiveArea.y}return e.y},e.prototype.clearFootnoteReference=function(e,t){if(e.footnoteElement&&e.footnoteElement.length>0){for(var i=e.bodyWidget.page,n=e.footnoteElement.length-1;n>=0;n--){var r=e.footnoteElement[n];r.isLayout=!1;var o=r.bodyWidget.containerWidget;if(o&&-1!==o.bodyWidgets.indexOf(r.bodyWidget)){var s=this.getFootNoteHeight(r.bodyWidget);o.height-=s,o.bodyWidgets.splice(r.bodyWidget.indexInOwner,1),t&&o.page===i&&(this.viewer.clientActiveArea.height+=s,this.viewer.clientArea.height+=s)}0===o.bodyWidgets.length&&o.page&&(o.page.footnoteWidget=void 0),r.bodyWidget.containerWidget=void 0}e.footnoteElement=[]}},e.prototype.clearTableWidget=function(e,t,i,n,r){e.height=0,n&&(e.isGridUpdated=!1),t&&(e.y=0,e.x=0,e.footnoteElement&&e.footnoteElement.length>0&&this.clearFootnoteReference(e,r)),e.leftBorderWidth=0,e.rightBorderWidth=0,e.topBorderWidth=0,e.bottomBorderWidth=0;for(var o=0;o<e.childWidgets.length;o++){var s=e.childWidgets[o];this.clearRowWidget(s,t,i,n)}},e.prototype.clearRowWidget=function(e,t,i,n){e.height=0,t&&(e.y=0,e.x=0),e.topBorderWidth=0,e.bottomBorderWidth=0;for(var r=0;r<e.childWidgets.length;r++){var o=e.childWidgets[r];this.clearCellWidget(o,t,i,n)}},e.prototype.clearCellWidget=function(e,t,i,n){e.height=0,t&&(e.y=0,e.x=0),e.leftBorderWidth=0,e.rightBorderWidth=0,this.clearBlockWidget(e.childWidgets,t,i,n)},e.prototype.clearBlockWidget=function(e,t,i,n){for(var r=0;r<e.length;r++){var o=e[r];o instanceof d.g?(t&&(o.y=0,o.x=0),i&&(o.height=0)):this.clearTableWidget(o,t,i,n)}},e.prototype.layoutBodyWidgetCollection=function(e,t,r,o,s){if(i.i(n.isNullOrUndefined)(r)||!r.isFieldCodeBlock){if(!i.i(n.isNullOrUndefined)(this.documentHelper.owner)&&this.documentHelper.owner.isLayoutEnabled)if(t instanceof d.h||t instanceof d.i){var a=this.checkAndGetBlock(t,e);if(t instanceof d.o&&i.i(n.isNullOrUndefined)(a)&&!i.i(n.isNullOrUndefined)(t.nextRenderedWidget)&&"NoBreak"===t.nextRenderedWidget.sectionFormat.breakCode&&(a=t.nextRenderedWidget.firstChild,t=t.nextRenderedWidget),i.i(n.isNullOrUndefined)(a))return;if(this.viewer instanceof h.a&&(a.containerWidget.height-=a.height),t instanceof d.x)t.isEmpty=!1,this.viewer.updateHeaderFooterClientAreaWithTop(t.sectionFormat,-1!==t.headerFooterType.indexOf("Header"),t.page),a.containerWidget.height-=a.height;else if(t instanceof d.i)this.viewer.updateClientAreaForTextBoxShape(t.containerShape,!0,!o);else if(!i.i(n.isNullOrUndefined)(t.containerWidget)&&t.containerWidget instanceof d.a){if(this.viewer.updateClientArea(t,t.page,!0),"Footnote"!==t.containerWidget.footNoteType)return this.viewer.cutFromTop(t.containerWidget.y),void this.layoutfootNote(t.containerWidget);this.isRelayoutFootnote=!0,this.viewer.clientArea.height=Number.POSITIVE_INFINITY,this.viewer.clientActiveArea.height=Number.POSITIVE_INFINITY,this.viewer.clientActiveArea.y=a.containerWidget.containerWidget.y}else i.i(n.isNullOrUndefined)(t.page.footnoteWidget)?this.viewer.updateClientArea(t,t.page,!0):(t.page.footnoteWidget.footNoteType,this.viewer.updateClientArea(t,t.page,!0));if(e>0||"NoBreak"===a.bodyWidget.sectionFormat.breakCode&&0!==a.bodyWidget.index&&a===t.firstChild){a=a.combineWidget(this.viewer);var l=a.getSplitWidgets()[0].previousRenderedWidget;for(!i.i(n.isNullOrUndefined)(l)&&l.wrapTextAround&&!i.i(n.isNullOrUndefined)(l.getSplitWidgets()[0].previousRenderedWidget)&&l.y<l.getSplitWidgets()[0].previousRenderedWidget.y&&(l=l.getSplitWidgets()[0].previousRenderedWidget);l instanceof d.C&&l.isFieldCodeBlock;)l=l.getSplitWidgets()[0].previousRenderedWidget;if(!(i.i(n.isNullOrUndefined)(l)||l instanceof d.g)||l instanceof d.g&&!l.isEndsWithPageBreak&&!l.isEndsWithColumnBreak)if(i.i(n.isNullOrUndefined)(s)&&a.containerWidget!==l.containerWidget){var c=a.containerWidget,p=l.containerWidget,u=this.getFootNoteWidgetsOf(a);if(this.moveFootNotesToPage(u,c,p),"NoBreak"!==a.bodyWidget.sectionFormat.breakCode||a.bodyWidget.index===l.bodyWidget.index)this.viewer.cutFromTop(l.y+l.height),this.updateContainerWidget(a,p,l.indexInOwner+1,!1);else if(a.bodyWidget.sectionIndex!==l.bodyWidget.sectionIndex&&l.bodyWidget.sectionFormat.numberOfColumns>1&&a.bodyWidget.page===l.bodyWidget.page){var g=this.getBodyWidget(l.bodyWidget,!0),f=this.getNextWidgetHeight(g);this.viewer.clientActiveArea.height-=f-this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.y=f,this.viewer.clientArea.y=this.viewer.clientActiveArea.y,this.viewer.clientArea.height=this.viewer.clientActiveArea.height}else this.viewer.updateClientArea(a.bodyWidget,a.bodyWidget.page,!0),this.viewer.cutFromTop(l.y+l.height)}else{if(l instanceof d.g&&l.height<=0&&this.isMultiColumnDoc){var m=l;this.viewer.updateClientAreaForBlock(m,!0),this.layoutParagraph(m,0),this.viewer.updateClientArea(m.bodyWidget,m.bodyWidget.page,!0)}this.viewer.cutFromTop(l.y+l.height)}else l instanceof d.g&&(l.isEndsWithPageBreak||l.isEndsWithColumnBreak)&&l.containerWidget===a.containerWidget&&this.moveBlocksToNextPage(l,!1)}var v=void 0;a=a.combineWidget(this.viewer),a instanceof d.u?(this.clearTableWidget(a,!0,!0),a.isGridUpdated=!1,v=this.documentHelper.getFirstParagraphInFirstCell(a)):v=a,this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule&&this.viewer.owner.editorModule.updateWholeListItems(v),this.viewer.updateClientAreaForBlock(a,!0,void 0,!1,!0),this.isRelayout=!0,this.documentHelper.layout.layoutBlock(a,0),this.isRelayout=!1,this.viewer.updateClientAreaForBlock(a,!1),!i.i(n.isNullOrUndefined)(t.containerWidget)&&t.containerWidget instanceof d.a&&"Footnote"===t.containerWidget.footNoteType&&this.layoutfootNote(t.containerWidget),o?this.shiftNextWidgets(a):this.layoutNextItemsBlock(a,this.viewer)}else if(t instanceof d.j){var y=this.documentHelper.layout.getParentTable(t.ownerTable).getSplitWidgets()[0];this.reLayoutTable(t.ownerTable),this.layoutNextItemsBlock(y,this.viewer)}this.isRelayoutFootnote=!1}},e.prototype.checkAndGetBlock=function(e,t){if(e instanceof d.i)return e.childWidgets[t];var i=e.indexInOwner;if(e.page.bodyWidgets.length<=1)for(;e&&e.indexInOwner===i;){if(e.childWidgets.length>0&&e.firstChild.index<=t&&e.lastChild.index>=t)for(var n=0;n<e.childWidgets.length;n++){var r=e.childWidgets[n];if(r.index===t)return r}if(!(e instanceof d.o))break;e=e.nextRenderedWidget}else for(;e;){if(e.childWidgets.length>0)for(var n=0;n<e.childWidgets.length;n++){var r=e.childWidgets[n];if(r.index===t)return r}if(!(e instanceof d.o))break;e=e.nextRenderedWidget}},e.prototype.layoutTable=function(e,t){if(this.isFieldCode&&!this.checkTableHasField(e))return e.isFieldCodeBlock=!0,e;!i.i(n.isNullOrUndefined)(e.previousWidget)&&this.viewer.clientActiveArea.height<0&&!e.wrapTextAround&&this.moveBlocksToNextPage(e.previousWidget,!1),e.isBidiTable=e.bidi,e.isGridUpdated||(e.buildTableColumns(),e.isGridUpdated=!0),"Word2013"===this.documentHelper.compatibilityMode||e.isInsideTable||i.i(n.isNullOrUndefined)(e.firstChild.firstChild.leftMargin)||(this.viewer.clientActiveArea.x=this.viewer.clientActiveArea.x-s.a.convertPointToPixel(e.firstChild.firstChild.leftMargin));var r=[e];this.addTableWidget(this.viewer.clientActiveArea,r),this.viewer.updateClientAreaTopOrLeft(e,!0);var o,a,l=0;if(e.wrapTextAround?(o=this.viewer.clientActiveArea.clone(),a=this.viewer.clientArea.clone(),this.updateClientAreaForWrapTable(r,e,!0,o,a)):e.containerWidget instanceof d.i||(this.adjustClientAreaBasedOnTextWrapForTable(e,this.viewer.clientActiveArea),this.isWrapText&&(l=this.viewer.clientActiveArea.x-this.viewer.clientArea.x,this.isWrapText=!1,e.x=this.viewer.clientActiveArea.x)),e.childWidgets.length>0){var c=e.childWidgets[0].rowFormat.isHeader;e.header=c,e.continueHeader=c,e.headerHeight=0}var p=e.childWidgets[t];for(r.length;p;)p=this.layoutRow(r,p),p=p.nextRow;this.documentHelper.viewer instanceof h.b&&e.wrapTextAround&&("Bottom"===e.positioning.verticalAlignment||"Center"===e.positioning.verticalAlignment||"Outside"===e.positioning.verticalAlignment)&&(this.updateTableFloatPoints(e),this.updateChildLocationForTable(e.y,e)),this.updateWidgetsToPage(r,[],e,!0),l>0&&(this.viewer.clientArea.x=this.viewer.clientArea.x-l);var u=e.getSplitWidgets();return e.wrapTextAround&&e.bodyWidget&&e.bodyWidget.lastChild!==u[u.length-1]&&this.updateClientAreaForWrapTable(r,e,!1,o,a),r[r.length-1].isLayouted=!0,r[r.length-1].isFieldCodeBlock=!1,"Word2013"===this.documentHelper.compatibilityMode||e.isInsideTable||e.wrapTextAround||i.i(n.isNullOrUndefined)(e.firstChild.firstChild.leftMargin)||(this.viewer.clientArea.x=this.viewer.clientArea.x+s.a.convertPointToPixel(e.firstChild.firstChild.leftMargin)),r[r.length-1]},e.prototype.updateClientAreaForWrapTable=function(e,t,r,o,s){if(r){if(t.wrapTextAround){this.updateTableFloatPoints(t);var a=this.viewer.clientActiveArea.clone(),l=this.adjustClientAreaBasedOnTextWrapForTable(t,this.viewer.clientActiveArea);a.x!==l.x&&(t.x=this.viewer.clientActiveArea.x),a.y!==l.y&&(t.y=this.viewer.clientActiveArea.y)}}else if(t.wrapTextAround&&t.bodyWidget)if(1==e.length){if(!i.i(n.isNullOrUndefined)(t.previousWidget)||t.isInHeaderFooter||t.isInsideTable){this.viewer.clientActiveArea=o.clone(),this.viewer.clientArea=s.clone();var d=t.positioning;this.viewer.clientActiveArea.height<t.height&&t.width>=this.viewer.clientActiveArea.width&&"None"==d.verticalAlignment&&"Left"==d.horizontalAlignment&&"Margin"==d.horizontalOrigin&&"Margin"==d.verticalOrigin&&0==d.horizontalPosition&&d.verticalPosition<=0&&this.moveBlocksToNextPage(t.previousWidget,!1)}else this.viewer.updateClientArea(t.bodyWidget,t.bodyWidget.page);-1===t.bodyWidget.floatingElements.indexOf(t)&&t.bodyWidget.floatingElements.push(t)}else{this.documentHelper.tableLefts.pop(),this.viewer.updateClientArea(t.bodyWidget,t.bodyWidget.page);for(var h=0;h<e.length;h++){var c=e[h].bodyWidget;i.i(n.isNullOrUndefined)(c)||-1!==c.floatingElements.indexOf(e[h])||c.floatingElements.push(e[h])}var p=e[e.length-1];this.viewer.cutFromTop(this.viewer.clientActiveArea.y+p.height+p.tableFormat.borders.bottom.lineWidth)}},e.prototype.addTableWidget=function(e,t,i){var n=t[t.length-1];return i&&(n=this.createTableWidget(n),t.push(n)),n.width=e.width,n.x=e.x,n.y=e.y,n.tableFormat.cellSpacing>0&&(n.height=n.height+s.a.convertPointToPixel(n.tableFormat.cellSpacing),n.isBidiTable?(n.leftBorderWidth=s.a.convertPointToPixel(this.getTableRightBorder(n.tableFormat.borders).getLineWidth()),n.rightBorderWidth=s.a.convertPointToPixel(this.getTableLeftBorder(n.tableFormat.borders).getLineWidth())):(n.leftBorderWidth=s.a.convertPointToPixel(this.getTableLeftBorder(n.tableFormat.borders).getLineWidth()),n.rightBorderWidth=s.a.convertPointToPixel(this.getTableRightBorder(n.tableFormat.borders).getLineWidth())),n.topBorderWidth=s.a.convertPointToPixel(this.getTableTopBorder(n.tableFormat.borders).getLineWidth()),n.bottomBorderWidth=s.a.convertPointToPixel(this.getTableBottomBorder(n.tableFormat.borders).getLineWidth()),n.x+=n.leftBorderWidth,n.y+=n.topBorderWidth,n.width-=n.leftBorderWidth,n.width-=n.rightBorderWidth,n.height+=n.bottomBorderWidth),n},e.prototype.updateWidgetsToPage=function(e,t,i,n,r){var o=this.viewer,a=e[e.length-1];if(!i.isInsideTable){for(var l=0;l<e.length;l++)this.updateHeightForTableWidget(e,t,e[l],r);a.childWidgets.length>0&&a.y!==a.childWidgets[0].y&&(a.y=a.childWidgets[0].y)}if(i.isBidiTable&&n)for(var l=0;l<e.length;l++)for(var c=e[l],p=0;p<c.childWidgets.length;p++){var u=c.childWidgets[p];u.shiftWidgetForRtlTable()}i.tableFormat.cellSpacing>0&&(a.y+a.height+s.a.convertPointToPixel(i.tableFormat.cellSpacing)>o.clientArea.bottom&&o instanceof h.a&&(a.height=a.height-s.a.convertPointToPixel(i.tableFormat.cellSpacing)/2),o.cutFromTop(a.y+a.height)),this.viewer instanceof h.a&&(i.containerWidget.height+=i.height),i.bodyWidget instanceof d.x&&!i.wrapTextAround&&(i.containerWidget.height+=i.height,this.viewer.owner.enableHeaderAndFooter&&-1!==i.bodyWidget.headerFooterType.indexOf("Footer")&&this.shiftFooterChildLocation(i.bodyWidget,this.viewer))},e.prototype.updateHeightForTableWidget=function(e,t,i,n){for(var r=0;r<i.childWidgets.length;r++){var o=i.childWidgets[r];if(o===n)break;this.updateHeightForRowWidget(this.viewer,!0,e,t,o,!1,n)}},e.prototype.layoutRow=function(e,t,i){var n=t.ownerTable.isInsideTable;n||this.updateExistingFootnoteHeight(t);var r=this.viewer,o=[t];this.addTableRowWidget(r.clientActiveArea,o),r.updateClientAreaForRow(t,!0);for(var s=this.getMaxTopCellMargin(t),a=this.getMaxBottomCellMargin(t),l=0;l<t.childWidgets.length;l++){var d=t.childWidgets[l];this.layoutCell(d,s+t.topBorderWidth,a+t.bottomBorderWidth)}r.updateClientAreaForRow(t,!1);var h=[t];return i||this.updateWidgetsToTable(e,h,t,!1),n||(this.layoutedFootnoteElement=[]),h[h.length-1]},e.prototype.updateExistingFootnoteHeight=function(e){this.layoutedFootnoteElement=[],i.i(n.isNullOrUndefined)(e.bodyWidget.page.footnoteWidget)||0===e.bodyWidget.page.footnoteWidget.bodyWidgets.length?this.existFootnoteHeight=0:this.existFootnoteHeight=e.bodyWidget.page.footnoteWidget.height},e.prototype.isIntersecting=function(e,t,i,n){return(s.a.round(i,2)<=s.a.round(e,2)||s.a.round(i,2)<s.a.round(t,2))&&s.a.round(n,2)>s.a.round(e,2)},e.prototype.getAdjacentRowCell=function(e,t,r,o){var a=[],l=e.ownerTable.tableHolder.columns.length,d=e.ownerTable.childWidgets[o];if(i.i(n.isNullOrUndefined)(d))return a;var h=0,c=0,p=e.cellFormat.columnSpan,u=e.columnIndex;if(d.rowFormat.gridBefore>0){if(d.rowFormat.gridBefore>u+p)return a;h=d.rowFormat.beforeWidth,c=d.rowFormat.gridBefore}for(var g=0;g<d.childWidgets.length;g++){var f=d.childWidgets[g],m=f.x-f.margin.left,v=f.x+f.width+f.margin.right,y=f.columnIndex+f.cellFormat.columnSpan;if(g==d.childWidgets.length-1||s.a.round(m,2)>s.a.round(h,2)&&s.a.round(m,2)>s.a.round(t,2)){if(g==d.childWidgets.length-1&&d.rowFormat.gridAfter>0&&y+d.rowFormat.gridAfter===l)return a;if(this.isIntersecting(t,r,h,m))for(;p>0;){var w=d.getVerticalMergeStartCell(u,p),b=0;if(i.i(n.isNullOrUndefined)(w))break;var x=w.cellFormat.columnSpan;if(a.push(w),b=w.x+w.width+w.margin.right,t=b,c=w.columnIndex+x,p-=c-u,u=c,s.a.round(b,2)>=s.a.round(r,2))break}}if(this.isIntersecting(t,r,m,v)&&(a.push(f),t=v,p-=y-u,u=y),s.a.round(v,2)>=s.a.round(r,2))break;h=v,c=y}return a},e.prototype.addTableRowWidget=function(e,t){var r=t[t.length-1];0===r.rowFormat.beforeWidth&&0===r.rowFormat.gridBeforeWidth||this.documentHelper.alignTablesRowByRow&&"Left"!==r.ownerTable.tableFormat.tableAlignment?r.x=e.x:r.x+=0!==r.rowFormat.beforeWidth?r.rowFormat.beforeWidth:r.rowFormat.gridBeforeWidth,r.y=e.y,r.width=e.width;var o=0;if(!i.i(n.isNullOrUndefined)(r.ownerTable)&&!i.i(n.isNullOrUndefined)(r.ownerTable.tableFormat)&&r.ownerTable.tableFormat.cellSpacing>0){r.height=r.height+s.a.convertPointToPixel(r.ownerTable.tableFormat.cellSpacing);for(var a=0;a<r.childWidgets.length;a++)if(!i.i(n.isNullOrUndefined)(r.childWidgets[a].cellFormat)&&!i.i(n.isNullOrUndefined)(r.childWidgets[a].cellFormat.borders)){var l=d.j.getCellBottomBorder(r.childWidgets[a]).getLineWidth();l>o&&(o=l)}if(r.bottomBorderWidth=s.a.convertPointToPixel(o),r.index>0&&!i.i(n.isNullOrUndefined)(r.previousWidget)){var h=r.previousWidget;o=0;for(var c=0;c<h.childWidgets.length;c++)if(!i.i(n.isNullOrUndefined)(h.childWidgets[c].cellFormat)&&!i.i(n.isNullOrUndefined)(h.childWidgets[c].cellFormat.borders)){var p=d.j.getCellBottomBorder(h.childWidgets[c]).getLineWidth();p>o&&(o=p)}r.topBorderWidth=s.a.convertPointToPixel(o)}}if(!i.i(n.isNullOrUndefined)(r.childWidgets))for(var c=0;c<r.childWidgets.length;c++)if(!i.i(n.isNullOrUndefined)(r.childWidgets[c].cellFormat)&&!i.i(n.isNullOrUndefined)(r.childWidgets[c].cellFormat.borders)){var u=d.j.getCellTopBorder(r.childWidgets[c]).getLineWidth();u>o&&(o=u)}if(r.topBorderWidth=s.a.convertPointToPixel(o),!i.i(n.isNullOrUndefined)(r.ownerTable)&&!i.i(n.isNullOrUndefined)(r.ownerTable.tableFormat)&&r.ownerTable.tableFormat.cellSpacing<=0&&r.rowIndex===r.ownerTable.childWidgets.length-1){for(var c=0;c<r.childWidgets.length;c++)if(!i.i(n.isNullOrUndefined)(r.childWidgets[c].cellFormat)&&!i.i(n.isNullOrUndefined)(r.childWidgets[c].cellFormat.borders)){var g=d.j.getCellBottomBorder(r.childWidgets[c]).getLineWidth();g>o&&(o=g)}r.bottomBorderWidth=s.a.convertPointToPixel(o)}return r},e.prototype.getMaxTopCellMargin=function(e){if(i.i(n.isNullOrUndefined)(e.childWidgets))return 0;for(var t=0,r=0;r<e.childWidgets.length;r++){var o=e.childWidgets[r],a=0;a=o.cellFormat.hasValue("topMargin")?s.a.convertPointToPixel(o.cellFormat.topMargin):e.rowFormat.hasValue("topMargin")?s.a.convertPointToPixel(e.rowFormat.topMargin):s.a.convertPointToPixel(e.ownerTable.tableFormat.topMargin),a>t&&(t=a)}return t},e.prototype.getMaxBottomCellMargin=function(e){if(i.i(n.isNullOrUndefined)(e.childWidgets))return 0;for(var t=0,r=0;r<e.childWidgets.length;r++){var o=e.childWidgets[r],a=0;a=o.cellFormat.hasValue("bottomMargin")?s.a.convertPointToPixel(o.cellFormat.bottomMargin):e.rowFormat.hasValue("bottomMargin")?s.a.convertPointToPixel(e.rowFormat.bottomMargin):s.a.convertPointToPixel(e.ownerTable.tableFormat.bottomMargin),a>t&&(t=a)}return t},e.prototype.layoutCell=function(e,t,i){var n=this.viewer;if(this.addTableCellWidget(e,n.clientActiveArea,t,i),this.updateTopBorders(e),n.updateClientAreaForCell(e,!0),0===e.childWidgets.length){var r=new d.g;r.characterFormat=new a.c,r.paragraphFormat=new a.a,r.index=0;var o=new d.p(r);r.childWidgets.push(o),e.childWidgets.push(r),r.paragraphFormat.borders=new a.d}for(var s=0;s<e.childWidgets.length;s++){var l=e.childWidgets[s];n.updateClientAreaForBlock(l,!0),l.containerWidget=e,this.layoutBlock(l,0),n.updateClientAreaForBlock(l,!1)}this.updateWidgetToRow(e),n.updateClientAreaForCell(e,!1)},e.prototype.isInsertTable=function(){return!(!this.documentHelper.owner.editorHistory||!this.documentHelper.owner.editorHistory.currentBaseHistoryInfo||"InsertTable"!==this.documentHelper.owner.editorHistory.currentBaseHistoryInfo.action)},e.prototype.updateTopBorders=function(e){if(e.updatedTopBorders=[],0===e.ownerTable.tableFormat.cellSpacing){var t=e.cellFormat.borders.top;(!t.isBorderDefined||t.isBorderDefined&&"None"===t.lineStyle&&0===t.lineWidth&&t.hasValue("color"))&&(t=e.ownerRow.rowFormat.borders.horizontal),t.isBorderDefined||(t=e.ownerRow.ownerTable.tableFormat.borders.horizontal);for(var i=e.x-e.margin.left,n=e.x+e.width+e.margin.right,r=this.getAdjacentRowCell(e,i,n,e.ownerRow.indexInOwner-1),o=0;o<r.length;o++){var a=r[o],l=a.cellFormat.borders.bottom;(!l.isBorderDefined||l.isBorderDefined&&"None"===l.lineStyle&&0===l.lineWidth&&l.hasValue("color"))&&(l=a.ownerRow.rowFormat.borders.horizontal),l.isBorderDefined||(l=a.ownerRow.ownerTable.tableFormat.borders.horizontal);var d=void 0;d="None"===t.lineStyle||"Cleared"===t.lineStyle?l:"Cleared"===l.lineStyle||"None"===l.lineStyle?t:e.getBorderBasedOnPriority(t,l);var h=a.x-a.margin.left,c=a.x+a.width+a.margin.right;if(0===o&&i<h&&e.updatedTopBorders.push({border:t,width:h-i}),d){var p=0;p=s.a.round(c,2)===s.a.round(n,2)&&s.a.round(h,2)===s.a.round(i,2)?n-i:s.a.round(h,2)>=s.a.round(i,2)&&s.a.round(c,2)>=s.a.round(n,2)?n-h:s.a.round(h,2)>=s.a.round(i,2)&&s.a.round(c,2)<=s.a.round(n,2)?c-h:s.a.round(h,2)<=s.a.round(i,2)&&s.a.round(c,2)<=s.a.round(n,2)?c-i:(s.a.round(h,2)<=s.a.round(i,2)&&(s.a.round(c,2),s.a.round(n,2)),n-i),p<0&&(p=0),e.updatedTopBorders.push({border:d,width:p})}o===r.length-1&&n>c&&e.updatedTopBorders.push({border:t,width:n-c})}}},e.prototype.shiftLayoutedItems=function(e){if(i.i(n.isNullOrUndefined)(this.documentHelper.blockToShift)||i.i(n.isNullOrUndefined)(this.documentHelper.blockToShift.containerWidget))return this.documentHelper.blockToShift=void 0,this.checkAndShiftEndnote(),void this.documentHelper.removeEmptyPages();var t=this.documentHelper.blockToShift,r=this.getColumnBreak(t.bodyWidget);if(!r&&this.viewer instanceof h.b&&!this.isMultiColumnSplit&&t===t.bodyWidget.firstChild&&!i.i(n.isNullOrUndefined)(t.bodyWidget.previousRenderedWidget)&&t.bodyWidget.sectionIndex!==t.bodyWidget.previousRenderedWidget.sectionIndex&&t.bodyWidget.previousRenderedWidget.sectionFormat.columns.length>1){var o=t.bodyWidget.previousRenderedWidget,a=this.getBodyWidget(o,!1);i.i(n.isNullOrUndefined)(a.nextRenderedWidget)||a.page!==a.nextRenderedWidget.page||this.splitBodyWidgetBasedOnColumn(o)}var l=!1,c=this.documentHelper.pages[this.documentHelper.pages.length-1];c.bodyWidgets[c.bodyWidgets.length-1];if((!r||e&&this.isSectionEndsWithColumnBreak(t.bodyWidget))&&this.viewer instanceof h.b&&!this.isMultiColumnSplit&&t.bodyWidget.sectionFormat.columns.length>1){if(0!==t.bodyWidget.columnIndex||t!==t.bodyWidget.firstChild||i.i(n.isNullOrUndefined)(t.previousRenderedWidget)||t.bodyWidget.page!==t.previousRenderedWidget.bodyWidget.page||(t.bodyWidget.y=this.viewer.clientActiveArea.y),l=t===t.bodyWidget.firstChild,this.reLayoutMultiColumn(t.bodyWidget,l),i.i(n.isNullOrUndefined)(this.documentHelper.blockToShift))return;t=this.documentHelper.blockToShift}var p=t.bodyWidget.index;this.reLayoutOrShiftWidgets(t,this.viewer);for(var u=!0,g=t.getSplitWidgets(),f=g[g.length-1].nextRenderedWidget;f instanceof d.C&&(f.bodyWidget.index===p||"NoBreak"===f.bodyWidget.sectionFormat.breakCode&&t.bodyWidget.sectionFormat.pageWidth===f.bodyWidget.sectionFormat.pageWidth&&t.bodyWidget.sectionFormat.pageHeight===f.bodyWidget.sectionFormat.pageHeight);){if((!(r=this.getColumnBreak(f.bodyWidget))||e&&this.isSectionEndsWithColumnBreak(f.bodyWidget))&&this.viewer instanceof h.b&&!this.isMultiColumnSplit&&f.bodyWidget.sectionFormat.columns.length>1){if(0!==f.bodyWidget.columnIndex||f!==f.bodyWidget.firstChild||i.i(n.isNullOrUndefined)(f.previousRenderedWidget)||f.bodyWidget.page!==f.previousRenderedWidget.bodyWidget.page||(f.bodyWidget.y=this.viewer.clientActiveArea.y),l=f===f.bodyWidget.firstChild,this.reLayoutMultiColumn(f.bodyWidget,l),i.i(n.isNullOrUndefined)(this.documentHelper.blockToShift))return;f=this.documentHelper.blockToShift}var m=void 0,v=t.getSplitWidgets();m=v[v.length-1],t=f,u=!1;var y=void 0;if(v=t.getSplitWidgets(),t instanceof d.g?y=v[0]:t instanceof d.u&&(y=v[0]),!this.documentHelper.owner.editor.isFootnoteElementRemoved&&m.containerWidget===y.containerWidget&&s.a.round(y.y,2)===s.a.round(this.viewer.clientActiveArea.y,2)&&i.i(n.isNullOrUndefined)(y.nextWidget))break;if(i.i(n.isNullOrUndefined)(m.floatingElements),u=!0,t.isFieldCodeBlock||this.reLayoutOrShiftWidgets(t,this.viewer),this.keepWithNext&&(t=this.documentHelper.blockToShift,this.keepWithNext=!1),!this.isMultiColumnSplit&&r&&t.bodyWidget.sectionFormat.numberOfColumns>1&&t.bodyWidget.nextWidget&&t.nextRenderedWidget&&t.bodyWidget.index!==t.nextRenderedWidget.bodyWidget.index){var w=this.viewer.clientActiveArea.y,b=this.viewer.clientActiveArea.height;this.viewer.updateClientArea(t.bodyWidget.nextWidget,t.bodyWidget.nextWidget.page),this.viewer.clientActiveArea.height=b,this.viewer.clientActiveArea.y=w}if(this.isMultiColumnSplit&&t.bodyWidget.sectionFormat.numberOfColumns>1&&t===t.bodyWidget.lastChild&&!i.i(n.isNullOrUndefined)(t.bodyWidget.nextRenderedWidget)&&t.bodyWidget.sectionIndex!==t.bodyWidget.nextRenderedWidget.sectionIndex&&t.bodyWidget.page===t.bodyWidget.nextRenderedWidget.page)return;g=t.getSplitWidgets(),f=g[g.length-1].nextRenderedWidget}this.viewer.owner.editorModule&&this.viewer.owner.editorModule.updateListItemsTillEnd(t,u),this.documentHelper.blockToShift=void 0;var x=this.viewer;if(x.owner.editor.isFootnoteElementRemoved){var C=this.documentHelper.pages[this.documentHelper.pages.length-1],I=C.bodyWidgets[C.bodyWidgets.length-1],F=C.endnoteWidget;if(!i.i(n.isNullOrUndefined)(F)){var k=this.viewer.clientArea.clone(),P=this.viewer.clientActiveArea.clone(),T=I.childWidgets[I.childWidgets.length-1],S=T.y+T.height;this.viewer.clientActiveArea.height=this.viewer.clientActiveArea.bottom-S,this.viewer.clientActiveArea.x=this.viewer.clientArea.x,this.viewer.clientActiveArea.width=this.viewer.clientArea.width,this.viewer.clientActiveArea.y=S,this.layoutfootNote(F),this.viewer.clientArea=k,this.viewer.clientActiveArea=P}}this.documentHelper.removeEmptyPages(),this.updateFieldElements();var W=this.documentHelper.pages[0];if(W.bodyWidgets[0].sectionIndex>0){var N=W;do{this.documentHelper.layout.layoutHeaderFooter(N.bodyWidgets[0],this.viewer,N),N=N.nextPage}while(N);for(;W.bodyWidgets[0].sectionIndex>0;)this.documentHelper.owner.editor.updateSectionIndex(void 0,W.bodyWidgets[0],!1)}this.documentHelper.owner.enableLockAndEdit&&e||this.isMultiColumnSplit||x.updateScrollBars(),t.bodyWidget instanceof d.a||this.isRelayoutFootnote||!t.bodyWidget.page.endnoteWidget||this.layoutfootNote(t.bodyWidget.page.endnoteWidget)},e.prototype.isSectionEndsWithColumnBreak=function(e){if(!i.i(n.isNullOrUndefined)(e)&&e.childWidgets.length>0&&e.lastChild instanceof d.g){return e.lastChild.isEndsWithColumnBreak}return!1},e.prototype.checkAndShiftEndnote=function(){if(this.documentHelper.owner.selection){var e=this.documentHelper.owner.selection.end.paragraph;e.isInsideTable&&(e=this.getParentTable(e)),e.isInHeaderFooter||e.bodyWidget.containerWidget instanceof d.a||!i.i(n.isNullOrUndefined)(e.nextRenderedWidget)||e.bodyWidget instanceof d.a||this.isRelayoutFootnote||!e.bodyWidget.page.endnoteWidget||this.layoutfootNote(e.bodyWidget.page.endnoteWidget)}},e.prototype.updateFieldElements=function(){for(var e=0;e<this.documentHelper.fields.length;e++){var t=this.documentHelper.fields[e];if((this.viewer instanceof h.b||this.viewer instanceof h.a&&!(t.line.paragraph.bodyWidget instanceof d.x))&&!i.i(n.isNullOrUndefined)(this.documentHelper.selection)){var r=this.documentHelper.selection.getFieldCode(t);if(!i.i(n.isNullOrUndefined)(r)&&(r.toLowerCase().match("numpages")||r.toLowerCase().match("sectionpages"))&&!i.i(n.isNullOrUndefined)(t.fieldSeparator)){var o=t.fieldSeparator.nextNode;if(!i.i(n.isNullOrUndefined)(o)){var s=o.text;o.text=this.documentHelper.pages.length.toString();var a=t.line.paragraph;if(!i.i(n.isNullOrUndefined)(a.bodyWidget)&&!i.i(n.isNullOrUndefined)(a.bodyWidget.page)&&s!==o.text){var l=a.childWidgets.indexOf(t.line),c=t.line.children.indexOf(o);a.isInsideTable?this.reLayoutParagraph(a,l,c):this.reLayoutLine(a,l,!1,!1,!0)}}}}}},e.prototype.reLayoutOrShiftWidgets=function(e,t){var i=e,n=!1;if(this.isNeedToRelayout(e.bodyWidget)?(this.isMultiColumnSplit||this.updateContainerForTable(i,t),i instanceof d.u&&(i=i.combineWidget(this.viewer),this.clearTableWidget(i,!0,!0,!0)),t.updateClientAreaForBlock(i,!0),this.isRelayout=!0,this.layoutBlock(i,0),this.isRelayout=!1,t.updateClientAreaForBlock(i,!1),n=!0):this.shiftWidgetsBlock(i,t),this.documentHelper.pages.indexOf(i.bodyWidget.page)>0&&i===i.bodyWidget.childWidgets[0]&&i instanceof d.g)for(var r=i.bodyWidget.childWidgets[0].childWidgets[0].children,o=0;o<r.length;o++){var s=r[o];s.margin.top>0&&s.margin.top===this.getBeforeSpacing(s.paragraph)&&(s.margin.top-=this.getBeforeSpacing(s.paragraph))}this.viewer.owner.editorModule&&!n&&this.viewer.owner.editorModule.updateRenderedListItems(i),!this.isRelayoutFootnote&&i.bodyWidget.page.footnoteWidget&&this.layoutfootNote(i.bodyWidget.page.footnoteWidget)},e.prototype.isNeedToRelayout=function(e){for(var t=0;t<e.floatingElements.length;t++){var i=e.floatingElements[t];if(i instanceof d.u||i instanceof d.v&&("Square"===i.textWrappingStyle||"TopAndBottom"===i.textWrappingStyle))return!0}return!1},e.prototype.shiftWidgetsBlock=function(e,t){e instanceof d.g?this.shiftWidgetsForPara(e,t):e instanceof d.u&&this.shiftWidgetsForTable(e,t)},e.prototype.shiftWidgetsForPara=function(e,t){if(!(e.height>t.clientArea.height+t.clientArea.y)||this.documentHelper.owner.enableHeaderAndFooter){for(var r=(e.bodyWidget,this.getBodyWidgetOfPreviousBlock(e,0)),o=r.bodyWidget,a=r.index,l=void 0,c=!1,p=!0,u=0;u<e.getSplitWidgets().length;u++){var g=e.getSplitWidgets()[u],f=this.getBodyWidget(g.bodyWidget,!0);if(!this.isMultiColumnSplit||g===e){if(p&&!i.i(n.isNullOrUndefined)(l)){var m=!!l.lastChild&&l.lastChild.isEndsWithPageBreak,v=!!l.lastChild&&l.lastChild.isEndsWithColumnBreak;if(this.shiftToPreviousWidget(g,t,l,m,v),this.updateFloatingElementPosition(l),(i.i(n.isNullOrUndefined)(g.childWidgets)||0===g.childWidgets.length)&&!m&&!v){u--;continue}l=void 0,o!==g.containerWidget&&(o=g.containerWidget,m&&t.updateClientAreaByWidget(g))}var y=[];if(c||(y=this.getFootNoteWidgetsOf(g)),c=!1,this.isFitInClientArea(g,t,y)||this.isMultiColumnSplit){if(this.keepWithNext&&(this.updateClientPositionForBlock(g.containerWidget.firstChild,g),this.keepWithNext=!1),l=g,t.updateClientAreaForBlock(g,!0,void 0,!1,!0),g.isEmpty()&&!i.i(n.isNullOrUndefined)(g.paragraphFormat)&&("Center"===g.paragraphFormat.textAlignment||"Right"===g.paragraphFormat.textAlignment||"Justify"===g.paragraphFormat.textAlignment&&g.paragraphFormat.bidi)&&-1===g.paragraphFormat.listFormat.listId?this.updateXPositionForEmptyParagraph(t.clientActiveArea,g):g.x=t.clientActiveArea.x,t.updateClientAreaForBlock(g,!1),g.y=t.clientActiveArea.y,this.updateFloatingElementPosition(g),t.cutFromTop(t.clientActiveArea.y+g.height),i.i(n.isNullOrUndefined)(o)||o===g.containerWidget||this.isMultiColumnSplit){if(g.containerWidget instanceof d.o&&g.containerWidget.firstChild===g&&g.previousRenderedWidget&&g.previousRenderedWidget instanceof d.g&&"NoBreak"==g.previousRenderedWidget.containerWidget.sectionFormat.breakCode&&g.containerWidget.page.index!==g.previousRenderedWidget.containerWidget.page.index&&g.containerWidget.index!==g.previousRenderedWidget.containerWidget.index){var w=g.previousRenderedWidget.bodyWidget,b=w.sectionFormat.breakCode;w.sectionFormat.columns.length>1&&(w=this.getBodyWidget(w,!0)),i.i(n.isNullOrUndefined)(w.previousRenderedWidget)||"NoBreak"!==w.sectionFormat.breakCode||"NewPage"!=w.previousRenderedWidget.sectionFormat.breakCode||w.page.index!==w.previousRenderedWidget.page.index||(b=w.previousRenderedWidget.sectionFormat.breakCode);var x=s.a.round(this.getNextWidgetHeight(w)+g.height,2);if(!g.previousRenderedWidget.containerWidget.lastChild.isEndsWithPageBreak&&!g.previousRenderedWidget.containerWidget.lastChild.isEndsWithColumnBreak&&x<=s.a.round(this.viewer.clientActiveArea.bottom,2)&&"NoBreak"===b){for(var C=g.previousRenderedWidget.bodyWidget.page,I=g.containerWidget.page,F=0;F<I.bodyWidgets.length;F++){var k=I.bodyWidgets[F];I.bodyWidgets.splice(I.bodyWidgets.indexOf(k),1),C.bodyWidgets.splice(C.bodyWidgets.length,0,k),k.page=C,F--}g.containerWidget.y=this.viewer.clientActiveArea.y,this.documentHelper.removeEmptyPages()}}}else if(a++,o.lastChild.isEndsWithPageBreak||o.lastChild.isEndsWithColumnBreak||this.updateContainerWidget(g,o,a,!0,y),y.length>0&&o.page.footnoteWidget)for(var P=0;P<y.length;P++)-1===o.page.footnoteWidget.bodyWidgets.indexOf(y[P])&&g.bodyWidget.page.index!=y[P].page.index&&(o.page.footnoteWidget.bodyWidgets.push(y[P]),o.page.footnoteWidget.height+=y[P].height);if(!this.isInitialLoad&&p&&g.bodyWidget.sectionFormat.columns.length>1&&g===g.bodyWidget.firstChild&&!i.i(n.isNullOrUndefined)(f.previousWidget)&&f.page===f.previousWidget.page){this.viewer.updateClientArea(g.bodyWidget,g.bodyWidget.page),f=this.getBodyWidget(f.previousWidget,!0);var T=this.getNextWidgetHeight(f);g.bodyWidget.y=T,this.viewer.clientActiveArea.height-=T-this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.y=T,p=!1,u--}if((g.isEndsWithPageBreak&&!this.isPageBreakInsideField(g)||g.isEndsWithColumnBreak)&&this.viewer instanceof h.b){var k=this.createOrGetNextBodyWidget(o,this.viewer);k=this.moveBlocksToNextPage(g,!0),t.updateClientArea(k,k.page)}}else{var S=g.previousRenderedWidget,m=!1,v=!1;S instanceof d.g&&S.isEndsWithPageBreak&&this.viewer instanceof h.b&&(m=!0),S instanceof d.g&&S.isEndsWithColumnBreak&&this.viewer instanceof h.b&&(v=!0);var W=this.splitWidget(g,t,o,a+1,m,y,v);this.updateFloatingElementPosition(g),l=void 0,o!==g.containerWidget&&(o=g.containerWidget,u--,y.length>0&&(c=!0)),a=o.childWidgets.indexOf(g),W&&(o=e.getSplitWidgets()[u+1].containerWidget)}}}this.skipUpdateContainerWidget=!1}},e.prototype.updateFloatingElementPosition=function(e){if(e.floatingElements.length>0)for(var t=0;t<e.floatingElements.length;t++){var r=e.floatingElements[t],o=0;if(r instanceof d.s&&"Inline"===r.textWrappingStyle){var a=r.line.indexInOwner,l=0;o=s.a.convertPointToPixel(r.textFrame.marginTop);for(var h=0;h<a;h++)i.i(n.isNullOrUndefined)(e.childWidgets[h])||(l+=e.childWidgets[h].height);r.y=e.y+l}else{var c=this.getFloatingItemPoints(r);r.y=c.y,r.x=c.x}r instanceof d.s&&this.updateChildLocationForCellOrShape(r.y+o,r,void 0,!1,!0)}},e.prototype.isPageBreakInsideField=function(e){for(var t=!1,i=!1,n=0,r=0;r<e.childWidgets.length;r++){var o=e.childWidgets[r];n+=o.height;for(var s=0;s<o.children.length;s++){var a=o.children[s];a instanceof d.b&&(0===a.fieldType?i=!0:2!==a.fieldType&&1!==a.fieldType||(i=!1)),t=!(!i&&"\f"===a.text)}}return t&&0===e.height&&this.viewer.cutFromTop(this.viewer.clientActiveArea.y+n),t},e.prototype.getFootNotesOfBlock=function(e,t){if(i.i(n.isNullOrUndefined)(t)&&(t=[]),e.childWidgets.length>0)for(var r=0;r<this.documentHelper.footnoteCollection.length;r++)this.documentHelper.footnoteCollection[r].line.paragraph===e&&t.push(this.documentHelper.footnoteCollection[r]);return t},e.prototype.getFootNotesWidgetsInLine=function(e){for(var t=[],i=0;i<e.children.length;i++){var n=e.children[i];n instanceof d.f&&t.push(n)}return this.getFootNoteWidgetsBy(e.paragraph,t)},e.prototype.getFootNoteWidgetsBy=function(e,t){var r=[];if(e.bodyWidget.page.footnoteWidget)for(var o=0;o<e.bodyWidget.page.footnoteWidget.bodyWidgets.length;o++)for(var s=0;s<t.length;s++)e.bodyWidget.page.footnoteWidget.bodyWidgets[o].footNoteReference===t[s]&&r.push(e.bodyWidget.page.footnoteWidget.bodyWidgets[o]);if(0===r.length&&!i.i(n.isNullOrUndefined)(e.previousRenderedWidget)&&e.previousRenderedWidget.bodyWidget.page.footnoteWidget)for(var o=0;o<e.previousRenderedWidget.bodyWidget.page.footnoteWidget.bodyWidgets.length;o++)for(var s=0;s<t.length;s++)e.previousRenderedWidget.bodyWidget.page.footnoteWidget.bodyWidgets[o].footNoteReference===t[s]&&r.push(e.previousRenderedWidget.bodyWidget.page.footnoteWidget.bodyWidgets[o]);else if(!i.i(n.isNullOrUndefined)(e.bodyWidget.previousRenderedWidget)&&e.bodyWidget.previousRenderedWidget.page.footnoteWidget)for(var o=0;o<e.bodyWidget.previousRenderedWidget.page.footnoteWidget.bodyWidgets.length;o++)for(var s=0;s<t.length;s++)e.bodyWidget.previousRenderedWidget.page.footnoteWidget.bodyWidgets[o].footNoteReference===t[s]&&r.push(e.bodyWidget.previousRenderedWidget.page.footnoteWidget.bodyWidgets[o]);else if(!i.i(n.isNullOrUndefined)(e.bodyWidget.nextRenderedWidget)&&e.bodyWidget.nextRenderedWidget.page.footnoteWidget)for(var o=0;o<e.bodyWidget.nextRenderedWidget.page.footnoteWidget.bodyWidgets.length;o++)for(var s=0;s<t.length;s++)e.bodyWidget.nextRenderedWidget.page.footnoteWidget.bodyWidgets[o].footNoteReference===t[s]&&r.push(e.bodyWidget.nextRenderedWidget.page.footnoteWidget.bodyWidgets[o]);return r},e.prototype.getFootNoteWidgetsOf=function(e,t){var i=[],n=[];if(e instanceof d.u)for(var r=0;r<e.childWidgets.length;r++)for(var o=e.childWidgets[r],s=0;s<o.childWidgets.length;s++)for(var a=o.childWidgets[s],l=0;l<a.childWidgets.length;l++){var h=a.childWidgets[l];n=this.getFootNotesOfBlock(h,n);for(var c=this.getFootNoteWidgetsBy(h,n),p=0;p<c.length;p++)-1===i.indexOf(c[p])&&i.push(c[p])}else if(n=this.getFootNotesOfBlock(e),n.length>0&&(i=this.getFootNoteWidgetsBy(e,n)),t&&0===i.length)for(var u=0;u<n.length;u++)i.push(n[u].bodyWidget);return i},e.prototype.getFootNodeWidgetsToShiftToPage=function(e){for(var t,i=e.getSplitWidgets(),n=[],r=e.containerWidget,o=0;o<i.length;o++)for(var s=this.getFootNoteWidgetsOf(i[o]),a=0;a<s.length;a++)t=s[a].containerWidget,r!==t&&n.push(s[a]);return{footNoteWidgets:n,fromBodyWidget:t,toBodyWidget:r}},e.prototype.shiftTableWidget=function(e,t,i){void 0===i&&(i=!1);var n=[e];this.addTableWidget(this.viewer.clientActiveArea,n),this.viewer.updateClientAreaTopOrLeft(e,!0);var r,o;e.wrapTextAround&&(r=this.viewer.clientActiveArea.clone(),o=this.viewer.clientArea.clone(),this.updateClientAreaForWrapTable(n,e,!0,r,o));for(var s=e.childWidgets[0];s;)s=this.shiftRowWidget(n,s,i),s=s.nextRow;return this.updateWidgetsToPage(n,[],e,!0),e.wrapTextAround&&e.bodyWidget&&this.updateClientAreaForWrapTable(n,e,!1,r,o),n[n.length-1]},e.prototype.shiftRowWidget=function(e,t,i){void 0===i&&(i=!1);var n=this.viewer;i&&(t.height=0);var r=t.ownerTable.isInsideTable;r||this.updateExistingFootnoteHeight(t);var o=[t];this.addTableRowWidget(n.clientActiveArea,o),n.updateClientAreaForRow(t,!0);for(var s=0;s<t.childWidgets.length;s++){var a=t.childWidgets[s];i&&(a.height=0),this.shiftCellWidget(a,this.getMaxTopCellMargin(t)+t.topBorderWidth,this.getMaxBottomCellMargin(t)+t.bottomBorderWidth,i)}if(n.updateClientAreaForRow(t,!1),!r){var l=this.footnoteHeight;this.updateFootnoteToBody(t,this.layoutedFootnoteElement),this.footnoteHeight=l}return this.updateWidgetsToTable(e,o,t,!1),r||(this.layoutedFootnoteElement=[]),o[o.length-1]},e.prototype.updateFootnoteToBody=function(e,t){this.layoutFootnoteInSplittedRow(e,this.getFootnoteBody(t)),i.i(n.isNullOrUndefined)(e.ownerTable.footnoteElement)&&(e.ownerTable.footnoteElement=[]);for(var r=0;r<t.length;r++)e.ownerTable.footnoteElement.push(t[r])},e.prototype.getFootnoteBody=function(e){for(var t=[],i=0;i<e.length;i++)t.push(e[i].bodyWidget);return t},e.prototype.shiftCellWidget=function(e,t,r,o){i.i(n.isNullOrUndefined)(o)&&(o=!1);var s=this.viewer;this.addTableCellWidget(e,s.clientActiveArea,t,r);var a=this.viewer.clientActiveArea.height;s.updateClientAreaForCell(e,!0);for(var l=0;l<e.childWidgets.length;l++){var h=e.childWidgets[l];s.updateClientAreaForBlock(h,!0),h instanceof d.g?this.shiftParagraphWidget(h):this.shiftTableWidget(h,s,o),s.updateClientAreaForBlock(h,!1)}this.updateWidgetToRow(e),s.updateClientAreaForCell(e,!1),e.ownerTable.isInsideTable||(this.viewer.clientActiveArea.height=a)},e.prototype.shiftParagraphWidget=function(e){if(this.addParagraphWidget(this.viewer.clientActiveArea,e),e.floatingElements.length>0)for(var t=0;t<e.floatingElements.length;t++){var i=e.floatingElements[t],n=0;if(i instanceof d.s&&"Inline"===i.textWrappingStyle){var r=i.line.indexInOwner,o=0;n=s.a.convertPointToPixel(i.textFrame.marginTop);for(var a=0;a<r;a++)o+=e.childWidgets[a].height;i.y=e.y+o}else{var l=this.getFloatingItemPoints(i);i.y=l.y,i.x=l.x}i instanceof d.s&&this.updateChildLocationForCellOrShape(i.y+n,i)}this.viewer.cutFromTop(this.viewer.clientActiveArea.y+e.height);for(var h=this.getFootNoteWidgetsOf(e,!0),c=0;c<h.length;c++)this.layoutedFootnoteElement.push(h[c].footNoteReference);this.footnoteHeight+=this.getFootNoteHeight(h),this.updateWidgetToPage(this.viewer,e)},e.prototype.updateContainerForTable=function(e,t){var i=this.getBodyWidgetOfPreviousBlock(e,0),n=i.bodyWidget,r=i.index,o=n.lastChild.lastChild.isEndsWithPageBreak,s=n.lastChild.lastChild.isEndsWithColumnBreak;n!==e.containerWidget&&(o||s?t.updateClientArea(e.bodyWidget,e.bodyWidget.page):this.updateContainerWidget(e,n,r+1,!0)),(e.isInHeaderFooter||this.viewer instanceof h.a)&&(e.containerWidget.height-=e.height)},e.prototype.shiftWidgetsForTable=function(e,t){this.updateContainerForTable(e,t),this.viewer.updateClientAreaForBlock(e,!0,void 0,!1,!0);var i=this.viewer.clientArea.x;"Word2013"===this.documentHelper.compatibilityMode||e.isInsideTable||(this.viewer.clientActiveArea.x=this.viewer.clientActiveArea.x-s.a.convertPointToPixel(e.firstChild.firstChild.leftMargin)),this.updateVerticalPositionToTop(e,!0);var n=e.combineWidget(this.viewer);this.documentHelper.layout.updateChildLocationForTable(n.y,n),this.clearTableWidget(n,!0,!1,!1,!0),this.shiftTableWidget(n,this.viewer),this.updateVerticalPositionToTop(e,!1),"Word2013"===this.documentHelper.compatibilityMode||e.isInsideTable||(this.viewer.clientArea.x=i),this.viewer.updateClientAreaForBlock(e,!1)},e.prototype.updateVerticalPositionToTop=function(e,t){for(var i=0;i<e.getSplitWidgets().length;i++)for(var n=e.getSplitWidgets()[i],r=0;r<n.childWidgets.length;r++)for(var o=n.childWidgets[r],s=0;s<o.childWidgets.length;s++){var a=o.childWidgets[s];this.documentHelper.layout.updateCellVerticalPosition(a,t,!1)}},e.prototype.splitWidget=function(e,t,r,o,s,a,l){var h=e.childWidgets[0],c=e.paragraphFormat.keepLinesTogether&&this.viewer.clientActiveArea.y!==this.viewer.clientArea.y,p=c?e.height:this.getMaxElementHeight(h),u=e.getSplitWidgets(),g=e.containerWidget;p=this.getMaximumLineHeightToSplit(e,p,t);var f=this.getFootNotesWidgetsInLine(h);if(i.i(n.isNullOrUndefined)(e.previousWidget)&&f.length>0)for(var m=0;m<f.length;m++)for(var v=0;v<f[m].childWidgets.length;v++)p+=f[m].childWidgets[v].height;if(t.clientActiveArea.height>=p&&!s&&!l){var y=void 0,w=u.indexOf(e);w<u.length-1?(y=u[w+1],g=y.containerWidget):(y=new d.g,y.index=e.index,y.characterFormat=e.characterFormat,y.paragraphFormat=e.paragraphFormat,y.width=e.width,y.x=e.x,y.y=e.y,u.push(y)),r===e.containerWidget||this.skipUpdateContainerWidget||this.updateContainerWidget(e,r,o,!0);for(var m=e.childWidgets.length-1;m>0;m--){var b=e.childWidgets[m];if(this.isFitInClientArea(e,t,void 0)){1===y.childWidgets.length&&(this.updateParagraphWidgetInternal(b,y,0),this.skipUpdateContainerWidget=!0);break}var x=e.childWidgets[m];this.updateParagraphWidgetInternal(x,y,0)}if(i.i(n.isNullOrUndefined)(y.containerWidget)&&y.childWidgets.length>0){var C=t.clientActiveArea.y,I=new d.t(t.clientArea.x,t.clientArea.y,t.clientArea.width,t.clientArea.height),F=new d.t(t.clientActiveArea.x,t.clientActiveArea.y,t.clientActiveArea.width,t.clientActiveArea.height),k=e.bodyWidget.page;if(g=this.moveBlocksToNextPage(e,!1,-1),y.containerWidget=g,g.childWidgets.splice(0,0,y),k===g.page)return e.x!==e.containerWidget.x&&(e.x=e.containerWidget.x),e.y=C,t.updateClientArea(g,g.page),y=this.addParagraphWidget(this.viewer.clientActiveArea,y),!0;if(g.height+=y.height,g!=r&&this.moveFootNotesToPage(a,r,g),1===g.childWidgets.length&&g.firstChild instanceof d.g&&g.firstChild.equals(e))return e.y=C,!0;t.clientArea=I,t.clientActiveArea=F}}else{var P=void 0,T=!1;t.columnLayoutArea.setColumns(r.sectionFormat),g=this.createOrGetNextBodyWidget(r,this.viewer);var S=this.alignBlockElement(e);if(this.isInitialLoad||i.i(n.isNullOrUndefined)(S.node)||e.isEndsWithPageBreak||e.isEndsWithColumnBreak||(P=S.node instanceof d.z?this.splitRow(S.node):S.node,P.containerWidget instanceof d.o&&P.containerWidget.firstChild!==P&&(e=P,T=!0,!i.i(n.isNullOrUndefined)(e.nextRenderedWidget)&&e.nextRenderedWidget instanceof d.g&&(this.keepWithNext=!0,this.documentHelper.blockToShift=e.nextRenderedWidget))),e.containerWidget!==g||T){var k=e.bodyWidget.page;if(g=this.moveBlocksToNextPage(e,!0),r!==g&&(t.updateClientArea(g,g.page),this.updateContainerWidget(e,g,0,!0),this.addParagraphWidget(this.viewer.clientActiveArea,e),this.moveFootNotesToPage(a,r,g)),r.page===g.page)return r!==g||(t.updateClientArea(g,g.page),!1)}}return r===e.containerWidget?(e.x!==e.containerWidget.x&&(e.x=e.containerWidget.x),e.y=t.clientActiveArea.y,t.cutFromTop(t.clientActiveArea.y+e.height)):t.updateClientArea(g,g.page),!1},e.prototype.getMaximumLineHeightToSplit=function(e,t,r){if(r.clientActiveArea.height>=t&&!e.paragraphFormat.keepLinesTogether&&e.paragraphFormat.widowControl&&!i.i(n.isNullOrUndefined)(e.previousWidget)&&i.i(n.isNullOrUndefined)(e.previousSplitWidget))for(var o=e.height,s=e.childWidgets.length-1;s>=0;s--){var a=e.childWidgets[s],l=this.getMaxElementHeight(a);if(a.height>l&&(o-=a.height-l),r.clientActiveArea.height>=o){0===s&&(t=e.height);break}o-=a.height}return t},e.prototype.moveFootNotesToPage=function(e,t,i){if(e.length>0&&t.page.footnoteWidget&&t.page!==i.page){for(var n=-1,r=void 0,o=0,s=!1,a=0;a<e.length;a++)if(r=e[a],(n=t.page.footnoteWidget.bodyWidgets.indexOf(r))>=0){void 0===i.page.footnoteWidget&&this.addEmptyFootNoteToBody(i);for(var l=0;l<i.page.footnoteWidget.bodyWidgets.length;l++){var d=i.page.footnoteWidget.bodyWidgets[l].footNoteReference;d===r.footNoteReference&&(s=!0)}if(t.page.footnoteWidget.bodyWidgets.splice(n,1),i.page.footnoteWidget.bodyWidgets.indexOf(r)<0&&!s){var h=(i.page.footnoteWidget.bodyWidgets.length,this.documentHelper.pages.indexOf(t.page)),c=this.documentHelper.pages.indexOf(i.page);r.containerWidget=i.page.footnoteWidget,r.page=i.page,h>c?(i.page.footnoteWidget.bodyWidgets.push(r),o++):i.page.footnoteWidget.bodyWidgets.splice(o++,0,r),i.page.footnoteWidget.height+=r.height}t.page.footnoteWidget.height-=r.height}t.page.footnoteWidget&&0===t.page.footnoteWidget.bodyWidgets.length&&(t.page.footnoteWidget=void 0),void 0!==t.page.footnoteWidget&&this.layoutfootNote(t.page.footnoteWidget),void 0!==i.page.footnoteWidget&&this.layoutfootNote(i.page.footnoteWidget)}},e.prototype.addEmptyFootNoteToBody=function(e){var t=new d.a;t.footNoteType="Footnote",t.page=e.page;var i=new d.g;i.characterFormat=new a.c,i.paragraphFormat=new a.a,i.index=0;var n=new d.p(i);i.childWidgets.push(n),t.height=this.documentHelper.textHelper.getParagraphMarkSize(i.characterFormat).Height,t.margin=new d.E(0,t.height,0,0),e.page.footnoteWidget=t},e.prototype.getMaxElementHeight=function(e){var t=0;if(0===e.children.length||1===e.children.length&&e.children[0]instanceof d.q||2===e.children.length&&e.children[0]instanceof d.q&&e.children[1]instanceof d.q){if(t=this.documentHelper.selection.getParagraphMarkSize(e.paragraph,0,0).height,t+=0,e.children.length>0){var i=e.children[0];t<i.margin.top+i.height&&(t=i.margin.top+i.height)}}else for(var n=0;n<e.children.length;n++){var i=e.children[n];t<i.margin.top+i.height&&(t=i.margin.top+i.height)}return t},e.prototype.createOrGetNextBodyWidget=function(e,t){t.columnLayoutArea.setColumns(e.sectionFormat);var r=t.columnLayoutArea.getNextColumnByBodyWidget(e);if(!i.i(n.isNullOrUndefined)(r)){return this.createOrGetNextColumnBody(e)}var o=void 0,s=0;s=this.documentHelper.pages.indexOf(e.page);var a=void 0,l=void 0;if(l=e.index,s===this.documentHelper.pages.length-1||this.documentHelper.pages[s+1].sectionIndex!==l){var h=new d.o;h.sectionFormat=e.sectionFormat,h.index=e.index,a=t.createNewPage(h),this.documentHelper.pages[s+1].sectionIndex!==l&&this.documentHelper.insertPage(s+1,a),o=a.bodyWidgets[0]}else a=this.documentHelper.pages[s+1],o=a.bodyWidgets[0];return o},e.prototype.isFitInClientArea=function(e,t,r){var o=e.childWidgets[e.childWidgets.length-1],s=e.height,a=this.getMaxElementHeight(o);o.height>a&&(s-=o.height-a);var l=0;if(!i.i(n.isNullOrUndefined)(r)&&r.length>0){r[0].containerWidget instanceof d.a&&(l=r[0].containerWidget.margin.top);for(var h=0;h<r.length;h++)for(var c=0;c<r[h].childWidgets.length;c++)l+=r[h].childWidgets[c].height}return t.clientActiveArea.height>=s+l},e.prototype.isLineInFootNote=function(e,t){for(var i=0;i<t.length;i++)if(t[i].line===e)return!0;return!1},e.prototype.shiftToPreviousWidget=function(e,t,r,o,s){var a=e.containerWidget,l=r.containerWidget,d=[],h=[];l!==a&&(d=this.getFootNotesOfBlock(e));for(var c=0;c<e.childWidgets.length;c++){var p=e.childWidgets[c],u=this.getMaxElementHeight(p);if(this.isLineInFootNote(p,d)){for(var g=this.getFootNoteWidgetsBy(p.paragraph,d),f=0,m=0;m<g.length;m++)for(var v=g[m],y=0;y<v.childWidgets.length;y++)f+=v.childWidgets[y].height;g.length>0&&g[0].containerWidget&&(f+=g[0].containerWidget.margin.top),u+=f}if(!(t.clientActiveArea.height>=u)||o||s){var w=r.containerWidget;t.updateClientArea(w,w.page);var b=this.createOrGetNextBodyWidget(w,t);e.containerWidget!==b&&(b=this.moveBlocksToNextPage(e,!0)),w!==b&&(d=this.getFootNotesOfBlock(e),d.length>0&&(h=h.concat(this.getFootNoteWidgetsBy(e,d)),l=b),this.updateContainerWidget(e,b,0,!0)),t.updateClientArea(b,b.page);break}if(d.length>0&&this.isLineInFootNote(p,d)&&(h=h.concat(this.getFootNoteWidgetsBy(p.paragraph,d))),this.updateParagraphWidgetInternal(p,r,r.childWidgets.length),c--,t.cutFromTop(t.clientActiveArea.y+p.height),i.i(n.isNullOrUndefined)(e.childWidgets))break}!i.i(n.isNullOrUndefined)(h)&&h.length>0&&a.page.footnoteWidget&&a!=l&&this.moveFootNotesToPage(h,a,l)},e.prototype.updateParagraphWidgetInternal=function(e,t,r){i.i(n.isNullOrUndefined)(e.paragraph)||(e.paragraph.childWidgets.splice(e.paragraph.childWidgets.indexOf(e),1),e.paragraph.height-=e.height,i.i(n.isNullOrUndefined)(e.paragraph.containerWidget)||(e.paragraph.containerWidget.height-=e.height),(i.i(n.isNullOrUndefined)(e.paragraph.childWidgets)||0===e.paragraph.childWidgets.length)&&e.paragraph.destroyInternal(this.viewer)),!i.i(n.isNullOrUndefined)(e.paragraph)&&e.paragraph.floatingElements.length>0&&this.shiftFloatingElements(e,t),t.childWidgets.splice(r,0,e),e.paragraph=t,t.height+=e.height,i.i(n.isNullOrUndefined)(t.containerWidget)||(t.containerWidget.height+=e.height)},e.prototype.shiftFloatingElements=function(e,t){for(var i=0;i<e.children.length;i++)if(e.children[i]instanceof d.s&&"Inline"===e.children[i].textWrappingStyle){var n=e.paragraph.floatingElements.indexOf(e.children[i]);n>=0&&(e.paragraph.floatingElements.splice(n,1),t.floatingElements.splice(n,0,e.children[i]))}},e.prototype.shiftNextWidgets=function(e){for(var t=e;t.nextWidget instanceof d.C;){if(t=t.nextWidget,this.viewer instanceof h.b&&!this.isMultiColumnSplit&&t.bodyWidget.sectionFormat.columns.length>1){var r=this.getBodyWidget(t.bodyWidget,!1);if(!i.i(n.isNullOrUndefined)(r.nextRenderedWidget)&&r.page===r.nextRenderedWidget.page){this.splitBodyWidgetBasedOnColumn(t.bodyWidget);break}}this.reLayoutOrShiftWidgets(t,this.viewer)}},e.prototype.updateContainerWidget=function(e,t,r,o,s){if(!(e.containerWidget&&e.containerWidget.containerWidget instanceof d.a)){var a=e.containerWidget;if(!i.i(n.isNullOrUndefined)(e.containerWidget)&&(e.containerWidget.childWidgets.splice(e.containerWidget.childWidgets.indexOf(e),1),e.containerWidget.height-=t.height,(i.i(n.isNullOrUndefined)(e.containerWidget.childWidgets)||0===e.containerWidget.childWidgets.length)&&e.containerWidget instanceof d.o&&e.containerWidget!==t&&o)){var l=e.containerWidget.page;if(this.documentHelper.pages[this.documentHelper.pages.length-1]===l&&-1!==this.viewer.visiblePages.indexOf(l)&&this.documentHelper.scrollToBottom(),i.i(n.isNullOrUndefined)(l.nextPage)||l.nextPage.bodyWidgets[0].index!==e.containerWidget.index){var h=e.containerWidget;!i.i(n.isNullOrUndefined)(h.nextRenderedWidget)&&h.nextRenderedWidget.sectionFormat.columns.length>1&&(h.nextRenderedWidget.columnIndex=h.columnIndex),e.containerWidget.destroyInternal(this.viewer)}}if(t.childWidgets.splice(r,0,e),e instanceof d.g&&!i.i(n.isNullOrUndefined)(e.floatingElements))for(var c=0;c<e.floatingElements.length;c++){var p=e.floatingElements[c];"Inline"!==p.textWrappingStyle&&(t.floatingElements.push(p),e.bodyWidget.floatingElements.splice(e.bodyWidget.floatingElements.indexOf(p),1),t.floatingElements.sort(function(e,t){return e.y-t.y}))}e instanceof d.u&&e.wrapTextAround&&-1!==e.bodyWidget.floatingElements.indexOf(e)&&e.bodyWidget.floatingElements.splice(e.bodyWidget.floatingElements.indexOf(e),1),t.height+=t.height,e.containerWidget=t,a&&a.page&&a.page.footnoteWidget&&s&&s.length>0&&this.moveFootNotesToPage(s,a,t)}},e.prototype.getBodyWidgetOfPreviousBlock=function(e,t){t=0;var i=void 0,n=e.previousRenderedWidget;return i=n&&n.containerWidget.equals(e.containerWidget)?n.containerWidget:e.containerWidget,t=n&&n.containerWidget.equals(e.containerWidget)?i.childWidgets.indexOf(n):e.containerWidget.childWidgets.indexOf(e),{bodyWidget:i,index:t}},e.prototype.moveBlocksToNextPage=function(e,t,r,o){var s=e.bodyWidget;this.viewer.columnLayoutArea.setColumns(s.sectionFormat);var a=this.viewer.columnLayoutArea.getNextColumnByBodyWidget(e.bodyWidget),l=void 0,h=void 0;if(!(i.i(n.isNullOrUndefined)(a)||e instanceof d.g&&e.isEndsWithPageBreak)&&(h=this.moveToNextColumnByBodyWidget(e,r),h.columnIndex=a.index,h.y=e.bodyWidget.y,this.viewer.updateClientArea(h,h.page),this.viewer.clientActiveArea.height-=h.y-this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.y=h.y,e.bodyWidget.sectionFormat.columns.length>1))for(var c=e.bodyWidget.columnIndex,p=e.bodyWidget.x+e.bodyWidget.sectionFormat.columns[c].width+e.bodyWidget.sectionFormat.columns[c].space,u=0;u<e.bodyWidget.floatingElements.length;u++)e.bodyWidget.floatingElements[u]instanceof d.s&&p<e.bodyWidget.floatingElements[u].x+e.bodyWidget.floatingElements[u].width&&h.floatingElements.push(e.bodyWidget.floatingElements[u]);if(i.i(n.isNullOrUndefined)(h)){var g=!1,f=s.page,m=f.index+1;if(this.documentHelper.pages.length>m&&(l=this.documentHelper.pages[m],i.i(n.isNullOrUndefined)(l)||0===l.bodyWidgets.length||s.sectionFormat.pageHeight!==l.bodyWidgets[0].sectionFormat.pageHeight||s.sectionFormat.pageWidth!==l.bodyWidgets[0].sectionFormat.pageWidth||"NoBreak"!==s.sectionFormat.breakCode?0!==l.bodyWidgets.length&&s.equals(l.bodyWidgets[0])?(h=l.bodyWidgets[0],this.viewer.updateClientArea(h,h.page)):(l=void 0,g=!0):l.bodyWidgets[0].index===s.index?(h=l.bodyWidgets[0],this.viewer.updateClientArea(h,h.page)):(h=this.createSplitBody(s),l.bodyWidgets.splice(0,0,h),h.page=l,this.viewer.updateClientArea(h,h.page),h.y=this.viewer.clientActiveArea.y)),i.i(n.isNullOrUndefined)(l)&&(h=this.createSplitBody(s),this.documentHelper.owner.editorHistory&&this.documentHelper.owner.editorHistory.isRedoing&&this.documentHelper.owner.editorHistory.currentBaseHistoryInfo&&"SectionBreakContinuous"===this.documentHelper.owner.editorHistory.currentBaseHistoryInfo.action&&"NoBreak"===e.bodyWidget.sectionFormat.breakCode||o||(l=this.viewer.createNewPage(h,m),this.viewer.updateClientArea(h,h.page),h.y=this.viewer.clientActiveArea.y),g&&!i.i(n.isNullOrUndefined)(l)&&this.documentHelper.insertPage(m,l),this.clearLineMeasures()),l)for(;;){var v=s.page.bodyWidgets[s.page.bodyWidgets.length-1];if(this.isSectionBreakCont||s===v||s.containerWidget instanceof d.a)break;s.page.bodyWidgets.splice(s.page.bodyWidgets.indexOf(v),1),l.bodyWidgets.splice(1,0,v),v.page=l}}if(this.isTextFormat){var y=s.childWidgets.indexOf(e),w=s.childWidgets.slice(y);s.childWidgets.splice(y);for(var b=0,x=w;b<x.length;b++){var C=x[b];h.childWidgets.push(C),C.containerWidget=h}}else for(;;){var I=void 0;if(I=s.lastChild instanceof d.a?s.lastChild.previousWidget:s.lastChild,t){var F=this.getFootNoteWidgetsOf(I);this.moveFootNotesToPage(F,s,h)}if(e===I)break;if(s.childWidgets.splice(s.childWidgets.indexOf(I),1),h.childWidgets.splice(0,0,I),I instanceof d.u&&-1!==s.floatingElements.indexOf(I)&&s.floatingElements.splice(s.floatingElements.indexOf(I),1),I instanceof d.g&&I.floatingElements.length>0)for(var k=0;k<I.floatingElements.length;k++)-1!==s.floatingElements.indexOf(I.floatingElements[k])&&"Inline"!==I.floatingElements[k].textWrappingStyle&&(s.floatingElements.splice(s.floatingElements.indexOf(I.floatingElements[k]),1),h.floatingElements.push(I.floatingElements[k]));I.containerWidget=h,h.height+=I.height}return h},e.prototype.createSplitBody=function(e){var t=this.addBodyWidget(this.viewer.clientActiveArea);return t.sectionFormat=e.sectionFormat,t.index=e.index,t},e.prototype.createOrGetNextColumnBody=function(e){var t;return e.nextRenderedWidget&&e.columnIndex+1===e.nextRenderedWidget.columnIndex&&(t=e.nextRenderedWidget),i.i(n.isNullOrUndefined)(t)&&(t=new d.o,t.sectionFormat=e.sectionFormat,t.index=e.index,t.page=e.page,t.y=e.y,e.containerWidget instanceof d.a?(e.containerWidget.bodyWidgets.splice(e.containerWidget.bodyWidgets.indexOf(e)+1,0,t),t.containerWidget=e.containerWidget):e.page.bodyWidgets.splice(e.page.bodyWidgets.indexOf(e)+1,0,t)),t},e.prototype.moveToNextColumnByBodyWidget=function(e,t){var i=e.containerWidget;return this.createOrGetNextColumnBody(i)},e.prototype.reLayoutLine=function(e,t,r,o,a){this.documentHelper.owner.editor.isFootnoteElementRemoved||(this.isFootnoteContentChanged=!1),this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule&&!a&&this.viewer.owner.editorModule.updateWholeListItems(e);var l;l=e.paragraphFormat.listFormat&&-1!==e.paragraphFormat.listFormat.listId?e.getSplitWidgets()[0].firstChild:e.childWidgets[t];var h;e.containerWidget instanceof d.o&&e.containerWidget.sectionFormat.numberOfColumns>1&&e.containerWidget.sectionFormat.equalWidth&&(h=l.previousLine),i.i(n.isNullOrUndefined)(h)&&(h=l),this.allowLayout&&(h.paragraph.splitTextRangeByScriptType(h.indexInOwner),h.paragraph.splitLtrAndRtlText(h.indexInOwner),h.paragraph.combineconsecutiveRTL(h.indexInOwner));var c=e.containerWidget;if(c.height-=e.height,!this.viewer.owner.enableHeaderAndFooter&&!e.isInHeaderFooter||c instanceof d.i?c instanceof d.i?this.viewer.updateClientAreaForTextBoxShape(c.containerShape,!0):this.viewer.updateClientArea(c,c.page,!0):(e.bodyWidget.isEmpty=!1,this.viewer.updateHeaderFooterClientAreaWithTop(e.bodyWidget.sectionFormat,this.documentHelper.isBlockInHeader(e),c.page)),this.viewer.updateClientAreaForBlock(e,!0),!i.i(n.isNullOrUndefined)(e.containerWidget)&&!i.i(n.isNullOrUndefined)(e.containerWidget.containerWidget)&&e.containerWidget.containerWidget instanceof d.a){var p=e.bodyWidget.containerWidget.y;return this.viewer.cutFromTop(p),this.documentHelper.owner.editor.isFootNoteInsert=!0,this.layoutfootNote(e.containerWidget.containerWidget),void(this.documentHelper.owner.editor.isFootNoteInsert=!1)}if(h.paragraph.isEmpty())this.viewer.cutFromTop(e.y),this.layoutParagraph(e,0);else{if(this.updateClientAreaForLine(h),this.layoutListItems(h.paragraph),h.isFirstLine()&&!i.i(n.isNullOrUndefined)(e.paragraphFormat)){var u=-s.a.convertPointToPixel(e.paragraphFormat.firstLineIndent);this.viewer.updateClientWidth(u)}do{h=this.layoutLine(h,0),e=h.paragraph,h=h.nextLine}while(h);this.updateWidgetToPage(this.viewer,e),this.viewer.updateClientAreaForBlock(e,!1)}this.layoutNextItemsBlock(e,this.viewer);var g=e.getSplitWidgets()[0].previousRenderedWidget;if(!(i.i(n.isNullOrUndefined)(g)||e.isEndsWithPageBreak||e.isEndsWithColumnBreak||g instanceof d.g&&(!(g instanceof d.g)||g.isEndsWithPageBreak||g.isEndsWithColumnBreak)||(this.viewer.cutFromTop(e.y+e.height),e.containerWidget===g.containerWidget||i.i(n.isNullOrUndefined)(g.containerWidget)))){var f=e.containerWidget,m=g.containerWidget,v=this.getFootNoteWidgetsOf(e);i.i(n.isNullOrUndefined)(m.page.footnoteWidget)||this.moveFootNotesToPage(v,m,f)}var y,w=this.documentHelper.pages.length,b=this.documentHelper.pages[w-1],x=b.bodyWidgets[b.bodyWidgets.length-1];if(!this.documentHelper.owner.editor.isFootnoteElementRemoved&&!this.isFootnoteContentChanged||i.i(n.isNullOrUndefined)(e.bodyWidget.page.footnoteWidget)||(y=e.bodyWidget.page.footnoteWidget,this.layoutfootNote(y)),i.i(n.isNullOrUndefined)(this.viewer.owner.editorHistory)||!this.viewer.owner.editorHistory.isRedoing||i.i(n.isNullOrUndefined)(x.page.endnoteWidget)||(this.isEndnoteContentChanged=!0),(this.documentHelper.owner.editor.isEndnoteElementRemoved||this.isEndnoteContentChanged)&&!i.i(n.isNullOrUndefined)(x.page.endnoteWidget)){y=x.page.endnoteWidget;var C=this.viewer.clientArea.clone(),I=this.viewer.clientActiveArea.clone(),F=x.childWidgets[x.childWidgets.length-1],p=F.y+F.height;this.viewer.clientActiveArea.height=this.viewer.clientActiveArea.bottom-p,this.viewer.clientActiveArea.x=this.viewer.clientArea.x,this.viewer.clientActiveArea.width=this.viewer.clientArea.width,this.viewer.clientActiveArea.y=p,this.layoutfootNote(y),this.viewer.clientArea=C,this.viewer.clientActiveArea=I}!i.i(n.isNullOrUndefined)(this.viewer.owner.editorHistory)&&this.viewer.owner.editorHistory.isRedoing&&(this.isEndnoteContentChanged=!1)},e.prototype.isContainsRtl=function(e){if(this.viewer.documentHelper.isSelectionChangedOnMouseMoved&&!this.isDocumentContainsRtl)return!1;for(var t=!1,i=0;i<e.children.length;i++)if(e.children[i]instanceof d.d&&(t=e.children[i].characterFormat.bidi||"RTL"===e.children[i].characterFormat.bdo||this.documentHelper.textHelper.isRTLText(e.children[i].text))){this.isDocumentContainsRtl||(this.isDocumentContainsRtl=t);break}return t},e.prototype.shiftElementsForRTLLayouting=function(e,t){var r=this.hasTextRangeBidi(e);if(this.isContainsRTLText(e)||t||r){for(var s=[],a=[],l=0;l<e.children.length;l++){var h=e.children[l];if(h instanceof d.d&&h.height>0&&!h.isPageBreak&&"\v"!==h.text){var c=h;a.push(c.characterFormat.bidi),"\t"==c.text?s.push(o.b.Tab):s.push(c.characterRange),h.isRightToLeft=s[s.length-1]==o.b.RightToLeft}else if(h instanceof d.B||h instanceof d.e||h instanceof d.G||h instanceof d.F||h instanceof d.H||h instanceof d.b){var p=this.isStartMarker(h),u=this.isEndMarker(h);if(p&&l<e.children.length-1){var g=this.getNextValidWidget(l+1,e);if(!i.i(n.isNullOrUndefined)(g)&&g instanceof d.d&&g.height>0){var c=g;a.push(c.characterFormat.bidi),"\t"===g.text?s.push(o.b.Tab):s.push(c.characterRange)}else a.push(!1),s.push(o.b.LeftToRight)}else!u&&l>0?(a.push(a[a.length-1]),s.push(s[s.length-1])):(a.push(!1),s.push(o.b.LeftToRight))}else h instanceof d.q&&t?(a.push(t),s.push(o.b.RightToLeft)):(a.push(!1),s.push(o.b.LeftToRight))}for(var f=-1,m=void 0,l=0;l<s.length;l++)if(l+1<a.length&&a[l]!=a[l+1])-1!=f&&(this.updateCharacterRange(e,l,f,a,s),f=-1),m=null;else{if(l>0&&l!=s.length-1&&s[l]==o.b.WordSplit&&a[l]&&s[l-1]==o.b.Number&&a[l-1]&&s[l+1]==o.b.Number&&a[l+1]&&this.isNumberNonReversingCharacter(e.children[l]))s[l]=o.b.Number;else if(s[l]==o.b.RightToLeft||s[l]==o.b.LeftToRight||s[l]==o.b.Number&&-1!=f||(i.i(n.isNullOrUndefined)(m)||!m)&&a[l])if(-1==f&&s[l]!=o.b.LeftToRight)f=l;else{if(-1==f){s[l]==o.b.LeftToRight?m=!0:s[l]==o.b.RightToLeft&&(m=!1);continue}s[l]==o.b.LeftToRight&&(this.updateCharacterRange(e,l,f,a,s),f=s[l]==o.b.RightToLeft||s[l]==o.b.Number&&-1!=f?l:-1)}s[l]==o.b.LeftToRight?m=!0:s[l]==o.b.RightToLeft&&(m=!1)}if(-1!=f&&f<s.length-1&&(this.updateCharacterRange(e,s.length-1,f,a,s),f=-1),s.length!=e.children.length)throw new Error("Splitted Widget count mismatch while reordering layouted child widgets of a line");var v=this.reorderElements(e,s,a,t);a.length=0,s.length=0,e.children.length>0&&(e.layoutedElements=v)}return t},e.prototype.isNumberNonReversingCharacter=function(e){if(e instanceof d.d){var t=e;if(!t.characterFormat.hasValueWithParent("localeIdBidi"))return c.a.isNumberNonReversingCharacter(t.text,t.characterFormat.bidi);var i=t.text.charCodeAt(0);if(47==i&&!this.isNumberReverseLangForSlash(t.characterFormat.localeIdBidi)||(35==i||36==i||37==i||43==i||45==i)&&!this.isNumberReverseLangForOthers(t.characterFormat.localeIdBidi)||44==i||46==i||58==i||1548==i)return!0}return!1},e.prototype.isNumberReverseLangForSlash=function(e){return this.isNumberReverseLangForOthers(e)||6145==e||1164==e||1125==e||1120==e||1123==e||1065==e||2137==e||1114==e||1119==e||1152==e||1056==e},e.prototype.isNumberReverseLangForOthers=function(e){return 14337==e||15361==e||5121==e||3073==e||2049==e||11265==e||13313==e||12289==e||4097==e||8193==e||16385==e||1025==e||10241==e||7169==e||9217==e},e.prototype.isStartMarker=function(e){return e instanceof d.B?0===e.commentType:e instanceof d.e?0===e.bookmarkType:e instanceof d.G||(e instanceof d.H?0===e.type:e instanceof d.b&&0===e.fieldType)},e.prototype.isEndMarker=function(e){return e instanceof d.B?1===e.commentType:e instanceof d.e?1===e.bookmarkType:e instanceof d.G||(e instanceof d.H?1===e.type:e instanceof d.b&&1===e.fieldType)},e.prototype.getNextValidWidget=function(e,t){for(var i=e;i<t.children.length;i++){var n=t.children[i];if(!(n instanceof d.B||n instanceof d.e||n instanceof d.G||n instanceof d.F||n instanceof d.H||n instanceof d.b))return n[i]}return null},e.prototype.hasTextRangeBidi=function(e){for(var t=0;t<e.children.length;t++){var i=e.children[t];if(i instanceof d.d){if(i.characterFormat.bidi)return!0}}return!1},e.prototype.isContainsRTLText=function(e){for(var t=e.paragraph.bodyWidget.page.documentHelper,i=t.textHelper,n=!1,r=0;r<e.children.length&&!(e.children[r]instanceof d.d&&(n=e.children[r].characterFormat.bidi||1==e.children[r].characterFormat.bidi||i.isRTLText(e.children[r].text)));r++);return n},e.prototype.updateCharacterRange=function(e,t,i,n,r){var s=t;if(!n[t]){r[t]===o.b.LeftToRight&&s--;for(var a=s;a>=i;a--)if(r[a]!=o.b.WordSplit){s=a;break}}for(var a=i;a<=s;a++)if(r[a]==o.b.WordSplit){r[a]=o.b.RightToLeft|o.b.WordSplit;var l=a-1,h=a+1;if(l>=0&&h<r.length&&r[l]==o.b.RightToLeft&&(r[h]==o.b.RightToLeft||r[h]==o.b.Number)&&e.children[a]instanceof d.d){var c=e.children[a];if("Times New Roman"==c.characterFormat.fontFamilyBidi){var p=c.text.split(""),u=p.reverse(),g=u.join("");c.text=g}}}},e.prototype.reorderElements=function(e,t,i,n){for(var r=0,s=-1,a=0,l=0,d=[],h=o.b.LeftToRight,c=!1,p=0;p<e.children.length;p++){var u=e.children[p],g=u;g.characterRange=t[p];var f=(g.characterRange&o.b.RightToLeft)==o.b.RightToLeft||g.characterRange==o.b.Number,m=i[p];if(t[p]==o.b.Tab){if(n){r=0,s=-1,a=0,h=o.b.LeftToRight,c=!1,d.splice(r,0,u);continue}m&&(m=!1)}p>0&&c!=m&&(n?(r=0,s=-1,a=0):s=d.length-1,l=0),m||f?f||m&&g.characterRange==o.b.WordSplit&&(h==o.b.RightToLeft||this.isInsertWordSplitToLeft(t,i,p))?(a++,r=s+1,g.characterRange==o.b.Number&&(h==o.b.Number&&(r+=l),l++),d.splice(r,0,u)):(d.splice(r,0,u),r++,a=0):(n?(a>0&&c==m&&(r+=a),d.splice(r,0,u),r++):(d.push(u),r=p+1),a=0,s=n?r-1:d.length-1),g.characterRange!=o.b.Number&&(l=0),g.characterRange!=o.b.WordSplit&&(h=g.characterRange),c=m}return d},e.prototype.isInsertWordSplitToLeft=function(e,t,i){for(var n=i+1;n<e.length;n++){if((e[n]&o.b.RightToLeft)==o.b.RightToLeft)return!0;if(e[n]==o.b.LeftToRight)return!t[n]}return!0},e.prototype.shiftLayoutFloatingItems=function(e){for(var t=0;t<e.floatingElements.length;t++){var i=e.floatingElements[t],n=this.getFloatingItemPoints(i),r=n.y-i.y;if(i.x=n.x,i.y=n.y,i instanceof d.s)for(var o=0;o<i.textFrame.childWidgets.length;o++){var s=i.textFrame.childWidgets[o];s instanceof d.g?s.y=s.y+r:s instanceof d.u&&this.shiftChildLocationForTableWidget(s,r)}}},e.prototype.getFloatingItemPoints=function(e){var t=e.line.paragraph,i=t.bodyWidget.sectionFormat,n=0,r=0;if(t){var o=s.a.convertPointToPixel(i.leftMargin),a=s.a.convertPointToPixel(i.rightMargin),l=s.a.convertPointToPixel(i.topMargin),c=i.bottomMargin>0?s.a.convertPointToPixel(i.bottomMargin):48,p=s.a.convertPointToPixel(i.headerDistance),u=s.a.convertPointToPixel(i.footerDistance),g=s.a.convertPointToPixel(i.pageWidth),f=s.a.convertPointToPixel(i.pageHeight),m=g-(o+a),v=f-l-c;l=t.isInHeaderFooter&&i.topMargin<=0?Math.abs(l)>0?Math.abs(l):s.a.convertPointToPixel(i.headerDistance)+t.height:l>0?l:48,!t.isInHeaderFooter&&l<this.viewer.clientArea.y&&(l=this.viewer.clientArea.y);var y="InFrontOfText",w=!1,b=e.verticalOrigin,x=e.horizontalOrigin,C=e.horizontalAlignment,I=e.verticalAlignment,F=e.verticalRelativePercent,k=(e.horizontalRelativePercent,e.height),P=e.width,T=e.verticalPosition,S=e.horizontalPosition,W=e.layoutInCell,N=e.heightRelativePercent,H=e.widthRelativePercent,E=void 0;if(e instanceof d.s&&(E=e.autoShapeType),t.isInsideTable&&W)w=!0,r=this.getVerticalPosition(e,T,b,y),n=this.getHorizontalPosition(e.width,e,C,x,S,y,t.associatedCell.cellFormat.cellWidth);else if(this.documentHelper.viewer instanceof h.a){switch(b){case"Line":r=this.documentHelper.selection.getTop(e.line);break;default:r=this.viewer.clientActiveArea.y}switch(x){case"Character":n=this.viewer.clientActiveArea.x;break;default:switch(C){case"Center":n=this.viewer.clientArea.width/2-e.width/2;break;default:n=this.viewer.clientArea.x}}}else{switch(b){case"Page":case"TopMargin":switch(r=T,I){case"Top":r=T;break;case"Center":"TopMargin"===b?r=(l-k)/2:N>0&&H>0?(r=(f-f*(N/100))/2,e.height=f*(N/100)):r=(f-k)/2;break;case"Outside":case"Bottom":r="Page"===b&&"Bottom"===I?f-k:"TopMargin"===b?l-k:(t.bodyWidget.page.index+1)%2!=0?f-k-u/2:p/2;break;case"Inside":"Page"===b?r=(t.bodyWidget.page.index+1)%2==0?f-k-u/2:p/2:(t.bodyWidget.page.index+1)%2==0&&(r=(l-k)/2-p);break;case"None":r=Math.abs(F)<=1e3?f*(F/100):T}break;case"Line":switch(r=T,I){case"Inside":case"Top":r=this.viewer.clientActiveArea.y;break;case"Center":r=this.viewer.clientActiveArea.y-k/2;break;case"Outside":case"Bottom":r=this.viewer.clientActiveArea.y-k;break;case"None":r=Math.round(t.y)+T}break;case"BottomMargin":switch(r=T,I){case"Inside":case"Top":r=f-c;break;case"Center":r=f-c+(c-k)/2;break;case"Outside":case"Bottom":r=t.bodyWidget.page.index+1!==0&&"Outside"===I?f-c:f-k;break;case"None":r=f-c+T}break;case"InsideMargin":case"OutsideMargin":switch(r=T,I){case"Inside":r="InsideMargin"===b?"InsideMargin"===b&&t.bodyWidget.page.index+1===0?f-k:0:(t.bodyWidget.page.index+1)%2!=0?f-c:l-k;break;case"Top":r="InsideMargin"===b?(t.bodyWidget.page.index+1)%2==0?f-c:0:(t.bodyWidget.page.index+1)%2!=0?f-c:0;break;case"Center":r="OutsideMargin"===b?(t.bodyWidget.page.index+1)%2!=0?f-c+(c-k)/2:(l-k)/2:(t.bodyWidget.page.index+1)%2==0?f-c+(c-k)/2:(l-k)/2;break;case"Outside":r="InsideMargin"===b?(t.bodyWidget.page.index+1)%2==0?f-c:l-k:(t.bodyWidget.page.index+1)%2!=0?l-k:f-c;break;case"Bottom":r="OutsideMargin"===b?t.bodyWidget.page.index+1!==0?f-k:l-k:(t.bodyWidget.page.index+1)%2==0?f-k:l-k}break;case"Paragraph":;r=Math.round(t.y)+0+T;break;case"Margin":switch(r=t.isInHeaderFooter&&p>l?p+t.height+T:l+T,I){case"Top":r=l;break;case"Center":r=l+(v-k)/2;break;case"Outside":case"Bottom":r=(t.bodyWidget.page.index+1)%2!=0?l+v-k:l;break;case"Inside":r=(t.bodyWidget.page.index+1)%2==0?l+v-k:l}break;default:r=this.viewer.clientArea.y-T}switch(x){case"Page":switch(n=S,C){case"Center":w?n=(t.associatedCell.cellFormat.cellWidth-P)/2:N>0&&H>0?(n=(g-g*(H/100))/2,e.width=g*(H/100)):n=(g-P)/2;break;case"Left":n=0;break;case"Outside":case"Right":n=w?t.associatedCell.cellFormat.cellWidth-P:g-P;break;case"None":n=w?t.associatedCell.x+S:(d.s,S)}n<0&&w&&(n=t.associatedCell.x);break;case"Column":var O=!1;if(this.viewer.clientActiveArea.x<t.x?n=t.x+S:!e.paragraph.isInsideTable&&("StraightConnector"===E||"Rectangle"===E||e instanceof d.r)?(O=!0,n=S+t.bodyWidget.x):n=t.x+S,t.paragraphFormat.leftIndent&&!O){var _=s.a.convertPointToPixel(t.leftIndent);n-=_}switch(C){case"Center":n=this.viewer.clientActiveArea.x+(this.viewer.clientActiveArea.width-P)/2;break;case"Left":n=this.viewer.clientActiveArea.x;break;case"Right":n=this.viewer.clientActiveArea.x+this.viewer.clientActiveArea.width-P}break;case"Margin":if(t.bodyWidget)switch(n=o+S,C){case"Center":n=o+(m-P)/2;break;case"Left":n=o;break;case"Outside":(t.bodyWidget.page.index+1)%2!=0&&(n=o+m-P);break;case"Right":n=o+m-P;break;case"Inside":(t.bodyWidget.page.index+1)%2==0&&(n=o+m-P)}else n=this.viewer.clientArea.x+S;break;case"Character":n="Right"===C||"Center"===C?this.getLeftMarginHorizPosition(o,C,S,P,y):this.viewer.clientArea.x+S;break;case"LeftMargin":n=this.getLeftMarginHorizPosition(o,C,S,P,y);break;case"RightMargin":n=this.getRightMarginHorizPosition(g,a,C,S,P,y);break;case"InsideMargin":n=(t.bodyWidget.page.index+1)%2==0?this.getRightMarginHorizPosition(g,a,C,S,P,y):this.getLeftMarginHorizPosition(o,C,S,P,y);break;case"OutsideMargin":n=(t.bodyWidget.page.index+1)%2==0?this.getLeftMarginHorizPosition(o,C,S,P,y):this.getRightMarginHorizPosition(g,a,C,S,P,y);break;default:n=this.viewer.clientArea.x+S}}!t||"Paragraph"!==b&&"Line"!==b||"InFrontOfText"===e.textWrappingStyle||"Behind"===e.textWrappingStyle||"Word2013"===this.documentHelper.compatibilityMode&&(t.isInHeaderFooter||(r+e.height>this.viewer.clientArea.bottom&&(r=this.viewer.clientArea.bottom-e.height),r<i.topMargin&&(r=i.topMargin)))}return new s.b(n,r)},e.prototype.getLeftMarginHorizPosition=function(e,t,i,n,r){var o=i;switch(t){case"Center":o=(e-n)/2;break;case"Left":o=0;break;case"Right":o=e-n}return o<0&&"InFrontOfText"!==r&&"Behind"!==r&&(o=0),o},e.prototype.getRightMarginHorizPosition=function(e,t,i,n,r,o){var s=e-t,a=s+n;switch(i){case"Center":a=s+(t-r)/2;break;case"Left":a=s;break;case"Right":a=e-r}return(a<0||a+r>e)&&"InFrontOfText"!==o&&"Behind"!==o&&(a=e-r),a},e.prototype.getVerticalPosition=function(e,t,i,n){var r=e.line.paragraph,o=e,s=0,a=r.associatedCell.y;switch(i){case"Page":case"Margin":case"TopMargin":case"InsideMargin":case"BottomMargin":case"OutsideMargin":s=a+t;break;case"Line":case"Paragraph":;s=r.y+t+0,"Square"==o.textWrappingStyle&&(s=s<=r.associatedCell.y?r.associatedCell.y:s);break;default:s=this.viewer.clientActiveArea.y+t}return s},e.prototype.getHorizontalPosition=function(e,t,i,n,r,o,s){var a=0,l=t.line.paragraph,d=l.associatedCell,h=s-d.leftMargin-d.rightMargin,c=d.cellFormat.cellWidth,p=d.x,u=p-d.leftMargin;switch(n){case"Page":switch(a=r,i){case"Center":a=u+(h-e)/2;break;case"Left":a=u;break;case"Right":a=u+(h-e);break;case"None":a=u+r}break;case"Column":case"Margin":switch(i){case"Center":a=p+(c-e)/2;break;case"Left":a=p;break;case"Right":a=p+(c-e);break;case"None":a=p+r}break;default:a=p+r}return a},e.prototype.updateTableFloatPoints=function(e){if(e.wrapTextAround){var t=e.getTableCellWidth(),r=e.positioning,o=e.bodyWidget.sectionFormat;if(this.documentHelper.viewer instanceof h.a)"Margin"!==r.horizontalOrigin&&"Page"!==r.horizontalOrigin&&"Column"!==r.horizontalOrigin||("Right"===r.horizontalAlignment||"Outside"===r.horizontalAlignment?this.viewer.clientActiveArea.x=this.viewer.clientArea.width-t:this.viewer.clientActiveArea.x=this.viewer.clientArea.x);else if(e.containerWidget instanceof d.i||e.isInsideTable){if(e.isInsideTable){var a=e.containerWidget,l=a.cellFormat;"Page"===r.verticalOrigin?(this.viewer.clientActiveArea.y=a.y,this.viewer.clientActiveArea.y+=s.a.convertPointToPixel(r.verticalPosition)):"Margin"===r.verticalOrigin?(this.viewer.clientActiveArea.y+=s.a.convertPointToPixel(r.verticalPosition),(this.viewer.clientActiveArea.y<a.y||"Top"===r.verticalAlignment)&&(this.viewer.clientActiveArea.y=a.y)):this.viewer.clientActiveArea.y+s.a.convertPointToPixel(r.verticalPosition)<a.y?this.viewer.clientActiveArea.y=a.y:this.viewer.clientActiveArea.y+=s.a.convertPointToPixel(r.verticalPosition),"Page"===r.horizontalOrigin?"Left"===r.horizontalAlignment||"Inside"===r.horizontalAlignment?this.viewer.clientActiveArea.x=a.x:"Right"!==r.horizontalAlignment&&"Outside"!==r.horizontalAlignment||(this.viewer.clientActiveArea.x=a.x+l.preferredWidth-t):"Margin"!==r.horizontalOrigin&&"Column"!==r.horizontalOrigin||("Left"===r.horizontalAlignment||"Inside"===r.horizontalAlignment?this.viewer.clientActiveArea.x=a.x+a.leftMargin:"Right"!==r.horizontalAlignment&&"Outside"!==r.horizontalAlignment||(this.viewer.clientActiveArea.x=a.x+l.preferredWidth-(t+a.rightMargin))),Math.round(r.horizontalPosition)>0&&(this.viewer.clientActiveArea.x=a.x,"Margin"===r.horizontalOrigin&&(this.viewer.clientActiveArea.x+=a.leftMargin),this.viewer.clientActiveArea.x+=s.a.convertPointToPixel(r.horizontalPosition)),"Center"===r.horizontalAlignment&&(this.viewer.clientActiveArea.x=l.preferredWidth/2-t/2)}}else"Page"===r.verticalOrigin?"Top"===r.verticalAlignment?this.viewer.clientActiveArea.y=0:"Inside"===r.verticalAlignment?this.viewer.clientActiveArea.y=0:(i.i(n.isNullOrUndefined)(r.verticalAlignment)||"None"===r.verticalAlignment)&&(this.viewer.clientActiveArea.y=s.a.convertPointToPixel(r.verticalPosition)):"Margin"===r.verticalOrigin?"Top"===r.verticalAlignment?this.viewer.clientActiveArea.y=s.a.convertPointToPixel(o.topMargin):"Inside"===r.verticalAlignment?this.viewer.clientActiveArea.y=s.a.convertPointToPixel(o.topMargin):0==Math.round(r.verticalPosition)||i.i(n.isNullOrUndefined)(o.topMargin)?this.viewer.clientActiveArea.y=s.a.convertPointToPixel(r.verticalPosition):this.viewer.clientActiveArea.y=s.a.convertPointToPixel(o.topMargin+r.verticalPosition):"Paragraph"===r.verticalOrigin&&(i.i(n.isNullOrUndefined)(r.verticalAlignment)||"None"===r.verticalAlignment)&&(this.viewer.clientActiveArea.y+=s.a.convertPointToPixel(r.verticalPosition)),"Page"===r.horizontalOrigin?"Left"===r.horizontalAlignment?this.viewer.clientActiveArea.x=0:"Inside"===r.horizontalAlignment?this.viewer.clientActiveArea.x=0:"Right"===r.horizontalAlignment?this.viewer.clientActiveArea.x=s.a.convertPointToPixel(o.pageWidth)-t:"Outside"===r.horizontalAlignment?this.viewer.clientActiveArea.x=s.a.convertPointToPixel(o.pageWidth)-t:"Center"===r.horizontalAlignment&&(this.viewer.clientActiveArea.x=(s.a.convertPointToPixel(o.pageWidth)-t)/2):"Margin"!==r.horizontalOrigin&&"Column"!==r.horizontalOrigin||("Left"===r.horizontalAlignment?(this.viewer.clientActiveArea.x=s.a.convertPointToPixel(o.leftMargin),"Word2013"===this.documentHelper.compatibilityMode||e.isInsideTable||(this.viewer.clientActiveArea.x=this.viewer.clientActiveArea.x-s.a.convertPointToPixel(e.firstChild.firstChild.leftMargin))):"Inside"===r.horizontalAlignment?this.viewer.clientActiveArea.x=s.a.convertPointToPixel(o.leftMargin):"Right"===r.horizontalAlignment?this.viewer.clientActiveArea.x=s.a.convertPointToPixel(o.pageWidth)-(s.a.convertPointToPixel(o.rightMargin)+t):"Outside"===r.horizontalAlignment?this.viewer.clientActiveArea.x=s.a.convertPointToPixel(o.pageWidth)-(s.a.convertPointToPixel(o.rightMargin)+t):"Center"===r.horizontalAlignment&&(this.viewer.clientActiveArea.x=s.a.convertPointToPixel(o.leftMargin)+(s.a.convertPointToPixel(o.pageWidth-o.rightMargin-o.leftMargin)-t)/2)),Math.round(r.horizontalPosition)>0&&(this.viewer.clientActiveArea.x+=s.a.convertPointToPixel(r.horizontalPosition))}e.x=this.viewer.clientActiveArea.x,e.y=this.viewer.clientActiveArea.y},e.prototype.isTocField=function(e){if(e instanceof d.b){var t=e.nextNode;if(e instanceof d.b&&0===e.fieldType&&t instanceof d.d&&-1!==t.text.trim().toLowerCase().indexOf("toc"))return!0}return!1},e.prototype.getTotalColumnSpan=function(e){for(var t=e,i=0,n=0;n<t.childWidgets.length;n++)i+=t.childWidgets[n].cellFormat.columnSpan;return i},e.prototype.getMaximumRightCellBorderWidth=function(e){for(var t=0,i=0;i<e.childWidgets.length;i++){var n=e.childWidgets[i],r=n.childWidgets[n.childWidgets.length-1],o=r.cellFormat.borders.right.lineWidth;t<o&&(t=o)}return t},e.prototype.getDefaultBorderSpacingValue=function(e,t,i){return 0==e?(e="Word2013"!=this.documentHelper.compatibilityMode&&"Center"==i?1.5:.75,!0):t},e.prototype.getMinimumWidthRequiredForTable=function(e,t,i){var n=0;return n="Word2013"==this.documentHelper.compatibilityMode?"Center"==t?e?18.5+Math.round(.375):18.5+Math.round(i/2):e?19.25:18.5+i:"Center"==t?e?19.25:18.5+i/2:.25==i?18.5:19.3,s.a.convertPointToPixel(n)},e.prototype.shiftFloatingItemsFromTable=function(e,t){if(e.containerWidget instanceof d.o)for(var i=0;i<e.containerWidget.floatingElements.length;i++){var n=e.containerWidget.floatingElements[i];!(n instanceof d.u)&&n.paragraph.containerWidget instanceof d.j&&n.paragraph.containerWidget.ownerTable.containerWidget.ownerTable==e&&(t.floatingElements.push(e.containerWidget.floatingElements[i]),e.containerWidget.floatingElements.splice(e.containerWidget.floatingElements.indexOf(e.containerWidget.floatingElements[i]),1),this.shiftedFloatingItemsFromTable.push(n),i--)}},e}()},function(e,t,i){"use strict";i.d(t,"a",function(){return a});var n=i(0),r=(i.n(n),i(7)),o=i(1),s=i(4),a=function(){function e(e){this.paragraphMarkInfo={},this.documentHelper=e,i.i(n.isNullOrUndefined)(e)||(this.context=e.containerContext)}return Object.defineProperty(e.prototype,"paragraphMark",{get:function(){return""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineBreakMark",{get:function(){return""},enumerable:!0,configurable:!0}),e.prototype.getEnSpaceCharacter=function(){return String.fromCharCode(8194)},e.prototype.repeatChar=function(e,t){for(var i="",n=0;n<t;n++)i+=e;return i},e.prototype.getParagraphMarkWidth=function(e){return this.getParagraphMarkSize(e).Width},e.prototype.getParagraphMarkSize=function(e){var t=this.getFormatText(e);if(this.paragraphMarkInfo[""+t])return this.paragraphMarkInfo[""+t];var i=this.getWidth(this.paragraphMark,e),n=this.getHeight(e),r={Width:i,Height:n.Height,BaselineOffset:n.BaselineOffset};return this.paragraphMarkInfo[""+t]=r},e.prototype.getTextSize=function(e,t){var i=0,n=t.bidi||this.isRTLText(e.text),r=this.setText(e.text,n,t.bdo);"\r"===r&&(r=String.fromCharCode(182)),i=this.getWidth(r,t,e.scriptType),e.width=i;var o=this.getHeight(t,e.scriptType);return"Word2003"===this.documentHelper.compatibilityMode&&e.isColumnBreak||(e.height=o.Height),e.baselineOffset=o.BaselineOffset," "===e.text[e.text.length-1]&&(i=this.getWidth(s.a.trimEnd(e.text),t,e.scriptType)),e.trimEndWidth=i,i},e.prototype.getHeight=function(e,t){var r=this.getFontNameToRender(t,e),o=this.getFormatText(e,r);if(!i.i(n.isNullOrUndefined)(this.documentHelper.heightInfoCollection[""+o]))return this.documentHelper.heightInfoCollection[""+o];var s=this.documentHelper.owner.textMeasureHelper.getHeightInternal(e,r);return this.documentHelper.heightInfoCollection[""+o]=s,s},e.prototype.getFormatText=function(e,t){var r="";return r=i.i(n.isNullOrUndefined)(t)?e.fontFamily.toLocaleLowerCase():t.toLocaleLowerCase(),r+=";"+e.fontSize,e.bold&&(r+=";bold"),e.italic&&(r+=";italic"),r},e.prototype.measureTextExcludingSpaceAtEnd=function(e,t,i){return this.getWidth(s.a.trimEnd(e),t,i)},e.prototype.getWidth=function(e,t,i){e.match("\v")&&e.replace("\v",this.lineBreakMark);var n="",r="",o="",s=t.fontSize;n=t.bold?"bold":"",r=t.italic?"italic":"",o=this.getFontNameToRender(i,t),s=0===s?.5:s/("Normal"===t.baselineAlignment?1:1.5),this.context.font=n+" "+r+" "+s+'pt "'+o+'"',this.context.letterSpacing=t.characterSpacing+"pt";var a=t.scaling/100;return t.allCaps&&(e=e.toUpperCase()),""==e&&(e+="A"),Math.abs(this.context.measureText(e).width*a)},e.prototype.setText=function(e,t,r,o){if(i.i(n.isNullOrUndefined)(o)&&(o=!1),0===e.length)return"";var a=t;if(!a&&"RTL"===r||a&&"LTR"===r)e=s.a.reverseString(e);else if(o&&a&&s.a.endsWith(e)){var l=e.length-s.a.trimEnd(e).length;e=s.a.addSpace(l)+s.a.trimEnd(e)}return e},e.prototype.measureText=function(e,t,i){var n=this.getWidth(e,t,i),r=this.getHeight(t,i);return{Width:n,Height:r.Height,BaselineOffset:r.BaselineOffset}},e.prototype.updateTextSize=function(e,t){var i=new r.g(void 0),n=e.listLevel.characterFormat,o=t.characterFormat;i.fontSize=n.hasValue("fontSize")?n.fontSize:o.fontSize,i.fontFamily=n.hasValue("fontFamily")?n.fontFamily:o.fontFamily;var s="",a="",l="Normal"===n.baselineAlignment?o.baselineAlignment:n.baselineAlignment;s=n.hasValue("bold")?n.bold?"bold":"":o.bold?"bold":"",a=n.hasValue("italic")?n.italic?"italic":"":o.italic?"italic":"",i.baselineAlignment=l,s&&(i.bold=!0),a&&(i.italic=!0);var d=i.bidi||this.isRTLText(e.text),h=this.setText(e.text,d,i.bdo);e.width=this.getWidth(h,i);var c=this.getHeight(i);e.height=c.Height,e.baselineOffset=c.BaselineOffset,i.destroy()},e.prototype.containsSpecialCharAlone=function(e){for(var t="*|.:[]{}-`;()@&$#%!~?, '",i=0;i<e.length;i++)if(-1===t.indexOf(e.charAt(i)))return!1;return!0},e.prototype.containsNumberAlone=function(e){var t="0123456789";if(""===e)return!1;for(var i=0;i<e.length;i++)if(-1===t.indexOf(e.charAt(i)))return!1;return!0},e.prototype.containsCombinationText=function(e){return!(!e.text.match(/^[0-9]+$/)||!e.paragraph.bidi)},e.prototype.inverseCharacter=function(e){switch(e){case"(":return")";case")":return"(";case"<":return">";case">":return"<";case"{":return"}";case"}":return"{";case"[":return"]";case"]":return"[";default:return e}},e.prototype.containsSpecialChar=function(e){for(var t="*|.:[]{}-`;()@&$#%!~? ",i=0;i<e.length;i++)if(-1!==t.indexOf(e.charAt(i)))return!0;return!1},e.prototype.isRTLText=function(e){var t=!1;if(!i.i(n.isNullOrUndefined)(e))for(var r=0;r<e.length;r++){var o=e[r];if(o>=String.fromCharCode(1424)&&o<=String.fromCharCode(1535)||o>=String.fromCharCode(64285)&&o<=String.fromCharCode(64335)||o>=String.fromCharCode(1536)&&o<=String.fromCharCode(1791)||o>=String.fromCharCode(1872)&&o<=String.fromCharCode(1919)||o>=String.fromCharCode(2208)&&o<=String.fromCharCode(2303)||o>=String.fromCharCode(64336)&&o<=String.fromCharCode(65023)||o>=String.fromCharCode(65136)&&o<=String.fromCharCode(65279)||o>=String.fromCharCode(43392)&&o<=String.fromCharCode(43487)||o>=String.fromCharCode(1792)&&o<=String.fromCharCode(1871)||o>=String.fromCharCode(1920)&&o<=String.fromCharCode(1983)||o>=String.fromCharCode(2112)&&o<=String.fromCharCode(2143)||o>=String.fromCharCode(1984)&&o<=String.fromCharCode(2047)||o>=String.fromCharCode(2048)&&o<=String.fromCharCode(2111)||o>=String.fromCharCode(11568)&&o<=String.fromCharCode(11647)){t=!0;break}}return t},e.prototype.isUnicodeText=function(e,t){var r=!1;if(!i.i(n.isNullOrUndefined)(e))for(var o=0;o<e.length;o++){var s=e[o];if((s>=""&&s<=""||s>=""&&s<=""||s>=""&&s<=""||s>=""&&s<=""||s>=""&&s<=""||s>=""&&s<="")&&0!==t){r=!0;break}}return r},e.prototype.getRtlLanguage=function(e){return i.i(n.isNullOrUndefined)(e)||""===e?{isRtl:!1,id:0}:e>=String.fromCharCode(1424)&&e<=String.fromCharCode(1535)?{isRtl:!0,id:1}:e>=String.fromCharCode(1536)&&e<=String.fromCharCode(1791)||e>=String.fromCharCode(1872)&&e<=String.fromCharCode(1919)||e>=String.fromCharCode(2208)&&e<=String.fromCharCode(2303)||e>=String.fromCharCode(64336)&&e<=String.fromCharCode(65023)||e>=String.fromCharCode(65136)&&e<=String.fromCharCode(65279)?{isRtl:!0,id:2}:e>=String.fromCharCode(43392)&&e<=String.fromCharCode(43487)?{isRtl:!0,id:3}:e>=String.fromCharCode(1792)&&e<=String.fromCharCode(1871)?{isRtl:!0,id:4}:e>=String.fromCharCode(1920)&&e<=String.fromCharCode(1983)?{isRtl:!0,id:5}:e>=String.fromCharCode(2112)&&e<=String.fromCharCode(2143)?{isRtl:!0,id:6}:e>=String.fromCharCode(1984)&&e<=String.fromCharCode(2047)?{isRtl:!0,id:7}:e>=String.fromCharCode(2048)&&e<=String.fromCharCode(2111)?{isRtl:!0,id:8}:e>=String.fromCharCode(11568)&&e<=String.fromCharCode(11647)?{isRtl:!0,id:9}:{isRtl:!1,id:0}},e.prototype.splitTextByConsecutiveLtrAndRtl=function(t,r,s,a,l,d){var h=a.length,c=[];if(i.i(n.isNullOrUndefined)(t)||""===t)return c;for(var p=-1,u="",g="",f="",m="",v=0;v<t.length;v++){var y=0,w=!1;(i.i(n.isNullOrUndefined)(l.value)?r:!l.value)&&this.isNumber(t[v])?(m+=t[v],y=4):this.isWordSplitChar(t[v])?(y=2,w=r||32==t.charCodeAt(v)&&""==f,f+=t[v]):this.isRTLText(t[v])&&!this.isNumber(t[v])?(l.value=!1,d.value=!0,g+=t[v],y=1):(l.value=!0,u+=t[v]),""!=m&&4!=y&&(c.push(m),a.push(o.i.Number),m=""),""!=g&&1!=y&&(c.push(g),a.push(o.i.RightToLeft),g=""),""!=u&&0!=y&&(c.push(u),p=c.length-1,a.push(o.i.LeftToRight),u=""),""==f||2==y&&!w||(c.push(f),a.push(o.i.WordSplit),f="")}if(""!=m?(c.push(m),a.push(o.i.Number)):""!=g?(c.push(g),a.push(o.i.RightToLeft)):""!=u?(c.push(u),p=c.length-1,a.push(o.i.LeftToRight)):""!=f&&(c.push(f),a.push(o.i.WordSplit)),d.value||!i.i(n.isNullOrUndefined)(l.value)&&!l.value)for(var v=1;v<c.length;v++){var b=a[v+h];b==o.i.WordSplit&&1==c[v].length&&v+h+1<a.length&&a[v+h-1]!=o.i.WordSplit&&(a[v+h-1]!=o.i.Number||e.isNumberNonReversingCharacter(c[v],r))&&a[v+h-1]==a[v+h+1]&&(c[v-1]=c[v-1]+c[v]+c[v+1],c.splice(v,1),c.splice(v,1),a.splice(v+h,1),a.splice(v+h,1),v--)}else if(-1!=p)if(r)for(var v=1;v<p;v++){var b=a[v+h];if(b==o.i.WordSplit&&v<p&&a[v+h-1]==o.i.LeftToRight){u="";for(var x=v+1;x<=p;x++)u+=c[x],c.splice(x,1),a.splice(x+h,1),x--,p--;c[v-1]=c[v-1]+c[v]+u,c.splice(v,1),a.splice(v+h,1),v--,p--}}else c.length=0,c.push(t);else r||(c.length=0,c.push(t));if(r)for(var v=1;v<c.length;v++){var b=a[v+h];b==o.i.WordSplit&&1==c[v].length&&v+h+1<a.length&&a[v+h-1]!=o.i.WordSplit&&(a[v+h-1]!=o.i.Number||e.isNumberNonReversingCharacter(c[v],r)||!s)&&a[v+h-1]==a[v+h+1]?(c[v-1]=c[v-1]+c[v]+c[v+1],c.splice(v,1),c.splice(v,1),a.splice(v+h,1),a.splice(v+h,1),v--):b==o.i.WordSplit&&a[v+h-1]==o.i.Number&&this.isNonWordSplitCharacter(c[v])&&!s?(c[v-1]=c[v-1]+c[v],c.splice(v,1),a.splice(v+h,1),v--):b!=o.i.LeftToRight||a[v+h-1]!=o.i.Number&&a[v+h-1]!=o.i.LeftToRight||(c[v-1]=c[v-1]+c[v],a[v+h-1]=o.i.LeftToRight,c.splice(v,1),a.splice(v+h,1),v--)}return c},e.prototype.isRightToLeftLanguage=function(e){return 14337==e||15361==e||5121==e||3073==e||2049==e||11265==e||13313==e||12289==e||4097==e||8193==e||16385==e||1025==e||10241==e||7169==e||9217==e||10655==e},e.prototype.isNumber=function(e){return!isNaN(parseInt(e,10))||(e>=String.fromCharCode(1632)&&e<=String.fromCharCode(1641)||e>=String.fromCharCode(1776)&&e<=String.fromCharCode(1785))},e.prototype.isWordSplitChar=function(t){for(var i=0;i<e.wordSplitCharacters.length;i++)if(e.wordSplitCharacters[i]===t)return!0;return!1},e.isNumberNonReversingCharacter=function(t,i){for(var n=0;n<e.numberNonReversingCharacters.length;n++){var r=e.numberNonReversingCharacters[n];if(t[0]==r&&(47!=r.charCodeAt(0)||!i))return!0}return!1},e.prototype.isNonWordSplitCharacter=function(e){for(var t=!1,i=0;i<e.length;i++){var n=e.charCodeAt(i);if(35!=n&&36!=n&&37!=n){t=!1;break}t=!0}return t},e.prototype.getFontNameToRender=function(e,t){return i.i(n.isNullOrUndefined)(e)?t.fontFamily:t.bidi||t.complexScript?this.getFontNameBidiToRender(e,t):this.isEastAsiaScript(e)&&!i.i(n.isNullOrUndefined)(t.fontFamilyFarEast)?this.getFontNameEAToRender(e,t):this.getFontNameAsciiToRender(e,t)},e.prototype.isEastAsiaScript=function(e){return e==o.j.Japanese||e==o.j.Korean||e==o.j.Chinese},e.prototype.getFontNameEAToRender=function(e,t){var r=t.fontFamilyFarEast;return i.i(n.isNullOrUndefined)(r)||s.a.isThemeFont(r)?this.getFontNameFromTheme(t,r,e,o.k.EastAsia):r},e.prototype.getFontNameAsciiToRender=function(e,t){var i=t.fontFamilyAscii;return s.a.isThemeFont(i)?this.getFontNameFromTheme(t,i,e,o.k.Default):t.fontFamily},e.prototype.getFontNameBidiToRender=function(e,t){var r=t.fontFamilyBidi;return!i.i(n.isNullOrUndefined)(r)||s.a.isThemeFont(r)?this.getFontNameFromTheme(t,r,e,o.k.CS):r},e.prototype.getFontNameFromTheme=function(e,t,r,a){var l;if(!this.documentHelper.hasThemes||i.i(n.isNullOrUndefined)(this.documentHelper.themes)||i.i(n.isUndefined)(this.documentHelper.themes.fontScheme)||(l=this.documentHelper.themes.fontScheme),"majorAscii"==t||"majorBidi"==t||"majorEastAsia"==t||"majorHAnsi"==t){var d=void 0;null!=l&&null!=l.majorFontScheme&&(d=l.majorFontScheme),t=this.updateFontNameFromTheme(e,d,r,t,a)}else if("minorAscii"==t||"minorBidi"==t||"minorEastAsia"==t||"minorHAnsi"==t){var h=void 0;null!=l&&null!=l.majorFontScheme&&(h=l.minorFontScheme),t=this.updateFontNameFromTheme(e,h,r,t,a)}return(i.i(n.isNullOrUndefined)(t)||s.a.isThemeFont(t))&&(t=o.Y),t},e.prototype.updateFontNameFromTheme=function(e,t,r,s,a){var l="";if(null!=t&&null!=t.fontSchemeList&&t.fontSchemeList.length>0&&t.fontSchemeList.forEach(function(e){("cs"!=e.name||"majorBidi"!=s&&"minorBidi"!=s)&&("ea"!=e.name||"majorEastAsia"!=s&&"minorEastAsia"!=s)?"latin"!=e.name||"majorAscii"!=s&&"majorHAnsi"!=s&&"minorAscii"!=s&&"minorHAnsi"!=s||(l=e.typeface):l=e.typeface}),null!=t&&null!=t.fontTypeface)if(a==o.k.CS)t.fontTypeface.containsKey("Arab")&&(l=t.fontTypeface.get("Arab"));else if(a==o.k.EastAsia);else if(i.i(n.isNullOrUndefined)(l)&&null!=this.documentHelper.themeFontLanguage&&("minorBidi"===s||"majorBidi"===s))return s=this.getFontNameWithFontScript(t,this.documentHelper.themeFontLanguage.localeIdBidi,a);return i.i(n.isNullOrUndefined)(l)&&(l=o.Y),s=l},e.prototype.getFontNameWithFontScript=function(e,t,i){var n=null,r=t.toString(),s=e.fontTypeface;return("gu_IN"==r||1095==t)&&s.containsKey("Gujr")||("hi_IN"==r||"mr_IN"==r||1081==t||1102==t)&&s.containsKey("Deva")||("ko_KR"==r||1042==t)&&s.containsKey("Hang")||("zh_CN"==r||"zh_SG"==r||2052==t)&&s.containsKey("Hans")||("zh_TW"==r||"zh_HK"==r||"zh_MO"==r)&&s.containsKey("Hant")||("ja_JP"==r||1041==t)&&s.containsKey("Jpan")||("ta_IN"==r||1097==t)&&s.containsKey("Taml")||("te_IN"==r||1098==t)&&s.containsKey("Telu")||("he_IL"==r||"yi_Hebr"==r||1037==t)&&s.containsKey("Hebr")?n=s.get("Arab"):"th_TH"!=r&&1054!=t||!s.containsKey("Thai")?i==o.k.CS&&s.containsKey("Arab")&&(n=s.get("Arab")):n=s.get("Thai"),n},e.prototype.destroy=function(){this.documentHelper=void 0,this.context=void 0,this.paragraphMarkInfo={},this.paragraphMarkInfo=void 0},e.wordSplitCharacters=[String.fromCharCode(32),String.fromCharCode(33),String.fromCharCode(34),String.fromCharCode(35),String.fromCharCode(36),String.fromCharCode(37),String.fromCharCode(38),String.fromCharCode(39),String.fromCharCode(40),String.fromCharCode(41),String.fromCharCode(42),String.fromCharCode(43),String.fromCharCode(44),String.fromCharCode(45),String.fromCharCode(46),String.fromCharCode(47),String.fromCharCode(58),String.fromCharCode(59),String.fromCharCode(60),String.fromCharCode(61),String.fromCharCode(62),String.fromCharCode(63),String.fromCharCode(64),String.fromCharCode(91),String.fromCharCode(92),String.fromCharCode(93),String.fromCharCode(94),String.fromCharCode(95),String.fromCharCode(96),String.fromCharCode(123),String.fromCharCode(124),String.fromCharCode(125),String.fromCharCode(126),String.fromCharCode(1548),String.fromCharCode(1563),String.fromCharCode(8211),String.fromCharCode(8212),String.fromCharCode(8216),String.fromCharCode(8217),String.fromCharCode(8221),String.fromCharCode(12288),String.fromCharCode(8207)],e.numberNonReversingCharacters=[String.fromCharCode(44),String.fromCharCode(46),String.fromCharCode(47),String.fromCharCode(58),String.fromCharCode(1548)],e}()},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(1);i.d(t,"DocumentEditorSettings",function(){return n.a}),i.d(t,"DocumentSettings",function(){return n.b}),i.d(t,"AutoResizeSettings",function(){return n.c}),i.d(t,"DocumentEditor",function(){return n.d}),i.d(t,"ServerActionSettings",function(){return n.e}),i.d(t,"FormFieldSettings",function(){return n.f}),i.d(t,"CollaborativeEditingSettings",function(){return n.g}),i.d(t,"ContainerServerActionSettings",function(){return n.h}),i.d(t,"CharacterRangeType",function(){return n.i}),i.d(t,"FontScriptType",function(){return n.j}),i.d(t,"FontHintType",function(){return n.k}),i.d(t,"LocaleId",function(){return n.l}),i.d(t,"SectionBreakType",function(){return n.m}),i.d(t,"CONTROL_CHARACTERS",function(){return n.n}),i.d(t,"Dictionary",function(){return n.o}),i.d(t,"WUniqueFormat",function(){return n.p}),i.d(t,"WUniqueFormats",function(){return n.q}),i.d(t,"XmlHttpRequestHandler",function(){return n.r}),i.d(t,"internalZoomFactorChange",function(){return n.s}),i.d(t,"contentChangeEvent",function(){return n.t}),i.d(t,"documentChangeEvent",function(){return n.u}),i.d(t,"selectionChangeEvent",function(){return n.v}),i.d(t,"zoomFactorChangeEvent",function(){return n.w}),i.d(t,"beforeFieldFillEvent",function(){return n.x}),i.d(t,"afterFieldFillEvent",function(){return n.y}),i.d(t,"afterFormFieldFillEvent",function(){return n.z}),i.d(t,"beforeFormFieldFillEvent",function(){return n.A}),i.d(t,"serviceFailureEvent",function(){return n.B}),i.d(t,"viewChangeEvent",function(){return n.C}),i.d(t,"customContextMenuSelectEvent",function(){return n.D}),i.d(t,"customContextMenuBeforeOpenEvent",function(){return n.E}),i.d(t,"contentControlEvent",function(){return n.F}),i.d(t,"commentBeginEvent",function(){return n.G}),i.d(t,"commentEndEvent",function(){return n.H}),i.d(t,"beforeCommentActionEvent",function(){return n.I}),i.d(t,"commentDeleteEvent",function(){return n.J}),i.d(t,"revisionActionEvent",function(){return n.K}),i.d(t,"beforePaneSwitchEvent",function(){return n.L}),i.d(t,"requestNavigateEvent",function(){return n.M}),i.d(t,"actionCompleteEvent",function(){return n.N}),i.d(t,"trackChangeEvent",function(){return n.O}),i.d(t,"searchResultsChangeEvent",function(){return n.P}),i.d(t,"keyDownEvent",function(){return n.Q}),i.d(t,"toolbarClickEvent",function(){return n.R}),i.d(t,"beforeFileOpenEvent",function(){return n.S}),i.d(t,"internalviewChangeEvent",function(){return n.T}),i.d(t,"beforeXmlHttpRequestSend",function(){return n.U}),i.d(t,"protectionTypeChangeEvent",function(){return n.V}),i.d(t,"internalDocumentEditorSettingsChange",function(){return n.W}),i.d(t,"internalStyleCollectionChange",function(){return n.X}),i.d(t,"defaultFont",function(){return n.Y}),i.d(t,"internalAutoResize",function(){return n.Z}),i.d(t,"beforeAutoResize",function(){return n._0}),i.d(t,"trackChanges",function(){return n._1}),i.d(t,"sectionsProperty",function(){return n._2}),i.d(t,"fontSubstitutionTableProperty",function(){return n._3}),i.d(t,"characterFormatProperty",function(){return n._4}),i.d(t,"paragraphFormatProperty",function(){return n._5}),i.d(t,"listsProperty",function(){return n._6}),i.d(t,"abstractListsProperty",function(){return n._7}),i.d(t,"backgroundProperty",function(){return n._8}),i.d(t,"stylesProperty",function(){return n._9}),i.d(t,"commentsProperty",function(){return n._10}),i.d(t,"revisionsProperty",function(){return n._11}),i.d(t,"customXmlProperty",function(){return n._12}),i.d(t,"defaultTabWidthProperty",function(){return n._13}),i.d(t,"formattingProperty",function(){return n._14}),i.d(t,"trackChangesProperty",function(){return n._15}),i.d(t,"protectionTypeProperty",function(){return n._16}),i.d(t,"enforcementProperty",function(){return n._17}),i.d(t,"hashValueProperty",function(){return n._18}),i.d(t,"saltValueProperty",function(){return n._19}),i.d(t,"cryptProviderTypeProperty",function(){return n._20}),i.d(t,"cryptAlgorithmClassProperty",function(){return n._21}),i.d(t,"cryptAlgorithmTypeProperty",function(){return n._22}),i.d(t,"isCreatedUsingHtmlSpanTagProperty",function(){return n._23}),i.d(t,"cryptAlgorithmSidProperty",function(){return n._24}),i.d(t,"cryptSpinCountProperty",function(){return n._25}),i.d(t,"doNotUseHTMLParagraphAutoSpacingProperty",function(){return n._26}),i.d(t,"alignTablesRowByRowProperty",function(){return n._27}),i.d(t,"formFieldShadingProperty",function(){return n._28}),i.d(t,"lastParagraphMarkCopiedProperty",function(){return n._29}),i.d(t,"footnotesProperty",function(){return n._30}),i.d(t,"endnotesProperty",function(){return n._31}),i.d(t,"compatibilityModeProperty",function(){return n._32}),i.d(t,"themeFontLanguagesProperty",function(){return n._33}),i.d(t,"themesProperty",function(){return n._34}),i.d(t,"nameProperty",function(){return n._35}),i.d(t,"basedOnProperty",function(){return n._36}),i.d(t,"nextProperty",function(){return n._37}),i.d(t,"linkProperty",function(){return n._38}),i.d(t,"localeIdProperty",function(){return n._39}),i.d(t,"localeIdFarEastProperty",function(){return n._40}),i.d(t,"localeIdBidiProperty",function(){return n._41}),i.d(t,"boldProperty",function(){return n._42}),i.d(t,"italicProperty",function(){return n._43}),i.d(t,"underlineProperty",function(){return n._44}),i.d(t,"baselineAlignmentProperty",function(){return n._45}),i.d(t,"strikethroughProperty",function(){return n._46}),i.d(t,"highlightColorProperty",function(){return n._47}),i.d(t,"fontSizeProperty",function(){return n._48}),i.d(t,"fontColorProperty",function(){return n._49}),i.d(t,"fontFamilyProperty",function(){return n._50}),i.d(t,"styleNameProperty",function(){return n._51}),i.d(t,"bidiProperty",function(){return n._52}),i.d(t,"bdoProperty",function(){return n._53}),i.d(t,"breakClearTypeProperty",function(){return n._54}),i.d(t,"fontSizeBidiProperty",function(){return n._55}),i.d(t,"fontFamilyBidiProperty",function(){return n._56}),i.d(t,"boldBidiProperty",function(){return n._57}),i.d(t,"italicBidiProperty",function(){return n._58}),i.d(t,"allCapsProperty",function(){return n._59}),i.d(t,"complexScriptProperty",function(){return n._60}),i.d(t,"fontFamilyAsciiProperty",function(){return n._61}),i.d(t,"fontFamilyFarEastProperty",function(){return n._62}),i.d(t,"fontFamilyNonFarEastProperty",function(){return n._63}),i.d(t,"revisionIdsProperty",function(){return n._64}),i.d(t,"listIdProperty",function(){return n._65}),i.d(t,"characterSpacingProperty",function(){return n._66}),i.d(t,"scalingProperty",function(){return n._67}),i.d(t,"listLevelNumberProperty",function(){return n._68}),i.d(t,"leftIndentProperty",function(){return n._69}),i.d(t,"rightIndentProperty",function(){return n._70}),i.d(t,"firstLineIndentProperty",function(){return n._71}),i.d(t,"textAlignmentProperty",function(){return n._72}),i.d(t,"afterSpacingProperty",function(){return n._73}),i.d(t,"beforeSpacingProperty",function(){return n._74}),i.d(t,"spaceAfterAutoProperty",function(){return n._75}),i.d(t,"spaceBeforeAutoProperty",function(){return n._76}),i.d(t,"lineSpacingProperty",function(){return n._77}),i.d(t,"lineSpacingTypeProperty",function(){return n._78}),i.d(t,"listFormatProperty",function(){return n._79}),i.d(t,"keepWithNextProperty",function(){return n._80}),i.d(t,"widowControlProperty",function(){return n._81}),i.d(t,"keepLinesTogetherProperty",function(){return n._82}),i.d(t,"outlineLevelProperty",function(){return n._83}),i.d(t,"contextualSpacingProperty",function(){return n._84}),i.d(t,"bordersProperty",function(){return n._85}),i.d(t,"tabsProperty",function(){return n._86}),i.d(t,"headerDistanceProperty",function(){return n._87}),i.d(t,"footerDistanceProperty",function(){return n._88}),i.d(t,"differentFirstPageProperty",function(){return n._89}),i.d(t,"differentOddAndEvenPagesProperty",function(){return n._90}),i.d(t,"pageWidthProperty",function(){return n._91}),i.d(t,"pageHeightProperty",function(){return n._92}),i.d(t,"leftMarginProperty",function(){return n._93}),i.d(t,"rightMarginProperty",function(){return n._94}),i.d(t,"topMarginProperty",function(){return n._95}),i.d(t,"bottomMarginProperty",function(){return n._96}),i.d(t,"restartPageNumberingProperty",function(){return n._97}),i.d(t,"pageStartingNumberProperty",function(){return n._98}),i.d(t,"endnoteNumberFormatProperty",function(){return n._99}),i.d(t,"footNoteNumberFormatProperty",function(){return n._100}),i.d(t,"restartIndexForFootnotesProperty",function(){return n._101}),i.d(t,"restartIndexForEndnotesProperty",function(){return n._102}),i.d(t,"initialFootNoteNumberProperty",function(){return n._103}),i.d(t,"initialEndNoteNumberProperty",function(){return n._104}),i.d(t,"pageNumberStyleProperty",function(){return n._105}),i.d(t,"columnsProperty",function(){return n._106}),i.d(t,"numberOfColumnsProperty",function(){return n._107}),i.d(t,"equalWidthProperty",function(){return n._108}),i.d(t,"lineBetweenColumnsProperty",function(){return n._109}),i.d(t,"breakCodeProperty",function(){return n._110}),i.d(t,"cellWidthProperty",function(){return n._111}),i.d(t,"columnSpanProperty",function(){return n._112}),i.d(t,"rowSpanProperty",function(){return n._113}),i.d(t,"verticalAlignmentProperty",function(){return n._114}),i.d(t,"allowBreakAcrossPagesProperty",function(){return n._115}),i.d(t,"isHeaderProperty",function(){return n._116}),i.d(t,"heightTypeProperty",function(){return n._117}),i.d(t,"beforeWidthProperty",function(){return n._118}),i.d(t,"afterWidthProperty",function(){return n._119}),i.d(t,"gridBeforeProperty",function(){return n._120}),i.d(t,"gridBeforeWidthProperty",function(){return n._121}),i.d(t,"gridBeforeWidthTypeProperty",function(){return n._122}),i.d(t,"gridAfterProperty",function(){return n._123}),i.d(t,"gridAfterWidthProperty",function(){return n._124}),i.d(t,"gridAfterWidthTypeProperty",function(){return n._125}),i.d(t,"allowAutoFitProperty",function(){return n._126}),i.d(t,"cellSpacingProperty",function(){return n._127}),i.d(t,"shadingProperty",function(){return n._128}),i.d(t,"tableAlignmentProperty",function(){return n._129}),i.d(t,"preferredWidthProperty",function(){return n._130}),i.d(t,"preferredWidthTypeProperty",function(){return n._131}),i.d(t,"horizontalPositionAbsProperty",function(){return n._132}),i.d(t,"textureProperty",function(){return n._133}),i.d(t,"backgroundColorProperty",function(){return n._134}),i.d(t,"foregroundColorProperty",function(){return n._135}),i.d(t,"shadowProperty",function(){return n._136}),i.d(t,"hasNoneStyleProperty",function(){return n._137}),i.d(t,"verticalProperty",function(){return n._138}),i.d(t,"horizontalProperty",function(){return n._139}),i.d(t,"diagonalUpProperty",function(){return n._140}),i.d(t,"diagonalDownProperty",function(){return n._141}),i.d(t,"lineStyleProperty",function(){return n._142}),i.d(t,"lineWidthProperty",function(){return n._143}),i.d(t,"layoutProperty",function(){return n._144}),i.d(t,"dataFormatProperty",function(){return n._145}),i.d(t,"yValueProperty",function(){return n._146}),i.d(t,"chartDataProperty",function(){return n._147});i.d(t,"categoryXNameProperty",function(){return n._148}),i.d(t,"lineProperty",function(){return n._149}),i.d(t,"foreColorProperty",function(){return n._150}),i.d(t,"patternProperty",function(){return n._151}),i.d(t,"layoutXProperty",function(){return n._152}),i.d(t,"layoutYProperty",function(){return n._153}),i.d(t,"directionProperty",function(){return n._154}),i.d(t,"endStyleProperty",function(){return n._155}),i.d(t,"numberValueProperty",function(){return n._156}),i.d(t,"markerStyleProperty",function(){return n._157}),i.d(t,"markerColorProperty",function(){return n._158}),i.d(t,"markerSizeProperty",function(){return n._159}),i.d(t,"forwardProperty",function(){return n._160}),i.d(t,"backwardProperty",function(){return n._161}),i.d(t,"interceptProperty",function(){return n._162}),i.d(t,"isDisplayRSquaredProperty",function(){return n._163}),i.d(t,"isDisplayEquationProperty",function(){return n._164}),i.d(t,"seriesNameProperty",function(){return n._165}),i.d(t,"dataLabelProperty",function(){return n._166}),i.d(t,"errorBarProperty",function(){return n._167}),i.d(t,"seriesFormatProperty",function(){return n._168}),i.d(t,"trendLinesProperty",function(){return n._169}),i.d(t,"dataPointsProperty",function(){return n._170}),i.d(t,"firstSliceAngleProperty",function(){return n._171}),i.d(t,"holeSizeProperty",function(){return n._172}),i.d(t,"isLegendKeyProperty",function(){return n._173}),i.d(t,"isBubbleSizeProperty",function(){return n._174}),i.d(t,"isCategoryNameProperty",function(){return n._175}),i.d(t,"isSeriesNameProperty",function(){return n._176}),i.d(t,"isValueProperty",function(){return n._177}),i.d(t,"isPercentageProperty",function(){return n._178}),i.d(t,"isLeaderLinesProperty",function(){return n._179}),i.d(t,"showSeriesKeysProperty",function(){return n._180}),i.d(t,"hasHorizontalBorderProperty",function(){return n._181}),i.d(t,"hasVerticalBorderProperty",function(){return n._182}),i.d(t,"hasBordersProperty",function(){return n._183}),i.d(t,"categoryTypeProperty",function(){return n._184}),i.d(t,"chartCategoryProperty",function(){return n._185}),i.d(t,"chartSeriesProperty",function(){return n._186}),i.d(t,"chartAreaProperty",function(){return n._187}),i.d(t,"chartTitleAreaProperty",function(){return n._188}),i.d(t,"plotAreaProperty",function(){return n._189}),i.d(t,"chartLegendProperty",function(){return n._190}),i.d(t,"chartPrimaryCategoryAxisProperty",function(){return n._191}),i.d(t,"chartPrimaryValueAxisProperty",function(){return n._192}),i.d(t,"chartTitleProperty",function(){return n._193}),i.d(t,"chartTypeProperty",function(){return n._194}),i.d(t,"gapWidthProperty",function(){return n._195}),i.d(t,"overlapProperty",function(){return n._196}),i.d(t,"chartDataTableProperty",function(){return n._197}),i.d(t,"textProperty",function(){return n._198}),i.d(t,"shapeIdProperty",function(){return n._199}),i.d(t,"alternativeTextProperty",function(){return n._200}),i.d(t,"visibleProperty",function(){return n._201}),i.d(t,"belowTextProperty",function(){return n._202}),i.d(t,"horizontalRuleProperty",function(){return n._203}),i.d(t,"widthProperty",function(){return n._204}),i.d(t,"heightProperty",function(){return n._205}),i.d(t,"widthScaleProperty",function(){return n._206}),i.d(t,"heightScaleProperty",function(){return n._207}),i.d(t,"lineFormatProperty",function(){return n._208}),i.d(t,"fillFormatProperty",function(){return n._209}),i.d(t,"textWrappingStyleProperty",function(){return n._210}),i.d(t,"textWrappingTypeProperty",function(){return n._211}),i.d(t,"verticalRelativePercentProperty",function(){return n._212}),i.d(t,"horizontalRelativePercentProperty",function(){return n._213}),i.d(t,"heightRelativePercentProperty",function(){return n._214}),i.d(t,"widthRelativePercentProperty",function(){return n._215}),i.d(t,"zOrderPositionProperty",function(){return n._216}),i.d(t,"layoutInCellProperty",function(){return n._217}),i.d(t,"lockAnchorProperty",function(){return n._218}),i.d(t,"autoShapeTypeProperty",function(){return n._219}),i.d(t,"textFrameProperty",function(){return n._220}),i.d(t,"colorProperty",function(){return n._221}),i.d(t,"fillProperty",function(){return n._222}),i.d(t,"textVerticalAlignmentProperty",function(){return n._223}),i.d(t,"imageStringProperty",function(){return n._224}),i.d(t,"metaFileImageStringProperty",function(){return n._225}),i.d(t,"lengthProperty",function(){return n._226}),i.d(t,"isInlineImageProperty",function(){return n._227}),i.d(t,"isMetaFileProperty",function(){return n._228}),i.d(t,"topProperty",function(){return n._229}),i.d(t,"bottomProperty",function(){return n._230}),i.d(t,"rightProperty",function(){return n._231}),i.d(t,"leftProperty",function(){return n._232}),i.d(t,"getImageHeightProperty",function(){return n._233}),i.d(t,"getImageWidthProperty",function(){return n._234}),i.d(t,"hasFieldEndProperty",function(){return n._235}),i.d(t,"formFieldDataProperty",function(){return n._236}),i.d(t,"fieldTypeProperty",function(){return n._237}),i.d(t,"enabledProperty",function(){return n._238}),i.d(t,"helpTextProperty",function(){return n._239}),i.d(t,"statusTextProperty",function(){return n._240}),i.d(t,"textInputProperty",function(){return n._241}),i.d(t,"checkBoxProperty",function(){return n._242}),i.d(t,"dropDownListProperty",function(){return n._243}),i.d(t,"maxLengthProperty",function(){return n._244}),i.d(t,"defaultValueProperty",function(){return n._245}),i.d(t,"formatProperty",function(){return n._246}),i.d(t,"sizeTypeProperty",function(){return n._247}),i.d(t,"sizeProperty",function(){return n._248}),i.d(t,"checkedProperty",function(){return n._249}),i.d(t,"dropDownItemsProperty",function(){return n._250}),i.d(t,"selectedIndexProperty",function(){return n._251}),i.d(t,"commentIdProperty",function(){return n._252}),i.d(t,"commentCharacterTypeProperty",function(){return n._253}),i.d(t,"authorProperty",function(){return n._254}),i.d(t,"initialProperty",function(){return n._255}),i.d(t,"dateProperty",function(){return n._256}),i.d(t,"doneProperty",function(){return n._257}),i.d(t,"replyCommentsProperty",function(){return n._258}),i.d(t,"revisionTypeProperty",function(){return n._259}),i.d(t,"revisionIdProperty",function(){return n._260}),i.d(t,"itemIDProperty",function(){return n._261}),i.d(t,"xmlProperty",function(){return n._262}),i.d(t,"footnoteTypeProperty",function(){return n._263}),i.d(t,"symbolCodeProperty",function(){return n._264}),i.d(t,"symbolFontNameProperty",function(){return n._265}),i.d(t,"customMarkerProperty",function(){return n._266}),i.d(t,"inlinesProperty",function(){return n._267}),i.d(t,"contentControlPropertiesProperty",function(){return n._268}),i.d(t,"lockContentControlProperty",function(){return n._269}),i.d(t,"lockContentsProperty",function(){return n._270}),i.d(t,"tagProperty",function(){return n._271}),i.d(t,"titleProperty",function(){return n._272}),i.d(t,"hasPlaceHolderTextProperty",function(){return n._273}),i.d(t,"multiLineProperty",function(){return n._274}),i.d(t,"isTemporaryProperty",function(){return n._275}),i.d(t,"dateCalendarTypeProperty",function(){return n._276}),i.d(t,"dateStorageFormatProperty",function(){return n._277}),i.d(t,"dateDisplayLocaleProperty",function(){return n._278}),i.d(t,"dateDisplayFormatProperty",function(){return n._279}),i.d(t,"isCheckedProperty",function(){return n._280}),i.d(t,"uncheckedStateProperty",function(){return n._281}),i.d(t,"checkedStateProperty",function(){return n._282}),i.d(t,"contentControlListItemsProperty",function(){return n._283}),i.d(t,"xmlMappingProperty",function(){return n._284}),i.d(t,"fontProperty",function(){return n._285}),i.d(t,"valueProperty",function(){return n._286}),i.d(t,"displayTextProperty",function(){return n._287}),i.d(t,"isMappedProperty",function(){return n._288}),i.d(t,"isWordMlProperty",function(){return n._289}),i.d(t,"prefixMappingProperty",function(){return n._290}),i.d(t,"xPathProperty",function(){return n._291}),i.d(t,"storeItemIdProperty",function(){return n._292}),i.d(t,"customXmlPartProperty",function(){return n._293}),i.d(t,"idProperty",function(){return n._294}),i.d(t,"cellFormatProperty",function(){return n._295}),i.d(t,"rowFormatProperty",function(){return n._296}),i.d(t,"cellsProperty",function(){return n._297}),i.d(t,"rowsProperty",function(){return n._298}),i.d(t,"descriptionProperty",function(){return n._299}),i.d(t,"wrapTextAroundProperty",function(){return n._300}),i.d(t,"isLegalStyleNumberingProperty",function(){return n._301}),i.d(t,"positioningProperty",function(){return n._302}),i.d(t,"tableFormatProperty",function(){return n._303}),i.d(t,"allowOverlapProperty",function(){return n._304}),i.d(t,"distanceTopProperty",function(){return n._305}),i.d(t,"distanceRightProperty",function(){return n._306}),i.d(t,"distanceLeftProperty",function(){return n._307}),i.d(t,"distanceBottomProperty",function(){return n._308}),i.d(t,"verticalOriginProperty",function(){return n._309}),i.d(t,"verticalPositionProperty",function(){return n._310}),i.d(t,"horizontalOriginProperty",function(){return n._311}),i.d(t,"horizontalAlignmentProperty",function(){return n._312}),i.d(t,"horizontalPositionProperty",function(){return n._313}),i.d(t,"blocksProperty",function(){return n._314}),i.d(t,"headerProperty",function(){return n._315}),i.d(t,"footerProperty",function(){return n._316}),i.d(t,"evenHeaderProperty",function(){return n._317}),i.d(t,"evenFooterProperty",function(){return n._318}),i.d(t,"firstPageHeaderProperty",function(){return n._319}),i.d(t,"firstPageFooterProperty",function(){return n._320}),i.d(t,"headersFootersProperty",function(){return n._321}),i.d(t,"sectionFormatProperty",function(){return n._322}),i.d(t,"listLevelPatternProperty",function(){return n._323}),i.d(t,"followCharacterProperty",function(){return n._324}),i.d(t,"startAtProperty",function(){return n._325}),i.d(t,"restartLevelProperty",function(){return n._326}),i.d(t,"levelNumberProperty",function(){return n._327}),i.d(t,"numberFormatProperty",function(){return n._328}),i.d(t,"abstractListIdProperty",function(){return n._329}),i.d(t,"nsidProperty",function(){return n._330}),i.d(t,"levelsProperty",function(){return n._331}),i.d(t,"overrideListLevelProperty",function(){return n._332}),i.d(t,"levelOverridesProperty",function(){return n._333}),i.d(t,"separatorProperty",function(){return n._334}),i.d(t,"continuationSeparatorProperty",function(){return n._335}),i.d(t,"continuationNoticeProperty",function(){return n._336}),i.d(t,"bookmarkTypeProperty",function(){return n._337}),i.d(t,"propertiesProperty",function(){return n._338}),i.d(t,"tabJustificationProperty",function(){return n._339}),i.d(t,"positionProperty",function(){return n._340}),i.d(t,"deletePositionProperty",function(){return n._341}),i.d(t,"leaderProperty",function(){return n._342}),i.d(t,"tabLeaderProperty",function(){return n._343}),i.d(t,"editRangeIdProperty",function(){return n._344}),i.d(t,"columnFirstProperty",function(){return n._345}),i.d(t,"columnLastProperty",function(){return n._346}),i.d(t,"userProperty",function(){return n._347});i.d(t,"groupProperty",function(){return n._348}),i.d(t,"editableRangeStartProperty",function(){return n._349}),i.d(t,"spaceProperty",function(){return n._350}),i.d(t,"fontSchemeProperty",function(){return n._351}),i.d(t,"fontSchemeNameProperty",function(){return n._352}),i.d(t,"majorFontSchemeProperty",function(){return n._353}),i.d(t,"minorFontSchemeProperty",function(){return n._354}),i.d(t,"fontSchemeListProperty",function(){return n._355}),i.d(t,"fontTypefaceProperty",function(){return n._356}),i.d(t,"typefaceProperty",function(){return n._357}),i.d(t,"panoseProperty",function(){return n._358}),i.d(t,"typeProperty",function(){return n._359}),i.d(t,"majorUnitProperty",function(){return n._360}),i.d(t,"maximumValueProperty",function(){return n._361}),i.d(t,"minimumValueProperty",function(){return n._362}),i.d(t,"hasMajorGridLinesProperty",function(){return n._363}),i.d(t,"hasMinorGridLinesProperty",function(){return n._364}),i.d(t,"majorTickMarkProperty",function(){return n._365}),i.d(t,"minorTickMarkProperty",function(){return n._366}),i.d(t,"tickLabelPositionProperty",function(){return n._367}),i.d(t,"rgbProperty",function(){return n._368}),i.d(t,"appearanceProperty",function(){return n._369}),i.d(t,"lineFormatTypeProperty",function(){return n._370}),i.d(t,"allowSpaceOfSameStyleInTableProperty",function(){return n._371}),i.d(t,"weightProperty",function(){return n._372}),i.d(t,"inlineFormatProperty",function(){return n._373}),i.d(t,"fontNameProperty",function(){return n._374}),i.d(t,"isCompressedProperty",function(){return n._375}),i.d(t,"columnIndexProperty",function(){return n._376}),i.d(t,"imagesProperty",function(){return n._377}),i.d(t,"isAfterParagraphMarkProperty",function(){return n._378}),i.d(t,"isAfterCellMarkProperty",function(){return n._379}),i.d(t,"isAfterRowMarkProperty",function(){return n._380}),i.d(t,"gridProperty",function(){return n._381}),i.d(t,"columnCountProperty",function(){return n._382}),i.d(t,"isAfterTableMarkProperty",function(){return n._383}),i.d(t,"incrementalOps",function(){return n._384}),i.d(t,"Print",function(){return n._385}),i.d(t,"ContextMenu",function(){return n._386}),i.d(t,"CommentReviewPane",function(){return n._387}),i.d(t,"CommentPane",function(){return n._388}),i.d(t,"CommentView",function(){return n._389}),i.d(t,"HyperlinkDialog",function(){return n._390}),i.d(t,"TableDialog",function(){return n._391}),i.d(t,"BookmarkDialog",function(){return n._392}),i.d(t,"TableOfContentsDialog",function(){return n._393}),i.d(t,"PageSetupDialog",function(){return n._394}),i.d(t,"ParagraphDialog",function(){return n._395}),i.d(t,"ListDialog",function(){return n._396}),i.d(t,"StyleDialog",function(){return n._397}),i.d(t,"BulletsAndNumberingDialog",function(){return n._398}),i.d(t,"FontDialog",function(){return n._399}),i.d(t,"TablePropertiesDialog",function(){return n._400}),i.d(t,"BordersAndShadingDialog",function(){return n._401}),i.d(t,"TableOptionsDialog",function(){return n._402}),i.d(t,"CellOptionsDialog",function(){return n._403}),i.d(t,"StylesDialog",function(){return n._404}),i.d(t,"SpellCheckDialog",function(){return n._405}),i.d(t,"CheckBoxFormFieldDialog",function(){return n._406}),i.d(t,"TextFormFieldDialog",function(){return n._407}),i.d(t,"DropDownFormFieldDialog",function(){return n._408}),i.d(t,"FormFieldPopUp",function(){return n._409}),i.d(t,"ColumnsDialog",function(){return n._410}),i.d(t,"TabDialog",function(){return n._411}),i.d(t,"Editor",function(){return n._412}),i.d(t,"ImageResizer",function(){return n._413}),i.d(t,"ImageResizingPoints",function(){return n._414}),i.d(t,"SelectedImageInfo",function(){return n._415}),i.d(t,"TableResizer",function(){return n._416}),i.d(t,"HelperMethods",function(){return n._417}),i.d(t,"Point",function(){return n._418}),i.d(t,"Base64",function(){return n._419}),i.d(t,"WrapPosition",function(){return n._420}),i.d(t,"CollaborativeEditing",function(){return n._421}),i.d(t,"EditorHistory",function(){return n._422}),i.d(t,"BaseHistoryInfo",function(){return n._423}),i.d(t,"HistoryInfo",function(){return n._424}),i.d(t,"ModifiedLevel",function(){return n._425}),i.d(t,"ModifiedParagraphFormat",function(){return n._426}),i.d(t,"RowHistoryFormat",function(){return n._427}),i.d(t,"TableHistoryInfo",function(){return n._428}),i.d(t,"TableFormatHistoryInfo",function(){return n._429}),i.d(t,"RowFormatHistoryInfo",function(){return n._430}),i.d(t,"CellFormatHistoryInfo",function(){return n._431}),i.d(t,"CellHistoryFormat",function(){return n._432}),i.d(t,"WSectionFormat",function(){return n._433}),i.d(t,"WColumnFormat",function(){return n._434}),i.d(t,"WStyle",function(){return n._435}),i.d(t,"WParagraphStyle",function(){return n._436}),i.d(t,"WCharacterStyle",function(){return n._437}),i.d(t,"WStyles",function(){return n._438}),i.d(t,"WCharacterFormat",function(){return n._439}),i.d(t,"WListFormat",function(){return n._440}),i.d(t,"WTabStop",function(){return n._441}),i.d(t,"WParagraphFormat",function(){return n._442}),i.d(t,"WTableFormat",function(){return n._443}),i.d(t,"WRowFormat",function(){return n._444}),i.d(t,"WCellFormat",function(){return n._445}),i.d(t,"WBorder",function(){return n._446}),i.d(t,"WBorders",function(){return n._447}),i.d(t,"WShading",function(){return n._448}),i.d(t,"WList",function(){return n._449}),i.d(t,"WAbstractList",function(){return n._450}),i.d(t,"WListLevel",function(){return n._451}),i.d(t,"WLevelOverride",function(){return n._452}),i.d(t,"AddUserDialog",function(){return n._453}),i.d(t,"EnforceProtectionDialog",function(){return n._454}),i.d(t,"UnProtectDocumentDialog",function(){return n._455}),i.d(t,"RestrictEditing",function(){return n._456}),i.d(t,"Search",function(){return n._457}),i.d(t,"OptionsPane",function(){return n._458}),i.d(t,"TextSearch",function(){return n._459}),i.d(t,"SearchWidgetInfo",function(){return n._460}),i.d(t,"TextSearchResult",function(){return n._461}),i.d(t,"TextSearchResults",function(){return n._462}),i.d(t,"Selection",function(){return n._463}),i.d(t,"SelectionCharacterFormat",function(){return n._464}),i.d(t,"SelectionBorder",function(){return n._465}),i.d(t,"SelectionBorders",function(){return n._466}),i.d(t,"SelectionParagraphFormat",function(){return n._467}),i.d(t,"SelectionHeaderFooter",function(){return n._468}),i.d(t,"SelectionSectionFormat",function(){return n._469}),i.d(t,"SelectionTableFormat",function(){return n._470}),i.d(t,"SelectionCellFormat",function(){return n._471}),i.d(t,"SelectionRowFormat",function(){return n._472}),i.d(t,"SelectionImageFormat",function(){return n._473}),i.d(t,"SelectionColumnFormat",function(){return n._474}),i.d(t,"TextPosition",function(){return n._475}),i.d(t,"SelectionWidgetInfo",function(){return n._476}),i.d(t,"Hyperlink",function(){return n._477}),i.d(t,"ImageSizeInfo",function(){return n._478}),i.d(t,"SpellChecker",function(){return n._479}),i.d(t,"Optimized",function(){return n._480}),i.d(t,"Regular",function(){return n._481}),i.d(t,"Revision",function(){return n._482}),i.d(t,"RevisionCollection",function(){return n._483}),i.d(t,"TrackChangesPane",function(){return n._484}),i.d(t,"ChangesSingleView",function(){return n._485}),i.d(t,"DocumentHelper",function(){return n._486}),i.d(t,"LayoutViewer",function(){return n._487}),i.d(t,"PageLayoutViewer",function(){return n._488}),i.d(t,"WebLayoutViewer",function(){return n._489}),i.d(t,"ColumnLayout",function(){return n._490}),i.d(t,"Rect",function(){return n._491}),i.d(t,"Padding",function(){return n._492}),i.d(t,"Margin",function(){return n._493}),i.d(t,"Widget",function(){return n._494}),i.d(t,"BlockContainer",function(){return n._495}),i.d(t,"BodyWidget",function(){return n._496}),i.d(t,"HeaderFooterWidget",function(){return n._497}),i.d(t,"BlockWidget",function(){return n._498}),i.d(t,"FootNoteWidget",function(){return n._499}),i.d(t,"ParagraphWidget",function(){return n._500}),i.d(t,"TablePosition",function(){return n._501}),i.d(t,"TableWidget",function(){return n._502}),i.d(t,"TableRowWidget",function(){return n._503}),i.d(t,"TableCellWidget",function(){return n._504}),i.d(t,"LineWidget",function(){return n._505}),i.d(t,"ElementBox",function(){return n._506}),i.d(t,"FieldElementBox",function(){return n._507}),i.d(t,"FormField",function(){return n._508}),i.d(t,"TextFormField",function(){return n._509}),i.d(t,"CheckBoxFormField",function(){return n._510}),i.d(t,"DropDownFormField",function(){return n._511}),i.d(t,"TextElementBox",function(){return n._512}),i.d(t,"Footnote",function(){return n._513}),i.d(t,"FootnoteElementBox",function(){return n._514}),i.d(t,"ErrorTextElementBox",function(){return n._515}),i.d(t,"FieldTextElementBox",function(){return n._516}),i.d(t,"TabElementBox",function(){return n._517}),i.d(t,"BookmarkElementBox",function(){return n._518}),i.d(t,"ContentControl",function(){return n._519}),i.d(t,"ContentControlProperties",function(){return n._520}),i.d(t,"ContentControlListItems",function(){return n._521}),i.d(t,"CheckBoxState",function(){return n._522}),i.d(t,"XmlMapping",function(){return n._523}),i.d(t,"CustomXmlPart",function(){return n._524}),i.d(t,"ShapeCommon",function(){return n._525}),i.d(t,"ShapeBase",function(){return n._526}),i.d(t,"ShapeElementBox",function(){return n._527}),i.d(t,"TextFrame",function(){return n._528}),i.d(t,"LineFormat",function(){return n._529}),i.d(t,"FillFormat",function(){return n._530}),i.d(t,"ImageElementBox",function(){return n._531}),i.d(t,"ListTextElementBox",function(){return n._532}),i.d(t,"EditRangeEndElementBox",function(){return n._533}),i.d(t,"EditRangeStartElementBox",function(){return n._534}),i.d(t,"ChartElementBox",function(){return n._535}),i.d(t,"ChartArea",function(){return n._536}),i.d(t,"ChartCategory",function(){return n._537}),i.d(t,"ChartData",function(){return n._538}),i.d(t,"ChartLegend",function(){return n._539}),i.d(t,"ChartSeries",function(){return n._540}),i.d(t,"ChartErrorBar",function(){return n._541}),i.d(t,"ChartSeriesFormat",function(){return n._542}),i.d(t,"ChartDataLabels",function(){return n._543}),i.d(t,"ChartTrendLines",function(){return n._544}),i.d(t,"ChartTitleArea",function(){return n._545}),i.d(t,"ChartDataFormat",function(){return n._546}),i.d(t,"ChartFill",function(){return n._547});i.d(t,"ChartLayout",function(){return n._548}),i.d(t,"ChartCategoryAxis",function(){return n._549}),i.d(t,"ChartDataTable",function(){return n._550}),i.d(t,"CommentCharacterElementBox",function(){return n._551}),i.d(t,"CommentElementBox",function(){return n._552}),i.d(t,"Page",function(){return n._553}),i.d(t,"WTableHolder",function(){return n._554}),i.d(t,"WColumn",function(){return n._555}),i.d(t,"ColumnSizeInfo",function(){return n._556}),i.d(t,"CommentEditInfo",function(){return n._557}),i.d(t,"BreakElementBox",function(){return n._558}),i.d(t,"TabStopListInfo",function(){return n._559}),i.d(t,"Layout",function(){return n._560}),i.d(t,"Renderer",function(){return n._561}),i.d(t,"SfdtReader",function(){return n._562}),i.d(t,"TextHelper",function(){return n._563}),i.d(t,"Zoom",function(){return n._564}),i.d(t,"WordExport",function(){return n._565}),i.d(t,"TextExport",function(){return n._566}),i.d(t,"SfdtExport",function(){return n._567}),i.d(t,"HtmlExport",function(){return n._568}),i.d(t,"FontScheme",function(){return n._569}),i.d(t,"FontSchemeStruct",function(){return n._570}),i.d(t,"Themes",function(){return n._571}),i.d(t,"MajorMinorFontScheme",function(){return n._572}),i.d(t,"CollaborativeEditingHandler",function(){return n._573});var r=i(70);i.d(t,"DocumentEditorContainer",function(){return r.a}),i.d(t,"Toolbar",function(){return r.b})},function(e,t){e.exports=d},function(e,t){e.exports=h},function(e,t,i){"use strict";i.d(t,"a",function(){return r});var n=i(0),r=(i.n(n),function(){function e(){this.mode=!0}return e.prototype.send=function(e,t,r){var o=this;this.xmlHttpRequest=new XMLHttpRequest;var s=0;r=!!i.i(n.isNullOrUndefined)(r)||r,i.i(n.isNullOrUndefined)(t)||(this.xmlHttpRequest.withCredentials=t.withCredentials,s=t.timeout>=0?t.timeout:0,this.customHeaders=t.headers),this.xmlHttpRequest.onreadystatechange=function(){o.stateChange(o)},this.xmlHttpRequest.onerror=function(){o.error(o)},this.mode?this.sendRequest(e,s,r):setTimeout(function(){o.sendRequest(e,s,r)})},e.prototype.sendRequest=function(e,t,i){this.xmlHttpRequest.open("POST",this.url,i),i&&(this.xmlHttpRequest.timeout=t),this.contentType&&this.xmlHttpRequest.setRequestHeader("Content-Type",this.contentType),this.setCustomAjaxHeaders(),this.responseType&&(this.xmlHttpRequest.responseType=this.responseType);var n=e instanceof FormData?e:JSON.stringify(e);this.xmlHttpRequest.send(n)},e.prototype.stateChange=function(e){if(4===e.xmlHttpRequest.readyState&&200===e.xmlHttpRequest.status){var t=void 0;t=this.responseType?e.xmlHttpRequest.response:e.xmlHttpRequest.responseText;var i={name:"onSuccess",data:t,readyState:e.xmlHttpRequest.readyState,status:e.xmlHttpRequest.status};e.successHandler(i)}else if(4===e.xmlHttpRequest.readyState&&200!==e.xmlHttpRequest.status){var i={name:"onFailure",status:e.xmlHttpRequest.status,statusText:e.xmlHttpRequest.statusText,url:e.url};e.failureHandler(i)}},e.prototype.error=function(e){var t={name:"onError",status:this.xmlHttpRequest.status,statusText:this.xmlHttpRequest.statusText};e.errorHandler(t)},e.prototype.successHandler=function(e){return this.onSuccess&&this.onSuccess(e),e},e.prototype.failureHandler=function(e){return this.onFailure&&this.onFailure(e),e},e.prototype.errorHandler=function(e){return this.onError&&this.onError(e),e},e.prototype.setCustomAjaxHeaders=function(){for(var e=0;e<this.customHeaders.length;e++)for(var t=this.customHeaders[e],i=0,n=Object.keys(t);i<n.length;i++){var r=n[i];this.xmlHttpRequest.setRequestHeader(r,t[r])}},e}())},function(e,t,i){"use strict";i.d(t,"b",function(){return x}),i.d(t,"c",function(){return C}),i.d(t,"d",function(){return I}),i.d(t,"a",function(){return F}),i.d(t,"e",function(){return k}),i.d(t,"f",function(){return P}),i.d(t,"g",function(){return T}),i.d(t,"h",function(){return S});var n=i(0),r=(i.n(n),i(44)),o=(i.n(r),i(1)),s=i(63),a=i(51),l=i(7),d=i(50),h=i(48),c=i(25),p=i(97),u=i(2),g=i(28),f=i(47),m=i(33),v=(i.n(m),i(52)),y=i(130),w=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),b=this&&this.__decorate||function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},x=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return w(t,e),b([i.i(n.Property)(null)],t.prototype,"popupTarget",void 0),b([i.i(n.Property)("#FFE97F")],t.prototype,"searchHighlightColor",void 0),b([i.i(n.Property)(["Algerian","Arial","Calibri","Cambria","Cambria Math","Candara","Courier New","Georgia","Impact","Segoe Print","Segoe Script","Segoe UI","Symbol","Times New Roman","Verdana","Wingdings"])],t.prototype,"fontFamilies",void 0),b([i.i(n.Property)({shadingColor:"#cfcfcf",applyShading:!0,selectionColor:"#cccccc",formFillingMode:"Popup"})],t.prototype,"formFieldSettings",void 0),b([i.i(n.Property)({interval:2e3,itertationCount:5})],t.prototype,"autoResizeSettings",void 0),b([i.i(n.Property)({roomName:"",editableRegionColor:"#22b24b",lockedRegionColor:"#f44336"})],t.prototype,"collaborativeEditingSettings",void 0),b([i.i(n.Property)(1)],t.prototype,"printDevicePixelRatio",void 0),b([i.i(n.Property)(!0)],t.prototype,"enableOptimizedTextMeasuring",void 0),b([i.i(n.Property)(!0)],t.prototype,"allowDragAndDrop",void 0),b([i.i(n.Property)(32767)],t.prototype,"maximumRows",void 0),b([i.i(n.Property)(63)],t.prototype,"maximumColumns",void 0),b([i.i(n.Property)(!1)],t.prototype,"showHiddenMarks",void 0),b([i.i(n.Property)(!1)],t.prototype,"showBookmarks",void 0),b([i.i(n.Property)(!0)],t.prototype,"highlightEditableRanges",void 0),b([i.i(n.Property)(!0)],t.prototype,"optimizeSfdt",void 0),b([i.i(n.Property)(!1)],t.prototype,"showRuler",void 0),t}(n.ChildProperty),C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return w(t,e),b([i.i(n.Property)("Word2013")],t.prototype,"compatibilityMode",void 0),t}(n.ChildProperty),I=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return w(t,e),b([i.i(n.Property)(2e3)],t.prototype,"interval",void 0),b([i.i(n.Property)(5)],t.prototype,"iterationCount",void 0),t}(n.ChildProperty),F=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.enableHeaderFooterIn=!1,n.isShiftingEnabled=!1,n.isLayoutEnabled=!0,n.isPastingContent=!1,n.isOnIndent=!1,n.isTableMarkerDragging=!1,n.startXPosition=0,n.parser=void 0,n.disableHistoryIn=!1,n.documentSettingOps=[],n.skipSettingsOps=!1,n.isSettingOp=!1,n.findResultsList=void 0,n.tablePropertiesDialogModule=void 0,n.bordersAndShadingDialogModule=void 0,n.cellOptionsDialogModule=void 0,n.tableOptionsDialogModule=void 0,n.paragraphDialogModule=void 0,n.imageResizerModule=void 0,n.createdTriggered=!1,n.defaultLocale={Table:"Table",Row:"Row",Cell:"Cell",Ok:"OK",Apply:"Apply","Alt Text":"Alt Text",Title:"Title",Description:"Description",Cancel:"Cancel",Size:"Size","Preferred Width":"Preferred width",Points:"Points",Percent:"Percent","Measure in":"Measure in",Alignment:"Alignment",Left:"Left",Center:"Center",Right:"Right",Decimal:"Decimal",Bar:"Bar",Justify:"Justify","Indent from left":"Indent from left","Borders and Shading":"Borders and Shading",Options:"Options","Specify height":"Specify height","At least":"At least",Exactly:"Exactly","Row height is":"Row height is","Allow row to break across pages":"Allow row to break across pages","Repeat as header row at the top of each page":"Repeat as header row at the top of each page","Vertical alignment":"Vertical alignment",Top:"Top",Bottom:"Bottom","Default cell margins":"Default cell margins","Default cell spacing":"Default cell spacing","Allow spacing between cells":"Allow spacing between cells","Cell margins":"Cell margins","Same as the whole table":"Same as the whole table",Borders:"Borders",None:"None",Style:"Style",Width:"Width",Height:"Height",Letter:"Letter","1, 2, 3, ...":"1, 2, 3, ...","a, b, c, ...":"a, b, c, ...","A, B, C, ...":"A, B, C, ...","I, II, III, ...":"I, II, III, ...","i, ii, iii, ...":"i, ii, iii, ...",Tabloid:"Tabloid",Legal:"Legal",Statement:"Statement",Executive:"Executive",A3:"A3",A4:"A4",A5:"A5",B4:"B4",B5:"B5","Custom Size":"Custom size","Different odd and even":"Different odd and even","Different first page":"Different first page","From edge":"From edge",Header:"Header",Footer:"Footer","First Page Header":"First Page Header","First Page Footer":"First Page Footer","Even Page Header":"Even Page Header","Even Page Footer":"Even Page Footer","Odd Page Header":"Odd Page Header","Odd Page Footer":"Odd Page Footer","Same as Previous":"Same as Previous",Section:"Section",Margin:"Margins",Paper:"Paper",Layout:"Layout",Orientation:"Orientation",Landscape:"Landscape",Portrait:"Portrait","Show page numbers":"Show page numbers","Right align page numbers":"Right align page numbers",Nothing:"Nothing","Tab leader":"Tab leader",Leader:"Leader","Show levels":"Show levels","Use hyperlinks instead of page numbers":"Use hyperlinks instead of page numbers","Build table of contents from":"Build table of contents from",Styles:"Styles","Available styles":"Available styles","TOC level":"TOC level",Heading:"Heading","Heading 1":"Heading 1","Heading 2":"Heading 2","Heading 3":"Heading 3","Heading 4":"Heading 4","Heading 5":"Heading 5","Heading 6":"Heading 6","List Paragraph":"List Paragraph",Normal:"Normal","Outline levels":"Outline levels","Table entry fields":"Table entry fields",Modify:"Modify",Color:"Color",Setting:"Setting",Box:"Box",All:"All",Custom:"Custom",Preview:"Preview",Shading:"Shading",Fill:"Fill","Apply To":"Apply to","Table Properties":"Table Properties","Cell Options":"Cell Options","Table Options":"Table Options","Insert Table":"Insert Table","Number of columns":"Number of columns","Number of rows":"Number of rows","Text to display":"Text to display","ScreenTip text":"ScreenTip text",Address:"Address","Insert Hyperlink":"Insert Hyperlink","Edit Hyperlink":"Edit Hyperlink",Insert:"Insert",General:"General",Indentation:"Indentation","Before text":"Before text",Special:"Special","First line":"First line",Hanging:"Hanging","After text":"After text",By:"By",Before:"Before","Line Spacing":"Line spacing",After:"After",At:"At",Multiple:"Multiple",Spacing:"Spacing","Define new Multilevel list":"Define new Multilevel list","List level":"List level","Choose level to modify":"Choose level to modify",Level:"Level","Number format":"Number format","Number style for this level":"Number style for this level","Enter formatting for number":"Enter formatting for number","Start at":"Start at","Restart list after":"Restart list after",Position:"Position","Text indent at":"Text indent at","Aligned at":"Aligned at","Follow number with":"Follow number with","Tab character":"Tab character",Space:"Space",Arabic:"Arabic",UpRoman:"UpRoman",LowRoman:"LowRoman",UpLetter:"UpLetter",LowLetter:"LowLetter",Number:"Number","Leading zero":"Leading zero",Bullet:"Bullet",Ordinal:"Ordinal","Ordinal Text":"Ordinal Text","For East":"For East","No Restart":"No Restart",Font:"Font","Font style":"Font style","Underline style":"Underline style","Font color":"Font color",Effects:"Effects",Strikethrough:"Strikethrough",Superscript:"Superscript",Subscript:"Subscript","Double strikethrough":"Double strikethrough",Regular:"Regular",Bold:"Bold",Italic:"Italic",Cut:"Cut",Copy:"Copy",Paste:"Paste",Hyperlink:"Hyperlink","Open Hyperlink":"Open Hyperlink","Copy Hyperlink":"Copy Hyperlink","Remove Hyperlink":"Remove Hyperlink",Paragraph:"Paragraph","Linked Style":"Linked(Paragraph and Character)",Character:"Character","Merge Cells":"Merge Cells","Insert Above":"Insert Above","Insert Below":"Insert Below","Insert Left":"Insert Left","Insert Right":"Insert Right",Delete:"Delete","Delete Table":"Delete Table","Delete Row":"Delete Row","Delete Column":"Delete Column","File Name":"File Name","Format Type":"Format Type",Save:"Save",Navigation:"Navigation",Results:"Results",Replace:"Replace","Replace All":"Replace All","We replaced all":"We replaced all",Find:"Find","No matches":"No matches","All Done":"All Done",Result:"Result",of:"of",instances:"instances",with:"with","Click to follow link":"Click to follow link","Continue Numbering":"Continue Numbering","Bookmark name":"Bookmark name",Tab:"Tab","Tab stop position":"Tab stop position",Close:"Close","Restart At":"Restart At",Properties:"Properties",Name:"Name","Style type":"Style type","Style based on":"Style based on","Style for following paragraph":"Style for following paragraph",Formatting:"Formatting","Numbering and Bullets":"Numbering and Bullets",Numbering:"Numbering","Update Field":"Update Field","Edit Field":"Edit Field",Bookmark:"Bookmark","Page Setup":"Page Setup","No bookmarks found":"No bookmarks found","Number format tooltip information":'Single-level number format: </br>[PREFIX]%[LEVELNUMBER][SUFFIX]</br>For example, "Chapter %1." will display numbering like</br>Chapter 1. Item</br>Chapter 2. Item</br></br>Chapter N. Item</br></br>Multilevel number format:</br>[PREFIX]%[LEVELNUMBER][SUFFIX]+[PREFIX]%[LEVELNUMBER][SUFFIX]</br>For example, "%1.%2." will display numbering like</br>1.1. Item</br>1.2. Item</br></br>1.N. Item',Format:"Format","Create New Style":"Create New Style","Modify Style":"Modify Style",New:"New",InsertFootnote:"InsertFootnote",InsertEndnote:"InsertEndnote",Footnote:"Footnote",Endnote:"Endnote","Notes Options":"Notes Options",Bullets:"Bullets","Use bookmarks":"Use bookmarks","Table of Contents":"Table of Contents",AutoFit:"AutoFit","AutoFit to Contents":"AutoFit to Contents","AutoFit to Window":"AutoFit to Window","Fixed Column Width":"Fixed Column Width",Reset:"Reset","Match case":"Match case","Whole words":"Whole words",Add:"Add","Go To":"Go To","Search for":"Search for","Replace with":"Replace with","TOC 1":"TOC 1","TOC 2":"TOC 2","TOC 3":"TOC 3","TOC 4":"TOC 4","TOC 5":"TOC 5","TOC 6":"TOC 6","TOC 7":"TOC 7","TOC 8":"TOC 8","TOC 9":"TOC 9","Right-to-left":"Right-to-left","Left-to-right":"Left-to-right",Direction:"Direction","Table direction":"Table direction","Indent from right":"Indent from right","Contextual Spacing":"Don't add space between paragraphs of the same style","Password Mismatch":"The password don't match","Restrict Editing":"Restrict Editing","Formatting restrictions":"Formatting restrictions","Allow formatting":"Allow formatting","Editing restrictions":"Editing restrictions","Read only":"Read only","Exceptions Optional":"Exceptions (optional)","Select Part Of Document And User":"Select parts of the document and choose users who are allowed to freely edit them.",Everyone:"Everyone","More users":"More users","Add Users":"Add Users","Enforcing Protection":"Yes, Start Enforcing Protection","Start Enforcing Protection":"Start Enforcing Protection","Enter User":"Enter User",Users:"Users","Enter new password":"Enter new password","Reenter new password to confirm":"Reenter new password to confirm","Your permissions":"Your permissions","Protected Document":"This document is protected from unintentional editing.",FormFieldsOnly:"You may only fill in forms in this region.",CommentsOnly:"You may only insert comments into this region.",ReadOnlyProtection:"You may edit in this region.","Stop Protection":"Stop Protection",Password:"Password","Spelling Editor":"Spelling Editor",Spelling:"Spelling","Spell Check":"Spell Check","Underline errors":"Underline errors",Ignore:"Ignore","Ignore All":"Ignore All","Add to Dictionary":"Add to Dictionary",Change:"Change","Change All":"Change All",Suggestions:"Suggestions","The password is incorrect":"The password is incorrect","Error in establishing connection with web server":"Error in establishing connection with web server","Highlight the regions I can edit":"Highlight the regions I can edit","Show All Regions I Can Edit":"Show All Regions I Can Edit","Find Next Region I Can Edit":"Find Next Region I Can Edit","Keep source formatting":"Keep source formatting","Match destination formatting":"Match destination formatting",InsertAsRows:"Insert as New Rows",InsertAsColumns:"Insert as New Columns",OverwriteCells:"Overwrite Cells",NestTable:"Nest Table","Text only":"Text only",Comments:"Comments","Type your comment":"Type your comment",Post:"Post",Reply:"Reply","New Comment":"New Comment",Edit:"Edit",Resolve:"Resolve",Reopen:"Reopen","No comments in this document":"No comments in this document",more:"more","Type your comment here":"Type your comment here","Next Comment":"Next Comment","Previous Comment":"Previous Comment","Un-posted comments":"Un-posted comments","Discard Comment":"Added comments not posted. If you continue, that comment will be discarded.","No Headings":"No Heading Found!","Add Headings":"This document has no headings. Please add headings and try again.","More Options":"More Options","Click to see this comment":"Click to see this comment","Form Fields":"Form Fields","Text Form":"Text Form","Check Box":"Check Box","Drop Down Form Field":"Drop Down Form Field","Dropdown items":"Drop-down items","Items in dropdown list":"Items in drop-down list",ADD:"ADD",REMOVE:"REMOVE","Field settings":"Field settings",Tooltip:"Tooltip","Dropdown enabled":"Drop-down enabled","Check Box Form Field":"Check Box Form Field","Check box size":"Check box size",Auto:"Auto","Default value":"Default value","Not checked":"Not checked",Checked:"Checked","Check box enabled":"Check box enabled","Text Form Field":"Text Form Field",Type:"Type","Default text":"Default text","Maximum length":"Maximum length","Text format":"Text format","Fillin enabled":"Fill-in enabled","Default number":"Default number","Default date":"Default date","Date format":"Date format","Merge Track":"This action wont be marked as change. Do you want to continue?",UnTrack:"Cannot be tracked !",Accept:"Accept",Reject:"Reject","Previous Changes":"Previous Changes","Next Changes":"Next Changes",Inserted:"Inserted",Deleted:"Deleted","Move From":"Move From","Move To":"Move To",Changes:"Changes","Accept all":"Accept all","Reject all":"Reject all","No changes":"No changes","Accept Changes":"Accept Changes","Reject Changes":"Reject Changes",User:"User",View:"View",Insertion:"Insertion",Deletion:"Deletion","All caps":"All caps","This region is locked by":"This region is locked by",Lock:"Lock",Unlock:"Unlock","Already locked":"Selected or part of region is already locked by another user","Click to View/Edit Footnote":"Click to View/Edit Footnote","Click to View/Edit Endnote":"Click to View/Edit Endnote","Multiple Comment":"Please post your comment","No suggestions":"No suggestions","More Suggestion":"More Suggestion","Ignore Once":"Ignore Once","Keep With Next":"Keep with next","Keep Lines Together":"Keep lines together",WidowControl:"Widow/Orphan control","Indents and Spacing":"Indents and Spacing","Line and Page Breaks":"Line and Page Breaks",Pagination:"Pagination",Single:"Single",DashSmallGap:"DashSmallGap",DashDot:"DashDot",Double:"Double",ThinThickSmallGap:"ThinThickSmallGap",ThickThinSmallGap:"ThickThinSmallGap",ThickThinMediumGap:"ThickThinMediumGap",ThickThinLargeGap:"ThickThinLargeGap",SingleWavy:"SingleWavy",DoubleWavy:"DoubleWavy",Inset:"Inset",DashLargeGap:"DashLargeGap",Dot:"Dot",DashDotDot:"DashDotDot",Triple:"Triple",ThinThickThinSmallGap:"ThinThickThinSmallGap",ThinThickThinMediumGap:"ThinThickThinMediumGap",ThinThickThinLargeGap:"ThinThickThinLargeGap",DashDotStroked:"DashDotStroked",Engrave3D:"Engrave3D",Thick:"Thick",Outset:"Outset",Emboss3D:"Emboss3D",ThinThickLargeGap:"ThinThickLargeGap",ThinThickMediumGap:"ThinThickMediumGap","Number of rows must be between":"Number of rows must be between","Number of columns must be between":"Number of columns must be between",and:"and",Unlimited:"Unlimited","Regular text":"Regular text",Date:"Date",Uppercase:"Uppercase",Lowercase:"Lowercase",FirstCapital:"FirstCapital",TitleCase:"Titlecase","Filling in forms":"Filling in forms",px:"px","Tracked changes":"Tracked changes",TrackChangesOnly:"You may edit in this region, but all change will be tracked.",RemovedIgnoreExceptions:"If you make this change in document protection, Word will ignore all the exceptions in this document.",RemovedIgnore:"Do you want to remove the ignored exceptions?",Information:"Information",Yes:"Yes",No:"No","Page Break":"Page Break","Column Break":"Column Break","Section Break Next Page":"Section Break (Next Page)","Section Break Continuous":"Section Break (Continuous)","Unsupported format":"The file format you have selected isn't supported. Please choose valid format.",One:"One",Two:"Two",Three:"Three",Presets:"Presets",Columns:"Columns","Split your text into two or more columns":"Split your text into two or more columns","Line between column":"Line between column","Width and Spacing":"Width and Spacing","Equal column width":"Equal column width",Column:"Column","Paste Content Dialog":"Due to browsers security policy, paste from system clipboard is restricted. Alternatively use the keyboard shortcut","Paste Content CheckBox":"Dont show again",BookMarkList:"List of bookmarks in the document",TabMarkList:"List of tab stops in the paragraph","Default tab stops":"Default tab stops","Tab stops to be cleared":"Tab stops to be cleared",Tabs:"Tabs",Set:"Set",Clear:"Clear","Clear All":"Clear All",Discard:"Discard","The top/bottom margins are too large for the page height in some sections.":"The top/bottom margins are too large for the page height in some sections.","Column width cannot be less than 36 pt.":"Column width cannot be less than 36 pt.","Left and right margins.":"Settings you chose for the left and right margins, column spacing, or pargraph indents are too large for the page width in same secitions.","Left Indent":"Left Indent","Right Indent":"Right Indent","Hanging Indent":"Hanging Indent","First Line Indent":"First Line Indent","Left Margin":"Left Margin","Right Margin":"Right Margin","Top Margin":"Top Margin","Bottom Margin":"Bottom Margin","Left Tab":"Left Tab","Right Tab":"Right Tab","Center Tab":"Center Tab","Decimal Tab":"Decimal Tab","Bar Tab":"Bar Tab","Move Table Column":"Move Table Column"},n.initHelper(),n}w(t,e),I=t,Object.defineProperty(t.prototype,"enableHeaderAndFooter",{get:function(){return this.enableHeaderFooterIn},set:function(e){this.enableHeaderFooterIn=e,!e&&this.selection&&this.selection.isWebLayout&&(this.selection.isWebLayout=!1),this.viewer.updateScrollBars()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageCount",{get:function(){return!this.isDocumentLoaded||i.i(n.isNullOrUndefined)(this.viewer)||this.viewer instanceof o._489?1:this.documentHelper.pages.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selection",{get:function(){return this.selectionModule},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"editor",{get:function(){return this.editorModule},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"editorHistory",{get:function(){return this.editorHistoryModule},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"search",{get:function(){return this.searchModule},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contextMenu",{get:function(){return this.contextMenuModule},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"spellCheckDialog",{get:function(){return this.spellCheckDialogModule},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"spellChecker",{get:function(){return this.spellCheckerModule},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"containerId",{get:function(){return this.element.id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDocumentLoaded",{get:function(){return this.isDocumentLoadedIn},set:function(e){this.isDocumentLoadedIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDocumentEmpty",{get:function(){if(1==this.documentHelper.pages.length){var e=this.documentHelper.pages[0],t=e.headerWidget,r=e.footerWidget,s=!0,a=!0;if(i.i(n.isNullOrUndefined)(t)||i.i(n.isNullOrUndefined)(t.firstChild)||t.firstChild instanceof o._500&&t.firstChild.isEmpty()||(s=!1),i.i(n.isNullOrUndefined)(r)||i.i(n.isNullOrUndefined)(r.firstChild)||r.firstChild instanceof o._500&&r.firstChild.isEmpty()||(a=!1),s&&a){var l=e.bodyWidgets[0];if(i.i(n.isNullOrUndefined)(l.nextWidget)){var d=l.firstChild;if(d instanceof o._500&&d.isEmpty()&&i.i(n.isNullOrUndefined)(d.nextWidget))return!0}}return!1}return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"revisions",{get:function(){return i.i(n.isNullOrUndefined)(this.revisionsInternal)&&(this.revisionsInternal=new c.a(this)),this.revisionsInternal},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"enableHistoryMode",{get:function(){return this.enableEditorHistory&&!i.i(n.isNullOrUndefined)(this.editorHistoryModule)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"documentStart",{get:function(){if(!i.i(n.isNullOrUndefined)(this.selectionModule))return this.selection.getDocumentStart()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"documentEnd",{get:function(){if(!i.i(n.isNullOrUndefined)(this.selectionModule))return this.selection.getDocumentEnd()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isReadOnlyMode",{get:function(){return this.isReadOnly||i.i(n.isNullOrUndefined)(this.editorModule)||i.i(n.isNullOrUndefined)(this.selectionModule)||!i.i(n.isNullOrUndefined)(this.editor)&&this.editor.restrictEditing},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isSpellCheck",{get:function(){return this.enableSpellCheck&&this.spellChecker.enableSpellCheck},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"enableImageResizerMode",{get:function(){return this.enableImageResizer&&!i.i(n.isNullOrUndefined)(this.imageResizerModule)},enumerable:!0,configurable:!0}),t.prototype.preRender=function(){var e=this;this.documentEditorSettings&&this.documentEditorSettings.enableOptimizedTextMeasuring?I.Inject(o._480):I.Inject(o._481),this.findResultsList=[],setTimeout(function(){i.i(n.isNullOrUndefined)(e.documentEditorSettings.popupTarget)&&(e.documentEditorSettings.popupTarget=document.body)},0),i.i(n.isNullOrUndefined)(this.element)||""!==this.element.id||(this.element.id=o._417.getUniqueElementId()),this.refreshing&&this.initHelper()},t.prototype.initHelper=function(){this.documentHelper=new o._486(this),"Pages"===this.layoutType?this.viewer=new o._488(this):this.viewer=new o._489(this),this.parser=new o._562(this.documentHelper)},t.prototype.render=function(){if(!i.i(n.isNullOrUndefined)(this.element)){var e=this.element;e.style.minHeight="200px",e.style.minWidth="200px",""!==this.height&&(this.element.style.height=i.i(n.formatUnit)(this.height)),""!==this.width&&(this.element.style.width=i.i(n.formatUnit)(this.width))}this.textMeasureHelper=this.optimizedModule?this.optimizedModule:this.regularModule,i.i(n.isNullOrUndefined)(this.textMeasureHelper)&&(this.textMeasureHelper=new o._480(this.documentHelper)),this.documentHelper.initializeComponents(),this.openBlank(),this.renderComplete(),this.renderRulers(),this.createdTriggered=!0},t.prototype.renderRulers=function(){this.rulerHelper=new y.a,this.rulerContainer=this.rulerHelper.renderOverlapElement(this),this.rulerHelper.renderRuler(this,!0),this.rulerHelper.renderRuler(this,!1),this.rulerHelper.renderRulerMarkerIndicatorElement(this),this.rulerHelper.createIndicatorLines(this),this.showHideRulers()},t.prototype.showHideRulers=function(){if(this.rulerHelper&&this.documentEditorSettings&&!i.i(n.isNullOrUndefined)(!this.documentEditorSettings.showRuler)){var e=this.documentEditorSettings.showRuler&&!this.isReadOnlyMode;this.rulerHelper.hideTabStopSwitch(e),this.rulerHelper.hideRulerBottom(e),this.vRuler&&this.vRuler.showHideRuler(e),this.hRuler&&this.hRuler.showHideRuler(e)}},t.prototype.getModuleName=function(){return"DocumentEditor"},t.prototype.onPropertyChanged=function(e,t){for(var r=this,s=0,a=Object.keys(e);s<a.length;s++){switch(a[s]){case"enableTrackChanges":this.notify(g.h,e),this.getSettingData("enableTrackChanges",e.enableTrackChanges),this.documentHelper.isTrackedOnlyMode&&!e.enableTrackChanges&&(this.enableTrackChanges=!0);break;case"autoResizeOnVisibilityChange":e.autoResizeOnVisibilityChange&&this.documentHelper.triggerAutoResizeInterval();break;case"zoomFactor":this.viewer&&t.zoomFactor!==e.zoomFactor&&(this.documentHelper.zoomFactor=e.zoomFactor,this.rulerHelper&&this.documentEditorSettings&&this.documentEditorSettings.showRuler&&this.rulerHelper.updateRuler(this,!0));break;case"layoutType":if(this.selection&&this.selection.isWebLayout)break;this.viewer.destroy(),"Pages"===this.layoutType?this.viewer=new o._488(this):(!0===this.enableHeaderAndFooter&&this.selection.closeHeaderFooter(),this.viewer=new o._489(this));this.selection.start.paragraph.containerWidget instanceof u.a&&(this.selection.clearSelectionHighlightInSelectedWidgets(),this.selection.selectContent(this.documentStart,!0)),this.editor.layoutWholeDocument(!0),setTimeout(function(){r.fireViewChange()},200);break;case"locale":this.localizeDialogs();break;case"isReadOnly":!i.i(n.isNullOrUndefined)(this.optionsPaneModule)&&this.optionsPaneModule.isOptionsPaneShow&&(this.optionsPaneModule.showHideOptionsPane(!1),this.documentHelper.updateFocus()),this.showComments&&this.commentReviewPane.showHidePane(!0,"Comments"),this.commentReviewPane.enableDisableItems(),this.trackChangesPane.enableDisableButton(!this.isReadOnly&&!this.documentHelper.isDocumentProtected),this.showHideRulers();break;case"currentUser":case"userColor":this.selection&&this.documentHelper.isDocumentProtected&&this.selection.highlightEditRegion(),this.viewer.updateScrollBars();break;case"pageGap":case"pageOutline":this.viewer.updateScrollBars();break;case"zIndex":this.documentHelper.dialog&&(this.documentHelper.dialog.zIndex=e.zIndex+10),this.documentHelper.dialog2&&(this.documentHelper.dialog2.zIndex=e.zIndex);break;case"showComments":this.viewer&&e.showComments!==t.showComments&&this.documentHelper.showComments(e.showComments),this.viewer.updateScrollBars();break;case"enableRtl":this.localizeDialogs(e.enableRtl);break;case"enableComment":this.viewer&&this.showComments&&(this.showComments=!!this.showComments&&this.enableComment,this.documentHelper.showComments(e.enableComment)),this.viewer.updateScrollBars();break;case"showRevisions":this.isReadOnly||this.documentHelper.isDocumentProtected?this.documentHelper.showRevisions(!1):this.viewer&&this.documentHelper.showRevisions(e.showRevisions),this.viewer.updateScrollBars();break;case"documentSettings":if(!i.i(n.isNullOrUndefined)(e.documentSettings.compatibilityMode)){var l=t.documentSettings.compatibilityMode,d=e.documentSettings.compatibilityMode;("Word2013"==l&&"Word2013"!=d||"Word2013"!=l&&"Word2013"==d)&&this.documentHelper.compatibilityMode!==d&&(this.documentHelper.compatibilityMode=d,this.editor.layoutWholeDocument(!0))}this.viewer.updateScrollBars();break;case"documentEditorSettings":i.i(n.isNullOrUndefined)(e.documentEditorSettings.enableOptimizedTextMeasuring)||(this.documentHelper.heightInfoCollection={},e.documentEditorSettings.enableOptimizedTextMeasuring?this.textMeasureHelper=this.optimizedModule:this.textMeasureHelper=this.regularModule,this.viewer.updateScrollBars()),(!i.i(n.isNullOrUndefined)(e.documentEditorSettings.showHiddenMarks)&&e.documentEditorSettings.showHiddenMarks!==t.documentEditorSettings.showHiddenMarks||!i.i(n.isNullOrUndefined)(e.documentEditorSettings.showBookmarks)&&e.documentEditorSettings.showBookmarks!==t.documentEditorSettings.showBookmarks)&&this.viewer.updateScrollBars(),i.i(n.isNullOrUndefined)(e.documentEditorSettings.highlightEditableRanges)||this.documentHelper&&this.documentHelper.restrictEditingPane&&(this.documentHelper.restrictEditingPane.highlightCheckBox.checked=e.documentEditorSettings.highlightEditableRanges),i.i(n.isNullOrUndefined)(e.documentEditorSettings.showRuler)||(this.showHideRulers(),e.documentEditorSettings.showRuler&&this.rulerHelper.updateRuler(this,!0));break;case"height":this.element.style.height=i.i(n.formatUnit)(this.height),this.resize();break;case"width":this.element.style.width=i.i(n.formatUnit)(this.width),this.resize();break;case"enableAutoFocus":this.enableAutoFocus=e.enableAutoFocus}}},t.prototype.localizeDialogs=function(e){if(""!==this.locale){var t=new n.L10n("documenteditor",this.defaultLocale);t.setLocale(this.locale),i.i(n.isNullOrUndefined)(e)||(this.documentHelper.dialog.enableRtl=e,this.documentHelper.dialog2.enableRtl=e),this.optionsPaneModule&&this.optionsPaneModule.initOptionsPane(t,e),this.paragraphDialogModule&&this.paragraphDialogModule.initParagraphDialog(t),this.footNotesDialogModule&&this.footNotesDialogModule.notesDialog(t,e),this.pageSetupDialogModule&&this.pageSetupDialogModule.initPageSetupDialog(t,e),this.columnsDialogModule&&this.columnsDialogModule.initColumnsDialog(t,e),this.fontDialogModule&&this.fontDialogModule.initFontDialog(t,e),this.hyperlinkDialogModule&&this.hyperlinkDialogModule.initHyperlinkDialog(t,e),this.contextMenuModule&&(this.contextMenuModule.contextMenuInstance.destroy(),this.contextMenuModule.initContextMenu(t,e)),this.listDialogModule&&this.listDialogModule.initListDialog(t,e),this.tablePropertiesDialogModule&&this.tablePropertiesDialogModule.initTablePropertyDialog(t,e),this.bordersAndShadingDialogModule&&this.bordersAndShadingDialogModule.initBordersAndShadingsDialog(t,e),this.cellOptionsDialogModule&&this.cellOptionsDialogModule.initCellMarginsDialog(t,e),this.tableOptionsDialogModule&&this.tableOptionsDialogModule.initTableOptionsDialog(t,e),this.tableDialogModule&&this.tableDialogModule.initTableDialog(t),this.styleDialogModule&&this.styleDialogModule.initStyleDialog(t,e),this.tabDialogModule&&this.tabDialogModule.initTabsDialog(t,e),this.tableOfContentsDialogModule&&this.tableOfContentsDialogModule.initTableOfContentDialog(t,e),this.commentReviewPane&&this.commentReviewPane.parentPaneElement&&(this.enableRtl?i.i(n.classList)(this.commentReviewPane.parentPaneElement,["e-rtl"],[]):i.i(n.classList)(this.commentReviewPane.parentPaneElement,[],["e-rtl"]))}},t.prototype.setDefaultCharacterFormat=function(e){this.characterFormat=JSON.parse(o._417.sanitizeString(JSON.stringify(e))),this.documentHelper.setDefaultDocumentFormat(),i.i(n.isNullOrUndefined)(this.selection)||this.selection.retrieveCurrentFormatProperties()},t.prototype.setDefaultParagraphFormat=function(e){this.paragraphFormat=JSON.parse(o._417.sanitizeString(JSON.stringify(e))),this.documentHelper.setDefaultDocumentFormat(),i.i(n.isNullOrUndefined)(this.selection)||this.selection.retrieveCurrentFormatProperties()},t.prototype.setDefaultSectionFormat=function(e){this.sectionFormat=JSON.parse(o._417.sanitizeString(JSON.stringify(e))),this.documentHelper.setDefaultDocumentFormat(),i.i(n.isNullOrUndefined)(this.selection)||this.selection.retrieveCurrentFormatProperties()},t.prototype.getPersistData=function(){return"documenteditor"},t.prototype.clearPreservedCollectionsInViewer=function(){this.viewer instanceof o._487&&this.documentHelper.clearDocumentItems()},t.prototype.getDocumentEditorElement=function(){return this.element},t.prototype.fireContentChange=function(){if(!this.enableEditor||!this.editor.isIncrementalSave){this.enableLockAndEdit&&this.collaborativeEditingModule&&this.collaborativeEditingModule.saveContent();var e={source:this};if(this.enableCollaborativeEditing)if(e.operations=[],this.isSettingOp)e.operations=this.documentSettingOps,this.documentSettingOps=[],this.isSettingOp=!1;else if(!i.i(n.isNullOrUndefined)(this.editorHistory)){if(i.i(n.isNullOrUndefined)(this.editorHistory.currentHistoryInfo)||"ApplyStyle"==this.editorHistory.currentHistoryInfo.action||"TableMarginsSelection"==this.editorHistory.currentHistoryInfo.action||"CellMarginsSelection"==this.editorHistory.currentHistoryInfo.action){if(!i.i(n.isNullOrUndefined)(this.editorHistory.lastOperation)){var t=this.editorHistory.lastOperation;"IMEInput"===t.action?e.operations=t.getActionInfo(!0):e.operations=t.getActionInfo()}}else"IMEInput"===this.editorHistory.currentHistoryInfo.action&&(e.operations=this.editorHistory.currentHistoryInfo.getActionInfo());if(this.enableTrackChanges&&e.operations.length>0)for(var r=0;r<e.operations.length;r++)i.i(n.isNullOrUndefined)(e.operations[r].markerData)&&(e.operations[r].markerData={}),e.operations[r].markerData.author=this.currentUser}this.trigger(g.p,e)}},t.prototype.fireDocumentChange=function(){this.enableLockAndEdit&&this.enableEditor&&this.editor.enforceProtection("",!1,!0);var e={source:this};this.trigger(g.q,e)},t.prototype.fireSelectionChange=function(){if(!this.enableEditor||!this.editor.isIncrementalSave){!this.documentHelper.isCompositionStart&&n.Browser.isDevice&&this.editorModule&&this.editorModule.predictText();var e={source:this,isCompleted:this.documentHelper.isCompleted};this.trigger(g.r,e),this.documentHelper.isSelectionCompleted=this.documentHelper.isCompleted,this.documentHelper.isCompleted=!0}},t.prototype.fireZoomFactorChange=function(){var e={source:this};this.trigger(g.u,e),this.notify(g.a,e)},t.prototype.fireBeformFieldFill=function(){var e={};this.trigger(g.v,e)},t.prototype.fireAfterFormFieldFill=function(){var e={};this.trigger(g.w,e)},t.prototype.fireServiceFailure=function(e){this.trigger(g.o,e)},t.prototype.fireViewChange=function(){if(this.viewer&&this.documentHelper.pages.length>0&&this.viewer.visiblePages.length>0){var e=this.viewer.visiblePages,t={startPage:e[0].index+1,endPage:e[e.length-1].index+1,source:this};this.trigger(g.x,t),this.notify(g.b,t)}},t.prototype.fireCustomContextMenuSelect=function(e){var t={id:e};this.trigger(g.s,t)},t.prototype.fireCustomContextMenuBeforeOpen=function(e){var t={ids:e};this.trigger(g.t,t)},t.prototype.showParagraphDialog=function(e){this.paragraphDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.paragraphDialogModule.show(e)},t.prototype.showPageSetupDialog=function(){this.pageSetupDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.pageSetupDialogModule.show()},t.prototype.showColumnsDialog=function(){this.columnsDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.columnsDialogModule.show()},t.prototype.showFootNotesDialog=function(){this.footNotesDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.footNotesDialogModule.show()},t.prototype.showFontDialog=function(e){this.fontDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.fontDialogModule.showFontDialog(e)},t.prototype.showCellOptionsDialog=function(){this.cellOptionsDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.cellOptionsDialogModule.show()},t.prototype.showTableOptionsDialog=function(){this.tableOptionsDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.tableOptionsDialogModule.show()},t.prototype.showTableDialog=function(){this.tableDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.tableDialogModule.show()},t.prototype.showTableOfContentsDialog=function(){this.tableOfContentsDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.tableOfContentsDialogModule.show()},t.prototype.showStyleDialog=function(){this.styleDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.styleDialogModule.show()},t.prototype.showHyperlinkDialog=function(){this.hyperlinkDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.hyperlinkDialogModule.show()},t.prototype.showBookmarkDialog=function(){this.bookmarkDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.bookmarkDialogModule.show()},t.prototype.showStylesDialog=function(){this.stylesDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.stylesDialogModule.show()},t.prototype.showListDialog=function(){this.listDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.listDialogModule.showListDialog()},t.prototype.showTablePropertiesDialog=function(){this.tablePropertiesDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.tablePropertiesDialogModule.show()},t.prototype.showBordersAndShadingDialog=function(){this.bordersAndShadingDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.bordersAndShadingDialogModule.show()},t.prototype.requiredModules=function(){var e=[];return this.enableCollaborativeEditing&&e.push({member:"CollaborativeEditingHandler",args:[this]}),this.enableLockAndEdit&&e.push({member:"CollaborativeEditing",args:[this]}),this.enablePrint&&e.push({member:"Print",args:[]}),(this.enableSfdtExport||this.enableWordExport||this.enableTextExport||this.enableSelection||this.enableEditor)&&e.push({member:"SfdtExport",args:[this.documentHelper]}),this.enableWordExport&&e.push({member:"WordExport",args:[]}),this.enableTextExport&&e.push({member:"TextExport",args:[]}),(this.enableSelection||this.enableSearch||this.enableEditor)&&(e.push({member:"Selection",args:[this]}),this.enableContextMenu&&e.push({member:"ContextMenu",args:[this.documentHelper]})),this.enableSearch&&(e.push({member:"Search",args:[this]}),this.enableOptionsPane&&e.push({member:"OptionsPane",args:[this.documentHelper]})),this.documentEditorSettings&&this.documentEditorSettings.enableOptimizedTextMeasuring?(I.Inject(o._480),e.push({member:"Optimized",args:[this.documentHelper]})):(I.Inject(o._481),e.push({member:"Regular",args:[this.documentHelper]})),this.enableEditor&&(e.push({member:"Editor",args:[this.documentHelper]}),this.enableImageResizer&&e.push({member:"ImageResizer",args:[this,this.documentHelper]}),this.enableEditorHistory&&e.push({member:"EditorHistory",args:[this]}),this.enableHyperlinkDialog&&e.push({member:"HyperlinkDialog",args:[this.documentHelper]}),this.enableTableDialog&&e.push({member:"TableDialog",args:[this.documentHelper]}),this.enableBookmarkDialog&&e.push({member:"BookmarkDialog",args:[this.documentHelper]}),this.enableTableOfContentsDialog&&e.push({member:"TableOfContentsDialog",args:[this.documentHelper]}),this.enablePageSetupDialog&&e.push({member:"PageSetupDialog",args:[this.documentHelper]}),this.enableColumnsDialog&&e.push({member:"ColumnsDialog",args:[this.documentHelper]}),this.enableFootnoteAndEndnoteDialog&&e.push({member:"FootNotesDialog",args:[this.documentHelper]}),this.enableStyleDialog&&(e.push({member:"StylesDialog",args:[this.documentHelper]}),e.push({member:"StyleDialog",args:[this.documentHelper]}),e.push({member:"BulletsAndNumberingDialog",args:[this.documentHelper]})),this.enableListDialog&&e.push({member:"ListDialog",args:[this.documentHelper]}),this.enableParagraphDialog&&(e.push({member:"ParagraphDialog",args:[this.documentHelper]}),e.push({member:"TabDialog",args:[this.documentHelper]})),this.enableFontDialog&&e.push({member:"FontDialog",args:[this.documentHelper]}),this.enableTablePropertiesDialog&&(e.push({member:"TablePropertiesDialog",args:[this.documentHelper]}),e.push({member:"CellOptionsDialog",args:[this.documentHelper]})),this.enableBordersAndShadingDialog&&e.push({member:"BordersAndShadingDialog",args:[this.documentHelper]}),this.enableTableOptionsDialog&&e.push({member:"TableOptionsDialog",args:[this.documentHelper]}),this.enableSpellCheck&&(e.push({member:"SpellChecker",args:[this.documentHelper]}),e.push({member:"SpellCheckDialog",args:[this.documentHelper]})),this.enableFormField&&(e.push({member:"TextFormFieldDialog",args:[this]}),e.push({member:"DropDownFormFieldDialog",args:[this]}),e.push({member:"CheckBoxFormFieldDialog",args:[this]}))),e},t.prototype.open=function(e){if(!i.i(n.isNullOrUndefined)(this.viewer)){if(this.clearPreservedCollectionsInViewer(),this.documentHelper.userCollection.push("Everyone"),this.documentHelper.lists=[],this.documentHelper.abstractLists=[],this.documentHelper.styles=new o._438,this.documentHelper.cachedPages=[],this.clearSpellCheck(),this.isSpellCheck&&this.isSpellCheck&&!this.spellChecker.enableOptimizedSpellCheck&&(this.documentHelper.triggerElementsOnLoading=!0,this.documentHelper.triggerSpellCheck=!0),!i.i(n.isNullOrUndefined)(e)&&this.viewer){var t={};this.documentHelper.setDefaultDocumentFormat(),this.documentHelper.onDocumentChanged(this.parser.convertJsonToDocument(e,t),t),this.editorModule&&this.editorModule.intializeDefaultStyles()}this.isSpellCheck&&this.isSpellCheck&&!this.spellChecker.enableOptimizedSpellCheck&&(this.documentHelper.triggerElementsOnLoading=!1,this.documentHelper.triggerSpellCheck=!1)}},t.prototype.scrollToPage=function(e){return!(i.i(n.isNullOrUndefined)(this.viewer)||e<1||e>this.documentHelper.pages.length)&&(this.viewer.scrollToPage(e-1),!0)},t.prototype.enableAllModules=function(){this.enablePrint=this.enableSfdtExport=this.enableWordExport=this.enableTextExport=this.enableSelection=this.enableContextMenu=this.enableSearch=this.enableOptionsPane=this.enableEditor=this.enableImageResizer=this.enableEditorHistory=this.enableHyperlinkDialog=this.enableTableDialog=this.enableBookmarkDialog=this.enableTableOfContentsDialog=this.enableFootnoteAndEndnoteDialog=this.enablePageSetupDialog=this.enableStyleDialog=this.enableListDialog=this.enableParagraphDialog=this.enableFontDialog=this.enableTablePropertiesDialog=this.enableBordersAndShadingDialog=this.enableTableOptionsDialog=this.enableSpellCheck=this.enableComment=this.enableFormField=this.enableColumnsDialog=!0,I.Inject(o._385,o._567,o._565,o._566,o._463,o._457,o._412,o._413,o._422,o._386,o._458,o._390,o._391,p.a,o._392,o._393,o._394,o._397,o._396,o._395,v.a,o._398,o._399,o._400,o._401,o._402,o._403,o._404,s.a,a.a,l.a,d.a,h.a,f.a)},t.prototype.resize=function(e,t){this.element&&(!i.i(n.isNullOrUndefined)(e)&&e>200&&(this.element.style.width=e+"px"),!i.i(n.isNullOrUndefined)(t)&&t>200&&(this.element.style.height=t+"px"),this.viewer&&this.documentHelper.updateViewerSize(),this.trackChangesPane.toolbar&&this.trackChangesPane.toolbar.refreshOverflow()),this.rulerHelper&&this.documentEditorSettings&&this.documentEditorSettings.showRuler&&this.rulerHelper.updateRuler(this,!1)},t.prototype.getFormFieldNames=function(){for(var e=[],t=this.documentHelper.formFields,i=0;i<t.length;i++)""!==t[parseInt(i.toString(),10)].formFieldData.name&&e.push(t[parseInt(i.toString(),10)].formFieldData.name);return e},t.prototype.getFormFieldInfo=function(e){e=o._417.sanitizeString(e);for(var t=this.documentHelper.formFields,i=0;i<t.length;i++)if(t[parseInt(i.toString(),10)].formFieldData.name===e&&""!==t[parseInt(i.toString(),10)].formFieldData.name)return t[parseInt(i.toString(),10)].formFieldData.getFormFieldInfo()},t.prototype.setFormFieldInfo=function(e,t){e=o._417.sanitizeString(e);for(var i=this.documentHelper.formFields,n=0;n<i.length;n++)if(i[parseInt(n.toString(),10)].formFieldData.name===e&&""!==i[parseInt(n.toString(),10)].formFieldData.name){var r=i[parseInt(n.toString(),10)];return void(this.selection&&(this.selection.selectFieldInternal(r),this.editor&&this.editor.setFormField(r,t)))}},t.prototype.resetFormFields=function(e){i.i(n.isNullOrUndefined)(e)||(e=o._417.sanitizeString(e));for(var t=this.documentHelper.formFields,r=0;r<t.length;r++)(i.i(n.isNullOrUndefined)(e)||e===t[parseInt(r.toString(),10)].formFieldData.name)&&(t[parseInt(r.toString(),10)].formFieldData instanceof l.b?this.editor.updateFormField(t[parseInt(r.toString(),10)],t[parseInt(r.toString(),10)].formFieldData.defaultValue,!0):t[parseInt(r.toString(),10)].formFieldData instanceof l.c?this.editor.toggleCheckBoxFormField(t[parseInt(r.toString(),10)],!0,t[parseInt(r.toString(),10)].formFieldData.defaultValue):t[parseInt(r.toString(),10)].formFieldData instanceof l.d&&this.editor.updateFormField(t[parseInt(r.toString(),10)],0,!0))},t.prototype.importFormData=function(e){for(var t=this.documentHelper.formFields,i=0;i<e.length;i++)for(var n=e[parseInt(i.toString(),10)],r=n.fieldName,o=0;o<t.length;o++)t[parseInt(o.toString(),10)].formFieldData.name===r&&(t[parseInt(o.toString(),10)].formFieldData instanceof l.c?this.editor.toggleCheckBoxFormField(t[parseInt(o.toString(),10)],!0,n.value):t[parseInt(o.toString(),10)].formFieldData instanceof l.b?this.editor.updateFormField(t[parseInt(o.toString(),10)],n.value):t[parseInt(o.toString(),10)].formFieldData instanceof l.d&&this.editor.updateFormField(t[parseInt(o.toString(),10)],n.value))},t.prototype.exportFormData=function(){for(var e=[],t=this.documentHelper.formFields,i=0;i<t.length;i++)if(""!==t[parseInt(i.toString(),10)].formFieldData.name){var n={fieldName:"",value:""};if(n.fieldName=t[parseInt(i.toString(),10)].formFieldData.name,t[parseInt(i.toString(),10)].formFieldData instanceof l.c)n.value=t[parseInt(i.toString(),10)].formFieldData.checked;else if(t[parseInt(i.toString(),10)].formFieldData instanceof l.b){var r="";r=this.documentHelper.isInlineFormFillProtectedMode?this.editorModule.getFieldResultText(t[parseInt(i.toString(),10)]):t[parseInt(i.toString(),10)].resultText;var o=RegExp(this.documentHelper.textHelper.getEnSpaceCharacter(),"gi");""===r.replace(o,"")&&(r=""),n.value=r}else t[parseInt(i.toString(),10)].formFieldData instanceof l.d&&(n.value=t[parseInt(i.toString(),10)].formFieldData.selectedIndex);e.push(n)}return e},t.prototype.updateFields=function(){for(var e=0;e<this.documentHelper.fields.length;e++){var t=this.documentHelper.fields[parseInt(e.toString(),10)];if(0===this.selection.getFieldCode(t).toLowerCase().trim().indexOf("ref ")){var r=t.line.paragraph;i.i(n.isNullOrUndefined)(r)||i.i(n.isNullOrUndefined)(this.selection)||i.i(n.isNullOrUndefined)(this.selection.getPage(r))||this.selection.updateRefField(t)}}},t.prototype.focusIn=function(){this.viewer&&this.documentHelper.updateFocus()},t.prototype.fitPage=function(e){i.i(n.isNullOrUndefined)(e)&&(e="None"),this.viewer&&(this.viewer.pageFitType=e)},t.prototype.exportAsImage=function(e,t){if(i.i(n.isNullOrUndefined)(this.viewer))throw new Error("Invalid operation.");if(this.printModule){var r="Png"===t?"image/png":"image/jpeg";return this.printModule.exportAsImage(this.documentHelper,e,r)}},t.prototype.exportAsPath=function(e){if(!i.i(n.isNullOrUndefined)(e)&&e<=this.documentHelper.pages.length&&e>=1){var t=this.documentHelper.pages[e-1];this.documentHelper.render.isExporting=!0,this.documentHelper.render.renderWidgets(t,0,0,0,0);var r=this.documentHelper.render.pageCanvas.toDataURL();return this.documentHelper.render.pageCanvas.getContext("2d").renderedPath="",this.documentHelper.render.isExporting=!1,r}},t.prototype.print=function(e){if(i.i(n.isNullOrUndefined)(this.viewer))throw new Error("Invalid operation.");if(!this.printModule)throw new Error("Invalid operation. Print is not enabled.");"Continuous"===this.layoutType?(this.documentHelper.isWebPrinting=!0,this.viewer=new o._488(this),this.editor.layoutWholeDocument(),this.printModule.print(this.documentHelper,e),this.viewer=new o._489(this),this.editor.layoutWholeDocument(),this.documentHelper.isWebPrinting=!1):this.printModule.print(this.documentHelper,e)},t.prototype.serialize=function(){if(!(this.enableSfdtExport&&this.sfdtExportModule instanceof o._567))throw new Error("Invalid operation. Sfdt export is not enabled.");return this.sfdtExportModule.serialize()},t.prototype.save=function(e,t){var s=this;if(i.i(n.isNullOrUndefined)(e)||(e=o._417.sanitizeString(e)),e=e||"Untitled",i.i(n.isNullOrUndefined)(this.documentHelper))throw new Error("Invalid operation.");if("Docx"===t||"Dotx"===t&&this.wordExportModule)this.wordExportModule&&(this.documentHelper.owner.sfdtExportModule.isWordExport=!0,this.wordExportModule.save(this.documentHelper,e,t),this.documentHelper.owner.sfdtExportModule.isWordExport=!1);else if("Txt"===t&&this.textExportModule)this.textExportModule.save(this.documentHelper,e);else{if("Sfdt"!==t||!this.enableSfdtExport||!this.sfdtExportModule)throw new Error("Invalid operation. Specified export is not enabled.");if(this.documentEditorSettings.optimizeSfdt){var a=this.serialize(),l=new Blob([a],{type:"application/json"}),d=new m.ZipArchiveItem(l,"sfdt"),h=new m.ZipArchive;h.addItem(d),h.saveAsBlob().then(function(t){s.zipArchiveBlobToSfdtFile(t,e)})}else{var a=this.serialize(),l=new Blob([a],{type:"application/json"});r.Save.save(e+".sfdt",l)}}},t.prototype.zipArchiveBlobToSfdtFile=function(e,t){var i=new FileReader;i.readAsDataURL(e),i.onload=function(){var e=i.result,n=e.split(",")[1],o={};o.sfdt=n;var s=new Blob([JSON.stringify(o)],{type:"application/json"});r.Save.save(t+".sfdt",s)}},t.prototype.saveAsBlob=function(e){var t=this;if(i.i(n.isNullOrUndefined)(this.viewer))throw new Error("Invalid operation");return new Promise(function(i){"Docx"!==e&&"Dotx"!==e||!t.wordExportModule?"Txt"===e&&t.textExportModule?i(t.textExportModule.saveAsBlob(t.documentHelper)):"Sfdt"===e&&t.enableSfdtExport&&t.sfdtExportModule&&(t.documentEditorSettings.optimizeSfdt?t.sfdtExportModule.saveAsBlob(t.documentHelper).then(function(e){t.getBase64StringFromBlob(e).then(function(e){var t={};t.sfdt=e;var n=new Blob([JSON.stringify(t)],{type:"application/json"});i(n)})}):i(t.sfdtExportModule.saveAsBlobNonOptimized(t.documentHelper))):i(t.wordExportModule.saveAsBlob(t.documentHelper,e))})},t.prototype.getBase64StringFromBlob=function(e){return new Promise(function(t,i){var n=new FileReader;n.readAsDataURL(e),n.onload=function(){var e=n.result,i=e.split(",")[1];t(i)}})},t.prototype.openBlank=function(){var e=[];e.push(this.createNewBodyWidget());var t=this.parser.parseHeaderFooter({header:{},footer:{},evenHeader:{},evenFooter:{},firstPageHeader:{},firstPageFooter:{}},void 0);if(this.viewer){if(this.clearPreservedCollectionsInViewer(),this.documentHelper.userCollection.push("Everyone"),this.documentHelper.cachedPages=[],this.clearSpellCheck(),this.documentHelper.setDefaultDocumentFormat(),this.documentHelper.headersFooters.push(t),this.editorModule){this.editorModule.intializeDefaultStyles();for(var i=this.documentHelper.styles.findByName("Normal"),n=0;n<e.length;n++){var r=e[parseInt(n.toString(),10)].childWidgets[0];r.paragraphFormat.baseStyle=i,r.paragraphFormat.listFormat.baseStyle=i}}this.documentHelper.onDocumentChanged(e,{})}},t.prototype.getStyleNames=function(e){return this.viewer?this.documentHelper.styles.getStyleNames(e):[]},t.prototype.getStyles=function(e){return this.viewer?this.documentHelper.styles.getStyles(e):[]},t.prototype.getBookmarks=function(){var e=[];return this.viewer&&(e=this.documentHelper.getBookmarks(!0)),e},t.prototype.showDialog=function(e){switch(e){case"Hyperlink":this.showHyperlinkDialog();break;case"Table":this.showTableDialog();break;case"Bookmark":this.showBookmarkDialog();break;case"TableOfContents":this.showTableOfContentsDialog();break;case"PageSetup":this.showPageSetupDialog();break;case"Columns":this.showColumnsDialog();break;case"List":this.showListDialog();break;case"Styles":this.showStylesDialog();break;case"Style":this.showStyleDialog();break;case"Paragraph":this.showParagraphDialog();break;case"Font":this.showFontDialog();break;case"TableProperties":this.showTablePropertiesDialog();break;case"BordersAndShading":this.showBordersAndShadingDialog();break;case"TableOptions":this.showTableOptionsDialog();break;case"SpellCheck":this.showSpellCheckDialog()}},t.prototype.toggleShowHiddenMarksInternal=function(){this.documentEditorSettings.showHiddenMarks=!this.documentEditorSettings.showHiddenMarks,this.notify(g.d,this.documentEditorSettings)},t.prototype.showOptionsPane=function(){i.i(n.isNullOrUndefined)(this.optionsPaneModule)||i.i(n.isNullOrUndefined)(this.viewer)||this.optionsPaneModule.showHideOptionsPane(!0)},t.prototype.showRestrictEditingPane=function(e){e=!!i.i(n.isNullOrUndefined)(e)||e,this.documentHelper&&this.documentHelper.restrictEditingPane&&this.documentHelper.restrictEditingPane.showHideRestrictPane(e)},t.prototype.showSpellCheckDialog=function(){if(this.spellCheckDialogModule&&this.spellChecker){var e=this.spellChecker.retriveText();i.i(n.isNullOrUndefined)(e)||this.spellCheckDialogModule.show(e.text,e.element)}},t.prototype.showTabDialog=function(){this.tabDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.tabDialogModule.show()},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.destroyDependentModules(),i.i(n.isNullOrUndefined)(this.documentHelper)||this.documentHelper.destroy(),this.viewer&&this.viewer.componentDestroy(),this.viewer=void 0,i.i(n.isNullOrUndefined)(this.element)||(this.element.classList.remove("e-documenteditor"),this.element.innerHTML=""),this.refreshing||(this.element=void 0),this.parser&&(this.parser.destroy(),this.parser=void 0),this.revisionsInternal&&(this.revisionsInternal.destroy(),this.revisionsInternal=void 0),this.findResultsList=[],this.findResultsList=void 0,this.documentHelper=void 0},t.prototype.updateStyle=function(e,t){if(!i.i(n.isNullOrUndefined)(this.styleDialogModule)){var r="Paragraph"==t.type?i.i(n.isNullOrUndefined)(t.link)?"Paragraph":"Linked Style":"Character";if(e.type=this.styleDialogModule.getTypeValue(r),e.basedOn=t.basedOn,"Paragraph"===r||"Linked Style"===r){e.next=t.next,e.characterFormat.copyFormat(t.characterFormat);var o=e.paragraphFormat.listFormat.listId;if(e.paragraphFormat.copyFormat(t.paragraphFormat),e.link=t.link,!i.i(n.isNullOrUndefined)(o)&&o>-1){var s=this.documentHelper.getListById(o);i.i(n.isNullOrUndefined)(s)||this.documentHelper.lists.splice(this.documentHelper.lists.indexOf(s),1)}}else"Character"===r&&e.characterFormat.copyFormat(t.characterFormat);e.name=t.name}},t.prototype.createNewBodyWidget=function(){var e=new o._496;e.index=0,e.sectionFormat=new o._433(e),this.sectionFormat&&this.parser.parseSectionFormat(0,this.sectionFormat,e.sectionFormat);var t=new o._500;return t.index=0,t.paragraphFormat=new o._442(t),t.characterFormat=new o._439(t),e.childWidgets.push(t),t.containerWidget=e,e},t.prototype.clearSpellCheck=function(){i.i(n.isNullOrUndefined)(this.spellChecker)||(i.i(n.isNullOrUndefined)(this.spellChecker.errorWordCollection)||this.spellChecker.errorWordCollection.clear(),i.i(n.isNullOrUndefined)(this.spellChecker.uniqueWordsCollection)||this.spellChecker.uniqueWordsCollection.clear())},t.prototype.getStyleData=function(e,t){if(this.enableCollaborativeEditing){this.isSettingOp=!0;var r;if(!i.i(n.isNullOrUndefined)(e)&&!i.i(n.isNullOrUndefined)(this.documentHelper.owner.sfdtExportModule)){var s=this.documentHelper.styles.findByName(e);if(!i.i(n.isNullOrUndefined)(s)){var a=this.documentHelper.owner.sfdtExportModule.keywordIndex;this.documentHelper.owner.sfdtExportModule.keywordIndex=1;var l=this.documentHelper.owner.sfdtExportModule.writeStyle(s),d={optimizeSfdt:!0,sty:[l]};if(this.editor.isLinkedStyle(s.name)){var h=this.documentHelper.styles.findByName(s.name+" Char"),c=this.documentHelper.owner.sfdtExportModule.writeStyle(h);d.sty.push(c)}if(!i.i(n.isNullOrUndefined)(t)&&t>-1){var p=this.documentHelper.getListById(t);d[o._6[1]]=[],d[o._6[1]].push(this.sfdtExportModule.writeList(p)),d[o._7[1]]=[],d[o._7[1]].push(this.sfdtExportModule.writeAbstractList(p.abstractList))}this.documentHelper.owner.sfdtExportModule.keywordIndex=a,i.i(n.isNullOrUndefined)(s)||(r={action:"Update",styleData:JSON.stringify(d)},this.documentSettingOps.push(r))}}this.fireContentChange()}},t.prototype.getSettingData=function(e,t,i,n,r){if(this.enableCollaborativeEditing){this.isSettingOp=!0;var o,s;"protection"===e?(o={saltValue:n,hashValue:i,protectionType:r},s={text:e,protectionData:o}):s={text:e,enableTrackChanges:t},this.skipSettingsOps||(this.documentSettingOps.push(s),this.fireContentChange()),this.skipSettingsOps=!1,this.isSettingOp=!1}},t.prototype.destroyDependentModules=function(){this.printModule&&(this.printModule.destroy(),this.printModule=void 0),this.sfdtExportModule&&(this.sfdtExportModule.destroy(),this.sfdtExportModule=void 0),this.optionsPaneModule&&(this.optionsPaneModule.destroy(),this.optionsPaneModule=void 0),this.commentReviewPane&&(this.commentReviewPane.destroy(),this.commentReviewPane=void 0),this.trackChangesPane&&(this.trackChangesPane.destroy(),this.trackChangesPane=void 0),i.i(n.isNullOrUndefined)(this.hyperlinkDialogModule)||(this.hyperlinkDialogModule.destroy(),this.hyperlinkDialogModule=void 0),this.searchModule&&(this.searchModule.destroy(),this.searchModule=void 0),this.contextMenuModule&&(this.contextMenuModule.componentDestroy(),this.contextMenuModule=void 0),this.editorModule&&(this.editorModule.destroy(),this.editorModule=void 0),this.selectionModule&&(this.selectionModule.destroy(),this.selectionModule=void 0),this.editorHistoryModule&&(this.editorHistoryModule.destroy(),this.editorHistoryModule=void 0),i.i(n.isNullOrUndefined)(this.paragraphDialogModule)||(this.paragraphDialogModule.destroy(),this.paragraphDialogModule=void 0),this.tabDialogModule&&(this.tabDialogModule.destroy(),this.tabDialogModule=void 0),this.pageSetupDialogModule&&(this.pageSetupDialogModule.destroy(),this.pageSetupDialogModule=void 0),this.columnsDialogModule&&(this.columnsDialogModule.destroy(),this.columnsDialogModule=void 0),this.footNotesDialogModule&&(this.footNotesDialogModule.destroy(),this.footNotesDialogModule=void 0),this.fontDialogModule&&(this.fontDialogModule.destroy(),this.fontDialogModule=void 0),this.listDialogModule&&(this.listDialogModule.destroy(),this.listDialogModule=void 0),this.imageResizerModule&&(this.imageResizerModule.destroy(),this.imageResizerModule=void 0),this.tablePropertiesDialogModule&&(this.tablePropertiesDialogModule.destroy(),this.tablePropertiesDialogModule=void 0),this.bordersAndShadingDialogModule&&(this.bordersAndShadingDialogModule.destroy(),this.bordersAndShadingDialogModule=void 0),this.cellOptionsDialogModule&&(this.cellOptionsDialogModule.destroy(),this.cellOptionsDialogModule=void 0),this.tableOptionsDialogModule&&(this.tableOptionsDialogModule.destroy(),this.tableOptionsDialogModule=void 0),this.tableDialogModule&&(this.tableDialogModule.destroy(),this.tableDialogModule=void 0),this.bookmarkDialogModule&&(this.bookmarkDialogModule.destroy(),this.bookmarkDialogModule=void 0),this.styleDialogModule&&(this.styleDialogModule.destroy(),this.styleDialogModule=void 0),this.textExportModule&&(this.textExportModule.destroy(),this.textExportModule=void 0),this.wordExportModule&&(this.wordExportModule.destroy(),this.wordExportModule=void 0),this.tableOfContentsDialogModule&&(this.tableOfContentsDialogModule.destroy(),this.tableOfContentsDialogModule=void 0),this.spellCheckerModule&&(this.spellCheckerModule.destroy(),this.spellCheckerModule=void 0),this.checkBoxFormFieldDialogModule&&(this.checkBoxFormFieldDialogModule.destroy(),this.checkBoxFormFieldDialogModule=void 0),this.dropDownFormFieldDialogModule&&(this.dropDownFormFieldDialogModule.destroy(),this.dropDownFormFieldDialogModule=void 0),this.textFormFieldDialogModule&&(this.textFormFieldDialogModule.destroy(),this.textFormFieldDialogModule=void 0),this.spellCheckDialogModule&&(this.spellCheckDialogModule.destroy(),this.spellCheckDialogModule=void 0),this.stylesDialogModule&&(this.stylesDialogModule.destroy(),this.stylesDialogModule=void 0),this.optimizedModule&&(this.optimizedModule.destroy(),this.optimizedModule=void 0),this.regularModule&&(this.regularModule.destroy(),this.regularModule=void 0)};var I;return b([i.i(n.Property)(!1)],t.prototype,"enableCollaborativeEditing",void 0),b([i.i(n.Property)("KeepSourceFormatting")],t.prototype,"defaultPasteOption",void 0),b([i.i(n.Property)("Pages")],t.prototype,"layoutType",void 0),b([i.i(n.Property)("")],t.prototype,"currentUser",void 0),b([i.i(n.Property)("#FFFF00")],t.prototype,"userColor",void 0),b([i.i(n.Property)(20)],t.prototype,"pageGap",void 0),b([i.i(n.Property)("")],t.prototype,"documentName",void 0),b([i.i(n.Property)("100%")],t.prototype,"width",void 0),b([i.i(n.Property)("200px")],t.prototype,"height",void 0),b([i.i(n.Property)("")],t.prototype,"serviceUrl",void 0),b([i.i(n.Property)(1)],t.prototype,"zoomFactor",void 0),b([i.i(n.Property)(2e3)],t.prototype,"zIndex",void 0),b([i.i(n.Property)(!0)],t.prototype,"isReadOnly",void 0),b([i.i(n.Property)(!1)],t.prototype,"enablePrint",void 0),b([i.i(n.Property)(!1)],t.prototype,"enableSelection",void 0),b([i.i(n.Property)(!1)],t.prototype,"enableEditor",void 0),b([i.i(n.Property)(!1)],t.prototype,"enableEditorHistory",void 0),b([i.i(n.Property)(!1)],t.prototype,"enableSfdtExport",void 0),b([i.i(n.Property)(!1)],t.prototype,"enableWordExport",void 0),b([i.i(n.Property)(!0)],t.prototype,"enableAutoFocus",void 0),b([i.i(n.Property)(!1)],t.prototype,"enableTextExport",void 0),b([i.i(n.Property)(!1)],t.prototype,"enableOptionsPane",void 0),b([i.i(n.Property)(!1)],t.prototype,"enableContextMenu",void 0),b([i.i(n.Property)(!1)],t.prototype,"enableHyperlinkDialog",void 0),b([i.i(n.Property)(!1)],t.prototype,"enableBookmarkDialog",void 0),b([i.i(n.Property)(!1)],t.prototype,"enableTableOfContentsDialog",void 0),b([i.i(n.Property)(!1)],t.prototype,"enableSearch",void 0),b([i.i(n.Property)(!1)],t.prototype,"enableParagraphDialog",void 0),b([i.i(n.Property)(!1)],t.prototype,"enableListDialog",void 0),b([i.i(n.Property)(!1)],t.prototype,"enableTablePropertiesDialog",void 0),b([i.i(n.Property)(!1)],t.prototype,"enableBordersAndShadingDialog",void 0),b([i.i(n.Property)(!1)],t.prototype,"enableFootnoteAndEndnoteDialog",void 0),b([i.i(n.Property)(!1)],t.prototype,"enableColumnsDialog",void 0),b([i.i(n.Property)(!1)],t.prototype,"enablePageSetupDialog",void 0),b([i.i(n.Property)(!1)],t.prototype,"enableStyleDialog",void 0),b([i.i(n.Property)(!1)],t.prototype,"enableFontDialog",void 0),b([i.i(n.Property)(!1)],t.prototype,"enableTableOptionsDialog",void 0),b([i.i(n.Property)(!1)],t.prototype,"enableTableDialog",void 0),b([i.i(n.Property)(!1)],t.prototype,"enableImageResizer",void 0),b([i.i(n.Property)(!1)],t.prototype,"enableSpellCheck",void 0),b([i.i(n.Property)(!1)],t.prototype,"enableComment",void 0),b([i.i(n.Property)(!1)],t.prototype,"enableTrackChanges",void 0),b([i.i(n.Property)(!0)],t.prototype,"enableFormField",void 0),b([i.i(n.Property)(!1)],t.prototype,"acceptTab",void 0),b([i.i(n.Property)(!0)],t.prototype,"useCtrlClickToFollowHyperlink",void 0),b([i.i(n.Property)("#000000")],t.prototype,"pageOutline",void 0),b([i.i(n.Property)(!1)],t.prototype,"enableCursorOnReadOnly",void 0),b([i.i(n.Property)(!1)],t.prototype,"enableLocalPaste",void 0),b([i.i(n.Property)(!1)],t.prototype,"enableLockAndEdit",void 0),b([i.i(n.Complex)({},x)],t.prototype,"documentEditorSettings",void 0),b([i.i(n.Complex)({},C)],t.prototype,"documentSettings",void 0),b([i.i(n.Property)({systemClipboard:"SystemClipboard",spellCheck:"SpellCheck",restrictEditing:"RestrictEditing",canLock:"CanLock",getPendingActions:"GetPendingActions"})],t.prototype,"serverActionSettings",void 0),b([i.i(n.Property)([])],t.prototype,"headers",void 0),b([i.i(n.Property)(!1)],t.prototype,"showComments",void 0),b([i.i(n.Property)(!1)],t.prototype,"showRevisions",void 0),b([i.i(n.Property)(!1)],t.prototype,"autoResizeOnVisibilityChange",void 0),b([i.i(n.Event)()],t.prototype,"documentChange",void 0),b([i.i(n.Event)()],t.prototype,"viewChange",void 0),b([i.i(n.Event)()],t.prototype,"zoomFactorChange",void 0),b([i.i(n.Event)()],t.prototype,"selectionChange",void 0),b([i.i(n.Event)()],t.prototype,"requestNavigate",void 0),b([i.i(n.Event)()],t.prototype,"contentChange",void 0),b([i.i(n.Event)()],t.prototype,"keyDown",void 0),b([i.i(n.Event)()],t.prototype,"searchResultsChange",void 0),b([i.i(n.Event)()],t.prototype,"created",void 0),b([i.i(n.Event)()],t.prototype,"destroyed",void 0),b([i.i(n.Event)()],t.prototype,"customContextMenuSelect",void 0),b([i.i(n.Event)()],t.prototype,"customContextMenuBeforeOpen",void 0),b([i.i(n.Event)()],t.prototype,"beforePaneSwitch",void 0),b([i.i(n.Event)()],t.prototype,"commentBegin",void 0),b([i.i(n.Event)()],t.prototype,"commentEnd",void 0),b([i.i(n.Event)()],t.prototype,"beforeFileOpen",void 0),b([i.i(n.Event)()],t.prototype,"commentDelete",void 0),b([i.i(n.Event)()],t.prototype,"beforeAcceptRejectChanges",void 0),b([i.i(n.Event)()],t.prototype,"beforeCommentAction",void 0),b([i.i(n.Event)()],t.prototype,"trackChange",void 0),b([i.i(n.Event)()],t.prototype,"beforeFormFieldFill",void 0),b([i.i(n.Event)()],t.prototype,"serviceFailure",void 0),b([i.i(n.Event)()],t.prototype,"afterFormFieldFill",void 0),b([i.i(n.Event)()],t.prototype,"actionComplete",void 0),b([i.i(n.Event)()],t.prototype,"contentControl",void 0),b([i.i(n.Event)()],t.prototype,"beforeXmlHttpRequestSend",void 0),t=I=b([n.NotifyPropertyChanges],t)}(n.Component),k=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return w(t,e),b([i.i(n.Property)("SystemClipboard")],t.prototype,"systemClipboard",void 0),b([i.i(n.Property)("SpellCheck")],t.prototype,"spellCheck",void 0),b([i.i(n.Property)("RestrictEditing")],t.prototype,"restrictEditing",void 0),b([i.i(n.Property)("CanLock")],t.prototype,"canLock",void 0),b([i.i(n.Property)("GetPendingActions")],t.prototype,"getPendingActions",void 0),t}(n.ChildProperty),P=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return w(t,e),b([i.i(n.Property)("#cfcfcf")],t.prototype,"shadingColor",void 0),b([i.i(n.Property)(!0)],t.prototype,"applyShading",void 0),b([i.i(n.Property)("#cccccc")],t.prototype,"selectionColor",void 0),b([i.i(n.Property)("Popup")],t.prototype,"formFillingMode",void 0),b([i.i(n.Property)([])],t.prototype,"formattingExceptions",void 0),t}(n.ChildProperty),T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return w(t,e),b([i.i(n.Property)("")],t.prototype,"roomName",void 0),b([i.i(n.Property)("#22b24b")],t.prototype,"editableRegionColor",void 0),b([i.i(n.Property)("#f44336")],t.prototype,"lockedRegionColor",void 0),b([i.i(n.Property)(3e3)],t.prototype,"saveTimeout",void 0),t}(n.ChildProperty),S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return w(t,e),b([i.i(n.Property)("Import")],t.prototype,"import",void 0),t}(k)},function(e,t,i){"use strict";i.d(t,"a",function(){return l});var n=i(0),r=(i.n(n),i(3)),o=(i.n(r),i(5)),s=(i.n(o),i(7)),a=function(){function e(){}return e}(),l=function(){function e(e){var t=this;this.lineCheckbox=void 0,this.equalCheckbox=void 0,this.checkBox=function(e){for(var i=0;i<t.columns.length;i++){var n=t.columns[parseInt(i.toString(),10)];1==t.equalCheckbox.checked?0!=i&&(n.width.enabled=!1,n.space.enabled=!1):(n.width.enabled=!0,n.space.enabled=!0)}},this.createTextBox=function(e){if(1==t.columnValueTexBox.value?(t.oneDiv.classList.add("e-de-table-border-inside-setting-click"),t.twoDiv.classList.remove("e-de-table-border-inside-setting-click"),t.threeDiv.classList.remove("e-de-table-border-inside-setting-click"),t.leftDiv.classList.remove("e-de-table-border-inside-setting-click"),t.rightDiv.classList.remove("e-de-table-border-inside-setting-click")):2==t.columnValueTexBox.value?(t.oneDiv.classList.remove("e-de-table-border-inside-setting-click"),t.twoDiv.classList.add("e-de-table-border-inside-setting-click"),t.threeDiv.classList.remove("e-de-table-border-inside-setting-click"),t.leftDiv.classList.remove("e-de-table-border-inside-setting-click"),t.rightDiv.classList.remove("e-de-table-border-inside-setting-click")):3==t.columnValueTexBox.value&&(t.oneDiv.classList.remove("e-de-table-border-inside-setting-click"),t.twoDiv.classList.remove("e-de-table-border-inside-setting-click"),t.threeDiv.classList.add("e-de-table-border-inside-setting-click"),t.leftDiv.classList.remove("e-de-table-border-inside-setting-click"),t.rightDiv.classList.remove("e-de-table-border-inside-setting-click")),t.numberOfColumns=e.value,e.value>=1){t.equalCheckbox.disabled=!1,t.lineCheckbox.disabled=!1;for(var i=e.previousValue;i<t.numberOfColumns;)t.createColumn(i+1),i++;for(;i>t.numberOfColumns;)t.columnTable.deleteRow(t.columnTable.rows.length-1),t.columns.splice(t.columns.length-1,t.columns.length),1===t.numberOfColumns&&(t.equalCheckbox.disabled=!0,t.columns[0].space.enabled=!1),i--;t.canUpdateColumnWidthAndSpacing(e.value,void 0,void 0,void 0)}},this.widthChange=function(e){if(1==e.isInteracted){var i=e.event.target.parentElement.classList;i.replace(i.item(4),"Width"),e.event.target.parentElement.classList,t.checkAndApplyColumnFormatWidth(e.value)}},this.spaceChange=function(e){if(1==e.isInteracted){var i=e.event.target.parentElement.classList;i.replace(i.item(4),"Space"),e.event.target.parentElement.classList,t.checkAndApplyColumnFormatSpace(e.value)}},this.checkAndApplyColumnFormatWidth=function(e){if(1===t.numberOfColumns)e>t.pageWidth?t.columns[0].width.value=e-1:t.columns[0].width.value=e+1;else{if(1==t.equalCheckbox.checked)for(var i=0;i<t.columns.length;i++){var n=t.columns[parseInt(i.toString(),10)];if(e>=36&&t.columns[0].space.value>=0){var r=(t.pageWidth-t.numberOfColumns*e)/(t.numberOfColumns-1);n.width.value=e,i<t.columns.length-1&&(n.space.value=r)}else t.columns[0].width.value=t.columns[1].width.value}if(0==t.equalCheckbox.checked)for(var i=0;i<t.columns.length;i++){var n=t.columns[parseInt(i.toString(),10)],o=void 0;if(e==t.columns[parseInt(i.toString(),10)].width.value)if((o=i)+1!=t.columns.length)if(e>t.columns[0].width.value||e>t.columns[t.columns.length-1].width.value)for(var s=o+1;s<=t.columns.length;s++){var a=t.columns[parseInt(s.toString(),10)];if(s<t.columns.length&&a.width.value>36&&(a.width.value=a.width.value-1),0==t.columns[0].space.value)for(var l=o-1;l>=0;l--){var d=t.columns[parseInt(l.toString(),10)];d.width.value>36&&(d.width.value=d.width.value-1)}if(s>=t.columns.length&&36==t.columns[0].width.value||36==t.columns[s-1].width.value&&0!=t.columns[0].space.value)for(var h=0;h<t.columns.length-1;h++){var c=t.columns[parseInt(h.toString(),10)];c.space.value>0&&h<t.columns.length-1&&(c.space.value=c.space.value-1)}if(36==t.columns[0].width.value&&0==t.columns[0].space.value||36==t.columns[s-1].width.value&&0==t.columns[0].space.value)for(var h=0;h<t.columns.length;h++){var p=t.columns[parseInt(h.toString(),10)];36!=p.width.value&&e>t.pageWidth-36*(t.numberOfColumns-1)&&(p.width.value=e-1)}}else for(var s=o+1;s<t.columns.length;s++){var u=t.columns[parseInt(s.toString(),10)];u.width.value>36&&(u.width.value=u.width.value+1)}else if(e>t.columns[0].width.value||e>t.columns[t.columns.length-1].width.value)for(var s=o+1;s<=t.columns.length;s++){if(0==t.columns[0].space.value)for(var l=o-1;l>=0;l--){var g=t.columns[parseInt(l.toString(),10)];g.width.value>36&&(g.width.value=g.width.value-1)}if(s<=t.columns.length&&0!=t.columns[0].space.value)for(var h=0;h<t.columns.length-1;h++){var f=t.columns[parseInt(h.toString(),10)];f.space.value>0&&h<t.columns.length-1&&(f.space.value=f.space.value-1)}if(36==t.columns[0].width.value&&0==t.columns[0].space.value)for(var h=0;h<t.columns.length;h++){var m=t.columns[parseInt(h.toString(),10)];36!=m.width.value&&e>t.pageWidth-36*(t.numberOfColumns-1)&&(m.width.value=e-1)}}else for(var s=o+1;s<t.columns.length;s++){var v=t.columns[parseInt(s.toString(),10)];v.width.value>36&&(v.width.value=v.width.value+1)}}}},this.checkAndApplyColumnFormatSpace=function(e){if(1==t.equalCheckbox.checked)for(var i=0;i<t.columns.length;i++){var n=t.columns[parseInt(i.toString(),10)];if(e>=0&&t.columns[0].width.value>=36){var r=(t.pageWidth-e*(t.numberOfColumns-1))/t.numberOfColumns;n.width.value=r,i<t.columns.length-1&&(n.space.value=e)}else t.columns[0].space.value=t.columns[1].space.value}if(0==t.equalCheckbox.checked)for(var i=0;i<t.columns.length;i++){var n=t.columns[parseInt(i.toString(),10)],o=void 0;if(e==t.columns[parseInt(i.toString(),10)].space.value)if((o=i)+1!=t.columns.length)if(t.columns[t.columns.length-1].space.value=0,e>t.columns[0].space.value||e>t.columns[t.columns.length-2].space.value)for(var s=o+1;s<=t.columns.length;s++){var a=t.columns[parseInt(s.toString(),10)];if(s<t.columns.length&&a.width.value>36&&(a.width.value=a.width.value-1),36==t.columns[o+1].width.value&&t.columns[parseInt(o.toString(),10)].width.value>36)for(var l=o;l>=0;l--){var d=t.columns[parseInt(l.toString(),10)];d.width.value>36&&(d.width.value=d.width.value-1)}if(36==t.columns[parseInt(o.toString(),10)].width.value&&(0!=t.columns[0].space.value||0!=t.columns[o+1].space.value))for(var h=0;h<t.columns.length-1;h++){var c=t.columns[parseInt(h.toString(),10)];c.space.value>0&&h<t.columns.length-1&&(c.space.value=c.space.value-1,t.columns[parseInt(o.toString(),10)].space.value=e)}if(36==t.columns[0].width.value&&(0==t.columns[0].space.value||0==t.columns[o+1].space.value))for(var l=0;l<t.columns.length;l++){var p=t.columns[parseInt(l.toString(),10)];0!=p.space.value&&e>t.pageWidth-36*t.numberOfColumns&&(p.space.value=e-1)}}else for(var s=o+1;s<t.columns.length;s++){var u=t.columns[parseInt(s.toString(),10)];u.width.value>36&&(u.width.value=u.width.value+.5)}else t.columns[parseInt(o.toString(),10)].space.value=0}},this.canUpdateColumnWidthAndSpacing=function(e,i,n,r){var o=(t.pageWidth-36*(e-1))/e,s=(t.pageWidth-36*e)/(e-1);if(2===e&&(t.equalCheckbox.checked=!0),1==t.equalCheckbox.checked){if(e>1){var a=t.columns[e-1];a.index.value=e;for(var l=0;l<e;l++){var d=t.columns[parseInt(l.toString(),10)];d.width.value=e<=6?o:36,d.width.value=o,l<e-1&&(d.space.value=e<=6?36:s),d.width.enabled=!1,d.space.enabled=!1}}else t.columns[0].width.value=t.pageWidth;t.columns[0].width.enabled=!0,t.columns[0].space.enabled=e>1}if(0==t.equalCheckbox.checked)if(e>2){var a=t.columns[e-1];a.index.value=e;for(var l=0;l<e;l++){var h=t.columns[parseInt(l.toString(),10)];h.width.value=o,l<e-1&&(h.width.value<=36?h.space.value=s:h.space.value=36),h.width.enabled=!0,h.space.enabled=!0}}else t.columns[0].width.value=t.pageWidth},this.closeDialog=function(){t.documentHelper.dialog.hide(),t.unWireEventsAndBindings(),t.closeColumnsDialog()},this.closeColumnsDialog=function(){t.documentHelper.dialog2.element.style.pointerEvents="",t.unWireEventsAndBindings(),t.documentHelper.updateFocus()},this.unWireEventsAndBindings=function(){t.equalCheckbox.checked=!0,t.lineCheckbox.checked=!1,t.equalCheckbox.disabled=!0;for(var e=0;e<t.columns.length;e++)t.columns.splice(1,t.columns.length-1),t.columns[0].space.enabled=!1;for(;t.columnTable.rows.length>1;)t.columnTable.deleteRow(t.columnTable.rows.length-1)},this.openColumnsDialog=function(){var e=t.documentHelper.selection.sectionFormat,i=e.pageWidth-e.leftMargin-e.rightMargin;switch(t.columnValueTexBox.max=i/36,t.columns[0].width.value=i,t.documentHelper.updateFocus(),t.equalCheckbox.checked=e.equalWidth,t.lineCheckbox.checked=e.lineBetweenColumns,t.columnValueTexBox.value=0===e.columns.length?1:e.columns.length,t.columnValueTexBox.value){case 1:t.oneDiv.classList.add("e-de-table-border-inside-setting-click"),t.twoDiv.classList.remove("e-de-table-border-inside-setting-click"),t.threeDiv.classList.remove("e-de-table-border-inside-setting-click"),t.leftDiv.classList.remove("e-de-table-border-inside-setting-click"),t.rightDiv.classList.remove("e-de-table-border-inside-setting-click");break;case 2:t.twoDiv.classList.add("e-de-table-border-inside-setting-click"),t.oneDiv.classList.remove("e-de-table-border-inside-setting-click"),t.threeDiv.classList.remove("e-de-table-border-inside-setting-click"),t.leftDiv.classList.remove("e-de-table-border-inside-setting-click"),t.rightDiv.classList.remove("e-de-table-border-inside-setting-click");break;case 3:t.threeDiv.classList.add("e-de-table-border-inside-setting-click"),t.twoDiv.classList.remove("e-de-table-border-inside-setting-click"),t.oneDiv.classList.remove("e-de-table-border-inside-setting-click"),t.leftDiv.classList.remove("e-de-table-border-inside-setting-click"),t.rightDiv.classList.remove("e-de-table-border-inside-setting-click")}1!==t.columnValueTexBox.value&&(t.columns[0].space.value=e.columns[0].space,t.columns[0].width.value=e.columns[0].width),1===t.columnValueTexBox.value&&(t.columns[0].space.value=0);for(var n=1;n<t.columnValueTexBox.value;n++)t.createColumn(n+1,e.columns[n].width,e.columns[n].space)},this.handleSettingCheckBoxAction=function(e){var i=e.target.id,n=t.target.id;i===n+"_One_Div"||i===n+"_One_Div_Container"?(t.oneDiv.classList.add("e-de-table-border-inside-setting-click"),t.setSettingPreviewDivElement("one")):i===n+"_Two_Div"||i===n+"_Two_Div_Container"?(t.twoDiv.classList.add("e-de-table-border-inside-setting-click"),t.setSettingPreviewDivElement("two")):i===n+"_Three_Div"||i===n+"_Three_Div_Container"?(t.threeDiv.classList.add("e-de-table-border-inside-setting-click"),t.setSettingPreviewDivElement("three")):i===n+"_Left_Div"||i===n+"_Left_Div_Container"?(t.oneDiv.classList.remove("e-de-table-border-inside-setting-click"),t.threeDiv.classList.remove("e-de-table-border-inside-setting-click"),t.rightDiv.classList.remove("e-de-table-border-inside-setting-click"),t.setSettingPreviewDivElement("two","left")):i!==n+"_Right_Div"&&i!==n+"_Right_Div_Container"||(t.oneDiv.classList.remove("e-de-table-border-inside-setting-click"),t.threeDiv.classList.remove("e-de-table-border-inside-setting-click"),t.leftDiv.classList.remove("e-de-table-border-inside-setting-click"),t.setSettingPreviewDivElement("two","right"))},this.applyColumnDialog=function(){var e=new s.G,i=t.documentHelper.selection.sectionFormat;e.bottomMargin=i.bottomMargin,e.topMargin=i.topMargin,e.leftMargin=i.leftMargin,e.rightMargin=i.rightMargin,e.pageWidth=i.pageWidth,e.pageHeight=i.pageHeight,e.differentOddAndEvenPages=i.differentOddAndEvenPages,e.differentFirstPage=i.differentFirstPage,e.headerDistance=i.headerDistance,e.footerDistance=i.footerDistance,e.numberOfColumns=t.numberOfColumns,e.equalWidth=t.equalCheckbox.checked,e.lineBetweenColumns=t.lineCheckbox.checked;for(var n=[],r=0;r<t.columns.length;r++){var o=new s.O;o.width=s.h.convertPointToPixel(t.columns[parseInt(r.toString(),10)].width.value),o.space=s.h.convertPointToPixel(t.columns[parseInt(r.toString(),10)].space.value),n.push(o)}e.columns=n,e.breakCode=i.breakCode,t.documentHelper.owner.editorModule.onApplySectionFormat(void 0,e),t.documentHelper.hideDialog()},this.documentHelper=e}return e.prototype.getModuleName=function(){return"ColumnsDialog"},e.prototype.initColumnsDialog=function(e,t){this.columns=[],this.target=i.i(n.createElement)("div",{id:this.documentHelper.owner.containerId+"_Columns",className:"e-de-table-border-shading-dlg"});var s=i.i(n.createElement)("div",{innerHTML:e.getConstant("Presets"),className:"e-de-para-dlg-heading"}),l=i.i(n.createElement)("div",{className:"e-de-dlg-row"}),d=i.i(n.createElement)("div",{id:this.target.id+"_One_Div_Container",className:"e-de-preset-container"});this.oneDiv=i.i(n.createElement)("div",{id:this.target.id+"_One_Div",className:"e-icons e-de-ctnr-columns-one e-de-columns-presets-genral"});var h=i.i(n.createElement)("label",{innerHTML:e.getConstant("One"),className:"e-de-column-label",id:this.target.id+"_One_Div_Label"}),c=i.i(n.createElement)("div",{id:this.target.id+"_Two_Div_Container",className:"e-de-preset-container"});this.twoDiv=i.i(n.createElement)("div",{id:this.target.id+"_Two_Div",className:"e-icons e-de-ctnr-columns-two e-de-columns-presets-genral"});var p=i.i(n.createElement)("label",{innerHTML:e.getConstant("Two"),className:"e-de-column-label",id:this.target.id+"_Two_Div_Label"}),u=i.i(n.createElement)("div",{id:this.target.id+"_Three_Div_Container",className:"e-de-preset-container"});this.threeDiv=i.i(n.createElement)("div",{id:this.target.id+"_Three_Div",className:"e-icons e-de-ctnr-columns-three  e-de-columns-presets-genral"});var g=i.i(n.createElement)("label",{innerHTML:e.getConstant("Three"),className:"e-de-column-label",id:this.target.id+"_Three_Div_Label"}),f=i.i(n.createElement)("div",{id:this.target.id+"_Left_Div_Container",className:"e-de-preset-container"});this.leftDiv=i.i(n.createElement)("div",{id:this.target.id+"_Left_Div",className:"e-icons e-de-ctnr-columns-left e-de-columns-presets-genral"});var m=i.i(n.createElement)("label",{innerHTML:e.getConstant("Left"),className:"e-de-column-label",id:this.target.id+"_Left_Div_Label"}),v=i.i(n.createElement)("div",{id:this.target.id+"_Right_Div_Container",className:"e-de-preset-container"});this.rightDiv=i.i(n.createElement)("div",{id:this.target.id+"_Right_Div",className:"e-icons e-de-ctnr-columns-right e-de-columns-presets-genral"});var y=i.i(n.createElement)("label",{innerHTML:e.getConstant("Right"),className:"e-de-column-label",id:this.target.id+"_Right_Div_Label"}),w=i.i(n.createElement)("div",{className:"e-de-container-row e-de-columns-padding-alignment"}),b=i.i(n.createElement)("div",{className:"e-de-subcontainer-left"});d.setAttribute("aria-label",e.getConstant("One")),c.setAttribute("aria-label",e.getConstant("Two")),u.setAttribute("aria-label",e.getConstant("Three")),f.setAttribute("aria-label",e.getConstant("Left")),v.setAttribute("aria-label",e.getConstant("Right")),t&&(this.oneDiv.classList.add("e-de-rtl"),this.twoDiv.classList.add("e-de-rtl"),this.threeDiv.classList.add("e-de-rtl"),this.leftDiv.classList.add("e-de-rtl"),this.rightDiv.classList.add("e-de-rtl"),d.classList.add("e-de-rtl"),c.classList.add("e-de-rtl"),u.classList.add("e-de-rtl"),f.classList.add("e-de-rtl"),v.classList.add("e-de-rtl"),h.classList.add("e-de-rtl"),p.classList.add("e-de-rtl"),g.classList.add("e-de-rtl"),m.classList.add("e-de-rtl"),y.classList.add("e-de-rtl")),this.columnsCountBox=i.i(n.createElement)("input",{attrs:{type:"text"}}),b.appendChild(this.columnsCountBox),w.appendChild(b),this.section=this.documentHelper.selection.sectionFormat,this.pageWidth=this.section.pageWidth-this.section.leftMargin-this.section.rightMargin,this.columnValueTexBox=new o.NumericTextBox({format:"#",value:1,min:1,strictMode:!0,placeholder:e.getConstant("Number of columns"),floatLabelType:"Always",change:this.createTextBox}),this.columnValueTexBox.appendTo(this.columnsCountBox);var x=i.i(n.createElement)("div",{className:"e-de-subcontainer-right"}),C=i.i(n.createElement)("div",{className:"e-de-columns-padding-alignment"}),I=i.i(n.createElement)("input",{attrs:{type:"checkbox"}});x.appendChild(C),C.appendChild(I),I.setAttribute("aria-labelledby",e.getConstant("Line between column")),this.columnsCountBox.setAttribute("aria-labelledby",e.getConstant("Number of columns")),this.lineCheckbox=new r.CheckBox({label:e.getConstant("Line between column")});var F=i.i(n.createElement)("div",{className:"e-de-dlg-row"}),k=i.i(n.createElement)("div",{}),P=i.i(n.createElement)("div",{innerHTML:e.getConstant("Width and Spacing"),className:"e-de-para-dlg-heading"});this.columnElementDiv=i.i(n.createElement)("div",{className:"e-width-space-div "}),this.widthcontainerDiv1=i.i(n.createElement)("div",{className:"e-de-container-row"}),this.widthContainer=i.i(n.createElement)("div",{className:"e-de-container-row"});var T=i.i(n.createElement)("table");T.style.width="96%";var S=T.insertRow(),W=S.insertCell();W.innerHTML=e.getConstant("Column"),W.style.width="20%",W.style.display="table-cell",W.classList.add("e-de-dlg-sub-header"),W=S.insertCell(),W.innerHTML=e.getConstant("Width"),W.style.width="40%",W.style.display="table-cell",W.classList.add("e-de-dlg-sub-header"),W=S.insertCell(),W.innerHTML=e.getConstant("Spacing"),W.style.width="40%",W.style.display="table-cell",W.classList.add("e-de-dlg-sub-header");var N=i.i(n.createElement)("div",{styles:"width:100%;height:100px;overflow-y: scroll;overflow-x: hidden;"});this.columnTable=i.i(n.createElement)("table",{styles:"width:100%;"});var H=this.columnTable.insertRow(),E=H.insertCell();E.style.width="20%";var O=new a;this.columnCountBox1=i.i(n.createElement)("input",{}),O.index=new o.NumericTextBox({format:"#",min:1,value:1,enabled:!1,cssClass:"index1",showSpinButton:!1,floatLabelType:"Always",change:this.spaceChange}),E.appendChild(this.columnCountBox1),O.index.appendTo(this.columnCountBox1);var _=H.insertCell();_.style.width="40%",this.widthCountBox1=i.i(n.createElement)("input",{attrs:{type:"text"}}),O.width=new o.NumericTextBox({min:36,decimals:2,strictMode:!0,enablePersistence:!1,cssClass:"width1",floatLabelType:"Always",change:this.widthChange}),_.appendChild(this.widthCountBox1),_.style.width="40%",O.width.appendTo(this.widthCountBox1);var B=H.insertCell();B.style.width="40%",this.spacingCountBox1=i.i(n.createElement)("input",{attrs:{type:"text"}}),O.space=new o.NumericTextBox({min:0,decimals:2,strictMode:!0,enablePersistence:!1,cssClass:"space1",floatLabelType:"Always",change:this.spaceChange}),B.appendChild(this.spacingCountBox1),O.space.appendTo(this.spacingCountBox1),this.columns.push(O),O.space.enabled=!1,this.widthCountBox1.setAttribute("aria-labelledby","Width"),this.spacingCountBox1.setAttribute("aria-labelledby","Space");var L=i.i(n.createElement)("div",{className:"e-de-columns-padding-alignment"}),R=i.i(n.createElement)("input",{attrs:{type:"checkbox"}});L.appendChild(R),L.setAttribute("aria-label",e.getConstant("Equal column width")),this.equalCheckbox=new r.CheckBox({label:e.getConstant("Equal column width"),change:this.checkBox}),this.equalCheckbox.appendTo(R),this.lineCheckbox.appendTo(I),w.appendChild(x),d.appendChild(this.oneDiv),d.appendChild(h),c.appendChild(this.twoDiv),c.appendChild(p),u.appendChild(this.threeDiv),u.appendChild(g),f.appendChild(this.leftDiv),f.appendChild(m),v.appendChild(this.rightDiv),v.appendChild(y),l.appendChild(d),l.appendChild(c),l.appendChild(u),l.appendChild(f),l.appendChild(v),k.appendChild(P),k.appendChild(T),N.appendChild(this.columnTable),k.appendChild(N),F.appendChild(k),this.target.appendChild(s),this.target.appendChild(l),this.target.appendChild(w),this.target.appendChild(F),this.target.appendChild(L),d.addEventListener("click",this.handleSettingCheckBoxAction),c.addEventListener("click",this.handleSettingCheckBoxAction),u.addEventListener("click",this.handleSettingCheckBoxAction),f.addEventListener("click",this.handleSettingCheckBoxAction),v.addEventListener("click",this.handleSettingCheckBoxAction),this.widthcontainerDiv1.style.display="flex",this.equalCheckbox.checked=!0,this.equalCheckbox.disabled=!0,this.lineCheckbox.disabled=!0},e.prototype.createColumn=function(e,t,r){this.widthContainer=i.i(n.createElement)("div",{className:"e-de-container-row"}),this.widthContainer.style.display="flex";var s=this.columnTable.insertRow(),l=s.insertCell();l.style.width="20%";var d=new a,h=i.i(n.createElement)("input",{});d.index=new o.NumericTextBox({format:"#",min:1,value:e,enabled:!1,cssClass:"column1",showSpinButton:!1,floatLabelType:"Always"}),l.appendChild(h),d.index.appendTo(h);var c=s.insertCell();c.style.width="40%";var p=i.i(n.createElement)("input",{attrs:{type:"text"}});d.width=new o.NumericTextBox({min:36,decimals:2,strictMode:!0,enablePersistence:!1,cssClass:"width1",floatLabelType:"Always",change:this.widthChange}),i.i(n.isNullOrUndefined)(t)||(d.width.value=t),c.appendChild(p),d.width.appendTo(p);var u=s.insertCell();u.style.width="40%";var g=i.i(n.createElement)("input",{attrs:{type:"text"}});d.space=new o.NumericTextBox({min:0,decimals:2,strictMode:!0,enablePersistence:!1,cssClass:"space1",floatLabelType:"Always",change:this.spaceChange}),i.i(n.isNullOrUndefined)(r)||(d.space.value=r),u.appendChild(g),d.space.appendTo(g),this.columns.push(d)},e.prototype.show=function(){var e=new n.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),this.target||this.initColumnsDialog(e,this.documentHelper.owner.enableRtl),this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.header=e.getConstant("Columns"),this.documentHelper.dialog.beforeOpen=this.openColumnsDialog,this.documentHelper.dialog.close=this.closeColumnsDialog,this.documentHelper.dialog.position={X:"center",Y:"center"},this.documentHelper.dialog.width="auto",this.documentHelper.dialog.height="auto",this.documentHelper.dialog.buttons=[{click:this.applyColumnDialog,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-table-border-shading-okay",isPrimary:!0}},{click:this.closeDialog,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-table-border-shading-cancel"}}],this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show()},e.prototype.setSettingPreviewDivElement=function(e,t){var i=this;switch(this.equalCheckbox.checked=!0,e){case"one":this.columnValueTexBox.value=1;break;case"two":this.columnValueTexBox.value=2,setTimeout(function(){if("left"!=t&&"right"!=t||(i.equalCheckbox.checked=!1),"left"==t){i.numberOfColumns=2,i.leftDiv.classList.add("e-de-table-border-inside-setting-click"),i.twoDiv.classList.remove("e-de-table-border-inside-setting-click");var e=(i.pageWidth-72)/3;i.columns[0].width.value=e,i.columns[1].width.value=e+e+36,i.columns[1].space.value=void 0}else if("right"==t){i.numberOfColumns=2,i.rightDiv.classList.add("e-de-table-border-inside-setting-click"),i.twoDiv.classList.remove("e-de-table-border-inside-setting-click");var e=(i.pageWidth-72)/3;i.columns[0].width.value=e+e+36,i.columns[1].width.value=e,i.columns[1].space.value=void 0}},5);break;case"three":this.columnValueTexBox.value=3}},e.prototype.destroy=function(){this.target=void 0,this.oneDiv=void 0,this.twoDiv=void 0,this.threeDiv=void 0,this.leftDiv=void 0,this.rightDiv=void 0,this.documentHelper=void 0},e}()},function(e,t,i){"use strict";i.d(t,"a",function(){return l});var n=i(0),r=(i.n(n),i(3)),o=(i.n(r),i(2)),s=i(18),a=(i.n(s),i(5)),l=(i.n(a),function(){function e(e){var t=this;this.addItemtoList=function(){t.dropDownItems.push(n.SanitizeHtmlHelper.sanitize(t.drpDownItemsInput.value)),t.currentSelectedItem=n.SanitizeHtmlHelper.sanitize(t.drpDownItemsInput.value),t.drpDownItemsInput.value="",t.enableOrDisableButton(),t.updateList()},this.removeItemFromList=function(){for(var e=0;e<t.dropDownItems.length;e++)t.dropDownItems[e]===t.currentSelectedItem&&t.dropDownItems.splice(e,1);t.updateList()},this.selectHandler=function(e){t.currentSelectedItem=e.text},this.moveUpItem=function(){var e=t.getSelectedIndex();t.moveUp(e,e-1),t.updateList()},this.moveDownItem=function(){var e=t.getSelectedIndex();t.moveDown(e,e+1),t.updateList()},this.onKeyUpOnTextBox=function(){t.enableOrDisableButton()},this.onCancelButtonClick=function(){t.documentHelper.dialog.hide()},this.insertDropDownField=function(){var e=new o.n;e.dropdownItems=t.dropDownItems,e.selectedIndex=0,e.name=n.SanitizeHtmlHelper.sanitize(t.bookmarkInput.value),e.helpText=n.SanitizeHtmlHelper.sanitize(t.tooltipInput.value),e.enabled=t.dropDownEnable.checked,t.owner.editor.editFormField("DropDown",e),t.closeDropDownField()},this.closeDropDownField=function(){t.documentHelper.dialog.hide(),t.documentHelper.dialog.element.style.pointerEvents=""},this.owner=e}return Object.defineProperty(e.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"DropDownFormFieldDialog"},e.prototype.initTextDialog=function(e,t){this.target=i.i(n.createElement)("div");var o=i.i(n.createElement)("div"),l=i.i(n.createElement)("div",{className:"e-de-drp-dwn-frst-div"});this.drpDownItemsInput=i.i(n.createElement)("input",{className:"e-input e-bookmark-textbox-input",id:"fielditems_text_box"}),this.drpDownItemsInput.addEventListener("keyup",this.onKeyUpOnTextBox);var d=i.i(n.createElement)("div",{className:"e-de-ff-drpdwn-dlg-scndiv"}),h=i.i(n.createElement)("div",{className:"e-de-ff-dlg-drpdwn-heading",innerHTML:e.getConstant("Items in dropdown list")}),c=i.i(n.createElement)("div",{className:"e-bookmark-listViewDiv e-de-ff-drpdwn-listview",attrs:{style:"height:100%"}});this.listviewInstance=new s.ListView({cssClass:"e-bookmark-listview",select:this.selectHandler});var p=i.i(n.createElement)("div"),u=i.i(n.createElement)("div",{className:"e-bookmark-addbutton"}),g=i.i(n.createElement)("button",{innerHTML:e.getConstant("ADD"),attrs:{type:"button",style:"height:36px;width:100%"}});this.addButton=new r.Button({cssClass:"e-button-custom"}),this.addButton.disabled=!0,g.setAttribute("aria-label",e.getConstant("ADD")),g.addEventListener("click",this.addItemtoList.bind(this));var f=i.i(n.createElement)("div",{className:"e-bookmark-addbutton"});f.style.display="none";var m=i.i(n.createElement)("button",{innerHTML:"EDIT",attrs:{type:"button",style:"height:36px;width:100%"}});this.editButton=new r.Button({cssClass:"e-button-custom"}),m.setAttribute("aria-label","EDIT");var v=i.i(n.createElement)("div",{className:"e-bookmark-addbutton"}),y=i.i(n.createElement)("button",{innerHTML:e.getConstant("REMOVE"),attrs:{type:"button",style:"height:36px;width:100%"}});y.setAttribute("aria-label",e.getConstant("REMOVE")),this.removeButton=new r.Button({cssClass:"e-button-custom"}),y.addEventListener("click",this.removeItemFromList.bind(this));var w=i.i(n.createElement)("div",{attrs:{style:"display:inline-flex"}}),b=i.i(n.createElement)("div",{className:"e-bookmark-addbutton"}),x=i.i(n.createElement)("button",{attrs:{type:"button",style:"height:36px;width:40px"},className:"e-de-ff-drpdwn-mvup"});x.setAttribute("aria-label","moveUp"),this.moveUpButton=new r.Button({cssClass:"e-button-custom",iconCss:"e-de-arrow-up"}),x.addEventListener("click",this.moveUpItem.bind(this));var C=i.i(n.createElement)("div",{className:"e-bookmark-addbutton"}),I=i.i(n.createElement)("button",{attrs:{type:"button",style:"height:36px;width:40px"},className:"e-de-ff-drpdwn-mvdn"});I.setAttribute("aria-label","moveDown"),this.moveDownButton=new r.Button({cssClass:"e-button-custom",iconCss:"e-de-arrow-down"}),I.addEventListener("click",this.moveDownItem.bind(this));var F=i.i(n.createElement)("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Field settings")}),k=i.i(n.createElement)("div",{className:"e-de-container-row"}),P=i.i(n.createElement)("div",{className:"e-de-subcontainer-left"}),T=i.i(n.createElement)("div",{className:"e-de-subcontainer-right"});this.tooltipInput=i.i(n.createElement)("input",{className:"e-input e-bookmark-textbox-input"}),this.bookmarkInput=i.i(n.createElement)("input",{className:"e-input e-bookmark-textbox-input"});var S=i.i(n.createElement)("div"),W=i.i(n.createElement)("input",{attrs:{type:"checkbox"}});this.dropDownEnable=new r.CheckBox({cssClass:"e-de-ff-dlg-check",label:e.getConstant("Dropdown enabled"),enableRtl:t}),t&&(c.classList.add("e-de-rtl"),x.classList.add("e-de-rtl"),P.classList.add("e-de-rtl"),T.classList.add("e-de-rtl")),S.setAttribute("aria-label",e.getConstant("Dropdown enabled")),this.target.appendChild(o),o.appendChild(l),l.appendChild(this.drpDownItemsInput),o.appendChild(h),o.appendChild(d),d.appendChild(c),this.listviewInstance.appendTo(c),d.appendChild(p),p.appendChild(u),u.appendChild(g),this.addButton.appendTo(g),p.appendChild(f),f.appendChild(m),this.editButton.appendTo(m),p.appendChild(v),v.appendChild(y),this.removeButton.appendTo(y),p.appendChild(w),w.appendChild(b),b.appendChild(x),this.moveUpButton.appendTo(x),w.appendChild(C),C.appendChild(I),this.moveDownButton.appendTo(I),o.appendChild(F),o.appendChild(k),k.appendChild(P),P.appendChild(this.tooltipInput),k.appendChild(T),T.appendChild(this.bookmarkInput),o.appendChild(S),S.appendChild(W),this.dropDownEnable.appendTo(W),new a.TextBox({placeholder:e.getConstant("Tooltip"),floatLabelType:"Always"},this.tooltipInput),new a.TextBox({placeholder:e.getConstant("Name"),floatLabelType:"Always"},this.bookmarkInput),new a.TextBox({placeholder:e.getConstant("Dropdown items"),floatLabelType:"Always"},this.drpDownItemsInput),this.tooltipInput.setAttribute("aria-labelledby",e.getConstant("Tooltip")),this.bookmarkInput.setAttribute("aria-labelledby",e.getConstant("Name")),this.drpDownItemsInput.setAttribute("aria-labelledby",e.getConstant("Dropdown items"))},e.prototype.show=function(){var e=new n.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),i.i(n.isNullOrUndefined)(this.target)&&this.initTextDialog(e,this.documentHelper.owner.enableRtl),this.loadDropDownDialog(),this.documentHelper.dialog.header=e.getConstant("Drop Down Form Field"),this.documentHelper.dialog.position={X:"center",Y:"center"},this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="448px",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.buttons=[{click:this.insertDropDownField,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-table-cell-margin-okay",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-table-cell-margin-cancel"}}],this.documentHelper.dialog.show()},e.prototype.loadDropDownDialog=function(){var e=this.owner.selection.getCurrentFormField();if(e instanceof o.b){if(this.fieldBegin=e,this.dropDownInstance=e.formFieldData,this.dropDownInstance.dropdownItems.length>0){var t=this.dropDownInstance.selectedIndex;this.currentSelectedItem=this.dropDownInstance.dropdownItems[t]}this.dropDownInstance.enabled?this.dropDownEnable.checked=!0:this.dropDownEnable.disabled=!1,""!==this.dropDownInstance.helpText?this.tooltipInput.value=this.dropDownInstance.helpText:this.tooltipInput.value="",""!==this.dropDownInstance.name?this.bookmarkInput.value=this.dropDownInstance.name:this.bookmarkInput.value="",this.dropDownItems=this.dropDownInstance.dropdownItems.slice(),this.updateList()}},e.prototype.updateList=function(){if(this.listviewInstance.dataSource=this.dropDownItems.slice(),this.listviewInstance.dataBind(),this.currentSelectedItem){var e=this.currentSelectedItem;this.listviewInstance.selectItem(e)}},e.prototype.getSelectedIndex=function(){for(var e=0;e<this.dropDownItems.length;e++)if(this.dropDownItems[e]===this.currentSelectedItem)return e;return 0},e.prototype.moveUp=function(e,t){var i=[];if(0===e){for(var n=0;n<this.dropDownItems.length;n++)n<this.dropDownItems.length-1?i[n]=this.dropDownItems[n+1]:i[n]=this.dropDownItems[0];this.dropDownItems=i}else{var r=this.dropDownItems[e];this.dropDownItems[e]=this.dropDownItems[t],this.dropDownItems[t]=r}},e.prototype.moveDown=function(e,t){var i=[];if(e===this.dropDownItems.length-1){for(var n=0;n<this.dropDownItems.length;n++)i[n]=0!==n?this.dropDownItems[n-1]:this.dropDownItems[this.dropDownItems.length-1];this.dropDownItems=i}else{var r=this.dropDownItems[e];this.dropDownItems[e]=this.dropDownItems[t],this.dropDownItems[t]=r}},e.prototype.enableOrDisableButton=function(){i.i(n.isNullOrUndefined)(this.addButton)||(this.addButton.disabled=""===this.drpDownItemsInput.value)},e.prototype.destroy=function(){var e=this.target;e&&(e.parentElement&&e.parentElement.removeChild(e),this.target=void 0),this.owner=void 0,this.drpDownItemsInput=void 0,this.listviewInstance&&(this.listviewInstance.destroy(),this.listviewInstance=void 0),this.addButton&&(this.addButton.destroy(),this.addButton=void 0),this.editButton&&(this.editButton.destroy(),this.editButton=void 0),this.removeButton&&(this.removeButton.destroy(),this.removeButton=void 0),this.moveUpButton&&(this.moveUpButton.destroy(),this.moveUpButton=void 0),this.moveDownButton&&(this.moveDownButton.destroy(),this.moveDownButton=void 0),this.tooltipInput=void 0,this.bookmarkInput=void 0,this.dropDownEnable&&(this.dropDownEnable.destroy(),this.dropDownEnable=void 0),this.dropDownInstance=void 0},e}())},function(e,t,i){"use strict";i.d(t,"a",function(){return c});var n=i(0),r=(i.n(n),i(5)),o=(i.n(r),i(3)),s=(i.n(o),i(8)),a=(i.n(s),i(2)),l=i(139),d=(i.n(l),i(10)),h=(i.n(d),i(11)),c=function(){function e(e){var t=this;this.applyTextFormFieldValue=function(){t.owner.editor.updateFormField(t.formField,t.textBoxInstance.value),t.owner.trigger(h.c,{fieldName:t.formField.formFieldData.name,value:t.formField.resultText,isCanceled:!1}),t.hidePopup()},this.applyNumberFormFieldValue=function(){t.owner.editor.updateFormField(t.formField,t.numberInput.value.toString()),t.owner.trigger(h.c,{fieldName:t.formField.formFieldData.name,value:t.formField.resultText,isCanceled:!1}),t.hidePopup()},this.applyDateFormFieldValue=function(){i.i(n.isNullOrUndefined)(t.datePickerInstance.value)||(t.owner.editor.updateFormField(t.formField,t.dateInput.value),t.owner.trigger(h.c,{fieldName:t.formField.formFieldData.name,value:t.formField.resultText,isCanceled:!1}),t.hidePopup())},this.applyDropDownFormFieldValue=function(){t.owner.editor.updateFormField(t.formField,t.ddlInstance.index),t.owner.trigger(h.c,{fieldName:t.formField.formFieldData.name,value:t.formField.formFieldData.selectedIndex,isCanceled:!1}),t.hidePopup()},this.enableDisableDatePickerOkButton=function(e){e.isInteracted&&(t.dataPickerOkButton.disabled=!1)},this.closeButton=function(){var e=t.formField;t.hidePopup();var i={fieldName:e.formFieldData.name};e.formFieldData instanceof a.l?i.value=e.resultText:e.formFieldData instanceof a.m?i.value=e.formFieldData.checked:i.value=e.formFieldData.selectedIndex,i.isCanceled=!0,t.owner.trigger(h.c,i)},this.hidePopup=function(){t.owner.documentHelper.isFormFilling=!1,t.formField=void 0,t.target&&(t.target.style.display="none"),t.popupObject&&(t.popupObject.hide(),t.popupObject.destroy(),t.popupObject=void 0)},this.owner=e}return e.prototype.initPopup=function(){var e=i.i(n.createElement)("div",{className:"e-de-form-popup"});this.textBoxContainer=this.initTextBoxInput(),e.appendChild(this.textBoxContainer),e.appendChild(this.initNumericTextBox()),e.appendChild(this.initDatePicker()),e.appendChild(this.initDropDownList()),this.target=e,this.owner.documentHelper.viewerContainer.appendChild(e)},e.prototype.initTextBoxInput=function(){var e=i.i(n.createElement)("div",{className:"e-de-txt-field"}),t=i.i(n.createElement)("input",{className:"e-de-txt-form"}),s=new r.TextBox;this.textBoxInput=t;var a=i.i(n.createElement)("div",{className:"e-de-cmt-action-button"}),l=i.i(n.createElement)("button"),d=i.i(n.createElement)("button");return l.addEventListener("click",this.applyTextFormFieldValue),d.addEventListener("click",this.closeButton),e.appendChild(t),a.appendChild(l),a.appendChild(d),e.appendChild(a),s.appendTo(t),new o.Button({cssClass:"e-de-save e-primary",iconCss:"e-de-save-icon"},l),new o.Button({cssClass:"e-de-cancel",iconCss:"e-de-cancel-icon"},d),this.textBoxInstance=s,e},e.prototype.initNumericTextBox=function(){var e=i.i(n.createElement)("div",{className:"e-de-num-field"}),t=i.i(n.createElement)("input",{className:"e-de-txt-form"}),s=new r.NumericTextBox;this.numberInput=t;var a=i.i(n.createElement)("div",{className:"e-de-cmt-action-button"}),l=i.i(n.createElement)("button"),d=i.i(n.createElement)("button");return l.addEventListener("click",this.applyNumberFormFieldValue),d.addEventListener("click",this.closeButton),e.appendChild(t),a.appendChild(l),a.appendChild(d),e.appendChild(a),s.appendTo(t),new o.Button({cssClass:"e-de-save e-primary",iconCss:"e-de-save-icon"},l),new o.Button({cssClass:"e-de-cancel",iconCss:"e-de-cancel-icon"},d),this.numericTextBoxInstance=s,e},e.prototype.initDatePicker=function(){var e=i.i(n.createElement)("div",{className:"e-de-date-field"}),t=i.i(n.createElement)("input",{className:"e-de-txt-form"}),r=new l.DateTimePicker({strictMode:!0,change:this.enableDisableDatePickerOkButton});this.dateInput=t;var s=i.i(n.createElement)("div",{className:"e-de-cmt-action-button"}),a=i.i(n.createElement)("button"),d=i.i(n.createElement)("button");return a.addEventListener("click",this.applyDateFormFieldValue),d.addEventListener("click",this.closeButton),e.appendChild(t),s.appendChild(a),s.appendChild(d),e.appendChild(s),r.appendTo(t),this.dataPickerOkButton=new o.Button({cssClass:"e-de-save e-primary",iconCss:"e-de-save-icon"},a),new o.Button({cssClass:"e-de-cancel",iconCss:"e-de-cancel-icon"},d),this.datePickerInstance=r,e},e.prototype.initDropDownList=function(){var e=i.i(n.createElement)("div",{className:"e-de-ddl-field"}),t=i.i(n.createElement)("input",{className:"e-de-txt-form"}),r=new d.DropDownList;this.dropDownInput=t;var s=i.i(n.createElement)("div",{className:"e-de-cmt-action-button"}),a=i.i(n.createElement)("button"),l=i.i(n.createElement)("button");return a.addEventListener("click",this.applyDropDownFormFieldValue),l.addEventListener("click",this.closeButton),e.appendChild(t),s.appendChild(a),s.appendChild(l),e.appendChild(s),r.appendTo(t),new o.Button({cssClass:"e-de-save e-primary",iconCss:"e-de-save-icon"},a),new o.Button({cssClass:"e-de-cancel",iconCss:"e-de-cancel-icon"},l),this.ddlInstance=r,e},e.prototype.showPopUp=function(e){var t=this;if(e){this.formField=e,this.owner.selection.selectField(),i.i(n.isNullOrUndefined)(this.target)&&this.initPopup(),i.i(n.classList)(this.target,[],["e-de-txt-form","e-de-num-form","e-de-date-form","e-de-ddl-form"]);var r=e.formFieldData;if(r){if(r instanceof a.l){var o=e.resultText,l=RegExp(this.owner.documentHelper.textHelper.getEnSpaceCharacter(),"gi");""===o.replace(l,"")&&(o="");var d,h=r.maxLength,c=r.type;if(o=o||"","Text"===c||"Calculation"===c)i.i(n.classList)(this.target,["e-de-txt-form"],[]),d=this.textBoxInput,this.textBoxInstance.value=o;else if("Number"===r.type)i.i(n.classList)(this.target,["e-de-num-form"],[]),d=this.numberInput,this.numericTextBoxInstance.format=r.format,this.numericTextBoxInstance.value=parseFloat(o.replace(/,/gi,""));else if("Date"===c){i.i(n.classList)(this.target,["e-de-date-form"],[]),d=this.dateInput;var p=r.format;-1!==p.indexOf("am/pm")&&(p=p.replace(/am\/pm/gi,"a")),this.datePickerInstance.format=p,this.datePickerInstance.value=new Date(o),this.dataPickerOkButton.disabled=!0}d&&(h>0?d.maxLength=h:d.removeAttribute("maxlength"),setTimeout(function(){d.focus()}))}else r instanceof a.n&&(i.i(n.classList)(this.target,["e-de-ddl-form"],[]),this.ddlInstance.refresh(),this.ddlInstance.dataSource=r.dropdownItems,this.ddlInstance.index=r.selectedIndex,setTimeout(function(){t.ddlInstance.showPopup()},50));var u=this.owner.selection.getLeftInternal(e.line,e,0),g=e.line.height*this.owner.documentHelper.zoomFactor,f=this.owner.selection.getTooltipPosition(e.line,u,this.target,!0);this.popupObject||(this.popupObject=new s.Popup(this.target,{height:"auto",width:"auto",relateTo:this.owner.documentHelper.viewerContainer.parentElement,position:{X:f.x,Y:f.y+g}})),this.target.style.display="block",this.popupObject.show()}this.owner.documentHelper.isFormFilling=!0}},e.prototype.destroy=function(){this.formField&&this.formField.destroy(),this.formField=void 0,this.owner=void 0},e}()},function(e,t,i){"use strict";i.d(t,"a",function(){return h});var n=i(0),r=(i.n(n),i(3)),o=(i.n(r),i(2)),s=i(5),a=(i.n(s),i(10)),l=(i.n(a),i(8)),d=(i.n(l),i(4)),h=function(){function e(e){var t=this;this.updateTextFormtas=function(){var e=n.SanitizeHtmlHelper.sanitize(t.updateFormats(t.defaultTextInput.value));t.defaultTextInput.value=i.i(n.isNullOrUndefined)(e)?"":e},this.onCancelButtonClick=function(){t.documentHelper.dialog.hide()},this.insertTextField=function(){var e=!0;if("Date"===t.typeDropDown.value&&(e=t.isValidDateFormat()),e)if(t.updateTextFormtas(),t.defaultTextInput.value.length>t.maxLengthNumber.value&&!i.i(n.isNullOrUndefined)(t.maxLengthNumber.value)&&0!==t.maxLengthNumber.value)l.DialogUtility.alert({content:"The maximum length value must be equal or greater than the length of the default text.",showCloseIcon:!0,closeOnEscape:!0,position:{X:"center",Y:"center"},animationSettings:{effect:"Zoom"}}).enableRtl=t.owner.enableRtl;else{var r=void 0;r="Date"===t.typeDropDown.value?"Date":"Number"===t.typeDropDown.value?"Number":"Text";var s=n.SanitizeHtmlHelper.sanitize(t.textFormatDropDown.value),a=new o.l;a.type=r,a.defaultValue=t.defaultTextInput.value,a.maxLength=t.maxLengthNumber.value,a.format=i.i(n.isNullOrUndefined)(s)?"":s,a.name=n.SanitizeHtmlHelper.sanitize(t.bookmarkTextInput.value),a.helpText=n.SanitizeHtmlHelper.sanitize(t.tooltipTextInput.value),a.enabled=t.fillInEnable.checked,t.owner.editor.editFormField("Text",a),t.closeTextField()}else l.DialogUtility.alert({content:"A valid date or time is required",showCloseIcon:!0,closeOnEscape:!0,position:{X:"center",Y:"center"},animationSettings:{effect:"Zoom"}}).enableRtl=t.owner.enableRtl},this.closeTextField=function(){t.documentHelper.dialog.hide(),t.documentHelper.dialog.element.style.pointerEvents=""},this.owner=e}return Object.defineProperty(e.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"TextFormFieldDialog"},e.prototype.initTextDialog=function(e,t){var o=this;this.target=i.i(n.createElement)("div");var l=i.i(n.createElement)("div"),d=i.i(n.createElement)("div",{className:"e-de-container-row"}),h=i.i(n.createElement)("div",{className:"e-de-subcontainer-left"});this.defaultTextDiv=i.i(n.createElement)("div",{className:"e-de-subcontainer-right"});var c=[{Value:"Regular text",Name:e.getConstant("Regular text")},{Value:"Number",Name:e.getConstant("Number")},{Value:"Date",Name:e.getConstant("Date")}],p=i.i(n.createElement)("input");this.typeDropDown=new a.DropDownList({dataSource:c,popupHeight:"150px",value:"Regular text",change:this.changeTypeDropDown.bind(this),floatLabelType:"Always",placeholder:e.getConstant("Type"),fields:{text:"Name",value:"Value"},htmlAttributes:{"aria-labelledby":e.getConstant("Type")}}),this.defaultTextInput=i.i(n.createElement)("input",{className:"e-input e-bookmark-textbox-input"});var u=i.i(n.createElement)("div",{className:"e-de-container-row"}),g=i.i(n.createElement)("div",{className:"e-de-subcontainer-left"}),f=i.i(n.createElement)("input",{attrs:{"aria-labelledby":e.getConstant("Maximum length")}});this.maxLengthNumber=new s.NumericTextBox({format:"n",value:0,min:0,max:32767,width:"100%",enablePersistence:!1,placeholder:e.getConstant("Maximum length"),floatLabelType:"Always",change:function(t){t.value||(this.element.value=e.getConstant("Unlimited"))},focus:function(t){t.value||(this.element.value=e.getConstant("Unlimited"))},blur:function(t){if(!t.value){var i=this;setTimeout(function(){i.element.value=e.getConstant("Unlimited")},0)}}});var m=i.i(n.createElement)("div",{className:"e-de-subcontainer-right"}),v=i.i(n.createElement)("input"),y=[{Value:"Uppercase",Name:e.getConstant("Uppercase")},{Value:"Lowercase",Name:e.getConstant("Lowercase")},{Value:"FirstCapital",Name:e.getConstant("FirstCapital")},{Value:"Titlecase",Name:e.getConstant("TitleCase")}];this.textFormatDropDown=new a.ComboBox({dataSource:y,popupHeight:"150px",allowCustom:!0,showClearButton:!1,change:this.updateTextFormtas.bind(this),placeholder:e.getConstant("Text format"),floatLabelType:"Always",fields:{text:"Name",value:"Value"}}),this.textFormatDropDown.focus=function(){o.textFormatDropDown.element.select()};var w=i.i(n.createElement)("div",{className:"e-de-ff-dlg-heading",innerHTML:e.getConstant("Field settings")}),b=i.i(n.createElement)("div",{className:"e-de-container-row"}),x=i.i(n.createElement)("div",{className:"e-de-subcontainer-left"}),C=i.i(n.createElement)("div",{className:"e-de-subcontainer-right"});this.tooltipTextInput=i.i(n.createElement)("input",{className:"e-input e-bookmark-textbox-input"}),this.bookmarkTextInput=i.i(n.createElement)("input",{className:"e-input e-bookmark-textbox-input"});var I=i.i(n.createElement)("div"),F=i.i(n.createElement)("input",{attrs:{type:"checkbox"}});F.setAttribute("aria-label",e.getConstant("Fillin enabled")),this.fillInEnable=new r.CheckBox({cssClass:"e-de-ff-dlg-check",label:e.getConstant("Fillin enabled"),enableRtl:t}),t&&(h.classList.add("e-de-rtl"),g.classList.add("e-de-rtl"),x.classList.add("e-de-rtl"),C.classList.add("e-de-rtl")),this.target.appendChild(l),l.appendChild(d),d.appendChild(h),h.appendChild(p),this.typeDropDown.appendTo(p),d.appendChild(this.defaultTextDiv),this.defaultTextDiv.appendChild(this.defaultTextInput),l.appendChild(u),u.appendChild(g),g.appendChild(f),this.maxLengthNumber.appendTo(f),u.appendChild(m),m.appendChild(v),this.textFormatDropDown.appendTo(v),l.appendChild(w),l.appendChild(b),b.appendChild(x),x.appendChild(this.tooltipTextInput),b.appendChild(C),C.appendChild(this.bookmarkTextInput),l.appendChild(I),I.appendChild(F),this.fillInEnable.appendTo(F),this.defaultTextLabel=new s.TextBox({placeholder:e.getConstant("Default text"),floatLabelType:"Always"},this.defaultTextInput),new s.TextBox({placeholder:e.getConstant("Tooltip"),floatLabelType:"Always"},this.tooltipTextInput),new s.TextBox({placeholder:e.getConstant("Name"),floatLabelType:"Always",htmlAttributes:{"aria-labelledby":e.getConstant("Name")}},this.bookmarkTextInput),this.defaultTextInput.setAttribute("aria-labelledby",e.getConstant("Default text")),this.tooltipTextInput.setAttribute("aria-labelledby",e.getConstant("Tooltip")),this.bookmarkTextInput.setAttribute("aria-labelledby",e.getConstant("Name"))},e.prototype.show=function(){this.localObj=new n.L10n("documenteditor",this.documentHelper.owner.defaultLocale),this.localObj.setLocale(this.documentHelper.owner.locale),i.i(n.isNullOrUndefined)(this.target)&&this.initTextDialog(this.localObj,this.documentHelper.owner.enableRtl),this.loadTextDialog(this.localObj),this.documentHelper.dialog.header=this.localObj.getConstant("Text Form Field"),this.documentHelper.dialog.position={X:"center",Y:"center"},this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="448px",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.buttons=[{click:this.insertTextField,buttonModel:{content:this.localObj.getConstant("Ok"),cssClass:"e-flat e-table-cell-margin-okay",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:this.localObj.getConstant("Cancel"),cssClass:"e-flat e-table-cell-margin-cancel"}}],this.documentHelper.dialog.show()},e.prototype.changeTypeDropDown=function(e){e.isInteracted&&(this.defaultTextInput.value="",this.textFormatDropDown.value=""),"Regular text"===e.value?(this.textFormatDropDown.fields={text:"Name",value:"Value"},this.defaultTextLabel.placeholder=this.localObj.getConstant("Default text"),this.textFormatDropDown.placeholder=this.localObj.getConstant("Text format"),this.textFormatDropDown.dataSource=[{Value:"Uppercase",Name:this.localObj.getConstant("Uppercase")},{Value:"Lowercase",Name:this.localObj.getConstant("Lowercase")},{Value:"FirstCapital",Name:this.localObj.getConstant("FirstCapital")},{Value:"Titlecase",Name:this.localObj.getConstant("TitleCase")}]):"Number"===e.value?(this.textFormatDropDown.fields={text:null,value:null},this.defaultTextLabel.placeholder=this.localObj.getConstant("Default number"),this.textFormatDropDown.placeholder=this.localObj.getConstant("Number format"),this.textFormatDropDown.dataSource=["0","0.00","#,##0","#,##0.00","$#,##0.00;($#,##0.00)","0%"]):"Date"===e.value&&(this.textFormatDropDown.fields={text:null,value:null},this.defaultTextLabel.placeholder=this.localObj.getConstant("Default date"),this.textFormatDropDown.placeholder=this.localObj.getConstant("Date format"),this.textFormatDropDown.dataSource=["M/d/yyyy","dddd, MMMM d, yyyy","MMMM d, yyyy","M/d/yy","yyyy-MM-dd","d-MMM-yy","M.d.yyyy","MMM. d, yy","d MMMM yyyy","MMMM yy","MMM-yy","M/d/yyyy h:mm am/pm","M/d/yyyy h:mm:ss am/pm","h:mm am/pm","h:mm:ss am/pm","HH:mm","HH:mm:ss"]),this.defaultTextLabel.dataBind(),this.textFormatDropDown.dataBind()},e.prototype.loadTextDialog=function(e){var t=this.owner.selection.getCurrentFormField();if(t instanceof o.b){this.fieldBegin=t;var r=t.formFieldData;r.maxLength>0?this.maxLengthNumber.value=r.maxLength:(this.maxLengthNumber.value=0,this.maxLengthNumber.element.value=e?e.getConstant("Unlimited"):"Unlimited"),"Date"===r.type?this.typeDropDown.value="Date":"Number"===r.type?this.typeDropDown.value="Number":this.typeDropDown.value="Regular text",r.format?this.textFormatDropDown.value=r.format:this.textFormatDropDown.value="",this.defaultTextInput.value=i.i(n.isNullOrUndefined)(r.defaultValue)?"":r.defaultValue,this.fillInEnable.checked=r.enabled,this.tooltipTextInput.value=i.i(n.isNullOrUndefined)(r.helpText)?"":r.helpText,this.bookmarkTextInput.value=i.i(n.isNullOrUndefined)(r.name)?"":r.name}},e.prototype.updateFormats=function(e){var t=i.i(n.isNullOrUndefined)(this.textFormatDropDown.value)?"":this.textFormatDropDown.value.toString();if("Regular text"===this.typeDropDown.value)return d.a.formatText(t,e);if("Number"===this.typeDropDown.value){var r=d.a.formatNumber(t,e);return"NaN"!==r.toString()?r:""}return"Date"===this.typeDropDown.value?d.a.formatDate(t,e):""},e.prototype.isValidDateFormat=function(){var e=this.defaultTextInput.value;if(""!==e){var t=new Date(e);if(isNaN(t.getDate()))return!1}return!0},e.prototype.destroy=function(){var e=this.target;e&&(e.parentElement&&e.parentElement.removeChild(e),this.target=void 0),this.maxLengthNumber&&(this.maxLengthNumber.destroy(),this.maxLengthNumber=void 0),this.fillInEnable&&(this.fillInEnable.destroy(),this.fillInEnable=void 0),this.typeDropDown&&(this.typeDropDown.destroy(),this.typeDropDown=void 0),this.textFormatDropDown&&(this.textFormatDropDown.destroy(),this.textFormatDropDown=void 0),this.owner=void 0,this.defaultTextInput=void 0,this.tooltipTextInput=void 0,this.bookmarkTextInput=void 0,this.defaultTextLabel=void 0,this.defaultTextDiv=void 0,this.textFormatLabel=void 0},e}()},function(e,t,i){"use strict";i.d(t,"a",function(){return l});var n=i(0),r=(i.n(n),i(3)),o=(i.n(r),i(18)),s=(i.n(o),i(2)),a=i(8),l=(i.n(a),function(){function e(e){var t=this;this.selectHandler=function(e){t.selectedText=e.text},this.onCancelButtonClick=function(){t.documentHelper.clearSelectionHighlight(),t.documentHelper.hideDialog()},this.onIgnoreClicked=function(){i.i(n.isNullOrUndefined)(t.elementBox)||(i.i(a.showSpinner)(t.documentHelper.dialog.element),t.parent.spellChecker.manageReplace("Ignore Once",t.elementBox),t.removeErrors(),t.parent.spellChecker.checkForNextError(),i.i(a.hideSpinner)(t.documentHelper.dialog.element))},this.onIgnoreAllClicked=function(){if(!i.i(n.isNullOrUndefined)(t.elementBox)){i.i(a.showSpinner)(t.documentHelper.dialog.element);var e=t.elementBox.text;t.parent.spellChecker.handleIgnoreAllItems({element:t.elementBox,text:e}),t.parent.spellChecker.checkForNextError(),i.i(a.hideSpinner)(t.documentHelper.dialog.element)}},this.addToDictClicked=function(){i.i(n.isNullOrUndefined)(t.elementBox)||(i.i(a.showSpinner)(t.documentHelper.dialog.element),t.parent.spellChecker.handleAddToDictionary({element:t.elementBox,text:t.elementBox.text}),t.parent.spellChecker.errorWordCollection.containsKey(t.errorText)&&t.parent.spellChecker.errorWordCollection.remove(t.errorText),t.parent.spellChecker.checkForNextError(),t.documentHelper.hideDialog())},this.changeButtonClicked=function(){i.i(n.isNullOrUndefined)(t.selectedText)||(t.isSpellChecking=!0,i.i(a.showSpinner)(t.documentHelper.dialog.element),t.parent.spellChecker.manageReplace(t.selectedText,t.elementBox),t.removeErrors(),t.parent.spellChecker.checkForNextError(),i.i(a.hideSpinner)(t.documentHelper.dialog.element),t.selectedText=void 0)},this.changeAllButtonClicked=function(){if(!i.i(n.isNullOrUndefined)(t.selectedText)){t.isSpellChecking=!0,i.i(a.showSpinner)(t.documentHelper.dialog.element);for(var e=t.parent.spellChecker.errorWordCollection.get(t.errorText),r=0;r<e.length;r++)if(e[r]instanceof s._2&&!e[r].ischangeDetected)t.parent.spellChecker.manageReplace(t.selectedText,e[r]);else if(e[r]instanceof s.d){var o=t.parent.spellChecker.getMatchedResultsFromElement(e[r]),l=o.textResults,d=e[r].ischangeDetected?e[r].start.offset:e[r].line.getOffset(e[r],0);t.parent.searchModule.textSearch.updateMatchedTextLocation(o.matches,l,o.elementInfo,0,e[r],!1,null,d);for(var h=0;h<l.length;h++){var c=t.parent.spellChecker.createErrorElementWithInfo(l.innerList[h],e[r]);t.parent.spellChecker.manageReplace(t.selectedText,c)}}t.parent.spellChecker.errorWordCollection.containsKey(t.errorText)&&t.parent.spellChecker.errorWordCollection.remove(t.errorText),t.parent.spellChecker.checkForNextError(),t.documentHelper.hideDialog(),i.i(a.hideSpinner)(t.documentHelper.dialog.element),t.selectedText=void 0}},this.documentHelper=e,i.i(a.createSpinner)({target:this.documentHelper.dialog.element,cssClass:"e-spin-overlay"})}return Object.defineProperty(e.prototype,"parent",{get:function(){return this.documentHelper.owner},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"SpellCheckDialog"},e.prototype.removeErrors=function(){if(!i.i(n.isNullOrUndefined)(this.errorText)&&this.parent.spellChecker.errorWordCollection.containsKey(this.errorText)){var e=this.parent.spellChecker.errorWordCollection.get(this.errorText);e.splice(0,1),0===e.length&&this.parent.spellChecker.errorWordCollection.remove(this.errorText)}0===this.parent.spellChecker.errorWordCollection.length&&this.documentHelper.hideDialog()},e.prototype.show=function(e,t){this.target=void 0,this.localValue=new n.L10n("documenteditor",this.documentHelper.owner.defaultLocale),this.localValue.setLocale(this.documentHelper.owner.locale),this.target||this.updateSuggestionDialog(e,t)},e.prototype.updateSuggestionDialog=function(e,t){var i=this;this.elementBox=t;var n;this.isSpellChecking?this.parent.spellChecker.callSpellChecker(this.parent.spellChecker.languageID,e,!1,!0).then(function(t){var r=JSON.parse(t);n=r.Suggestions,i.isSpellChecking=!1,i.handleRetrievedSuggestion(e,n)}):(e=this.parent.spellChecker.manageSpecialCharacters(e,void 0,!0),n=this.parent.spellChecker.errorSuggestions.containsKey(e)?this.parent.spellChecker.errorSuggestions.get(e):[],this.handleRetrievedSuggestion(e,n))},e.prototype.handleRetrievedSuggestion=function(e,t){e=this.parent.spellChecker.manageSpecialCharacters(e,void 0,!0),this.initSpellCheckDialog(this.localValue,e,t),"none"!==this.documentHelper.selection.caret.style.display&&(this.documentHelper.selection.caret.style.display="none"),this.documentHelper.dialog.header=this.localValue.getConstant("Spelling Editor"),this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=this.documentHelper.updateFocus,this.documentHelper.dialog.buttons=[{click:this.onCancelButtonClick,buttonModel:{content:this.localValue.getConstant("Cancel"),cssClass:"e-control e-flat",isPrimary:!0}}],this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show(),i.i(a.hideSpinner)(this.documentHelper.dialog.element)},e.prototype.initSpellCheckDialog=function(e,t,s,a){var l=this.documentHelper.owner.containerId+"_add_SpellCheck";this.target=i.i(n.createElement)("div",{id:l,className:"e-de-insert-spellchecker"}),this.errorText=t;var d=i.i(n.createElement)("div",{className:"e-de-dlg-sub-header",innerHTML:e.getConstant("Spelling")});this.target.appendChild(d);var h=i.i(n.createElement)("div",{className:"e-de-spellcheck-error-container"}),c=i.i(n.createElement)("div",{className:"e-de-dlg-spellcheck-listview"});h.appendChild(c),this.spellingListView=new o.ListView({dataSource:[t],cssClass:"e-dlg-spellcheck-listitem"}),this.spellingListView.appendTo(c);var p=i.i(n.createElement)("div",{className:"e-de-spellcheck-btncontainer"});h.appendChild(p);var u=i.i(n.createElement)("button",{innerHTML:e.getConstant("Ignore")});p.appendChild(u),u.setAttribute("aria-label",e.getConstant("Ignore")),new r.Button({cssClass:"e-control e-de-ok-button e-de-spellcheck-btn"}).appendTo(u),u.addEventListener("click",this.onIgnoreClicked);var g=i.i(n.createElement)("button",{innerHTML:e.getConstant("Ignore All")});g.setAttribute("aria-label",e.getConstant("Ignore All")),p.appendChild(g),new r.Button({cssClass:"e-control e-de-ok-button e-de-spellcheck-btn"}).appendTo(g),g.addEventListener("click",this.onIgnoreAllClicked);var f=i.i(n.createElement)("button",{innerHTML:e.getConstant("Add to Dictionary")});f.setAttribute("aria-label",e.getConstant("Add to Dictionary")),p.appendChild(f),new r.Button({cssClass:"e-control e-de-ok-button e-de-spellcheck-btn"}).appendTo(f),f.addEventListener("click",this.addToDictClicked),this.target.appendChild(h);var m=i.i(n.createElement)("div",{className:"e-de-dlg-sub-header",innerHTML:e.getConstant("Suggestions")});this.target.appendChild(m);var v=i.i(n.createElement)("div",{className:"e-de-spellcheck-suggestion-container"});this.target.appendChild(v);var y=i.i(n.createElement)("div",{className:"e-de-dlg-spellcheck-listview"});y.setAttribute("aria-label",e.getConstant("Suggestions")),v.appendChild(y),this.suggestionListView=new o.ListView({dataSource:s,cssClass:"e-dlg-spellcheck-listitem"}),this.suggestionListView.appendTo(y),this.suggestionListView.addEventListener("select",this.selectHandler);var w=i.i(n.createElement)("div",{className:"e-de-spellcheck-btncontainer"});v.appendChild(w);var b=i.i(n.createElement)("button",{innerHTML:e.getConstant("Change")});b.setAttribute("aria-label",e.getConstant("Change")),w.appendChild(b);var x=new r.Button({cssClass:"e-control e-de-ok-button e-de-spellcheck-btn"});x.appendTo(b),b.addEventListener("click",this.changeButtonClicked);var C=i.i(n.createElement)("button",{innerHTML:e.getConstant("Change All")});C.setAttribute("aria-label",e.getConstant("Change All")),w.appendChild(C);var I=new r.Button({cssClass:"e-control e-de-ok-button e-de-spellcheck-btn"});I.appendTo(C),C.addEventListener("click",this.changeAllButtonClicked),(i.i(n.isNullOrUndefined)(s)||0===s.length)&&(x.disabled=!0,I.disabled=!0)},e.prototype.destroy=function(){this.target&&(this.target.remove(),this.target=void 0),this.elementBox&&(this.elementBox.destroy(),this.elementBox=void 0),this.documentHelper=void 0,this.spellingListView&&(this.spellingListView.destroy(),this.spellingListView=void 0),this.suggestionListView&&(this.suggestionListView.destroy(),this.suggestionListView=void 0),this.selectedText=void 0},e}())},function(e,t,i){"use strict";i.d(t,"a",function(){return d});var n=i(18),r=(i.n(n),i(3)),o=(i.n(r),i(0)),s=(i.n(o),i(5)),a=(i.n(s),i(4)),l=i(17),d=function(){function e(e){var t=this;this.isBarClicked=!1,this.removedItems=[],this.tabStopList=[],this.isAddUnits=!0,this.applyParagraphFormat=function(){if(t.defaultTabStopIn.value!==t.documentHelper.defaultTabWidth&&(t.documentHelper.defaultTabWidth=t.defaultTabStopIn.value),t.removedItems.length>0){for(var e=[],n=0;n<t.removedItems.length;n++)e.push(t.removedItems[parseInt(n.toString(),10)].value);t.documentHelper.owner.editor.removeTabStops(t.documentHelper.selection.getParagraphsInSelection(),e)}var r=i.i(o.isNullOrUndefined)(t.selectedTabStop)?new l.b:t.selectedTabStop.value;r.deletePosition=0,r.tabJustification=t.getTabAlignmentValue(),r.tabLeader=t.getTabLeaderValue();for(var s=[],n=0;n<t.tabStopList.length;n++)s.push(t.tabStopList[parseInt(n.toString(),10)].value);if(i.i(o.isNullOrUndefined)(t.selectedTabStop)){var d=a.a.getNumberFromString(t.textBoxInput.value);"NaN"!==d.toString()&&(r.position=d,s.push(r))}t.documentHelper.owner.editor.onApplyParagraphFormat("tabStop",s,!1,!1),t.closeTabDialog()},this.textBoxInputChange=function(e){for(var i=a.a.getNumberFromString(t.textBoxInput.value),n=0;n<t.tabStopList.length;n++){if(a.a.getNumberFromString(t.tabStopList[parseInt(n.toString(),10)].displayText)===i){t.selectedTabStop=t.tabStopList[parseInt(n.toString(),10)];break}t.selectedTabStop=void 0}t.isAddUnits=!1;var r=t.listviewInstance.dataSource.indexOf(t.selectedTabStop),o=r>=0?t.listviewInstance.dataSource[parseInt(r.toString(),10)]:void 0;t.listviewInstance.selectItem(o),t.isAddUnits=!0},this.setButtonClick=function(e){if(i.i(o.isNullOrUndefined)(t.selectedTabStop)){var n=parseFloat(a.a.getNumberFromString(t.textBoxInput.value).toFixed(2));if("NaN"===n.toString())return;var r=new l.b;r.position=n,r.tabJustification=t.getTabAlignmentValue(),r.tabLeader=t.getTabLeaderValue(),r.deletePosition=0;for(var s=[],d=0;d<t.tabStopList.length;d++)s.push(t.tabStopList[parseInt(d.toString(),10)].value);var h=t.documentHelper.owner.editor.addTabStopToCollection(s,r,!0),c={displayText:parseFloat(n.toFixed(2))+" pt",value:r};t.tabStopList.splice(h,0,c),t.selectedTabStop=c,t.listviewInstance.dataSource=t.tabStopList,t.listviewInstance.refresh(),t.listviewInstance.selectItem(t.selectedTabStop)}else{var n=t.selectedTabStop.value;n.tabJustification=t.getTabAlignmentValue(),n.tabLeader=t.getTabLeaderValue()}},this.clearAllButtonClick=function(e){for(var i=0;i<t.tabStopList.length;i++)t.removedItems.push(t.tabStopList[parseInt(i.toString(),10)]);t.displayDiv.innerText=t.localeValue.getConstant("All"),t.tabStopList=[],t.listviewInstance.dataSource=[],t.listviewInstance.refresh(),t.selectedTabStop=void 0,t.textBoxInput.value="",t.updateButtons()},this.clearButtonClick=function(e){t.removedItems.push(t.selectedTabStop),t.displayDiv.innerText!==t.localeValue.getConstant("All")&&(""!==t.displayDiv.innerText&&(t.displayDiv.innerText+=", "),t.displayDiv.innerText+=t.selectedTabStop.displayText);var n=t.tabStopList.indexOf(t.selectedTabStop);n===t.tabStopList.length-1?(t.tabStopList.splice(n,1),t.selectedTabStop=t.tabStopList[n-1]):0===t.tabStopList.length?t.selectedTabStop=void 0:(t.tabStopList.splice(n,1),t.selectedTabStop=t.tabStopList[parseInt(n.toString(),10)]),t.listviewInstance.refresh(),i.i(o.isNullOrUndefined)(t.selectedTabStop)?t.textBoxInput.value="":t.textBoxInput.value=!i.i(o.isNullOrUndefined)(t.selectedTabStop)&&t.tabStopList.length>0?t.selectedTabStop.displayText:"",t.updateButtons()},this.closeTabDialog=function(){t.documentHelper.hideDialog()},this.selectHandler=function(e){t.isAddUnits&&t.focusTextBox(e.text),t.selectedTabStop=e.data,i.i(o.isNullOrUndefined)(t.selectedTabStop)||"Bar"!==t.selectedTabStop.value.tabJustification||(t.isBarClicked=!0),t.updateButtons()},this.onBarClick=function(e){t.clearTabLeaderButton(),t.disableOrEnableTabLeaderButton(!0),t.isBarClicked=!0},this.onTabAlignmentButtonClick=function(e){t.disableOrEnableTabLeaderButton(!1),t.isBarClicked&&(t.updateTabLeaderButton("None"),t.isBarClicked=!1)},this.documentHelper=e}return e.prototype.getModuleName=function(){return"TabDialog"},e.prototype.initTabsDialog=function(e,t){var a=this.documentHelper.owner.containerId;this.target=i.i(o.createElement)("div",{id:a+"_tab",className:"e-de-tab"});var l=i.i(o.createElement)("div",{className:"e-de-container-row"});this.target.appendChild(l);var d=i.i(o.createElement)("div",{innerHTML:e.getConstant("Tab stop position")+":",className:"e-de-para-dlg-heading"}),h=i.i(o.createElement)("div",{className:"e-de-subcontainer-left"});h.appendChild(d);var c=i.i(o.createElement)("div",{className:"e-tab-list"});h.appendChild(c),t&&c.classList.add("e-de-rtl");var p=i.i(o.createElement)("div",{className:"e-bookmark-textboxdiv"});c.appendChild(p),this.textBoxInput=i.i(o.createElement)("input",{className:"e-input e-tab-textbox-input",attrs:{autofocus:"true"}}),this.textBoxInput.setAttribute("type","text"),this.textBoxInput.setAttribute("aria-label",e.getConstant("Tab stop position")),p.appendChild(this.textBoxInput),p.addEventListener("keyup",this.textBoxInputChange),this.textBoxInput.value=!i.i(o.isNullOrUndefined)(this.tabStopList)&&this.tabStopList.length>0?this.tabStopList[0].displayText:"";var u=i.i(o.createElement)("div",{className:"e-tab-listViewDiv",attrs:{tabindex:"-1"}});u.setAttribute("aria-label",e.getConstant("TabMarkList")),c.appendChild(u),this.listviewInstance=new n.ListView({dataSource:this.tabStopList,fields:{text:"displayText"},cssClass:"e-bookmark-listview"}),this.listviewInstance.appendTo(u),this.listviewInstance.addEventListener("select",this.selectHandler),l.appendChild(h);var g=i.i(o.createElement)("div",{innerHTML:e.getConstant("Default tab stops")+":",className:"e-de-para-dlg-heading"}),f=i.i(o.createElement)("div",{className:"e-de-subcontainer-right"});l.appendChild(f);var m=i.i(o.createElement)("div",{className:"e-de-dlg-container"}),v=i.i(o.createElement)("input",{attrs:{type:"text"}});m.appendChild(g),m.appendChild(v),f.appendChild(m),this.defaultTabStopIn=new s.NumericTextBox({format:"# pt",value:this.documentHelper.defaultTabWidth,min:0,max:1584,step:1,enablePersistence:!1,placeholder:e.getConstant("Default tab stops")}),this.defaultTabStopIn.appendTo(v);var y=i.i(o.createElement)("div",{innerHTML:e.getConstant("Tab stops to be cleared")+":",className:"e-de-dlg-container"});f.appendChild(y),this.displayDiv=i.i(o.createElement)("div",{className:"e-defaultTablabelDiv"}),this.documentHelper.owner.enableRtl?this.displayDiv.style.marginRight="20px":this.displayDiv.style.marginLeft="20px",f.appendChild(this.displayDiv);var w=i.i(o.createElement)("div",{className:"e-de-dlg-container"});this.target.appendChild(w);var b=i.i(o.createElement)("div",{innerHTML:e.getConstant("Alignment")+":",className:"e-de-para-dlg-heading"});w.appendChild(b);var x=i.i(o.createElement)("div",{styles:"display: flex;"});w.appendChild(x);var C=i.i(o.createElement)("div",{styles:"display: flex; flex-direction: column; width: 33.33%"}),I=i.i(o.createElement)("div"),F=i.i(o.createElement)("input",{attrs:{type:"radiobutton"}}),k=i.i(o.createElement)("div"),P=i.i(o.createElement)("input",{attrs:{type:"radiobutton"}});I.appendChild(F),k.appendChild(P),C.appendChild(I),C.appendChild(k),x.appendChild(C),this.left=new r.RadioButton({label:e.getConstant("Left"),name:"alignment",value:"left",cssClass:"e-small",checked:!0,enableRtl:t,change:this.onTabAlignmentButtonClick}),this.decimal=new r.RadioButton({label:e.getConstant("Decimal"),name:"alignment",value:"decimal",cssClass:"e-small",enableRtl:t,change:this.onTabAlignmentButtonClick}),this.left.appendTo(F),this.decimal.appendTo(P),F.setAttribute("aria-label",e.getConstant("Left")),P.setAttribute("aria-label",e.getConstant("Decimal"));var T=i.i(o.createElement)("div",{styles:"display: flex; flex-direction: column; width: 33.33%"}),S=i.i(o.createElement)("div"),W=i.i(o.createElement)("input",{attrs:{type:"radiobutton"}}),N=i.i(o.createElement)("div"),H=i.i(o.createElement)("input",{attrs:{type:"radiobutton"}});N.appendChild(H),S.appendChild(W),T.appendChild(S),T.appendChild(N),this.bar=new r.RadioButton({label:e.getConstant("Bar"),name:"alignment",value:"bar",cssClass:"e-small",enableRtl:t,change:this.onBarClick}),this.center=new r.RadioButton({label:e.getConstant("Center"),name:"alignment",value:"center",cssClass:"e-small",enableRtl:t,change:this.onTabAlignmentButtonClick}),this.bar.appendTo(H),this.center.appendTo(W),H.setAttribute("aria-label",e.getConstant("Bar")),W.setAttribute("aria-label",e.getConstant("Center")),x.appendChild(T);var E=i.i(o.createElement)("div",{styles:"display: flex; flex-direction: column;width: 33.33%"}),O=i.i(o.createElement)("div"),_=i.i(o.createElement)("input",{attrs:{type:"radiobutton"}});O.appendChild(_),E.appendChild(O),this.right=new r.RadioButton({label:e.getConstant("Right"),name:"alignment",value:"right",cssClass:"e-small",enableRtl:t,change:this.onTabAlignmentButtonClick}),this.right.appendTo(_),_.setAttribute("aria-label",e.getConstant("Right")),x.appendChild(E);var B=i.i(o.createElement)("div",{className:"e-de-dlg-container"}),L=i.i(o.createElement)("div",{innerHTML:e.getConstant("Leader")+":",className:"e-de-para-dlg-heading"});B.appendChild(L),this.target.appendChild(B);var R=i.i(o.createElement)("div",{styles:"display: flex;"});B.appendChild(R);var A=i.i(o.createElement)("div",{styles:"display: flex; flex-direction: column; width: 33.33%"}),D=i.i(o.createElement)("div"),U=i.i(o.createElement)("input",{attrs:{type:"radiobutton"}}),M=i.i(o.createElement)("div"),V=i.i(o.createElement)("input",{attrs:{type:"radiobutton"}});D.appendChild(U),M.appendChild(V),A.appendChild(D),A.appendChild(M),this.none=new r.RadioButton({label:"1 "+e.getConstant("None"),name:"tabLeader",value:"none",cssClass:"e-small",checked:!0,enableRtl:t}),this.underscore=new r.RadioButton({label:"4 _____",name:"tabLeader",value:"underscore",cssClass:"e-small",enableRtl:t}),this.none.appendTo(U),this.underscore.appendTo(V),R.appendChild(A);var z=i.i(o.createElement)("div",{styles:"display: flex; flex-direction: column; width: 33.33%"}),j=i.i(o.createElement)("div"),q=i.i(o.createElement)("input",{attrs:{type:"radiobutton"}}),G=i.i(o.createElement)("div"),K=i.i(o.createElement)("input",{attrs:{type:"radiobutton"}});j.appendChild(q),G.appendChild(K),this.dotted=new r.RadioButton({label:"2 .......",name:"tabLeader",value:"dotted",cssClass:"e-small",enableRtl:t}),this.single=new r.RadioButton({label:"5 -------",name:"tabLeader",value:"single",cssClass:"e-small",enableRtl:t}),this.dotted.appendTo(q),this.single.appendTo(K),z.appendChild(j),z.appendChild(G),R.appendChild(z);var Z=i.i(o.createElement)("div",{styles:"display: flex; flex-direction: column; width: 33.33%"}),X=i.i(o.createElement)("div"),J=i.i(o.createElement)("input",{attrs:{type:"radiobutton"}});X.appendChild(J),Z.appendChild(X),this.Hyphen=new r.RadioButton({label:"3 -------",name:"tabLeader",value:"hyphen",cssClass:"e-small",enableRtl:t}),this.Hyphen.appendTo(J),R.appendChild(Z);var Y=i.i(o.createElement)("div",{className:"e-de-tab-button",styles:"display: flex;"});this.target.appendChild(Y);var Q=i.i(o.createElement)("table");Y.appendChild(Q),Q.style.width="100%";var $=Q.insertRow(),ee=$.insertCell(),te=i.i(o.createElement)("div",{className:"e-de-tab-setBtn"});Y.appendChild(te);var ie=i.i(o.createElement)("button",{innerHTML:e.getConstant("Set"),attrs:{type:"button"}});ie.setAttribute("aria-label",e.getConstant("Set")),te.appendChild(ie),this.setButton=new r.Button({cssClass:"e-button-custom"}),this.setButton.appendTo(ie),ee.appendChild(te),ie.addEventListener("click",this.setButtonClick),ee.style.width="33.33%",ee.style.display="table-cell",ee=$.insertCell();var ne=i.i(o.createElement)("div",{className:"e-de-tab-clearBtn"});Y.appendChild(ne);var re=i.i(o.createElement)("button",{innerHTML:e.getConstant("Clear"),attrs:{type:"button"}});re.setAttribute("aria-label",e.getConstant("Clear")),ne.appendChild(re),this.clearButton=new r.Button({cssClass:"e-button-custom"}),this.clearButton.appendTo(re),re.addEventListener("click",this.clearButtonClick),ee.appendChild(ne),ee.style.width="33.33%",ee.style.display="table-cell",ee=$.insertCell();var oe=i.i(o.createElement)("div",{className:"e-de-tab-clearAllBtn"});Y.appendChild(oe);var se=i.i(o.createElement)("button",{innerHTML:e.getConstant("Clear All"),attrs:{type:"button"}});se.setAttribute("aria-label",e.getConstant("Clear All")),oe.appendChild(se),this.clearAllButton=new r.Button({cssClass:"e-button-custom"}),this.clearAllButton.appendTo(se),se.addEventListener("click",this.clearAllButtonClick),ee.appendChild(oe),ee.style.width="33.33%",ee.style.display="table-cell",this.selectedTabStop=!i.i(o.isNullOrUndefined)(this.tabStopList)&&this.tabStopList.length>0?this.tabStopList[0]:void 0,this.updateButtons()},e.prototype.getTabAlignmentValue=function(){return this.left.checked?"Left":this.center.checked?"Center":this.right.checked?"Right":this.decimal.checked?"Decimal":this.bar.checked?"Bar":"Left"},e.prototype.getTabLeaderValue=function(){return this.none.checked?"None":this.dotted.checked?"Dot":this.Hyphen.checked?"Hyphen":this.underscore.checked?"Underscore":this.single.checked?"Single":"None"},e.prototype.updateButtons=function(){i.i(o.isNullOrUndefined)(this.selectedTabStop)?(this.updateTabAlignmentButton("Left"),this.updateTabLeaderButton("None")):(this.updateTabAlignmentButton(this.selectedTabStop.value.tabJustification),this.updateTabLeaderButton(this.selectedTabStop.value.tabLeader))},e.prototype.updateTabLeaderButton=function(e){if(this.clearTabLeaderButton(),"Bar"!==this.getTabAlignmentValue())switch(e){case"None":this.none.checked=!0;break;case"Single":this.single.checked=!0;break;case"Dot":this.dotted.checked=!0;break;case"Hyphen":this.Hyphen.checked=!0;break;case"Underscore":this.underscore.checked=!0;break;default:this.none.checked=!0}},e.prototype.updateTabAlignmentButton=function(e){switch(this.clearTabAlignmentButton(),e){case"Left":this.left.checked=!0;break;case"Center":this.center.checked=!0;break;case"Right":this.right.checked=!0;break;case"Decimal":this.decimal.checked=!0;break;case"Bar":return this.bar.checked=!0,this.clearTabLeaderButton(),void this.disableOrEnableTabLeaderButton(!0)}this.disableOrEnableTabLeaderButton(!1)},e.prototype.clearTabLeaderButton=function(){this.none.checked=!1,this.single.checked=!1,this.dotted.checked=!1,this.Hyphen.checked=!1,this.underscore.checked=!1},e.prototype.disableOrEnableTabLeaderButton=function(e){this.none.disabled=e,this.single.disabled=e,this.dotted.disabled=e,this.Hyphen.disabled=e,this.underscore.disabled=e},e.prototype.clearTabAlignmentButton=function(){this.left.checked=!1,this.center.checked=!1,this.right.checked=!1,this.decimal.checked=!1,this.bar.checked=!1},e.prototype.focusTextBox=function(e){this.textBoxInput.value=e;var t=this.textBoxInput;t.setSelectionRange(0,e.length),t.focus()},e.prototype.show=function(){var e=new o.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),this.localeValue=e;var t=this.documentHelper.owner.editor.getTabsInSelection();this.tabStopList=[];for(var i=0;i<t.length;i++){var n=parseFloat(t[i].position.toFixed(2))+" pt",r={displayText:n,value:t[i].clone()};this.tabStopList.push(r)}this.initTabsDialog(e,this.documentHelper.owner.enableRtl),this.documentHelper.dialog.header=e.getConstant("Tabs"),this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=this.documentHelper.updateFocus,this.documentHelper.dialog.close=this.documentHelper.updateFocus,this.documentHelper.dialog.buttons=[{click:this.applyParagraphFormat,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-para-okay",isPrimary:!0}},{click:this.closeTabDialog,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-para-cancel"}}],this.documentHelper.dialog.show()},e.prototype.destroy=function(){this.target=void 0,this.textBoxInput=void 0,this.defaultTabStopIn=void 0,this.left=void 0,this.right=void 0,this.center=void 0,this.decimal=void 0,this.bar=void 0,this.none=void 0,this.dotted=void 0,this.single=void 0,this.Hyphen=void 0,this.setButton=void 0,this.clearButton=void 0,this.clearAllButton=void 0,this.listviewInstance&&(this.listviewInstance.destroy(),this.listviewInstance=void 0),this.selectedTabStop=void 0,this.isBarClicked=void 0,this.removedItems=void 0,this.tabStopList=void 0,this.localeValue=void 0},e}()},function(e,t,i){"use strict";i.d(t,"a",function(){return l});var n=i(0),r=(i.n(n),i(29)),o=i(2),s=i(16),a=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),l=function(e){function t(t,i){var n=e.call(this,t)||this;return n.isChildHistoryInfo=!1,n.editRangeStart=void 0,n.documentHelper=t.documentHelper,n.isChildHistoryInfo=i,n}return a(t,e),Object.defineProperty(t.prototype,"hasAction",{get:function(){return!i.i(n.isNullOrUndefined)(this.modifiedActions)},enumerable:!0,configurable:!0}),t.prototype.addModifiedAction=function(e){this.editorHistory.isUndoing||this.editorHistory.isRedoing||(i.i(n.isNullOrUndefined)(this.modifiedActions)&&(this.modifiedActions=[]),this.modifiedActions.push(e))},t.prototype.getActionInfo=function(e){var r=this.action,a=[];switch(r){case"InsertBookmark":case"RestrictEditing":if(this.editorHistory.isUndoing)for(var l=0;l<this.modifiedActions.length;l++)"RestrictEditing"==r&&this.modifiedActions[parseInt(l.toString(),10)].markerData.push(this.owner.editor.getMarkerData(this.modifiedActions[parseInt(l.toString(),10)].removedNodes[0])),a.push(this.modifiedActions[parseInt(l.toString(),10)].getDeleteOperation("DeleteBookmark",0==l||void 0)),this.modifiedActions[parseInt(l.toString(),10)].markerData.shift();else for(var d=0;d<this.modifiedActions.length;d++){var h=this.modifiedActions[parseInt(d.toString(),10)];"DeleteBookmark"!==h.action?a.push(h.getInsertOperation(r)):(a.push(h.getDeleteOperation("DeleteBookmark")),a.push(h.getDeleteOperation("DeleteBookmark",!0)))}break;case"BackSpace":case"Delete":case"RemoveEditRange":if(this.editorHistory.isUndoing){for(var c=0;c<this.modifiedActions.length;c++){var p=this.modifiedActions[parseInt(c.toString(),10)];if("InsertInline"===p.action){var u=p.getDeleteOperation("DeleteBookmark",!0);a.push(u)}else{var g=p.getActionInfo();a=a.concat(g),"RemoveEditRange"===p.action&&a.push(p.getDeleteOperation(r,!0))}}a.reverse()}else for(var f=0;f<this.modifiedActions.length;f++){var m=this.modifiedActions[parseInt(f.toString(),10)];if("InsertInline"===m.action){var u=m.getInsertOperation("InsertBookmark");a.push(u)}else a.push(m.getDeleteOperation(r)),"RemoveEditRange"===m.action&&a.push(m.getDeleteOperation(r,!0))}break;case"PageBreak":case"ColumnBreak":if(this.owner.enableTrackChanges)for(var v=0;v<this.modifiedActions.length;v++){var y=this.modifiedActions[parseInt(v.toString(),10)];y.removedNodes.length>0&&(a=a.concat(y.getDeleteOperationsForTrackChanges()));var w=y.markerData[y.markerData.length-1],b=y.getInsertOperation("Enter"),x=this.getInsertOperation(r);b.markerData=w,x.markerData=this.owner.editor.getMarkerData(void 0,void 0,this.owner.editor.getRevision(w.revisionId)),a.push(b),a.push(x),a.push(b),b.markerData.skipOperation=!0}else if(this.editorHistory.isUndoing)for(var C=0;C<3;C++)a.push(this.getDeleteOperation("Delete"));else{for(var I=0;I<this.modifiedActions.length;I++){var F=this.modifiedActions[parseInt(I.toString(),10)];F.removedNodes.length>0&&a.push(F.getDeleteOperation(r))}a.push(this.getInsertOperation("Enter")),a.push(this.getInsertOperation(r)),a.push(this.getInsertOperation("Enter"))}break;case"InsertHyperlink":case"AutoFormatHyperlink":case"RemoveHyperlink":for(var k=0;k<this.modifiedActions.length;k++){var P=this.modifiedActions[parseInt(k.toString(),10)];"InsertInline"===P.action?P.insertedText===s.c.Marker_Start||P.insertedText===s.c.Marker_End?a.push(P.getInsertOperation("InsertHyperlink")):a.push(P.getInsertOperation("Insert")):"Delete"===P.action?a.push(P.getDeleteOperation(P.action)):"Underline"!==P.action&&"FontColor"!==P.action||(a=a.concat(P.getActionInfo()))}break;case"InsertComment":if(this.editorHistory.isUndoing)this.getDeleteCommentOperation(this.modifiedActions,a);else for(var T=0;T<this.modifiedActions.length;T++){var S=this.modifiedActions[parseInt(T.toString(),10)],W=S.getInsertOperation(S.action);S.insertedElement instanceof o.B&&"InsertInline"===S.action?a.push(S.getCommentOperation(W,S.action)):"InsertCommentWidget"===S.action&&(W=this.getUpdateOperation(),a.push(S.getCommentOperation(W,S.action)))}break;case"RemoveComment":if(this.editorHistory.isUndoing)for(var N=this.modifiedActions.length-1;N>=0;N--){var H=this.modifiedActions[parseInt(N.toString(),10)],E=void 0,g=[];"InsertInline"===H.action&&H.insertedElement instanceof o.B?(E=H.getDeleteOperation(H.action),g.push(H.getCommentOperation(E,"InsertInline"))):"RemoveInline"===H.action?(E=H.getDeleteOperation(H.action),g.push(H.getCommentOperation(E,"InsertInline")),E=H.getInsertOperation(H.action),g.push(H.getCommentOperation(E,"InsertInline"))):"DeleteComment"===H.action?g=H.getActionInfo():(this.owner.sfdtExportModule.iscommentInsert=!1,g=H.getActionInfo(),this.owner.sfdtExportModule.iscommentInsert=!0),a=a.concat(g)}else for(var O=0;O<this.modifiedActions.length;O++){var _=this.modifiedActions[parseInt(O.toString(),10)],B=void 0,g=[];"RemoveInline"===_.action&&_.removedNodes[0]instanceof o.B?(B=_.getDeleteOperation(_.action),g.push(_.getCommentOperation(B,_.action))):"InsertInline"===_.action&&_.insertedElement instanceof o.B?(B=_.getInsertOperation(_.action),g.push(_.getCommentOperation(B,_.action))):g=_.getActionInfo(),a=a.concat(g)}break;case"DeleteComment":if(this.editorHistory.isUndoing)for(var L=this.modifiedActions.length-1;L>=0;L--){var R=this.modifiedActions[parseInt(L.toString(),10)],A=R.getInsertOperation(R.action);R.insertedElement instanceof o.B&&"RemoveInline"===R.action?a.push(R.getCommentOperation(A,"InsertInline")):"DeleteCommentWidget"===R.action?(A=this.getUpdateOperation(),a.push(R.getCommentOperation(A,"InsertCommentWidget"))):"DeleteComment"===R.action&&R.getActionInfo()}else this.getDeleteCommentOperation(this.modifiedActions,a);break;case"FormField":var P=this.modifiedActions.pop();a=P.getFieldOperation();break;case"IMEInput":if(e){if(this.modifiedActions[0].removedNodes.length>0){var D=this.modifiedActions[0].getDeleteOperation("Delete");D.length=D.text.length,a.push(D)}var U=this.modifiedActions[this.modifiedActions.length-1].getInsertOperation("Insert");U.length=U.text.length,a.push(U),a.reverse();for(var M=0;M<a.length;M++){var V=a[parseInt(M.toString(),10)];"Insert"===V.action?V.action="Delete":"Delete"===V.action&&(V.action="Insert")}}else{var z=this.modifiedActions[this.modifiedActions.length-1];z.removedNodes.length>0&&a.push(z.getDeleteOperation(r)),a.push(z.getInsertOperation(this.action))}break;case"Accept All":case"ReplaceAll":case"Reject All":for(var j=0;j<this.modifiedActions.length;j++){var q=this.modifiedActions[parseInt(j.toString(),10)];if(!i.i(n.isNullOrUndefined)(q.cellOperation)&&q.cellOperation.length>0)a.push(q.cellOperation[0]),!0;else{var G=q.getActionInfo();a.push.apply(a,G)}}break;case"Paste":for(var K=0;K<this.modifiedActions.length;K++){var Z=this.modifiedActions[parseInt(K.toString(),10)];Z.type="PasteToc"===this.type?this.type:"Paste";var X=Z.getActionInfo();a.push.apply(a,X)}break;case"TOC":for(var J=0;J<this.modifiedActions.length;J++){var Y=this.modifiedActions[parseInt(J.toString(),10)];Y.type="Paste"===Y.action?"PasteToc":void 0;var Q=Y.getActionInfo();a.push.apply(a,Q)}break;case"DragAndDropContent":for(var $=0;$<this.modifiedActions.length;$++){var ee=this.modifiedActions[parseInt($.toString(),10)];ee.type="Paste"===ee.action?"Paste":void 0;var te=ee.getActionInfo();a.push.apply(a,te)}break;case"ClearFormat":a=this.modifiedActions[this.modifiedActions.length-1].buildFormatOperation("ClearFormat",!0).slice();break;case"ApplyStyle":var ie=void 0,ne=[];if(this.modifiedActions[0]instanceof t){ie=this.modifiedActions[0].modifiedActions[0],ne=ie.buildFormatOperation("ClearFormat",!0),a=ne.slice()}if(!(this.modifiedActions[this.modifiedActions.length-1]instanceof t)){ne=this.modifiedActions[this.modifiedActions.length-1].buildFormatOperation(r,!0);for(var re=0;re<ne.length;re++)a.push(ne[parseInt(re.toString(),10)])}break;case"TableMarginsSelection":this.modifiedActions[this.modifiedActions.length-1].createTableFormat(this.modifiedActions[this.modifiedActions.length-1].action),this.modifiedActions[this.modifiedActions.length-1].type="TableFormat",a.push(this.modifiedActions[this.modifiedActions.length-1].getFormatOperation());break;case"BordersAndShading":"TableFormat"===this.modifiedActions[0].action?(this.modifiedActions[0].type="TableFormat",this.modifiedActions[0].createTableFormat("BordersAndShading"),a.push(this.modifiedActions[0].getFormatOperation())):(this.modifiedActions[0].createCellFormat("BordersAndShading"),this.modifiedActions[0].type="CellFormat",a=this.modifiedActions[0].getSelectedCellOperation("BordersAndShading",void 0,!0,!0));break;case"AutoList":for(var oe=0;oe<this.modifiedActions.length;oe++){var se=this.modifiedActions[parseInt(oe.toString(),10)],ae=se.getActionInfo();a.push.apply(a,ae)}break;case"TableProperties":for(var le=0;le<this.modifiedActions.length;le++){var de=this.modifiedActions[parseInt(le.toString(),10)];if("TableFormat"===de.action)de.createTableFormat(de.action),de.type="TableFormat",a.push(de.getFormatOperation());else if("RowFormat"===de.action)de.createRowFormat(de.action),de.type="RowFormat",a.push(de.getFormatOperation());else if("CellFormat"===de.action){de.createCellFormat(de.action),de.type="CellFormat";for(var he=de.getSelectedCellOperation(de.action),ce=0;ce<he.length;ce++)a.push(he[parseInt(ce.toString(),10)])}}break;case"CellMarginsSelection":this.modifiedActions[this.modifiedActions.length-1].createCellFormat("CellOptions"),this.modifiedActions[this.modifiedActions.length-1].type="CellFormat",a=this.modifiedActions[this.modifiedActions.length-1].getSelectedCellOperation("CellOptions").slice()}return a},t.prototype.revert=function(){if(this.editorHistory.currentHistoryInfo=this,"BordersAndShading"===this.action&&(this.owner.editorModule.isBordersAndShadingDialog=!0),!i.i(n.isNullOrUndefined)(this.modifiedActions))if(this.editorHistory.isUndoing)for(var e=this.modifiedActions.length;e>0;){var t=this.modifiedActions[e-1];t.revert(),e-=1}else for(var e=0;e<this.modifiedActions.length;){var t=this.modifiedActions[parseInt(e.toString(),10)];t.revert(),e+=1}if("RestrictEditing"===this.action){var r=""!==this.editRangeStart.user?this.editRangeStart.user:this.editRangeStart.group;if(this.editorHistory.isUndoing){var o=this.owner.documentHelper.editRanges.get(r).indexOf(this.editRangeStart);-1!==o&&this.owner.documentHelper.editRanges.get(r).splice(o,1)}else this.owner.editor.updateRangeCollection(this.editRangeStart,r);this.owner.selection.updateEditRangeCollection()}this.isChildHistoryInfo?this.editorHistory.updateComplexHistoryInternal():this.editorHistory.updateComplexHistory()},t.prototype.destroy=function(){if(!i.i(n.isNullOrUndefined)(this.modifiedActions)){for(;this.modifiedActions.length>0;){var t=this.modifiedActions[this.modifiedActions.length-1];t.destroy(),this.modifiedActions.splice(this.modifiedActions.indexOf(t),1)}this.modifiedActions=void 0}e.prototype.destroy.call(this)},t}(r.a)},function(e,t,i){"use strict";i.d(t,"a",function(){return s});var n=i(7),r=i(0),o=(i.n(r),i(4)),s=function(){function e(e){this.resizeNode=0,this.resizerPosition=-1,this.currentResizingTable=void 0,this.owner=e,this.documentHelper=this.owner.documentHelper,this.startingPoint=new o.b(0,0)}return Object.defineProperty(e.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"TableResizer"},e.prototype.updateResizingHistory=function(e){this.owner.editorHistory&&this.owner.editorHistory.updateResizingHistory(e,this),this.documentHelper.isRowOrCellResizing=!1,this.resizerPosition=-1},e.prototype.handleResize=function(e){this.owner.documentHelper.isRowOrCellResizing=!0,this.startingPoint.x=e.x,this.startingPoint.y=e.y,this.owner.editorHistory.initResizingHistory(e,this)},e.prototype.isInRowResizerArea=function(e){var t=this.getRowReSizerPosition(void 0,e);return-1!==t&&(this.resizeNode=1,this.resizerPosition=t,!0)},e.prototype.isInCellResizerArea=function(e){var t=this.getCellReSizerPosition(e);return-1!==t&&(this.resizeNode=0,this.resizerPosition=t,!0)},e.prototype.getCellReSizerPosition=function(e){var t=-1,n=this.getTableWidget(e),s=this.getTableCellWidget(e),a=i.i(r.isNullOrUndefined)(n)?0:n.tableFormat.cellSpacing;if(n&&a>0){if(this.currentResizingTable=n,this.documentHelper.isInsideRect(n.x-o.a.convertPointToPixel(n.leftBorderWidth)-.25,n.y,o.a.convertPointToPixel(n.leftBorderWidth)+.5,n.height,e))return t=0;for(var l=n.x,d=0;d<n.tableHolder.columns.length;d++){var h=o.a.convertPointToPixel(n.tableHolder.columns[parseInt(d.toString(),10)].preferredWidth);if(this.documentHelper.isInsideRect(l-1,n.y,n.leftBorderWidth+2,n.height,e))return t=d>0?d:0;if(d>0&&this.documentHelper.isInsideRect(l+h-1,n.y,2,n.height,e))return t=d+1;l+=h}}else if(!i.i(r.isNullOrUndefined)(s)){if(this.currentResizingTable=s.ownerTable,this.documentHelper.isInsideRect(s.x-s.margin.left-1,s.y-s.margin.top,2,s.height+s.margin.top+s.margin.bottom,e))return t=s.columnIndex;if(i.i(r.isNullOrUndefined)(s.nextRenderedWidget)&&this.documentHelper.isInsideRect(s.x+s.margin.right+s.width-1,s.y-s.margin.top,2,s.height+s.margin.top+s.margin.bottom,e))return t=s.columnIndex+s.cellFormat.columnSpan;if(s.childWidgets.length>0)return this.getCellReSizerPositionInternal(s,e)}return t},e.prototype.getCellReSizerPositionInternal=function(e,t){var n=-1,s=this.getTableWidgetFromWidget(t,e),a=void 0;if(!i.i(r.isNullOrUndefined)(s)&&s.tableFormat.cellSpacing>0){if(this.currentResizingTable=s,this.documentHelper.isInsideRect(s.x-s.leftBorderWidth-.25,s.y,s.leftBorderWidth+.5,s.height,t))return n=0;for(var l=s.x,d=0;d<s.tableHolder.columns.length;d++){var h=o.a.convertPointToPixel(s.tableHolder.columns[parseInt(d.toString(),10)].preferredWidth);if(this.documentHelper.isInsideRect(l-1,s.y,s.leftBorderWidth+2,s.height,t))return n=d>0?d:0;if(d>0&&this.documentHelper.isInsideRect(l+h-1,s.y,2,s.height,t))return n=d+1;l+=h}}else if(i.i(r.isNullOrUndefined)(s)||(a=s.getTableCellWidget(t)),!i.i(r.isNullOrUndefined)(a)){if(this.currentResizingTable=a.ownerTable,this.documentHelper.isInsideRect(a.x-a.margin.left-1,a.y-a.margin.top,2,a.height,t))return n=a.columnIndex;if(i.i(r.isNullOrUndefined)(a.nextRenderedWidget)&&this.documentHelper.isInsideRect(a.x+a.margin.right+a.width-1,a.y-a.margin.top,2,a.height,t))return n=a.columnIndex+a.cellFormat.columnSpan;if(a.childWidgets.length>0)return this.getCellReSizerPositionInternal(a,t)}return n},e.prototype.getRowReSizerPosition=function(e,t){var n=void 0,o=void 0;i.i(r.isNullOrUndefined)(e)?(n=this.getTableWidget(t),o=this.getTableCellWidget(t)):n=this.getTableWidgetFromWidget(t,e);var s=i.i(r.isNullOrUndefined)(n)?0:n.tableFormat.cellSpacing;if(n&&s>0){if(this.currentResizingTable=n,this.owner.documentHelper.isInsideRect(n.x,n.y+n.height-s,this.getActualWidth(n.lastChild),i.i(r.isNullOrUndefined)(n.nextSplitWidget)?n.bottomBorderWidth+s:0,t))return n.lastChild.rowIndex;for(var a=0;a<n.childWidgets.length;a++){var l=n.childWidgets[parseInt(a.toString(),10)];if(n.childWidgets.indexOf(l)>-1&&this.owner.documentHelper.isInsideRect(l.x,l.y+l.height+s/2,this.getActualWidth(l),s/2,t))return l.rowIndex}}else if(n&&o&&(o=this.getTableCellWidget(t)),o){var l=o.containerWidget,d=0;if(d=l.rowIndex===l.ownerTable.childWidgets.length-1?l.bottomBorderWidth+2:l.nextRenderedWidget.topBorderWidth+2,this.owner.documentHelper.isInsideRect(l.x,l.y+l.height-d,l.width,2*d,t))return this.currentResizingTable=l.ownerTable,l.rowIndex;if(o.childWidgets.length>0)return this.getRowReSizerPosition(o,t)}return-1},e.prototype.handleResizing=function(e,t,i){this.owner.isShiftingEnabled=!0,t?0===this.resizeNode&&this.resizeTableCellColumn(i):0===this.resizeNode?(i=e.x-this.startingPoint.x,this.resizeTableCellColumn(i)):(i=e.y-this.startingPoint.y,this.resizeTableRow(i))},e.prototype.resizeTableRow=function(e){var t=this.currentResizingTable;if(!i.i(r.isNullOrUndefined)(t)&&0!==e&&-1!==this.resizerPosition){var n=this.owner.selection;t.isInsideTable&&(this.owner.isLayoutEnabled=!1);var s=void 0;if(this.resizerPosition>-1&&(s=t.childWidgets[this.resizerPosition],s&&this.updateRowHeight(s,e),n.selectPosition(n.start,n.end)),t.isInsideTable){var a=this.owner.documentHelper.layout.getParentTable(t);this.owner.isLayoutEnabled=!0,t=a}this.startingPoint.y+=o.a.convertPointToPixel(e),this.owner.documentHelper.layout.reLayoutTable(t),this.owner.editorModule.isSkipOperationsBuild=!0,this.owner.editorModule.reLayout(this.owner.selection),this.owner.editorModule.isSkipOperationsBuild=!1,s&&this.getRowReSizerPosition(void 0,this.startingPoint),!this.currentResizingTable||void 0!==this.currentResizingTable.childWidgets&&void 0!==this.currentResizingTable.childWidgets[this.resizerPosition]||(this.resizerPosition=-1)}},e.prototype.getTableWidget=function(e){var t=void 0,n=this.owner.documentHelper.currentPage;if(!i.i(r.isNullOrUndefined)(n))for(var o=0;o<n.bodyWidgets.length;o++){var s=n.bodyWidgets[parseInt(o.toString(),10)];if(t=this.getTableWidgetFromWidget(e,s),!i.i(r.isNullOrUndefined)(t))break;if("Pages"===this.documentHelper.owner.layoutType){var a=n.headerWidget;if(t=this.getTableWidgetFromWidget(e,a),!i.i(r.isNullOrUndefined)(t))break;var l=n.footerWidget;if(t=this.getTableWidgetFromWidget(e,l),!i.i(r.isNullOrUndefined)(t))break}}return t},e.prototype.getTableWidgetFromWidget=function(e,t){for(var i=0;i<t.childWidgets.length;i++)if(t.childWidgets[parseInt(i.toString(),10)]instanceof n.r){var r=t.childWidgets[parseInt(i.toString(),10)],o=0;if(r.wrapTextAround&&(o=r.getTableCellWidth()),!r.wrapTextAround&&r.y<=e.y&&r.y+r.height>=e.y)return r;if(r.wrapTextAround&&r.x<=e.x&&r.x+o>=e.x&&r.y<=e.y&&r.y+r.height>=e.y)return r}},e.prototype.getTableCellWidget=function(e){var t=void 0,n=this.owner.documentHelper.currentPage;if(!i.i(r.isNullOrUndefined)(n))for(var o=0;o<n.bodyWidgets.length;o++){var s=n.bodyWidgets[parseInt(o.toString(),10)];if(t=s.getTableCellWidget(e),!i.i(r.isNullOrUndefined)(t))break;if("Pages"===this.documentHelper.owner.layoutType&&this.viewer.owner.enableHeaderAndFooter){var a=n.headerWidget;if(t=a.getTableCellWidget(e),!i.i(r.isNullOrUndefined)(t))break;var l=n.footerWidget;if(t=l.getTableCellWidget(e),!i.i(r.isNullOrUndefined)(t))break}}return t},e.prototype.updateRowHeight=function(e,t){var i=e.rowFormat;if("Auto"===i.heightType){i.heightType="AtLeast";var n=i.ownerBase,r=this.owner.documentHelper.layout.getRowHeight(n,[n]);r+t>=2.7&&i.height!==r+t&&(i.height=r+t)}else i.height+t>=2.7&&i.height!==i.height+t&&(i.height=i.height+t)},e.prototype.resizeTableCellColumn=function(e){var t=this.currentResizingTable;if(!(i.i(r.isNullOrUndefined)(t)||0===e||i.i(r.isNullOrUndefined)(t.childWidgets)||this.resizerPosition<0)){var n=!0,s=this.owner.selection;this.owner.editor.setOffsetValue(s),t=t.combineWidget(this.viewer),this.owner.isLayoutEnabled=!1,this.setPreferredWidth(t);var a=t.getOwnerWidth(!0),l=t.leftIndent,d=t.tableFormat.tableAlignment;if(s.isEmpty||(n=this.resizeColumnWithSelection(s,t,e)),!n)return void this.updateGridValue(t,!0);if(0===this.resizerPosition){var h=this.resizerPosition,c=t.tableHolder.columns[parseInt(h.toString(),10)],p=c.preferredWidth;if(e>0){var u=e;do{var g=o.a.round(c.preferredWidth-e,1);if(g>=c.minWidth){c.preferredWidth=g,l=t.leftIndent+e,l=l>=-1440?l<=1440?l:1440:-1440;break}u=e,e+=g-c.minWidth}while(e!==u)}else{var u=e;do{var g=o.a.round(c.preferredWidth-e,1);if(g<=2112){c.preferredWidth=g,l=t.leftIndent+e,l=l>=-1440?l<=1440?l:1440:-1440;break}u=e,e-=g-2112}while(e!==u)}var f=e;"Left"!==d&&t.tableHolder.getTotalWidth(0)>a&&"Auto"===t.tableFormat.preferredWidthType&&(t.tableHolder.isFitColumns(a,t.tableHolder.tableWidth,"Auto"===t.tableFormat.preferredWidthType)?t.tableHolder.fitColumns(a,t.tableHolder.tableWidth,"Auto"===t.tableFormat.preferredWidthType,t.tableFormat.allowAutoFit):c.preferredWidth=p,f=0),"Center"===d&&(t.tableHolder.getTotalWidth(0)<a||"Auto"!==t.tableFormat.preferredWidthType)&&(f/=2),t.tableFormat.leftIndent="Left"===d?l:0,t.tableHolder.tableWidth=t.tableHolder.getTotalWidth(0),this.updateCellPreferredWidths(t),"Auto"!==t.tableFormat.preferredWidthType&&t.updateWidth(e),this.updateGridValue(t,!0,f)}else if(null!==t&&this.resizerPosition===t.tableHolder.columns.length)this.resizeColumnAtLastColumnIndex(t,e,a);else{if(-1===this.resizerPosition)return void(this.owner.isLayoutEnabled=!0);this.resizeCellAtMiddle(t,e)}this.owner.isLayoutEnabled=!0,s.selectPosition(s.start,s.end)}},e.prototype.resizeColumnWithSelection=function(e,t,i){var n=this.getTableCellWidget(this.startingPoint);if(n&&(e.selectedWidgets.containsKey(n)||n.previousWidget&&e.selectedWidgets.containsKey(n.previousWidget))){var r=e.getSelectedCells();if(0===this.resizerPosition)this.resizeColumnAtStart(t,i,r);else if(null!==t&&this.resizerPosition===t.tableHolder.columns.length){for(var o=this.getColumnCells(t,this.resizerPosition,!0),s=0;s<o.length;s++){var a=o[parseInt(s.toString(),10)];-1!==r.indexOf(a)&&this.increaseOrDecreaseWidth(a,i,!0)}this.updateRowsGridAfterWidth(t),t.updateWidth(i),t.tableFormat.allowAutoFit=!1,this.updateGridValue(t,!0,i)}else{if(-1===this.resizerPosition)return!1;var l=this.resizerPosition,o=this.getColumnCells(t,l,!0),d=this.getColumnCells(t,l,!1),h=this.isColumnSelected(t,l);if(o.length>0&&!h)for(var s=0;s<o.length;s++)-1===r.indexOf(o[parseInt(s.toString(),10)])&&(o.splice(s,1),s--);if(d.length>0&&!h)for(var s=0;s<d.length;s++)-1===r.indexOf(d[parseInt(s.toString(),10)])&&(d.splice(s,1),s--);if(0===o.length&&d.length>0)for(var s=0;s<d.length;s++){var a=d[parseInt(s.toString(),10)];a.previousWidget&&o.push(a.previousWidget)}else if(0===d.length&&o.length>0)for(var s=0;s<o.length;s++){var a=o[parseInt(s.toString(),10)];a.nextWidget&&d.push(a.nextWidget)}this.changeWidthOfCells(t,o,d,i),t.tableFormat.allowAutoFit&&t.updateWidth(i),t.tableFormat.allowAutoFit=!1,this.updateGridValue(t,!0,i)}e.selectPosition(e.start,e.end)}return!1},e.prototype.resizeColumnAtStart=function(e,t,i){var n=e.leftIndent,r=i[0].ownerRow,o=r.rowFormat;if(o.beforeWidth>0){var s=o.beforeWidth+t;if(s>0)this.updateGridBefore(r,t);else{var a=this.getLeastGridBefore(e,r);if(s<a&&0!==s){n=e.leftIndent+s,e.tableFormat.leftIndent=n>=-1440?n<=1440?n:1440:-1440;for(var l=0;l<e.childWidgets.length;l++){var d=e.childWidgets[parseInt(l.toString(),10)];r!==d&&this.updateGridBefore(d,-s)}}}}else if(t<0)n=e.leftIndent+t,e.tableFormat.leftIndent=n>=-1440?n<=1440?n:1440:-1440,this.updateWidthForCells(e,i,t);else{var a=this.getLeastGridBefore(e,r),h=e.tableFormat.leftIndent;if(0===h)for(var l=0;l<e.childWidgets.length;l++){var d=e.childWidgets[parseInt(l.toString(),10)];-1!==i.indexOf(d.childWidgets[0])&&(this.updateGridBefore(d,t),this.increaseOrDecreaseWidth(d.childWidgets[0],t,!1))}else{var c=a-t;if(c>0)n=e.leftIndent+t,e.tableFormat.leftIndent=n>=-1440?n<=1440?n:1440:-1440,this.updateWidthForCells(e,i,t);else{n=e.leftIndent+a,e.tableFormat.leftIndent=n>=-1440?n<=1440?n:1440:-1440;for(var l=0;l<e.childWidgets.length;l++){var d=e.childWidgets[parseInt(l.toString(),10)];-1!==i.indexOf(d.childWidgets[0])?(this.increaseOrDecreaseWidth(d.childWidgets[0],t,!1),this.updateGridBefore(d,t-a)):this.updateGridBefore(d,-a)}}}}e.tableFormat.allowAutoFit=!1,this.updateGridValue(e,!0,t)},e.prototype.updateWidthForCells=function(e,t,i){for(var n=0;n<e.childWidgets.length;n++){var r=e.childWidgets[parseInt(n.toString(),10)];-1!==t.indexOf(r.childWidgets[0])?this.increaseOrDecreaseWidth(r.childWidgets[0],i,!1):this.updateGridBefore(r,-i)}},e.prototype.resizeColumnAtLastColumnIndex=function(e,t,i){for(var n=e.tableFormat.tableAlignment,r=e.tableFormat.preferredWidth,s=r,a=this.resizerPosition,l=e.tableHolder.columns[a-1],d=0;t!==d;){var h=o.a.round(l.preferredWidth+t,1);h>=l.minWidth?(l.preferredWidth=h,d=t):(d=t,t-=h-l.minWidth)}this.updateCellPreferredWidths(e),(s||e.tableHolder.getTotalWidth(0)>i)&&(e.tableFormat.allowAutoFit=!1,e.updateWidth(t),e.tableHolder.tableWidth=e.tableHolder.getTotalWidth(0));var c=t;"Right"===n?c=0:"Center"===n&&(c/=2),this.updateGridValue(e,!0,c)},e.prototype.resizeCellAtMiddle=function(e,t){var i=this.resizerPosition,n=e.tableHolder.columns[i-1],r=e.tableHolder.columns[parseInt(i.toString(),10)];if(t>0)for(var s=!0;s;){var a=o.a.round(r.preferredWidth-t,1);a>=r.minWidth?(r.preferredWidth=a,n.preferredWidth=n.preferredWidth+t,s=!1):t+=a-r.minWidth}else for(var s=!0;s;){var a=o.a.round(n.preferredWidth+t,1);a>=n.minWidth?(n.preferredWidth=a,r.preferredWidth=r.preferredWidth-t,s=!1):t-=a-n.minWidth}this.updateCellPreferredWidths(e),e.tableFormat.allowAutoFit&&e.updateWidth(t),e.tableFormat.allowAutoFit=!1,e.tableHolder.tableWidth=e.tableHolder.getTotalWidth(0),this.updateGridValue(e,!1,t)},e.prototype.updateGridValue=function(e,t,i){if(t&&(e.calculateGrid(),e.isGridUpdated=!1),e.buildTableColumns(),e.isGridUpdated=!0,this.viewer.owner.isLayoutEnabled=!0,e.isInsideTable){var n=this.documentHelper.layout.getParentTable(e);this.documentHelper.layout.reLayoutTable(n)}else this.documentHelper.layout.reLayoutTable(e);this.owner.editor.getOffsetValue(this.documentHelper.selection),this.owner.editorModule.isSkipOperationsBuild=!0,this.owner.editorModule.reLayout(this.owner.selection),this.owner.editorModule.isSkipOperationsBuild=!1,i&&(this.startingPoint.x+=o.a.convertPointToPixel(i),this.resizerPosition=this.getCellReSizerPosition(this.startingPoint))},e.prototype.getColumnCells=function(e,t,i){for(var n=[],r=0;r<e.childWidgets.length;r++)for(var o=e.childWidgets[parseInt(r.toString(),10)],s=0;s<o.childWidgets.length;s++){var a=o.childWidgets[parseInt(s.toString(),10)];i?a.columnIndex+a.cellFormat.columnSpan===t&&n.push(a):a.columnIndex===t&&n.push(a)}return n},e.prototype.updateGridBefore=function(e,t){e.rowFormat.beforeWidth+t!==e.rowFormat.beforeWidth&&(e.rowFormat.beforeWidth=e.rowFormat.beforeWidth+t,e.rowFormat.gridBeforeWidth=e.rowFormat.beforeWidth)},e.prototype.getLeastGridBefore=function(e,t){for(var i=0,n=0,r=0;r<e.childWidgets.length;r++){var o=e.childWidgets[parseInt(r.toString(),10)];o!==t&&(0===n&&(i=o.rowFormat.beforeWidth,n++),o.rowFormat.beforeWidth<=i&&(i=o.rowFormat.beforeWidth))}return i},e.prototype.increaseOrDecreaseWidth=function(e,t,i){var n=e.cellFormat.preferredWidth;"Auto"===e.cellFormat.preferredWidthType&&(n=e.cellFormat.cellWidth,e.cellFormat.preferredWidthType="Point");var r=e.ownerColumn.minWidth;"Percent"===e.cellFormat.preferredWidthType&&(r=e.convertPointToPercent(r)),e.cellFormat.preferredWidth=i?n+t>r?n+t:r:n-t>r?n-t:r},e.prototype.changeWidthOfCells=function(e,t,i,n){if(t.length>0){for(var r=!1,o=0;o<t.length;o++){var s=t[parseInt(o.toString(),10)];this.increaseOrDecreaseWidth(s,n,!0),s.cellIndex===s.ownerRow.childWidgets.length-1&&(r=!0)}r&&this.updateRowsGridAfterWidth(e)}if(i.length>0){for(var a=0,o=0;o<i.length;o++){var s=i[parseInt(o.toString(),10)];if(0===s.cellIndex){var l=s.ownerRow.rowFormat.beforeWidth+n;l>=0?this.updateGridBefore(s.ownerRow,n):(a!==l&&(a=l),s.ownerRow.rowFormat.gridBeforeWidth=0,s.ownerRow.rowFormat.gridBeforeWidthType="Auto")}this.increaseOrDecreaseWidth(s,n,!1)}if(0!==a){var d=e.leftIndent+a;e.tableFormat.leftIndent=d>=-1440?d<=1440?d:1440:-1440;for(var h=0;h<e.childWidgets.length;h++){var c=e.childWidgets[parseInt(h.toString(),10)];-1===i.indexOf(c.childWidgets[0])&&this.updateGridBefore(c,a>0?a:-a)}}}},e.prototype.updateRowsGridAfterWidth=function(e){for(var t=this.getMaxRowWidth(e,!0),i=0;i<e.childWidgets.length;i++){var n=e.childWidgets[parseInt(i.toString(),10)],r=this.getRowWidth(n,!0);if(t>=r&&n.rowFormat.afterWidth!==t-r){var o=t-r;n.rowFormat.gridAfterWidth=o,n.rowFormat.afterWidth=o}}},e.prototype.getRowWidth=function(e,t){var i=0;t&&(i+=e.rowFormat.beforeWidth);for(var n=0;n<e.childWidgets.length;n++){i+=e.childWidgets[parseInt(n.toString(),10)].cellFormat.cellWidth}return i},e.prototype.getMaxRowWidth=function(e,t){for(var i=0,n=0;n<e.childWidgets.length;n++){var r=e.childWidgets[parseInt(n.toString(),10)],o=0;t&&(o+=r.rowFormat.beforeWidth);for(var s=0;s<r.childWidgets.length;s++){o+=r.childWidgets[parseInt(s.toString(),10)].cellFormat.cellWidth}i<o&&(i=o)}return i},e.prototype.isColumnSelected=function(e,t){for(var i=this.owner.selection,n=i.getSelectedCells(),r=this.getColumnCells(e,t,!0),o=this.getColumnCells(e,t,!1),s=!1,a=0;a<r.length;a++){var l=r[parseInt(a.toString(),10)];s=-1!==n.indexOf(l)}if(!s)for(var a=0;a<o.length;a++){var l=o[parseInt(a.toString(),10)];s=-1!==n.indexOf(l)}return s},e.prototype.applyProperties=function(e,t){if(!i.i(r.isNullOrUndefined)(t)){t.tableHolder&&(e.tableHolder=t.tableHolder.clone()),null!==t.tableFormat&&(e.tableFormat.leftIndent=t.tableFormat.leftIndent,e.tableFormat.preferredWidth=t.tableFormat.preferredWidth,e.tableFormat.preferredWidthType=t.tableFormat.preferredWidthType,e.tableFormat.allowAutoFit=t.tableFormat.allowAutoFit);for(var n=0;n<e.childWidgets.length;n++){var o=e.childWidgets[parseInt(n.toString(),10)],s=t.rows[parseInt(n.toString(),10)];o.rowFormat.gridBefore=s.gridBefore,o.rowFormat.gridBeforeWidth=s.gridBeforeWidth,o.rowFormat.gridBeforeWidthType=s.gridBeforeWidthType,o.rowFormat.gridAfter=s.gridAfter,o.rowFormat.gridAfterWidth=s.gridAfterWidth,o.rowFormat.gridAfterWidthType=s.gridAfterWidthType;for(var a=0;a<o.childWidgets.length;a++){var l=o.childWidgets[parseInt(a.toString(),10)],d=s.cells[parseInt(a.toString(),10)];l.columnIndex=d.columnIndex,l.cellFormat.columnSpan=d.columnSpan,l.cellFormat.preferredWidth=d.preferredWidth,l.cellFormat.preferredWidthType=d.preferredWidthType}}var h=e.getOwnerWidth(!0),c=e.getTableClientWidth(h);e.setWidthToCells(c,"Auto"===e.tableFormat.preferredWidthType)}},e.prototype.getActualWidth=function(e){var t=0;if(e.childWidgets.length>0)for(var i=0;i<e.childWidgets.length;i++)t+=e.childWidgets[parseInt(i.toString(),10)].cellFormat.cellWidth;return t},e.prototype.setPreferredWidth=function(e){for(var t=0;t<e.childWidgets.length;t++){var i=e.childWidgets[parseInt(t.toString(),10)],n=i.rowFormat;n.gridBefore>0&&(n.gridBeforeWidth=n.beforeWidth,n.gridBeforeWidthType="Point");for(var r=0;r<i.childWidgets.length;r++){var o=i.childWidgets[parseInt(r.toString(),10)];o.cellFormat.preferredWidth=o.cellFormat.cellWidth,o.cellFormat.preferredWidthType="Point"}n.gridAfter>0&&(n.gridAfterWidth=n.afterWidth,n.gridAfterWidthType="Point")}},e.prototype.updateCellPreferredWidths=function(e){for(var t=e.tableHolder.tableWidth,i=0;i<e.childWidgets.length;i++){var n=e.childWidgets[parseInt(i.toString(),10)];if(n.rowFormat.gridBefore>0){var r=e.tableHolder.getCellWidth(0,n.rowFormat.gridBefore,t);this.updateGridBeforeWidth(r,n)}for(var o=0;o<n.childWidgets.length;o++){var s=n.childWidgets[parseInt(o.toString(),10)];s.updateWidth(e.tableHolder.getCellWidth(s.columnIndex,s.cellFormat.columnSpan,t))}n.rowFormat.gridAfter>0&&this.updateGridAfterWidth(e.tableHolder.getCellWidth(n.childWidgets.length,n.rowFormat.gridAfter,t),n)}},e.prototype.updateGridBeforeWidth=function(e,t){var i=t.rowFormat;if(e!==i.beforeWidth)if(i.beforeWidth=e,"Auto"===i.gridBeforeWidthType&&(i.gridBeforeWidthType="Point"),"Point"===i.gridBeforeWidthType)i.gridBeforeWidth=i.beforeWidth;else{var n=t.ownerTable.getTableClientWidth(t.ownerTable.getOwnerWidth(!0)),r=t.ownerTable.convertPointToPercent(i.beforeWidth,n);i.gridBeforeWidth=r}},e.prototype.updateGridAfterWidth=function(e,t){var i=t.rowFormat;if(e!==i.afterWidth&&(i.afterWidth=e),"Auto"===i.gridAfterWidthType&&(i.gridAfterWidthType="Point"),"Point"===i.gridAfterWidthType)i.gridAfterWidth=i.afterWidth;else{var n=t.ownerTable.getTableClientWidth(t.ownerTable.getOwnerWidth(!0)),r=t.ownerTable.convertPointToPercent(i.afterWidth,n);i.gridAfterWidth=r}},e.prototype.destroy=function(){this.documentHelper=void 0,this.owner=void 0},e}()},function(e,t,i){"use strict";i.d(t,"a",function(){return a});var n=i(6),r=i(12),o=i(13),s=i(0),a=(i.n(s),function(){function e(e){this.uniqueBorderFormat=void 0,this.ownerBase=void 0,this.ownerBase=e}return Object.defineProperty(e.prototype,"color",{get:function(){return this.getPropertyValue("color")},set:function(e){this.setPropertyValue("color",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineStyle",{get:function(){return this.getPropertyValue("lineStyle")},set:function(e){this.setPropertyValue("lineStyle",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineWidth",{get:function(){return this.getPropertyValue("lineWidth")},set:function(e){this.setPropertyValue("lineWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shadow",{get:function(){return this.getPropertyValue("shadow")},set:function(e){this.setPropertyValue("shadow",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"space",{get:function(){return this.getPropertyValue("space")},set:function(e){this.setPropertyValue("space",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasNoneStyle",{get:function(){return this.getPropertyValue("hasNoneStyle")},set:function(e){this.setPropertyValue("hasNoneStyle",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBorderDefined",{get:function(){return"None"!==this.lineStyle||this.hasNoneStyle&&this.hasValue("hasNoneStyle")},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(t){if(this.hasValue(t)){var n=r.a.getPropertyType(e.uniqueFormatType,t);if(!i.i(s.isNullOrUndefined)(this.uniqueBorderFormat)){var o=this.uniqueBorderFormat.propertiesHash.get(n);if(!i.i(s.isNullOrUndefined)(o))return o}}return e.getPropertyDefaultValue(t)},e.prototype.setPropertyValue=function(t,n){if((i.i(s.isNullOrUndefined)(n)||""===n)&&(n=e.getPropertyDefaultValue(t)),i.i(s.isNullOrUndefined)(this.uniqueBorderFormat))this.initializeUniqueBorder(t,n);else{var o=r.a.getPropertyType(this.uniqueBorderFormat.uniqueFormatType,t);if(this.uniqueBorderFormat.propertiesHash.containsKey(o)&&this.uniqueBorderFormat.propertiesHash.get(o)===n)return;this.uniqueBorderFormat=e.uniqueBorderFormats.updateUniqueFormat(this.uniqueBorderFormat,t,n)}},e.prototype.initializeUniqueBorder=function(t,i){var r=new n.a;this.addUniqueBorderFormat("color",t,i,r),this.addUniqueBorderFormat("lineStyle",t,i,r),this.addUniqueBorderFormat("lineWidth",t,i,r),this.addUniqueBorderFormat("shadow",t,i,r),this.addUniqueBorderFormat("space",t,i,r),this.addUniqueBorderFormat("hasNoneStyle",t,i,r),this.uniqueBorderFormat=e.uniqueBorderFormats.addUniqueFormat(r,e.uniqueFormatType)},e.prototype.addUniqueBorderFormat=function(t,i,n,o){var s=r.a.getPropertyType(e.uniqueFormatType,t);t===i&&o.add(s,n)},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"color":t="#000000";break;case"lineStyle":t="None";break;case"lineWidth":t=0;break;case"shadow":t=!1;break;case"space":t=0;break;case"hasNoneStyle":t=!1}return t},e.prototype.getLineWidth=function(){switch(this.lineStyle){case"None":case"Cleared":return 0;case"Triple":case"Double":case"ThinThickSmallGap":case"ThickThinSmallGap":case"ThinThickThinSmallGap":case"ThinThickMediumGap":case"ThickThinMediumGap":case"ThinThickThinMediumGap":case"ThinThickLargeGap":case"ThickThinLargeGap":case"ThinThickThinLargeGap":case"Emboss3D":case"Engrave3D":for(var e=this.getBorderLineWidthArray(this.lineStyle,this.lineWidth),t=0,i=0;i<e.length;i++)t+=e[i];return t;case"Single":case"DashLargeGap":case"DashSmallGap":case"Dot":case"DashDot":case"DashDotDot":case"Thick":return this.lineWidth>=.5?this.lineWidth:.5;case"SingleWavy":return 1.5===this.lineWidth?3:2.5;case"DoubleWavy":return 6.75;case"DashDotStroked":case"Outset":return this.lineWidth>=.5?this.lineWidth:.5}return this.lineWidth>=.5?this.lineWidth:.5},e.prototype.getBorderLineWidthArray=function(e,t){var i=[t];switch(e){case"Double":i=[1,1,1];break;case"ThinThickSmallGap":i=[1,-.75,-.75];break;case"ThickThinSmallGap":i=[-.75,-.75,1];break;case"ThinThickMediumGap":i=[1,.5,.5];break;case"ThickThinMediumGap":i=[.5,.5,1];break;case"ThinThickLargeGap":i=[-1.5,1,-.75];break;case"ThickThinLargeGap":i=[-.75,1,-1.5];break;case"Triple":i=[1,1,1,1,1];break;case"ThinThickThinSmallGap":i=[-.75,-.75,1,-.75,-.75];break;case"ThinThickThinMediumGap":i=[.5,.5,1,.5,.5];break;case"ThinThickThinLargeGap":i=[-.75,1,-1.5,1,-.75];break;case"Emboss3D":case"Engrave3D":i=[.25,0,1,0,.25]}if(1===i.length)return[t];for(var n=0;n<i.length;n++)i[parseInt(n.toString(),10)]>=0?i[parseInt(n.toString(),10)]=i[parseInt(n.toString(),10)]*t:i[parseInt(n.toString(),10)]=Math.abs(i[parseInt(n.toString(),10)]);return i},e.prototype.getBorderWeight=function(){var e=0,t=(this.getNumberOfLines(),this.getBorderNumber());switch(this.lineStyle){case"Single":case"DashSmallGap":case"DashDot":case"DashDotDot":case"Double":case"Triple":case"ThinThickSmallGap":case"ThickThinSmallGap":case"ThinThickThinSmallGap":case"ThinThickMediumGap":case"ThickThinMediumGap":case"ThinThickThinMediumGap":case"ThinThickLargeGap":case"ThickThinLargeGap":case"ThinThickThinLargeGap":case"SingleWavy":case"DoubleWavy":case"DashDotStroked":case"Emboss3D":case"Engrave3D":case"Outset":case"Inset":case"Thick":e=this.lineWidth*t;break;case"Dot":case"DashLargeGap":e=1}return e},e.prototype.getBorderNumber=function(){var e=0;switch(this.lineStyle){case"Single":e=1;break;case"Thick":e=2;break;case"Double":e=3;break;case"Dot":e=4;break;case"DashLargeGap":e=5;break;case"DashDot":e=6;break;case"DashDotDot":e=7;break;case"Triple":e=8;break;case"ThinThickSmallGap":e=9;break;case"ThickThinSmallGap":e=10;break;case"ThinThickThinSmallGap":e=11;break;case"ThinThickMediumGap":e=12;break;case"ThickThinMediumGap":e=13;break;case"ThinThickThinMediumGap":e=14;break;case"ThinThickLargeGap":e=15;break;case"ThickThinLargeGap":e=16;break;case"ThinThickThinLargeGap":e=17;break;case"SingleWavy":e=18;break;case"DoubleWavy":e=19;break;case"DashSmallGap":e=20;break;case"DashDotStroked":e=21;break;case"Emboss3D":e=22;break;case"Engrave3D":e=23;break;case"Outset":e=24;break;case"Inset":e=25}return e},e.prototype.getNumberOfLines=function(){var e=0;switch(this.lineStyle){case"Single":case"Dot":case"DashSmallGap":case"DashLargeGap":case"DashDot":case"DashDotDot":e=1;break;case"Double":e=3;break;case"Triple":e=5;break;case"ThinThickSmallGap":case"ThickThinSmallGap":e=3;break;case"ThinThickThinSmallGap":e=5;break;case"ThinThickMediumGap":case"ThickThinMediumGap":e=3;break;case"ThinThickThinMediumGap":e=5;break;case"ThinThickLargeGap":case"ThickThinLargeGap":e=3;break;case"ThinThickThinLargeGap":e=5;break;case"SingleWavy":e=1;break;case"DoubleWavy":e=2;break;case"DashDotStroked":e=1;break;case"Emboss3D":case"Engrave3D":e=3;break;case"Outset":case"Inset":case"Thick":e=1}return e},e.prototype.getPrecedence=function(){var e=0;switch(this.lineStyle){case"Single":e=1;break;case"Thick":e=2;break;case"Double":e=3;break;case"Dot":e=4;break;case"DashLargeGap":e=5;break;case"DashDot":e=6;break;case"DashDotDot":e=7;break;case"Triple":e=8;break;case"ThinThickSmallGap":e=9;break;case"ThickThinSmallGap":e=10;break;case"ThinThickThinSmallGap":e=11;break;case"ThinThickMediumGap":e=12;break;case"ThickThinMediumGap":e=13;break;case"ThinThickThinMediumGap":e=14;break;case"ThinThickLargeGap":e=15;break;case"ThickThinLargeGap":e=16;break;case"ThinThickThinLargeGap":e=17;break;case"SingleWavy":e=18;break;case"DoubleWavy":e=19;break;case"DashSmallGap":e=20;break;case"DashDotStroked":e=21;break;case"Emboss3D":e=22;break;case"Engrave3D":e=23;break;case"Outset":e=24;break;case"Inset":e=25}return e},e.prototype.hasValues=function(){return this.hasValue("color")||this.hasValue("lineStyle")||this.hasValue("lineWidth")||this.hasValue("shadow")||this.hasValue("space")||this.hasValue("hasNoneStyle")},e.prototype.hasValue=function(e){if(!i.i(s.isNullOrUndefined)(this.uniqueBorderFormat)){var t=r.a.getPropertyType(this.uniqueBorderFormat.uniqueFormatType,e);return this.uniqueBorderFormat.propertiesHash.containsKey(t)}return!1},e.prototype.cloneFormat=function(){var t=new e(void 0);return t.color=this.color,t.lineStyle=this.lineStyle,t.lineWidth=this.lineWidth,t.shadow=this.shadow,t.space=this.space,t},e.prototype.clearFormat=function(){i.i(s.isNullOrUndefined)(this.uniqueBorderFormat)||e.uniqueBorderFormats.remove(this.uniqueBorderFormat),this.uniqueBorderFormat=void 0},e.prototype.destroy=function(){this.clearFormat(),this.ownerBase=void 0},e.prototype.isEqualFormat=function(e){var t=!1;return this.color===e.color&&this.lineStyle===e.lineStyle&&this.lineWidth===e.lineWidth&&this.shadow==e.shadow&&this.space===e.space&&(t=!0),t},e.prototype.copyFormat=function(e){i.i(s.isNullOrUndefined)(e)||i.i(s.isNullOrUndefined)(e.uniqueBorderFormat)||(e.hasValue("color")&&(this.color=e.color),e.hasValue("lineStyle")&&(this.lineStyle=e.lineStyle),e.hasValue("lineWidth")&&(this.lineWidth=e.lineWidth),e.hasValue("shadow")&&(this.shadow=e.shadow),e.hasValue("space")&&(this.space=e.space),e.hasValue("hasNoneStyle")&&(this.hasNoneStyle=e.hasNoneStyle))},e.clear=function(){this.uniqueBorderFormats.clear()},e.uniqueBorderFormats=new o.a,e.uniqueFormatType=1,e}())},function(e,t,i){"use strict";i.d(t,"a",function(){return d});var n=i(0),r=(i.n(n),i(6)),o=i(12),s=i(13),a=i(27),l=i(25),d=function(){function e(e){this.uniqueRowFormat=void 0,this.borders=new a.a(this),this.ownerBase=void 0,this.beforeWidth=0,this.afterWidth=0,this.revisions=[],this.removedIds=[],this.ownerBase=e}return Object.defineProperty(e.prototype,"gridBefore",{get:function(){return this.getPropertyValue("gridBefore")},set:function(e){this.setPropertyValue("gridBefore",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gridBeforeWidth",{get:function(){return this.getPropertyValue("gridBeforeWidth")},set:function(e){this.setPropertyValue("gridBeforeWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gridBeforeWidthType",{get:function(){return this.getPropertyValue("gridBeforeWidthType")},set:function(e){this.setPropertyValue("gridBeforeWidthType",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gridAfter",{get:function(){return this.getPropertyValue("gridAfter")},set:function(e){this.setPropertyValue("gridAfter",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gridAfterWidth",{get:function(){return this.getPropertyValue("gridAfterWidth")},set:function(e){this.setPropertyValue("gridAfterWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gridAfterWidthType",{get:function(){return this.getPropertyValue("gridAfterWidthType")},set:function(e){this.setPropertyValue("gridAfterWidthType",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allowBreakAcrossPages",{get:function(){return this.getPropertyValue("allowBreakAcrossPages")},set:function(e){this.setPropertyValue("allowBreakAcrossPages",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isHeader",{get:function(){return this.getPropertyValue("isHeader")},set:function(e){this.setPropertyValue("isHeader",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightMargin",{get:function(){return this.getPropertyValue("rightMargin")},set:function(e){this.setPropertyValue("rightMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.getPropertyValue("height")},set:function(e){0!==e||"AtLeast"!==this.heightType&&"Exactly"!==this.heightType?"Auto"===this.heightType&&(e=0):e=1,this.setPropertyValue("height",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"heightType",{get:function(){return this.getPropertyValue("heightType")},set:function(e){this.height="AtLeast"===e||"Exactly"===e?1:0,this.setPropertyValue("heightType",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomMargin",{get:function(){return this.getPropertyValue("bottomMargin")},set:function(e){this.setPropertyValue("bottomMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftIndent",{get:function(){return this.getPropertyValue("leftIndent")},set:function(e){this.setPropertyValue("leftIndent",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topMargin",{get:function(){return this.getPropertyValue("topMargin")},set:function(e){this.setPropertyValue("topMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftMargin",{get:function(){return this.getPropertyValue("leftMargin")},set:function(e){this.setPropertyValue("leftMargin",e)},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(t){if(this.hasValue(t)){var r=o.a.getPropertyType(e.uniqueFormatType,t);if(!i.i(n.isNullOrUndefined)(this.uniqueRowFormat)&&this.uniqueRowFormat.propertiesHash.containsKey(r))return this.uniqueRowFormat.propertiesHash.get(r)}return e.getPropertyDefaultValue(t)},e.prototype.setPropertyValue=function(t,r){if((i.i(n.isNullOrUndefined)(r)||""===r)&&(r=e.getPropertyDefaultValue(t)),i.i(n.isNullOrUndefined)(this.uniqueRowFormat))this.initializeUniqueRowFormat(t,r);else{var s=o.a.getPropertyType(this.uniqueRowFormat.uniqueFormatType,t);if(this.uniqueRowFormat.propertiesHash.containsKey(s)&&this.uniqueRowFormat.propertiesHash.get(s)===r)return;this.uniqueRowFormat=e.uniqueRowFormats.updateUniqueFormat(this.uniqueRowFormat,t,r)}},e.prototype.initializeUniqueRowFormat=function(t,i){var n=new r.a;this.addUniqueRowFormat("allowBreakAcrossPages",t,i,n),this.addUniqueRowFormat("isHeader",t,i,n),this.addUniqueRowFormat("height",t,i,n),this.addUniqueRowFormat("heightType",t,i,n),this.addUniqueRowFormat("gridBefore",t,i,n),this.addUniqueRowFormat("gridBeforeWidth",t,i,n),this.addUniqueRowFormat("gridBeforeWidthType",t,i,n),this.addUniqueRowFormat("gridAfter",t,i,n),this.addUniqueRowFormat("gridAfterWidth",t,i,n),this.addUniqueRowFormat("gridgridAfterWidth",t,i,n),this.addUniqueRowFormat("gridBeforeWidthType",t,i,n),this.addUniqueRowFormat("leftMargin",t,i,n),this.addUniqueRowFormat("rightMargin",t,i,n),this.addUniqueRowFormat("topMargin",t,i,n),this.addUniqueRowFormat("bottomMargin",t,i,n),this.addUniqueRowFormat("leftIndent",t,i,n),this.uniqueRowFormat=e.uniqueRowFormats.addUniqueFormat(n,e.uniqueFormatType)},e.prototype.addUniqueRowFormat=function(t,i,n,r){var s=o.a.getPropertyType(e.uniqueFormatType,t);t===i&&r.add(s,n)},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"allowBreakAcrossPages":t=!0;break;case"isHeader":t=!1;break;case"height":t=0;break;case"heightType":t="Auto";break;case"gridBefore":case"gridBeforeWidth":t=0;break;case"gridBeforeWidthType":t="Point";break;case"gridAfter":case"gridAfterWidth":t=0;break;case"gridAfterWidthType":t="Point";break;case"leftMargin":case"topMargin":case"bottomMargin":case"rightMargin":t=void 0;break;case"leftIndent":t=0}return t},e.prototype.containsMargins=function(){return!(i.i(n.isNullOrUndefined)(this.leftMargin)&&i.i(n.isNullOrUndefined)(this.rightMargin)&&i.i(n.isNullOrUndefined)(this.bottomMargin)&&i.i(n.isNullOrUndefined)(this.topMargin))},e.prototype.cloneFormat=function(){var t=new e;return t.allowBreakAcrossPages=this.allowBreakAcrossPages,t.heightType=this.heightType,t.height=this.height,t.isHeader=this.isHeader,t.gridBefore=this.gridBefore,t.gridBeforeWidth=this.gridBeforeWidth,t.gridBeforeWidthType=this.gridBeforeWidthType,t.gridAfter=this.gridAfter,t.gridAfterWidth=this.gridAfterWidth,t.gridAfterWidthType=this.gridAfterWidthType,t.leftMargin=this.leftMargin,t.rightMargin=this.rightMargin,t.topMargin=this.topMargin,t.bottomMargin=this.bottomMargin,t.leftIndent=this.leftIndent,this.revisions.length>0?t.removedIds=l.b.cloneRevisions(this.revisions):t.removedIds=this.removedIds.slice(),t},e.prototype.hasValue=function(e){if(!i.i(n.isNullOrUndefined)(this.uniqueRowFormat)){var t=o.a.getPropertyType(this.uniqueRowFormat.uniqueFormatType,e);return this.uniqueRowFormat.propertiesHash.containsKey(t)}return!1},e.prototype.copyFormat=function(e){i.i(n.isNullOrUndefined)(e)||(i.i(n.isNullOrUndefined)(e.uniqueRowFormat)||(this.allowBreakAcrossPages=e.allowBreakAcrossPages,this.isHeader=e.isHeader,this.heightType=e.heightType,this.height=e.height,this.gridBefore=e.gridBefore,this.gridBeforeWidth=e.gridBeforeWidth,this.gridBeforeWidthType=e.gridBeforeWidthType,this.gridAfter=e.gridAfter,this.gridAfterWidth=e.gridAfterWidth,this.gridAfterWidthType=e.gridAfterWidthType,this.leftMargin=e.leftMargin,this.topMargin=e.topMargin,this.rightMargin=e.rightMargin,this.bottomMargin=e.bottomMargin,this.leftIndent=e.leftIndent,this.revisions=e.revisions),i.i(n.isNullOrUndefined)(e.borders)||(this.borders=new a.a(this),this.borders.ownerBase=e,this.borders.copyFormat(e.borders)),e.revisions.length>0?this.removedIds=l.b.cloneRevisions(e.revisions):this.removedIds=e.removedIds.slice())},e.prototype.destroy=function(){i.i(n.isNullOrUndefined)(this.borders)||this.borders.destroy(),i.i(n.isNullOrUndefined)(this.uniqueRowFormat)||e.uniqueRowFormats.remove(this.uniqueRowFormat),this.beforeWidth=void 0,this.afterWidth=void 0,this.borders=void 0,this.uniqueRowFormat=void 0},e.clear=function(){this.uniqueRowFormats.clear()},e.uniqueRowFormats=new s.a,e.uniqueFormatType=6,e}()},function(e,t,i){"use strict";i.d(t,"a",function(){return a});var n=i(0),r=(i.n(n),i(18)),o=(i.n(r),i(3)),s=(i.n(o),i(8)),a=(i.n(s),function(){function e(e){var t=this;this.show=function(){var e=new n.L10n("documenteditor",t.documentHelper.owner.defaultLocale);e.setLocale(t.documentHelper.owner.locale),t.target||t.initUserDialog(e,t.documentHelper.owner.enableRtl),t.documentHelper.dialog.header=e.getConstant("Add Users"),t.documentHelper.dialog.height="auto",t.documentHelper.dialog.width="auto",t.documentHelper.dialog.content=t.target,t.documentHelper.dialog.beforeOpen=t.loadUserDetails,t.documentHelper.dialog.close=t.documentHelper.updateFocus,t.documentHelper.dialog.buttons=[{click:t.okButtonClick,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat",isPrimary:!0}},{click:t.hideDialog,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat"}},{click:t.deleteButtonClick,buttonModel:{content:e.getConstant("Delete"),cssClass:"e-flat e-user-delete"}}],t.documentHelper.dialog.dataBind(),t.documentHelper.dialog.show()},this.loadUserDetails=function(){t.userList.dataSource=t.documentHelper.userCollection.slice(),t.userList.dataBind(),t.documentHelper.restrictEditingPane.addedUser.dataSource=t.documentHelper.userCollection.slice(),t.documentHelper.restrictEditingPane.addedUser.dataBind()},this.okButtonClick=function(){t.documentHelper.restrictEditingPane.isAddUser=!0,t.documentHelper.restrictEditingPane.showStopProtectionPane(!1),t.documentHelper.restrictEditingPane.addUserCollection(),t.documentHelper.restrictEditingPane.isAddUser=!1,t.documentHelper.dialog.hide()},this.hideDialog=function(){t.textBoxInput.value="",t.documentHelper.dialog.hide()},this.onKeyUpOnDisplayBox=function(){t.addButton.disabled=""===t.textBoxInput.value},this.addButtonClick=function(){t.validateUserName(t.textBoxInput.value)?(-1===t.documentHelper.userCollection.indexOf(t.textBoxInput.value)&&t.documentHelper.userCollection.push(t.textBoxInput.value),t.userList.dataSource=t.documentHelper.userCollection.slice(),t.userList.dataBind(),t.textBoxInput.value=""):s.DialogUtility.alert("Invalid user name")},this.deleteButtonClick=function(){var e=t.documentHelper.userCollection.indexOf(t.userList.getSelectedItems().text);e>-1&&(t.documentHelper.userCollection.splice(e,1),t.userList.dataSource=t.documentHelper.userCollection.slice(),t.userList.dataBind())},this.documentHelper=e}return e.prototype.initUserDialog=function(e,t){this.target=i.i(n.createElement)("div",{className:"e-de-user-dlg"});var s=e.getConstant("Enter User"),a=i.i(n.createElement)("div",{innerHTML:s,className:"e-bookmark-dlgfields"});this.target.appendChild(a);var l=i.i(n.createElement)("div",{className:"e-de-user-dlg-common"});this.target.appendChild(l);var d=i.i(n.createElement)("div",{className:"e-de-user-dlg-list"});l.appendChild(d),t&&d.classList.add("e-de-rtl"),this.textBoxInput=i.i(n.createElement)("input",{className:"e-input e-de-user-dlg-textbox-input",attrs:{autofocus:"true"}}),this.textBoxInput.setAttribute("type","text"),d.appendChild(this.textBoxInput),this.textBoxInput.addEventListener("keyup",this.onKeyUpOnDisplayBox);var h=i.i(n.createElement)("button",{innerHTML:e.getConstant("Add"),attrs:{type:"button"}});d.appendChild(h),h.addEventListener("click",this.addButtonClick),this.addButton=new o.Button({cssClass:"e-de-user-add-btn"}),this.addButton.disabled=!0,this.addButton.appendTo(h),this.addButton.addEventListener("click",this.addButtonClick);var c=i.i(n.createElement)("div");l.appendChild(c);var p=i.i(n.createElement)("div",{innerHTML:e.getConstant("Users"),className:"e-de-user-dlg-user"});c.appendChild(p);var u=i.i(n.createElement)("div");c.appendChild(u),this.userList=new r.ListView({cssClass:"e-de-user-listview"}),this.userList.appendTo(u)},e.prototype.validateUserName=function(e){if(-1===e.indexOf("@"))return!1;var t=e.split("@"),i=t[1];if(-1===i.indexOf("."))return!1;var n=i.split("."),r=n[1];return!(n.length>2)&&!(r.length>4||r.length<2)},e.prototype.destroy=function(){this.textBoxInput&&(this.textBoxInput=void 0),this.addButton&&(this.addButton.destroy(),this.addButton=void 0),this.userList&&(this.userList.destroy(),this.userList=void 0),this.documentHelper=void 0},e}())},function(e,t,i){"use strict";i.d(t,"a",function(){return s}),i.d(t,"b",function(){return a});var n=i(0),r=(i.n(n),i(8)),o=(i.n(r),i(5)),s=(i.n(o),function(){function e(e,t){var i=this;this.show=function(){i.localeValue=new n.L10n("documenteditor",i.viewer.owner.defaultLocale),i.localeValue.setLocale(i.viewer.owner.locale),i.target||i.initDialog(i.localeValue),i.documentHelper.dialog.header=i.localeValue.getConstant("Start Enforcing Protection"),i.documentHelper.dialog.height="auto",i.documentHelper.dialog.content=i.target,i.documentHelper.dialog.width="auto",i.documentHelper.dialog.buttons=[{click:i.okButtonClick,buttonModel:{content:i.localeValue.getConstant("Ok"),cssClass:"e-flat",isPrimary:!0}},{click:i.hideDialog,buttonModel:{content:i.localeValue.getConstant("Cancel"),cssClass:"e-flat"}}],i.passwordTextBox.value="",i.confirmPasswordTextBox.value="",i.documentHelper.dialog.show()},this.hideDialog=function(){i.passwordTextBox.value="",i.confirmPasswordTextBox.value="",i.documentHelper.dialog.hide()},this.okButtonClick=function(){i.passwordTextBox.value!==i.confirmPasswordTextBox.value?r.DialogUtility.alert(i.localeValue.getConstant("Password Mismatch")):(i.password=n.SanitizeHtmlHelper.sanitize(i.passwordTextBox.value),i.viewer.owner.editor.addProtection(i.password,i.owner.protectionType))},this.documentHelper=e,this.owner=t}return Object.defineProperty(e.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.initDialog=function(e){this.target=i.i(n.createElement)("div",{className:"e-de-enforce"});var t=i.i(n.createElement)("div",{className:"e-de-container-row"});this.passwordTextBox=i.i(n.createElement)("input",{attrs:{type:"password",autofocus:"true"},className:"e-input"}),t.appendChild(this.passwordTextBox);var r=i.i(n.createElement)("div");this.confirmPasswordTextBox=i.i(n.createElement)("input",{attrs:{type:"password"},className:"e-input"}),r.appendChild(this.confirmPasswordTextBox),this.target.appendChild(t),this.target.appendChild(r),new o.TextBox({placeholder:e.getConstant("Enter new password"),floatLabelType:"Always",cssClass:"e-de-enforce-dlg-input"},this.passwordTextBox),new o.TextBox({placeholder:e.getConstant("Reenter new password to confirm"),floatLabelType:"Always"},this.confirmPasswordTextBox)},e.prototype.destroy=function(){this.documentHelper=void 0,this.owner=void 0},e}()),a=function(){function e(e,t){var i=this;this.show=function(){i.localObj=new n.L10n("documenteditor",i.viewer.owner.defaultLocale),i.localObj.setLocale(i.viewer.owner.locale),i.target||i.initDialog(i.localObj),i.documentHelper.dialog.header="Unprotect Document",i.documentHelper.dialog.height="auto",i.documentHelper.dialog.width="auto",i.documentHelper.dialog.content=i.target,i.documentHelper.dialog.buttons=[{click:i.okButtonClick,buttonModel:{content:i.localObj.getConstant("Ok"),cssClass:"e-flat",isPrimary:!0}},{click:i.hideDialog,buttonModel:{content:i.localObj.getConstant("Cancel"),cssClass:"e-flat"}}],i.documentHelper.dialog.dataBind(),i.passwordTextBox.value="",i.documentHelper.dialog.show()},this.okButtonClick=function(){var e=i.passwordTextBox.value;if(e.length==="".length&&""===e)return void r.DialogUtility.alert(i.localObj.getConstant("The password is incorrect"));i.viewer.owner.editor.stopProtection(e)},this.hideDialog=function(){i.passwordTextBox.value="",i.documentHelper.dialog.hide()},this.documentHelper=e,this.owner=t}return Object.defineProperty(e.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.initDialog=function(e){var t=this.viewer.owner.containerId+"_enforce_protection";this.target=i.i(n.createElement)("div",{id:t,className:"e-de-enforce"});var r=i.i(n.createElement)("div"),o=i.i(n.createElement)("div",{className:"e-de-unprotect-dlg-title",innerHTML:e.getConstant("Password")});this.passwordTextBox=i.i(n.createElement)("input",{attrs:{type:"password"},id:this.viewer.owner.containerId+"_display_text",className:"e-input e-de-enforce-dlg-input"}),r.appendChild(o),r.appendChild(this.passwordTextBox),this.target.appendChild(r)},e.prototype.destroy=function(){this.documentHelper=void 0,this.owner=void 0},e}()},function(e,t,i){"use strict";i.d(t,"a",function(){return h});var n=i(0),r=(i.n(n),i(3)),o=(i.n(r),i(57)),s=i(58),a=i(4),l=i(18),d=(i.n(l),i(10)),h=(i.n(d),function(){function e(e){var t=this;this.addRemove=!0,this.protectionType="ReadOnly",this.previousProtectionType="Read only",this.isShowRestrictPane=!1,this.isAddUser=!1,this.usersCollection=["Everyone"],this.closePane=function(){t.restrictPane.style.display="none",t.documentHelper.updateViewerSize()},this.onYesButtonClick=function(){t.viewer.owner.editor.removeAllEditRestrictions(),t.documentHelper.dialog.hide()},this.onCancelButtonClick=function(e){t.protectionTypeDrop.value=t.previousProtectionType,t.documentHelper.dialog.hide()},this.onNoButtonClick=function(){t.documentHelper.dialog.hide()},this.showAllRegion=function(){t.documentHelper.selection.showAllEditingRegion()},this.documentHelper=e,this.addUserDialog=new o.a(e),this.enforceProtectionDialog=new s.a(e,this),this.unProtectDialog=new s.b(e,this),this.base64=new a.c}return Object.defineProperty(e.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.showHideRestrictPane=function(e){this.restrictPane||(this.localObj=new n.L10n("documenteditor",this.viewer.owner.defaultLocale),this.localObj.setLocale(this.viewer.owner.locale),this.initPane(this.localObj,this.documentHelper.owner.enableRtl)),e?(this.restrictPane.style.display="block",this.isShowRestrictPane=!0,this.documentHelper.selection.isHighlightEditRegion=!0,this.wireEvents(),this.documentHelper.updateViewerSize(),this.loadPaneValue()):(this.closePane(),this.documentHelper.updateFocus())},e.prototype.initPane=function(e,t){this.restrictPane=i.i(n.createElement)("div",{className:"e-de-restrict-pane"}),t&&this.restrictPane.classList.add("e-rtl");var r=i.i(n.createElement)("div",{className:"e-de-rp-whole-header"}),o=i.i(n.createElement)("div",{innerHTML:e.getConstant("Restrict Editing"),className:"e-de-rp-header"});this.closeButton=i.i(n.createElement)("button",{className:"e-de-rp-close-icon e-de-close-icon e-btn e-flat e-icon-btn",attrs:{type:"button"}}),this.closeButton.setAttribute("aria-label",this.localObj.getConstant("Close")),r.appendChild(this.closeButton),r.appendChild(o);var s=i.i(n.createElement)("span",{className:"e-de-op-close-icon e-de-close-icon e-btn-icon e-icons"});this.closeButton.appendChild(s),this.restrictPane.appendChild(r),this.initRestrictEditingPane(e),this.documentHelper.optionsPaneContainer.setAttribute("style","display:inline-flex;"),this.documentHelper.optionsPaneContainer.insertBefore(this.restrictPane,this.documentHelper.viewerContainer)},e.prototype.initRestrictEditingPane=function(e){this.restrictPaneWholeDiv=i.i(n.createElement)("div");var t=i.i(n.createElement)("div",{className:"e-de-rp-sub-div"}),o=i.i(n.createElement)("div",{innerHTML:e.getConstant("Formatting restrictions"),className:"e-de-rp-format"});t.appendChild(o);var s=i.i(n.createElement)("input",{attrs:{type:"checkbox"}});t.appendChild(s),this.allowFormat=this.createCheckBox(e.getConstant("Allow formatting"),s),this.restrictPaneWholeDiv.appendChild(t);var a=i.i(n.createElement)("div",{className:"e-de-rp-sub-div"}),h=(i.i(n.createElement)("input",{attrs:{type:"checkbox"}}),i.i(n.createElement)("input",{className:"e-prop-font-style"}));a.appendChild(h);var c=[{Value:"Read only",Name:e.getConstant("Read only")},{Value:"Filling in forms",Name:e.getConstant("Filling in forms")},{Value:"Comments",Name:e.getConstant("Comments")},{Value:"Tracked changes",Name:e.getConstant("Tracked changes")}];this.protectionTypeDrop=new d.DropDownList({dataSource:c,cssClass:"e-de-prop-dropdown",floatLabelType:"Always",placeholder:e.getConstant("Editing restrictions"),fields:{text:"Name",value:"Value"},enableRtl:this.documentHelper.owner.enableRtl}),this.protectionTypeDrop.value="Read only",this.protectionTypeDrop.appendTo(h),this.restrictPaneWholeDiv.appendChild(a),this.userWholeDiv=i.i(n.createElement)("div",{className:"e-de-rp-sub-div"});var p=i.i(n.createElement)("div",{innerHTML:e.getConstant("Exceptions Optional"),className:"e-de-rp-format"});this.userWholeDiv.appendChild(p);var u=i.i(n.createElement)("div",{innerHTML:e.getConstant("Select Part Of Document And User"),className:"e-de-rp-sub-content-div"});this.userWholeDiv.appendChild(u);var g=i.i(n.createElement)("div",{className:"e-de-rp-user"});this.userWholeDiv.appendChild(g),this.addedUser=new l.ListView({cssClass:"e-de-user-listView",dataSource:[{text:"Everyone"}],showCheckBox:!0,select:this.selectHandler.bind(this),enableRtl:this.documentHelper.owner.enableRtl}),this.addedUser.appendTo(g),this.addUser=i.i(n.createElement)("button",{className:"e-btn e-primary e-flat e-de-rp-mu-btn",innerHTML:e.getConstant("More users")+"...",attrs:{type:"button"}}),this.addUser.setAttribute("aria-label",e.getConstant("More users")),this.userWholeDiv.appendChild(this.addUser),this.restrictPaneWholeDiv.appendChild(this.userWholeDiv);var f=i.i(n.createElement)("div",{className:"e-de-rp-enforce"});this.restrictPaneWholeDiv.appendChild(f),this.enforceProtection=i.i(n.createElement)("button",{innerHTML:e.getConstant("Enforcing Protection"),className:"e-btn e-de-rp-btn-enforce",attrs:{type:"button"}}),this.enforceProtection.setAttribute("aria-label",e.getConstant("Enforcing Protection")),f.appendChild(this.enforceProtection),this.restrictPane.appendChild(this.restrictPaneWholeDiv),this.stopProtectionDiv=i.i(n.createElement)("div",{styles:"display:none"});var m=i.i(n.createElement)("div",{innerHTML:e.getConstant("Your permissions"),className:"e-de-rp-stop-div1"});this.stopProtectionDiv.appendChild(m);var v=i.i(n.createElement)("div",{className:"e-de-rp-stop-div2"});this.stopProtectionDiv.appendChild(v);var y=e.getConstant("Protected Document");this.contentDiv1=i.i(n.createElement)("div",{innerHTML:y}),v.appendChild(this.contentDiv1);var w=e.getConstant("ReadOnlyProtection");this.contentDiv2=i.i(n.createElement)("div",{innerHTML:w}),v.appendChild(this.contentDiv2),this.stopReadOnlyOptions=i.i(n.createElement)("div"),this.stopProtectionDiv.appendChild(this.stopReadOnlyOptions);var b=i.i(n.createElement)("div",{className:"e-de-rp-enforce-nav"}),x=i.i(n.createElement)("button",{innerHTML:e.getConstant("Find Next Region I Can Edit"),className:"e-btn e-de-rp-nav-btn",attrs:{type:"button"}});b.appendChild(x),x.addEventListener("click",this.navigateNextRegion.bind(this)),this.stopReadOnlyOptions.appendChild(b);var C=i.i(n.createElement)("div",{className:"e-de-rp-enforce-nav"}),I=i.i(n.createElement)("button",{innerHTML:e.getConstant("Show All Regions I Can Edit"),className:"e-btn e-de-rp-nav-btn",attrs:{type:"button"}});C.appendChild(I),I.addEventListener("click",this.showAllRegion),this.stopReadOnlyOptions.appendChild(C);var F=i.i(n.createElement)("div",{className:"e-de-rp-nav-lbl e-de-rp-more-less"}),k=i.i(n.createElement)("input",{attrs:{type:"checkbox"},className:"e-btn e-de-rp-nav-btn"});F.appendChild(k),this.stopReadOnlyOptions.appendChild(F),this.highlightCheckBox=new r.CheckBox({label:e.getConstant("Highlight the regions I can edit"),change:this.changeHighlightOptions.bind(this),enableRtl:this.documentHelper.owner.enableRtl},k);var P=i.i(n.createElement)("div",{className:"e-de-rp-enforce"});this.stopProtection=i.i(n.createElement)("button",{innerHTML:e.getConstant("Stop Protection"),className:"e-btn e-de-rp-btn-stop-enforce",attrs:{type:"button"}}),P.appendChild(this.stopProtection),this.stopProtectionDiv.appendChild(P),this.restrictPane.appendChild(this.stopProtectionDiv)},e.prototype.showStopProtectionPane=function(e){switch(e?(this.stopProtectionDiv.style.display="block",this.restrictPaneWholeDiv.style.display="none"):(this.stopProtectionDiv.style.display="none",this.restrictPaneWholeDiv.style.display="block"),this.documentHelper.protectionType){case"ReadOnly":case"CommentsOnly":this.stopReadOnlyOptions.style.display="block";break;default:this.stopReadOnlyOptions.style.display="none"}},e.prototype.wireEvents=function(){this.addUser.addEventListener("click",this.addUserDialog.show),this.enforceProtection.addEventListener("click",this.protectDocument.bind(this)),this.stopProtection.addEventListener("click",this.stopProtectionTriggered.bind(this)),this.closeButton.addEventListener("click",this.closePane),this.allowFormat.addEventListener("change",this.enableFormatting.bind(this)),this.protectionTypeDrop.addEventListener("change",this.protectionTypeDropChanges.bind(this)),this.highlightCheckBox.addEventListener("change",this.highlightClicked.bind(this))},e.prototype.changeHighlightOptions=function(){var e=this;this.documentHelper.owner.documentEditorSettings.highlightEditableRanges=this.highlightCheckBox.checked,setTimeout(function(){e.documentHelper.owner.focusIn()},10)},e.prototype.enableFormatting=function(e){this.documentHelper.restrictFormatting=!e.checked},e.prototype.stopProtectionTriggered=function(e){if((i.i(n.isNullOrUndefined)(this.documentHelper.saltValue)||""===this.documentHelper.saltValue)&&(i.i(n.isNullOrUndefined)(this.documentHelper.hashValue)||""===this.documentHelper.hashValue))return void this.documentHelper.owner.editor.unProtectDocument();this.unProtectDialog.show()},e.prototype.protectionTypeDropChanges=function(e){switch(e.value){case"Read only":this.protectionType="ReadOnly",this.userWholeDiv.style.display="block",this.contentDiv1.innerHTML=this.localObj.getConstant("Protected Document"),this.contentDiv2.innerHTML=this.localObj.getConstant("ReadOnlyProtection"),this.previousProtectionType=e.previousItemData.Value;break;case"Filling in forms":this.protectionType="FormFieldsOnly",this.userWholeDiv.style.display="none",this.contentDiv1.innerHTML=this.localObj.getConstant("Protected Document"),this.contentDiv2.innerHTML=this.localObj.getConstant("FormFieldsOnly"),this.previousProtectionType=e.previousItemData.Value,this.showRemovedIgnoreDialog();break;case"Comments":this.protectionType="CommentsOnly",this.userWholeDiv.style.display="block",this.contentDiv1.innerHTML=this.localObj.getConstant("Protected Document"),this.contentDiv2.innerHTML=this.localObj.getConstant("CommentsOnly"),this.previousProtectionType=e.previousItemData.Value;break;case"Tracked changes":this.protectionType="RevisionsOnly",this.userWholeDiv.style.display="none",this.contentDiv1.innerHTML=this.localObj.getConstant("Protected Document"),this.contentDiv2.innerHTML=this.localObj.getConstant("TrackChangesOnly"),this.previousProtectionType=e.previousItemData.Value,this.showRemovedIgnoreDialog();break;default:this.protectionType="NoProtection",this.addedUser.uncheckAllItems(),this.viewer.owner.editor.removeAllEditRestrictions()}},e.prototype.showRemovedIgnoreDialog=function(){this.documentHelper.selection&&this.documentHelper.editRanges.length>0&&(this.documentHelper.dialog.height=" Auto",this.documentHelper.dialog.width=" 600px",this.documentHelper.dialog.header=this.localObj.getConstant("Information"),this.documentHelper.dialog.content=this.localObj.getConstant("RemovedIgnoreExceptions")+"<br><br>"+this.localObj.getConstant("RemovedIgnore"),this.documentHelper.dialog.buttons=[{click:this.onYesButtonClick,buttonModel:{content:this.localObj.getConstant("Yes")}},{click:this.onCancelButtonClick,buttonModel:{content:this.localObj.getConstant("Cancel")}},{click:this.onNoButtonClick,buttonModel:{content:this.localObj.getConstant("No")}}],this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show())},e.prototype.selectHandler=function(e){e.isChecked?(this.viewer.owner.editor.insertEditRangeElement(e.text),e.event.target.classList.add("e-check")):this.viewer.owner.editor.removeUserRestrictions(e.text)},e.prototype.highlightClicked=function(e){this.documentHelper.selection.isHighlightEditRegion=e.checked},e.prototype.protectDocument=function(){this.enforceProtectionDialog.show()},e.prototype.createCheckBox=function(e,t){var i=new r.CheckBox({label:e,enableRtl:this.documentHelper.owner.enableRtl});return i.appendTo(t),i},e.prototype.loadPaneValue=function(){switch(this.allowFormat.checked=!this.documentHelper.restrictFormatting,this.documentHelper.protectionType){case"ReadOnly":this.protectionTypeDrop.value="Read only";break;case"FormFieldsOnly":this.protectionTypeDrop.value="Filling in forms";break;case"CommentsOnly":this.protectionTypeDrop.value="Comments";break;case"RevisionsOnly":this.protectionTypeDrop.value="Tracked changes"}this.highlightCheckBox.checked=this.documentHelper.owner.documentEditorSettings.highlightEditableRanges,this.addedUser.enablePersistence=!0,this.addedUser.dataSource=this.usersCollection.slice(),this.addedUser.dataBind(),this.showStopProtectionPane(this.documentHelper.isDocumentProtected)},e.prototype.navigateNextRegion=function(){this.documentHelper.selection.navigateToNextEditingRegion()},e.prototype.addUserCollection=function(){if(this.documentHelper.selection&&this.documentHelper.selection.editRangeCollection.length>0)for(var e=0;e<this.documentHelper.selection.editRangeCollection.length;e++){var t=this.documentHelper.selection.editRangeCollection[e];""!==t.user&&-1===this.usersCollection.indexOf(t.user)&&this.usersCollection.push(t.user),""!==t.group&&-1===this.usersCollection.indexOf(t.group)&&this.usersCollection.push(t.group)}this.addedUser.dataSource=this.documentHelper.userCollection.slice(),this.addedUser.dataBind()},e.prototype.updateUserInformation=function(){if(this.addedUser.uncheckAllItems(),this.documentHelper.selection.checkSelectionIsAtEditRegion){var e=this.documentHelper.selection.getEditRangeStartElement();if(e){var t=this.addedUser.dataSource.indexOf(e.user);if(t>-1){var i=this.addedUser.element.querySelectorAll("li")[t];i.querySelector(".e-icons").classList.add("e-check")}if((t=this.addedUser.dataSource.indexOf(e.group))>-1){var i=this.addedUser.element.querySelectorAll("li")[t];i.querySelector(".e-icons").classList.add("e-check")}}}},e.prototype.destroy=function(){this.addUserDialog&&this.addUserDialog.destroy(),this.addUserDialog=void 0,this.enforceProtectionDialog&&this.enforceProtectionDialog.destroy(),this.enforceProtectionDialog=void 0,this.unProtectDialog&&this.unProtectDialog.destroy(),this.unProtectDialog=void 0,this.base64&&this.base64.destroy(),this.base64=void 0,this.addedUser&&(this.addedUser.destroy(),this.addedUser=void 0),this.allowFormat&&(this.allowFormat.destroy(),this.allowFormat=void 0),this.protectionTypeDrop&&(this.protectionTypeDrop.destroy(),this.protectionTypeDrop=void 0),this.highlightCheckBox&&(this.highlightCheckBox.destroy(),this.highlightCheckBox=void 0),this.addUser&&(this.addUser.innerHTML="",this.addUser.remove(),this.addUser=void 0),this.restrictPane&&(this.restrictPane.innerHTML="",this.restrictPane.remove(),this.restrictPane=void 0),this.enforceProtection&&(this.enforceProtection.innerHTML="",this.enforceProtection.remove(),this.enforceProtection=void 0),this.stopProtection&&(this.stopProtection.innerHTML="",this.stopProtection.remove(),this.stopProtection=void 0),this.stopProtectionDiv&&(this.stopProtectionDiv.innerHTML="",this.stopProtectionDiv.remove(),this.stopProtectionDiv=void 0),this.stopReadOnlyOptions&&(this.stopReadOnlyOptions.innerHTML="",this.stopReadOnlyOptions.remove(),this.stopReadOnlyOptions=void 0),this.contentDiv1&&(this.contentDiv1.innerHTML="",this.contentDiv1.remove(),this.contentDiv1=void 0),this.contentDiv2&&(this.contentDiv2.innerHTML="",this.contentDiv2.remove(),this.contentDiv2=void 0),this.closeButton&&(this.closeButton.innerHTML="",this.closeButton.remove(),this.closeButton=void 0),this.userWholeDiv&&(this.userWholeDiv.innerHTML="",this.userWholeDiv.remove(),this.userWholeDiv=void 0),this.restrictPaneWholeDiv&&(this.restrictPaneWholeDiv.innerHTML="",this.restrictPaneWholeDiv.remove(),this.restrictPaneWholeDiv=void 0),this.usersCollection=[],this.usersCollection=void 0,this.previousProtectionType=void 0,this.currentHashValue=void 0,this.currentSaltValue=void 0,this.documentHelper=void 0},e}())},function(e,t,i){"use strict";i.d(t,"a",function(){return n});var n=function(){function e(e){this.startIn=void 0,this.endIn=void 0,this.owner=e,this.documentHelper=this.owner.documentHelper}return Object.defineProperty(e.prototype,"start",{get:function(){return this.startIn},set:function(e){this.startIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this.endIn},set:function(e){this.endIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this.documentHelper.selection.getTextInternal(this.start,this.end,!1)},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.start=void 0,this.end=void 0},e}()},function(e,t,i){"use strict";i.d(t,"a",function(){return o});var n=i(0),r=(i.n(n),i(60)),o=function(){function e(e){this.currentIndex=-1,this.owner=e}return Object.defineProperty(e.prototype,"length",{get:function(){return void 0===this.innerList?0:this.innerList.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentSearchResult",{get:function(){if(!(void 0===this.innerList||this.currentIndex<0||this.currentIndex>=this.length))return this.innerList[this.currentIndex]},enumerable:!0,configurable:!0}),e.prototype.addResult=function(){var e=new r.a(this.owner);return i.i(n.isNullOrUndefined)(this.innerList)&&(this.innerList=[]),this.innerList.push(e),e},e.prototype.clearResults=function(){if(this.currentIndex=-1,!i.i(n.isNullOrUndefined)(this.innerList))for(var e=this.innerList.length-1;e>=0;e--)this.innerList[parseInt(e.toString(),10)].destroy(),this.innerList.splice(e,1)},e.prototype.indexOf=function(e){return i.i(n.isNullOrUndefined)(this.innerList)?-1:this.innerList.indexOf(e)},e.prototype.destroy=function(){i.i(n.isNullOrUndefined)(this.innerList)||this.clearResults(),this.innerList=void 0},e}()},function(e,t,i){"use strict";i.d(t,"a",function(){return h}),i.d(t,"h",function(){return c}),i.d(t,"i",function(){return p}),i.d(t,"b",function(){return u}),i.d(t,"j",function(){return g}),i.d(t,"c",function(){return f}),i.d(t,"f",function(){return m}),i.d(t,"e",function(){return v}),i.d(t,"d",function(){return y}),i.d(t,"g",function(){return w}),i.d(t,"k",function(){return b});var n=i(16),r=i(9),o=i(7),s=i(0),a=(i.n(s),i(24)),l=i(14),d=i(23),h=function(){function e(e){this.boldIn=void 0,this.italicIn=void 0,this.underlineIn=void 0,this.strikeThroughIn=void 0,this.baselineAlignmentIn=void 0,this.highlightColorIn=void 0,this.fontSizeIn=0,this.scriptType=n.a.English,this.fontColorIn=void 0,this.allCapsIn=void 0,this.boldBidi=void 0,this.italicBidi=void 0,this.fontSizeBidi=0,this.bidi=void 0,this.bdo=void 0,this.selection=e}return Object.defineProperty(e.prototype,"fontSize",{get:function(){return this.fontSizeIn},set:function(e){e!==this.fontSizeIn&&(this.fontSizeIn=e,this.notifyPropertyChanged("fontSize"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"renderedFontFamily",{get:function(){return this.renderedFontFamilyIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontFamily",{get:function(){return this.fontFamilyIn},set:function(e){e!==this.fontFamilyIn&&(this.fontFamilyIn=this.renderedFontFamilyIn=e,this.notifyPropertyChanged("fontFamily"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontColor",{get:function(){return this.fontColorIn},set:function(e){e!==this.fontColorIn&&(this.fontColorIn=e,this.notifyPropertyChanged("fontColor"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bold",{get:function(){return this.boldIn},set:function(e){e!==this.boldIn&&(this.boldIn=e,this.notifyPropertyChanged("bold"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"italic",{get:function(){return this.italicIn},set:function(e){e!==this.italic&&(this.italicIn=e,this.notifyPropertyChanged("italic"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strikethrough",{get:function(){return this.strikeThroughIn},set:function(e){e!==this.strikeThroughIn&&(this.strikeThroughIn=e,this.notifyPropertyChanged("strikethrough"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baselineAlignment",{get:function(){return this.baselineAlignmentIn},set:function(e){e!==this.baselineAlignmentIn&&(this.baselineAlignmentIn=e,this.notifyPropertyChanged("baselineAlignment"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"underline",{get:function(){return this.underlineIn},set:function(e){e!==this.underlineIn&&(this.underlineIn=e,this.notifyPropertyChanged("underline"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"highlightColor",{get:function(){return this.highlightColorIn},set:function(e){e===this.highlightColorIn&&"NoColor"!==e||(this.highlightColorIn=e,this.notifyPropertyChanged("highlightColor"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allCaps",{get:function(){return this.allCapsIn},set:function(e){e!==this.allCapsIn&&(this.allCapsIn=e,this.notifyPropertyChanged("allCaps"))},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(e){switch(e){case"bold":return this.bold;case"italic":return this.italic;case"fontSize":if(this.fontSize>=1)return this.fontSize;return;case"fontFamily":return this.fontFamily;case"strikethrough":return this.strikethrough;case"baselineAlignment":return this.baselineAlignment;case"highlightColor":return this.highlightColor;case"underline":return this.underline;case"fontColor":return this.fontColor;case"allCaps":return this.allCaps;default:return}},e.prototype.notifyPropertyChanged=function(e){if((i.i(s.isNullOrUndefined)(this.selection)||!(this.selection.isCleared||this.selection.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||!this.selection.owner.isDocumentLoaded||this.selection.owner.isPastingContent)||this.selection.isRetrieveFormatting)&&!i.i(s.isNullOrUndefined)(this.selection)&&!i.i(s.isNullOrUndefined)(this.selection.start)&&!this.selection.isRetrieveFormatting){var t=this.getPropertyValue(e);i.i(s.isNullOrUndefined)(t)||this.selection.owner.editorModule.onApplyCharacterFormat(e,t)}},e.prototype.copyFormat=function(e,t){this.styleName=i.i(s.isNullOrUndefined)(e.baseCharStyle)?"Default Paragraph Font":e.baseCharStyle.name,this.fontSize=e.fontSize,this.renderedFontFamilyIn=t,this.fontFamily=e.fontFamily,this.bold=e.bold,this.italic=e.italic,this.baselineAlignment=e.baselineAlignment,this.underline=e.underline,this.fontColor=e.fontColor,this.highlightColor=e.highlightColor,this.strikethrough=e.strikethrough,this.bidi=e.bidi,this.bdo=e.bdo,this.boldBidi=e.boldBidi,this.italicBidi=e.italicBidi,this.fontFamilyBidi=e.fontFamilyBidi,this.fontSizeBidi=e.fontSizeBidi,this.allCaps=e.allCaps},e.prototype.combineFormat=function(e,t){i.i(s.isNullOrUndefined)(this.bold)||this.bold===e.bold||(this.bold=void 0),i.i(s.isNullOrUndefined)(this.italic)||this.italic===e.italic||(this.italic=void 0),0!==this.fontSize&&this.fontSize!==e.fontSize&&(this.fontSize=0),i.i(s.isNullOrUndefined)(this.renderedFontFamily)||this.renderedFontFamily===t||(this.renderedFontFamilyIn=void 0),i.i(s.isNullOrUndefined)(this.fontFamily)||this.fontFamily===e.fontFamily||(this.fontFamily=void 0),i.i(s.isNullOrUndefined)(this.highlightColor)||this.highlightColor===e.highlightColor||(this.highlightColor=void 0),i.i(s.isNullOrUndefined)(this.baselineAlignment)||this.baselineAlignment===e.baselineAlignment||(this.baselineAlignment=void 0),i.i(s.isNullOrUndefined)(this.fontColor)||this.fontColor===e.fontColor||(this.fontColor=void 0),i.i(s.isNullOrUndefined)(this.underline)||this.underline===e.underline||(this.underline=void 0),i.i(s.isNullOrUndefined)(this.strikethrough)||this.strikethrough===e.strikethrough||(this.strikethrough=void 0),i.i(s.isNullOrUndefined)(this.boldBidi)||this.boldBidi===e.boldBidi||(this.boldBidi=void 0),i.i(s.isNullOrUndefined)(this.italicBidi)||this.italicBidi===e.italicBidi||(this.italicBidi=void 0),0!==this.fontSizeBidi&&this.fontSizeBidi!==e.fontSizeBidi&&(this.fontSizeBidi=0),i.i(s.isNullOrUndefined)(this.fontFamilyBidi)||this.fontFamilyBidi===e.fontFamilyBidi||(this.fontFamilyBidi=void 0),i.i(s.isNullOrUndefined)(this.bidi)||this.bidi===e.bidi||(this.bidi=void 0),i.i(s.isNullOrUndefined)(this.bdo)||this.bdo===e.bdo||(this.bdo=void 0),i.i(s.isNullOrUndefined)(this.allCaps)||this.allCaps===e.allCaps||(this.allCaps=void 0)},e.prototype.canRetrieveNextCharacterFormat=function(){return!(i.i(s.isNullOrUndefined)(this.bold)&&i.i(s.isNullOrUndefined)(this.italic)&&0===this.fontSize&&i.i(s.isNullOrUndefined)(this.fontFamily)&&i.i(s.isNullOrUndefined)(this.highlightColor)&&i.i(s.isNullOrUndefined)(this.baselineAlignment)&&i.i(s.isNullOrUndefined)(this.fontColor)&&i.i(s.isNullOrUndefined)(this.underline)&&i.i(s.isNullOrUndefined)(this.strikethrough)&&i.i(s.isNullOrUndefined)(this.boldBidi)&&i.i(s.isNullOrUndefined)(this.italicBidi)&&0===this.fontSizeBidi&&i.i(s.isNullOrUndefined)(this.fontFamilyBidi)&&i.i(s.isNullOrUndefined)(this.bdo)&&i.i(s.isNullOrUndefined)(this.allCaps))},e.prototype.cloneFormat=function(e){this.bold=e.bold,this.italic=e.italic,this.underline=e.underline,this.strikethrough=e.strikethrough,this.baselineAlignment=e.baselineAlignment,this.highlightColor=e.highlightColor,this.fontSize=e.fontSize,this.fontFamily=e.fontFamily,this.fontColor=e.fontColor,this.styleName=e.styleName,this.bidi=e.bidi,this.bdo=e.bdo,this.boldBidi=e.boldBidi,this.italicBidi=e.italicBidi,this.fontSizeBidi=e.fontSizeBidi,this.fontFamilyBidi=e.fontFamilyBidi,this.allCaps=e.allCaps},e.prototype.isEqualFormat=function(e){return this.fontSize===e.fontSize&&this.strikethrough===e.strikethrough&&this.bold===e.bold&&this.fontFamily===e.fontFamily&&this.underline===e.underline&&this.highlightColor===e.highlightColor&&this.italic===e.italic&&this.baselineAlignment===e.baselineAlignment&&this.fontColor===e.fontColor&&this.allCaps===e.allCaps},e.prototype.clearFormat=function(){this.fontSizeIn=0,this.boldIn=void 0,this.italicIn=void 0,this.fontFamilyIn=void 0,this.fontColorIn=void 0,this.underlineIn=void 0,this.strikeThroughIn=void 0,this.highlightColorIn=void 0,this.baselineAlignmentIn=void 0,this.styleName=void 0,this.bidi=void 0,this.bdo=void 0,this.boldBidi=void 0,this.italicBidi=void 0,this.fontFamilyBidi=void 0,this.fontSizeBidi=void 0,this.allCapsIn=void 0},e.prototype.destroy=function(){this.fontSizeIn=void 0,this.boldIn=void 0,this.italicIn=void 0,this.fontFamilyIn=void 0,this.fontColorIn=void 0,this.underlineIn=void 0,this.strikeThroughIn=void 0,this.baselineAlignmentIn=void 0,this.highlightColorIn=void 0,this.selection=void 0,this.styleName=void 0,this.bidi=void 0,this.bdo=void 0,this.boldBidi=void 0,this.italicBidi=void 0,this.fontFamilyBidi=void 0,this.fontSizeBidi=void 0,this.allCapsIn=void 0},e}(),c=function(){function e(e,t,i){this.colorIn=void 0,this.lineStyleIn=void 0,this.lineWidthIn=void 0,this.shadowIn=void 0,this.spaceIn=void 0,this.borderType=t,this.ownerBase=i,this.selection=e}return Object.defineProperty(e.prototype,"color",{get:function(){return this.colorIn},set:function(e){e!==this.colorIn&&(this.colorIn=e,this.notifyPropertyChanged("color"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineStyle",{get:function(){return this.lineStyleIn},set:function(e){e!==this.lineStyleIn&&(this.lineStyleIn=e,this.notifyPropertyChanged("lineStyle"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineWidth",{get:function(){return this.lineWidthIn},set:function(e){e!==this.lineWidthIn&&(this.lineWidthIn=e,this.notifyPropertyChanged("lineWidth"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shadow",{get:function(){return this.shadowIn},set:function(e){e!==this.shadowIn&&(this.shadowIn=e,this.notifyPropertyChanged("shadow"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"space",{get:function(){return this.spaceIn},set:function(e){e!==this.spaceIn&&(this.spaceIn=e,this.notifyPropertyChanged("space"))},enumerable:!0,configurable:!0}),e.prototype.copyFormat=function(e){this.color=e.color,this.lineStyle=e.lineStyle,this.lineWidth=e.lineWidth,this.shadow=e.shadow,this.space=e.space},e.prototype.combineFormat=function(e){i.i(s.isNullOrUndefined)(this.color)||this.color===e.color||(this.color=void 0),i.i(s.isNullOrUndefined)(this.lineStyle)||this.lineStyle===e.lineStyle||(this.lineStyle=void 0),i.i(s.isNullOrUndefined)(this.lineWidth)||this.lineWidth===e.lineWidth||(this.lineWidth=void 0),i.i(s.isNullOrUndefined)(this.shadow)||this.shadow===e.shadow||(this.shadow=void 0),i.i(s.isNullOrUndefined)(this.space)||this.space===e.space||(this.space=void 0)},e.prototype.getPropertyValue=function(e){switch(e){case"color":return this.color;case"lineStyle":return this.lineStyle;case"lineWidth":return this.lineWidth;case"space":return this.space;case"shadow":return this.shadow}},e.prototype.notifyPropertyChanged=function(e){if((i.i(s.isNullOrUndefined)(this.selection)||(!this.selection.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())&&this.selection.owner.isDocumentLoaded||this.selection.isRetrieveFormatting)&&!i.i(s.isNullOrUndefined)(this.selection)&&!i.i(s.isNullOrUndefined)(this.selection.start)&&!this.selection.isRetrieveFormatting){var t=this.selection.owner.editorModule,n=this.getPropertyValue(e);i.i(s.isNullOrUndefined)(n)||t.applyParagraphBorders(e,this.borderType,n)}},e.prototype.destroy=function(){i.i(s.isNullOrUndefined)(this.colorIn)||(this.colorIn=void 0),i.i(s.isNullOrUndefined)(this.lineStyleIn)||(this.lineStyleIn=void 0),i.i(s.isNullOrUndefined)(this.lineWidthIn)||(this.lineWidthIn=void 0),i.i(s.isNullOrUndefined)(this.spaceIn)||(this.spaceIn=void 0),i.i(s.isNullOrUndefined)(this.shadowIn)||(this.shadowIn=void 0)},e}(),p=function(){function e(e,t){this.ownerBase=void 0,this.ownerBase=t,this.selection=e,this.topIn=new c(this.selection,"topBorder",this),this.bottomIn=new c(this.selection,"bottomBorder",this),this.rightIn=new c(this.selection,"rightBorder",this),this.leftIn=new c(this.selection,"leftBorder",this),this.horizontalIn=new c(this.selection,"horizontalBorder",this),this.verticalIn=new c(this.selection,"verticalBorder",this)}return Object.defineProperty(e.prototype,"top",{get:function(){return this.topIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.bottomIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this.leftIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.rightIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"horizontal",{get:function(){return this.horizontalIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vertical",{get:function(){return this.verticalIn},enumerable:!0,configurable:!0}),e.prototype.copyFormat=function(e){this.top.copyFormat(e.top),this.bottom.copyFormat(e.bottom),this.left.copyFormat(e.left),this.right.copyFormat(e.right),this.horizontal.copyFormat(e.horizontal),this.vertical.copyFormat(e.vertical)},e.prototype.combineFormat=function(e){this.top.combineFormat(e.top),this.bottom.combineFormat(e.bottom),this.left.combineFormat(e.left),this.right.combineFormat(e.right),this.vertical.combineFormat(e.vertical),this.horizontal.combineFormat(e.horizontal)},e.prototype.destroy=function(){i.i(s.isNullOrUndefined)(this.topIn)||(this.topIn.destroy(),this.topIn=void 0),i.i(s.isNullOrUndefined)(this.topIn)||(this.bottomIn.destroy(),this.bottomIn=void 0),i.i(s.isNullOrUndefined)(this.leftIn)||(this.leftIn.destroy(),this.leftIn=void 0),i.i(s.isNullOrUndefined)(this.rightIn)||(this.rightIn.destroy(),this.rightIn=void 0),i.i(s.isNullOrUndefined)(this.horizontalIn)||(this.horizontalIn.destroy(),this.horizontalIn=void 0),i.i(s.isNullOrUndefined)(this.verticalIn)||(this.verticalIn.destroy(),this.verticalIn=void 0)},e}(),u=function(){function e(e,t){this.leftIndentIn=0,this.rightIndentIn=0,this.beforeSpacingIn=0,this.afterSpacingIn=0,this.spaceAfterAutoIn=void 0,this.spaceBeforeAutoIn=void 0,this.textAlignmentIn=void 0,this.outlineLevelIn=void 0,this.firstLineIndentIn=0,this.lineSpacingIn=1,this.lineSpacingTypeIn=void 0,this.bidiIn=void 0,this.keepWithNextIn=void 0,this.keepLinesTogetherIn=void 0,this.widowControlIn=void 0,this.contextualSpacingIn=void 0,this.listLevelNumberIn=-1,this.selection=e,this.documentHelper=t,this.bordersIn=new p(this.selection,this)}return Object.defineProperty(e.prototype,"borders",{get:function(){return this.bordersIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftIndent",{get:function(){return this.leftIndentIn},set:function(e){e!==this.leftIndentIn&&(this.leftIndentIn=e,this.notifyPropertyChanged("leftIndent"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightIndent",{get:function(){return this.rightIndentIn},set:function(e){e!==this.rightIndentIn&&(this.rightIndentIn=e,this.notifyPropertyChanged("rightIndent"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstLineIndent",{get:function(){return this.firstLineIndentIn},set:function(e){e!==this.firstLineIndentIn&&(this.firstLineIndentIn=e,this.notifyPropertyChanged("firstLineIndent"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textAlignment",{get:function(){return this.textAlignmentIn},set:function(e){e!==this.textAlignmentIn&&(this.textAlignmentIn=e,this.notifyPropertyChanged("textAlignment"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outlineLevel",{get:function(){return this.outlineLevelIn},set:function(e){e!==this.outlineLevelIn&&(this.outlineLevelIn=e,this.notifyPropertyChanged("outlineLevel"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"afterSpacing",{get:function(){return this.afterSpacingIn},set:function(e){e!==this.afterSpacingIn&&(this.afterSpacingIn=e,this.notifyPropertyChanged("afterSpacing"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"beforeSpacing",{get:function(){return this.beforeSpacingIn},set:function(e){e!==this.beforeSpacingIn&&(this.beforeSpacingIn=e,this.notifyPropertyChanged("beforeSpacing"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spaceAfterAuto",{get:function(){return this.spaceAfterAutoIn},set:function(e){e!==this.spaceAfterAutoIn&&(this.spaceAfterAutoIn=e,this.notifyPropertyChanged("spaceAfterAuto"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spaceBeforeAuto",{get:function(){return this.spaceBeforeAutoIn},set:function(e){e!==this.spaceBeforeAutoIn&&(this.spaceBeforeAutoIn=e,this.notifyPropertyChanged("spaceBeforeAuto"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineSpacing",{get:function(){return this.lineSpacingIn},set:function(e){e!==this.lineSpacingIn&&(this.lineSpacingIn=e,this.notifyPropertyChanged("lineSpacing"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineSpacingType",{get:function(){return this.lineSpacingTypeIn},set:function(e){e!==this.lineSpacingTypeIn&&(this.lineSpacingTypeIn=e,this.notifyPropertyChanged("lineSpacingType"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"listLevelNumber",{get:function(){return this.listLevelNumberIn},set:function(e){e!==this.listLevelNumberIn&&(this.listLevelNumberIn=e,this.notifyPropertyChanged("listLevelNumber"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bidi",{get:function(){return this.bidiIn},set:function(e){this.bidiIn=e,this.notifyPropertyChanged("bidi")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"keepWithNext",{get:function(){return this.keepWithNextIn},set:function(e){this.keepWithNextIn=e,this.notifyPropertyChanged("keepWithNext")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"keepLinesTogether",{get:function(){return this.keepLinesTogetherIn},set:function(e){this.keepLinesTogetherIn=e,this.notifyPropertyChanged("keepLinesTogether")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"widowControl",{get:function(){return this.widowControlIn},set:function(e){this.widowControlIn=e,this.notifyPropertyChanged("widowControl")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contextualSpacing",{get:function(){return this.contextualSpacingIn},set:function(e){this.contextualSpacingIn=e,this.notifyPropertyChanged("contextualSpacing")},enumerable:!0,configurable:!0}),e.prototype.validateLineSpacing=function(){return"Multiple"!==this.lineSpacingType&&this.lineSpacingIn<12},Object.defineProperty(e.prototype,"listText",{get:function(){var e=void 0,t=this.documentHelper.getListById(this.listId);if(t instanceof a.a&&this.listLevelNumberIn>-1&&this.listLevelNumberIn<9){var i=t.getListLevel(this.listLevelNumber);if(i instanceof d.a)if("Bullet"===i.listLevelPattern)e=i.numberFormat;else{e=i.numberFormat;for(var n=0;n<9;n++){var r="%"+(n+1);if(e.indexOf(r)>-1){var o=(n===this.listLevelNumberIn||t.getListLevel(n),this.selection.getListTextElementBox(this.selection.start.paragraph)),s=o?o.text:"";e=s}}}}return e},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(e){switch(e){case"leftIndent":return this.leftIndent;case"rightIndent":return this.rightIndent;case"firstLineIndent":return this.firstLineIndent;case"beforeSpacing":return this.beforeSpacing;case"afterSpacing":return this.afterSpacing;case"spaceAfterAuto":return this.spaceAfterAuto;case"spaceBeforeAuto":return this.spaceBeforeAuto;case"textAlignment":return this.textAlignment;case"lineSpacing":return this.lineSpacing;case"lineSpacingType":return this.lineSpacingType;case"bidi":return this.bidi;case"contextualSpacing":return this.contextualSpacing;case"keepWithNext":return this.keepWithNext;case"keepLinesTogether":return this.keepLinesTogether;case"widowControl":return this.widowControl;case"outlineLevel":return this.outlineLevel;default:return}},e.prototype.notifyPropertyChanged=function(e){if((i.i(s.isNullOrUndefined)(this.selection)||(!this.selection.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())&&this.selection.owner.isDocumentLoaded||this.selection.isRetrieveFormatting)&&!i.i(s.isNullOrUndefined)(this.selection)&&!i.i(s.isNullOrUndefined)(this.selection.start)&&!this.selection.isRetrieveFormatting){var t=this.selection.owner.editorModule;if("lineSpacing"===e||"lineSpacingType"===e){var n=this.selection.owner.editorHistory;if((!n||!n.isUndoing&&!n.isRedoing)&&this.validateLineSpacing()){if(this.selection.owner.editorHistory.initComplexHistory(this.selection,"LineSpacing"),"lineSpacing"===e){this.lineSpacingTypeIn="Multiple";var r=this.getPropertyValue("lineSpacingType");t.onApplyParagraphFormat("lineSpacingType",r,!1,!1),t.onApplyParagraphFormat(e,this.getPropertyValue(e),!1,!1)}else t.onApplyParagraphFormat(e,this.getPropertyValue(e),!1,!1),this.lineSpacingIn=12,t.onApplyParagraphFormat("lineSpacing",this.getPropertyValue("lineSpacing"),!1,!1);return void this.selection.owner.editorHistory.updateComplexHistory()}}var o=this.getPropertyValue(e);if(!("leftIndent"!==e&&"rightIndent"!==e&&"firstLineIndent"!==e||o>=-1056&&o<1056))return;"listLevelNumber"===e?t.onApplyListInternal(this.documentHelper.getListById(this.listId),this.listLevelNumber):t.onApplyParagraphFormat(e,o,"textAlignment"===e,!1)}},e.prototype.copyFormat=function(e){this.styleName=i.i(s.isNullOrUndefined)(e.baseStyle)?"Normal":e.baseStyle.name,this.leftIndent=e.leftIndent,this.rightIndent=e.rightIndent,this.firstLineIndent=e.firstLineIndent,this.afterSpacing=e.afterSpacing,this.beforeSpacing=e.beforeSpacing,this.spaceAfterAuto=e.spaceAfterAuto,this.spaceBeforeAuto=e.spaceBeforeAuto,this.lineSpacing=e.lineSpacing,this.lineSpacingType=e.lineSpacingType,this.textAlignment=e.textAlignment,this.outlineLevel=e.outlineLevel,this.bidi=e.bidi,this.keepLinesTogether=e.keepLinesTogether,this.keepWithNext=e.keepWithNext,this.widowControl=e.widowControl,this.contextualSpacing=e.contextualSpacing,this.borders.copyFormat(e.borders),i.i(s.isNullOrUndefined)(e.listFormat)||i.i(s.isNullOrUndefined)(e.listFormat.listId)?(this.listId=void 0,this.listLevelNumber=0):(this.listId=e.listFormat.listId,this.listLevelNumber=e.listFormat.listLevelNumber)},e.prototype.copyToFormat=function(e){i.i(s.isNullOrUndefined)(e)||(i.i(s.isNullOrUndefined)(this.afterSpacing)||(e.afterSpacing=this.afterSpacing),i.i(s.isNullOrUndefined)(this.beforeSpacing)||(e.beforeSpacing=this.beforeSpacing),i.i(s.isNullOrUndefined)(this.spaceAfterAuto)||(e.spaceAfterAuto=this.spaceAfterAuto),i.i(s.isNullOrUndefined)(this.spaceBeforeAuto)||(e.spaceBeforeAuto=this.spaceBeforeAuto),i.i(s.isNullOrUndefined)(this.leftIndent)||(e.leftIndent=this.leftIndent),i.i(s.isNullOrUndefined)(this.rightIndent)||(e.rightIndent=this.rightIndent),i.i(s.isNullOrUndefined)(this.textAlignment)||(e.textAlignment=this.textAlignment),i.i(s.isNullOrUndefined)(this.outlineLevel)||(e.outlineLevel=this.outlineLevel),i.i(s.isNullOrUndefined)(this.lineSpacing)||(e.lineSpacing=this.lineSpacing),i.i(s.isNullOrUndefined)(this.lineSpacingType)||(e.lineSpacingType=this.lineSpacingType),i.i(s.isNullOrUndefined)(this.firstLineIndent)||(e.firstLineIndent=this.firstLineIndent),i.i(s.isNullOrUndefined)(this.bidi)||(e.bidi=this.bidi),i.i(s.isNullOrUndefined)(this.keepWithNext)||(e.keepWithNext=this.keepWithNext),i.i(s.isNullOrUndefined)(this.keepLinesTogether)||(e.keepLinesTogether=this.keepLinesTogether),i.i(s.isNullOrUndefined)(this.widowControl)||(e.widowControl=this.widowControl),i.i(s.isNullOrUndefined)(this.contextualSpacing)||(e.contextualSpacing=this.contextualSpacing))},e.prototype.combineFormat=function(e){i.i(s.isNullOrUndefined)(this.leftIndent)||this.leftIndent===e.leftIndent||(this.leftIndent=void 0),i.i(s.isNullOrUndefined)(this.rightIndent)||this.rightIndent===e.rightIndent||(this.rightIndent=void 0),i.i(s.isNullOrUndefined)(this.firstLineIndent)||this.firstLineIndent===e.firstLineIndent||(this.firstLineIndent=void 0),0!==this.lineSpacing&&this.lineSpacing!==e.lineSpacing&&(this.lineSpacing=0),-1!==this.beforeSpacing&&this.beforeSpacing!==e.beforeSpacing&&(this.beforeSpacing=-1),-1!==this.afterSpacing&&this.afterSpacing!==e.afterSpacing&&(this.afterSpacing=-1),i.i(s.isNullOrUndefined)(this.spaceAfterAuto)||this.spaceAfterAuto===e.spaceAfterAuto||(this.spaceAfterAuto=void 0),i.i(s.isNullOrUndefined)(this.spaceBeforeAuto)||this.spaceBeforeAuto===e.spaceBeforeAuto||(this.spaceBeforeAuto=void 0),i.i(s.isNullOrUndefined)(this.lineSpacingType)||this.lineSpacingType===e.lineSpacingType||(this.lineSpacingType=void 0),i.i(s.isNullOrUndefined)(this.textAlignment)||this.textAlignment===e.textAlignment||(this.textAlignment=void 0),i.i(s.isNullOrUndefined)(this.outlineLevel)||this.outlineLevel===e.outlineLevel||(this.outlineLevel=void 0),this.listLevelNumber>=0&&!i.i(s.isNullOrUndefined)(this.listId)&&(i.i(s.isNullOrUndefined)(e.listFormat)||e.listFormat.listLevelNumber!==this.listLevelNumber)&&(this.listLevelNumber=-1),(i.i(s.isNullOrUndefined)(e.listFormat)||i.i(s.isNullOrUndefined)(e.listFormat.listId)||!i.i(s.isNullOrUndefined)(this.listId)&&this.listId!==e.listFormat.listId)&&(this.listId=void 0),i.i(s.isNullOrUndefined)(this.bidi)||this.bidi===e.bidi||(this.bidi=void 0),i.i(s.isNullOrUndefined)(this.keepLinesTogether)||this.keepLinesTogether===e.keepLinesTogether||(this.keepLinesTogether=void 0),i.i(s.isNullOrUndefined)(this.keepWithNext)||this.keepWithNext===e.keepWithNext||(this.keepWithNext=void 0),i.i(s.isNullOrUndefined)(this.widowControl)||this.widowControl===e.widowControl||(this.widowControl=void 0),i.i(s.isNullOrUndefined)(this.contextualSpacing)||this.contextualSpacing===e.contextualSpacing||(this.contextualSpacing=void 0),!i.i(s.isNullOrUndefined)(this.styleName)&&e.baseStyle&&this.styleName!==e.baseStyle.name&&(this.styleName=void 0),this.borders.combineFormat(e.borders)},e.prototype.clearFormat=function(){this.leftIndent=0,this.rightIndent=0,this.beforeSpacing=0,this.afterSpacing=0,this.spaceAfterAuto=void 0,this.spaceBeforeAuto=void 0,this.firstLineIndent=0,this.lineSpacing=1,this.textAlignment=void 0,this.lineSpacingType=void 0,this.listId=void 0,this.listLevelNumber=-1,this.styleName=void 0,this.bidi=void 0,this.contextualSpacing=void 0},e.prototype.getList=function(){var e=this.documentHelper.getListById(this.listId);if(!i.i(s.isNullOrUndefined)(e)){var t=new a.a,n=new l.a,r=this.documentHelper.getAbstractListById(e.abstractListId),o=this.selection.owner.editorModule;if(i.i(s.isNullOrUndefined)(r))n.levels.push(new d.a(n));else for(var h=0;h<r.levels.length;h++){var c=o.cloneListLevel(r.levels[h]);n.levels.push(c),c.ownerBase=n}if(!i.i(s.isNullOrUndefined)(e.levelOverrides))for(var h=0;h<e.levelOverrides.length;h++){var p=o.cloneLevelOverride(e.levelOverrides[h]);t.levelOverrides.push(p)}return t.abstractList=n,t.abstractListId=n.abstractListId,t.sourceListId=e.listId,t}},e.prototype.setList=function(e,t){if((!this.documentHelper.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())&&this.documentHelper.owner.isDocumentLoaded){var n=this.documentHelper.getListById(this.listId),r=void 0,o=e?this.documentHelper.getAbstractListById(e.abstractListId):void 0;if(i.i(s.isNullOrUndefined)(n)||i.i(s.isNullOrUndefined)(e)||i.i(s.isNullOrUndefined)(o)||e.sourceListId!==n.listId)i.i(s.isNullOrUndefined)(e)?this.selection.owner.editorModule.onApplyList(void 0):(this.selection.owner.isLayoutEnabled=!1,i.i(s.isNullOrUndefined)(o)||-1!==this.documentHelper.abstractLists.indexOf(o)||this.documentHelper.abstractLists.push(o),-1===this.documentHelper.lists.indexOf(e)&&this.documentHelper.lists.push(e),this.selection.owner.isLayoutEnabled=!0,this.selection.owner.editorModule.onApplyList(e));else{var a=this.documentHelper.owner.editorHistory;this.documentHelper.layout.getListLevel(n,1);this.selection.owner.isLayoutEnabled=!1,this.documentHelper.owner.editorModule.setOffsetValue(this.selection),a&&(r=a.updateListChangesInHistory(o,n)),this.documentHelper.owner.editorModule.updateListParagraphs(),a&&a.applyListChanges(this.selection,r),this.selection.owner.isLayoutEnabled=!0,this.documentHelper.renderedLists.clear(),this.documentHelper.renderedLevelOverrides=[],t&&this.documentHelper.layout.clearInvalidList(e),this.documentHelper.owner.editorModule.layoutWholeDocument(),this.documentHelper.owner.editorModule.updateSelectionTextPosition(!1),a&&a.currentBaseHistoryInfo&&(a.currentBaseHistoryInfo.modifiedProperties.length>0&&a.currentBaseHistoryInfo.updateSelection(),a.updateHistory()),this.documentHelper.owner.editorModule.fireContentChange()}}},e.prototype.destroy=function(){this.leftIndentIn=void 0,this.rightIndentIn=void 0,this.beforeSpacingIn=void 0,this.afterSpacingIn=void 0,this.spaceBeforeAutoIn=void 0,this.spaceAfterAutoIn=void 0,this.firstLineIndentIn=void 0,this.lineSpacingIn=void 0,this.textAlignmentIn=void 0,this.lineSpacingTypeIn=void 0,this.listId=void 0,this.listLevelNumberIn=void 0,this.documentHelper=void 0,this.selection=void 0,this.styleName=void 0,this.bidi=void 0,this.contextualSpacing=void 0,i.i(s.isNullOrUndefined)(this.bordersIn)||(this.bordersIn.destroy(),this.bordersIn=void 0)},e}(),g=function(){function e(e){this.linkToPreviousIn=!0,this.selection=e}return Object.defineProperty(e.prototype,"linkToPrevious",{get:function(){return this.linkToPreviousIn},set:function(e){this.linkToPreviousIn=e,this.notifyPropertyChanged("linkToPrevious")},enumerable:!0,configurable:!0}),e.prototype.notifyPropertyChanged=function(e){var t=this.selection;if((i.i(s.isNullOrUndefined)(t)||!(t.isCleared||t.owner.isPastingContent||t.owner.isReadOnlyMode)&&t.owner.isDocumentLoaded||t.isRetrieveFormatting)&&!i.i(s.isNullOrUndefined)(t)&&!i.i(s.isNullOrUndefined)(t.start)&&!t.isRetrieveFormatting){var n=this.getPropertyvalue(e);if(!i.i(s.isNullOrUndefined)(n)){var r=t.start.paragraph.bodyWidget,o=r.sectionIndex,a=r.headerFooterType;t.owner.editorModule.removeInlineHeaderFooterWidget(o,a,e,n)}}},e.prototype.getPropertyvalue=function(e){if("linkToPrevious"==e&&!i.i(s.isNullOrUndefined)(this.linkToPrevious))return this.linkToPrevious},e}(),f=function(){function e(e){this.differentFirstPageIn=void 0,this.differentOddAndEvenPagesIn=void 0,this.bidi=void 0,this.selection=e,this.firstPageHeaderIn=new g(e),this.firstPageFooterIn=new g(e),this.oddPageHeaderIn=new g(e),this.oddPageFooterIn=new g(e),this.evenPageHeaderIn=new g(e),this.evenPageFooterIn=new g(e)}return Object.defineProperty(e.prototype,"pageHeight",{get:function(){return this.pageHeightIn},set:function(e){this.pageHeightIn=e,this.notifyPropertyChanged("pageHeight")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageWidth",{get:function(){return this.pageWidthIn},set:function(e){this.pageWidthIn=e,this.notifyPropertyChanged("pageWidth")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftMargin",{get:function(){return this.leftMarginIn},set:function(e){this.leftMarginIn=e,this.notifyPropertyChanged("leftMargin")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomMargin",{get:function(){return this.bottomMarginIn},set:function(e){this.bottomMarginIn=e,this.notifyPropertyChanged("bottomMargin")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topMargin",{get:function(){return this.topMarginIn},set:function(e){this.topMarginIn=e,this.notifyPropertyChanged("topMargin")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightMargin",{get:function(){return this.rightMarginIn},set:function(e){this.rightMarginIn=e,this.notifyPropertyChanged("rightMargin")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"headerDistance",{get:function(){return this.headerDistanceIn},set:function(e){this.headerDistanceIn=e,this.notifyPropertyChanged("headerDistance")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstPageHeader",{get:function(){return this.firstPageHeaderIn},set:function(e){this.firstPageHeaderIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstPageFooter",{get:function(){return this.firstPageFooterIn},set:function(e){this.firstPageFooterIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"oddPageHeader",{get:function(){return this.oddPageHeaderIn},set:function(e){this.oddPageHeaderIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"oddPageFooter",{get:function(){return this.oddPageFooterIn},set:function(e){this.oddPageFooterIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"evenPageHeader",{get:function(){return this.evenPageHeaderIn},set:function(e){this.evenPageHeaderIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"evenPageFooter",{get:function(){return this.evenPageFooterIn},set:function(e){this.evenPageFooterIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageStartingNumber",{get:function(){return this.pageStartingNumberIn},set:function(e){this.pageStartingNumberIn=e,this.notifyPropertyChanged("pageStartingNumber")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"restartPageNumbering",{get:function(){return this.restartPageNumberingIn},set:function(e){this.restartPageNumberingIn=e,this.notifyPropertyChanged("restartPageNumbering")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"footerDistance",{get:function(){return this.footerDistanceIn},set:function(e){this.footerDistanceIn=e,this.notifyPropertyChanged("footerDistance")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"differentFirstPage",{get:function(){return this.differentFirstPageIn},set:function(e){this.differentFirstPageIn=e,this.notifyPropertyChanged("differentFirstPage")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"differentOddAndEvenPages",{get:function(){return this.differentOddAndEvenPagesIn},set:function(e){this.differentOddAndEvenPagesIn=e,this.notifyPropertyChanged("differentOddAndEvenPages")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endnoteNumberFormat",{get:function(){return this.endnoteNumberFormatIn},set:function(e){this.endnoteNumberFormatIn=e,this.notifyPropertyChanged("endnoteNumberFormat")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"footNoteNumberFormat",{get:function(){return this.footNoteNumberFormatIn},set:function(e){this.footNoteNumberFormatIn=e,this.notifyPropertyChanged("footNoteNumberFormat")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"initialFootNoteNumber",{get:function(){return this.initialFootNoteNumberIn},set:function(e){this.initialFootNoteNumberIn=e,this.notifyPropertyChanged("initialFootNoteNumber")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"initialEndNoteNumber",{get:function(){return this.initialEndNoteNumberIn},set:function(e){this.initialEndNoteNumberIn=e,this.notifyPropertyChanged("initialEndNoteNumber")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"restartIndexForFootnotes",{get:function(){return this.restartIndexForFootnotesIn},set:function(e){this.restartIndexForFootnotesIn=e,this.notifyPropertyChanged("restartIndexForFootnotes")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"restartIndexForEndnotes",{get:function(){return this.restartIndexForEndnotesIn},set:function(e){this.restartIndexForEndnotesIn=e,this.notifyPropertyChanged("restartIndexForEndnotes")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numberOfColumns",{get:function(){return 0==this.columns.length?1:this.columns.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"equalWidth",{get:function(){return this.equalWidthIn},set:function(e){this.equalWidthIn=e,this.notifyPropertyChanged("equalWidth")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineBetweenColumns",{get:function(){return this.lineBetweenColumnsIn},set:function(e){this.lineBetweenColumnsIn=e,this.notifyPropertyChanged("lineBetweenColumns")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columns",{get:function(){return this.columnsIn},set:function(e){this.columnsIn=e;var t=this.selection;(i.i(s.isNullOrUndefined)(t)||!(t.isCleared||t.owner.isPastingContent||t.owner.isReadOnlyMode)&&t.owner.isDocumentLoaded||t.isRetrieveFormatting)&&(i.i(s.isNullOrUndefined)(t)||i.i(s.isNullOrUndefined)(t.start)||t.isRetrieveFormatting||this.selection.owner.editorModule.onApplyColumnFormat("columns",e))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"breakCode",{get:function(){return this.breakCodeIn},set:function(e){this.breakCodeIn=e,this.notifyPropertyChanged("breakCode")},enumerable:!0,configurable:!0}),e.prototype.copyFormat=function(e){this.pageHeight=e.pageHeight,this.pageWidth=e.pageWidth,this.leftMargin=e.leftMargin,this.topMargin=e.topMargin,this.rightMargin=e.rightMargin,this.bottomMargin=e.bottomMargin,this.headerDistance=e.headerDistance,this.footerDistance=e.footerDistance,this.differentFirstPage=e.differentFirstPage,this.differentOddAndEvenPages=e.differentOddAndEvenPages,this.bidi=e.bidi,this.pageStartingNumber=e.pageStartingNumber,this.restartPageNumbering=e.restartPageNumbering,this.endnoteNumberFormat=e.endnoteNumberFormat,this.footNoteNumberFormat=e.footNoteNumberFormat,this.restartIndexForEndnotes=e.restartIndexForEndnotes,this.restartIndexForFootnotes=e.restartIndexForFootnotes,this.initialEndNoteNumber=e.initialEndNoteNumber,this.initialFootNoteNumber=e.initialFootNoteNumber,this.equalWidth=e.equalWidth,this.lineBetweenColumns=e.lineBetweenColumns,this.columns=[];for(var t=0,n=e.columns;t<n.length;t++){var r=n[t],a=new b(this.selection);a.width=o.h.convertPixelToPoint(r.width),a.space=o.h.convertPixelToPoint(r.space),this.columns.push(a)}if(this.breakCode=e.breakCode,this.selection.owner.enableHeaderAndFooter){var l=this.selection.documentHelper.headersFooters,d=this.selection.start.paragraph.containerWidget,h=d.sectionIndex,c=d.headerFooterType,p=!1;if(0==h)this.oddPageHeader.linkToPrevious=!1,this.oddPageFooter.linkToPrevious=!1,this.evenPageHeader.linkToPrevious=!1,this.evenPageFooter.linkToPrevious=!1,this.firstPageHeader.linkToPrevious=!1,this.firstPageFooter.linkToPrevious=!1;else if(l[h]){var u=this.selection.viewer.getHeaderFooter(c),g=l[h][u];if(i.i(s.isNullOrUndefined)(g)&&(p=!0),!i.i(s.isNullOrUndefined)(g)||p)switch(c){case"OddHeader":this.oddPageHeader.linkToPrevious=!!p;break;case"OddFooter":this.oddPageFooter.linkToPrevious=!!p;break;case"EvenHeader":this.evenPageHeader.linkToPrevious=!!p;break;case"EvenFooter":this.evenPageFooter.linkToPrevious=!!p;break;case"FirstPageHeader":this.firstPageHeader.linkToPrevious=!!p;break;case"FirstPageFooter":this.firstPageFooter.linkToPrevious=!!p}}}},e.prototype.applyColumnFormat=function(){},e.prototype.notifyPropertyChanged=function(e){var t=this.selection;if((i.i(s.isNullOrUndefined)(t)||!(t.isCleared||t.owner.isPastingContent||t.owner.isReadOnlyMode)&&t.owner.isDocumentLoaded||t.isRetrieveFormatting)&&!i.i(s.isNullOrUndefined)(t)&&!i.i(s.isNullOrUndefined)(t.start)&&!t.isRetrieveFormatting){var n=this.getPropertyvalue(e);i.i(s.isNullOrUndefined)(n)||t.owner.editorModule.onApplySectionFormat(e,n)}},e.prototype.getPropertyvalue=function(e){switch(e){case"pageHeight":if(this.pageHeight>0)return this.pageHeight;return;case"pageWidth":if(this.pageWidth>0)return this.pageWidth;return;case"leftMargin":if(this.leftMargin>=0)return this.leftMargin;return;case"rightMargin":if(this.rightMargin>=0)return this.rightMargin;return;case"topMargin":if(this.topMargin>=0)return this.topMargin;return;case"bottomMargin":if(this.bottomMargin>=0)return this.bottomMargin;return;case"differentFirstPage":if(!i.i(s.isNullOrUndefined)(this.differentFirstPage))return this.differentFirstPage;return;case"differentOddAndEvenPages":if(!i.i(s.isNullOrUndefined)(this.differentOddAndEvenPages))return this.differentOddAndEvenPages;return;case"headerDistance":return this.headerDistanceIn;case"footerDistance":return this.footerDistance;case"pageStartingNumber":if(!i.i(s.isNullOrUndefined)(this.pageStartingNumber))return this.pageStartingNumber;return;case"restartPageNumbering":if(!i.i(s.isNullOrUndefined)(this.restartPageNumbering))return this.restartPageNumbering;return;case"endnoteNumberFormat":return this.endnoteNumberFormatIn;case"restartIndexForEndnotes":return this.restartIndexForEndnotesIn;case"restartIndexForFootnotes":return this.restartIndexForFootnotesIn;case"footNoteNumberFormat":return this.footNoteNumberFormatIn;case"initialFootNoteNumber":return this.initialFootNoteNumber;case"initialEndNoteNumber":return this.initialEndNoteNumber;case"equalWidth":return this.equalWidthIn;case"lineBetweenColumns":return this.lineBetweenColumnsIn;case"columns":return this.columnsIn;case"breakCode":return this.breakCodeIn;default:return}},e.prototype.combineFormat=function(e){this.pageHeight>0&&this.pageHeight!==e.pageHeight&&(this.pageHeight=0),this.pageWidth>0&&this.pageWidth!==e.pageWidth&&(this.pageWidth=0),this.leftMargin>-1&&this.leftMargin!==e.leftMargin&&(this.leftMargin=-1),this.topMargin>-1&&this.topMargin!==e.topMargin&&(this.topMargin=-1),this.rightMargin>-1&&this.rightMargin!==e.rightMargin&&(this.rightMargin=-1),this.bottomMargin>-1&&this.bottomMargin!==e.bottomMargin&&(this.bottomMargin=-1),0!==this.headerDistance&&this.headerDistance!==e.headerDistance&&(this.headerDistance=0),0!==this.footerDistance&&this.footerDistance!==e.footerDistance&&(this.footerDistance=0),i.i(s.isNullOrUndefined)(this.differentFirstPage)||this.differentFirstPage===e.differentFirstPage||(this.differentFirstPage=void 0),i.i(s.isNullOrUndefined)(this.pageStartingNumber)||this.pageStartingNumber===e.pageStartingNumber||(this.pageStartingNumber=void 0),i.i(s.isNullOrUndefined)(this.restartPageNumbering)||this.restartPageNumbering===e.restartPageNumbering||(this.restartPageNumbering=void 0),i.i(s.isNullOrUndefined)(this.differentOddAndEvenPages)||this.differentOddAndEvenPages===e.differentOddAndEvenPages||(this.differentOddAndEvenPages=void 0),i.i(s.isNullOrUndefined)(this.bidi)||this.bidi===e.bidi||(this.bidi=void 0),i.i(s.isNullOrUndefined)(this.endnoteNumberFormat)||this.endnoteNumberFormat===e.endnoteNumberFormat||(this.endnoteNumberFormat=void 0),i.i(s.isNullOrUndefined)(this.restartIndexForEndnotes)||this.restartIndexForEndnotes===e.restartIndexForEndnotes||(this.restartIndexForEndnotes=void 0),i.i(s.isNullOrUndefined)(this.restartIndexForFootnotes)||this.restartIndexForFootnotes===e.restartIndexForFootnotes||(this.restartIndexForFootnotes=void 0),i.i(s.isNullOrUndefined)(this.footNoteNumberFormat)||this.footNoteNumberFormat===e.footNoteNumberFormat||(this.footNoteNumberFormat=void 0),i.i(s.isNullOrUndefined)(this.initialFootNoteNumber)||this.initialFootNoteNumber===e.initialFootNoteNumber||(this.initialFootNoteNumber=void 0),i.i(s.isNullOrUndefined)(this.initialEndNoteNumber)||this.initialEndNoteNumber===e.initialEndNoteNumber||(this.initialEndNoteNumber=void 0)},e.prototype.clearFormat=function(){this.headerDistance=0,this.footerDistance=0,this.pageHeight=0,this.pageWidth=0,this.leftMargin=-1,this.rightMargin=-1,this.topMargin=-1,this.bottomMargin=-1,this.differentFirstPage=void 0,this.differentOddAndEvenPages=void 0,this.bidi=void 0,this.pageStartingNumber=void 0,this.restartPageNumbering=void 0,this.endnoteNumberFormat=void 0,this.footNoteNumberFormat=void 0,this.restartIndexForFootnotes=void 0,this.restartIndexForEndnotes=void 0,this.initialFootNoteNumber=1,this.initialEndNoteNumber=1},e.prototype.destroy=function(){this.headerDistanceIn=void 0,this.footerDistanceIn=void 0,this.pageHeightIn=void 0,this.pageWidthIn=void 0,this.leftMarginIn=void 0,this.rightMarginIn=void 0,this.topMarginIn=void 0,this.bottomMarginIn=void 0,this.differentFirstPageIn=void 0,this.differentOddAndEvenPagesIn=void 0,this.selection=void 0,this.bidi=void 0,this.pageStartingNumberIn=void 0,this.restartPageNumberingIn=void 0,this.endnoteNumberFormatIn=void 0,this.footNoteNumberFormatIn=void 0,this.restartIndexForFootnotesIn=void 0,this.restartIndexForEndnotesIn=void 0,this.initialEndNoteNumber=void 0,this.initialFootNoteNumber=void 0,this.firstPageHeaderIn=void 0,this.firstPageFooterIn=void 0,this.oddPageHeaderIn=void 0,this.oddPageFooterIn=void 0,this.evenPageHeaderIn=void 0,this.evenPageFooterIn=void 0},e}(),m=function(){function e(e){this.leftIndentIn=0,this.backgroundIn=void 0,this.tableAlignmentIn=void 0,this.cellSpacingIn=0,this.leftMarginIn=0,this.rightMarginIn=0,this.topMarginIn=0,this.bottomMarginIn=0,this.preferredWidthIn=0,this.bidiIn=void 0,this.selection=e}return Object.defineProperty(e.prototype,"table",{get:function(){return this.tableIn},set:function(e){this.tableIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"title",{get:function(){return this.titleIn},set:function(e){i.i(s.isNullOrUndefined)(this.table)||(this.titleIn=e,this.notifyPropertyChanged("title"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"description",{get:function(){return this.descriptionIn},set:function(e){i.i(s.isNullOrUndefined)(this.table)||(this.descriptionIn=e,this.notifyPropertyChanged("description"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftIndent",{get:function(){return this.leftIndentIn},set:function(e){e!==this.leftIndentIn&&(this.leftIndentIn=e,this.notifyPropertyChanged("leftIndent"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topMargin",{get:function(){return this.topMarginIn},set:function(e){e!==this.topMarginIn&&(this.topMarginIn=e,this.notifyPropertyChanged("topMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"background",{get:function(){return this.backgroundIn},set:function(e){e!==this.backgroundIn&&(this.backgroundIn=e,this.notifyPropertyChanged("background"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tableAlignment",{get:function(){return this.tableAlignmentIn},set:function(e){e!==this.tableAlignmentIn&&(this.tableAlignmentIn=e,this.notifyPropertyChanged("tableAlignment"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftMargin",{get:function(){return this.leftMarginIn},set:function(e){e!==this.leftMarginIn&&(this.leftMarginIn=e,this.notifyPropertyChanged("leftMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomMargin",{get:function(){return this.bottomMarginIn},set:function(e){e!==this.bottomMarginIn&&(this.bottomMarginIn=e,this.notifyPropertyChanged("bottomMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cellSpacing",{get:function(){return this.cellSpacingIn},set:function(e){e!==this.cellSpacingIn&&(this.cellSpacingIn=e,this.notifyPropertyChanged("cellSpacing"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightMargin",{get:function(){return this.rightMarginIn},set:function(e){e!==this.rightMarginIn&&(this.rightMarginIn=e,this.notifyPropertyChanged("rightMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredWidth",{get:function(){return this.preferredWidthIn},set:function(e){e!==this.preferredWidthIn&&(this.preferredWidthIn=e,this.notifyPropertyChanged("preferredWidth"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredWidthType",{get:function(){return this.preferredWidthTypeIn},set:function(e){e!==this.preferredWidthTypeIn&&(this.preferredWidthTypeIn=e,this.notifyPropertyChanged("preferredWidthType"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bidi",{get:function(){return this.bidiIn},set:function(e){this.bidiIn=e,this.notifyPropertyChanged("bidi")},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(e){switch(e){case"tableAlignment":return this.tableAlignment;case"leftIndent":return this.leftIndent;case"cellSpacing":return this.cellSpacing;case"leftMargin":return this.leftMargin;case"rightMargin":return this.rightMargin;case"topMargin":return this.topMargin;case"bottomMargin":return this.bottomMargin;case"background":var t=new r.o;return t.backgroundColor=this.background,t;case"preferredWidth":return this.preferredWidth;case"preferredWidthType":return this.preferredWidthType;case"bidi":return this.bidi;case"title":return this.title;case"description":return this.description;default:return}},e.prototype.notifyPropertyChanged=function(e){if((i.i(s.isNullOrUndefined)(this.selection)||!this.selection.isCleared&&this.selection.owner.isDocumentLoaded&&!this.selection.owner.isReadOnlyMode&&!this.selection.owner.isPastingContent||this.selection.isRetrieveFormatting)&&!i.i(s.isNullOrUndefined)(this.selection)&&!i.i(s.isNullOrUndefined)(this.selection.start)&&!this.selection.isRetrieveFormatting){var t=this.getPropertyValue(e);"background"===e&&(e="shading"),i.i(s.isNullOrUndefined)(t)||this.selection.owner.editorModule.onApplyTableFormat(e,t)}},e.prototype.copyFormat=function(e){this.leftIndent=e.leftIndent,this.background=e.shading.backgroundColor,this.tableAlignment=e.tableAlignment,this.leftMargin=e.leftMargin,this.rightMargin=e.rightMargin,this.topMargin=e.topMargin,this.bottomMargin=e.bottomMargin,this.cellSpacing=e.cellSpacing,this.preferredWidth=e.preferredWidth,this.preferredWidthType=e.preferredWidthType,this.bidi=e.bidi,this.title=e.title,this.description=e.description},e.prototype.clearFormat=function(){this.table=void 0,this.leftIndent=0,this.background=void 0,this.leftIndent=0,this.leftMargin=0,this.rightMargin=0,this.topMargin=0,this.bottomMargin=0,this.cellSpacing=0,this.tableAlignment=void 0,this.bidi=void 0},e.prototype.destroy=function(){this.leftIndentIn=void 0,this.backgroundIn=void 0,this.leftIndentIn=void 0,this.leftMarginIn=void 0,this.rightMarginIn=void 0,this.topMarginIn=void 0,this.bottomMarginIn=void 0,this.cellSpacingIn=void 0,this.tableAlignmentIn=void 0,this.tableIn=void 0,this.selection=void 0,this.bidi=void 0},e}(),v=function(){function e(e){this.verticalAlignmentIn=void 0,this.leftMarginIn=0,this.rightMarginIn=0,this.topMarginIn=0,this.bottomMarginIn=0,this.backgroundIn=void 0,this.preferredWidthTypeIn=void 0,this.selection=e}return Object.defineProperty(e.prototype,"verticalAlignment",{get:function(){return this.verticalAlignmentIn},set:function(e){e!==this.verticalAlignmentIn&&(this.verticalAlignmentIn=e,this.notifyPropertyChanged("verticalAlignment"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftMargin",{get:function(){return this.leftMarginIn},set:function(e){e!==this.leftMarginIn&&(this.leftMarginIn=e,this.notifyPropertyChanged("leftMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightMargin",{get:function(){return this.rightMarginIn},set:function(e){e!==this.rightMarginIn&&(this.rightMarginIn=e,this.notifyPropertyChanged("rightMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topMargin",{get:function(){return this.topMarginIn},set:function(e){e!==this.topMarginIn&&(this.topMarginIn=e,this.notifyPropertyChanged("topMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomMargin",{get:function(){return this.bottomMarginIn},set:function(e){e!==this.bottomMarginIn&&(this.bottomMarginIn=e,this.notifyPropertyChanged("bottomMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"background",{get:function(){return this.backgroundIn},set:function(e){e!==this.backgroundIn&&(this.backgroundIn=e,this.notifyPropertyChanged("background"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredWidthType",{get:function(){return this.preferredWidthTypeIn},set:function(e){e!==this.preferredWidthTypeIn&&(this.preferredWidthTypeIn=e,this.notifyPropertyChanged("preferredWidthType"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredWidth",{get:function(){return this.preferredWidthIn},set:function(e){e!==this.preferredWidthIn&&(this.preferredWidthIn=e,this.notifyPropertyChanged("preferredWidth"))},enumerable:!0,configurable:!0}),e.prototype.notifyPropertyChanged=function(e){var t=this.selection;if(!i.i(s.isNullOrUndefined)(t)){if((t.isCleared||!t.owner.isDocumentLoaded||t.owner.isReadOnlyMode||t.owner.isPastingContent)&&!t.isRetrieveFormatting)return;if(!i.i(s.isNullOrUndefined)(this.selection.start)&&!this.selection.isRetrieveFormatting){var n=this.getPropertyValue(e);"background"===e&&(e="shading"),i.i(s.isNullOrUndefined)(n)||this.selection.owner.editorModule.onApplyTableCellFormat(e,n)}}},e.prototype.getPropertyValue=function(e){switch(e){case"verticalAlignment":return this.verticalAlignment;case"leftMargin":return this.leftMargin;case"rightMargin":return this.rightMargin;case"topMargin":return this.topMargin;case"bottomMargin":return this.bottomMargin;case"preferredWidth":return this.preferredWidth;case"preferredWidthType":return this.preferredWidthType;case"background":var t=new r.o;return t.backgroundColor=this.background,t;default:return}},e.prototype.copyFormat=function(e){this.leftMargin=e.leftMargin,this.rightMargin=e.rightMargin,this.topMargin=e.topMargin,this.bottomMargin=e.bottomMargin,this.background=e.shading.backgroundColor,this.verticalAlignment=e.verticalAlignment,this.preferredWidth=e.preferredWidth,this.preferredWidthType=e.preferredWidthType},e.prototype.clearCellFormat=function(){this.leftMargin=void 0,this.rightMargin=void 0,this.topMargin=void 0,this.bottomMargin=void 0,this.background=void 0,this.verticalAlignment=void 0},e.prototype.combineFormat=function(e){i.i(s.isNullOrUndefined)(this.leftMargin)||this.leftMargin===e.leftMargin||(this.leftMargin=void 0),i.i(s.isNullOrUndefined)(this.topMargin)||this.topMargin===e.topMargin||(this.topMargin=void 0),i.i(s.isNullOrUndefined)(this.rightMargin)||this.rightMargin===e.rightMargin||(this.rightMargin=void 0),i.i(s.isNullOrUndefined)(this.bottomMargin)||this.bottomMargin===e.bottomMargin||(this.bottomMargin=void 0),i.i(s.isNullOrUndefined)(this.background)||this.background===e.shading.backgroundColor||(this.background=void 0),i.i(s.isNullOrUndefined)(this.verticalAlignment)||this.verticalAlignment===e.verticalAlignment||(this.verticalAlignment=void 0),i.i(s.isNullOrUndefined)(this.preferredWidth)||this.preferredWidth===e.preferredWidth||(this.preferredWidth=void 0),i.i(s.isNullOrUndefined)(this.preferredWidthType)||this.preferredWidthType===e.preferredWidthType||(this.preferredWidthType=void 0)},e.prototype.clearFormat=function(){this.background=void 0,this.bottomMargin=0,this.leftMargin=0,this.rightMargin=0,this.topMargin=0,this.verticalAlignment=void 0},e.prototype.destroy=function(){this.backgroundIn=void 0,this.verticalAlignmentIn=void 0,this.bottomMarginIn=void 0,this.leftMarginIn=void 0,this.rightMarginIn=void 0,this.topMarginIn=void 0,this.selection=void 0},e}(),y=function(){function e(e){this.heightIn=void 0,this.heightTypeIn=void 0,this.isHeaderIn=void 0,this.allowRowBreakAcrossPagesIn=void 0,this.selection=e}return Object.defineProperty(e.prototype,"height",{get:function(){return this.heightIn},set:function(e){e!==this.heightIn&&(this.heightIn=e,this.notifyPropertyChanged("height"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"heightType",{get:function(){return this.heightTypeIn},set:function(e){e!==this.heightTypeIn&&(this.heightTypeIn=e,this.notifyPropertyChanged("heightType"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isHeader",{get:function(){return this.isHeaderIn},set:function(e){e!==this.isHeaderIn&&(this.isHeaderIn=e,this.notifyPropertyChanged("isHeader"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allowBreakAcrossPages",{get:function(){return this.allowRowBreakAcrossPagesIn},set:function(e){e!==this.allowRowBreakAcrossPagesIn&&(this.allowRowBreakAcrossPagesIn=e,this.notifyPropertyChanged("allowBreakAcrossPages"))},enumerable:!0,configurable:!0}),e.prototype.notifyPropertyChanged=function(e){var t=this.selection;if((i.i(s.isNullOrUndefined)(t)||!t.isCleared&&!t.owner.isReadOnlyMode&&t.owner.isDocumentLoaded&&!t.owner.isPastingContent||t.isRetrieveFormatting)&&!i.i(s.isNullOrUndefined)(t)&&!i.i(s.isNullOrUndefined)(t.start)&&!t.isRetrieveFormatting){var n=this.getPropertyValue(e);i.i(s.isNullOrUndefined)(n)||t.owner.editorModule.onApplyTableRowFormat(e,n)}},e.prototype.getPropertyValue=function(e){switch(e){case"height":return this.height;case"heightType":return this.heightType;case"isHeader":return this.isHeader;case"allowBreakAcrossPages":return this.allowBreakAcrossPages;default:return}},e.prototype.copyFormat=function(e){this.height=e.height,this.heightType=e.heightType,this.allowBreakAcrossPages=e.allowBreakAcrossPages,this.isHeader=e.isHeader},e.prototype.combineFormat=function(e){i.i(s.isNullOrUndefined)(this.height)||this.height===e.height||(this.height=void 0),i.i(s.isNullOrUndefined)(this.heightType)||this.heightType===e.heightType||(this.heightType=void 0),i.i(s.isNullOrUndefined)(this.allowBreakAcrossPages)||this.allowBreakAcrossPages===e.allowBreakAcrossPages||(this.allowBreakAcrossPages=void 0),i.i(s.isNullOrUndefined)(this.isHeader)||this.isHeader===e.isHeader||(this.isHeader=void 0)},e.prototype.clearRowFormat=function(){this.height=void 0,this.heightType=void 0,this.allowBreakAcrossPages=void 0,this.isHeader=void 0},e.prototype.clearFormat=function(){this.height=0,this.heightType=void 0,this.allowBreakAcrossPages=void 0,this.isHeader=void 0},e.prototype.destroy=function(){this.heightIn=void 0,this.heightTypeIn=void 0,this.allowRowBreakAcrossPagesIn=void 0,this.isHeaderIn=void 0,this.selection=void 0},e}(),w=function(){function e(e){this.selection=e}return Object.defineProperty(e.prototype,"width",{get:function(){return this.image?this.image.width:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.image?this.image.height:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alternateText",{get:function(){return this.image?this.image.alternateText:null},set:function(e){e!==this.alternateText&&(this.image.alternateText=e)},enumerable:!0,configurable:!0}),e.prototype.resize=function(e,t){this.updateImageFormat(e,t,this.alternateText)},e.prototype.applyImageAlternativeText=function(e){this.updateImageFormat(this.width,this.height,e)},e.prototype.updateImageFormat=function(e,t,i){this.image&&this.selection.owner.editorModule&&this.selection.owner.editorModule.onImageFormat(this.image,e,t,i)},e.prototype.copyImageFormat=function(e){this.image=e},e.prototype.clearImageFormat=function(){this.image=void 0},e}(),b=function(){function e(e){this.widthIn=0,this.spaceIn=0,this.selection=e}return e.prototype.copyFormat=function(e){this.width=e.width,this.space=e.space},Object.defineProperty(e.prototype,"width",{get:function(){return this.widthIn},set:function(e){e!==this.widthIn&&(this.widthIn=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"space",{get:function(){return this.spaceIn},set:function(e){e!==this.spaceIn&&(this.spaceIn=e)},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(e){switch(e){case"space":return this.space;case"width":return this.width;default:return}},e.prototype.notifyPropertyChanged=function(e){var t=this.selection;i.i(s.isNullOrUndefined)(t)||this.selection.owner.editorModule.onApplyColumnFormat("columns",this.selection.sectionFormat.columns)},e.prototype.clearFormat=function(){this.widthIn=0,this.spaceIn=0},e.prototype.destroy=function(){this.widthIn=void 0,this.spaceIn=void 0},e}()},function(e,t,i){"use strict";i.d(t,"a",function(){return l});var n=i(7),r=i(1),o=i(6),s=i(2),a=i(0),l=(i.n(a),function(){function e(e){this.langIDInternal=0,this.enableSpellCheckInternal=!0,this.uniqueSpelledWords={},this.spellSuggestionInternal=!0,this.uniqueKey="",this.removeUnderlineInternal=!1,this.uniqueWordsCountInternal=15e3,this.performOptimizedCheck=!0,this.documentHelper=e,this.errorWordCollection=new o.a,this.uniqueWordsCollection=new o.a,this.errorSuggestions=new o.a,this.ignoreAllItems=[],this.uniqueSpelledWords={},this.textSearchResults=new n.P(this.documentHelper.owner),this.uniqueKey=this.documentHelper.owner.element.id+"_"+this.createGuid()}return e.prototype.getModuleName=function(){return"SpellChecker"},Object.defineProperty(e.prototype,"enableOptimizedSpellCheck",{get:function(){return this.performOptimizedCheck},set:function(e){this.performOptimizedCheck=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"uniqueWordsCount",{get:function(){return i.i(a.isNullOrUndefined)(this.uniqueWordsCountInternal)?0:this.uniqueWordsCountInternal},set:function(e){this.uniqueWordsCountInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"languageID",{get:function(){return i.i(a.isNullOrUndefined)(this.langIDInternal)?0:this.langIDInternal},set:function(e){this.langIDInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allowSpellCheckAndSuggestion",{get:function(){return this.spellSuggestionInternal},set:function(e){this.spellSuggestionInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"removeUnderline",{get:function(){return this.removeUnderlineInternal},set:function(e){this.removeUnderlineInternal=e,this.documentHelper.owner.editor.reLayout(this.documentHelper.selection)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableSpellCheck",{get:function(){return this.enableSpellCheckInternal},set:function(e){this.enableSpellCheckInternal=e,this.documentHelper.owner.editor.reLayout(this.documentHelper.selection)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.manageReplace=function(e,t){this.documentHelper.triggerSpellCheck=!0;if(!i.i(a.isNullOrUndefined)(t)&&t instanceof s._2){var n=t.text;if(this.documentHelper.selection.start=t.start.clone(),this.documentHelper.selection.end=t.end.clone(),"Ignore Once"!==e)return e=this.manageSpecialCharacters(n,e),this.documentHelper.owner.editor.insertTextInternal(e,!0),this.documentHelper.selection.start.setPositionInternal(this.documentHelper.selection.end),void this.documentHelper.clearSelectionHighlight();this.currentContextInfo={text:n,element:t}}if(!i.i(a.isNullOrUndefined)(this.currentContextInfo)&&this.currentContextInfo.element&&"Ignore Once"!==e){var r=this.currentContextInfo.element;this.currentContextInfo.element.text,this.documentHelper.selection.start=r.start.clone(),this.documentHelper.selection.end=r.end.clone()}else this.handleReplace(e);"Ignore Once"!==e&&(this.documentHelper.owner.editor.insertTextInternal(e,!0),i.i(a.isNullOrUndefined)(this.currentContextInfo)||this.removeErrorsFromCollection(this.currentContextInfo),this.documentHelper.selection.start.setPositionInternal(this.documentHelper.selection.end),this.documentHelper.clearSelectionHighlight()),this.documentHelper.triggerSpellCheck=!1},e.prototype.handleReplace=function(e){var t=this.documentHelper.selection.start,n=t.offset,r=t.currentWidget.getInline(n,0,!1,!0);r.element.line.getOffset(r.element,0)+r.element.length===n&&this.retrieveExactElementInfo(r);for(var o,s=r.element.text,l=new RegExp("^[#\\@\\!\\~\\$\\%\\^\\&\\*\\(\\)\\-\\_\\+\\=\\{\\}\\[\\]\\:\\;\\\"'\\,\\<\\.\\>\\/\\?\\`\\s]+","g"),d=[];!i.i(a.isNullOrUndefined)(o=l.exec(s));)d.push(o);if("Ignore Once"===e)return void this.handleIgnoreOnce(r);t.offset=n-r.index,!i.i(a.isNullOrUndefined)(d)&&d.length>0&&(t.offset+=d[0].toString().length),t.location=this.documentHelper.owner.selection.getPhysicalPositionInternal(t.currentWidget,t.offset,!0),t=this.documentHelper.owner.searchModule.textSearch.getTextPosition(t.currentWidget,t.offset.toString()),t.setPositionParagraph(t.currentWidget,t.offset);var h=t.offset+r.element.length-t.offset,c=t.currentWidget.getOffset(r.element,h),p=t.currentWidget,u=new RegExp("[#\\@\\!\\~\\$\\%\\^\\&\\*\\(\\)\\-\\_\\+\\=\\{\\}\\[\\]\\:\\;\\\"'\\,\\<\\.\\>\\/\\?\\s\\`]+$","g");for(d=[];!i.i(a.isNullOrUndefined)(o=u.exec(s));)d.push(o);!i.i(a.isNullOrUndefined)(d)&&d.length>0&&(c-=d[0].toString().length),this.documentHelper.selection.end=this.documentHelper.owner.searchModule.textSearch.getTextPosition(p,c.toString()),this.documentHelper.selection.end.location=this.documentHelper.owner.selection.getPhysicalPositionInternal(t.currentWidget,c,!0),this.documentHelper.selection.end.setPositionParagraph(p,c),this.currentContextInfo={element:r.element,text:r.element.text}},e.prototype.retrieveExactElementInfo=function(e){var t=e.element.nextElement;if(!i.i(a.isNullOrUndefined)(t)&&t instanceof s.d){""!=t.text.trim()&&(e.element=t)}},e.prototype.handleIgnoreOnce=function(e){var t=e.element,n="";n=!i.i(a.isNullOrUndefined)(this.currentContextInfo)&&this.currentContextInfo.element?this.currentContextInfo.element.text:t.text,n=this.manageSpecialCharacters(n,void 0,!0),-1===t.ignoreOnceItems.indexOf(n)&&t.ignoreOnceItems.push(n),this.documentHelper.owner.editor.reLayout(this.documentHelper.selection)},e.prototype.handleIgnoreAllItems=function(e){var t=i.i(a.isNullOrUndefined)(e)?this.retriveText():e,n=this.manageSpecialCharacters(t.text,void 0,!0);-1===this.ignoreAllItems.indexOf(n)&&(this.ignoreAllItems.push(n),this.removeErrorsFromCollection(t),this.documentHelper.triggerSpellCheck=!0,this.documentHelper.owner.editor.reLayout(this.documentHelper.selection),this.documentHelper.triggerSpellCheck=!1,this.documentHelper.clearSelectionHighlight())},e.prototype.handleAddToDictionary=function(e){var t=this,n=i.i(a.isNullOrUndefined)(e)?this.retriveText():e,r=this.manageSpecialCharacters(n.text,void 0,!0);this.callSpellChecker(this.languageID,r,!1,!1,!0).then(function(e){t.documentHelper.triggerSpellCheck=!0,t.removeErrorsFromCollection(n),t.ignoreAllItems.push(r),t.documentHelper.owner.editor.reLayout(t.documentHelper.selection,!0),t.documentHelper.triggerSpellCheck=!1})},e.prototype.manageSpecialCharacters=function(e,t,n){if(!i.i(a.isNullOrUndefined)(e)){i.i(a.isNullOrUndefined)(t)&&(t=e);for(var r=new RegExp("^[#\\@\\!\\$\\%\\^\\&\\*\\(\\)\\-\\_\\+\\=\\{\\}\\[\\]\\:\\;\\\"\\'\\,\\<\\.\\>\\/\\?\\`\\s\\]+","g"),o=[],s=void 0;!i.i(a.isNullOrUndefined)(s=r.exec(e));)o.push(s);if(o.length>0)for(var l=0;l<o.length;l++){var d=o[l];t=n?t.replace(d[0],""):d[0]+t}var h=new RegExp("[#\\@\\!\\$\\%\\^\\&\\*\\(\\)\\-\\_\\+\\=\\{\\}\\[\\]\\:\\;\\\"\\'\\,\\<\\.\\>\\/\\?\\s\\`\\]+$","g");for(o=[];!i.i(a.isNullOrUndefined)(s=h.exec(t));)o.push(s);if(o.length>0)for(var l=0;l<o.length;l++){var d=o[l];t=n?t.slice(0,d.index):t+d[0]}}return t},e.prototype.removeErrorsFromCollection=function(e){if(!i.i(a.isNullOrUndefined)(e.text)&&this.errorWordCollection.containsKey(e.text)){var t=this.errorWordCollection.get(e.text);t.indexOf(e.element)>=0&&t.splice(0,1),0===t.length&&this.errorWordCollection.remove(e.text)}},e.prototype.retriveText=function(){var e,t;if(!i.i(a.isNullOrUndefined)(this.currentContextInfo)&&this.currentContextInfo.element)t=this.currentContextInfo.element,e=this.currentContextInfo.element.text,this.documentHelper.selection.start=t.start.clone(),this.documentHelper.selection.end=t.end.clone();else{var n=this.documentHelper.selection.start,r=n.offset,o=n.currentWidget.getInline(r,0);t=o.element,e=o.element.text}return{text:e,element:t}},e.prototype.handleSuggestions=function(e){this.spellCheckSuggestion=[],0===e.length?this.spellCheckSuggestion.push(this.documentHelper.owner.contextMenu.locale.getConstant("Add to Dictionary")):(e=e.length>3?this.constructInlineMenu(e):e,this.spellCheckSuggestion.push(this.documentHelper.owner.contextMenu.locale.getConstant("Add to Dictionary")));var t=[];if(this.spellCheckSuggestion.length>0)for(var i=0,n=this.spellCheckSuggestion;i<n.length;i++){var r=n[i];t.push({text:r,id:this.documentHelper.owner.element.id+"_contextmenu_otherSuggestions_spellcheck_"+(r===this.documentHelper.owner.contextMenu.locale.getConstant("Add to Dictionary")?"Add to Dictionary":r),iconCss:""})}return t},e.prototype.checktextElementHasErrors=function(e,t,n){var r=!1,o=[];if(e=e.replace(/[\s]+/g,""),!i.i(a.isNullOrUndefined)(t.errorCollection)&&t.errorCollection.length>0){if(!this.documentHelper.isScrollHandler&&(t.ischangeDetected||t.paragraph.isChangeDetected))return this.updateStatusForGlobalErrors(t.errorCollection,t),t.errorCollection=[],t.ischangeDetected=!0,{errorFound:r,elements:o};for(var s=0;s<t.errorCollection.length;s++)this.handleErrorCollection(t.errorCollection[s])&&(r=!0,o.push(t.errorCollection[s]))}else!this.documentHelper.isScrollHandler&&t.paragraph.isChangeDetected?t.ischangeDetected=!0:!t.ischangeDetected&&this.handleErrorCollection(t)&&(r=!0,o.push(t));return{errorFound:r,elements:o}},e.prototype.updateStatusForGlobalErrors=function(e,t){if(e.length>0)for(var i=0;i<e.length;i++){var n=this.manageSpecialCharacters(e[i].text,void 0,!0);if(this.errorWordCollection.containsKey(n))for(var r=this.errorWordCollection.get(n),o=0;o<r.length;o++)if(r[o]instanceof s._2&&r[o]===e[i]){r[o].ischangeDetected=!0,r[o].start.offset=t.line.getOffset(t.istextCombined?this.getCombinedElement(t):t,0),r[o].line=t.line;break}}},e.prototype.handleErrorCollection=function(e){var t=this.errorWordCollection,i=this.manageSpecialCharacters(e.text,void 0,!0);if(t.containsKey(i)&&e.length>1){return!(this.ignoreAllItems.indexOf(i)>-1)||(t.containsKey(i)&&t.remove(i),!1)}return!1},e.prototype.constructInlineMenu=function(e){for(var t=e.length-1;t>0;t--)e.length>3&&(this.spellCheckSuggestion.push(e[t]),e.pop());return e},e.prototype.findCurretText=function(){var e,t,n=this.documentHelper.selection.start,r=n.currentWidget.getInline(this.documentHelper.selection.start.offset,0);if(!i.i(a.isNullOrUndefined)(r.element)){if(!i.i(a.isNullOrUndefined)(r.element.errorCollection)&&r.element.errorCollection.length>0)for(var o=0;o<r.element.errorCollection.length;o++){var s=r.element.errorCollection[o];if(s.start.location.x<=n.location.x&&s.end.location.x>=n.location.x){t=s.text,e=s;break}}else t=r.element.text;" "===t&&(r=n.currentWidget.getInline(this.documentHelper.selection.start.offset+1,0),t=r.element.text)}return{text:t,element:e}},e.prototype.addErrorCollection=function(e,t,n){if(e=this.manageSpecialCharacters(e,void 0,!0),this.errorWordCollection.containsKey(e)){var r=this.errorWordCollection.get(e);t instanceof s._2?this.compareErrorTextElement(t,r)||r.push(t):t instanceof s.d&&(this.compareTextElement(t,r)||r.push(t))}else!i.i(a.isNullOrUndefined)(n)&&n.length>0&&this.errorSuggestions.add(e,n),this.errorWordCollection.add(e,[t]),this.uniqueWordsCollection.containsKey(e)||this.uniqueWordsCollection.add(e,!0)},e.prototype.addCorrectWordCollection=function(e){e=this.manageSpecialCharacters(e,void 0,!0),this.uniqueWordsCollection.containsKey(e)||this.uniqueWordsCollection.add(e,!1)},e.prototype.isInUniqueWords=function(e){return e=e.replace(/[\s]+/g,""),this.uniqueWordsCollection.containsKey(e)},e.prototype.isErrorWord=function(e){return e=e.replace(/[\s]+/g,""),this.uniqueWordsCollection.get(e)},e.prototype.isCorrectWord=function(e){return e=e.replace(/[\s]+/g,""),!this.uniqueWordsCollection.get(e)},e.prototype.compareErrorTextElement=function(e,t){for(var i=[],n=!1,r=0;r<t.length;r++)i.push(t[r]);for(var o=t.length,r=0;r<o;r++)if(i[r]instanceof s._2)if(i[r].ischangeDetected){var a=this.manageSpecialCharacters(i[r].text,void 0,!0);n=!0,this.removeErrorsFromCollection({element:i[r],text:a})}else{var l=i[r];if(e.start.offset===l.start.offset&&e.end.offset===l.end.offset)return!0}return n&&this.errorWordCollection.add(this.manageSpecialCharacters(e.text,void 0,!0),[e]),!1},e.prototype.compareTextElement=function(e,t){for(var i=0;i<t.length;i++)if(t[i]instanceof s.d){var n=t[i];if(n===e)return!0}return!1},e.prototype.handleWordByWordSpellCheck=function(e,t,i,n,r,o,a){if(e.HasSpellingError&&a){this.addErrorCollection(t.text,t,e.Suggestions);var l=t.line.paragraph.containerWidget instanceof s.j?t.line.paragraph.containerWidget.cellFormat.shading.backgroundColor:this.documentHelper.backgroundColor;this.documentHelper.render.renderWavyLine(t,i,n,r,"#FF0000","Single",o,l),t.isSpellChecked=!0}else this.addCorrectWordCollection(t.text),t.isSpellChecked=!0},e.prototype.checkElementCanBeCombined=function(e,t,n,r,o,l,d,h){var c=i.i(a.isNullOrUndefined)(o)?"":o,p=!i.i(a.isNullOrUndefined)(h)&&h,u=!!i.i(a.isNullOrUndefined)(d)||d,g=!!i.i(a.isNullOrUndefined)(l)||l,f=[],m=this.documentHelper.selection.getLineWidget(e,0),v=m.children.indexOf(e),y=e.text;f.push(e);var w=d?0:1,b=!1,x=!1;if("\v"!==e.text){if(u){for(var C=void 0,I=v-w;I>=0;I--)if((C=m.children[I])instanceof s.d&&!x){if(0!==y.indexOf(" ")&&C.text.lastIndexOf(" ")!==C.text.length-1)b=!i.i(a.isNullOrUndefined)(o),c=C.text+c,y=C.text,x=!1,f.push(C),p=!0;else if(!i.i(a.isNullOrUndefined)(C)){C=C.nextElement;break}}else C instanceof s.b&&1!==C.fieldType&&(x=!0);var F=p?C:e;if(this.lookThroughPreviousLine(c,y,F,t,n))return!0}d?c=b?c:e.text+c:c+=e.text,x=!1;var k=e.text;if(g){for(var P=!1,T=void 0,I=v+1;I<m.children.length;I++)if((T=m.children[I])instanceof s.d&&!x){if(k.lastIndexOf(" ")!==k.length-1&&0!==T.text.indexOf(" "))c+=T.text,k=T.text,x=!1,f.push(T),P=!0,p=!0;else if(!i.i(a.isNullOrUndefined)(T)){T=T.previousElement;break}}else T instanceof s.b&&2!==T.fieldType&&(x=!0);var F=P?T:e;if("\f"!==F.text&&F.text!==String.fromCharCode(14)&&this.lookThroughNextLine(c,y,F,t,n))return!0}}return p&&r&&!this.checkCombinedElementsBeIgnored(f,c)&&this.handleCombinedElements(e,c,t,n),p},e.prototype.lookThroughPreviousLine=function(e,t,n,r,o){if(!i.i(a.isNullOrUndefined)(n)&&0===n.indexInOwner&&!i.i(a.isNullOrUndefined)(n.line.previousLine)){var l=n.line.previousLine,d=l.children.length-1;if(!i.i(a.isNullOrUndefined)(l.children[d])&&l.children[d]instanceof s.d){var h=l.children[d];if(!i.i(a.isNullOrUndefined)(n.text)&&0!==n.text.indexOf(" ")&&h.text.lastIndexOf(" ")!==h.text.length-1)return e=e.length>0?e:t,this.checkElementCanBeCombined(h,r,o,!0,e,!1,!0,!0),!0}}return!1},e.prototype.lookThroughNextLine=function(e,t,n,r,o){if(n instanceof s.d&&!i.i(a.isNullOrUndefined)(n)&&n.indexInOwner===n.line.children.length-1&&!i.i(a.isNullOrUndefined)(n.line.nextLine)){var l=n.line.nextLine;if(!i.i(a.isNullOrUndefined)(l.children[0])&&l.children[0]instanceof s.d){var d=l.children[0];if(n.text.lastIndexOf(" ")!==n.text.length-1&&0!==d.text.indexOf(" "))return e=e.length>0?e:t,this.checkElementCanBeCombined(d,r,o,!0,e,!0,!1,!0),!0}}return!1},e.prototype.handleCombinedElements=function(e,t,i,n){e.istextCombined=!0;var r=t.split(/[\s]+/);if(-1===this.ignoreAllItems.indexOf(t)&&e instanceof s.d&&-1===e.ignoreOnceItems.indexOf(t))if(r.length>1)for(var o=0;o<r.length;o++){var a=r[o];a=this.manageSpecialCharacters(a,void 0,!0),this.documentHelper.render.handleUnorderedElements(a,e,i,o,0,o===r.length-1,n)}else t=this.manageSpecialCharacters(t,void 0,!0),this.documentHelper.render.handleUnorderedElements(t,e,i,0,0,!0,n)},e.prototype.checkArrayHasSameElement=function(e,t){for(var i=0;i<e.length;i++){var n=e[i];if(n.start.location.x===t.start.location.x&&n.start.location.y===t.start.location.y)return!0}return!1},e.prototype.handleSplitWordSpellCheck=function(e,t,i,n,r,o,s,a){if(e.HasSpellingError&&" "!==i.text&&n){var l=this.getMatchedResultsFromElement(i,t);s=i.istextCombined?i.line.getOffset(this.getCombinedElement(i),0):s,this.documentHelper.owner.searchModule.textSearch.updateMatchedTextLocation(l.matches,l.textResults,l.elementInfo,0,i,!1,null,s),this.handleMatchedResults(l.textResults,i,r,o,e.Suggestions,a)}else this.addCorrectWordCollection(t),a&&(i.isSpellChecked=!0);this.updateUniqueWords([{Text:t,HasSpellError:e.HasSpellingError}])},e.prototype.handleMatchedResults=function(e,t,n,r,o,l){if(0===e.length&&l)return void(t.isSpellChecked=!0);for(var d=0;d<e.length;d++){var h=this.createErrorElementWithInfo(e.innerList[d],t);i.i(a.isNullOrUndefined)(t.errorCollection)||this.checkArrayHasSameElement(t.errorCollection,h)||t.errorCollection.splice(r,0,h),this.addErrorCollection(h.text,h,o);for(var c=t.line.paragraph.containerWidget instanceof s.j?t.paragraph.containerWidget.cellFormat.shading.backgroundColor:this.documentHelper.backgroundColor,p=t.line.paragraph,u=p.y,g=0;g<p.childWidgets.length&&p.childWidgets[g]!=t.line;g++)u+=p.childWidgets[g].height;t.isRightToLeft?this.documentHelper.render.renderWavyLine(h,h.end.location.x,u,n,"#FF0000","Single",t.characterFormat.baselineAlignment,c):this.documentHelper.render.renderWavyLine(h,h.start.location.x,u,n,"#FF0000","Single",t.characterFormat.baselineAlignment,c),l&&(t.isSpellChecked=!0)}},e.prototype.callSpellChecker=function(e,t,n,o,s,l){var d=this,h=this;return new Promise(function(c,p){if(!i.i(a.isNullOrUndefined)(d)){var u=new XMLHttpRequest,g=d.documentHelper.owner.serviceUrl+d.documentHelper.owner.serverActionSettings.spellCheck;g=l?g+"ByPage":g,u.open("POST",g,!0),u.setRequestHeader("Content-Type","application/json"),d.setCustomHeaders(u);var f={LanguageID:e,TexttoCheck:t,CheckSpelling:n,CheckSuggestion:o,AddWord:s},m={serverActionType:"SpellCheck",headers:d.documentHelper.owner.headers,timeout:0,cancel:!1,withCredentials:!1};d.documentHelper.owner.trigger(r.U,m),m.cancel||u.send(JSON.stringify(f)),u.onreadystatechange=function(){if(4===u.readyState)if(200===u.status||304===u.status)c(u.response);else{var e={name:"onFailure",status:u.status,statusText:u.responseText,url:g};i.i(a.isNullOrUndefined)(h.documentHelper)||h.documentHelper.owner.fireServiceFailure(e),p(u.response)}}}})},e.prototype.setCustomHeaders=function(e){for(var t=0;t<this.documentHelper.owner.headers.length;t++)for(var i=this.documentHelper.owner.headers[t],n=0,r=Object.keys(i);n<r.length;n++){var o=r[n];e.setRequestHeader(o,i[o])}},e.prototype.checkForNextError=function(){if(!i.i(a.isNullOrUndefined)(this.viewer)){var e=this.errorWordCollection;if(e.length>0)for(var t=0;t<e.length;t++){for(var n=e.get(e.keys[t]),r=0;r<n.length;r++){if(n[r]instanceof s._2&&!n[r].ischangeDetected)this.updateErrorElementTextBox(e.keys[t],n[r]);else if(n[r]instanceof s.d){var o=this.getMatchedResultsFromElement(n[r]),l=o.textResults,d=n[r].ischangeDetected?n[r].start.offset:n[r].line.getOffset(n[r],0);this.documentHelper.owner.searchModule.textSearch.updateMatchedTextLocation(o.matches,l,o.elementInfo,0,n[r],!1,null,d);for(var h=0;h<l.length;h++){var c=this.createErrorElementWithInfo(l.innerList[h],n[r]);this.updateErrorElementTextBox(c.text,c);break}}break}break}else this.documentHelper.clearSelectionHighlight()}},e.prototype.createErrorElementWithInfo=function(e,t){var i=new s._2;return i.text=e.text,i.start=e.start,i.end=e.end,i.height=t.height,i.canTrigger=t.canTrigger,i.characterFormat.copyFormat(t.characterFormat),i.width=Math.abs(i.start.location.x-i.end.location.x),i},e.prototype.getMatchedResultsFromElement=function(e,t){var n=e.line,r=this.documentHelper.owner.searchModule.textSearch.stringToRegex(i.i(a.isNullOrUndefined)(t)?e.text:t,"CaseSensitive");this.textSearchResults.clearResults();for(var o,s=this.textSearchResults,l=this.documentHelper.owner.searchModule.textSearch.getElementInfo(n.children[0],0,!1,r,void 0,void 0,void 0,void 0,!0),d=l.fullText,h=[],c=l.elementsWithOffset;!i.i(a.isNullOrUndefined)(o=r.exec(d));)c.containsKey(e)&&this.manageSpecialCharacters(e.text,void 0,!0)===e.text&&(o.index=c.get(e)),h.push(o);return{matches:h,elementInfo:c,textResults:s}},e.prototype.updateErrorElementTextBox=function(e,t){var i=t;this.documentHelper.clearSelectionHighlight(),this.documentHelper.selection.start=i.start.clone(),this.documentHelper.selection.end=i.end.clone(),this.documentHelper.selection.highlight(t.start.paragraph,t.start,t.end),this.documentHelper.owner.spellCheckDialog.updateSuggestionDialog(e,i)},e.prototype.getWhiteSpaceCharacterInfo=function(e){var t=e.text,n=e.characterFormat,r=[],o=0,s=0;if(r=t.match(/[\s]+/),!i.i(a.isNullOrUndefined)(r)&&r.length>0)for(var l=0;l<r.length;l++)o+=this.documentHelper.textHelper.getWidth(r[l],n,e.scriptType),s+=r[l].length;return{width:o,wordLength:s,isBeginning:!i.i(a.isNullOrUndefined)(r)&&0===r.index}},e.prototype.getSpecialCharactersInfo=function(e){var t=e.text,n=e.characterFormat,r=[],o=0,s=0,l=0;r=t.match(/^[\#\@\!\~\$\%\^\&\*\(\)\-\_\+\=\{\}\[\]\:\;\"\'\,\<\.\>\/\?\`]*/);for(var d=0;d<r.length;d++)!i.i(a.isNullOrUndefined)(r[d])&&r[d].length>0&&(o=this.documentHelper.textHelper.getWidth(r[d],n,e.scriptType)),l=r.length;r=t.match(/[\#\@\!\~\$\%\^\&\*\(\)\-\_\+\=\{\}\[\]\:\;\"\'\,\<\.\>\/\?\`]*$/);for(var d=0;d<r.length;d++)!i.i(a.isNullOrUndefined)(r[d])&&r[d].length>0&&(s=this.documentHelper.textHelper.getWidth(r[d],n,e.scriptType)),l=r.length;return{beginningWidth:o,endWidth:s,wordLength:l}},e.prototype.getCombinedElement=function(e){for(var t=e;!i.i(a.isNullOrUndefined)(e)&&e instanceof s.d&&e.istextCombined;)t=e,e=e.previousElement;return t},e.prototype.checkCombinedElementsBeIgnored=function(e,t){t=this.manageSpecialCharacters(t,void 0,!0);for(var i=0;i<e.length;i++)if(-1!==e[i].ignoreOnceItems.indexOf(t))return!0;return!1},e.prototype.updateSplittedElementError=function(e,t){var i=e.errorCollection.length;if(i>0){for(var n=[],r=0;r<i;r++)n.push(e.errorCollection[r]);for(var r=0;r<i;r++)-1===e.text.indexOf(n[r].text)&&(t.ischangeDetected=!0,e.errorCollection.splice(0,1))}},e.prototype.getPageContent=function(e){var t="";if(this.documentHelper.owner.sfdtExportModule){var i=this.documentHelper.owner.sfdtExportModule,n=i.keywordIndex;i.keywordIndex=0,i.Initialize();var r=i.writePage(e);if(i.keywordIndex=n,this.documentHelper.owner.textExportModule){var o=this.documentHelper.owner.textExportModule;o.pageContent="",o.setDocument(r),o.writeInternal(),t=o.pageContent}}return t},e.prototype.updateUniqueWords=function(e){if(i.i(a.isNullOrUndefined)(localStorage.getItem(this.uniqueKey))||(this.uniqueSpelledWords=JSON.parse(localStorage.getItem(this.uniqueKey))),this.uniqueSpelledWords=this.uniqueSpelledWords||{},e.length+Object.keys(this.uniqueSpelledWords).length<=this.uniqueWordsCount)for(var t=0;t<e.length;t++)this.checkForUniqueWords(e[t]);localStorage.setItem(this.uniqueKey,JSON.stringify(this.uniqueSpelledWords)),this.uniqueSpelledWords={}},e.prototype.checkForUniqueWords=function(e){this.uniqueSpelledWords[e.Text]||(this.uniqueSpelledWords[e.Text]=e.HasSpellError)},e.prototype.clearCache=function(){i.i(a.isNullOrUndefined)(localStorage.getItem(this.uniqueKey))||localStorage.removeItem(this.uniqueKey)},e.prototype.createGuid=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var i=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?i:3&i|8).toString(16)})},e.prototype.checkSpellingInPageInfo=function(e){var t=JSON.parse(localStorage.getItem(this.uniqueKey));return i.i(a.isNullOrUndefined)(t)||i.i(a.isNullOrUndefined)(t[e])?{hasSpellError:!1,isElementPresent:!1}:{hasSpellError:t[e],isElementPresent:!0}},e.prototype.destroy=function(){this.errorWordCollection=void 0,this.ignoreAllItems=void 0,this.errorSuggestions=void 0,this.uniqueWordsCollection=void 0,this.uniqueSpelledWords={},this.textSearchResults=void 0,i.i(a.isNullOrUndefined)(localStorage.getItem(this.uniqueKey))||localStorage.removeItem(this.uniqueKey),this.documentHelper=void 0},e}())},function(e,t,i){"use strict";i.d(t,"a",function(){return o}),i.d(t,"b",function(){return s});var n=i(0),r=(i.n(n),i(65)),o=function(){function e(e){this.majFontScheme=new r.a,this.minFontScheme=new r.a}return Object.defineProperty(e.prototype,"fontSchemeName",{get:function(){return this.schemeName},set:function(e){this.schemeName=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"majorFontScheme",{get:function(){return this.majFontScheme},set:function(e){this.majFontScheme=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minorFontScheme",{get:function(){return this.minFontScheme},set:function(e){this.minFontScheme=e},enumerable:!0,configurable:!0}),e.prototype.copyFormat=function(e){i.i(n.isNullOrUndefined)(e)||(this.schemeName=e.schemeName,this.majFontScheme.copyFormat(e.majFontScheme),this.minFontScheme.copyFormat(e.minFontScheme))},e.prototype.destroy=function(){this.schemeName=void 0,this.majFontScheme=void 0,this.minFontScheme=void 0},e}(),s=function(){function e(){}return Object.defineProperty(e.prototype,"name",{get:function(){return this.fontName},set:function(e){this.fontName=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"typeface",{get:function(){return this.fontTypeface},set:function(e){this.fontTypeface=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"panose",{get:function(){return this.pnose},set:function(e){this.pnose=e},enumerable:!0,configurable:!0}),e.prototype.copyFormat=function(e){i.i(n.isNullOrUndefined)(e)||(this.fontName=e.fontName,this.fontTypeface=e.fontTypeface,this.pnose=e.panose)},e.prototype.destroy=function(){this.fontName=void 0,this.fontTypeface=void 0,this.pnose=void 0},e}()},function(e,t,i){"use strict";i.d(t,"a",function(){return o});var n=i(0),r=(i.n(n),i(1)),o=function(){function e(){this.fntTypeface=new r.o,this.fntSchemeList=[],this.fntTypeface=new r.o,this.fntSchemeList=[]}return Object.defineProperty(e.prototype,"fontTypeface",{get:function(){return this.fntTypeface},set:function(e){this.fntTypeface=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontSchemeList",{get:function(){return this.fntSchemeList},set:function(e){this.fntSchemeList=e},enumerable:!0,configurable:!0}),e.prototype.copyFormat=function(e){i.i(n.isNullOrUndefined)(e)||(this.fntTypeface=e.fntTypeface,this.fntSchemeList=e.fntSchemeList)},e.prototype.destroy=function(){this.fntTypeface=void 0,this.fntSchemeList=void 0},e}()},function(e,t,i){"use strict";i.d(t,"a",function(){return o});var n=i(0),r=(i.n(n),i(64)),o=function(){function e(e){this.fntScheme=new r.a}return Object.defineProperty(e.prototype,"fontScheme",{get:function(){return this.fntScheme},set:function(e){this.fntScheme=e},enumerable:!0,configurable:!0}),e.prototype.copyFormat=function(e){i.i(n.isNullOrUndefined)(e)||this.fntScheme.copyFormat(e.fntScheme)},e.prototype.destroy=function(){this.fntScheme=void 0},e}()},function(e,t,i){"use strict";i.d(t,"a",function(){return c});var n=i(0),r=(i.n(n),i(2)),o=i(40),s=i(32),a=i(4),l=i(1),d=i(132),h=i(6),c=function(){function e(e){this.commentMarkDictionary=new h.a,this.isPrinting=!1,this.isExporting=!1,this.pageLeft=0,this.pageTop=0,this.pageIndex=-1,this.isFieldCode=!1,this.leftPosition=0,this.topPosition=0,this.height=0,this.fieldStacks=[],this.documentHelper=e}return Object.defineProperty(e.prototype,"pageCanvas",{get:function(){return this.isPrinting?(i.i(n.isNullOrUndefined)(this.pageCanvasIn)&&(this.pageCanvasIn=document.createElement("canvas"),this.pageCanvasIn.getContext("2d").save()),this.pageCanvasIn):this.isExporting?(i.i(n.isNullOrUndefined)(this.exportPageCanvas)&&(this.exportPageCanvas=new d.a),this.exportPageCanvas):i.i(n.isNullOrUndefined)(this.viewer)?void 0:this.documentHelper.containerCanvas},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spellChecker",{get:function(){return this.documentHelper.owner.spellChecker},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionCanvas",{get:function(){return i.i(n.isNullOrUndefined)(this.viewer)?void 0:this.documentHelper.selectionCanvas},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageContext",{get:function(){return this.pageCanvas.getContext("2d")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionContext",{get:function(){return this.selectionCanvas.getContext("2d")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.renderWidgets=function(e,t,r,o,l){if(!i.i(n.isNullOrUndefined)(this.pageCanvas)&&!i.i(n.isNullOrUndefined)(e)){if(this.pageContext.fillStyle=a.a.getColor(this.documentHelper.backgroundColor),this.pageContext.beginPath(),this.viewer instanceof s.a){l=l>this.documentHelper.visibleBounds.height?l:this.documentHelper.visibleBounds.height;var d=r;0===e.index&&(d=r-this.viewer.padding.top),this.pageContext.fillRect(t-this.viewer.padding.left,d,o+this.viewer.padding.left,l+this.viewer.padding.top)}else this.pageContext.fillRect(t,r,o,l);this.pageContext.closePath(),this.viewer instanceof s.b&&(this.pageContext.strokeStyle=this.documentHelper.owner.pageOutline,this.pageContext.strokeRect(t,r,o,l)),this.pageLeft=t,this.pageTop=r,this.pageIndex=e.index,this.isPrinting?this.setPageSize(e):(this.pageContext.beginPath(),this.pageContext.save(),this.pageContext.rect(t,r,o,l),this.pageContext.clip()),this.height=l,e.headerWidget&&this.renderHFWidgets(e,e.headerWidgetIn,o,!0),e.footerWidget&&this.renderHFWidgets(e,e.footerWidgetIn,o,!1);for(var h=0;h<e.bodyWidgets.length;h++)this.render(e,e.bodyWidgets[parseInt(h.toString(),10)]),e.footnoteWidget&&"Pages"===this.documentHelper.owner.layoutType&&this.renderfootNoteWidget(e,e.footnoteWidget,o);e.endnoteWidget&&"Pages"===this.documentHelper.owner.layoutType&&this.renderfootNoteWidget(e,e.endnoteWidget,o),this.documentHelper.owner.enableHeaderAndFooter&&!this.isPrinting&&this.renderHeaderSeparator(e,this.pageLeft,this.pageTop,e.headerWidgetIn),this.pageLeft=0,this.pageTop=0,this.pageContext.restore()}},e.prototype.setPageSize=function(e){this.pageContext.clearRect(0,0,this.pageCanvas.width,this.pageCanvas.height),this.selectionContext.clearRect(0,0,this.selectionCanvas.width,this.selectionCanvas.height),this.pageContext.restore(),this.selectionContext.restore();var t=e.boundingRectangle.width,i=e.boundingRectangle.height,n=Math.max(window.devicePixelRatio,this.documentHelper.owner.documentEditorSettings.printDevicePixelRatio);this.pageCanvas.width===t*n&&this.pageCanvas.height===i*n||(this.pageCanvas.height=i*n,this.pageCanvas.width=t*n,this.pageCanvas.style.height=i+"px",this.pageCanvas.style.width=t+"px",this.pageContext.globalAlpha=1,this.pageContext.scale(n,n)),this.pageContext.fillStyle="#FFFFFF",this.pageContext.fillRect(0,0,this.pageCanvas.width,this.pageCanvas.height),this.pageContext.fillStyle="#000000"},e.prototype.renderHFWidgets=function(e,t,r,o){this.isFieldCode&&(this.isFieldCode=!1),this.isPrinting||(this.pageContext.globalAlpha=this.documentHelper.owner.enableHeaderAndFooter?1:.65);var s=!1,l=0,d=e.boundingRectangle.height/100*40;if(o){var h=a.a.convertPointToPixel(e.bodyWidgets[0].sectionFormat.topMargin);Math.max(t.y+t.height,h)>d&&(s=!0,this.pageContext.beginPath(),this.pageContext.save(),this.pageContext.rect(this.pageLeft,this.pageTop,r,this.getScaledValue(d)),this.pageContext.clip())}else{var c=a.a.convertPointToPixel(e.bodyWidgets[0].sectionFormat.footerDistance),p=void 0;p=(i.i(n.isNullOrUndefined)(e.footerWidgetIn.sectionFormat),e.boundingRectangle.height-Math.max(e.footerWidgetIn.height+c,a.a.convertPointToPixel(e.footerWidgetIn.sectionFormat.bottomMargin))),l=Math.max(e.boundingRectangle.height-d,p),e.boundingRectangle.height-c}this.renderFloatingItems(e,t.floatingElements,"Behind");for(var u=0;u<t.childWidgets.length;u++){var g=t.childWidgets[parseInt(u.toString(),10)];o||(l+=g.height),this.renderWidget(e,g)}this.renderFloatingItems(e,t.floatingElements,"InFrontOfText"),s&&this.pageContext.restore(),this.isPrinting||(this.pageContext.globalAlpha=this.documentHelper.owner.enableHeaderAndFooter?.5:1)},e.prototype.renderHeaderSeparator=function(e,t,i,r){var o=a.a.convertPointToPixel(e.bodyWidgets[0].sectionFormat.topMargin),s=this.getScaledValue(Math.max(r.y+r.height,Math.abs(o))),l=this.getScaledValue(e.boundingRectangle.width),d=this.pageContext;d.save(),d.globalAlpha=.85;var h=this.getScaledValue(e.boundingRectangle.height)/100*40;s=Math.min(s,h),this.renderDashLine(d,t,i+s,l,"#000000",!1);var c=this.getHeaderFooterType(e,!0),p=this.viewer.getHeaderFooter(r.headerFooterType),u=e.sectionIndex,g=new n.L10n("documenteditor",this.documentHelper.owner.defaultLocale);if(g.setLocale(this.documentHelper.owner.locale),this.documentHelper.headersFooters.length>1){var f=u+1;c=c+" -"+g.getConstant("Section")+" "+f+"-"}d.font="9pt Arial";var m=d.measureText(c).width;this.renderHeaderFooterMark(d,t+5,i+s,m+10,20),this.renderHeaderFooterMarkText(d,c,t+10,s+i+15);var v;if(this.documentHelper.headersFooters[parseInt(u.toString(),10)]&&(v=this.documentHelper.headersFooters[parseInt(u.toString(),10)][parseInt(p.toString(),10)]),0!=u&&!v){var y=g.getConstant("Same as Previous"),w=d.measureText(y).width,b=this.viewer.containerWidth-w-75+t;this.renderHeaderFooterMark(d,b,i+s,w+10,20),this.renderHeaderFooterMarkText(d,y,b+5,s+i+15)}if(e.footerWidget){var x=a.a.convertPointToPixel(e.bodyWidgets[0].sectionFormat.footerDistance),C=this.getScaledValue(e.boundingRectangle.height)-this.getScaledValue(Math.max(e.footerWidgetIn.height+x,Math.abs(a.a.convertPointToPixel(e.footerWidgetIn.sectionFormat.bottomMargin))));C=Math.max(this.getScaledValue(e.boundingRectangle.height)-h,C),this.renderDashLine(d,t,i+C,l,"#000000",!1);var I=this.getHeaderFooterType(e,!1),F=e.sectionIndex;if(this.documentHelper.headersFooters.length>1){var f=F+1;I=I+" -"+g.getConstant("Section")+" "+f+"-"}m=d.measureText(I).width,this.renderHeaderFooterMark(d,t+5,i+C-20,m+10,20),this.renderHeaderFooterMarkText(d,I,t+10,i+C-5);var k,P=this.viewer.getHeaderFooter(e.footerWidget.headerFooterType);if(this.documentHelper.headersFooters[parseInt(F.toString(),10)]&&(k=this.documentHelper.headersFooters[parseInt(F.toString(),10)][parseInt(P.toString(),10)]),0!=F&&!k){var y=g.getConstant("Same as Previous"),T=d.measureText(y).width,b=this.viewer.containerWidth-T-75+t;this.renderHeaderFooterMark(d,b,i+C-20,T+10,20),this.renderHeaderFooterMarkText(d,y,b+5,i+C-5)}d.restore()}},e.prototype.getFooterHeight=function(e){var t=e.boundingRectangle.height/100*40,i=a.a.convertPointToPixel(e.bodyWidgets[0].sectionFormat.footerDistance),n=e.boundingRectangle.height-Math.max(e.footerWidgetIn.height+i,a.a.convertPointToPixel(e.footerWidgetIn.sectionFormat.bottomMargin));return Math.max(e.boundingRectangle.height-t,n)},e.prototype.getHeaderFooterType=function(e,t){var r,o=new n.L10n("documenteditor",this.documentHelper.owner.defaultLocale);return o.setLocale(this.documentHelper.owner.locale),r=t?o.getConstant("Header"):o.getConstant("Footer"),e.bodyWidgets[0].sectionFormat.differentFirstPage&&(i.i(n.isNullOrUndefined)(e.previousPage)||e.sectionIndex!==e.previousPage.sectionIndex)?r=t?o.getConstant("First Page Header"):o.getConstant("First Page Footer"):e.bodyWidgets[0].sectionFormat.differentOddAndEvenPages&&(r=(this.documentHelper.pages.indexOf(e)+1)%2==0?t?o.getConstant("Even Page Header"):o.getConstant("Even Page Footer"):t?o.getConstant("Odd Page Header"):o.getConstant("Odd Page Footer")),r},e.prototype.renderDashLine=function(e,t,i,n,r,o){e.beginPath(),e.strokeStyle=r,e.lineWidth=1,o?e.setLineDash([3,2]):e.setLineDash([6,4]),e.moveTo(t,i),e.lineTo(t+n,i),e.stroke(),e.setLineDash([]),e.closePath()},e.prototype.renderSolidLine=function(e,t,i,n,r){e.beginPath(),e.strokeStyle=r,e.lineWidth=.5,e.moveTo(t,i),e.lineTo(t+n,i),e.stroke(),e.closePath()},e.prototype.renderHeaderFooterMark=function(e,t,i,n,r){e.beginPath(),e.fillStyle="lightgray",e.fillRect(t,i,n,r),e.strokeStyle="black",e.strokeRect(t,i,n,r),e.closePath()},e.prototype.renderHeaderFooterMarkText=function(e,t,i,n){e.beginPath(),e.fillStyle="#000000",e.textBaseline="alphabetic",e.fillText(t,i,n),e.closePath()},e.prototype.render=function(e,t){this.isFieldCode&&(this.isFieldCode=!1);for(var o=0;o<e.bodyWidgets.length;o++)i.i(n.isNullOrUndefined)(e.bodyWidgets[o].floatingElements)||this.renderFloatingItems(e,e.bodyWidgets[o].floatingElements,"Behind");var l,d=!1;if(i.i(n.isNullOrUndefined)(t.nextRenderedWidget)||t.columnIndex+1!==t.nextRenderedWidget.columnIndex||(l=t.nextRenderedWidget),!(this.viewer instanceof s.a)&&t.sectionFormat.columns.length>1&&!i.i(n.isNullOrUndefined)(l)){var h=e.bodyWidgets.indexOf(t),c=void 0,p=void 0;0===t.columnIndex?(c=e.bodyWidgets[h].x-a.a.convertPointToPixel(e.bodyWidgets[h].sectionFormat.leftMargin),p=a.a.convertPointToPixel(e.bodyWidgets[h].sectionFormat.leftMargin)+t.sectionFormat.columns[t.columnIndex].width+t.sectionFormat.columns[t.columnIndex].space/2):h===t.sectionFormat.columns.length-1?(c=e.bodyWidgets[h].x-t.sectionFormat.columns[t.columnIndex-1].space/2,p=a.a.convertPointToPixel(e.bodyWidgets[h].sectionFormat.rightMargin)+t.sectionFormat.columns[t.columnIndex].width+t.sectionFormat.columns[t.columnIndex-1].space/2):(c=e.bodyWidgets[h].x-t.sectionFormat.columns[t.columnIndex].space/2,p=t.sectionFormat.columns[t.columnIndex].width+t.sectionFormat.columns[t.columnIndex].space),this.clipRect(c,e.bodyWidgets[h].y,this.getScaledValue(p),this.getScaledValue(e.boundingRectangle.height)),d=!0}for(var o=0;o<t.childWidgets.length;o++){var u=t.childWidgets[parseInt(o.toString(),10)];0===o&&t.childWidgets[0]instanceof r.u&&t.childWidgets[0].childWidgets.length>0&&e.repeatHeaderRowTableWidget&&this.renderHeader(e,u,this.documentHelper.layout.getHeader(t.childWidgets[0])),this.renderWidget(e,u)}d&&this.pageContext.restore();for(var o=0;o<e.bodyWidgets.length;o++)i.i(n.isNullOrUndefined)(e.bodyWidgets[o].floatingElements)||this.renderFloatingItems(e,e.bodyWidgets[o].floatingElements,"InFrontOfText");for(var o=0;o<e.bodyWidgets.length;o++)if(!0===e.bodyWidgets[parseInt(o.toString(),10)].sectionFormat.lineBetweenColumns&&0!==e.bodyWidgets[parseInt(o.toString(),10)].columnIndex&&e.bodyWidgets.length>1){var g=a.a.convertPointToPixel(e.bodyWidgets[0].sectionFormat.topMargin),f=this.getScaledValue(Math.max(e.headerWidgetIn.y+e.headerWidgetIn.height,g)),m=this.getScaledValue(e.boundingRectangle.height)/100*40,v=a.a.convertPointToPixel(e.bodyWidgets[0].sectionFormat.footerDistance),y=this.getScaledValue(e.boundingRectangle.height)-this.getScaledValue(Math.max(e.footerWidgetIn.height+v,a.a.convertPointToPixel(e.footerWidgetIn.sectionFormat.bottomMargin)));y=Math.max(this.getScaledValue(e.boundingRectangle.height)-m,y);var w=(e.bodyWidgets[parseInt(o.toString(),10)].x-(e.bodyWidgets[parseInt(o.toString(),10)].previousRenderedWidget.x+e.bodyWidgets[parseInt(o.toString(),10)].previousRenderedWidget.width))/2,b=w+(e.bodyWidgets[parseInt(o.toString(),10)].previousRenderedWidget.x+e.bodyWidgets[parseInt(o.toString(),10)].previousRenderedWidget.width),x=f/this.documentHelper.zoomFactor,C=b,I=void 0;I=e.footnoteWidget?(y-e.footerWidgetIn.height/2-e.footnoteWidget.height*this.documentHelper.zoomFactor)/this.documentHelper.zoomFactor:(y-e.footerWidgetIn.height/2)/this.documentHelper.zoomFactor;var F=this.documentHelper.layout.getBodyWidget(e.bodyWidgets[parseInt(o.toString(),10)],!0),k=this.documentHelper.layout.getNextWidgetHeight(F);x=e.bodyWidgets[parseInt(o.toString(),10)].y,I=k;this.renderSingleBorder("#000000",b,x,C,I,.5,"Single")}},e.prototype.renderFloatingItems=function(e,t,o){if(!i.i(n.isNullOrUndefined)(t)&&t.length>0){var s=new h.a;t.sort(function(e,t){return e instanceof r.u||t instanceof r.u?0:e.zOrderPosition-t.zOrderPosition});for(var a=0;a<t.length;a++)if(!(t[a]instanceof r.u)){var l=t[a];if(!("Behind"===o&&"Behind"!==l.textWrappingStyle||"Behind"!==o&&"Behind"===l.textWrappingStyle))if(!this.isOverLappedShapeWidget(l)||s.containsKey(l.zOrderPosition)){if(l instanceof r.r)this.renderImageElementBox(l,l.x,l.y,0);else if(l instanceof r.s){var d=this.getScaledValue(l.x,1),c=this.getScaledValue(l.y,2);this.renderShapeElementBox(l,d,c,e)}}else s.containsKey(l.zOrderPosition)||s.add(l.zOrderPosition,l)}if(s.length>0)for(var p=s.keys.sort(),u=0;u<p.length;u++){var l=s.get(p[u]);if(l instanceof r.r)this.renderImageElementBox(l,l.x,l.y,0);else if(l instanceof r.s){var d=this.getScaledValue(l.x,1),c=this.getScaledValue(l.y,2);this.renderShapeElementBox(l,d,c,e)}}}},e.prototype.isOverLappedShapeWidget=function(e){return e instanceof r.r&&"Inline"!==e.textWrappingStyle&&"Behind"!==e.textWrappingStyle&&!("Word2013"!==this.documentHelper.compatibilityMode&&e.isBelowText&&"InFrontOfText"!==e.textWrappingStyle)||e instanceof r.s&&"Inline"!==e.textWrappingStyle&&"Behind"!==e.textWrappingStyle&&!("Word2013"!==this.documentHelper.compatibilityMode&&e.isBelowText&&"InFrontOfText"!==e.textWrappingStyle)},e.prototype.renderShapeElementBox=function(e,t,r,o){if(!e.isHorizontalRule){var s=0===e.height,l=e.autoShapeType,d=e.textFrame.childWidgets;r+=e.margin.top,this.pageContext.beginPath(),e.fillFormat&&e.fillFormat.color&&e.fillFormat.fill&&"StraightConnector"!==l&&(this.pageContext.fillStyle=e.fillFormat.color,this.pageContext.fillRect(t,r,this.getScaledValue(e.width),this.getScaledValue(e.height))),i.i(n.isNullOrUndefined)(l)||e.lineFormat.line&&"None"!==e.lineFormat.lineFormatType&&(this.pageContext.lineWidth=e.lineFormat.weight,this.pageContext.strokeStyle=a.a.getColor(e.lineFormat.color),"StraightConnector"!==l?this.pageContext.strokeRect(t,r,this.getScaledValue(e.width),this.getScaledValue(e.height)):(this.pageContext.moveTo(t,r),this.pageContext.lineTo(t+this.getScaledValue(e.width),r+this.getScaledValue(e.height)),this.pageContext.stroke())),this.pageContext.closePath();var h=!1;0!=e.width&&0!=e.height&&(h=!0,this.clipRect(e.x,e.y,this.getScaledValue(e.width),this.getScaledValue(e.height)));for(var c=0;c<d.length;c++)this.renderWidget(o,d[c]),s&&"StraightConnector"!==l&&(e.height=a.a.round(e.height+d[c].height,5));s&&(s=!1),h&&this.pageContext.restore()}},e.prototype.renderWidget=function(e,t){this.documentHelper.owner.enableLockAndEdit&&this.renderLockRegionBorder(e,t),t instanceof r.g?this.renderParagraphWidget(e,t):this.renderTableWidget(e,t)},e.prototype.renderLockRegionBorder=function(e,t){if(!t.isInsideTable&&t instanceof r.C&&t.locked){var o=this.documentHelper.owner.documentEditorSettings.collaborativeEditingSettings,l=e.bodyWidgets[0].sectionFormat,d=a.a.convertPointToPixel(l.leftMargin)-5,h=l.pageWidth-l.leftMargin-l.rightMargin;h=a.a.convertPointToPixel(h)+10,this.viewer instanceof s.a&&(d=t.x-5,h=(this.documentHelper.visibleBounds.width-5*this.viewer.padding.right)/this.documentHelper.zoomFactor);var c=t.previousRenderedWidget,p=t.nextRenderedWidget,u=t.lockedBy===this.documentHelper.owner.currentUser?o.editableRegionColor:o.lockedRegionColor,g=t.y,f=t.y+t.height;this.renderSingleBorder(u,d,g,d,f,1,"Single"),!i.i(n.isNullOrUndefined)(c)&&c.locked&&t.lockedBy===c.lockedBy||this.renderSingleBorder(u,d,g,d+h,g,1,"Single"),this.renderSingleBorder(u,d+h,g,d+h,f,1,"Single"),!i.i(n.isNullOrUndefined)(p)&&p.locked&&t.lockedBy===p.lockedBy||this.renderSingleBorder(u,d,f,d+h,f,1,"Single")}},e.prototype.renderHeader=function(e,t,o){if(!i.i(n.isNullOrUndefined)(o)){e.viewer.updateClientArea(e.bodyWidgets[0],e);for(var s=e.viewer.clientArea.y,a=o.ownerTable.getSplitWidgets()[0],l=0;l<=o.rowIndex;l++){if(0===a.childWidgets.length)return;var d=a.childWidgets[l];if(-1===t.childWidgets.indexOf(d)){var h=d.clone();h.containerWidget=d.containerWidget,e.viewer.updateClientAreaLocation(h,new r.t(e.viewer.clientArea.x,s,h.width,h.height)),e.documentHelper.layout.updateChildLocationForRow(s,h);for(var c=void 0,p=0;p<h.childWidgets.length;p++)c=h.childWidgets[p],this.renderTableCellWidget(e,c);s+=h.height}}t.y!==s&&e.documentHelper.layout.updateChildLocationForTable(s,t)}},e.prototype.renderParagraphWidget=function(e,t){if(!this.isFieldCode||!t.isFieldCodeBlock){var o=t.y,s=t.x,a=!1,l=t.firstChild,d=0;if(!i.i(n.isNullOrUndefined)(l))for(var h=0;h<l.children.length;h++){var c=l.children[h];if(c instanceof r.d){d=c.padding.left;break}}d>0&&(this.clipRect(t.x+d,this.getScaledValue(e.boundingRectangle.y),this.getScaledValue(e.boundingRectangle.width),this.getScaledValue(e.boundingRectangle.height)),a=!0),t.containerWidget instanceof r.x&&t.containerWidget.isEmpty&&!i.i(n.isNullOrUndefined)(this.documentHelper.selection)&&!i.i(n.isNullOrUndefined)(this.documentHelper.selection.start.paragraph)&&!this.documentHelper.selection.start.paragraph.isInHeaderFooter||this.renderParagraphBorder(e,t),a&&this.pageContext.restore();for(var h=0;h<t.childWidgets.length;h++){var p=t.childWidgets[h];o+=p.marginTop,this.renderLine(p,e,s,o),o+=p.height}}},e.prototype.renderParagraphBorder=function(e,t){var r=t.paragraphFormat.borders.left,o=t.paragraphFormat.borders.top,s=t.paragraphFormat.borders.right,l=t.paragraphFormat.borders.bottom,d=0,h=0,c=0,p=0,u=0,g=t.firstChild,f=t.lastChild,m=this.documentHelper.canRenderBorder(t);i.i(n.isNullOrUndefined)(r)||"None"===r.lineStyle||(d=this.documentHelper.getParagraphLeftPosition(t)-a.a.convertPointToPixel(r.space),c=d,p=h+t.height,"None"!==o.lineStyle&&g.isFirstLine()&&!m.skipTopBorder?(h=t.y+this.getTopMargin(t)-a.a.convertPointToPixel(o.lineWidth+o.space),p=h+t.height-(this.getTopMargin(t)-a.a.convertPointToPixel(o.lineWidth+o.space))):(h=t.y,p=h+t.height),"None"!==l.lineStyle&&f.isLastLine()&&!m.skipBottomBorder&&(p=p+a.a.convertPointToPixel(l.lineWidth+l.space)-this.getBottomMargin(t)),u=a.a.convertPointToPixel(r.lineWidth),this.renderSingleBorder(r.color,d,h,c,p,u,r.lineStyle)),i.i(n.isNullOrUndefined)(o)||"None"===o.lineStyle||!g.isFirstLine()||m.skipTopBorder||(d=this.documentHelper.getParagraphLeftPosition(t),c=d+this.getContainerWidth(t,e),h=t.y+this.getTopMargin(t)-a.a.convertPointToPixel(o.lineWidth+o.space),p=h,"None"!==r.lineStyle&&(d-=a.a.convertPointToPixel(r.space)),"None"!==s.lineStyle&&(c+=a.a.convertPointToPixel(s.space)),u=a.a.convertPointToPixel(o.lineWidth),this.renderSingleBorder(o.color,d,h,c,p,u,o.lineStyle)),i.i(n.isNullOrUndefined)(s)||"None"===s.lineStyle||(d=this.documentHelper.getParagraphLeftPosition(t)+this.getContainerWidth(t,e)+a.a.convertPointToPixel(s.space),h=p,c=d,p=h+t.height,"None"!==o.lineStyle&&g.isFirstLine()&&!m.skipTopBorder?(h=t.y+this.getTopMargin(t)-a.a.convertPointToPixel(o.lineWidth+o.space),p=h+t.height-(this.getTopMargin(t)-a.a.convertPointToPixel(o.lineWidth+o.space))):(h=t.y,p=h+t.height),"None"!==l.lineStyle&&f.isLastLine()&&!m.skipBottomBorder&&(p=p+a.a.convertPointToPixel(l.lineWidth+l.space)-this.getBottomMargin(t)),u=a.a.convertPointToPixel(s.lineWidth),this.renderSingleBorder(s.color,d,h,c,p,u,s.lineStyle)),i.i(n.isNullOrUndefined)(l)||"None"===l.lineStyle||!f.isLastLine()||m.skipBottomBorder||(d=this.documentHelper.getParagraphLeftPosition(t),c=d+this.getContainerWidth(t,e),h=t.y+t.height+a.a.convertPointToPixel(l.lineWidth+l.space)-this.getBottomMargin(t),p=h,"None"!==r.lineStyle&&(d-=a.a.convertPointToPixel(r.space)),"None"!==s.lineStyle&&(c+=a.a.convertPointToPixel(s.space)),u=a.a.convertPointToPixel(l.lineWidth),this.renderSingleBorder(l.color,d,h,c,p,u,l.lineStyle))},e.prototype.getContainerWidth=function(e,t){var i=0;if(e.paragraphFormat.firstLineIndent<0&&(i=Math.abs(e.paragraphFormat.firstLineIndent)),e.isInsideTable){var n=e.associatedCell;return n.width+n.margin.left+n.margin.right-n.leftBorderWidth}if(this.viewer instanceof s.a){var o=a.a.convertPointToPixel(e.leftIndent+e.rightIndent);return(this.documentHelper.visibleBounds.width-o-4*this.viewer.padding.right-2*this.viewer.padding.left)/this.documentHelper.zoomFactor}var l=e.bodyWidget;if(l instanceof r.o&&l.sectionFormat.columns.length>1){var d=l.columnIndex;return l.sectionFormat.columns[d].width+a.a.convertPointToPixel(i-(e.rightIndent+e.leftIndent))}var h=l.sectionFormat.pageWidth-l.sectionFormat.leftMargin-l.sectionFormat.rightMargin;return a.a.convertPointToPixel(h+i-(e.rightIndent+e.leftIndent))},e.prototype.getTopMargin=function(e){if(e.isEmpty())return e.childWidgets[0].margin.top;var t=e.childWidgets[0],r=0;return i.i(n.isNullOrUndefined)(t.margin)||(r=t.margin.top),r},e.prototype.getBottomMargin=function(e){if(e.isEmpty())return e.childWidgets[e.childWidgets.length-1].margin.bottom;var t=e.childWidgets[e.childWidgets.length-1],r=0;return i.i(n.isNullOrUndefined)(t.margin)||(r=t.margin.bottom),r},e.prototype.renderfootNoteWidget=function(e,t,o){var s=(1===t.page.bodyWidgets.length&&(1===t.page.bodyWidgets[0].childWidgets.length&&void 0!=t.page.bodyWidgets[0].childWidgets[0].isEmpty&&t.page.bodyWidgets[0].childWidgets[0].isEmpty()||t.page.bodyWidgets[0].childWidgets.length),this.getFooterHeight(e)),a=t.y+t.height;a>s&&(a=s-t.y),this.pageContext.beginPath(),this.pageContext.save(),this.pageContext.rect(this.pageLeft,this.getScaledValue(t.y,2),this.getScaledValue(o),this.getScaledValue(a)),this.pageContext.clip();for(var l=0;l<t.bodyWidgets.length;l++)for(var d=t.bodyWidgets[l],h=d.footNoteReference,c=0;c<d.childWidgets.length;c++){var p=d.childWidgets[c];if(0===l&&0===c){var u=this.pageContext,g=e.bodyWidgets[0].x;if(e.bodyWidgets.length>1&&!i.i(n.isNullOrUndefined)(d.nextWidget)&&"NoBreak"!==d.nextWidget.sectionFormat.breakCode){var f=e.bodyWidgets[0].width;this.renderSolidLine(u,this.getScaledValue(g,1),this.getScaledValue(t.y+t.margin.top/2+1,2),f*this.documentHelper.zoomFactor,"#000000")}else this.renderSolidLine(u,this.getScaledValue(g,1),this.getScaledValue(t.y+t.margin.top/2+1,2),210*this.documentHelper.zoomFactor,"#000000")}if(0===c&&!i.i(n.isNullOrUndefined)(h)&&p.childWidgets[0].children[0]instanceof r.d&&!this.documentHelper.owner.editor.isFootNoteInsert){var m=p.childWidgets[0].children[0];m.text=m.text.replace(m.text,h.text),m.width=h.width}this.renderWidget(e,p)}this.pageContext.restore()},e.prototype.renderTableWidget=function(e,t){if(!this.isFieldCode)for(var i=0;i<t.childWidgets.length;i++){var n=t.childWidgets[i];if(this.renderTableRowWidget(e,n),t.tableFormat.cellSpacing>0&&this.renderTableOutline(t),n.isRenderBookmarkEnd&&this.documentHelper.owner.documentEditorSettings.showBookmarks){var o=n.lastChild,s=o.ownerTable.isBidiTable?r.j.getCellLeftBorder(o):r.j.getCellRightBorder(o),l=a.a.convertPointToPixel(s.getLineWidth()),d=this.documentHelper.selection.getLastParagraph(n.lastChild),h=d.lastChild.height-d.lastChild.margin.bottom;this.renderBookmark(this.getScaledValue(o.x+o.width+o.margin.right-l/2+this.documentHelper.textHelper.getParagraphMarkWidth(d.characterFormat),1),this.getScaledValue(o.y-o.margin.top,2),this.getScaledValue(h),1)}}},e.prototype.renderTableRowWidget=function(e,t){for(var i=0;i<t.childWidgets.length;i++){var n=t.childWidgets[i];if(this.renderTableCellWidget(e,n),n.isRenderBookmarkEnd&&this.documentHelper.owner.documentEditorSettings.showBookmarks){var r=this.documentHelper.selection.getLastParagraph(n),o=r.lastChild,s=this.documentHelper.selection.getEndPosition(r);if(this.documentHelper.owner.documentEditorSettings.showHiddenMarks&&!this.isPrinting){var a=this.documentHelper.textHelper.getWidth(String.fromCharCode(164),o.paragraph.characterFormat)+s.x;this.renderBookmark(this.getScaledValue(a,1),this.getScaledValue(s.y,2),this.getScaledValue(o.height-o.margin.bottom),1)}else this.renderBookmark(this.getScaledValue(s.x,1),this.getScaledValue(s.y,2),this.getScaledValue(o.height-o.margin.bottom),1)}}},e.prototype.renderTableCellWidget=function(e,t){if(!this.isPrinting){var r=0,o=0;if(r=t.margin.top-t.containerWidget.topBorderWidth,o=t.margin.bottom-t.containerWidget.bottomBorderWidth,this.getScaledValue(t.y,2)+t.height+o*this.documentHelper.zoomFactor<0||this.getScaledValue(t.y,2)-r>this.documentHelper.visibleBounds.height)return}this.renderSelectionHighlightOnTable(e,t),this.renderTableCellOutline(e.documentHelper,t);for(var s=0;s<t.childWidgets.length;s++){var a=t.childWidgets[s],l=t.width+t.margin.left+t.margin.right-t.leftBorderWidth;this.isPrinting||this.clipRect(t.x-t.margin.left,t.y,this.getScaledValue(l),this.getScaledValue(this.height)),this.renderWidget(e,a),this.pageContext.restore()}if(t.isRenderEditRangeStart){var d=this.documentHelper.selection.getFirstParagraph(t),h=d.firstChild,c=h.paragraph.x,p=h.paragraph.y;if(this.documentHelper.owner.documentEditorSettings.highlightEditableRanges){var u=this.documentHelper.selection.editRegionHighlighters,g=i.i(n.isNullOrUndefined)(u)?[]:u.get(h),f=i.i(n.isNullOrUndefined)(g)||i.i(n.isNullOrUndefined)(g[0])?"ffff00":g[0].color;this.renderBookmark(this.getScaledValue(c,1),this.getScaledValue(p,2),this.getScaledValue(h.height-h.margin.bottom),0,f)}}if(t.isRenderEditRangeEnd){var m=this.documentHelper.selection.getLastParagraph(t),v=m.lastChild,y=this.documentHelper.selection.getEndPosition(m),c=this.documentHelper.textHelper.getWidth(String.fromCharCode(164),v.paragraph.characterFormat)+y.x;if(this.documentHelper.owner.documentEditorSettings.highlightEditableRanges){var u=this.documentHelper.selection.editRegionHighlighters,g=i.i(n.isNullOrUndefined)(u)?[]:u.get(v),f=i.i(n.isNullOrUndefined)(g)||i.i(n.isNullOrUndefined)(g[0])?"ffff00":g[0].color;this.renderBookmark(this.getScaledValue(c,1),this.getScaledValue(y.y,2),this.getScaledValue(v.height-v.margin.bottom),0,f)}}},e.prototype.checkHeaderFooterLineWidget=function(e,t){var o;if(e instanceof r.p?o=e.paragraph.bodyWidget:e instanceof r.j&&(o=e.bodyWidget),!i.i(n.isNullOrUndefined)(o.parentHeaderFooter)){o=o.parentHeaderFooter;for(var s=0;s<t.length;s++){var a=t[s];if(a instanceof r.p&&e instanceof r.p){var l=a.getHierarchicalIndex(""),d=e.getHierarchicalIndex("");if(a.paragraph.isInHeaderFooter&&o===a.paragraph.bodyWidget&&l.substring(l.indexOf(";"))===d.substring(d.indexOf(";")))return a}else if(a instanceof r.j&&e instanceof r.j){var l=a.getHierarchicalIndex(""),d=e.getHierarchicalIndex("");if(a.ownerTable.isInHeaderFooter&&o===a.ownerTable.bodyWidget&&l.substring(l.indexOf(";"))===d.substring(d.indexOf(";")))return a}}}},e.prototype.renderEditRegionHighlight=function(e,t,r){if(e.documentHelper.selection&&!i.i(n.isNullOrUndefined)(e.documentHelper.selection.editRegionHighlighters)){var o=this.documentHelper.selection.editRegionHighlighters.containsKey(t);if(!o&&t.paragraph.isInHeaderFooter){var s=this.documentHelper.selection.editRegionHighlighters.keys;t=this.checkHeaderFooterLineWidget(t,s),i.i(n.isNullOrUndefined)(t)||(o=!0)}if(o)for(var a=this.documentHelper.selection.editRegionHighlighters.get(t),l=0;l<a.length;l++)this.pageContext.fillStyle=""!==a[l].color?a[l].color:"#add8e6",this.pageContext.fillRect(this.getScaledValue(a[l].left,1),this.getScaledValue(r,2),this.getScaledValue(a[l].width),this.getScaledValue(t.height))}},e.prototype.renderSearchHighlight=function(e,t,r){if(this.documentHelper.owner.searchModule&&!i.i(n.isNullOrUndefined)(e.documentHelper.owner.searchModule.searchHighlighters)){var o=e.documentHelper.owner.searchModule.searchHighlighters.containsKey(t);if(!o&&t.paragraph.isInHeaderFooter){var s=e.documentHelper.owner.searchModule.searchHighlighters.keys;t=this.checkHeaderFooterLineWidget(t,s),i.i(n.isNullOrUndefined)(t)||(o=!0)}if(o)for(var a=e.documentHelper.owner.searchModule.searchHighlighters.get(t),l=0;l<a.length;l++)this.pageContext.fillStyle=this.viewer.owner.documentEditorSettings.searchHighlightColor,this.pageContext.fillRect(this.getScaledValue(a[l].left,1),this.getScaledValue(r,2),this.getScaledValue(a[l].width),this.getScaledValue(t.height))}},e.prototype.renderSelectionHighlight=function(e,t,r){if(!this.isPrinting&&e.documentHelper.owner.selection&&!this.documentHelper.isScrollToSpellCheck&&e.documentHelper.owner.selection.selectedWidgets.length>0){var o=e.documentHelper.owner.selection.selectedWidgets.containsKey(t);if(!o&&t.paragraph.isInHeaderFooter){var s=e.documentHelper.owner.selection.selectedWidgets.keys;t=this.checkHeaderFooterLineWidget(t,s),i.i(n.isNullOrUndefined)(t)||(o=!0)}o&&e.documentHelper.owner.selection.addSelectionHighlight(this.selectionContext,t,r,e)}},e.prototype.renderSelectionHighlightOnTable=function(e,t){if(!this.isPrinting&&e.documentHelper.owner.selection&&e.documentHelper.owner.selection.selectedWidgets.length>0){var r=e.documentHelper.owner.selection.selectedWidgets.containsKey(t);if(!r&&t.ownerTable.isInHeaderFooter){var o=e.documentHelper.owner.selection.selectedWidgets.keys;t=this.checkHeaderFooterLineWidget(t,o),i.i(n.isNullOrUndefined)(t)||(r=!0)}r&&e.documentHelper.owner.selection.addSelectionHighlightTable(this.selectionContext,t,e)}},e.prototype.renderLine=function(e,t,o,d){this.renderSelectionHighlight(t,e,d);var h=e.paragraph.paragraphFormat,c=o;if(e.isFirstLine()&&!h.bidi&&(o+=a.a.convertPointToPixel(h.firstLineIndent)),this.documentHelper&&this.documentHelper.selection&&!i.i(n.isNullOrUndefined)(this.documentHelper.selection.formFieldHighlighters)&&this.documentHelper.selection.formFieldHighlighters.containsKey(e)&&this.documentHelper.owner.documentEditorSettings&&this.documentHelper.owner.documentEditorSettings.formFieldSettings.applyShading)for(var p=t.documentHelper.selection.formFieldHighlighters.get(e),u=0;u<p.length;u++){this.pageContext.fillStyle=this.documentHelper.owner.documentEditorSettings.formFieldSettings.shadingColor;var g=e.height,f=!1,m=e.isLastLine();if(m&&(g-=a.a.convertPointToPixel(this.documentHelper.layout.getAfterSpacing(e.paragraph)),e.paragraph.paragraphFormat.lineSpacing>1)){var v=this.getFormfieldInLine(e);if(!i.i(n.isNullOrUndefined)(v)){var y=this.documentHelper.textHelper.getHeight(v.characterFormat),w=y.Height;"Multiple"===e.paragraph.paragraphFormat.lineSpacingType?g-=a.a.convertPointToPixel(this.documentHelper.layout.getLineSpacing(e.paragraph,w,!0)):(d+=a.a.convertPointToPixel(e.paragraph.paragraphFormat.beforeSpacing),g=y.Height,f=!0)}}this.pageContext.fillRect(this.getScaledValue(p[u].left,1),this.getScaledValue(d,2),this.getScaledValue(p[u].width),this.getScaledValue(g)),f&&(f=!1,d-=a.a.convertPointToPixel(e.paragraph.paragraphFormat.beforeSpacing))}this.renderSearchHighlight(t,e,d),this.renderEditRegionHighlight(t,e,d);var b=[],x=e.renderedElements,C=this.getUnderlineYPosition(e),I=[];if(!i.i(n.isNullOrUndefined)(e.paragraph.associatedCell)&&e.paragraph.associatedCell.isRenderBookmarkStart){e.paragraph.associatedCell.firstChild.firstChild==e&&I.push({x:o,y:d,height:e.height-e.margin.bottom,type:0})}for(var u=0;u<x.length;u++){var F=x[u];if(!(F instanceof r.v&&"Inline"!==F.textWrappingStyle)){if(F instanceof r.B||F instanceof r.G){var k=0;this.viewer instanceof s.b&&(k=this.viewer.pageGap);var P="display:block;position:absolute;",T=this.getScaledValue(d+(t.boundingRectangle.y-k*(t.index+1)))+k*(t.index+1)+"px;";if(F instanceof r.G&&(this.documentHelper.owner.currentUser===F.user||"Everyone"===F.group&&""===F.user)){if(this.documentHelper.owner.documentEditorSettings.highlightEditableRanges&&-1==F.columnFirst){var S=F.line.height-F.line.margin.bottom,W=o,N=d,H=this.documentHelper.selection.editRegionHighlighters,p=i.i(n.isNullOrUndefined)(H)?[]:H.get(e),E=i.i(n.isNullOrUndefined)(p)||i.i(n.isNullOrUndefined)(p[0])?"ffff00":p[0].color;this.renderBookmark(this.getScaledValue(W,1),this.getScaledValue(N,2),this.getScaledValue(e.height-e.margin.bottom),0,E)}if(this.documentHelper.owner.enableLockAndEdit){var O=new n.L10n("documenteditor",this.documentHelper.owner.defaultLocale);O.setLocale(this.documentHelper.owner.locale),F.renderLockMark(this.documentHelper.owner.currentUser,O);var _=this.documentHelper.owner.documentEditorSettings.collaborativeEditingSettings,E=F.user===this.documentHelper.owner.currentUser?_.editableRegionColor:_.lockedRegionColor;P+="color:"+E+";";var B=a.a.convertPointToPixel(t.bodyWidgets[0].sectionFormat.leftMargin),L=t.boundingRectangle.x+this.getScaledValue(B-20)+"px;";this.viewer instanceof s.a&&(L=e.paragraph.x-5+"px;"),P=P+"left:"+L+"top:"+T,F.editRangeMark.setAttribute("style",P)}else F.editRangeMark&&F.editRangeMark.setAttribute("style","display:none")}else if(F instanceof r.B&&0===F.commentType&&this.documentHelper.owner.selectionModule)if(this.documentHelper.owner.enableComment){var R=a.a.convertPointToPixel(t.bodyWidgets[0].sectionFormat.rightMargin),A=a.a.convertPointToPixel(t.bodyWidgets[0].sectionFormat.pageWidth),L=t.boundingRectangle.x+this.getScaledValue(A-R+R/4)+"px;";this.viewer instanceof s.a&&(L=t.boundingRectangle.width-2*this.viewer.padding.right-2*this.viewer.padding.left+"px;"),P=P+"left:"+L+"top:"+T,-1!==b.indexOf(F.commentId)||i.i(n.isNullOrUndefined)(F.comment)||F.comment.isReply||(b.push(F.commentId),F.renderCommentMark(T,L),F.commentMark.setAttribute("style",P))}else F.commentMark&&F.commentMark.setAttribute("style","display:none")}if(F instanceof r.F&&(this.documentHelper.owner.currentUser===F.editRangeStart.user||"Everyone"===F.editRangeStart.group&&""===F.editRangeStart.user)&&-1==F.editRangeStart.columnFirst&&this.documentHelper.owner.documentEditorSettings.highlightEditableRanges){var S=F.line.height-F.line.margin.bottom,W=o,N=d,H=this.documentHelper.selection.editRegionHighlighters,p=i.i(n.isNullOrUndefined)(H)?[]:H.get(e),E=i.i(n.isNullOrUndefined)(p)||i.i(n.isNullOrUndefined)(p[0])?"ffff00":p[0].color;this.renderBookmark(this.getScaledValue(W,1),this.getScaledValue(N,2),this.getScaledValue(e.height-e.margin.bottom),1,E)}if(F instanceof r.e&&this.documentHelper.owner.documentEditorSettings.showBookmarks&&-1!==this.documentHelper.getBookmarks().indexOf(F.name)){var S=F.line.height-F.line.margin.bottom,W=o,N=d;if(1==F.bookmarkType){if(this.isBookmarkEndAtStart(F)&&i.i(n.isNullOrUndefined)(F.properties)){for(var D=F.paragraph,U=void 0,M=!1;!M&&!i.i(n.isNullOrUndefined)(D);){for(var V=D.childWidgets.indexOf(F.line)>=0?D.childWidgets.indexOf(F.line):D.childWidgets.length-1,z=V;z>=0;z--){for(var j=D.childWidgets[z],q=j.children.indexOf(F)>=0?j.children.indexOf(F):j.children.length-1,G=q;G>=0;G--)if(this.isRenderable(j.children[G])){U=j.children[G],M=!0;break}if(M)break}M||(D=this.documentHelper.selection.getPreviousParagraphBlock(D))}i.i(n.isNullOrUndefined)(U)||(W+=this.documentHelper.selection.getWidth(U.line,!1)+this.documentHelper.textHelper.getParagraphMarkWidth(F.line.paragraph.characterFormat),N=this.documentHelper.selection.getTop(U.line))}i.i(n.isNullOrUndefined)(F.properties)||(F.properties.isAfterParagraphMark&&(W+=this.documentHelper.textHelper.getParagraphMarkWidth(F.line.paragraph.characterFormat)),F.properties.isAfterCellMark&&(W+=this.documentHelper.textHelper.getWidth(String.fromCharCode(164),e.paragraph.characterFormat)))}if(1==F.bookmarkType){if(!i.i(n.isNullOrUndefined)(F.reference))if(i.i(n.isNullOrUndefined)(F.reference.properties))this.documentHelper.selection.isRenderBookmarkAtEnd(F)||I.push({x:W,y:N,height:S,type:F.bookmarkType});else{var K=F.paragraph.associatedCell;i.i(n.isNullOrUndefined)(K)&&I.push({x:W,y:N,height:S,type:F.bookmarkType})}}else i.i(n.isNullOrUndefined)(F.properties)&&I.push({x:W,y:N,height:S,type:F.bookmarkType})}if(F instanceof r.b||this.isFieldCode||0===F.width&&0===F.height)this.isFieldCode&&(F.width=0),o+=F.width+F.margin.left,this.toSkipFieldCode(F);else if(this.isPrinting||!(this.getScaledValue(d+F.margin.top,2)+F.height*this.documentHelper.zoomFactor<0||this.getScaledValue(d+F.margin.top,2)>this.documentHelper.visibleBounds.height)){if(F instanceof r.q)this.renderListTextElementBox(F,o,d,C);else if(F instanceof r.r)o+=F.padding.left,this.renderImageElementBox(F,o,d,C);else if(F instanceof r.s){var Z=F.margin.left,X=this.getScaledValue(o+Z,1),J=this.getScaledValue(d,2);this.renderShapeElementBox(F,X,J,t)}else F.isVisible=!0,o+=F.padding.left,this.renderTextElementBox(F,o,d,C);o+=F.width+F.margin.left,e.paragraph.bidi?c+=F.margin.left:c=o}else o+=F.width+F.margin.left,F instanceof r.d&&(this.documentHelper.owner.isSpellCheck&&(F.canTrigger=!0),F.isVisible=!1,F.isSpellChecked&&!F.line.paragraph.isChangeDetected||(F.ischangeDetected=!0))}}if(this.documentHelper.owner.documentEditorSettings.showBookmarks&&I.length>0)for(var u=0;u<I.length;u++){var Y=I[u];this.renderBookmark(this.getScaledValue(Y.x,1),this.getScaledValue(Y.y,2),this.getScaledValue(Y.height),Y.type)}if(this.documentHelper.owner.documentEditorSettings.showHiddenMarks&&!this.isPrinting){var Q="",$=e.paragraph.characterFormat,ee=0,te=this.retriveCharacterformat($),O=new n.L10n("documenteditor",this.documentHelper.owner.defaultLocale);if(O.setLocale(this.documentHelper.owner.locale),this.pageContext.fillStyle=a.a.getColor($.fontColor),0==x.length&&!e.isEndsWithLineBreak&&!i.i(n.isNullOrUndefined)(e.paragraph)||1===e.paragraph.childWidgets.length?(ee=e.paragraph.y+this.documentHelper.textHelper.getHeight($).BaselineOffset+this.documentHelper.layout.getBeforeSpacing(e.paragraph),!e.isEndsWithLineBreak&&e.indexInOwner>0&&0==x.length&&(ee=d+e.previousLine.maxBaseLine)):ee=d+e.maxBaseLine,$.revisions.length>0){var E=this.documentHelper.authors.get($.revisions[0].author);this.pageContext.fillStyle=a.a.getColor(E)}if(e.isEndsWithColumnBreak)te=this.retriveCharacterformat($,.7),Q="....."+O.getConstant("Column Break")+".....";else if(e.isEndsWithPageBreak){te=this.retriveCharacterformat($,.7),Q=e.paragraph.bidi?String.fromCharCode(182)+"....."+O.getConstant("Page Break")+".....":"....."+O.getConstant("Page Break")+"....."+String.fromCharCode(182);var ie=this.documentHelper.textHelper.getWidth(Q,$,l.j.English);this.viewer instanceof s.b?e.paragraph.bidi?c<ie+this.viewer.clientActiveArea.x&&(Q="....."):c>this.viewer.clientActiveArea.width&&(Q="....."):e.paragraph.bidi?c-ie<this.viewer.clientActiveArea.x&&(Q="....."):c+ie>this.viewer.clientActiveArea.width+this.viewer.clientActiveArea.x&&(Q=".....")}else e.isEndsWithLineBreak?Q=e.paragraph.bidi?String.fromCharCode(8627):String.fromCharCode(8629):e.paragraph.isInsideTable&&i.i(n.isNullOrUndefined)(e.nextLine)&&i.i(n.isNullOrUndefined)(e.paragraph.nextWidget)?0!=e.height&&(Q=String.fromCharCode(164)):i.i(n.isNullOrUndefined)(e.nextLine)&&(Q=String.fromCharCode(182));if(e.paragraph.containerWidget instanceof r.o&&!i.i(n.isNullOrUndefined)(e.paragraph.nextRenderedWidget)&&e.paragraph.containerWidget.sectionIndex!==e.paragraph.nextRenderedWidget.containerWidget.sectionIndex&&e.isLastLine()){Q="NoBreak"===e.paragraph.nextRenderedWidget.containerWidget.sectionFormat.breakCode&&e.paragraph.containerWidget.index!==e.paragraph.nextRenderedWidget.containerWidget.index?":::::"+O.getConstant("Section Break Continuous")+":::::":":::::"+O.getConstant("Section Break Next Page")+":::::",te=this.retriveCharacterformat($,.7),e.isEndsWithPageBreak&&(Q=e.paragraph.bidi?Q+String.fromCharCode(182)+"....."+O.getConstant("Page Break")+".....":"....."+O.getConstant("Page Break")+"....."+String.fromCharCode(182)+Q);var ie=this.documentHelper.textHelper.getWidth(Q,$,l.j.English);this.viewer instanceof s.b?e.paragraph.bidi?c<ie+this.viewer.clientActiveArea.x&&(Q=":::::",e.isEndsWithPageBreak&&(Q=":::::.....")):c+ie-this.viewer.clientActiveArea.x>this.viewer.clientActiveArea.width&&(Q=":::::",e.isEndsWithPageBreak&&(Q=".....:::::")):e.paragraph.bidi?c-ie<this.viewer.clientActiveArea.x&&(Q=":::::",e.isEndsWithPageBreak&&(Q=":::::.....")):c+ie-this.documentHelper.pages[0].boundingRectangle.x>this.viewer.clientActiveArea.width&&(Q=":::::",e.isEndsWithPageBreak&&(Q=".....:::::"))}if(Q.length>0){e.paragraph.bidi&&!e.paragraph.isEmpty()&&(c-=this.documentHelper.textHelper.getWidth(Q,$,l.j.English)),this.pageContext.font=te;var ne=$.scaling<100?1:$.scaling/100;this.pageContext.letterSpacing=$.characterSpacing*this.documentHelper.zoomFactor+"pt",this.pageContext.save(),this.pageContext.scale(ne,1),this.pageContext.fillText(Q,this.getScaledValue(c,1)/ne,this.getScaledValue(ee,2)),this.pageContext.restore()}}},e.prototype.isBookmarkEndAtStart=function(e){for(var t=e.paragraph,i=0,n=t.childWidgets[i],r=!0;-1==n.children.indexOf(e)&&(n=t.childWidgets[++i],i!=t.childWidgets.length););if(e.line!=n)return!1;for(var o=n.children.indexOf(e)>=0?n.children.indexOf(e):-1,s=o;s>=0;s--){var a=n.children[s];this.isRenderable(a)&&(r=!1)}return!!r},e.prototype.isRenderable=function(e){return!(e instanceof r.e||e instanceof r.G||e instanceof r.F)},e.prototype.combineHexColors=function(e,t){var i=e.replace("#",""),n=t.replace("#",""),r=parseInt(i.substring(0,2),16),o=parseInt(i.substring(2,4),16),s=parseInt(i.substring(4,6),16),a=parseInt(n.substring(0,2),16),l=parseInt(n.substring(2,4),16),d=parseInt(n.substring(4,6),16),h=Math.round(.35*r+.65*a),c=Math.round(.35*o+.65*l),p=Math.round(.35*s+.65*d);return"#"+h.toString(16)+c.toString(16)+p.toString(16)},e.prototype.renderBookmark=function(e,t,r,o,s){if(!this.isPrinting){this.pageContext.beginPath(),this.pageContext.lineWidth=1.5;if(0==o&&(this.pageContext.moveTo(e+3,t),this.pageContext.lineTo(e,t),this.pageContext.lineTo(e,t+r),this.pageContext.lineTo(e+3,t+r)),1==o&&(this.pageContext.moveTo(e-3,t),this.pageContext.lineTo(e,t),this.pageContext.lineTo(e,t+r),this.pageContext.lineTo(e-3,t+r)),this.pageContext.strokeStyle="#7F7F7F",this.pageContext.stroke(),this.pageContext.closePath(),!i.i(n.isNullOrUndefined)(s)){var a=this.combineHexColors(s,"#7F7F7F");this.pageContext.fillStyle=a,this.pageContext.fillRect(e,t,1.5,r)}}},e.prototype.retriveCharacterformat=function(e,t){i.i(n.isNullOrUndefined)(t)&&(t=1);this.pageContext.textBaseline="alphabetic";var r="",o="",s=11,a="";return r=e.bold?"bold":"",o=e.italic?"italic":"",s=0===e.fontSize?.5:e.fontSize/("Normal"===e.baselineAlignment?1:1.5),s=s*this.documentHelper.zoomFactor*t,a=e.fontFamily,r+" "+o+" "+s+'pt "'+a+'"'},e.prototype.toSkipFieldCode=function(e){e instanceof r.b&&(0===e.fieldType?this.isFieldCode||i.i(n.isNullOrUndefined)(e.fieldEnd)&&!e.hasFieldEnd||(this.fieldStacks.push(e),this.isFieldCode=!0):2!==e.fieldType&&1!==e.fieldType||this.fieldStacks.length>0&&e.fieldBegin===this.fieldStacks[this.fieldStacks.length-1]&&(this.fieldStacks.pop(),this.isFieldCode=!1))},e.prototype.getUnderlineYPosition=function(e){for(var t=0,i=0,n=0;n<e.children.length;n++)e.children[n]instanceof r.b||0===e.children[n].width&&0===e.children[n].height||e.children[n]instanceof r.s||t<e.children[n].height+e.children[n].margin.top&&(t=e.children[n].margin.top+e.children[n].height,i=e.children[n]instanceof r.r?.9:e.children[n].height/20);return t-2*i},e.prototype.renderListTextElementBox=function(e,t,o,s){var l=e.margin.top,d=e.margin.left,h=e.listLevel.characterFormat,c=e.line.paragraph.characterFormat,p=h.hasValue("fontColor")?h.fontColor:c.fontColor;this.pageContext.textBaseline="alphabetic";var u="",g="",f=h.hasValue("fontFamily")?h.fontFamily:c.fontFamily;!this.documentHelper.isIosDevice||e.text!==String.fromCharCode(9679)&&e.text!==String.fromCharCode(9675)||(f="");var m=h.hasValue("fontSize")?h.fontSize:c.fontSize,v=h.hasValue("baselineAlignment")?h.baselineAlignment:c.baselineAlignment;u=h.hasValue("bold")?h.bold?"bold":"":c.bold?"bold":"",g=h.hasValue("italic")?h.italic?"italic":"":c.italic?"italic":"",m=0===m?.5:m/("Normal"===v?1:1.5),m=this.isPrinting?m:m*this.documentHelper.zoomFactor;var y=h.hasValue("strikethrough")?h.strikethrough:c.strikethrough,w=h.hasValue("highlightColor")?h.highlightColor:c.highlightColor;"NoColor"!==w&&("#"!==w.substring(0,1)?this.pageContext.fillStyle=a.a.getHighlightColorCode(w):this.pageContext.fillStyle=a.a.getColor(w),this.pageContext.fillRect(Math.floor(this.getScaledValue(t+d,1)),Math.floor(this.getScaledValue(o+l,2)-1),Math.ceil(this.getScaledValue(e.width)+1),Math.ceil(this.getScaledValue(e.height)+1))),this.pageContext.font=u+" "+g+" "+m+'pt "'+f+'"',"Subscript"===v&&(l+=e.height-e.height/1.5);var b=e.baselineOffset;l="Normal"===h.baselineAlignment?l+b:l+b/1.5;var x=e.text,C=e.paragraph.paragraphFormat.bidi;if(C&&(this.pageContext.direction="rtl",t+=e.width),"empty"===p||"#00000000"===p){var I=this.getBackgroundColorHeirachy(e);this.pageContext.fillStyle=this.getDefaultFontColor(I)}else this.pageContext.fillStyle=a.a.getColor(p);var F=h.scaling<100?1:h.scaling/100;this.documentHelper.owner.documentEditorSettings.showHiddenMarks&&!this.isPrinting?(e instanceof r.q&&"\t"===e.text&&this.tabMark(e,h,t,o,d,l),this.pageContext.letterSpacing=h.characterSpacing*this.documentHelper.zoomFactor+"pt",this.pageContext.save(),this.pageContext.scale(F,1),this.pageContext.fillText(this.replaceSpace(x),this.getScaledValue(t+d,1)/F,this.getScaledValue(o+l,2),this.getScaledValue(e.width)),this.pageContext.restore()):(this.pageContext.letterSpacing=h.characterSpacing*this.documentHelper.zoomFactor+"pt",this.pageContext.save(),this.pageContext.scale(F,1),this.pageContext.fillText(x,this.getScaledValue(t+d,1)/F,this.getScaledValue(o+l,2),this.getScaledValue(e.width)),this.pageContext.restore()),C&&(this.pageContext.direction="ltr",t-=e.width),"None"===h.underline||i.i(n.isNullOrUndefined)(h.underline)||this.renderUnderline(e,t,o,s,p,h.underline,v),"None"!==y&&this.renderStrikeThrough(e,t,o,h.strikethrough,p,v)},e.prototype.getDefaultFontColor=function(e){return a.a.isVeryDark(e)?"#FFFFFF":"#000000"},e.prototype.renderTextElementBox=function(e,t,o,s){var d=!1,h=e.line.paragraph.containerWidget;h instanceof r.j&&(d="Exactly"===h.ownerRow.rowFormat.heightType);var c=e.margin.top,p=e.margin.left;if(d&&h instanceof r.j){var u=h.width+h.margin.left+h.margin.right-h.leftBorderWidth;this.clipRect(h.x-h.margin.left,h.y,this.getScaledValue(u),this.getScaledValue(h.height))}var g=e.characterFormat,f=!0;if("NoColor"!=g.highlightColor&&""==e.text.trim()){var m=e.line.paragraph.firstChild,v=e.line.paragraph.lastChild;!i.i(n.isNullOrUndefined)(m)&&m instanceof r.p&&m.children.length>0&&e===m.children[0]&&(f=!1),!i.i(n.isNullOrUndefined)(v)&&v instanceof r.p&&v.children.length>0&&e===v.children[v.children.length-1]&&(f=!1)}"NoColor"!==g.highlightColor&&f&&("#"!==g.highlightColor.substring(0,1)?this.pageContext.fillStyle=a.a.getHighlightColorCode(g.highlightColor):this.pageContext.fillStyle=a.a.getColor(g.highlightColor),this.pageContext.fillRect(Math.floor(this.getScaledValue(t+p,1)),Math.floor(this.getScaledValue(o+c,2)-1),Math.ceil(this.getScaledValue(e.width)+1),Math.ceil(this.getScaledValue(e.height)+1)));var y=this.checkRevisionType(e),w=y.length>0?this.getRevisionColor(y):g.fontColor;this.pageContext.textBaseline="alphabetic";var b="",x="",C=11;b=g.bold?"bold":"",x=g.italic?"italic":"",C=0===g.fontSize?.5:g.fontSize/("Normal"===g.baselineAlignment?1:1.5),C=this.isPrinting?C:C*this.documentHelper.zoomFactor;var I=this.documentHelper.textHelper.getFontNameToRender(e.scriptType,g);this.pageContext.font=b+" "+x+" "+C+'pt "'+I+'"',"Subscript"===g.baselineAlignment&&(c+=e.height-e.height/1.5);var F=e.baselineOffset;if(c="Normal"===g.baselineAlignment?c+F:c+F/1.5,"empty"===w||"#00000000"===w){var k=this.getBackgroundColorHeirachy(e);this.pageContext.fillStyle=this.getDefaultFontColor(k)}else this.pageContext.fillStyle=a.a.getColor(w);var P=this.getScaledValue(e.width),T=e.text;if(e instanceof r.I){var S=e;""!==S.tabText||i.i(n.isNullOrUndefined)(S.tabLeader)||"None"===S.tabLeader?""!==S.tabText&&(T=S.tabText):(T=this.getTabLeader(e),S.tabText=T)}var W=g.bidi||this.documentHelper.textHelper.isRTLText(e.text);T=this.documentHelper.textHelper.setText(T,W,g.bdo,!0),g.allCaps&&(T=T.toUpperCase());var N=e.characterRange;(N==l.i.WordSplit||(N&l.i.WordSplit)==l.i.WordSplit&&(N&l.i.RightToLeft)==l.i.RightToLeft)&&g.bidi&&(T=this.inverseCharacter(T));var H=g.scaling<100?1:g.scaling/100;if(N!==l.i.RightToLeft||a.a.startsWith(T," ")||(this.pageContext.direction="rtl",t+=e.width),this.documentHelper.owner.documentEditorSettings.showHiddenMarks&&!this.isPrinting?((e instanceof r.I||e instanceof r.d)&&"\t"===e.text&&this.tabMark(e,g,t,o,p,c),"\r"===T&&(T=String.fromCharCode(182)),this.pageContext.letterSpacing=g.characterSpacing*this.documentHelper.zoomFactor+"pt",this.pageContext.save(),this.pageContext.scale(H,1),this.pageContext.fillText(this.replaceSpace(T),this.getScaledValue(t+p,1)/H,this.getScaledValue(o+c,2),P),this.pageContext.restore()):(this.pageContext.letterSpacing=g.characterSpacing*this.documentHelper.zoomFactor+"pt",this.pageContext.save(),this.pageContext.scale(H,1),this.pageContext.fillText(T,this.getScaledValue(t+p,1)/H,this.getScaledValue(o+c,2),P),this.pageContext.restore()),N!==l.i.RightToLeft||a.a.startsWith(T," ")||(this.pageContext.direction="ltr",t-=e.width),this.documentHelper.owner.isSpellCheck&&this.documentHelper.owner.isSpellCheck&&!this.spellChecker.removeUnderline&&(this.documentHelper.triggerSpellCheck||e.canTrigger)&&" "!==e.text&&!this.documentHelper.isScrollHandler&&(i.i(n.isNullOrUndefined)(e.previousNode)||!(e.previousNode instanceof r.b))&&(!this.documentHelper.selection.isSelectionInsideElement(e)||this.documentHelper.triggerElementsOnLoading)){e.canTrigger=!0,this.leftPosition=this.pageLeft,this.topPosition=this.pageTop;var E=this.spellChecker.checktextElementHasErrors(e.text,e,t);if(E.errorFound&&!this.isPrinting){w="#FF0000";for(var O=h instanceof r.j?h.cellFormat.shading.backgroundColor:this.documentHelper.backgroundColor,_=0;_<E.elements.length;_++){var B=E.elements[_];-1===e.ignoreOnceItems.indexOf(this.spellChecker.manageSpecialCharacters(B.text,void 0,!0))&&(W?this.renderWavyLine(B,i.i(n.isNullOrUndefined)(B.end)?t:B.end.location.x,o,s,w,"Single",g.baselineAlignment,O):this.renderWavyLine(B,i.i(n.isNullOrUndefined)(B.start)?t:B.start.location.x,o,s,w,"Single",g.baselineAlignment,O))}}else(e.ischangeDetected||this.documentHelper.triggerElementsOnLoading)&&(e.ischangeDetected=!1,this.handleChangeDetectedElements(e,s,t,o,g.baselineAlignment))}var L=this.getRevisionType(y,!0);("None"===g.underline||i.i(n.isNullOrUndefined)(g.underline))&&(i.i(n.isNullOrUndefined)(L)||"Insertion"!==L.type&&"MoveTo"!==L.type)||this.renderUnderline(e,t,o,s,w,g.underline,g.baselineAlignment,L),L=this.getRevisionType(y,!1),("None"===g.strikethrough||i.i(n.isNullOrUndefined)(g.strikethrough))&&(i.i(n.isNullOrUndefined)(L)||"Deletion"!==L.type&&"MoveFrom"!==L.type)||this.renderStrikeThrough(e,t,o,g.strikethrough,w,g.baselineAlignment,L),d&&this.pageContext.restore()},e.prototype.tabMark=function(e,t,i,n,r,o){var s=e.paragraph.bidi?String.fromCharCode(8592):String.fromCharCode(8594),a=this.documentHelper.textHelper.getWidth(s,t,e.scriptType),l=e.width/2,d=a/2;this.pageContext.font=this.retriveCharacterformat(e.characterFormat),this.pageContext.letterSpacing=t.characterSpacing*this.documentHelper.zoomFactor+"pt",this.pageContext.save();var h=t.scaling<100?1:t.scaling/100;this.pageContext.scale(h,1),l>a?this.pageContext.fillText(s,this.getScaledValue(i+r+l-d,1)/h,this.getScaledValue(n+o,2)):this.pageContext.fillText(s,this.getScaledValue(i+r,1)/h,this.getScaledValue(n+o,2),this.getScaledValue(e.width)),this.pageContext.restore()},e.prototype.replaceSpace=function(e){return e=e.replace(new RegExp(String.fromCharCode(32),"g"),String.fromCharCode(183)),e=e.replace(new RegExp(String.fromCharCode(160),"g"),String.fromCharCode(176))},e.prototype.inverseCharacter=function(e){switch(e){case String.fromCharCode(40):return String.fromCharCode(41);case String.fromCharCode(41):return String.fromCharCode(40);case String.fromCharCode(60):return String.fromCharCode(62);case String.fromCharCode(62):return String.fromCharCode(60);case String.fromCharCode(123):return String.fromCharCode(125);case String.fromCharCode(125):return String.fromCharCode(123);case String.fromCharCode(91):return String.fromCharCode(93);case String.fromCharCode(93):return String.fromCharCode(91);default:return e}},e.prototype.getBackgroundColorHeirachy=function(e){var t;if(e.paragraph.isInsideTable){var o=e.paragraph.containerWidget;if("empty"!==(t=o.cellFormat.shading.backgroundColor)&&"#00000000"!==t)return t;if("empty"!==(t=o.ownerTable.tableFormat.shading.backgroundColor)&&"#00000000"!==t)return t}else if(e.paragraph.containerWidget instanceof r.i&&!i.i(n.isNullOrUndefined)(e.paragraph.containerWidget.containerShape)&&!i.i(n.isNullOrUndefined)(e.paragraph.containerWidget.containerShape.fillFormat)&&"#000000FF"===e.paragraph.containerWidget.containerShape.fillFormat.color)return e.paragraph.containerWidget.containerShape.fillFormat.color;return this.documentHelper.backgroundColor},e.prototype.handleChangeDetectedElements=function(e,t,i,n,r){var o=this,s=e.text.trim(),a=this.pageIndex;if("\v"!==e.text&&!this.spellChecker.checkElementCanBeCombined(e,t,a,!0)){var l=s.split(/[\s]+/),d=e.line.getOffset(e,0);if(l.length>1)for(var h=0;h<l.length;h++){var c=l[h],p=this.spellChecker.manageSpecialCharacters(c,void 0,!0);-1===this.spellChecker.ignoreAllItems.indexOf(p)&&-1===e.ignoreOnceItems.indexOf(p)&&(this.handleUnorderedElements(p,e,t,h,d,h===l.length-1,a),d+=c.length+1)}else{var p=this.spellChecker.manageSpecialCharacters(s,void 0,!0);if(s.length>0&&-1===this.spellChecker.ignoreAllItems.indexOf(p)&&-1===e.ignoreOnceItems.indexOf(p)){var u=e.indexInOwner,g=e.line.paragraph.indexInOwner,f=this.spellChecker.checkSpellingInPageInfo(p);if(f.isElementPresent&&this.spellChecker.enableOptimizedSpellCheck){var m=JSON.parse('{"HasSpellingError":'+f.hasSpellError+"}");this.spellChecker.handleWordByWordSpellCheck(m,e,i,n,t,r,!0)}else if(this.spellChecker.isInUniqueWords(p)){var v=!!this.spellChecker.isErrorWord(p),m=JSON.parse('{"HasSpellingError":'+v+"}");this.spellChecker.handleWordByWordSpellCheck(m,e,i,n,t,r,!0)}else this.documentHelper.owner.editor.triggerPageSpellCheck&&!this.documentHelper.triggerElementsOnLoading||this.spellChecker.callSpellChecker(this.spellChecker.languageID,s,!0,this.spellChecker.allowSpellCheckAndSuggestion).then(function(s){var l=JSON.parse(s),d=(a===o.pageIndex||e.isVisible)&&u===e.indexInOwner&&g===e.line.paragraph.indexInOwner;o.spellChecker.handleWordByWordSpellCheck(l,e,i,n,t,r,d)})}}}},e.prototype.handleUnorderedElements=function(e,t,i,n,r,o,s){var a=this,l=t.indexInOwner,d=t.line.paragraph.indexInOwner;if(e.length>0){var h=this.spellChecker.checkSpellingInPageInfo(e);if(h.isElementPresent&&this.spellChecker.enableOptimizedSpellCheck){var c=JSON.parse('{"HasSpellingError":'+h.hasSpellError+"}");this.spellChecker.handleSplitWordSpellCheck(c,e,t,!0,i,n,r,o)}else{var p=t.isVisible&&l===t.indexInOwner&&d===t.line.paragraph.indexInOwner;if(this.spellChecker.isInUniqueWords(e)){var u=!!this.spellChecker.isErrorWord(e),c=JSON.parse('{"HasSpellingError":'+u+"}");this.spellChecker.handleSplitWordSpellCheck(c,e,t,p,i,n,r,o)}else this.documentHelper.owner.editor.triggerPageSpellCheck&&!this.documentHelper.triggerElementsOnLoading||this.spellChecker.callSpellChecker(this.spellChecker.languageID,e,!0,this.spellChecker.allowSpellCheckAndSuggestion).then(function(s){var l=JSON.parse(s);a.spellChecker.handleSplitWordSpellCheck(l,e,t,p,i,n,r,o)})}}},e.prototype.renderWavyLine=function(e,t,i,n,o,s,l,d){if(!this.isPrinting&&e.text.length>1){var h=e.height/("Normal"===l?1:1.5),c=e.margin.top,p=h/20,u=0;"Subscript"===l||e instanceof r.q?(u=h-2*p+i,c+=e.height-h,u+=c>0?c:0):u=n+i;var g=this.spellChecker.getSpecialCharactersInfo(e),f=this.spellChecker.getWhiteSpaceCharacterInfo(e),m=t+g.beginningWidth+(f.isBeginning?f.width:0)+e.margin.left,v=m*this.documentHelper.zoomFactor+this.leftPosition,y=u*this.documentHelper.zoomFactor+this.topPosition,w=v+this.getScaledValue(e.width-(g.beginningWidth+g.endWidth)-f.width),b=new a.b(v,y),x=new a.b(w,y);this.drawWavy(b,x,.5*(w-v),1,.7,o,e.height,d)}},e.prototype.drawWavy=function(e,t,r,o,s,a,l,d,h){this.pageContext.save(),this.pageContext.fillStyle=i.i(n.isNullOrUndefined)(d)?this.documentHelper.backgroundColor:d,this.pageContext.fillRect(e.x,e.y-o,t.x-e.x,3*o),this.pageContext.restore(),this.pageContext.lineWidth=1,this.pageContext.lineCap="round",this.pageContext.strokeStyle=a,this.pageContext.beginPath();var c=0,p=0,u=e.x,g=e.y,f=t.x,m=t.y,v=0,y=0,w=Math.atan2(m-g,f-u),b=Math.sqrt((u-f)*(u-f)+(g-m)*(g-m)),x=1*o,C=Math.PI*r;for(v;v<=b;v+=s)y=Math.sin(v/b*C)*x,c=e.x+Math.cos(w)*v+Math.cos(w-Math.PI/2)*y,p=e.y+Math.sin(w)*v+Math.sin(w-Math.PI/2)*y,v>0?this.pageContext.lineTo(c,p):this.pageContext.moveTo(c,p);this.pageContext.stroke(),this.pageContext.restore()},e.prototype.getTabLeader=function(e){var t=0,i=this.getTabLeaderString(e.tabLeader),n=i;t=this.documentHelper.textHelper.getWidth(n,e.characterFormat,e.scriptType);var r=Math.floor(e.width/t);0==t&&(r=0);for(var o=0;o<=r;o++)n+=i;return n.slice(0,-1)},e.prototype.getTabLeaderString=function(e){var t="";switch(e){case"Dot":t=".";break;case"Hyphen":t="-";break;case"Underscore":t="_"}return t},e.prototype.clipRect=function(e,t,i,n){this.pageContext.beginPath(),this.pageContext.save(),this.pageContext.rect(this.getScaledValue(e,1),this.getScaledValue(t,2),i,n),this.pageContext.clip()},e.prototype.getTrimmedWidth=function(e){var t=e.width;return e instanceof r.d&&!(e instanceof r.I)&&i.i(n.isNullOrUndefined)(e.nextNode)&&(t=this.documentHelper.textHelper.getWidth(a.a.trimEnd(e.text),e.characterFormat,e.scriptType)),t},e.prototype.renderUnderline=function(e,t,o,s,a,l,d,h){var c=e.height/("Normal"===d?1:1.5),p=e.margin.top,u=c/20,g=0,f=c/20;"Subscript"===d||e instanceof r.q?(g=c-2*u+o,p+=e.height-c,g+=p>0?p:0):g=s+o;var m=0;for(i.i(n.isNullOrUndefined)(h)||(l="MoveTo"===h.type?"Double":"Single"),"Double"===l&&(g-=f),e instanceof r.r&&(u=.9);m<("Double"===l?2:1);){m++;var v=this.getTrimmedWidth(e);this.pageContext.fillRect(this.getScaledValue(t+e.margin.left,1),this.getScaledValue(g,2),this.getScaledValue(v),this.getScaledValue(u)),g+=2*f}},e.prototype.renderStrikeThrough=function(e,t,o,s,a,l,d){var h=e.height/("Normal"===l?1:1.5),c=e.margin.top;"Subscript"===l&&(c+=e.height-h),o+=c>0?c:0;var p=h/20,u=h/2+.5*p,g=0;for(i.i(n.isNullOrUndefined)(d)||(s="Deletion"===d.type?"SingleStrike":"DoubleStrike"),e instanceof r.r&&(p=.9),"DoubleStrike"===s&&(u-=p);g<("DoubleStrike"===s?2:1);){g++;var f=this.getTrimmedWidth(e);this.pageContext.fillRect(this.getScaledValue(t+e.margin.left,1),this.getScaledValue(u+o,2),this.getScaledValue(f),this.getScaledValue(p)),u+=2*p}},e.prototype.renderImageElementBox=function(e,t,o,s){var l=e.margin.top,d=e.margin.left,h=this.checkRevisionType(e),c=h.length>0?this.getRevisionColor(h):"black";this.pageContext.textBaseline="top";var p=0,u=!1,g=e.line.paragraph.containerWidget,f=!1;if(g instanceof r.j&&(f="Exactly"===g.ownerRow.rowFormat.heightType),"Inline"===e.textWrappingStyle)if(l<0||e.line.paragraph.width<e.width){if(g instanceof r.j){var m=0;if(g.childWidgets[0]instanceof r.g){var v=g.childWidgets[0];m=v.paragraphFormat.leftIndent}p=g.width+g.margin.left-g.leftBorderWidth-m,u=!0,this.clipRect(t+d,o+l,this.getScaledValue(p),this.getScaledValue(g.height))}}else if(f){var y=g.width+g.margin.left-g.leftBorderWidth;u=!0,this.clipRect(g.x,g.y,this.getScaledValue(y),this.getScaledValue(g.height))}if(e.isMetaFile&&!i.i(n.isNullOrUndefined)(e.metaFileImageString))this.pageContext.drawImage(e.element,this.getScaledValue(t+d,1),this.getScaledValue(o+l,2),this.getScaledValue(e.width),this.getScaledValue(e.height));else{var w="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAgVBMVEX///8AAADgAADY2Njl5eVcXFxjY2NZWVl/f3+wsLCmpqb4+PiioqKpqam7u7vV1dX2uLj2wsLhFRXzpKT3vb30sbHhCwv74+P40dH+9vbkIyO2trbBwcHLy8tsbGycnJz529v4zMzrbGzlLS3qZmblNzfrdXXoRkbvi4vvgYHlHh7CZsBOAAADpUlEQVR4nO3da1faQBSF4ekAUQlUEFs14AXxVv7/D6yaQiZx5mSEYXF2ut+PNKzyyK5diYDmR9czx34AB49C/CjE759w3jvvWr15Tdgz3atXE54f++EcIArxoxA/CvGjED8K8aMQPwrxoxA/CvGLEeZ9jPJdhfk4GyCUjb3ECGE/Q6m/q3DwfudjP0ERZYN9hKdn2hvd3+0jHJz5/kBVuTk96bbQUEjhYR9ckiikUH8UUqg/CinUH4UU6o9CCvVHIYX6o5BC/VFIof4opFB/FFKoPwop1B+FFOqPQgrjyxfjVC38Lxk9tnAxGqZqdKtSOE4GHA5/fuNJpDCtcNHbv4VqYYqPLjgfUViPQgrjozA2CptRSGF8/59w+Wrt+rr1btNna1cPzg0wwuXavncxabnX7PfHYYXzlYARvlobQZyUR9mXm+1NMEK7SSLONgcVV9vb8IQXv4J3KSeKKlxXxNCzONkeYp8AV3p9UT1+P3FWHVAsq5thhGZSEb1DrSZq7dS5HUdoLiuBZ6jORG3tCwAkNJfCUJ2Jrqe1P0ESCkMNTdSACYNDDU7UoAkDQw1P1MAJvUMVJmrwhJ6hShM1gMIvQxUnahCFjaHKEzWQQneoxR95ogZTWBuqPFEDKnSHKk/UoArdoYoTNbDC5lBDEzW4QjMpYiZqgIXG/S76JhwHK5zVVipcnkIVuv/RW/HyFKhwYhuFr6NiCmdNoDBUSGFjovJQEYXuRN9ahwoorJ8uSZenPsMTNk+X2q6jwgm/ntHL11HhhL4zenmoYEL/Gb04VCxh6KKTNFQoYfiikzBUJKF00Sk8VCChfF00OFQcYdt10dBQYYRT5xn0n9G7Q0X8GfCzNNEyZ6iPgD/HlydaVg11DfhajJaJlm2HugIUrlomWrYZKuJKHz6vHhbSM/hROdRnxNe1meuXYvW0DB6+aflYrB7dlzDiCM3N1dVN6GDhMCDhjlHYjEIK46MwNgqbUUhhfJ/vA07wO8N1vw94ONo/3e/lTpVOYfc/UyG//ZmqW52fi/FuTNW3/lZ+eguF+qOQQv1RSKH+KKRQfxRSqD8KKdQfhRTqj0IK9UchhfqjkEL9UUih/iikUH8UUqg/CmXh6Hsv3jlK+wnvD/vgkrSHMMuyu1P9ZdmuwnycDQYn+svG3n9KEUKT9zHyf6+IEWJHIX4U4kchfhTiRyF+FOJHIX4U4kchfnVhijeZa6sunCf4ZdPamteEHY5C/CjEr/vCv0ec0g+AtS1QAAAAAElFTkSuQmCC";try{var b=this.getScaledValue(t+d,1),x=this.getScaledValue(o+l,2),C=this.getScaledValue(e.width),I=this.getScaledValue(e.height),F=this;e.element.onload=function(){var t=e.element.getAttribute("lastLoaded");i.i(n.isNullOrUndefined)(F.documentHelper)||t===e.element.src||(e.isCrop?F.pageContext.drawImage(e.element,e.cropX,e.cropY,e.cropWidth,e.cropHeight,b,x,C,I):F.pageContext.drawImage(e.element,b,x,C,I))},e.element.onerror=function(){e.element.src=w},e.isCrop?this.pageContext.drawImage(e.element,e.cropX,e.cropY,e.cropWidth,e.cropHeight,b,x,C,I):this.pageContext.drawImage(e.element,b,x,C,I)}catch(i){e.imageString=w,this.documentHelper.addBase64StringInCollection(e),e.element.src=this.documentHelper.getImageString(e),this.pageContext.drawImage(e.element,this.getScaledValue(t+d,1),this.getScaledValue(o+l,2),this.getScaledValue(e.width),this.getScaledValue(e.height))}}this.pageContext.fillStyle=a.a.getColor(c);var k=this.getRevisionType(h,!1);if(i.i(n.isNullOrUndefined)(k)||"Deletion"!==k.type&&"MoveFrom"!==k.type||this.renderStrikeThrough(e,t,o,"SingleStrike",c,"Normal",k),k=this.getRevisionType(h,!0),!i.i(n.isNullOrUndefined)(k)&&("Insertion"===k.type||"MoveTo"===k.type)){var P=this.getUnderlineYPosition(e.line);this.renderUnderline(e,t,o,P,c,"Single","Normal")}u&&this.pageContext.restore()},e.prototype.renderTableOutline=function(e){var t=new o.a(this.documentHelper),i=e;e.width=this.documentHelper.layout.getTableWidth(i);var n=i.isBidiTable?t.getTableRightBorder(i.tableFormat.borders):t.getTableLeftBorder(i.tableFormat.borders),r=0;r=a.a.convertPointToPixel(n.getLineWidth()),this.renderSingleBorder(n.color,e.x-e.margin.left-r/2,e.y,e.x-e.margin.left-r/2,e.y+e.height,r,n.lineStyle),n=t.getTableTopBorder(i.tableFormat.borders),r=0,r=a.a.convertPointToPixel(n.getLineWidth()),this.renderSingleBorder(n.color,e.x-e.margin.left-r,e.y-r/2,e.x+e.width+r+e.margin.right,e.y-r/2,r,n.lineStyle),n=i.isBidiTable?t.getTableLeftBorder(i.tableFormat.borders):t.getTableRightBorder(i.tableFormat.borders),r=0,r=a.a.convertPointToPixel(n.getLineWidth()),this.renderSingleBorder(n.color,e.x+e.width+e.margin.right+r/2,e.y,e.x+e.width+e.margin.right+r/2,e.y+e.height,r,n.lineStyle),n=t.getTableBottomBorder(i.tableFormat.borders),r=0,r=a.a.convertPointToPixel(n.getLineWidth()),this.renderSingleBorder(n.color,e.x-e.margin.left-r,e.y+e.height-r/2,e.x+e.width+r+e.margin.right,e.y+e.height-r/2,r,n.lineStyle)},e.prototype.renderTableCellOutline=function(e,t){var o=e.layout,s=t,l=0,d=0,h=0,c=0,p=0,u=t.ownerTable.isBidiTable;s.cellFormat.borders,t.containerWidget instanceof r.z&&(d=t.margin.bottom-t.containerWidget.bottomBorderWidth,l=t.margin.top-t.containerWidget.topBorderWidth),h=t.margin.left-t.leftBorderWidth,c=t.margin.right-t.rightBorderWidth,p=i.i(n.isNullOrUndefined)(s.ownerRow)||"Exactly"!==s.ownerRow.rowFormat.heightType?!i.i(n.isNullOrUndefined)(s.ownerRow)&&[s.ownerRow].length<=1?Math.max(a.a.convertPointToPixel(s.ownerRow.rowFormat.height),t.height)+l+d:t.height+l+d:a.a.convertPointToPixel(s.ownerRow.rowFormat.height)+l+d;var g=u?r.j.getCellRightBorder(s):r.j.getCellLeftBorder(s),f=0;f=a.a.convertPointToPixel(g.getLineWidth()),this.renderCellBackground(p,t,h,c,f);var m=f;if(0===s.index||1===s.cellFormat.rowSpan||s.cellFormat.rowSpan>1&&0===s.columnIndex)this.renderSingleBorder(g.color,t.x-h-f,t.y-t.margin.top,t.x-h-f,t.y+t.height+d,f,g.lineStyle);else for(var v=0;v<s.ownerTable.childWidgets.length;v++){for(var y=s.ownerTable.childWidgets[v],w=void 0,b=0;b<y.childWidgets.length;b++){var x=y.childWidgets[b];if(x.columnIndex+x.cellFormat.columnSpan-1==s.columnIndex-1){w=x;break}if(y.childWidgets[b].columnIndex>=s.columnIndex&&y.childWidgets[b].previousWidget){w=y.childWidgets[b].previousWidget;break}}if(w&&w.columnIndex+w.cellFormat.columnSpan-1==s.columnIndex-1){var C=u?r.j.getCellLeftBorder(w):r.j.getCellRightBorder(w),I=a.a.convertPointToPixel(C.getLineWidth());if(h=s.margin.left-I,w.y+w.height<s.y)continue;if(w.y<s.y&&w.y+w.height>s.y)this.renderSingleBorder(C.color,s.x-h-I,s.y-l,s.x-h-I,w.y+w.height+w.margin.bottom,I,C.lineStyle);else if(w.y===s.y||w.y>s.y&&w.y+w.height<s.y+s.height)this.renderSingleBorder(C.color,s.x-h-I,w.y-w.margin.top,s.x-h-I,w.y+w.height+w.margin.bottom,I,C.lineStyle);else if(w.y<s.y+s.height&&w.y+w.height>=s.y+s.height)this.renderSingleBorder(C.color,s.x-h-I,w.y-w.margin.top,s.x-h-I,w.y+w.height+d,I,C.lineStyle);else if(w.y>s.y+s.height)break}}if(s.updatedTopBorders&&s.updatedTopBorders.length>1)for(var F=t.x-t.margin.left-m/2,k=t.y-t.margin.top,P=0;P<s.updatedTopBorders.length;P++){var T=s.updatedTopBorders[P];g=T.border,"None"!==g.lineStyle&&g.lineWidth<r.j.getCellTopBorder(s).lineWidth&&(g.lineWidth=r.j.getCellTopBorder(s).lineWidth),i.i(n.isNullOrUndefined)(g)||(f=a.a.convertPointToPixel(g.getLineWidth()),this.renderSingleBorder(g.color,F,k+f/2,F+T.width,k+f/2,f,g.lineStyle),F+=T.width)}else{g=r.j.getCellTopBorder(s),f=a.a.convertPointToPixel(g.getLineWidth());this.renderSingleBorder(g.color,t.x-t.margin.left-m/2,t.y-t.margin.top+f/2,t.x+t.width+t.margin.right+0,t.y-t.margin.top+f/2,f,g.lineStyle)}var S=!1;S=u?0===s.columnIndex:s.cellIndex===s.ownerRow.childWidgets.length-1;for(var W=s.containerWidget.getPreviousRowSpannedCells(),N=!1,H=0;H<W.length;H++){var E=W[H];if(s.rowIndex<E.rowIndex+E.cellFormat.rowSpan&&s.columnIndex<E.columnIndex){N=!0;break}}!(s.ownerTable.tableFormat.cellSpacing>0||S)||!u&&s.columnIndex+s.cellFormat.columnSpan!==s.ownerTable.tableHolder.columns.length&&N||(g=u?r.j.getCellLeftBorder(s):r.j.getCellRightBorder(s),f=a.a.convertPointToPixel(g.getLineWidth()),this.renderSingleBorder(g.color,t.x+t.width+t.margin.right-f/2,t.y-t.margin.top,t.x+t.width+t.margin.right-f/2,t.y+t.height+d,f,g.lineStyle));var O=s.ownerRow.nextWidget,_=!1,B=void 0;if(!i.i(n.isNullOrUndefined)(O)){if(O.lastChild){var L=O.lastChild;B=L.columnIndex+L.cellFormat.columnSpan}var R=void 0;R=O,R instanceof r.z&&t.containerWidget instanceof r.z&&t.containerWidget.containerWidget instanceof r.u&&(_=-1!==t.containerWidget.containerWidget.childWidgets.indexOf(R))}if(s.ownerTable.tableFormat.cellSpacing>0||s.ownerRow.rowIndex===s.ownerTable.childWidgets.length-1||s.cellFormat.rowSpan>1&&s.ownerRow.rowIndex+s.cellFormat.rowSpan>=s.ownerTable.childWidgets.length||!_||B&&O.childWidgets.length<s.ownerRow.childWidgets.length&&B<s.columnIndex+s.cellFormat.columnSpan){var A=s.cellFormat.borders.bottom;g=(i.i(n.isNullOrUndefined)(A)||"Cleared"!==A.lineStyle)&&s.cellFormat.rowSpan>1&&s.ownerRow.rowIndex+s.cellFormat.rowSpan===s.ownerTable.childWidgets.length?s.getBorderBasedOnPriority(s.getBorderBasedOnPriority(s.cellFormat.borders.bottom,s.ownerRow.rowFormat.borders.bottom),s.ownerTable.tableFormat.borders.bottom):r.j.getCellBottomBorder(s),f=a.a.convertPointToPixel(g.getLineWidth()),this.renderSingleBorder(g.color,t.x-t.margin.left-m/2,t.y+t.height+d+f/2,t.x+t.width+t.margin.right,t.y+t.height+d+f/2,f,g.lineStyle)}g=o.getCellDiagonalUpBorder(s),f=a.a.convertPointToPixel(g.getLineWidth()),f>0&&this.renderSingleBorder(g.color,t.x-h,t.y+t.height+d,t.x+t.width+c,t.y-l,f,g.lineStyle),g=o.getCellDiagonalDownBorder(s),(f=a.a.convertPointToPixel(g.getLineWidth()))>0&&this.renderSingleBorder(g.color,t.x-h,t.y-l,t.x+t.width+c,t.y+t.height+d,f,g.lineStyle)},e.prototype.renderCellBackground=function(e,t,i,n,r){var o=t.cellFormat,s="#ffffff"===o.shading.backgroundColor?t.ownerTable.tableFormat.shading.backgroundColor:o.shading.backgroundColor,l=t.x-i-r,d=t.margin.top-t.containerWidget.topBorderWidth,h=t.y-d,c=t.width+i+n+r/2;if(t.ownerRow.rowFormat.revisions.length>0){s="Insertion"===t.ownerRow.rowFormat.revisions[t.ownerRow.rowFormat.revisions.length-1].revisionType?"#e1f2fa":"#fce6f4"}this.pageContext.beginPath(),"empty"!==s&&(this.pageContext.fillStyle=a.a.getColor(s),this.pageContext.fillRect(this.getScaledValue(l,1),this.getScaledValue(h,2),this.getScaledValue(c),this.getScaledValue(e)),this.pageContext.closePath()),o.shading.hasValue("foregroundColor")&&"TextureNone"!==o.shading.textureStyle&&(this.pageContext.beginPath(),this.pageContext.fillStyle=this.drawTextureStyle(o.shading.textureStyle,a.a.getColor(o.shading.foregroundColor),a.a.getColor(o.shading.backgroundColor),"empty"===o.shading.foregroundColor,"empty"===o.shading.backgroundColor),this.pageContext.fillRect(this.getScaledValue(l,1),this.getScaledValue(h,2),this.getScaledValue(c),this.getScaledValue(e)),this.pageContext.closePath())},e.prototype.drawTextureStyle=function(e,t,i,n,r){if(r&&(i="#ffffff"),n&&(t="#000000"),e.indexOf("Percent")>-1){var o=e.replace("Texture","").replace("Percent","").replace("Pt","."),s=parseInt(o);return this.getForeColor(t,i,s,n,r)}return"TextureSolid"===e?t:"#FFFFFF"},e.prototype.getForeColor=function(e,t,i,n,r){var o=0,s=0,l=0,d=a.a.convertHexToRgb(e),h=a.a.convertHexToRgb(t);return o=this.getColorValue(d.r,h.r,i,n,r),s=this.getColorValue(d.g,h.g,i,n,r),l=this.getColorValue(d.b,h.b,i,n,r),"#"+a.a.convertRgbToHex(o)+a.a.convertRgbToHex(s)+a.a.convertRgbToHex(l)},e.prototype.getColorValue=function(e,t,i,n,r){return 100==i?e:n?r?Math.round(255*(1-i/100)):Math.round(t*(1-i/100)):r?Math.round(e*(i/100)):t+Math.round(e*(i/100))-Math.round(t*(i/100))},e.prototype.renderSingleBorder=function(e,t,i,n,r,o,s){this.pageContext.beginPath(),this.pageContext.moveTo(this.getScaledValue(t,1),this.getScaledValue(i,2)),this.pageContext.lineTo(this.getScaledValue(n,1),this.getScaledValue(r,2)),this.pageContext.lineWidth=this.getScaledValue(o),this.pageContext.strokeStyle=a.a.getColor(e),"None"!==s&&"Cleared"!==s&&this.pageContext.stroke(),this.pageContext.closePath()},e.prototype.getScaledValue=function(e,t){return this.isPrinting?e:(i.i(n.isNullOrUndefined)(t)&&(t=0),e*this.documentHelper.zoomFactor+(1===t?this.pageLeft:2===t?this.pageTop:0))},e.prototype.checkRevisionType=function(e){for(var t=[],i=e.revisions.length,n=0;n<i;n++){var r=e.revisions[n],o=this.documentHelper.authors.get(r.author);t.push({type:r.revisionType,color:o})}return t},e.prototype.getRevisionColor=function(e){if(1===e.length)return e[0].color;for(var t=0;t<e.length;t++)if("Deletion"===e[t].type||"MoveFrom"===e[t].type)return e[t].color;return e.length>0?e[0].color:void 0},e.prototype.getRevisionType=function(e,t){if(0!==e.length)for(var i=0;i<e.length;i++){var n=void 0;if(t&&("Insertion"===e[i].type||"MoveTo"===e[i].type))return n=e[i],this.pageContext.fillStyle=a.a.getColor(n.color),e.splice(i,1),n;if(!t&&("Deletion"===e[i].type||"MoveFrom"===e[i].type))return n=e[i],this.pageContext.fillStyle=a.a.getColor(n.color),e.splice(i,1),n}},e.prototype.getFormfieldInLine=function(e){for(var t=0;t<e.children.length;t++)if(e.children[t]instanceof r.b&&!i.i(n.isNullOrUndefined)(e.children[t].formFieldData))return e.children[t]},e.prototype.destroy=function(){this.documentHelper=void 0,i.i(n.isNullOrUndefined)(this.pageCanvasIn)||(this.pageCanvasIn.innerHTML=""),this.pageCanvasIn=void 0},e}()},function(e,t,i){"use strict";i.d(t,"a",function(){return r});var n=i(0),r=(i.n(n),function(){function e(e){var t=this;this.onMouseWheelInternal=function(e){if(!0===e.ctrlKey){e.preventDefault();if(e.pageX-t.documentHelper.viewerContainer.offsetLeft<t.documentHelper.pageContainer.offsetWidth){var i=void 0;void 0!==navigator&&(i=navigator.userAgent.match("Firefox"));var r=i?e.detail<0:n.Browser.isIE?e.wheelDelta>0:e.deltaY<0,o=t.documentHelper.zoomFactor;r?o<=4.9?o+=.1:o=5:o>=.2?o-=.1:o=.1,t.documentHelper.zoomFactor=o}}},this.documentHelper=e}return e.prototype.setZoomFactor=function(){this.onZoomFactorChanged(),i.i(n.isNullOrUndefined)(this.documentHelper.selection)||this.documentHelper.selection.updateCaretPosition(),this.documentHelper.updateTouchMarkPosition(),i.i(n.isNullOrUndefined)(this.documentHelper.owner.imageResizerModule)||this.documentHelper.owner.imageResizerModule.updateImageResizerPosition(),this.documentHelper.owner.fireZoomFactorChange()},Object.defineProperty(e.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.onZoomFactorChanged=function(){this.documentHelper.zoomFactor>5?this.documentHelper.zoomFactor=5:this.documentHelper.zoomFactor<.1&&(this.documentHelper.zoomFactor=.1),this.zoom()},e.prototype.zoom=function(){var e=this.viewer;this.documentHelper.clearContent(),e.handleZoom(),this.documentHelper.updateFocus()},e.prototype.destroy=function(){this.documentHelper=void 0},e}())},function(e,t,i){"use strict";i.d(t,"a",function(){return s});var n=i(0),r=(i.n(n),i(4)),o=i(1),s=function(){function e(){this.document=void 0,this.prevListLevel=void 0,this.isOrdered=void 0,this.keywordIndex=void 0,this.fieldCheck=0}return e.prototype.writeHtml=function(e,t){this.keywordIndex=t?1:0,this.document=e;var i="";e.hasOwnProperty(o._377[this.keywordIndex])&&this.serializeImages(e[o._377[this.keywordIndex]]);for(var n=0;n<e[o._2[this.keywordIndex]].length;n++)i+=this.serializeSection(e[o._2[this.keywordIndex]][n]);return i},e.prototype.serializeImages=function(e){this.images=new o.o;for(var t in e)if(Array.isArray(e[""+t]))this.images.add(parseInt(t),e[""+t]);else{var i=[];i.push(e[""+t]),this.images.add(parseInt(t),i)}},e.prototype.serializeSection=function(e){for(var t="",i=0;i<e[o._314[this.keywordIndex]].length;i++){var n=e[o._314[this.keywordIndex]][i];n.hasOwnProperty(o._267[this.keywordIndex])?t+=this.serializeParagraph(n):n.hasOwnProperty(o._314[this.keywordIndex])?t+=this.serializeSection(n):(t+=this.closeList(),t+=this.serializeTable(n))}return t+=this.closeList(),this.prevListLevel=void 0,this.isOrdered=void 0,t},e.prototype.serializeParagraph=function(e){var t="",r=!1,s=!1;i.i(n.isNullOrUndefined)(this.prevListLevel)||(s=!0);var a=[],l=void 0;return i.i(n.isNullOrUndefined)(e[o._5[this.keywordIndex]][o._79[this.keywordIndex]])||(l=this.getListLevel(e),s||(this.prevListLevel=l),this.prevListLevel!==l&&(s=!1),this.prevListLevel=l),s||(t+=this.closeList()),i.i(n.isNullOrUndefined)(l)||(r=!0),r&&!s&&(t+=this.getHtmlList(l,e[o._5[this.keywordIndex]][o._79[this.keywordIndex]][o._68[this.keywordIndex]])),a.push('style="'+this.serializeParagraphStyle(e,"",r)+';white-space:pre"'),r?t+=this.createAttributesTag("li",a):(this.prevListLevel=void 0,this.isOrdered=void 0,t+=this.createAttributesTag(this.getStyleName(e[o._5[this.keywordIndex]][o._51[this.keywordIndex]]),a)),0===e[o._267[this.keywordIndex]].length?t+="&nbsp":t=this.serializeInlines(e,t),r?(t+=this.endTag("li"),t.indexOf("<ul")>-1?this.isOrdered=!1:t.indexOf("<ol")>-1&&(this.isOrdered=!0)):t+=this.endTag(this.getStyleName(e[o._5[this.keywordIndex]][o._51[this.keywordIndex]])),e[o._23[this.keywordIndex]]&&(t+='<p class="iscreatedusinghtmlspantag"><span>iscreatedusinghtmlspantag</span></p>'),t},e.prototype.closeList=function(){var e="";return i.i(n.isNullOrUndefined)(this.isOrdered)||(e=this.isOrdered?this.endTag("ol"):this.endTag("ul"),this.isOrdered=void 0),e},e.prototype.getListLevel=function(e){for(var t=void 0,i=void 0,n=0;n<this.document[o._6[this.keywordIndex]].length;n++)if(this.document[o._6[this.keywordIndex]][n][o._65[this.keywordIndex]]===e[o._5[this.keywordIndex]][o._79[this.keywordIndex]][o._65[this.keywordIndex]]){i=this.document[o._6[this.keywordIndex]][n];break}if(i)for(var r=0;r<this.document[o._7[this.keywordIndex]].length;r++)if(this.document[o._7[this.keywordIndex]][r][o._329[this.keywordIndex]]===i[o._329[this.keywordIndex]]){var s=e[o._5[this.keywordIndex]][o._79[this.keywordIndex]][o._68[this.keywordIndex]];t=this.document[o._7[this.keywordIndex]][r][o._331[this.keywordIndex]][s];break}return t},e.prototype.getHtmlList=function(e,t){var i="";if(e[o._323[this.keywordIndex]]===(1==this.keywordIndex?10:"Bullet")){switch(i+='<ul type="',t){case 0:i+="disc",e[o._4[this.keywordIndex]][o._50[this.keywordIndex]]="Symbol";break;case 1:i+="circle",e[o._4[this.keywordIndex]][o._50[this.keywordIndex]]="Symbol";break;case 2:i+="square",e[o._4[this.keywordIndex]][o._50[this.keywordIndex]]="Wingdings";break;default:i+="disc",e[o._4[this.keywordIndex]][o._50[this.keywordIndex]]="Symbol"}i+='">'}else{switch(i+='<ol type="',e[o._323[this.keywordIndex]]){case"UpRoman":case 2:i+="I";break;case"LowRoman":case 3:i+="i";break;case"UpLetter":case 4:i+="A";break;case"LowLetter":case 5:i+="a";break;default:i+="1"}i+='" start="'+e[o._325[this.keywordIndex]].toString()+'">'}return i},e.prototype.serializeInlines=function(e,t){for(var r=void 0,s=0;e[o._267[this.keywordIndex]].length>s;)if(r=e[o._267[this.keywordIndex]][s],r.hasOwnProperty(o._267[this.keywordIndex]))t+=this.serializeContentInlines(r,t),s++;else{if(r.hasOwnProperty(o._224[this.keywordIndex]))t+=this.serializeImageContainer(r);else if(r.hasOwnProperty(o._237[this.keywordIndex]))if(0===r[o._237[this.keywordIndex]]){var a=e[o._267[this.keywordIndex]][s+1];if(i.i(n.isNullOrUndefined)(a[o._198[this.keywordIndex]])&&(a=e[o._267[this.keywordIndex]][s+2]),i.i(n.isNullOrUndefined)(a)||i.i(n.isNullOrUndefined)(a[o._198[this.keywordIndex]])||!(a[o._198[this.keywordIndex]].indexOf("TOC")>=0||a[o._198[this.keywordIndex]].indexOf("HYPERLINK")>=0))this.fieldCheck=void 0;else{this.fieldCheck=1;var l=[];l.push('style="'+this.serializeInlineStyle(r[o._4[this.keywordIndex]])+'"'),t+=this.createAttributesTag("a",l)}}else 2===r[o._237[this.keywordIndex]]?i.i(n.isNullOrUndefined)(this.fieldCheck)?this.fieldCheck=0:this.fieldCheck=2:(i.i(n.isNullOrUndefined)(this.fieldCheck)||0===this.fieldCheck||(t+=this.endTag("a")),this.fieldCheck=0);else{var d=i.i(n.isNullOrUndefined)(r[o._198[this.keywordIndex]])?"":r[o._198[this.keywordIndex]];if(r.hasOwnProperty(o._337[this.keywordIndex]))switch(r[o._337[this.keywordIndex]]){case 0:t+="<a name="+r[o._35[this.keywordIndex]]+">";break;case 1:t+="</a>"}if(0===this.fieldCheck&&(t+=this.serializeSpan(d,r[o._4[this.keywordIndex]])),1===this.fieldCheck){var h=d.replace(/"/g,"");t+=' href= "'+h.replace("HYPERLINK","").trim(),t+='"',t+=">"}2===this.fieldCheck&&(t+=this.serializeSpan(d,r[o._4[this.keywordIndex]]))}s++}return t},e.prototype.serializeContentInlines=function(e,t){return t+=this.serializeInlines(e,t)},e.prototype.serializeSpan=function(e,t){var i="";if(-1!==e.indexOf("\v"))return i+="<br>",i.toString();if(-1!==e.indexOf("\f"))return i+='<br style = "page-break-after:always;"/>',i.toString();var n=[];return this.serializeInlineStyle(t),n.push('style="'+this.serializeInlineStyle(t)+'"'),i+=this.createAttributesTag("span",n),i+=this.decodeHtmlNames(e.toString()),i+=this.endTag("span"),i.toString()},e.prototype.getStyleName=function(e){switch(e){case"Heading 1":return"h1";case"Heading 2":return"h2";case"Heading 3":return"h3";case"Heading 4":return"h4";case"Heading 5":return"h5";default:return"p"}},e.prototype.serializeImageContainer=function(e){var t="",s=[];this.serializeInlineStyle(e[o._4[this.keywordIndex]]);var a="";if(!i.i(n.isNullOrUndefined)(e[o._224[this.keywordIndex]])){a=this.images.get(parseInt(e[o._224[this.keywordIndex]]))[r.a.parseBoolValue(e[o._228[this.keywordIndex]])?1:0]}var l=r.a.convertPointToPixel(e[o._204[this.keywordIndex]]),d=r.a.convertPointToPixel(e[o._205[this.keywordIndex]]);return s.push('width="'+l.toString()+'"'),s.push('height="'+d.toString()+'"'),s.push('src="'+a+'"'),t+=this.createAttributesTag("img",s),t+=this.endTag("img"),t.toString()},e.prototype.serializeCell=function(e,t){var s="",a=[],l="";if(a=[],!i.i(n.isNullOrUndefined)(e[o._295[this.keywordIndex]])){if(i.i(n.isNullOrUndefined)(e[o._295[this.keywordIndex]][o._128[this.keywordIndex]][o._134[this.keywordIndex]])||"empty"===e[o._295[this.keywordIndex]][o._128[this.keywordIndex]][o._134[this.keywordIndex]]||a.push('bgcolor="'+r.a.getColor(e[o._295[this.keywordIndex]][o._128[this.keywordIndex]][o._134[this.keywordIndex]])+'"'),!i.i(n.isNullOrUndefined)(e[o._295[this.keywordIndex]][o._112[this.keywordIndex]])&&e[o._295[this.keywordIndex]][o._112[this.keywordIndex]]>1&&a.push('colspan="'+e[o._295[this.keywordIndex]][o._112[this.keywordIndex]].toString()+'"'),!i.i(n.isNullOrUndefined)(e[o._295[this.keywordIndex]][o._113[this.keywordIndex]])&&e[o._295[this.keywordIndex]][o._113[this.keywordIndex]]>1&&a.push('rowspan="'+e[o._295[this.keywordIndex]][o._113[this.keywordIndex]].toString()+'"'),!i.i(n.isNullOrUndefined)(e[o._295[this.keywordIndex]][o._111[this.keywordIndex]])&&0!==e[o._295[this.keywordIndex]][o._111[this.keywordIndex]]){var d=r.a.convertPointToPixel(e[o._295[this.keywordIndex]][o._111[this.keywordIndex]]);a.push('width="'+d.toString()+'"')}var h=i.i(n.isNullOrUndefined)(e[o._295[this.keywordIndex]][o._114[this.keywordIndex]])?"top":this.convertVerticalAlignment(e[o._295[this.keywordIndex]][o._114[this.keywordIndex]]);a.push('valign="'+h+'"'),i.i(n.isNullOrUndefined)(e[o._295[this.keywordIndex]][o._93[this.keywordIndex]])||0===e[o._295[this.keywordIndex]][o._93[this.keywordIndex]]||(l+="padding-left:"+e[o._295[this.keywordIndex]][o._93[this.keywordIndex]].toString()+"pt;"),i.i(n.isNullOrUndefined)(e[o._295[this.keywordIndex]][o._94[this.keywordIndex]])||0===e[o._295[this.keywordIndex]][o._94[this.keywordIndex]]||(l+="padding-right:"+e[o._295[this.keywordIndex]][o._94[this.keywordIndex]].toString()+"pt;"),i.i(n.isNullOrUndefined)(e[o._295[this.keywordIndex]][o._95[this.keywordIndex]])||0===e[o._295[this.keywordIndex]][o._95[this.keywordIndex]]||(l+="padding-top:"+e[o._295[this.keywordIndex]][o._95[this.keywordIndex]].toString()+"pt;"),i.i(n.isNullOrUndefined)(e[o._295[this.keywordIndex]][o._96[this.keywordIndex]])||0===e[o._295[this.keywordIndex]][o._96[this.keywordIndex]]||(l+="padding-bottom:"+e[o._295[this.keywordIndex]][o._96[this.keywordIndex]].toString()+"pt;"),i.i(n.isNullOrUndefined)(e[o._295[this.keywordIndex]][o._85[this.keywordIndex]])||(l+=this.serializeCellBordersStyle(e[o._295[this.keywordIndex]][o._85[this.keywordIndex]],t))}0!==l.length&&a.push('style="'+l+'"'),s+=this.createAttributesTag("td",a);for(var c=0;c<e[o._314[this.keywordIndex]].length;c++){var p=e[o._314[this.keywordIndex]][c];p.hasOwnProperty(o._298[this.keywordIndex])?s+=this.serializeTable(p):s+=this.serializeParagraph(p)}return s+=this.endTag("td")},e.prototype.convertVerticalAlignment=function(e){switch(e){case"Center":case 1:return"middle";case"Bottom":case 2:return"bottom";default:return"top"}},e.prototype.serializeTable=function(e){var t="";t+=this.createTableStartTag(e);for(var i=0;i<e[o._298[this.keywordIndex]].length;i++)t+=this.serializeRow(e[o._298[this.keywordIndex]][i]);return t+=this.createTableEndTag()},e.prototype.serializeRow=function(e){var t="";t+=this.createRowStartTag(e);for(var i=0;i<e[o._297[this.keywordIndex]].length;i++)t+=this.serializeCell(e[o._297[this.keywordIndex]][i],e);return t},e.prototype.serializeParagraphStyle=function(e,t,r,s){var a="";i.i(n.isNullOrUndefined)(this.keywordIndex)&&(this.keywordIndex=s),e[o._267[this.keywordIndex]].length>0&&(a+=this.serializeCharacterFormat(e[o._4[this.keywordIndex]]));var l=!1;return 0==e[o._267[this.keywordIndex]].length&&(l=!0),a+=this.serializeCharacterFormat(e[o._4[this.keywordIndex]],l),a+=this.serializeParagraphFormat(e[o._5[this.keywordIndex]],r)},e.prototype.serializeInlineStyle=function(e){return this.serializeCharacterFormat(e)},e.prototype.serializeTableBorderStyle=function(e){var t="",s={};return s=e[o._232[this.keywordIndex]],i.i(n.isNullOrUndefined)(s)||s[o._142[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||s[o._142[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")?!i.i(n.isNullOrUndefined)(s)&&r.a.parseBoolValue(s[o._137[this.keywordIndex]])&&(t+="border-left-style:none;"):(s[o._221[this.keywordIndex]]=i.i(n.isNullOrUndefined)(s[o._221[this.keywordIndex]])?"#000000":s[o._221[this.keywordIndex]],s[o._143[this.keywordIndex]]=i.i(n.isNullOrUndefined)(s[o._143[this.keywordIndex]])?.5:s[o._143[this.keywordIndex]],t+=this.serializeBorderStyle(s,"left")),s=e[o._229[this.keywordIndex]],i.i(n.isNullOrUndefined)(s)||s[o._142[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||s[o._142[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")?!i.i(n.isNullOrUndefined)(s)&&r.a.parseBoolValue(s[o._137[this.keywordIndex]])&&(t+="border-top-style:none;"):(s[o._221[this.keywordIndex]]=i.i(n.isNullOrUndefined)(s[o._221[this.keywordIndex]])?"#000000":s[o._221[this.keywordIndex]],s[o._143[this.keywordIndex]]=i.i(n.isNullOrUndefined)(s[o._143[this.keywordIndex]])?.5:s[o._143[this.keywordIndex]],t+=this.serializeBorderStyle(s,"top")),s=e[o._231[this.keywordIndex]],i.i(n.isNullOrUndefined)(s)||s[o._142[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||s[o._142[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")?!i.i(n.isNullOrUndefined)(s)&&r.a.parseBoolValue(s[o._137[this.keywordIndex]])&&(t+="border-right-style:none;"):(s[o._221[this.keywordIndex]]=i.i(n.isNullOrUndefined)(s[o._221[this.keywordIndex]])?"#000000":s[o._221[this.keywordIndex]],s[o._143[this.keywordIndex]]=i.i(n.isNullOrUndefined)(s[o._143[this.keywordIndex]])?.5:s[o._143[this.keywordIndex]],t+=this.serializeBorderStyle(s,"right")),s=e[o._230[this.keywordIndex]],i.i(n.isNullOrUndefined)(s)||s[o._142[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||s[o._142[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")?!i.i(n.isNullOrUndefined)(s)&&r.a.parseBoolValue(s[o._137[this.keywordIndex]])&&(t+="border-bottom-style:none;"):(s[o._221[this.keywordIndex]]=i.i(n.isNullOrUndefined)(s[o._221[this.keywordIndex]])?"#000000":s[o._221[this.keywordIndex]],s[o._143[this.keywordIndex]]=i.i(n.isNullOrUndefined)(s[o._143[this.keywordIndex]])?.5:s[o._143[this.keywordIndex]],t+=this.serializeBorderStyle(s,"bottom")),t},e.prototype.serializeCellBordersStyle=function(e,t){var s="",a={};return a=e[o._232[this.keywordIndex]],i.i(n.isNullOrUndefined)(a)||a[o._142[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||a[o._142[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")?!i.i(n.isNullOrUndefined)(a)&&r.a.parseBoolValue(a[o._137[this.keywordIndex]])?s+="border-left-style:none;":i.i(n.isNullOrUndefined)(t[o._296[this.keywordIndex]][o._85[this.keywordIndex]][o._232[this.keywordIndex]])||(a=t[o._296[this.keywordIndex]][o._85[this.keywordIndex]][o._232[this.keywordIndex]],i.i(n.isNullOrUndefined)(a)||a[o._142[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||a[o._142[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")||(a[o._221[this.keywordIndex]]=i.i(n.isNullOrUndefined)(a[o._221[this.keywordIndex]])?"#000000":a[o._221[this.keywordIndex]],a[o._143[this.keywordIndex]]=i.i(n.isNullOrUndefined)(a[o._143[this.keywordIndex]])?.5:a[o._143[this.keywordIndex]],s+=this.serializeBorderStyle(a,"left"))):(a[o._221[this.keywordIndex]]=i.i(n.isNullOrUndefined)(a[o._221[this.keywordIndex]])?"#000000":a[o._221[this.keywordIndex]],a[o._143[this.keywordIndex]]=i.i(n.isNullOrUndefined)(a[o._143[this.keywordIndex]])?.5:a[o._143[this.keywordIndex]],s+=this.serializeBorderStyle(a,"left")),a=e[o._229[this.keywordIndex]],i.i(n.isNullOrUndefined)(a)||a[o._142[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||a[o._142[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")?!i.i(n.isNullOrUndefined)(a)&&r.a.parseBoolValue(a[o._137[this.keywordIndex]])?s+="border-top-style:none;":i.i(n.isNullOrUndefined)(t[o._296[this.keywordIndex]][o._85[this.keywordIndex]][o._229[this.keywordIndex]])||(a=t[o._296[this.keywordIndex]][o._85[this.keywordIndex]][o._229[this.keywordIndex]],i.i(n.isNullOrUndefined)(a)||a[o._142[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||a[o._142[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")||(a[o._221[this.keywordIndex]]=i.i(n.isNullOrUndefined)(a[o._221[this.keywordIndex]])?"#000000":a[o._221[this.keywordIndex]],a[o._143[this.keywordIndex]]=i.i(n.isNullOrUndefined)(a[o._143[this.keywordIndex]])?.5:a[o._143[this.keywordIndex]],s+=this.serializeBorderStyle(a,"top"))):(a[o._221[this.keywordIndex]]=i.i(n.isNullOrUndefined)(a[o._221[this.keywordIndex]])?"#000000":a[o._221[this.keywordIndex]],a[o._143[this.keywordIndex]]=i.i(n.isNullOrUndefined)(a[o._143[this.keywordIndex]])?.5:a[o._143[this.keywordIndex]],s+=this.serializeBorderStyle(a,"top")),a=e[o._231[this.keywordIndex]],i.i(n.isNullOrUndefined)(a)||a[o._142[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||a[o._142[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")?!i.i(n.isNullOrUndefined)(a)&&r.a.parseBoolValue(a[o._137[this.keywordIndex]])?s+="border-right-style:none;":i.i(n.isNullOrUndefined)(t[o._296[this.keywordIndex]][o._85[this.keywordIndex]][o._231[this.keywordIndex]])||(a=t[o._296[this.keywordIndex]][o._85[this.keywordIndex]][o._231[this.keywordIndex]],i.i(n.isNullOrUndefined)(a)||a[o._142[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||a[o._142[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")||(a[o._221[this.keywordIndex]]=i.i(n.isNullOrUndefined)(a[o._221[this.keywordIndex]])?"#000000":a[o._221[this.keywordIndex]],a[o._143[this.keywordIndex]]=i.i(n.isNullOrUndefined)(a[o._143[this.keywordIndex]])?.5:a[o._143[this.keywordIndex]],s+=this.serializeBorderStyle(a,"right"))):(a[o._221[this.keywordIndex]]=i.i(n.isNullOrUndefined)(a[o._221[this.keywordIndex]])?"#000000":a[o._221[this.keywordIndex]],a[o._143[this.keywordIndex]]=i.i(n.isNullOrUndefined)(a[o._143[this.keywordIndex]])?.5:a[o._143[this.keywordIndex]],s+=this.serializeBorderStyle(a,"right")),a=e[o._230[this.keywordIndex]],i.i(n.isNullOrUndefined)(a)||a[o._142[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||a[o._142[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")?!i.i(n.isNullOrUndefined)(a)&&r.a.parseBoolValue(a[o._137[this.keywordIndex]])?s+="border-bottom-style:none;":i.i(n.isNullOrUndefined)(t[o._296[this.keywordIndex]][o._85[this.keywordIndex]][o._230[this.keywordIndex]])||(a=t[o._296[this.keywordIndex]][o._85[this.keywordIndex]][o._230[this.keywordIndex]],i.i(n.isNullOrUndefined)(a)||a[o._142[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||a[o._142[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")||(a[o._221[this.keywordIndex]]=i.i(n.isNullOrUndefined)(a[o._221[this.keywordIndex]])?"#000000":a[o._221[this.keywordIndex]],a[o._143[this.keywordIndex]]=i.i(n.isNullOrUndefined)(a[o._143[this.keywordIndex]])?.5:a[o._143[this.keywordIndex]],s+=this.serializeBorderStyle(a,"bottom"))):(a[o._221[this.keywordIndex]]=i.i(n.isNullOrUndefined)(a[o._221[this.keywordIndex]])?"#000000":a[o._221[this.keywordIndex]],a[o._143[this.keywordIndex]]=i.i(n.isNullOrUndefined)(a[o._143[this.keywordIndex]])?.5:a[o._143[this.keywordIndex]],s+=this.serializeBorderStyle(a,"bottom")),s},e.prototype.serializeBorderStyle=function(e,t){var s="";return s+="border-"+t+"-style:"+this.convertBorderLineStyle(e[o._142[this.keywordIndex]]),s+=";",e[o._143[this.keywordIndex]]>0&&(s+="border-"+t+"-width:"+e[o._143[this.keywordIndex]].toString()+"pt;"),i.i(n.isNullOrUndefined)(e[o._221[this.keywordIndex]])||(s+="border-"+t+"-color:"+r.a.getColor(e[o._221[this.keywordIndex]])+";"),s},e.prototype.convertBorderLineStyle=function(e){switch(e){case"Single":case 0:return"solid";case"None":case 1:return"none";case"Dot":case 2:return"dotted";case"DashSmallGap":case"DashLargeGap":case"DashDot":case"DashDotDot":case 3:case 4:case 5:case 6:return"dashed";case"Double":case"Triple":case"ThinThickSmallGap":case"ThickThinSmallGap":case"ThinThickThinSmallGap":case"ThinThickMediumGap":case"ThickThinMediumGap":case"ThinThickThinMediumGap":case"ThinThickLargeGap":case"ThickThinLargeGap":case"ThinThickThinLargeGap":case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:return"double";case"SingleWavy":case 18:return"solid";case"DoubleWavy":case 19:return"double";case"DashDotStroked":case 20:return"solid";case"Emboss3D":case 21:return"ridge";case"Engrave3D":case 22:return"groove";case"Outset":case 23:return"outset";case"Inset":case 24:return"inset";default:return"solid"}},e.prototype.serializeCharacterFormat=function(e,t){if(!i.i(n.isNullOrUndefined)(e[o._373[this.keywordIndex]]))return this.serializeCharacterFormat(e[o._373[this.keywordIndex]],t);var s,a="";return a+="font-weight",a+=":",a+=r.a.parseBoolValue(e[o._42[this.keywordIndex]])?"bold":"normal",a+=";",a+="font-style",a+=":",r.a.parseBoolValue(e[o._43[this.keywordIndex]])?a+="italic":a+="normal",a+=";",a+=this.serializeTextDecoration(e),e[o._45[this.keywordIndex]]!==(1==this.keywordIndex?1:"Superscript")&&e[o._45[this.keywordIndex]]!==(1==this.keywordIndex?2:"Subscript")||(a+="vertical-align",a+=":",a+=e[o._45[this.keywordIndex]]===(1==this.keywordIndex?1:"Superscript")?"super":"sub",a+=";"),i.i(n.isNullOrUndefined)(e[o._47[this.keywordIndex]])||e[o._47[this.keywordIndex]]===(1==this.keywordIndex?0:"NoColor")||t||(a+="background-color",a+=":",a+=1==this.keywordIndex?this.getHighlightColorCode(e[o._47[this.keywordIndex]]):r.a.getHighlightColorCode(e.highlightColor.toString()),a+=";"),s=e[o._49[this.keywordIndex]],i.i(n.isNullOrUndefined)(s)||(a+="color",a+=":",a+=r.a.getColor(s),a+=";"),!i.i(n.isNullOrUndefined)(e[o._59[this.keywordIndex]])&&r.a.parseBoolValue(e[o._59[this.keywordIndex]])&&(a+="text-transform",a+=":",a+="uppercase",a+=";"),s=e[o._48[this.keywordIndex]],i.i(n.isNullOrUndefined)(s)||(a+="font-size",a+=":",a+=s.toString(),a+="pt",a+=";"),s=e[o._50[this.keywordIndex]],i.i(n.isNullOrUndefined)(s)||(a+="font-family",a+=":",a+=s.toString(),a+=";"),s=e[o._66[this.keywordIndex]],i.i(n.isNullOrUndefined)(s)||(a+="letter-spacing",a+=":",a+=s.toString(),a+="pt",a+=";"),s=e[o._67[this.keywordIndex]],i.i(n.isNullOrUndefined)(s)||(a+="transform:scaleX(",a+=(s/100).toString(),a+=")",a+=";"),a.toString()},e.prototype.serializeTextDecoration=function(e){var t="";return e[o._46[this.keywordIndex]]!==(1==this.keywordIndex?1:"SingleStrike")&&e[o._46[this.keywordIndex]]!==(1==this.keywordIndex?2:"DoubleStrike")||(t+="line-through "),i.i(n.isNullOrUndefined)(e[o._44[this.keywordIndex]])||e[o._44[this.keywordIndex]]===(1==this.keywordIndex?0:"None")||(t+="underline"),t.length>1&&(t="text-decoration:"+t+";"),t},e.prototype.serializeParagraphFormat=function(e,t,r){if(i.i(n.isNullOrUndefined)(this.keywordIndex)&&(this.keywordIndex=r),!i.i(n.isNullOrUndefined)(e[o._373[this.keywordIndex]]))return this.serializeParagraphFormat(e[o._373[this.keywordIndex]],t);var s,a="";return s=this.getTextAlignment(e[o._72[this.keywordIndex]]),i.i(n.isNullOrUndefined)(s)||(a+="text-align:"+s.toLowerCase()+";"),s=e[o._74[this.keywordIndex]],i.i(n.isNullOrUndefined)(s)||(a+="margin-top:"+s.toString()+"pt; "),s=e[o._70[this.keywordIndex]],i.i(n.isNullOrUndefined)(s)||(a+="margin-right:"+s.toString()+"pt; "),s=e[o._73[this.keywordIndex]],i.i(n.isNullOrUndefined)(s)||(a+="margin-bottom:"+s.toString()+"pt; "),s=e[o._69[this.keywordIndex]],t&&(s=0),i.i(n.isNullOrUndefined)(s)||(a+="margin-left:"+s.toString()+"pt; "),s=e[o._71[this.keywordIndex]],t&&(s=0),i.i(n.isNullOrUndefined)(s)||0===s||(a+="text-indent:"+s.toString()+"pt;"),s=e[o._77[this.keywordIndex]],i.i(n.isNullOrUndefined)(s)||(s=e[o._78[this.keywordIndex]]===(1==this.keywordIndex?0:"Multiple")?Math.round(10*s)/10:s.toString()+"pt;",a+="line-height:"+s),a.toString()},e.prototype.createAttributesTag=function(e,t){var i="";i+="<",i+=e;for(var n=0;n<t.length;n++)i+=" ",i+=t[n];return"a"!==e&&(i+=">"),i},e.prototype.createTag=function(e){var t="";return t+="<",t+=e,t+=">"},e.prototype.endTag=function(e){var t="";return t+="<",t+="/",t+=e,t+=">"},e.prototype.createTableStartTag=function(e){var t="",s="",a=[];return i.i(n.isNullOrUndefined)(e[o._303[this.keywordIndex]])||(i.i(n.isNullOrUndefined)(e[o._303[this.keywordIndex]][o._128[this.keywordIndex]])||i.i(n.isNullOrUndefined)(e[o._303[this.keywordIndex]][o._128[this.keywordIndex]][o._134[this.keywordIndex]])||"empty"===e[o._303[this.keywordIndex]][o._128[this.keywordIndex]][o._134[this.keywordIndex]]||a.push('bgcolor="'+r.a.getColor(e[o._303[this.keywordIndex]][o._128[this.keywordIndex]][o._134[this.keywordIndex]])+'"'),!i.i(n.isNullOrUndefined)(e[o._303[this.keywordIndex]][o._127[this.keywordIndex]])&&e[o._303[this.keywordIndex]][o._127[this.keywordIndex]]>0?a.push('cellspacing="'+(72*e[o._303[this.keywordIndex]][o._127[this.keywordIndex]]/96*2).toString()+'"'):s+="border-collapse:collapse;",a.push('cellpadding="0"'),i.i(n.isNullOrUndefined)(e[o._303[this.keywordIndex]][o._69[this.keywordIndex]])||0===e[o._303[this.keywordIndex]][o._69[this.keywordIndex]]||e[o._303[this.keywordIndex]][o._129[this.keywordIndex]]!==(1==this.keywordIndex?0:"Left")||(s+="margin-left:"+e[o._303[this.keywordIndex]][o._69[this.keywordIndex]].toString()+"pt;"),i.i(n.isNullOrUndefined)(e[o._303[this.keywordIndex]])||(s+=this.serializeTableWidth(e[o._303[this.keywordIndex]])),i.i(n.isNullOrUndefined)(e[o._303[this.keywordIndex]][o._85[this.keywordIndex]])||(s+=this.serializeTableBorderStyle(e[o._303[this.keywordIndex]][o._85[this.keywordIndex]]))),0!==s.length&&a.push('style="',s.toString()+'"'),t+=this.createAttributesTag("table",a)},e.prototype.serializeTableWidth=function(e){var t="";switch(e[o._131[this.keywordIndex]]){case"Percent":case 1:t+="width: "+e[o._130[this.keywordIndex]].toString()+"%;";break;case"Point":case 2:t+="width: "+e[o._130[this.keywordIndex]].toString()+"pt;";break;case"Auto":case 0:t+="width: auto;"}return t},e.prototype.getHighlightColorCode=function(e){var t="#ffffff";switch(e){case 1:t="#ffff00";break;case 2:t="#00ff00";break;case 3:t="#00ffff";break;case 4:t="#ff00ff";break;case 5:t="#0000ff";break;case 6:t="#ff0000";break;case 7:t="#000080";break;case 8:t="#008080";break;case 9:t="#008000";break;case 10:t="#800080";break;case 11:t="#800000";break;case 12:t="#808000";break;case 13:t="#808080";break;case 14:t="#c0c0c0";break;case 15:t="#000000"}return t},e.prototype.getTextAlignment=function(e){switch(e){case 1:return"Center";case 2:return"Right";case 3:return"Justify";default:return"Left"}},e.prototype.createTableEndTag=function(){var e="";return e+=this.endTag("table")},e.prototype.createRowStartTag=function(e){var t="",s=[];if(r.a.parseBoolValue(e[o._296[this.keywordIndex]][o._116[this.keywordIndex]])&&(t+=this.createTag("thead")),!i.i(n.isNullOrUndefined)(e[o._296[this.keywordIndex]][o._205[this.keywordIndex]])&&e[o._296[this.keywordIndex]][o._205[this.keywordIndex]]>0){var a=r.a.convertPointToPixel(e[o._296[this.keywordIndex]][o._205[this.keywordIndex]]);s.push('height="'+a+'"')}return t+this.createAttributesTag("tr",s)},e.prototype.createRowEndTag=function(e){var t="";return t+=this.endTag("tr"),r.a.parseBoolValue(e[o._296[this.keywordIndex]][o._116[this.keywordIndex]])&&(t+=this.endTag("thead")),t},e.prototype.decodeHtmlNames=function(e){if("\t"===e)return"&emsp;";e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;");var t=e.split(" "),i="";if(t.length>0){i=t[0];for(var n=0;n<t.length-1;n++)i+=" "+t[n+1]}return i},e}()},function(e,t,i){"use strict";var n=i(80);i.d(t,"b",function(){return n.a});var r=i(71);i.d(t,"a",function(){return r.a})},function(e,t,i){"use strict";i.d(t,"a",function(){return f});var n=i(0),r=(i.n(n),i(46)),o=i(72),s=i(73),a=i(76),l=i(77),d=i(75),h=i(8),c=(i.n(h),i(28)),p=i(42),u=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),g=this&&this.__decorate||function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},f=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.previousContext="",n.showHeaderProperties=!0,n.defaultLocale={New:"New","Insert Footnote":"Insert Footnote","Insert Endnote":"Insert Endnote","Footnote Tooltip":"Insert Footnote (Alt+Ctrl+F).","Endnote Tooltip":"Insert Endnote (Alt+Ctrl+D).",Open:"Open",Undo:"Undo",Redo:"Redo",Image:"Image",Table:"Table",Link:"Link",Bookmark:"Bookmark","Table of Contents":"Table of Contents","HEADING - - - - 1":"HEADING - - - - 1","HEADING - - - - 2":"HEADING - - - - 2","HEADING - - - - 3":"HEADING - - - - 3",Header:"Header",Footer:"Footer","Page Setup":"Page Setup","Page Number":"Page Number",Break:"Break",Find:"Find","Local Clipboard":"Local Clipboard","Restrict Editing":"Restrict Editing","Upload from computer":"Upload from computer","By URL":"By URL",Page:"Page","Show properties pane":"Show properties pane","Hide properties pane":"Hide properties pane","Next Page":"Next Page",Continuous:"Continuous","Header And Footer":"Header & Footer",Options:"Options",Levels:"Levels","Different First Page":"Different First Page","Different header and footer for odd and even pages":"Different header and footer for odd and even pages.","Different Odd And Even Pages":"Different Odd & Even Pages","Different header and footer for first page":"Different header and footer for first page.",Position:"Position","Header from Top":"Header from Top","Footer from Bottom":"Footer from Bottom","Distance from top of the page to top of the header":"Distance from top of the page to top of the header.","Distance from bottom of the page to bottom of the footer":"Distance from bottom of the page to bottom of the footer.","Aspect ratio":"Aspect ratio",W:"W",H:"H",Width:"Width",Height:"Height",Text:"Text",Paragraph:"Paragraph",Fill:"Fill","Fill color":"Fill color","Border Style":"Border Style","Outside borders":"Outside borders","All borders":"All borders","Inside borders":"Inside borders","Left border":"Left border","Inside vertical border":"Inside vertical border","Right border":"Right border","Top border":"Top border","Inside horizontal border":"Inside horizontal border","Bottom border":"Bottom border","Border color":"Border color","Border width":"Border width",Cell:"Cell","Merge cells":"Merge cells","Insert Or Delete":"Insert / Delete","Insert columns to the left":"Insert columns to the left","Insert columns to the right":"Insert columns to the right","Insert rows above":"Insert rows above","Insert rows below":"Insert rows below","Delete rows":"Delete rows","Delete columns":"Delete columns","Cell Margin":"Cell Margin",Top:"Top",Bottom:"Bottom",Left:"Left",Right:"Right","Align Text":"Align Text","Align top":"Align top","Align bottom":"Align bottom","Align center":"Align center","Number of heading or outline levels to be shown in table of contents":"Number of heading or outline levels to be shown in table of contents.","Show page numbers":"Show page numbers","Show page numbers in table of contents":"Show page numbers in table of contents.","Right align page numbers":"Right align page numbers","Right align page numbers in table of contents":"Right align page numbers in table of contents.","Use hyperlinks":"Use hyperlinks","Use hyperlinks instead of page numbers":"Use hyperlinks instead of page numbers.",Font:"Font","Font Size":"Font Size","Font color":"Font color","Text highlight color":"Text highlight color","Clear all formatting":"Clear all formatting","Bold Tooltip":"Bold (Ctrl+B)","Italic Tooltip":"Italic (Ctrl+I)","Underline Tooltip":"Underline (Ctrl+U)",Strikethrough:"Strikethrough","Superscript Tooltip":"Superscript (Ctrl+Shift++)","Subscript Tooltip":"Subscript (Ctrl+=)","Align left Tooltip":"Align left (Ctrl+L)","Center Tooltip":"Center (Ctrl+E)","Align right Tooltip":"Align right (Ctrl+R)","Justify Tooltip":"Justify (Ctrl+J)","Decrease indent":"Decrease indent","Increase indent":"Increase indent","Line spacing":"Line spacing",Bullets:"Bullets",Numbering:"Numbering",Styles:"Styles","Manage Styles":"Manage Styles",of:"of","Fit one page":"Fit one page","Spell Check":"Spell Check",Spelling:"Spelling","Underline errors":"Underline errors","Fit page width":"Fit page width",Update:"Update",Cancel:"Cancel",Insert:"Insert","No Border":"No Border","Create a new document":"Create a new document.","Open a document":"Open a document.","Undo Tooltip":"Undo the last operation (Ctrl+Z).","Redo Tooltip":"Redo the last operation (Ctrl+Y).","Insert inline picture from a file":"Insert inline picture from a file.","Insert a table into the document":"Insert a table into the document","Create Hyperlink":"Create a link in your document for quick access to web pages and files (Ctrl+K).","Insert a bookmark in a specific place in this document":"Insert a bookmark in a specific place in this document.","Provide an overview of your document by adding a table of contents":"Provide an overview of your document by adding a table of contents.","Add or edit the header":"Add or edit the header.","Add or edit the footer":"Add or edit the footer.","Open the page setup dialog":"Open the page setup dialog.","Add page numbers":"Add page numbers.","Find Text":"Find text in the document (Ctrl+F).","Toggle between the internal clipboard and system clipboard":"Toggle between the internal clipboard and system clipboard.</br>Access to system clipboard through script is denied due to browsers security policy. Instead, </br> 1. You can enable internal clipboard to cut, copy and paste within the component.</br> 2. You can use the keyboard shortcuts (Ctrl+X, Ctrl+C and Ctrl+V) to cut, copy and paste with system clipboard.","Current Page Number":"The current page number in the document. Click or tap to navigate specific page.","Read only":"Read only",Protections:"Protections","Error in establishing connection with web server":"Error in establishing connection with web server",Single:"Single",Double:"Double","New comment":"New comment",Comments:"Comments","Print layout":"Print layout","Web layout":"Web layout","Form Fields":"Form Fields","Text Form":"Text Form","Check Box":"Check Box",DropDown:"Drop-Down","Update Fields":"Update Fields","Update cross reference fields":"Update cross reference fields","Track Changes":"Keep track of the changes made in the document",TrackChanges:"Track Changes",AllCaps:"AllCaps","Change case Tooltip":"Change case",UPPERCASE:"UPPERCASE","No color":"No color","Top margin":"Top margin","Bottom margin":"Bottom margin","Left margin":"Left margin","Right margin":"Right margin",Normal:"Normal",Heading:"Heading","Heading 1":"Heading 1","Heading 2":"Heading 2","Heading 3":"Heading 3","Heading 4":"Heading 4","Heading 5":"Heading 5","Heading 6":"Heading 6",ZoomLevelTooltip:"Zoom level. Click or tap to open the Zoom options.",None:"None",Borders:"Borders","ShowHiddenMarks Tooltip":"Show the hidden characters like spaces, tab, paragraph marks, and breaks.(Ctrl + *)",Columns:"Columns",Column:"Column","Page Breaks":"Page Breaks","Section Breaks":"Section Breaks","Link to Previous":"Link to Previous","Link to PreviousTooltip":"Link this section with previous section header or footer","Alternate Text":"Alternate Text","The address of this site is not valid. Check the address and try again.":"The address of this site is not valid. Check the address and try again.",OK:"OK",Information:"Information"},n}return u(t,e),Object.defineProperty(t.prototype,"documentEditor",{get:function(){return this.documentEditorInternal},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"toolbar",{get:function(){return this.toolbarModule},enumerable:!0,configurable:!0}),t.prototype.getModuleName=function(){return"DocumentEditorContainer"},t.prototype.onPropertyChanged=function(e,t){for(var r=0,o=Object.keys(e);r<o.length;r++){switch(o[r]){case"restrictEditing":this.restrictEditingToggleHelper(e.restrictEditing);break;case"showPropertiesPane":this.showHidePropertiesPane(e.showPropertiesPane);break;case"enableTrackChanges":this.documentEditor.documentHelper.isTrackedOnlyMode&&!e.enableTrackChanges&&e.enableTrackChanges!==this.enableTrackChanges&&(this.enableTrackChanges=!0),this.documentEditor&&(this.documentEditor.enableTrackChanges=e.enableTrackChanges,this.toolbarModule&&this.toolbarModule.toggleTrackChanges(e.enableTrackChanges),this.documentEditor.enableTrackChanges&&(this.documentEditor.documentHelper.showRevision=!0),this.documentEditor.resize());break;case"enableLocalPaste":this.documentEditor&&(this.documentEditor.enableLocalPaste=e.enableLocalPaste);break;case"serviceUrl":this.documentEditor&&(this.documentEditor.serviceUrl=e.serviceUrl);break;case"serverActionSettings":this.documentEditor&&this.setserverActionSettings();break;case"zIndex":this.documentEditor&&(this.documentEditor.zIndex=e.zIndex);break;case"headers":this.documentEditor&&(this.documentEditor.headers=e.headers);break;case"locale":case"enableRtl":this.refresh();break;case"enableComment":this.documentEditor&&(this.documentEditor.enableComment=e.enableComment),this.toolbarModule&&this.toolbarModule.enableDisableInsertComment(e.enableComment);break;case"enableSpellCheck":this.documentEditor&&(this.documentEditor.enableSpellCheck=e.enableSpellCheck);break;case"documentSettings":this.documentEditor&&(this.documentEditor.documentSettings.compatibilityMode=this.documentSettings.compatibilityMode);break;case"documentEditorSettings":if(this.documentEditor&&this.customizeDocumentEditorSettings(),!i.i(n.isNullOrUndefined)(e.documentEditorSettings.fontFamilies)){var s=e.documentEditorSettings.fontFamilies;this.refreshFontFamilies(s)}break;case"toolbarItems":this.toolbarModule&&this.toolbarModule.reInitToolbarItems(e.toolbarItems);break;case"currentUser":this.documentEditor&&(this.documentEditor.currentUser=e.currentUser);break;case"userColor":this.documentEditor&&(this.documentEditor.userColor=e.userColor);break;case"layoutType":this.documentEditor&&(this.documentEditor.layoutType=e.layoutType,"Continuous"===e.layoutType?this.statusBar.togglePageLayout():this.statusBar.toggleWebLayout());break;case"enableToolbar":this.createToolbarContainer(this.enableRtl,!0),e.enableToolbar&&this.toolbarModule&&(this.toolbarModule.initToolBar(this.toolbarItems),this.toolbarModule.enableDisableInsertComment(this.enableComment),this.toolbarModule.toggleTrackChanges(this.enableTrackChanges)),this.documentEditor&&this.documentEditor.resize();break;case"height":this.element.style.height=i.i(n.formatUnit)(this.height),this.documentEditor&&this.documentEditor.resize(),this.resize();break;case"width":this.element.style.width=i.i(n.formatUnit)(this.width),this.documentEditor&&this.documentEditor.resize();break;case"enableAutoFocus":this.documentEditor&&(this.documentEditor.enableAutoFocus=e.enableAutoFocus);break;case"autoResizeOnVisibilityChange":this.documentEditor&&(this.documentEditor.autoResizeOnVisibilityChange=e.autoResizeOnVisibilityChange)}}},t.prototype.preRender=function(){this.localObj=new n.L10n("documenteditorcontainer",this.defaultLocale,this.locale),i.i(n.isNullOrUndefined)(this.element)||""!==this.element.id||(this.element.id=p.HelperMethods.getUniqueElementId()),this.initContainerElement()},t.prototype.render=function(){this.toolbarModule&&(this.toolbarModule.initToolBar(this.toolbarItems),this.toolbarModule.enableDisableInsertComment(this.enableComment)),""!==this.height&&(this.element.style.height=i.i(n.formatUnit)(this.height)),""!==this.width&&(this.element.style.width=i.i(n.formatUnit)(this.width)),this.element.style.minHeight="320px",this.initializeDocumentEditor(),this.restrictEditing&&this.restrictEditingToggleHelper(this.restrictEditing),this.headerFooterProperties=new o.a(this,this.enableRtl),this.imageProperties=new s.a(this,this.enableRtl),this.tocProperties=new a.a(this,this.enableRtl),this.tableProperties=new l.a(this,this.imageProperties,this.enableRtl),this.statusBar=new d.a(this.statusBarElement,this),i.i(h.createSpinner)({target:this.containerTarget,cssClass:"e-spin-overlay"}),this.setserverActionSettings(),this.renderComplete()},t.prototype.restrictEditingToggleHelper=function(e){this.documentEditor.isReadOnly=e,this.toolbarModule&&(this.toolbarModule.enableDisableToolBarItem(!e,!1),this.toolbarModule.toggleRestrictEditing(e)),this.showPropertiesPane=!e,this.showHidePropertiesPane(!e),this.documentEditor.trackChangesPane.enableDisableButton(!e&&!this.documentEditor.documentHelper.isDocumentProtected)},t.prototype.setFormat=function(){this.characterFormat&&this.documentEditor&&this.documentEditor.setDefaultCharacterFormat(this.characterFormat),this.paragraphFormat&&this.documentEditor&&this.documentEditor.setDefaultParagraphFormat(this.paragraphFormat),this.sectionFormat&&this.documentEditor&&this.documentEditor.setDefaultSectionFormat(this.sectionFormat)},t.prototype.setserverActionSettings=function(){this.serviceUrl&&(this.documentEditor.serviceUrl=p.HelperMethods.sanitizeString(this.serviceUrl)),this.serverActionSettings.spellCheck&&(this.documentEditor.serverActionSettings.spellCheck=p.HelperMethods.sanitizeString(this.serverActionSettings.spellCheck)),this.serverActionSettings.restrictEditing&&(this.documentEditor.serverActionSettings.restrictEditing=p.HelperMethods.sanitizeString(this.serverActionSettings.restrictEditing)),this.serverActionSettings.systemClipboard&&(this.documentEditor.serverActionSettings.systemClipboard=p.HelperMethods.sanitizeString(this.serverActionSettings.systemClipboard)),this.headers&&(this.documentEditor.headers=JSON.parse(p.HelperMethods.sanitizeString(JSON.stringify(this.headers))))},t.prototype.customizeDocumentEditorSettings=function(){if(this.documentEditorSettings.formFieldSettings){var e=this.documentEditorSettings.formFieldSettings,t=this.documentEditor;i.i(n.isNullOrUndefined)(e.applyShading)||(t.documentEditorSettings.formFieldSettings.applyShading=e.applyShading),i.i(n.isNullOrUndefined)(e.formFillingMode)||(t.documentEditorSettings.formFieldSettings.formFillingMode=e.formFillingMode),i.i(n.isNullOrUndefined)(e.formattingExceptions)||(t.documentEditorSettings.formFieldSettings.formattingExceptions=e.formattingExceptions),i.i(n.isNullOrUndefined)(e.selectionColor)||(t.documentEditorSettings.formFieldSettings.selectionColor=e.selectionColor),i.i(n.isNullOrUndefined)(e.shadingColor)||(t.documentEditorSettings.formFieldSettings.shadingColor=e.shadingColor)}this.documentEditorSettings.searchHighlightColor&&(this.documentEditor.documentEditorSettings.searchHighlightColor=p.HelperMethods.sanitizeString(this.documentEditorSettings.searchHighlightColor)),this.documentEditorSettings.fontFamilies&&(this.documentEditor.documentEditorSettings.fontFamilies=JSON.parse(p.HelperMethods.sanitizeString(JSON.stringify(this.documentEditorSettings.fontFamilies)))),this.documentEditorSettings.collaborativeEditingSettings&&(this.documentEditor.documentEditorSettings.collaborativeEditingSettings=this.documentEditorSettings.collaborativeEditingSettings),this.documentEditorSettings.printDevicePixelRatio&&(this.documentEditor.documentEditorSettings.printDevicePixelRatio=this.documentEditorSettings.printDevicePixelRatio),i.i(n.isNullOrUndefined)(this.documentEditorSettings.enableOptimizedTextMeasuring)||(this.documentEditor.documentEditorSettings.enableOptimizedTextMeasuring=this.documentEditorSettings.enableOptimizedTextMeasuring),i.i(n.isNullOrUndefined)(this.documentEditorSettings.maximumRows)||(this.documentEditor.documentEditorSettings.maximumRows=this.documentEditorSettings.maximumRows),i.i(n.isNullOrUndefined)(this.documentEditorSettings.maximumColumns)||(this.documentEditor.documentEditorSettings.maximumColumns=this.documentEditorSettings.maximumColumns),i.i(n.isNullOrUndefined)(this.documentEditorSettings.showHiddenMarks)||(this.documentEditor.documentEditorSettings.showHiddenMarks=this.documentEditorSettings.showHiddenMarks),i.i(n.isNullOrUndefined)(this.documentEditorSettings.showBookmarks)||(this.documentEditor.documentEditorSettings.showBookmarks=this.documentEditorSettings.showBookmarks),i.i(n.isNullOrUndefined)(this.documentEditorSettings.highlightEditableRanges)||(this.documentEditor.documentEditorSettings.highlightEditableRanges=this.documentEditorSettings.highlightEditableRanges),i.i(n.isNullOrUndefined)(this.documentEditorSettings.allowDragAndDrop)||(this.documentEditor.documentEditorSettings.allowDragAndDrop=this.documentEditorSettings.allowDragAndDrop),i.i(n.isNullOrUndefined)(this.documentEditorSettings.optimizeSfdt)||(this.documentEditor.documentEditorSettings.optimizeSfdt=this.documentEditorSettings.optimizeSfdt),i.i(n.isNullOrUndefined)(this.documentEditorSettings.autoResizeSettings)||(this.documentEditor.documentEditorSettings.autoResizeSettings=this.documentEditorSettings.autoResizeSettings),i.i(n.isNullOrUndefined)(this.documentEditorSettings.showRuler)||(this.documentEditor.documentEditorSettings.showRuler=this.documentEditorSettings.showRuler),i.i(n.isNullOrUndefined)(this.documentEditorSettings.popupTarget)||(this.documentEditor.documentEditorSettings.popupTarget=this.documentEditorSettings.popupTarget)},t.prototype.getPersistData=function(){return"documenteditor-container"},t.prototype.requiredModules=function(){var e=[];return this.enableToolbar&&e.push({member:"toolbar",args:[this]}),e},t.prototype.initContainerElement=function(){var e=this.enableRtl;this.containerTarget=this.createElement("div",{className:"e-de-ctn"}),this.containerTarget.contentEditable="false",this.createToolbarContainer(e);var t;t=e?"e-de-pane-rtl":"e-de-pane",this.propertiesPaneContainer=this.createElement("div",{className:t,styles:"display:none"}),this.editorContainer.appendChild(this.propertiesPaneContainer),this.containerTarget.appendChild(this.editorContainer),this.statusBarElement=this.createElement("div",{className:"e-de-status-bar"}),e&&(this.statusBarElement.style.direction="rtl"),this.containerTarget.appendChild(this.statusBarElement),this.element.appendChild(this.containerTarget)},t.prototype.createToolbarContainer=function(e,t){i.i(n.isNullOrUndefined)(this.editorContainer)&&(this.editorContainer=this.createElement("div",{className:"e-de-tool-ctnr-properties-pane"+(e?" e-de-ctnr-rtl":"")})),this.enableToolbar?(this.toolbarContainer=this.createElement("div",{className:"e-de-ctnr-toolbar"+(e?" e-de-ctnr-rtl":"")}),t?this.containerTarget.insertBefore(this.toolbarContainer,this.containerTarget.firstChild):this.containerTarget.appendChild(this.toolbarContainer),this.editorContainer.classList.remove("e-de-ctnr-properties-pane"),this.editorContainer.classList.add("e-de-tool-ctnr-properties-pane")):(this.editorContainer.classList.remove("e-de-tool-ctnr-properties-pane"),this.editorContainer.classList.add("e-de-ctnr-properties-pane"))},t.prototype.initializeDocumentEditor=function(){var e=this.element.id+"_editor",t=this.createElement("div",{id:e,styles:"width:100%;height:100%"});this.documentEditorInternal=new r.a({isReadOnly:!1,enableRtl:this.enableRtl,selectionChange:this.onSelectionChange.bind(this),contentChange:this.onContentChange.bind(this),documentChange:this.onDocumentChange.bind(this),requestNavigate:this.onRequestNavigate.bind(this),viewChange:this.onViewChange.bind(this),customContextMenuSelect:this.onCustomContextMenuSelect.bind(this),customContextMenuBeforeOpen:this.onCustomContextMenuBeforeOpen.bind(this),beforePaneSwitch:this.onBeforePaneSwitch.bind(this),commentBegin:this.onCommentBegin.bind(this),commentEnd:this.onCommentEnd.bind(this),commentDelete:this.onCommentDelete.bind(this),beforeAcceptRejectChanges:this.onBeforeAcceptRejectChanges.bind(this),beforeCommentAction:this.onCommentAction.bind(this),trackChange:this.onTrackChange.bind(this),serviceFailure:this.fireServiceFailure.bind(this),beforeXmlHttpRequestSend:this.beforeXmlHttpSend.bind(this),locale:this.locale,acceptTab:!0,zIndex:this.zIndex,enableLocalPaste:this.enableLocalPaste,layoutType:this.layoutType,pageOutline:"#E0E0E0",currentUser:this.currentUser,userColor:this.userColor,height:"100%",width:"100%",enableTrackChanges:this.enableTrackChanges,showRevisions:!0,showComments:!0,enableLockAndEdit:this.enableLockAndEdit,enableAutoFocus:this.enableAutoFocus}),this.wireEvents(),this.customizeDocumentEditorSettings(),this.documentEditor.enableAllModules(),this.documentEditor.enableComment=this.enableComment,this.editorContainer.insertBefore(t,this.editorContainer.firstChild),this.setFormat(),this.documentEditor.appendTo(t),this.documentEditor.resize()},t.prototype.wireEvents=function(){this.documentEditor.on(c.a,this.onZoomFactorChange,this),this.documentEditor.on(c.b,this.onViewChange,this),this.documentEditor.on(c.c,this.showPropertiesPaneOnSelection,this),this.documentEditor.on(c.d,this.updateShowHiddenMarks,this),this.documentEditor.on(c.e,this.updateStyleCollection,this),this.documentEditor.on(c.f,this.triggerAutoResize,this),this.documentEditor.on(c.g,this.onBeforeAutoResize,this),this.documentEditor.on(c.h,this.onEnableTrackChanges,this)},t.prototype.onEnableTrackChanges=function(e){e.enableTrackChanges!==this.enableTrackChanges&&(this.enableTrackChanges=e.enableTrackChanges)},t.prototype.triggerAutoResize=function(e){e.cancel=!0,this.resize()},t.prototype.onBeforeAutoResize=function(e){e.element=this.element},t.prototype.unWireEvents=function(){i.i(n.isNullOrUndefined)(this.documentEditor)||this.documentEditor.isDestroyed||(this.documentEditor.off(c.a,this.onZoomFactorChange),this.documentEditor.off(c.b,this.onViewChange),this.documentEditor.off(c.c,this.showPropertiesPaneOnSelection),this.documentEditor.off(c.d,this.updateShowHiddenMarks),this.documentEditor.off(c.e,this.updateStyleCollection))},t.prototype.onCommentBegin=function(){this.toolbarModule&&this.toolbarModule.enableDisableInsertComment(!1)},t.prototype.onCommentEnd=function(){this.toolbarModule&&this.toolbarModule.enableDisableInsertComment(this.enableComment)},t.prototype.beforeXmlHttpSend=function(e){this.trigger(c.i,e)},t.prototype.onCommentDelete=function(e){this.trigger(c.j,e)},t.prototype.onBeforeAcceptRejectChanges=function(e){this.trigger(c.k,e)},t.prototype.onCommentAction=function(e){this.trigger(c.l,e)},t.prototype.onTrackChange=function(e){this.trigger(c.m,e),this.toolbarModule&&this.toolbarModule.toggleTrackChanges(e.isTrackChangesEnabled)},t.prototype.onBeforePaneSwitch=function(e){this.trigger(c.n,e)},t.prototype.fireServiceFailure=function(e){this.trigger(c.o,e)},t.prototype.showHidePropertiesPane=function(e){this.showPropertiesPane&&this.showPropertiesPaneOnSelection(),this.propertiesPaneContainer.style.display=e?"block":"none",this.toolbarModule&&(this.toolbarModule.propertiesPaneButton.element.style.opacity=e?"1":"0.5"),this.documentEditor.resize()},t.prototype.updateStyleCollection=function(){i.i(n.isNullOrUndefined)(this.tableProperties)||i.i(n.isNullOrUndefined)(this.tableProperties.tableTextProperties)||i.i(n.isNullOrUndefined)(this.tableProperties.tableTextProperties.paragraph)||this.tableProperties.tableTextProperties.paragraph.updateStyleNames()},t.prototype.resize=function(e,t){this.element&&(i.i(n.isNullOrUndefined)(t)&&this.element&&this.element.parentElement&&(t=this.element.parentElement.clientHeight),i.i(n.isNullOrUndefined)(e)&&this.element&&this.element.parentElement&&(e=this.element.parentElement.clientWidth),!i.i(n.isNullOrUndefined)(e)&&e>200&&(this.width=e.toString(),this.element.style.width=e+"px"),!i.i(n.isNullOrUndefined)(t)&&t>200&&(this.height=t.toString(),this.element.style.height=t+"px"),this.documentEditor&&this.documentEditor.resize(),this.toolbarModule&&this.toolbarModule.toolbar.refreshOverflow(),this.showPropertiesPane&&this.tableProperties&&this.tableProperties.updateTabContainerHeight())},t.prototype.refreshFontFamilies=function(e){if(!i.i(n.isNullOrUndefined)(this.tableProperties)&&!i.i(n.isNullOrUndefined)(this.tableProperties.tableTextProperties)&&!i.i(n.isNullOrUndefined)(this.tableProperties.tableTextProperties.text)){var t=this.tableProperties.tableTextProperties.text;t.fontFamily.refresh();for(var r=0;r<e.length;r++){var o=e[r],s={FontName:o,FontValue:o};t.fontFamily.addItem(s,r)}}},t.prototype.onContentChange=function(e){this.toolbarModule&&this.toolbarModule.enableDisableUndoRedo(),this.statusBar&&this.statusBar.updatePageCount();var t={source:this,operations:e.operations};this.trigger(c.p,t)},t.prototype.onDocumentChange=function(){if(this.enableTrackChanges=this.documentEditor.enableTrackChanges,i.i(n.isNullOrUndefined)(this.documentSettings)||i.i(n.isNullOrUndefined)(this.documentEditor)||i.i(n.isNullOrUndefined)(this.documentEditor.documentSettings)||(this.documentSettings.compatibilityMode=this.documentEditor.documentSettings.compatibilityMode),!i.i(n.isNullOrUndefined)(this.documentEditorSettings)&&!i.i(n.isNullOrUndefined)(this.documentEditorSettings.fontFamilies)){var e=this.documentEditorSettings.fontFamilies;this.refreshFontFamilies(e)}this.toolbarModule&&(this.toolbarModule.isCommentEditing=!1,this.toolbarModule.enableDisableInsertComment(!0),this.toolbarModule.enableDisableUndoRedo()),this.statusBar&&this.statusBar.updatePageCount();var t={source:this};this.trigger(c.q,t),this.updateStyleCollection()},t.prototype.onSelectionChange=function(){var e=this;setTimeout(function(){e.showPropertiesPaneOnSelection();var t={source:e,isCompleted:e.documentEditor.documentHelper.isSelectionCompleted};e.trigger(c.r,t),e.documentEditor.documentHelper.isSelectionCompleted=!0})},t.prototype.onZoomFactorChange=function(){this.statusBar&&this.statusBar.updateZoomContent()},t.prototype.updateShowHiddenMarks=function(e){this.documentEditorSettings.showHiddenMarks=e.showHiddenMarks,this.tableProperties.tableTextProperties.paragraph.toggleHiddenMarks()},t.prototype.onRequestNavigate=function(e){if("Bookmark"!==e.linkType){var t=e.navigationLink,i=n.SanitizeHtmlHelper.sanitize(t);e.localReference.length>0&&(i+="#"+e.localReference),"file:///"===t.substring(0,8)||"http://"===t.substring(0,7)&&t.length>7||"https://"===t.substring(0,8)&&t.length>8||"www."===t.substring(0,4)&&t.length>4||"mailto:"===t.substring(0,7)&&t.length>7?window.open(i):h.DialogUtility.alert({title:this.localObj.getConstant("Information"),content:this.localObj.getConstant("The address of this site is not valid. Check the address and try again."),okButton:{text:this.localObj.getConstant("OK")},closeOnEscape:!0}),e.isHandled=!0}},t.prototype.onViewChange=function(e){this.statusBar&&this.statusBar.updatePageNumberOnViewChange(e)},t.prototype.onCustomContextMenuSelect=function(e){this.trigger(c.s,e)},t.prototype.onCustomContextMenuBeforeOpen=function(e){this.trigger(c.t,e)},t.prototype.showPropertiesPaneOnSelection=function(){if(!(this.restrictEditing&&!this.showPropertiesPane||i.i(n.isNullOrUndefined)(this.tableProperties))){var e="NoProtection"!==this.documentEditor.documentHelper.protectionType,t=e&&this.documentEditor.documentHelper.restrictFormatting,r=this.documentEditor.editor.restrictEditing;if(e)this.toolbarModule&&this.toolbarModule.enableDisableToolBarItem(!r,!0),this.tableProperties.enableDisableElements(!t&&!r),this.tocProperties.enableDisableElements(!r),this.headerFooterProperties.enableDisableElements(!r),this.imageProperties.enableDisableElements(!r);else{var o=!this.documentEditor.isReadOnly;this.toolbarModule&&this.toolbarModule.enableDisableToolBarItem(o,!0),this.tableProperties.enableDisableElements(!0),this.tocProperties.enableDisableElements(!0),this.headerFooterProperties.enableDisableElements(!0),this.imageProperties.enableDisableElements(!0)}var s=this.documentEditor.selection.contextType,a=s.indexOf("Header")>=0||s.indexOf("Footer")>=0;a||(this.showHeaderProperties=!0),this.showPropertiesPane?(this.propertiesPaneContainer.style.display="block",a&&this.showHeaderProperties?this.showProperties("headerfooter"):s.indexOf("List")>=0||s.indexOf("Text")>=0&&s.indexOf("Table")<0?this.showProperties("text"):s.indexOf("Image")>=0?this.showProperties("image"):s.indexOf("TableOfContents")>=0?this.showProperties("toc"):s.indexOf("Table")>=0&&this.showProperties("table")):(this.showHidePropertiesPane(!1),this.propertiesPaneContainer.style.display="none"),this.previousContext=this.documentEditor.selection.contextType,this.toolbarModule&&this.toolbarModule.toolbar&&this.toolbarModule.enableDisableInsertComment(!this.documentEditor.enableHeaderAndFooter&&this.enableComment&&!this.documentEditor.isReadOnlyMode&&!this.documentEditor.selection.isinFootnote&&!this.documentEditor.selection.isinEndnote)}},t.prototype.showProperties=function(e){this.toolbarModule&&"headerfooter"!==e&&"toc"!==e&&this.toolbarModule.enableDisablePropertyPaneButton(!0),this.tableProperties.showTableProperties("table"===e||"text"===e,e),this.imageProperties.showImageProperties("image"===e),this.headerFooterProperties.showHeaderFooterPane("headerfooter"===e),this.tocProperties.showTocPane("toc"===e)},t.prototype.setDefaultCharacterFormat=function(e){this.characterFormat=e,this.setFormat()},t.prototype.setDefaultParagraphFormat=function(e){this.paragraphFormat=e,this.setFormat()},t.prototype.setDefaultSectionFormat=function(e){this.sectionFormat=e,this.setFormat()},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.element&&(this.refreshing||this.element.classList.remove("e-documenteditorcontainer"),this.element.innerHTML=""),this.refreshing||(this.element=void 0,this.paragraphFormat=void 0,this.sectionFormat=void 0,this.characterFormat=void 0),this.toolbarContainer&&this.toolbarContainer.parentElement&&(this.toolbarContainer.innerHTML="",this.toolbarContainer.parentElement.removeChild(this.toolbarContainer)),this.toolbarContainer=void 0,this.documentEditorInternal&&(this.unWireEvents(),this.documentEditorInternal.destroy(),this.documentEditorInternal=void 0),this.headerFooterProperties&&this.headerFooterProperties.destroy(),this.headerFooterProperties=void 0,this.imageProperties&&this.imageProperties.destroy(),this.imageProperties=void 0,this.tocProperties&&this.tocProperties.destroy(),this.tocProperties=void 0,this.tableProperties&&this.tableProperties.destroy(),this.tableProperties=void 0,this.statusBar&&this.statusBar.destroy(),this.propertiesPaneContainer&&this.propertiesPaneContainer.parentElement&&(this.propertiesPaneContainer.innerHTML="",this.propertiesPaneContainer.parentElement.removeChild(this.propertiesPaneContainer)),this.propertiesPaneContainer=void 0,this.editorContainer&&this.editorContainer.parentElement&&(this.editorContainer.innerHTML="",this.editorContainer.parentElement.removeChild(this.editorContainer)),this.statusBarElement&&this.statusBarElement.parentElement&&(this.statusBarElement.innerHTML="",this.statusBarElement.parentElement.removeChild(this.statusBarElement)),this.containerTarget&&this.containerTarget.parentElement&&(this.containerTarget.innerHTML="",this.containerTarget.parentElement.removeChild(this.containerTarget)),this.containerTarget=void 0,this.statusBarElement=void 0,this.editorContainer=void 0,this.statusBar=void 0,this.previousContext=void 0},g([i.i(n.Property)(!0)],t.prototype,"showPropertiesPane",void 0),g([i.i(n.Property)(!0)],t.prototype,"enableToolbar",void 0),g([i.i(n.Property)(!1)],t.prototype,"restrictEditing",void 0),g([i.i(n.Property)(!1)],t.prototype,"enableSpellCheck",void 0),g([i.i(n.Property)(!1)],t.prototype,"enableTrackChanges",void 0),g([i.i(n.Property)("Pages")],t.prototype,"layoutType",void 0),g([i.i(n.Property)("")],t.prototype,"currentUser",void 0),g([i.i(n.Property)("#FFFF00")],t.prototype,"userColor",void 0),g([i.i(n.Property)(!1)],t.prototype,"enableLocalPaste",void 0),g([i.i(n.Property)()],t.prototype,"serviceUrl",void 0),g([i.i(n.Property)(2e3)],t.prototype,"zIndex",void 0),g([i.i(n.Property)(!1)],t.prototype,"enableCsp",void 0),g([i.i(n.Property)(!0)],t.prototype,"enableComment",void 0),g([i.i(n.Property)("100%")],t.prototype,"width",void 0),g([i.i(n.Property)("320px")],t.prototype,"height",void 0),g([i.i(n.Property)(!0)],t.prototype,"enableAutoFocus",void 0),g([i.i(n.Property)(!1)],t.prototype,"enableLockAndEdit",void 0),g([i.i(n.Property)(!1)],t.prototype,"autoResizeOnVisibilityChange",void 0),g([i.i(n.Event)()],t.prototype,"created",void 0),g([i.i(n.Event)()],t.prototype,"destroyed",void 0),g([i.i(n.Event)()],t.prototype,"contentChange",void 0),g([i.i(n.Event)()],t.prototype,"selectionChange",void 0),g([i.i(n.Event)()],t.prototype,"documentChange",void 0),g([i.i(n.Event)()],t.prototype,"toolbarClick",void 0),g([i.i(n.Event)()],t.prototype,"customContextMenuSelect",void 0),g([i.i(n.Event)()],t.prototype,"customContextMenuBeforeOpen",void 0),g([i.i(n.Event)()],t.prototype,"beforePaneSwitch",void 0),g([i.i(n.Event)()],t.prototype,"commentDelete",void 0),g([i.i(n.Event)()],t.prototype,"beforeAcceptRejectChanges",void 0),g([i.i(n.Event)()],t.prototype,"beforeCommentAction",void 0),g([i.i(n.Event)()],t.prototype,"serviceFailure",void 0),g([i.i(n.Event)()],t.prototype,"trackChange",void 0),g([i.i(n.Event)()],t.prototype,"contentControl",void 0),g([i.i(n.Event)()],t.prototype,"beforeXmlHttpRequestSend",void 0),g([i.i(n.Complex)({},r.b)],t.prototype,"documentEditorSettings",void 0),g([i.i(n.Complex)({},r.c)],t.prototype,"documentSettings",void 0),g([i.i(n.Property)({import:"Import",systemClipboard:"SystemClipboard",spellCheck:"SpellCheck",restrictEditing:"RestrictEditing",canLock:"CanLock",getPendingActions:"GetPendingActions"})],t.prototype,"serverActionSettings",void 0),g([i.i(n.Property)(["New","Open","Separator","Undo","Redo","Separator","Image","Table","Hyperlink","Bookmark","TableOfContents","Separator","Header","Footer","PageSetup","PageNumber","Break","InsertFootnote","InsertEndnote","Separator","Find","Separator","Comments","TrackChanges","Separator","LocalClipboard","RestrictEditing","Separator","FormFields","UpdateFields"])],t.prototype,"toolbarItems",void 0),g([i.i(n.Property)([])],t.prototype,"headers",void 0),t=g([n.NotifyPropertyChanges],t)}(n.Component)},function(e,t,i){"use strict";i.d(t,"a",function(){return s});var n=i(0),r=(i.n(n),i(3)),o=(i.n(r),i(5)),s=(i.n(o),function(){function e(e,t){this.isHeaderTopApply=!1,this.isFooterTopApply=!1,this.container=e,this.isRtl=t,this.initHeaderFooterPane(),this.wireEvents()}return Object.defineProperty(e.prototype,"documentEditor",{get:function(){return this.container.documentEditor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"toolbar",{get:function(){return this.container.toolbarModule},enumerable:!0,configurable:!0}),e.prototype.enableDisableElements=function(e){e?i.i(n.classList)(this.element,[],["e-de-overlay"]):i.i(n.classList)(this.element,["e-de-overlay"],[])},e.prototype.initHeaderFooterPane=function(){this.initializeHeaderFooter(),this.element.style.display="none",this.container.propertiesPaneContainer.appendChild(this.element)},e.prototype.showHeaderFooterPane=function(e){e&&(this.toolbar&&this.toolbar.enableDisablePropertyPaneButton(!1),this.onSelectionChange()),!e&&"none"===this.element.style.display||e&&"block"===this.element.style.display||(this.element.style.display=e?"block":"none",this.documentEditor.resize())},e.prototype.initializeHeaderFooter=function(){var e=this,t=new n.L10n("documenteditorcontainer",this.container.defaultLocale,this.container.locale),s="header_footer_properties";this.element=i.i(n.createElement)("div",{id:this.documentEditor.element.id+s,className:"e-de-prop-pane"});var a=this.createDivTemplate("_header_footer",this.element,"padding-bottom:0");i.i(n.classList)(a,["e-de-cntr-pane-padding"],[]);var l=i.i(n.createElement)("label",{className:"e-de-prop-header-label"});l.innerHTML=t.getConstant("Header And Footer");var d;d=this.isRtl?"float:left;":"float:right;";var h=i.i(n.createElement)("span",{id:"_header_footer_close",className:"e-de-ctnr-close e-de-close-icon e-icons",styles:"display:inline-block;cursor:pointer;"+d});h.addEventListener("click",function(){e.onClose()}),a.appendChild(l),a.appendChild(h);var c=this.createDivTemplate(s+"_options",this.element);i.i(n.classList)(c,["e-de-cntr-pane-padding","e-de-prop-separator-line"],[]);var p=i.i(n.createElement)("label",{className:"e-de-ctnr-prop-label",styles:"height:20px;"});p.innerHTML=t.getConstant("Options"),c.appendChild(p);var u=this.createDivTemplate(s+"_optionsDiv",c),g=this.createDivTemplate(s+"_firstPageDiv",u);i.i(n.classList)(g,["e-de-hdr-ftr-frst-div"],[]);var f=i.i(n.createElement)("input",{id:"firstPage",className:"e-de-prop-sub-label"});g.appendChild(f),this.firstPage=new r.CheckBox({label:t.getConstant("Different First Page"),change:this.changeFirstPageOptions.bind(this),cssClass:"e-de-prop-sub-label",enableRtl:this.isRtl}),this.firstPage.appendTo(f),g.children[0].setAttribute("title",t.getConstant("Different header and footer for first page"));var m=this.createDivTemplate(s+"_oddOrEvenDiv",u);i.i(n.classList)(m,["e-de-hdr-ftr-frst-div"],[]);var v=i.i(n.createElement)("input",{id:"oddOrEven",className:"e-de-sub-prop-label"});m.appendChild(v),this.oddOrEven=new r.CheckBox({label:t.getConstant("Different Odd And Even Pages"),change:this.changeoddOrEvenOptions.bind(this),cssClass:"e-de-prop-sub-label",enableRtl:this.isRtl}),this.oddOrEven.appendTo(v),m.children[0].setAttribute("title",t.getConstant("Different header and footer for odd and even pages"));var y=this.createDivTemplate(s+"_linkToPreviousDiv",u),w=i.i(n.createElement)("input",{id:"linkToPrevious",className:"e-de-sub-prop-label"});y.appendChild(w),this.linkToPrevious=new r.CheckBox({label:t.getConstant("Link to Previous"),change:this.changeLinkToPreviousOptions.bind(this),cssClass:"e-de-prop-sub-label",enableRtl:this.isRtl,checked:!0}),this.linkToPrevious.appendTo(w),y.children[0].setAttribute("title",t.getConstant("Link to the previous Title"));var b=this.createDivTemplate(s+"_positionLabelDiv",this.element);i.i(n.classList)(b,["e-de-cntr-pane-padding","e-de-prop-separator-line"],[]);var x=i.i(n.createElement)("label",{className:"e-de-ctnr-prop-label",styles:"height:20px;"});x.innerHTML=t.getConstant("Position"),b.appendChild(x);var C=this.createDivTemplate(s+"_positionDiv",b),I=this.createDivTemplate(s+"_headerTopDiv",C);i.i(n.classList)(I,["e-de-hdr-ftr-top-div"],[]);var F=i.i(n.createElement)("label",{className:"e-de-prop-sub-label",styles:"display:block"});F.innerHTML=t.getConstant("Header from Top"),I.appendChild(F);var k=i.i(n.createElement)("input",{id:this.documentEditor.element.id+"_headerFromTop",className:"e-de-prop-sub-label"});k.setAttribute("aria-label",t.getConstant("Header from Top")),I.appendChild(k),this.headerFromTop=new o.NumericTextBox({value:36,cssClass:"e-de-prop-header-numeric",showSpinButton:!1,format:"n0",decimals:2,max:1584,min:0,enableRtl:this.isRtl}),this.headerFromTop.appendTo(k),this.headerFromTop.element.parentElement.setAttribute("title",t.getConstant("Distance from top of the page to top of the header"));var P=this.createDivTemplate(s+"_footerBottomDiv",C),T=i.i(n.createElement)("label",{className:"e-de-prop-sub-label",styles:"display:block"});T.innerHTML=t.getConstant("Footer from Bottom"),P.appendChild(T);var S=i.i(n.createElement)("input",{id:this.documentEditor.element.id+"_footerFromTop",className:"e-de-prop-sub-label"});S.setAttribute("aria-label",t.getConstant("Footer from Bottom")),P.appendChild(S),this.footerFromTop=new o.NumericTextBox({value:36,cssClass:"e-de-prop-header-numeric",showSpinButton:!1,format:"n0",decimals:2,max:1584,min:0,enableRtl:this.isRtl}),this.footerFromTop.appendTo(S),this.footerFromTop.element.parentElement.setAttribute("title",t.getConstant("Distance from bottom of the page to bottom of the footer"))},e.prototype.createDivTemplate=function(e,t,r){var o;return o=r?i.i(n.createElement)("div",{id:e,styles:r}):i.i(n.createElement)("div",{id:e}),t.appendChild(o),o},e.prototype.wireEvents=function(){var e=this;this.headerFromTop.element.addEventListener("click",function(){e.isHeaderTopApply=!0}),this.footerFromTop.element.addEventListener("click",function(){e.isFooterTopApply=!0}),this.headerFromTop.element.addEventListener("keydown",this.onHeaderValue.bind(this)),this.footerFromTop.element.addEventListener("keydown",this.onFooterValue.bind(this)),this.headerFromTop.element.addEventListener("blur",function(){e.changeHeaderValue(),e.isHeaderTopApply=!1}),this.footerFromTop.element.addEventListener("blur",function(){e.changeFooterValue(),e.isFooterTopApply=!1})},e.prototype.onClose=function(){this.container.showHeaderProperties=!0,this.container.documentEditor.selection.closeHeaderFooter()},e.prototype.changeFirstPageOptions=function(){var e=this;this.documentEditor.isReadOnly||(this.documentEditor.selection.sectionFormat.differentFirstPage=this.firstPage.checked,setTimeout(function(){e.documentEditor.focusIn()},10))},e.prototype.changeoddOrEvenOptions=function(){var e=this;this.documentEditor.isReadOnly||(this.documentEditor.selection.sectionFormat.differentOddAndEvenPages=this.oddOrEven.checked,setTimeout(function(){e.documentEditor.focusIn()},10))},e.prototype.changeLinkToPreviousOptions=function(){var e=this;if(!this.documentEditor.isReadOnly){var t=this.documentEditor.selection.start.paragraph.containerWidget.headerFooterType,i=this.linkToPrevious.checked;switch(t){case"OddHeader":this.documentEditor.selection.sectionFormat.oddPageHeader.linkToPrevious=i;break;case"OddFooter":this.documentEditor.selection.sectionFormat.oddPageFooter.linkToPrevious=i;break;case"EvenHeader":this.documentEditor.selection.sectionFormat.evenPageHeader.linkToPrevious=i;break;case"EvenFooter":this.documentEditor.selection.sectionFormat.evenPageFooter.linkToPrevious=i;break;case"FirstPageHeader":this.documentEditor.selection.sectionFormat.firstPageHeader.linkToPrevious=i;break;case"FirstPageFooter":this.documentEditor.selection.sectionFormat.firstPageFooter.linkToPrevious=i}setTimeout(function(){e.documentEditor.focusIn()},10)}},e.prototype.changeHeaderValue=function(){if(this.isHeaderTopApply&&!this.documentEditor.isReadOnly){var e=this.headerFromTop.value;e>this.headerFromTop.max&&(e=this.headerFromTop.max),this.documentEditor.selection.sectionFormat.headerDistance=e}},e.prototype.onHeaderValue=function(e){var t=this;13===e.keyCode&&setTimeout(function(){t.changeHeaderValue(),t.isHeaderTopApply=!1},30)},e.prototype.onFooterValue=function(e){var t=this;13===e.keyCode&&setTimeout(function(){t.changeFooterValue(),t.isFooterTopApply=!1},30)},e.prototype.changeFooterValue=function(){if(this.isFooterTopApply&&!this.documentEditor.isReadOnly){var e=this.footerFromTop.value;e>this.footerFromTop.max&&(e=this.footerFromTop.max),this.documentEditor.selection.sectionFormat.footerDistance=e}},e.prototype.onSelectionChange=function(){if(this.headerFromTop.value=this.documentEditor.selection.sectionFormat.headerDistance,this.footerFromTop.value=this.documentEditor.selection.sectionFormat.footerDistance,this.documentEditor.selection.sectionFormat.differentFirstPage?this.firstPage.checked=!0:this.firstPage.checked=!1,this.documentEditor.selection.sectionFormat.differentOddAndEvenPages?this.oddOrEven.checked=!0:this.oddOrEven.checked=!1,0==this.documentEditor.selection.start.paragraph.bodyWidget.sectionIndex)this.linkToPrevious.disabled=!0;else{this.linkToPrevious.disabled=!1;switch(this.documentEditor.selection.start.paragraph.containerWidget.headerFooterType){case"OddHeader":this.linkToPrevious.checked=this.documentEditor.selection.sectionFormat.oddPageHeader.linkToPrevious;break;case"OddFooter":this.linkToPrevious.checked=this.documentEditor.selection.sectionFormat.oddPageFooter.linkToPrevious;break;case"EvenHeader":this.linkToPrevious.checked=this.documentEditor.selection.sectionFormat.evenPageHeader.linkToPrevious;break;case"EvenFooter":this.linkToPrevious.checked=this.documentEditor.selection.sectionFormat.evenPageFooter.linkToPrevious;break;case"FirstPageHeader":this.linkToPrevious.checked=this.documentEditor.selection.sectionFormat.firstPageHeader.linkToPrevious;break;case"FirstPageFooter":this.linkToPrevious.checked=this.documentEditor.selection.sectionFormat.firstPageFooter.linkToPrevious}}},e.prototype.destroy=function(){this.element&&(this.element.innerHTML="",this.element.parentElement&&this.element.parentElement.removeChild(this.element)),this.element=void 0,this.firstPage&&this.firstPage.destroy(),this.firstPage=void 0,this.oddOrEven&&this.oddOrEven.destroy(),this.oddOrEven=void 0,this.linkToPrevious&&this.linkToPrevious.destroy(),this.linkToPrevious=void 0,this.headerFromTop&&(this.headerFromTop.destroy(),this.headerFromTop=void 0),this.footerFromTop&&(this.footerFromTop.destroy(),this.footerFromTop=void 0),this.container=void 0},e}())},function(e,t,i){"use strict";i.d(t,"a",function(){return s});var n=i(0),r=(i.n(n),i(5)),o=(i.n(r),i(3)),s=(i.n(o),function(){function e(e,t){this.isWidthApply=!1,this.isHeightApply=!1,this.container=e,this.elementId=this.documentEditor.element.id,this.isMaintainAspectRatio=!1,this.isRtl=t,this.initializeImageProperties()}return Object.defineProperty(e.prototype,"documentEditor",{get:function(){return this.container.documentEditor},enumerable:!0,configurable:!0}),e.prototype.enableDisableElements=function(e){e?i.i(n.classList)(this.element,[],["e-de-overlay"]):i.i(n.classList)(this.element,["e-de-overlay"],[])},e.prototype.initializeImageProperties=function(){this.element=i.i(n.createElement)("div",{id:this.elementId+"_imageProperties",className:"e-de-prop-pane"}),this.element.style.display="none",this.container.propertiesPaneContainer.appendChild(this.element),this.initImageProp(),this.initImageAltProp(),this.wireEvents()},e.prototype.initImageProp=function(){var e=new n.L10n("documenteditorcontainer",this.container.defaultLocale,this.container.locale),t=i.i(n.createElement)("div",{id:this.elementId+"_imageDiv",className:"e-de-cntr-pane-padding e-de-prop-separator-line"});this.element.appendChild(t);var s=i.i(n.createElement)("label",{className:"e-de-ctnr-prop-label"});s.textContent=e.getConstant("Image"),t.appendChild(s);var a=i.i(n.createElement)("div");t.appendChild(a),this.widthElement=this.createImagePropertiesDiv("_widthDiv",a,"_widthInput",e.getConstant("W"),e.getConstant("Width")),this.widthNumericBox=new r.NumericTextBox({min:0,max:23500,cssClass:"e-de-image-property",showSpinButton:!1,format:"n0",decimals:2}),this.widthNumericBox.appendTo(this.widthElement),this.heightElement=this.createImagePropertiesDiv("_heightDiv",a,"_heightInput",e.getConstant("H"),e.getConstant("Height")),this.heightNumericBox=new r.NumericTextBox({min:0,max:23500,cssClass:"e-de-image-property",showSpinButton:!1,format:"n0",decimals:2}),this.heightNumericBox.appendTo(this.heightElement);var l=i.i(n.createElement)("div",{id:this.elementId+"_aspectRatioDiv"});l.setAttribute("title",e.getConstant("Aspect ratio")),a.appendChild(l);var d=i.i(n.createElement)("input",{id:this.elementId+"_aspectRatio",className:"e-de-ctnr-prop-label"});l.appendChild(d),this.aspectRatioBtn=new o.CheckBox({label:e.getConstant("Aspect ratio"),enableRtl:this.isRtl},d)},e.prototype.initImageAltProp=function(){var e=new n.L10n("documenteditorcontainer",this.container.defaultLocale,this.container.locale),t=i.i(n.createElement)("div",{id:this.elementId+"_altDiv",className:"e-de-cntr-pane-padding e-de-prop-separator-line"});this.element.appendChild(t);var o=i.i(n.createElement)("label",{className:"e-de-ctnr-prop-label"});o.textContent=e.getConstant("Alternate Text"),t.appendChild(o),this.textArea=i.i(n.createElement)("textarea",{id:this.elementId+"_textarea",className:"e-de-ctnr-prop-label "}),t.appendChild(this.textArea),new r.TextBox({floatLabelType:"Never"}).appendTo(this.textArea)},e.prototype.createImagePropertiesDiv=function(e,t,r,o,s){var a=i.i(n.createElement)("div",{id:this.elementId+e,styles:"position: relative;width: 100%;",className:"e-de-ctnr-segment"});a.setAttribute("title",s),t.appendChild(a);var l=i.i(n.createElement)("input",{id:this.elementId+r,className:"e-textbox",styles:"width:100%;"});a.appendChild(l);var d=i.i(n.createElement)("span",{className:"e-de-img-prty-span"});return d.textContent=o,a.appendChild(d),l},e.prototype.wireEvents=function(){var e=this;this.aspectRatioBtn.element.addEventListener("change",this.onAspectRatioBtnClick.bind(this)),this.widthNumericBox.element.addEventListener("click",function(){e.isWidthApply=!0}),this.heightNumericBox.element.addEventListener("click",function(){e.isHeightApply=!0}),this.widthNumericBox.element.addEventListener("keydown",this.onImageWidth.bind(this)),this.heightNumericBox.element.addEventListener("keydown",this.onImageHeight.bind(this)),this.widthNumericBox.element.addEventListener("blur",function(){e.applyImageWidth(),e.isWidthApply=!1}),this.heightNumericBox.element.addEventListener("blur",function(){e.applyImageHeight(),e.isHeightApply=!1}),this.textArea.addEventListener("blur",function(){e.documentEditor.selection.imageFormat.alternateText!=e.textArea.value&&e.applyImageAlternativeText()})},e.prototype.applyImageAlternativeText=function(){var e=n.SanitizeHtmlHelper.sanitize(this.textArea.value);i.i(n.isNullOrUndefined)(e)||this.documentEditor.selection.imageFormat.applyImageAlternativeText(e)},e.prototype.onImageWidth=function(e){var t=this;13===e.keyCode&&setTimeout(function(){t.applyImageWidth(),t.isWidthApply=!1},30)},e.prototype.onImageHeight=function(e){var t=this;13===e.keyCode&&setTimeout(function(){t.applyImageHeight(),t.isHeightApply=!1},30)},e.prototype.applyImageWidth=function(){if(this.isMaintainAspectRatio){if(this.isMaintainAspectRatio){var e=this.widthNumericBox.value;e>this.widthNumericBox.max&&(e=this.widthNumericBox.max);var t=e/this.documentEditor.selection.imageFormat.width,i=this.heightNumericBox.value*t;this.heightNumericBox.value=i,null!==e&&null!==i&&this.documentEditor.selection.imageFormat.resize(e,i)}}else{var e=this.widthNumericBox.value,i=this.heightNumericBox.value;e>this.widthNumericBox.max&&(e=this.widthNumericBox.max),i>this.heightNumericBox.max&&(i=this.heightNumericBox.max),null!==e&&null!==i&&this.documentEditor.selection.imageFormat.resize(e,i)}},e.prototype.applyImageHeight=function(){if(this.isMaintainAspectRatio){if(this.isMaintainAspectRatio){var e=this.heightNumericBox.value,t=e/this.documentEditor.selection.imageFormat.height,i=this.widthNumericBox.value*t;this.widthNumericBox.value=i,null!==i&&null!==e&&this.documentEditor.selection.imageFormat.resize(i,e)}}else{var i=this.widthNumericBox.value,e=this.heightNumericBox.value;null!==i&&null!==e&&this.documentEditor.selection.imageFormat.resize(i,e)}},e.prototype.onAspectRatioBtnClick=function(){this.isMaintainAspectRatio?this.isMaintainAspectRatio=!1:this.isMaintainAspectRatio=!0},e.prototype.showImageProperties=function(e){"block"===this.element.style.display&&this.updateImageProperties(),!e&&"none"===this.element.style.display||e&&"block"===this.element.style.display||(this.element.style.display=e?"block":"none",this.documentEditor.resize())},e.prototype.updateImageProperties=function(){this.widthNumericBox.value=this.documentEditor.selection.imageFormat.width,this.heightNumericBox.value=this.documentEditor.selection.imageFormat.height,i.i(n.isNullOrUndefined)(this.documentEditor.selection.imageFormat.alternateText)?this.textArea.value="":this.textArea.value=this.documentEditor.selection.imageFormat.alternateText},e.prototype.destroy=function(){this.container=void 0,this.widthNumericBox&&this.widthNumericBox.destroy(),this.widthNumericBox=void 0,this.heightNumericBox&&this.heightNumericBox.destroy(),this.heightNumericBox=void 0,this.aspectRatioBtn&&this.aspectRatioBtn.destroy(),this.aspectRatioBtn=void 0},e}())},function(e,t,i){"use strict";i.d(t,"a",function(){return l});var n=i(0),r=(i.n(n),i(10)),o=(i.n(r),i(3)),s=(i.n(o),i(19)),a=(i.n(s),i(43)),l=(i.n(a),function(){function e(e){this.isRetrieving=!1,this.appliedBulletStyle="dot",this.appliedNumberingStyle="arabic",this.appliedLineSpacing="",this.splitButtonClass="e-de-prop-splitbutton",this.container=e}return Object.defineProperty(e.prototype,"documentEditor",{get:function(){return this.container.documentEditor},enumerable:!0,configurable:!0}),e.prototype.initializeParagraphPropertiesDiv=function(e,t){this.localObj=new n.L10n("documenteditorcontainer",this.container.defaultLocale,this.container.locale),this.isRtl=t,this.isRtl&&(this.splitButtonClass="e-rtl "+this.splitButtonClass),this.textProperties=e;var r=this.documentEditor.element.id+"_font_properties",o=this.createDivElement(r+"_paragraph",e,"");i.i(n.classList)(o,["e-de-cntr-pane-padding"],[]);var s=i.i(n.createElement)("label",{className:"e-de-ctnr-prop-label"});s.innerHTML=this.localObj.getConstant("Paragraph"),o.appendChild(s);var a=this.createDivElement(r+"_styleDiv",o);a.classList.add("e-de-ctnr-segment","e-de-ctnr-style-div");var l=i.i(n.createElement)("input",{id:r+"_style",styles:"width:248px;letter-spacing: 0.05px;"});a.appendChild(l),this.createStyleDropDownList(l);var d=this.createDivElement(r+"_indentWholeDiv",o);d.style.display="flex",d.classList.add("e-de-ctnr-segment"),t&&i.i(n.classList)(d,["e-de-ctnr-segment-rtl"],[]);var h=this.createDivElement(r+"_indentDiv",d,"display:flex;"),c="e-de-ctnr-group-btn e-de-char-fmt-btn-left e-btn-group";t&&(c="e-rtl "+c),h.className=c,this.leftAlignment=this.createButtonTemplate(r+"_leftIndent","e-de-ctnr-alignleft e-icons",h,"e-de-prop-indent-button","40.5","Align left Tooltip"),this.centerAlignment=this.createButtonTemplate(r+"_centerIndent","e-de-ctnr-aligncenter e-icons",h,"e-de-prop-indent-button","40.5","Center Tooltip"),this.rightAlignment=this.createButtonTemplate(r+"_rightIndent","e-de-ctnr-alignright e-icons",h,"e-de-prop-indent-button","40.5","Align right Tooltip"),this.justify=this.createButtonTemplate(r+"_justify","e-de-ctnr-justify e-icons",h,"e-de-prop-indent-last-button","40.5","Justify Tooltip");var p="e-de-ctnr-increaseindent e-icons",u="e-de-ctnr-decreaseindent e-icons",g=this.createDivElement(r+"_lineindentDiv",d,"display:flex;");c="e-de-ctnr-group-btn e-de-char-fmt-btn-right e-btn-group",t&&(c="e-rtl "+c,p+=" e-de-flip",u+=" e-de-flip"),g.className=c,this.decreaseIndent=this.createButtonTemplate(r+"_decreaseIndent",u,g,"e-de-prop-indent-button","37","Decrease indent"),this.increaseIndent=this.createButtonTemplate(r+"_increaseIndent",p,g,"e-de-prop-indent-last-button","37","Increase indent");var f=this.createDivElement(r+"_listDiv",o,"display:flex;"),m=this.createDivElement(r+"_paraDiv",o,"display:flex");i.i(n.classList)(f,["e-de-ctnr-segment","e-de-ctnr-group-btn"],[]),i.i(n.classList)(m,["e-de-ctnr-segment","e-de-ctnr-group-btn"],[]),t&&(i.i(n.classList)(f,["e-de-ctnr-segment-rtl","e-de-ctnr-group-btn"],[]),i.i(n.classList)(m,["e-de-ctnr-segment-rtl","e-de-ctnr-group-btn"],[]));var v=i.i(n.createElement)("button",{id:r+"_lineHeight",attrs:{type:"button"}});f.appendChild(v),this.lineSpacing=this.createLineSpacingDropdown(v);var y=this.createDivElement(r+"_listDropDiv",f);i.i(n.classList)(y,["de-split-button","e-de-ctnr-segment-list"],[]),t&&i.i(n.classList)(y,["e-de-ctnr-segment-list-rtl"],[]);var w=i.i(n.createElement)("button",{id:r+"_bullet",attrs:{type:"button"}});y.appendChild(w);var b=i.i(n.createElement)("button",{id:r+"_numberingList",attrs:{type:"button"}});y.appendChild(b);var x="e-de-ctnr-bullets e-icons",C="e-de-ctnr-numbering e-icons";t&&(x+=" e-de-flip",C+=" e-de-flip"),this.createBulletListDropButton(x,w),this.createNumberListDropButton(C,b),this.borders=this.createButtonTemplate(r+"_borders","e-de-ctnr-borders e-icons",m,"e-de-ctnr-group-btn","37","Borders"),this.showHiddenMarks=this.createButtonTemplate(r+"_paraMark","e-de-e-paragraph-mark e-icons",m,"e-de-ctnr-group-btn","37","ShowHiddenMarks Tooltip")},e.prototype.createSeparator=function(e){var t=i.i(n.createElement)("div",{className:"e-de-prop-vline"});e.appendChild(t)},e.prototype.createDivElement=function(e,t,r){var o;return o=r?i.i(n.createElement)("div",{id:e,styles:r}):i.i(n.createElement)("div",{id:e}),t.appendChild(o),o},e.prototype.createButtonTemplate=function(e,t,r,s,a,l){var d=i.i(n.createElement)("Button",{id:e,attrs:{type:"button"}});r.appendChild(d);var h=new o.Button({cssClass:s,iconCss:t});switch(h.appendTo(d),d.setAttribute("title",this.localObj.getConstant(l)),d.setAttribute("aria-label",this.localObj.getConstant(l)),"Decrease indent"!=this.localObj.getConstant(l)&&"Increase indent"!=this.localObj.getConstant(l)&&"Borders"!=this.localObj.getConstant(l)&&d.setAttribute("aria-pressed","false"),l){case"Align left Tooltip":this.leftAlignmentBtn=h;break;case"Align right Tooltip":this.rightAlignmentBtn=h;break;case"Justify Tooltip":this.justifyBtn=h;break;case"Decrease indent":this.decreaseIndentBtn=h;break;case"Increase indent":this.increaseIndentBtn=h;break;case"Borders":this.bordersBtn=h;break;case"ShowHiddenMarks Tooltip":this.showHiddenMarksBtn=h;break;default:this.centerAlignmentBtn=h}return d},e.prototype.createLineSpacingDropdown=function(e){var t=this,i=[{text:this.localObj.getConstant("Single")},{text:"1.15"},{text:"1.5"},{text:this.localObj.getConstant("Double")}],n=new s.DropDownButton({items:i,iconCss:"e-de-ctnr-linespacing e-icons",enableRtl:this.isRtl,select:this.lineSpacingAction.bind(this),cssClass:this.splitButtonClass,beforeItemRender:function(e){e.element.innerHTML="<span></span>"+e.item.text;var i=e.element.children[0];e.item.text===t.appliedLineSpacing?(i.style.marginRight="10px",i.setAttribute("class","e-de-selected-item e-icons e-de-linespacing")):(e.element.children[0].style.marginRight="25px",e.element.children[0].classList.remove("e-de-selected-item"))}});return n.appendTo(e),e.setAttribute("title",this.localObj.getConstant("Line spacing")),n},e.prototype.createNumberListDropButton=function(e,t){var r=this,o=i.i(n.createElement)("div",{id:"target",styles:"width: 211px;height: auto;display:none"}),a=i.i(n.createElement)("ul",{styles:"display: block; outline: 0px;",id:"listMenu",className:"e-de-floating-menu e-de-bullets-menu e-de-list-container e-de-list-thumbnail"});o.appendChild(a),this.noneNumberTag=this.createNumberNoneListTag(a),this.noneNumberTag.addEventListener("click",this.numberedNoneClick.bind(this)),this.numberList=this.createNumberListTag(a,"1.","2.","3."),this.numberList.addEventListener("click",this.numberedNumberDotClick.bind(this)),this.lowLetter=this.createNumberListTag(a,"a.","b.","c."),this.lowLetter.addEventListener("click",this.numberedLowLetterClick.bind(this)),this.upLetter=this.createNumberListTag(a,"A.","B.","C."),this.upLetter.addEventListener("click",this.numberedUpLetterClick.bind(this)),this.lowRoman=this.createNumberListTag(a,"i.","ii.","iii."),this.lowRoman.addEventListener("click",this.numberedLowRomanClick.bind(this)),this.upRoman=this.createNumberListTag(a,"I.","II.","III."),this.upRoman.addEventListener("click",this.numberedUpRomanClick.bind(this));var l={target:o,iconCss:e,cssClass:this.splitButtonClass,beforeOpen:function(){o.style.display="block";var e="None";if(!i.i(n.isNullOrUndefined)(r.documentEditor.selection.paragraphFormat))if(i.i(n.isNullOrUndefined)(r.documentEditor.selection.paragraphFormat.listId)||-1==r.documentEditor.selection.paragraphFormat.listId)e="None";else{var t=r.documentEditor.documentHelper.getListById(r.documentEditor.selection.paragraphFormat.listId),s=r.documentEditor.documentHelper.getAbstractListById(t.abstractListId),a=s.levels[r.documentEditor.selection.paragraphFormat.listLevelNumber];e=a.listLevelPattern}r.updateSelectedNumberedListType(e)},beforeClose:function(){o.style.display="none",r.removeSelectedList()}};this.numberedListBtn=new s.SplitButton(l),this.numberedListBtn.click=function(){r.applyLastAppliedNumbering()},this.numberedListBtn.appendTo(t),t.parentElement.setAttribute("title",this.localObj.getConstant("Numbering")),t.parentElement.setAttribute("aria-label",this.localObj.getConstant("Numbering"))},e.prototype.updateSelectedBulletListType=function(e){switch(e){case String.fromCharCode(61623):this.dotBullet.classList.add("de-list-item-selected");break;case String.fromCharCode(61551)+String.fromCharCode(32):this.circleBullet.classList.add("de-list-item-selected");break;case String.fromCharCode(61607):this.squareBullet.classList.add("de-list-item-selected");break;case String.fromCharCode(61558):this.flowerBullet.classList.add("de-list-item-selected");break;case String.fromCharCode(61656):this.arrowBullet.classList.add("de-list-item-selected");break;case String.fromCharCode(61692):this.tickBullet.classList.add("de-list-item-selected");break;default:this.noneBulletTag.classList.add("de-list-item-selected")}},e.prototype.updateSelectedNumberedListType=function(e){switch(e){case"Arabic":this.numberList.classList.add("de-list-item-selected");break;case"UpRoman":this.upRoman.classList.add("de-list-item-selected");break;case"UpLetter":this.upLetter.classList.add("de-list-item-selected");break;case"LowLetter":this.lowLetter.classList.add("de-list-item-selected");break;case"LowRoman":this.lowRoman.classList.add("de-list-item-selected");break;default:this.noneNumberTag.classList.add("de-list-item-selected")}},e.prototype.removeSelectedList=function(){var e="de-list-item-selected";this.noneNumberTag.classList.remove(e),this.numberList.classList.remove(e),this.lowLetter.classList.remove(e),this.upLetter.classList.remove(e),this.lowRoman.classList.remove(e),this.upRoman.classList.remove(e),this.noneBulletTag.classList.remove(e),this.dotBullet.classList.remove(e),this.circleBullet.classList.remove(e),this.squareBullet.classList.remove(e),this.flowerBullet.classList.remove(e),this.arrowBullet.classList.remove(e),this.tickBullet.classList.remove(e)},e.prototype.applyLastAppliedNumbering=function(){switch(this.appliedNumberingStyle){case"arabic":this.numberedNumberDotClick();break;case"lowletter":this.numberedLowLetterClick();break;case"upletter":this.numberedUpLetterClick();break;case"lowroman":this.numberedLowRomanClick();break;case"uproman":this.numberedUpRomanClick()}},e.prototype.applyLastAppliedBullet=function(){switch(this.appliedBulletStyle){case"dot":this.bulletDotClick();break;case"circle":this.bulletCircleClick();break;case"square":this.bulletSquareClick();break;case"arrow":this.bulletArrowClick();break;case"tick":this.bulletTickClick();break;case"flower":this.bulletFlowerClick()}},e.prototype.createBulletListDropButton=function(e,t){var r=this,o=i.i(n.createElement)("div",{id:"bullet_list",styles:"width: 196px;height: auto;display:none"}),a=i.i(n.createElement)("ul",{styles:"display: block; outline: 0px;",id:"listMenu",className:"e-de-floating-menu e-de-bullets-menu e-de-list-container e-de-list-thumbnail"});o.appendChild(a),this.noneBulletTag=this.createBulletListTag(a,"e-de-ctnr-bullet-none e-icons e-de-ctnr-list",!0),this.noneBulletTag.addEventListener("click",this.numberedNoneClick.bind(this)),this.dotBullet=this.createBulletListTag(a,"e-de-ctnr-bullet-dot e-icons e-de-ctnr-list",!1),this.dotBullet.addEventListener("click",this.bulletDotClick.bind(this)),this.circleBullet=this.createBulletListTag(a,"e-de-ctnr-bullet-circle e-icons e-de-ctnr-list",!1),this.circleBullet.addEventListener("click",this.bulletCircleClick.bind(this)),this.squareBullet=this.createBulletListTag(a,"e-de-ctnr-bullet-square e-icons e-de-ctnr-list",!1),this.squareBullet.addEventListener("click",this.bulletSquareClick.bind(this)),this.flowerBullet=this.createBulletListTag(a,"e-de-ctnr-bullet-flower e-icons e-de-ctnr-list",!1),this.flowerBullet.addEventListener("click",this.bulletFlowerClick.bind(this)),this.arrowBullet=this.createBulletListTag(a,"e-de-ctnr-bullet-arrow e-icons e-de-ctnr-list",!1),this.arrowBullet.addEventListener("click",this.bulletArrowClick.bind(this)),this.tickBullet=this.createBulletListTag(a,"e-de-ctnr-bullet-tick e-icons e-de-ctnr-list",!1),this.tickBullet.addEventListener("click",this.bulletTickClick.bind(this));var l={target:o,iconCss:e,cssClass:this.splitButtonClass,beforeOpen:function(){o.style.display="block",r.updateSelectedBulletListType(r.documentEditor.selection.paragraphFormat.listText)},beforeClose:function(){o.style.display="none",r.removeSelectedList()}};this.bulletListBtn=new s.SplitButton(l),this.bulletListBtn.click=function(){r.applyLastAppliedBullet()},this.bulletListBtn.appendTo(t),t.parentElement.setAttribute("title",this.localObj.getConstant("Bullets")),t.parentElement.setAttribute("aria-label",this.localObj.getConstant("Bullets"))},e.prototype.createNumberListTag=function(e,t,r,o){var s=i.i(n.createElement)("li",{styles:"display:block",className:"e-de-floating-menuitem e-de-floating-menuitem-md e-de-list-items  e-de-list-item-size"});e.appendChild(s);var a="<div>"+t+'<span class="e-de-list-line"></span></div><div>'+r+'<span class="e-de-list-line">';a+="</span></div><div>"+o+'<span class="e-de-list-line"> </span></div >';var l=i.i(n.createElement)("div",{className:"e-de-list-header-presetmenu",innerHTML:a});return s.appendChild(l),s},e.prototype.createNumberNoneListTag=function(e){var t=i.i(n.createElement)("li",{styles:"display:block;",className:"e-de-floating-menuitem e-de-floating-menuitem-md e-de-list-items  e-de-list-item-size"});e.appendChild(t);var r='<div><span class="e-de-bullets">'+this.localObj.getConstant("None")+"</span></div>",o=i.i(n.createElement)("div",{className:"e-de-list-header-presetmenu",styles:"position:relative;left:11px;top:13px",innerHTML:r});return t.appendChild(o),t},e.prototype.createBulletListTag=function(e,t,r){var o=i.i(n.createElement)("li",{styles:"display:block;",className:"e-de-floating-menuitem e-de-floating-bullet-menuitem-md e-de-list-items  e-de-list-item-size"});e.appendChild(o);var s=i.i(n.createElement)("div",{className:"e-de-bullet-list-header-presetmenu"}),a=i.i(n.createElement)("div",{styles:r?"font-size:8px;text-align: center;top: 8px;line-height:normal":""});s.appendChild(a);var l=i.i(n.createElement)("span",{className:r?"":t});return a.appendChild(l),r&&(s.style.display="inline-table",l.textContent=this.localObj.getConstant("None")),o.appendChild(s),o},e.prototype.createStyleDropDownList=function(e){var t=this;this.style=new r.ComboBox({dataSource:[{StyleName:"Normal",IconClass:"e-de-e-paragraph-mark e-icons"}],cssClass:"e-de-prop-dropdown",popupHeight:"240px",enableRtl:this.isRtl,allowFiltering:!0,query:(new a.Query).select(["StyleName","Style","IconClass"]),fields:{text:"StyleName",value:"StyleName"},showClearButton:!1,change:this.selectStyleValue.bind(this)});var o="";this.container.enableCsp||(this.style.open=this.updateOptions.bind(this),o=this.isRtl?i.i(n.initializeCSPTemplate)(function(e){return'<span style="'+e.Style+'">'+e.StyleName+'</span><span class="'+e.IconClass+'"></span>'}):i.i(n.initializeCSPTemplate)(function(e){return'<span class="'+e.IconClass+'"></span><span style="'+e.Style+'">'+e.StyleName+"</span>"}),this.style.itemTemplate=o,this.style.footerTemplate='<span class="e-de-ctnr-dropdown-ftr">'+this.localObj.getConstant("Manage Styles")+"...</span>",this.style.isStringTemplate=!0),this.style.appendTo(e),this.style.focus=function(){t.isRetrieving=!1,t.style.element.select()},e.parentElement.setAttribute("title",this.localObj.getConstant("Styles"))},e.prototype.updateOptions=function(e){e.popup.element.getElementsByClassName("e-de-ctnr-dropdown-ftr")[0].addEventListener("click",this.createStyle.bind(this))},e.prototype.updateStyleNames=function(){this.styleName=i.i(n.isNullOrUndefined)(this.style.itemData)?void 0:this.style.itemData.StyleName;for(var e=this.documentEditor.documentHelper.stylesMap,t=e.get("Paragraph")?e.get("Paragraph"):[],r=e.get("Linked")?e.get("Linked"):[],o=e.get("Character")?e.get("Character"):[],s=0,a=r;s<a.length;s++)for(var l=a[s],d=0;d<o.length;d++){var h=o[d];if(l.StyleName+" Char"===h.StyleName){o.splice(d,1);break}}this.style.dataSource=t.concat(r,o),this.onSelectionChange()},e.prototype.createStyle=function(){this.style.hidePopup(),this.documentEditor.isReadOnly||this.documentEditor.showDialog("Styles")},e.prototype.constructStyleDropItems=function(e){for(var t=[],i=0,n=e;i<n.length;i++){var r=n[i],o={},s=this.localObj.getConstant(r.name);o.StyleName=""===s?r.name:s,o.Style=this.parseStyle(r.style),"Paragraph"==r.type?o.IconClass="e-list-icon e-de-listview-icon e-de-e-paragraph-style-mark e-icons":"Character"==r.type?o.IconClass="e-list-icon e-de-listview-icon e-de-e-character-style-mark e-icons":o.IconClass="e-list-icon e-de-listview-icon e-de-e-linked-style-mark e-icons",t.push(o)}return t},e.prototype.parseStyle=function(e){var t="",r=JSON.parse(e),o="";if(!i.i(n.isNullOrUndefined)(r.characterFormat.baselineAlignment)&&"Normal"!==r.characterFormat.baselineAlignment){var s="";switch(r.characterFormat.baselineAlignment){case"Superscript":s="super";break;case"Subscript":s="sub"}s.length>1&&(t+="vertical-align:"+s+";")}return i.i(n.isNullOrUndefined)(r.characterFormat.underline)||"None"===r.characterFormat.underline||(o+="underline "),i.i(n.isNullOrUndefined)(r.characterFormat.strikethrough)||"None"===r.characterFormat.strikethrough||(o+="line-through "),i.i(n.isNullOrUndefined)(r.characterFormat.fontSize)||(t+="font-size:"+r.characterFormat.fontSize+"px;"),i.i(n.isNullOrUndefined)(r.characterFormat.fontFamily)||(t+="font-family:"+r.characterFormat.fontFamily+";"),!i.i(n.isNullOrUndefined)(r.characterFormat.bold)&&r.characterFormat.bold&&(t+="font-weight:bold;"),!i.i(n.isNullOrUndefined)(r.characterFormat.italic)&&r.characterFormat.italic&&(t+="font-style:italic;"),o.length>1&&(t+="text-decoration:"+o+";"),t},e.prototype.wireEvent=function(){var e=this;this.leftAlignment.addEventListener("click",function(){e.leftAlignmentAction()}),this.rightAlignment.addEventListener("click",function(){e.rightAlignmentAction()}),this.centerAlignment.addEventListener("click",function(){e.centerAlignmentAction()}),this.justify.addEventListener("click",function(){e.justifyAction()}),this.increaseIndent.addEventListener("click",function(){e.increaseIndentAction()}),this.showHiddenMarks.addEventListener("click",function(){e.container.documentEditorSettings.showHiddenMarks=!e.container.documentEditorSettings.showHiddenMarks,e.toggleHiddenMarks(),setTimeout(function(){e.documentEditor.focusIn()},30)}),this.decreaseIndent.addEventListener("click",function(){e.decreaseIndentAction()}),this.lineSpacing.addEventListener("select",function(t){e.lineSpacingAction(t)}),this.borders.addEventListener("click",function(){e.documentEditor.showBordersAndShadingDialog()})},e.prototype.unwireEvents=function(){this.leftAlignment.click=void 0,this.rightAlignment.click=void 0,this.centerAlignment.click=void 0,this.justify.click=void 0,this.increaseIndent.click=void 0,this.decreaseIndent.click=void 0,this.lineSpacing.select=void 0,this.style.select=void 0},e.prototype.toggleHiddenMarks=function(){this.container.documentEditorSettings.showHiddenMarks?(i.i(n.classList)(this.showHiddenMarks,["e-btn-toggle"],[]),this.showHiddenMarks.setAttribute("aria-pressed","true")):(i.i(n.classList)(this.showHiddenMarks,[],["e-btn-toggle"]),this.showHiddenMarks.setAttribute("aria-pressed","false"))},e.prototype.leftAlignmentAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editor&&(this.documentEditor.editor.toggleTextAlignment("Left"),this.documentEditor.focusIn())},e.prototype.lineSpacingAction=function(e){var t=this;if(!this.isRetrieving){switch(e.item.text){case this.localObj.getConstant("Single"):this.documentEditor.selection.paragraphFormat.lineSpacing=1;break;case"1.15":this.documentEditor.selection.paragraphFormat.lineSpacing=1.15;break;case"1.5":this.documentEditor.selection.paragraphFormat.lineSpacing=1.5;break;case this.localObj.getConstant("Double"):this.documentEditor.selection.paragraphFormat.lineSpacing=2}setTimeout(function(){t.documentEditor.focusIn()},30)}},e.prototype.setLineSpacing=function(){var e=this.documentEditor.selection.paragraphFormat.lineSpacing;this.appliedLineSpacing=1===e?this.localObj.getConstant("Single"):1.15===e?"1.15":1.5===e?"1.5":2===e?this.localObj.getConstant("Double"):""},e.prototype.selectStyleValue=function(e){var t=this;!this.isRetrieving&&e.isInteracted&&setTimeout(function(){t.applyStyleValue(e)},10)},e.prototype.applyStyleValue=function(e){if(!this.documentEditor.isReadOnly&&this.documentEditor.editor){var t=this.documentEditor.stylesDialogModule.getStyleName(n.SanitizeHtmlHelper.sanitize(e.itemData.StyleName));i.i(n.isNullOrUndefined)(this.documentEditor.documentHelper.styles.findByName(t))||this.documentEditor.editor.applyStyle(t,!0)}},e.prototype.rightAlignmentAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editor&&(this.documentEditor.editor.toggleTextAlignment("Right"),this.documentEditor.focusIn())},e.prototype.centerAlignmentAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editor&&(this.documentEditor.editor.toggleTextAlignment("Center"),this.documentEditor.focusIn())},e.prototype.justifyAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editor&&(this.documentEditor.editor.toggleTextAlignment("Justify"),this.documentEditor.focusIn())},e.prototype.increaseIndentAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editor&&(this.documentEditor.editor.increaseIndent(),this.documentEditor.focusIn())},e.prototype.decreaseIndentAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editor&&(this.documentEditor.editor.decreaseIndent(),this.documentEditor.focusIn())},e.prototype.numberedNoneClick=function(){var e=this;this.isRetrieving||this.documentEditor.editor&&(this.documentEditor.editor.clearList(),setTimeout(function(){e.documentEditor.focusIn()},30))},e.prototype.numberedNumberDotClick=function(){var e=this;this.isRetrieving||this.documentEditor.editor&&(this.appliedNumberingStyle="arabic",this.documentEditor.editor.applyNumbering(this.getLevelFormatNumber(),"Arabic"),setTimeout(function(){e.documentEditor.focusIn()},30))},e.prototype.numberedUpRomanClick=function(){var e=this;this.isRetrieving||this.documentEditor.editor&&(this.appliedNumberingStyle="uproman",this.documentEditor.editor.applyNumbering(this.getLevelFormatNumber(),"UpRoman"),setTimeout(function(){e.documentEditor.focusIn()},30))},e.prototype.numberedUpLetterClick=function(){var e=this;this.isRetrieving||this.documentEditor.editor&&(this.appliedNumberingStyle="upletter",this.documentEditor.editor.applyNumbering(this.getLevelFormatNumber(),"UpLetter"),setTimeout(function(){e.documentEditor.focusIn()},30))},e.prototype.numberedLowLetterClick=function(){var e=this;this.isRetrieving||this.documentEditor.editor&&(this.appliedNumberingStyle="lowletter",this.documentEditor.editor.applyNumbering(this.getLevelFormatNumber(),"LowLetter"),setTimeout(function(){e.documentEditor.focusIn()},30))},e.prototype.numberedLowRomanClick=function(){var e=this;this.isRetrieving||this.documentEditor.editor&&(this.appliedNumberingStyle="lowroman",this.documentEditor.editor.applyNumbering(this.getLevelFormatNumber(),"LowRoman"),setTimeout(function(){e.documentEditor.focusIn()},30))},e.prototype.getLevelFormatNumber=function(){var e="%";return e=e+((this.documentEditor.selection.paragraphFormat.listLevelNumber<=0?0:this.documentEditor.selection.paragraphFormat.listLevelNumber)+1)+"."},e.prototype.bulletDotClick=function(){var e=this;this.isRetrieving||this.documentEditor.editor&&(this.appliedBulletStyle="dot",this.documentEditor.editor.applyBullet(String.fromCharCode(61623),"Symbol"),setTimeout(function(){e.documentEditor.focusIn()},30))},e.prototype.bulletCircleClick=function(){var e=this;this.isRetrieving||this.documentEditor.editor&&(this.appliedBulletStyle="circle",this.documentEditor.editor.applyBullet(String.fromCharCode(61551)+String.fromCharCode(32),"Symbol"),setTimeout(function(){e.documentEditor.focusIn()},30))},e.prototype.bulletSquareClick=function(){var e=this;this.isRetrieving||this.documentEditor.editor&&(this.appliedBulletStyle="square",this.documentEditor.editor.applyBullet(String.fromCharCode(61607),"Wingdings"),setTimeout(function(){e.documentEditor.focusIn()},30))},e.prototype.bulletFlowerClick=function(){var e=this;this.isRetrieving||this.documentEditor.editor&&(this.appliedBulletStyle="flower",this.documentEditor.editor.applyBullet(String.fromCharCode(61558),"Wingdings"),setTimeout(function(){e.documentEditor.focusIn()},30))},e.prototype.bulletArrowClick=function(){var e=this;this.isRetrieving||this.documentEditor.editor&&(this.appliedBulletStyle="arrow",this.documentEditor.editor.applyBullet(String.fromCharCode(61656),"Wingdings"),setTimeout(function(){e.documentEditor.focusIn()},30))},e.prototype.bulletTickClick=function(){var e=this;this.isRetrieving||this.documentEditor.editor&&(this.appliedBulletStyle="tick",this.documentEditor.editor.applyBullet(String.fromCharCode(61692),"Wingdings"),setTimeout(function(){e.documentEditor.focusIn()},30))},e.prototype.onSelectionChange=function(){if(this.isRetrieving=!0,this.documentEditor.editor){var e=this.documentEditor.selection.characterFormat.styleName;if("Default Paragraph Font"===this.documentEditor.selection.characterFormat.styleName&&(e=this.documentEditor.selection.paragraphFormat.styleName),e){var t=this.localObj.getConstant(e);this.style.value=i.i(n.isNullOrUndefined)(t)||""==t?e:t}else this.style.value=null;i.i(n.classList)(this.leftAlignment,[],["e-btn-toggle"]),i.i(n.classList)(this.rightAlignment,[],["e-btn-toggle"]),i.i(n.classList)(this.centerAlignment,[],["e-btn-toggle"]),i.i(n.classList)(this.justify,[],["e-btn-toggle"]),"Left"===this.documentEditor.selection.paragraphFormat.textAlignment?(i.i(n.classList)(this.leftAlignment,["e-btn-toggle"],[]),this.leftAlignment.setAttribute("aria-pressed","true"),this.rightAlignment.setAttribute("aria-pressed","false"),this.centerAlignment.setAttribute("aria-pressed","false"),this.justify.setAttribute("aria-pressed","false")):"Right"===this.documentEditor.selection.paragraphFormat.textAlignment?(i.i(n.classList)(this.rightAlignment,["e-btn-toggle"],[]),this.leftAlignment.setAttribute("aria-pressed","false"),this.rightAlignment.setAttribute("aria-pressed","true"),this.centerAlignment.setAttribute("aria-pressed","false"),this.justify.setAttribute("aria-pressed","false")):"Center"===this.documentEditor.selection.paragraphFormat.textAlignment?(i.i(n.classList)(this.centerAlignment,["e-btn-toggle"],[]),this.leftAlignment.setAttribute("aria-pressed","false"),this.rightAlignment.setAttribute("aria-pressed","false"),this.centerAlignment.setAttribute("aria-pressed","true"),this.justify.setAttribute("aria-pressed","false")):"Justify"===this.documentEditor.selection.paragraphFormat.textAlignment&&(i.i(n.classList)(this.justify,["e-btn-toggle"],[]),this.leftAlignment.setAttribute("aria-pressed","false"),this.rightAlignment.setAttribute("aria-pressed","false"),this.centerAlignment.setAttribute("aria-pressed","false"),this.justify.setAttribute("aria-pressed","true")),this.toggleHiddenMarks()}this.setLineSpacing(),this.isRetrieving=!1},e.prototype.destroy=function(){this.container=void 0,this.lineSpacing&&(this.lineSpacing.destroy(),this.lineSpacing=void 0),this.style&&(this.style.destroy(),this.style=void 0),this.bulletListBtn&&(this.bulletListBtn.destroy(),this.bulletListBtn=void 0),this.numberedListBtn&&(this.numberedListBtn.destroy(),this.numberedListBtn=void 0),this.leftAlignmentBtn&&(this.leftAlignmentBtn.destroy(),this.leftAlignmentBtn=void 0),this.rightAlignmentBtn&&(this.rightAlignmentBtn.destroy(),this.rightAlignmentBtn=void 0),this.centerAlignmentBtn&&(this.centerAlignmentBtn.destroy(),this.centerAlignmentBtn=void 0),this.showHiddenMarksBtn&&(this.showHiddenMarksBtn.destroy(),this.showHiddenMarksBtn=void 0),this.justifyBtn&&(this.justifyBtn.destroy(),this.justifyBtn=void 0),this.decreaseIndentBtn&&(this.decreaseIndentBtn.destroy(),this.decreaseIndentBtn=void 0),this.increaseIndentBtn&&(this.increaseIndentBtn.destroy(),this.increaseIndentBtn=void 0),this.bordersBtn&&(this.bordersBtn.destroy(),this.bordersBtn=void 0),this.showHiddenMarksBtn&&(this.showHiddenMarksBtn.destroy(),this.showHiddenMarksBtn=void 0)},e}())},function(e,t,i){"use strict";i.d(t,"a",function(){return s});var n=i(0),r=(i.n(n),i(19)),o=(i.n(r),i(3)),s=(i.n(o),function(){function e(e,t){this.startPage=1,this.statusBarDiv=e,this.container=t,this.initializeStatusBar(),this.wireEvents()}return Object.defineProperty(e.prototype,"documentEditor",{get:function(){return this.container?this.container.documentEditor:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"editorPageCount",{get:function(){return this.documentEditor?this.documentEditor.pageCount:1},enumerable:!0,configurable:!0}),e.prototype.initializeStatusBar=function(){var e=this,t=this.container.enableRtl;this.documentEditor.enableSpellCheck=!!this.container.enableSpellCheck,this.localObj=new n.L10n("documenteditorcontainer",this.container.defaultLocale,this.container.locale);var o=t?"padding-right:16px":"padding-left:16px",s=i.i(n.createElement)("div",{className:this.container.enableSpellCheck?"e-de-ctnr-pg-no":"e-de-ctnr-pg-no-spellout",styles:o});this.statusBarDiv.appendChild(s);var a=i.i(n.createElement)("span");a.textContent=this.localObj.getConstant("Page")+" ",s.appendChild(a),this.pageNumberInput=i.i(n.createElement)("input",{styles:"text-transform:capitalize;white-space:pre;overflow:hidden;user-select:none;cursor:text",attrs:{type:"text","aria-label":this.localObj.getConstant("Current Page Number")},className:"e-de-pagenumber-input"}),this.editablePageNumber=i.i(n.createElement)("div",{styles:"display: inline-flex",className:"e-input e-de-pagenumber-text"}),this.editablePageNumber.appendChild(this.pageNumberInput);var l="";t?(a.style.marginLeft="6px",this.editablePageNumber.style.marginLeft="6px",l="padding-left:5px"):(a.style.marginRight="6px",this.editablePageNumber.style.marginRight="6px",l="padding-right:5px"),this.updatePageNumber(),s.appendChild(this.editablePageNumber),this.editablePageNumber.setAttribute("title",this.localObj.getConstant("Current Page Number"));var d=i.i(n.createElement)("span",{styles:l});if(d.textContent=" "+this.localObj.getConstant("of")+" ",s.appendChild(d),this.pageCount=i.i(n.createElement)("span"),s.appendChild(this.pageCount),this.updatePageCount(),this.documentEditor.enableSpellCheck){var h=i.i(n.createElement)("div",{className:"e-de-statusbar-separator"});this.statusBarDiv.appendChild(h);var c=this.addSpellCheckElement();this.spellCheckButton.appendTo(c)}this.pageButton=this.createButtonTemplate(this.container.enableSpellCheck?"e-de-statusbar-pageweb e-btn-pageweb-spellcheck":"e-de-statusbar-pageweb","e-de-printlayout e-icons","Print layout",this.statusBarDiv,this.pageButton,"Pages"===this.documentEditor.layoutType),this.webButton=this.createButtonTemplate("e-de-statusbar-pageweb","e-de-weblayout e-icons","Web layout",this.statusBarDiv,this.webButton,"Continuous"===this.documentEditor.layoutType),this.pageButton.addEventListener("click",function(){e.documentEditor.layoutType="Pages",e.addRemoveClass(e.pageButton,e.webButton),e.documentEditor.focusIn()}),this.webButton.addEventListener("click",function(){e.documentEditor.layoutType="Continuous",e.addRemoveClass(e.webButton,e.pageButton),e.documentEditor.focusIn()});var p=i.i(n.createElement)("button",{className:"e-de-statusbar-zoom",attrs:{type:"button"}});this.statusBarDiv.appendChild(p),p.setAttribute("title",this.localObj.getConstant("ZoomLevelTooltip"));var u=[{text:"200%"},{text:"175%"},{text:"150%"},{text:"125%"},{text:"100%"},{text:"75%"},{text:"50%"},{text:"25%"},{separator:!0},{text:this.localObj.getConstant("Fit one page")},{text:this.localObj.getConstant("Fit page width")}];this.zoom=new r.DropDownButton({content:"100%",items:u,enableRtl:this.container.enableRtl,select:this.onZoom.bind(this)}),this.zoom.isStringTemplate=!0,this.zoom.appendTo(p)},e.prototype.addSpellCheckElement=function(){var e=this,t=i.i(n.createElement)("button",{className:"e-de-statusbar-spellcheck"});this.statusBarDiv.appendChild(t),t.setAttribute("title","Spell Checker options");var o=[{text:this.localObj.getConstant("Spell Check")},{text:this.localObj.getConstant("Underline errors")}];return this.spellCheckButton=new r.DropDownButton({content:this.localObj.getConstant("Spelling"),items:o,enableRtl:this.container.enableRtl,select:this.onSpellCheck.bind(this),beforeItemRender:function(t){t.element.innerHTML="<span></span>"+t.item.text,i.i(n.isNullOrUndefined)(e.currentLanguage)&&(e.currentLanguage=e.documentEditor.spellChecker.languageID),i.i(n.isNullOrUndefined)(e.allowSuggestion)&&(e.allowSuggestion=e.documentEditor.spellChecker.allowSpellCheckAndSuggestion);var r=t.element.children[0];t.item.text===e.localObj.getConstant("Spell Check")&&e.documentEditor.enableSpellCheck&&e.documentEditor.spellChecker.enableSpellCheck?(r.style.marginRight="10px",r.setAttribute("class","e-de-selected-spellcheck-item")):t.item.text===e.localObj.getConstant("Underline errors")&&e.documentEditor.enableSpellCheck&&e.documentEditor.spellChecker.enableSpellCheck&&!e.documentEditor.spellChecker.removeUnderline?(r.style.marginRight="10px",r.setAttribute("class","e-de-selected-underline-item")):(r.style.marginRight="25px",t.element.children[0].classList.remove("e-de-selected-spellcheck-item"),t.element.children[0].classList.remove("e-de-selected-underline-item"))}}),t},e.prototype.onZoom=function(e){this.setZoomValue(e.item.text),this.updateZoomContent()},e.prototype.onSpellCheck=function(e){this.setSpellCheckValue(e.item.text)},e.prototype.updateZoomContent=function(){this.zoom.content=Math.round(100*this.documentEditor.zoomFactor)+"%"},e.prototype.setSpellCheckValue=function(e){this.spellCheckButton.content=this.localObj.getConstant("Spelling"),e.match(this.localObj.getConstant("Spell Check"))?(this.documentEditor.spellChecker.enableSpellCheck=!this.documentEditor.spellChecker.enableSpellCheck,this.documentEditor.documentHelper.triggerSpellCheck=!1,this.documentEditor.documentHelper.triggerElementsOnLoading=!1):e.match(this.localObj.getConstant("Underline errors"))&&this.documentEditor.enableSpellCheck&&this.documentEditor.spellChecker.enableSpellCheck&&(this.documentEditor.spellChecker.removeUnderline=!this.documentEditor.spellChecker.removeUnderline)},e.prototype.setZoomValue=function(e){e.match(this.localObj.getConstant("Fit one page"))?this.documentEditor.fitPage("FitOnePage"):e.match(this.localObj.getConstant("Fit page width"))?this.documentEditor.fitPage("FitPageWidth"):this.documentEditor.zoomFactor=parseInt(e,10)/100},e.prototype.updatePageCount=function(){this.pageCount.textContent=this.editorPageCount.toString()},e.prototype.updatePageNumber=function(){this.pageNumberInput.value=this.startPage.toString(),this.updatePageNumberWidth()},e.prototype.updatePageNumberOnViewChange=function(e){this.documentEditor.selection&&this.documentEditor.selection.startPage>=e.startPage&&this.documentEditor.selection.startPage<=e.endPage?this.startPage=this.documentEditor.selection.startPage:this.startPage=e.startPage,this.updatePageNumber(),this.updatePageCount()},e.prototype.wireEvents=function(){var e=this;this.pageNumberInput.addEventListener("keydown",function(t){if(13===t.which){t.preventDefault();parseInt(e.pageNumberInput.value,10)>e.editorPageCount?e.updatePageNumber():e.documentEditor.selection?(e.documentEditor.selection.goToPage(parseInt(e.pageNumberInput.value,10)),e.documentEditor.focusIn()):e.documentEditor.scrollToPage(parseInt(e.pageNumberInput.value,10)),e.pageNumberInput.contentEditable="false",""===e.pageNumberInput.value&&e.updatePageNumber()}t.which>64&&t.preventDefault()}),this.pageNumberInput.addEventListener("keyup",function(){e.updatePageNumberWidth()}),this.pageNumberInput.addEventListener("blur",function(){(""===e.pageNumberInput.value||parseInt(e.pageNumberInput.value,10)>e.editorPageCount)&&e.updatePageNumber(),e.pageNumberInput.contentEditable="false"}),this.pageNumberInput.addEventListener("focus",function(){e.pageNumberInput.select()})},e.prototype.updatePageNumberWidth=function(){this.pageNumberInput&&(this.pageNumberInput.style.width=this.pageNumberInput.value.length>=3?"30px":"22px")},e.prototype.toggleWebLayout=function(){this.addRemoveClass(this.pageButton,this.webButton)},e.prototype.togglePageLayout=function(){this.addRemoveClass(this.webButton,this.pageButton)},e.prototype.addRemoveClass=function(e,t){e.classList.add("e-btn-toggle"),t.classList.contains("e-btn-toggle")&&t.classList.remove("e-btn-toggle")},e.prototype.createButtonTemplate=function(e,t,r,s,a,l){a=i.i(n.createElement)("Button",{className:e,attrs:{type:"button"}}),s.appendChild(a);var d=new o.Button({cssClass:e,iconCss:t,enableRtl:this.container.enableRtl});return!0===l&&a.classList.add("e-btn-toggle"),d.appendTo(a),a.setAttribute("title",this.localObj.getConstant(r)),"Web layout"===r?this.webBtn=d:this.pageBtn=d,a},e.prototype.destroy=function(){this.zoom&&(this.zoom.destroy(),this.zoom=void 0),this.spellCheckButton&&(this.spellCheckButton.destroy(),this.spellCheckButton=void 0),this.pageBtn&&(this.pageBtn.destroy(),this.pageBtn=void 0),this.webBtn&&(this.webBtn.destroy(),this.webBtn=void 0),this.pageButton=void 0,this.webButton=void 0,this.pageNumberInput=void 0,this.statusBarDiv=void 0,this.pageCount=void 0,this.editablePageNumber=void 0,this.localObj=void 0,this.container=void 0},e}())},function(e,t,i){"use strict";i.d(t,"a",function(){return s});var n=i(0),r=(i.n(n),i(3)),o=(i.n(r),i(10)),s=(i.n(o),function(){function e(e,t){this.container=e,this.elementId=this.documentEditor.element.id,this.isRtl=t,this.initializeTocPane()}return Object.defineProperty(e.prototype,"documentEditor",{get:function(){return this.container.documentEditor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"toolbar",{get:function(){return this.container.toolbarModule},enumerable:!0,configurable:!0}),e.prototype.enableDisableElements=function(e){e?i.i(n.classList)(this.element,[],["e-de-overlay"]):i.i(n.classList)(this.element,["e-de-overlay"],[])},e.prototype.initializeTocPane=function(){this.localObj=new n.L10n("documenteditorcontainer",this.container.defaultLocale,this.container.locale),this.element=i.i(n.createElement)("div",{id:this.elementId+"_tocProperties",className:"e-de-prop-pane"});var e=i.i(n.createElement)("div",{className:"e-de-cntr-pane-padding e-de-prop-separator-line"});this.tocHeaderDiv(e),this.initTemplates(e),e=i.i(n.createElement)("div",{className:"e-de-cntr-pane-padding"}),this.tocOptionsDiv(e),this.contentStylesDropdown(e),this.checkboxContent(e),this.buttonDiv(e),this.wireEvents(),this.updateTocProperties(),this.container.propertiesPaneContainer.appendChild(this.element)},e.prototype.updateTocProperties=function(){this.rightalignPageNumber.checked=!0,this.showPageNumber.checked=!0,this.hyperlink.checked=!0},e.prototype.wireEvents=function(){var e=this;this.cancelBtn.element.addEventListener("click",function(){e.onClose()}),this.updateBtn.element.addEventListener("click",this.onInsertToc.bind(this)),this.closeButton.addEventListener("click",function(){e.onClose()})},e.prototype.onClose=function(){this.container.showPropertiesPane&&"TableOfContents"!==this.container.previousContext?this.container.showPropertiesPaneOnSelection():(this.showTocPane(!1),this.toolbar&&this.toolbar.enableDisablePropertyPaneButton(!1),this.container.showPropertiesPane=!1)},e.prototype.tocHeaderDiv=function(e){var t,r;this.isRtl?(t="float:left;",r="margin-left:7px;"):(t="float:right;",r="margin-right:7px;");var o=i.i(n.createElement)("div",{id:this.elementId+"toc_id",styles:"display: block;"});e.appendChild(o),this.element.appendChild(e);var s=i.i(n.createElement)("label",{className:"e-de-ctnr-prop-label"});s.textContent=this.localObj.getConstant("Table of Contents"),o.appendChild(s),this.closeButton=i.i(n.createElement)("span",{className:"e-de-ctnr-close e-icons",styles:"cursor: pointer;display:inline-block;color: #4A4A4A;"+t+r}),o.appendChild(this.closeButton)},e.prototype.initTemplates=function(e){this.template1(e)},e.prototype.template1=function(e){this.template1Div=i.i(n.createElement)("div",{className:"e-de-toc-template1"}),this.isRtl&&this.template1Div.classList.add("e-de-rtl"),e.appendChild(this.template1Div);var t=i.i(n.createElement)("div",{className:"e-de-toc-template1-content1"});t.textContent=this.localObj.getConstant("HEADING - - - - 1"),this.template1Div.appendChild(t);var r=i.i(n.createElement)("div",{className:"e-de-toc-template1-content2"});r.textContent=this.localObj.getConstant("HEADING - - - - 2"),this.template1Div.appendChild(r);var o=i.i(n.createElement)("div",{className:"e-de-toc-template1-content3"});o.textContent=this.localObj.getConstant("HEADING - - - - 3"),this.template1Div.appendChild(o)},e.prototype.tocOptionsDiv=function(e){var t=i.i(n.createElement)("div");e.appendChild(t),this.element.appendChild(e),this.isRtl&&t.classList.add("e-de-rtl");var r=i.i(n.createElement)("label",{className:"e-de-ctnr-prop-label"});r.textContent=this.localObj.getConstant("Options"),t.appendChild(r)},e.prototype.createDropDownButton=function(e,t,r,s,a){var l=i.i(n.createElement)("input",{id:e});return t.appendChild(l),new o.DropDownList({index:a,dataSource:s,popupHeight:"150px",cssClass:"e-de-prop-font-button",placeholder:this.localObj.getConstant("Levels")},l)},e.prototype.contentStylesDropdown=function(e){var t=this;this.isRtl;var r=i.i(n.createElement)("div",{id:"contentstyle_div"});r.setAttribute("title",this.localObj.getConstant("Number of heading or outline levels to be shown in table of contents")),e.appendChild(r);this.isRtl;var o=i.i(n.createElement)("label",{className:"e-de-prop-sub-label",styles:"display:block"});o.textContent=this.localObj.getConstant("Levels"),r.appendChild(o),e.appendChild(r);var s=["1","2","3","4","5","6","7","8","9"];this.borderLevelStyle=this.createDropDownButton(this.elementId+"_borderLevelDiv",r,"",s,2),this.borderLevelStyle.change=function(e){t.borderLevelStyle.value=e.item.value},e.appendChild(r)},e.prototype.checkboxContent=function(e){this.isRtl;var t=i.i(n.createElement)("div",{id:"toc_checkboxDiv",styles:"margin-bottom:36px;"});e.appendChild(t);var o=i.i(n.createElement)("div",{className:"e-de-toc-checkbox1"});o.setAttribute("title",this.localObj.getConstant("Show page numbers in table of contents")),t.appendChild(o);var s=i.i(n.createElement)("input",{id:"showpagenumber",styles:"width:12px;height:12px;margin-bottom:8px",className:"e-de-prop-sub-label"});o.appendChild(s),this.showPageNumber=new r.CheckBox({label:this.localObj.getConstant("Show page numbers"),enableRtl:this.isRtl}),this.showPageNumber.appendTo(s);var a=i.i(n.createElement)("div",{className:"e-de-toc-checkbox2"});a.setAttribute("title",this.localObj.getConstant("Right align page numbers in table of contents")),t.appendChild(a);var l=i.i(n.createElement)("input",{id:"rightalignpagenumber",styles:"width:12px;height:12px",className:"e-de-prop-sub-label"});a.appendChild(l),this.rightalignPageNumber=new r.CheckBox({label:this.localObj.getConstant("Right align page numbers"),enableRtl:this.isRtl}),this.rightalignPageNumber.appendTo(l);var d=i.i(n.createElement)("div",{className:"e-de-toc-checkbox3"});d.setAttribute("title",this.localObj.getConstant("Use hyperlinks instead of page numbers")),t.appendChild(d);var h=i.i(n.createElement)("input",{id:"hyperlinkdiv",styles:"width:12px;height:12px",className:"e-de-prop-sub-label"});d.appendChild(h),this.hyperlink=new r.CheckBox({label:this.localObj.getConstant("Use hyperlinks"),enableRtl:this.isRtl}),this.hyperlink.appendTo(h)},e.prototype.buttonDiv=function(e){var t;t=this.isRtl?"float:left":"float:right";var o=i.i(n.createElement)("div",{id:"footerDiv",styles:t});e.appendChild(o);var s=i.i(n.createElement)("button",{id:"footerupdatebuttonDiv",attrs:{type:"button"}});o.appendChild(s),this.updateBtn=new r.Button({content:this.localObj.getConstant("Update"),cssClass:"btn-update",isPrimary:!0}),this.updateBtn.appendTo(s);var a=i.i(n.createElement)("button",{id:"footercancelbuttonDiv",attrs:{type:"button"}});o.appendChild(a),this.cancelBtn=new r.Button({content:this.localObj.getConstant("Cancel"),cssClass:this.isRtl?"e-de-btn-cancel-rtl":"e-de-btn-cancel"}),a.setAttribute("aria-label",this.cancelBtn.content),this.cancelBtn.appendTo(a)},e.prototype.showTocPane=function(e,t){!e&&"none"===this.element.style.display||e&&"block"===this.element.style.display||(this.element.style.display=e?"block":"none",this.updateBtn.content="TableOfContents"===this.documentEditor.selection.contextType?this.localObj.getConstant("Update"):this.localObj.getConstant("Insert"),this.updateBtn.element.setAttribute("aria-label",this.updateBtn.content),this.prevContext=this.documentEditor.selection.contextType,this.documentEditor.resize(),e&&this.updateBtn.element.focus())},e.prototype.onInsertToc=function(){var e={startLevel:1,endLevel:parseInt(this.borderLevelStyle.value,0),includeHyperlink:this.hyperlink.checked,includeOutlineLevels:!0,includePageNumber:this.showPageNumber.checked,rightAlign:this.rightalignPageNumber.checked};e.rightAlign&&(e.tabLeader="Dot"),this.documentEditor.editor.insertTableOfContents(e),this.documentEditor.focusIn()},e.prototype.destroy=function(){this.container=void 0,this.showPageNumber&&(this.showPageNumber.destroy(),this.showPageNumber=void 0),this.rightalignPageNumber&&(this.rightalignPageNumber.destroy(),this.rightalignPageNumber=void 0),this.borderBtn&&(this.borderBtn.destroy(),this.borderBtn=void 0),this.borderLevelStyle&&(this.borderLevelStyle.destroy(),this.borderLevelStyle=void 0),this.hyperlink&&this.hyperlink.destroy(),this.hyperlink=void 0,this.updateBtn&&this.updateBtn.destroy(),this.updateBtn=void 0,this.cancelBtn&&this.cancelBtn.destroy(),this.cancelBtn=void 0},e}())},function(e,t,i){"use strict";i.d(t,"a",function(){return d});var n=i(0),r=(i.n(n),i(15)),o=(i.n(r),i(78)),s=i(3),a=(i.n(s),i(19)),l=(i.n(a),i(5)),d=(i.n(l),function(){function e(e,t,i){this.isTopMarginApply=!1,this.isRightMarginApply=!1,this.isBottomMarginApply=!1,this.isLeftMarginApply=!1,this.borderColor="#000000",this.groupButtonClass="e-de-ctnr-group-btn e-btn-group",this.container=e,this.isRtl=i,this.isRtl&&(this.groupButtonClass="e-rtl "+this.groupButtonClass),this.tableTextProperties=new o.a(e,"textProperties",!0,this.isRtl),this.imageProperty=t,this.elementId=this.documentEditor.element.id,this.initializeTablePropPane(),this.prevContext=this.documentEditor.selection.contextType}return Object.defineProperty(e.prototype,"documentEditor",{get:function(){return this.container.documentEditor},enumerable:!0,configurable:!0}),e.prototype.initializeTablePropPane=function(){this.localObj=new n.L10n("documenteditorcontainer",this.container.defaultLocale,this.container.locale),this.tableProperties=i.i(n.createElement)("div",{className:"e-de-scrollbar-hide",styles:"overflow: auto"}),this.initFillColorDiv(),this.initBorderStylesDiv(),this.initCellDiv(),this.initInsertOrDelCell(),this.initCellMargin(),this.initAlignText(),this.addTablePropertyTab(),this.wireEvent()},e.prototype.enableDisableElements=function(e){e?i.i(n.classList)(this.element,[],["e-de-overlay"]):i.i(n.classList)(this.element,["e-de-overlay"],[])},e.prototype.addTablePropertyTab=function(){var e=i.i(n.createElement)("div",{innerHTML:this.localObj.getConstant("Table")}),t=i.i(n.createElement)("div",{innerHTML:this.localObj.getConstant("Text")});this.parentElement=i.i(n.createElement)("div",{styles:"height:100%;overflow:auto;display:none",className:"e-de-prop-pane e-de-scrollbar-hide"}),this.element=i.i(n.createElement)("div",{id:this.elementId+"_propertyTabDiv",className:"e-de-property-tab"});var o=[{header:{text:t},content:this.tableTextProperties.element},{header:{text:e},content:this.tableProperties}];this.propertiesTab=new r.Tab({items:o,animation:{previous:{effect:"None"},next:{effect:"None"}},selected:this.onTabSelection.bind(this)}),this.propertiesTab.isStringTemplate=!0,this.propertiesTab.appendTo(this.element),this.parentElement.appendChild(this.element),this.container.propertiesPaneContainer.appendChild(this.parentElement)},e.prototype.onTabSelection=function(e){e.preventFocus=!0,this.documentEditor.resize(),this.documentEditor.enableAutoFocus&&this.documentEditor.focusIn()},e.prototype.wireEvent=function(){var e=this;this.shadingBtn.addEventListener("change",this.changeBackgroundColor.bind(this)),this.borderBtn.addEventListener("change",function(t){setTimeout(function(){e.borderColor=t.currentValue.hex,e.tableOutlineBorder.element.focus()},10)}),this.tableOutlineBorder.element.addEventListener("click",this.onOutlineBorder.bind(this)),this.tableAllBorder.element.addEventListener("click",this.onAllBorder.bind(this)),this.tableCenterBorder.element.addEventListener("click",this.onInsideBorder.bind(this)),this.tableLeftBorder.element.addEventListener("click",this.onLeftBorder.bind(this)),this.tableCenterVerticalBorder.element.addEventListener("click",this.onVerticalBorder.bind(this)),this.tableRightBorder.element.addEventListener("click",this.onRightBorder.bind(this)),this.tableTopBorder.element.addEventListener("click",this.onTopBorder.bind(this)),this.tableCenterHorizontalBorder.element.addEventListener("click",this.onHorizontalBorder.bind(this)),this.tableBottomBorder.element.addEventListener("click",this.onBottomBorder.bind(this)),this.insertRowAbove.element.addEventListener("click",this.onInsertRowAbove.bind(this)),this.insertRowBelow.element.addEventListener("click",this.onInsertRowBelow.bind(this)),this.insertColumnLeft.element.addEventListener("click",this.onInsertColumnLeft.bind(this)),this.insertColumnRight.element.addEventListener("click",this.onInsertColumnRight.bind(this)),this.deleteRow.element.addEventListener("click",this.onDeleteRow.bind(this)),this.deleteColumn.element.addEventListener("click",this.onDeleteColumn.bind(this)),this.horizontalMerge.element.addEventListener("click",this.onMergeCell.bind(this)),this.alignTop.element.addEventListener("click",this.applyAlignTop.bind(this)),this.alignBottom.element.addEventListener("click",this.applyAlignBottom.bind(this)),this.alignCenterHorizontal.element.addEventListener("click",this.applyAlignCenterHorizontal.bind(this)),this.topMargin.htmlAttributes={"aria-label":"top-margin"},this.bottomMargin.htmlAttributes={"aria-label":"bottom-margin"},this.leftMargin.htmlAttributes={"aria-label":"left-margin"},this.rightMargin.htmlAttributes={"aria-label":"right-Margin"},this.topMargin.element.addEventListener("click",function(){e.isTopMarginApply=!0}),this.rightMargin.element.addEventListener("click",function(){e.isRightMarginApply=!0}),this.leftMargin.element.addEventListener("click",function(){e.isLeftMarginApply=!0}),this.bottomMargin.element.addEventListener("click",function(){e.isBottomMarginApply=!0}),this.topMargin.element.addEventListener("keydown",this.onTopMargin.bind(this)),this.rightMargin.element.addEventListener("keydown",this.onRightMargin.bind(this)),this.leftMargin.element.addEventListener("keydown",this.onLeftMargin.bind(this)),this.bottomMargin.element.addEventListener("keydown",this.onBottomMargin.bind(this)),this.topMargin.element.addEventListener("blur",function(){e.applyTopMargin(),e.isTopMarginApply=!1}),this.rightMargin.element.addEventListener("blur",function(){e.applyRightMargin(),e.isRightMarginApply=!1}),this.leftMargin.element.addEventListener("blur",function(){e.applyLeftMargin(),e.isLeftMarginApply=!1}),this.bottomMargin.element.addEventListener("blur",function(){e.applyBottomMargin(),e.isBottomMarginApply=!1})},e.prototype.getBorder=function(e){var t=this.borderSize.content.indexOf("No Border")>=0?0:parseFloat(this.borderSize.content),i=0===t?"Cleared":"Single";return{type:e,borderColor:this.borderColor,lineWidth:t,borderStyle:i}},e.prototype.onOutlineBorder=function(){this.documentEditor.editor.applyBorders(this.getBorder("OutsideBorders"))},e.prototype.onAllBorder=function(){this.documentEditor.editor.applyBorders(this.getBorder("AllBorders"))},e.prototype.onInsideBorder=function(){this.documentEditor.editor.applyBorders(this.getBorder("InsideBorders"))},e.prototype.onLeftBorder=function(){this.documentEditor.editor.applyBorders(this.getBorder("LeftBorder"))},e.prototype.onVerticalBorder=function(){this.documentEditor.editor.applyBorders(this.getBorder("InsideVerticalBorder"))},e.prototype.onRightBorder=function(){this.documentEditor.editor.applyBorders(this.getBorder("RightBorder"))},e.prototype.onTopBorder=function(){this.documentEditor.editor.applyBorders(this.getBorder("TopBorder"))},e.prototype.onHorizontalBorder=function(){this.documentEditor.editor.applyBorders(this.getBorder("InsideHorizontalBorder"))},e.prototype.onBottomBorder=function(){this.documentEditor.editor.applyBorders(this.getBorder("BottomBorder"))},e.prototype.onTopMargin=function(e){var t=this;13===e.keyCode&&setTimeout(function(){t.applyTopMargin(),t.isTopMarginApply=!1},30)},e.prototype.onBottomMargin=function(e){var t=this;13===e.keyCode&&setTimeout(function(){t.applyBottomMargin(),t.isBottomMarginApply=!1},30)},e.prototype.onLeftMargin=function(e){var t=this;13===e.keyCode&&setTimeout(function(){t.applyLeftMargin(),t.isLeftMarginApply=!1},30)},e.prototype.onRightMargin=function(e){var t=this;13===e.keyCode&&setTimeout(function(){t.applyRightMargin(),t.isRightMarginApply=!1},30)},e.prototype.applyTopMargin=function(){this.isTopMarginApply&&(this.documentEditor.selection.cellFormat.topMargin=this.topMargin.value>this.topMargin.max?this.topMargin.max:this.topMargin.value)},e.prototype.applyBottomMargin=function(){this.isBottomMarginApply&&(this.documentEditor.selection.cellFormat.bottomMargin=this.bottomMargin.value>this.bottomMargin.max?this.bottomMargin.max:this.bottomMargin.value)},e.prototype.applyLeftMargin=function(){this.isLeftMarginApply&&(this.documentEditor.selection.cellFormat.leftMargin=this.leftMargin.value>this.leftMargin.max?this.leftMargin.max:this.leftMargin.value)},e.prototype.applyRightMargin=function(){this.isRightMarginApply&&(this.documentEditor.selection.cellFormat.rightMargin=this.rightMargin.value>this.rightMargin.max?this.rightMargin.max:this.rightMargin.value)},e.prototype.applyAlignTop=function(){this.documentEditor.selection.cellFormat.verticalAlignment="Top"},e.prototype.applyAlignBottom=function(){this.documentEditor.selection.cellFormat.verticalAlignment="Bottom"},e.prototype.applyAlignCenterHorizontal=function(){this.documentEditor.selection.cellFormat.verticalAlignment="Center"},e.prototype.onMergeCell=function(){this.documentEditor.editor.mergeCells()},e.prototype.onInsertRowAbove=function(){this.documentEditor.editor.insertRow(!0)},e.prototype.onInsertRowBelow=function(){this.documentEditor.editor.insertRow(!1)},e.prototype.onInsertColumnLeft=function(){this.documentEditor.editor.insertColumn(!0)},e.prototype.onInsertColumnRight=function(){this.documentEditor.editor.insertColumn(!1)},e.prototype.onDeleteRow=function(){this.documentEditor.editor.deleteRow(),this.documentEditor.focusIn()},e.prototype.onDeleteColumn=function(){this.documentEditor.editor.deleteColumn(),this.documentEditor.focusIn()},e.prototype.onSelectionChange=function(){this.documentEditor.selection&&(this.documentEditor.editor&&this.documentEditor.editor.canMergeCells()?this.horizontalMerge.disabled=!1:this.horizontalMerge.disabled=!0,"TableText"!==this.documentEditor.selection.contextType&&"TableImage"!==this.documentEditor.selection.contextType||(this.shadingBtn.value=this.documentEditor.selection.cellFormat.background?this.documentEditor.selection.cellFormat.background:""),this.topMargin.value=this.documentEditor.selection.cellFormat.topMargin?this.documentEditor.selection.cellFormat.topMargin:0,this.bottomMargin.value=this.documentEditor.selection.cellFormat.bottomMargin?this.documentEditor.selection.cellFormat.bottomMargin:0,this.rightMargin.value=this.documentEditor.selection.cellFormat.rightMargin?this.documentEditor.selection.cellFormat.rightMargin:0,this.leftMargin.value=this.documentEditor.selection.cellFormat.leftMargin?this.documentEditor.selection.cellFormat.leftMargin:0)},e.prototype.changeBackgroundColor=function(e){var t=this;this.documentEditor.isReadOnly||(this.documentEditor.selection.cellFormat.background=e.currentValue.hex,setTimeout(function(){t.documentEditor.focusIn()},10))},e.prototype.initFillColorDiv=function(){var e=i.i(n.createElement)("div",{id:this.elementId+"_fillColorDiv",className:"e-de-property-div-padding de-tbl-fill-clr"});this.tableProperties.appendChild(e);var t=i.i(n.createElement)("label",{className:"e-de-prop-sub-label"});t.classList.add("e-de-prop-fill-label"),this.isRtl&&t.classList.add("e-de-rtl"),t.textContent=this.localObj.getConstant("Fill"),e.appendChild(t),this.shadingBtn=this.createColorPickerTemplate(this.elementId+"_tableShading",e,this.localObj.getConstant("Fill color"),!1),i.i(n.classList)(e.lastElementChild.lastElementChild.lastElementChild.firstChild,["e-de-ctnr-cellbg-clr-picker"],["e-caret"])},e.prototype.initBorderStylesDiv=function(){var e=i.i(n.createElement)("div",{className:"e-de-property-div-padding"});this.tableProperties.appendChild(e);var t=i.i(n.createElement)("label",{className:"e-de-ctnr-prop-label"});t.textContent=this.localObj.getConstant("Border Style"),e.appendChild(t);var r=i.i(n.createElement)("div",{styles:"display:inline-flex;"}),o=i.i(n.createElement)("div",{styles:"width:min-content;height:126px",className:"e-de-grp-btn-ctnr"}),s=i.i(n.createElement)("div",{className:this.groupButtonClass+" e-de-ctnr-group-btn-top"});o.appendChild(s);var a=i.i(n.createElement)("div",{className:this.groupButtonClass+" e-de-ctnr-group-btn-middle"});o.appendChild(a);var l=i.i(n.createElement)("div",{className:this.groupButtonClass+" e-de-ctnr-group-btn-bottom"});o.appendChild(l),this.isRtl&&(s.classList.add("e-de-rtl"),l.classList.add("e-de-rtl"),r.classList.add("e-de-rtl"),t.classList.add("e-de-rtl"));this.tableOutlineBorder=this.createButtonTemplate(this.elementId+"_tableOutlineBorder","e-de-ctnr-outsideborder e-icons",s,"e-de-prop-font-button","",this.localObj.getConstant("Outside borders")),this.tableAllBorder=this.createButtonTemplate(this.elementId+"_tableAllBorder","e-de-ctnr-allborders e-icons",s,"e-de-prop-font-button","",this.localObj.getConstant("All borders")),this.tableCenterBorder=this.createButtonTemplate(this.elementId+"_tableCenterBorder","e-de-ctnr-insideborders e-icons",s,"e-de-prop-font-button","",this.localObj.getConstant("Inside borders")),this.tableLeftBorder=this.createButtonTemplate(this.elementId+"_tableLeftBorder","e-de-ctnr-leftborders e-icons",a,"e-de-prop-font-button","",this.localObj.getConstant("Left border")),this.tableCenterVerticalBorder=this.createButtonTemplate(this.elementId+"_tableCenterVBorder","e-de-ctnr-insideverticalborder e-icons",a,"e-de-prop-font-button","",this.localObj.getConstant("Inside vertical border")),this.tableRightBorder=this.createButtonTemplate(this.elementId+"_tableRightBorder","e-de-ctnr-rightborder e-icons",a,"e-de-prop-font-button","",this.localObj.getConstant("Right border")),this.tableTopBorder=this.createButtonTemplate(this.elementId+"_tableTopBorder","e-de-ctnr-topborder e-icons",l,"e-de-prop-font-button","",this.localObj.getConstant("Top border")),this.tableCenterHorizontalBorder=this.createButtonTemplate(this.elementId+"_tableCenterHBorder","e-de-ctnr-insidehorizondalborder e-icons",l,"e-de-prop-font-button","",this.localObj.getConstant("Inside horizontal border")),this.tableBottomBorder=this.createButtonTemplate(this.elementId+"_tableBottomBorder","e-de-ctnr-bottomborder e-icons",l,"e-de-prop-font-button","",this.localObj.getConstant("Bottom border")),r.appendChild(o);var d=i.i(n.createElement)("div",{className:"de-tbl-fill-clr"});this.isRtl?d.classList.add("e-de-stylediv-rtl"):d.classList.add("e-de-stylediv"),this.borderBtn=this.createColorPickerTemplate(this.elementId+"_tableBorderColor",d,this.localObj.getConstant("Border color"),!0),this.borderBtn.value="#000000",d.firstElementChild.lastElementChild.lastElementChild.style.width="30px",d.firstElementChild.lastElementChild.firstElementChild.firstElementChild.style.width="100%",i.i(n.classList)(d.lastElementChild.lastElementChild.lastElementChild.firstChild,["e-de-ctnr-highlightcolor"],["e-caret"]);var h=i.i(n.createElement)("button",{id:this.elementId+"_tableBorderSize",className:"e-de-border-size-button",styles:"font-size:10px;padding:0px;",attrs:{type:"button"}});d.appendChild(h),this.borderSize=this.createBorderSizeDropDown("e-de-ctnr-strokesize e-icons",h),r.appendChild(d),this.borderSizeColorElement=document.getElementsByClassName("e-de-border-width"),e.appendChild(r)},e.prototype.initCellDiv=function(){var e=i.i(n.createElement)("div",{className:"e-de-property-div-padding"});this.tableProperties.appendChild(e);var t=i.i(n.createElement)("label",{className:"e-de-ctnr-prop-label"});t.textContent=this.localObj.getConstant("Cell"),e.appendChild(t);var r=i.i(n.createElement)("div",{className:"e-de-ctnr-group-btn"});r.classList.add("e-de-cell-div"),this.isRtl&&(r.classList.add("e-de-rtl"),t.classList.add("e-de-rtl"));this.horizontalMerge=this.createButtonTemplate(this.elementId+"_tableOutlineBorder","e-de-ctnr-mergecell e-icons",r,"e-de-prop-font-button","",this.localObj.getConstant("Merge cells")),e.appendChild(r)},e.prototype.initInsertOrDelCell=function(){var e=i.i(n.createElement)("div",{className:"e-de-property-div-padding"});this.tableProperties.appendChild(e);var t=i.i(n.createElement)("label",{className:"e-de-ctnr-prop-label"});t.textContent=this.localObj.getConstant("Insert Or Delete"),e.appendChild(t);var r=i.i(n.createElement)("div",{className:"e-de-insert-del-cell",styles:"display:inline-flex"}),o=i.i(n.createElement)("div",{className:this.groupButtonClass});r.appendChild(o);var s=i.i(n.createElement)("div",{className:this.groupButtonClass});this.isRtl?(s.style.marginRight="12px",r.classList.add("e-de-rtl"),t.classList.add("e-de-rtl")):s.style.marginLeft="12px",r.appendChild(s);this.insertColumnLeft=this.createButtonTemplate(this.elementId+"_insertColumnLeft","e-de-ctnr-insertleft e-icons",o,"e-de-prop-font-button","",this.localObj.getConstant("Insert columns to the left")),this.insertColumnRight=this.createButtonTemplate(this.elementId+"_insertColumnRight","e-de-ctnr-insertright e-icons",o,"e-de-prop-font-button","",this.localObj.getConstant("Insert columns to the right")),this.insertRowAbove=this.createButtonTemplate(this.elementId+"_insertRowAbove","e-de-ctnr-insertabove e-icons",o,"e-de-prop-font-button","",this.localObj.getConstant("Insert rows above")),this.insertRowBelow=this.createButtonTemplate(this.elementId+"_insertRowBelow","e-de-ctnr-insertbelow e-icons",o,"e-de-prop-font-button","",this.localObj.getConstant("Insert rows below")),this.deleteRow=this.createButtonTemplate(this.elementId+"_deleteRow","e-de-ctnr-deleterows e-icons",s,"e-de-prop-font-button","",this.localObj.getConstant("Delete rows")),this.deleteColumn=this.createButtonTemplate(this.elementId+"_deleteColumn","e-de-ctnr-deletecolumns e-icons",s,"e-de-prop-font-button","",this.localObj.getConstant("Delete columns")),e.appendChild(r)},e.prototype.initCellMargin=function(){var e=i.i(n.createElement)("div",{className:"e-de-property-div-padding e-de-cellmargin-text"});this.tableProperties.appendChild(e);var t=i.i(n.createElement)("label",{className:"e-de-ctnr-prop-label"});t.textContent=this.localObj.getConstant("Cell Margin"),e.appendChild(t);var r=i.i(n.createElement)("div",{styles:"display:inline-flex"});this.isRtl&&t.classList.add("e-de-rtl");this.topMargin=this.createCellMarginTextBox(this.localObj.getConstant("Top"),this.elementId+"_topMargin",r,"width:48px","width:50px;float:left;",500,this.localObj.getConstant("Top margin")),this.bottomMargin=this.createCellMarginTextBox(this.localObj.getConstant("Bottom"),this.elementId+"_bottomMargin",r,"width:48px","width:50px;float:left;",500,this.localObj.getConstant("Bottom margin")),this.leftMargin=this.createCellMarginTextBox(this.localObj.getConstant("Left"),this.elementId+"_leftMargin",r,"width:48px","width:50px;float:left;",500,this.localObj.getConstant("Left margin")),this.rightMargin=this.createCellMarginTextBox(this.localObj.getConstant("Right"),this.elementId+"_rightMargin",r,"width:48px","width:50px;float:left;",500,this.localObj.getConstant("Right margin"),!0),e.appendChild(r)},e.prototype.initAlignText=function(){var e=i.i(n.createElement)("div",{className:"e-de-property-div-padding",styles:"border-bottom-width:0px"});this.tableProperties.appendChild(e);var t=i.i(n.createElement)("label",{className:"e-de-ctnr-prop-label"});t.textContent=this.localObj.getConstant("Align Text"),e.appendChild(t);var r=i.i(n.createElement)("div");this.isRtl&&(r.classList.add("e-de-rtl"),t.classList.add("e-de-rtl"));var o=i.i(n.createElement)("div",{className:this.groupButtonClass});r.appendChild(o);this.alignTop=this.createButtonTemplate(this.elementId+"_alignTop","e-de-ctnr-aligntop e-icons",o,"e-de-prop-font-button","",this.localObj.getConstant("Align top")),this.alignBottom=this.createButtonTemplate(this.elementId+"_alignBottom","e-de-ctnr-alignbottom e-icons",o,"e-de-prop-font-button","",this.localObj.getConstant("Align bottom")),this.alignCenterHorizontal=this.createButtonTemplate(this.elementId+"_alignCenterHorizontal","e-de-ctnr-aligncenter-table e-icons",o,"e-de-prop-font-button","",this.localObj.getConstant("Align center")),this.alignCenterHorizontal.addEventListener("click",this.applyAlignCenterHorizontal.bind(this)),e.appendChild(r)},e.prototype.createCellMarginTextBox=function(e,t,r,o,s,a,d,h){var c=i.i(n.createElement)("div",{styles:s});h||c.classList.add("e-de-cell-text-box");var p=i.i(n.createElement)("label",{className:"e-de-prop-sub-label"});p.textContent=e,c.appendChild(p);var u=i.i(n.createElement)("input",{className:"e-textbox",id:t,styles:o});c.appendChild(u);var g=new l.NumericTextBox({showSpinButton:!1,min:0,format:"n0",max:a,enableRtl:this.isRtl},u);return r.appendChild(c),u.setAttribute("title",d),g},e.prototype.createBorderSizeDropDown=function(e,t){var r=this,o=i.i(n.createElement)("div",{id:"borderSizeTarget",styles:"display:none"}),s=i.i(n.createElement)("ul",{styles:"display: block; outline: 0px; width: 126px; height: auto;",id:"borderSizeListMenu"});o.appendChild(s),this.createDropdownOption(s,this.localObj.getConstant("No Border")).addEventListener("click",function(){r.onBorderSizeChange("No Border")});var l=this.localObj.getConstant("px");this.createDropdownOption(s,".25"+l).addEventListener("click",function(){r.onBorderSizeChange(".25px")}),this.createDropdownOption(s,".5"+l).addEventListener("click",function(){r.onBorderSizeChange(".5px")}),this.createDropdownOption(s,".75"+l).addEventListener("click",function(){r.onBorderSizeChange(".75px")}),this.createDropdownOption(s,"1"+l).addEventListener("click",function(){r.onBorderSizeChange("1px")}),this.createDropdownOption(s,"1.5"+l).addEventListener("click",function(){r.onBorderSizeChange("1.5px")}),this.createDropdownOption(s,"2"+l).addEventListener("click",function(){r.onBorderSizeChange("2px")}),this.createDropdownOption(s,"3"+l).addEventListener("click",function(){r.onBorderSizeChange("3px")}),this.createDropdownOption(s,"4"+l).addEventListener("click",function(){r.onBorderSizeChange("4px")}),this.createDropdownOption(s,"5"+l).addEventListener("click",function(){r.onBorderSizeChange("5px")}),this.createDropdownOption(s,"6"+l).addEventListener("click",function(){r.onBorderSizeChange("6px")});var d={target:o,iconCss:e,cssClass:"e-de-prop-bordersize",enableRtl:this.isRtl,content:"1.5px"},h=new a.DropDownButton(d);return h.beforeOpen=function(){o.style.display="block";for(var e=0;e<r.borderSizeColorElement.length;e++)r.borderSizeColorElement[parseInt(e.toString(),10)].style.borderBottomColor=r.borderColor},h.beforeClose=function(){o.style.display="none"},h.appendTo(t),h.element.setAttribute("title",this.localObj.getConstant("Border width")),h},e.prototype.onBorderSizeChange=function(e){var t=this;this.borderSize.content=e,setTimeout(function(){t.tableOutlineBorder.element.focus()},10)},e.prototype.createDropdownOption=function(e,t){var r=i.i(n.createElement)("li",{styles:"display:block",className:"e-de-floating-menuitem e-de-floating-menuitem-md e-de-list-items  e-de-list-item-size"});e.appendChild(r);var o;o="No Border"===t?"<div>"+t+"</div>":"1.5px"===t?"<div>"+t+'<span class="e-de-list-line e-de-border-width"  style="margin-left:10px;border-bottom-width:'+t+';"></span></div>':"<div>"+t+'<span class="e-de-list-line e-de-border-width" style="margin-left:20px;border-bottom-width:'+t+';"></span></div>';var s=i.i(n.createElement)("div",{className:"e-de-list-header-presetmenu",innerHTML:o});return r.appendChild(s),r},e.prototype.createDropDownButton=function(e,t,r,o,s,l,d){var h=i.i(n.createElement)("button",{id:e,styles:t,attrs:{type:"button"}});r.appendChild(h);var c="e-de-prop-splitbutton";this.isRtl&&(c="e-rtl "+c);var p=new a.DropDownButton({iconCss:o,content:s,enableRtl:this.isRtl,cssClass:c},h);return l&&(p.items=l),d&&(p.target=d),p},e.prototype.createButtonTemplate=function(e,t,r,o,a,l,d,h){var c=i.i(n.createElement)("Button",{id:e,styles:a,attrs:{type:"button"}});r.appendChild(c);var p=new s.Button({cssClass:o,iconCss:t,enableRtl:this.isRtl,iconPosition:h||"Left",content:d||""});return p.appendTo(c),c.setAttribute("title",l),c.setAttribute("aria-label",l),p},e.prototype.createColorPickerTemplate=function(e,t,r,o){var s=i.i(n.createElement)("input",{id:e});t.appendChild(s);var a="e-de-prop-font-button e-de-prop-font-colorpicker";o&&(a+=" e-de-border-clr-picker");var d=new l.ColorPicker({showButtons:!0,cssClass:a,enableRtl:this.isRtl,locale:this.container.locale,enableOpacity:!1},s);return s.parentElement.setAttribute("title",r),s.parentElement.setAttribute("aria-label",r),d},e.prototype.showTableProperties=function(e,t){e&&("text"===t?this.propertiesTab.hideTab(1,!0):(this.propertiesTab.hideTab(1,!1),this.prevContext!==this.documentEditor.selection.contextType&&(this.propertiesTab.selectedItem=1)),this.prevContext=this.documentEditor.selection.contextType,this.onSelectionChange(),this.tableTextProperties.onSelectionChange()),!e&&"none"===this.parentElement.style.display||e&&"block"===this.parentElement.style.display||(this.parentElement.style.display=e?"block":"none",e&&this.updateTabContainerHeight(),this.documentEditor.resize(),this.prevContext=this.documentEditor.selection.contextType)},e.prototype.updateTabContainerHeight=function(){if(this.parentElement&&"block"===this.parentElement.style.display){var e=this.parentElement.getElementsByClassName("e-tab-header")[0];if(e){var t=this.parentElement.offsetHeight-e.offsetHeight;this.tableProperties.style.height=t+"px",this.tableTextProperties.element.style.height=t+"px"}}},e.prototype.destroy=function(){this.container=void 0,this.shadingBtn&&(this.shadingBtn.destroy(),this.shadingBtn=void 0),this.borderBtn&&(this.borderBtn.destroy(),this.borderBtn=void 0),this.borderSize&&(this.borderSize.destroy(),this.borderSize=void 0),this.topMargin&&(this.topMargin.destroy(),this.topMargin=void 0),this.bottomMargin&&(this.bottomMargin.destroy(),this.bottomMargin=void 0),this.leftMargin&&(this.leftMargin.destroy(),this.leftMargin=void 0),this.rightMargin&&(this.rightMargin.destroy(),this.rightMargin=void 0),this.tableTextProperties&&(this.tableTextProperties.destroy(),this.tableTextProperties=void 0),this.propertiesTab&&(this.propertiesTab.destroy(),this.propertiesTab=void 0),this.imageProperty&&(this.imageProperty.destroy(),this.imageProperty=void 0),this.tableOutlineBorder&&this.tableOutlineBorder.destroy(),this.tableOutlineBorder=void 0,this.tableAllBorder&&this.tableAllBorder.destroy(),this.tableAllBorder=void 0,this.tableCenterBorder&&this.tableCenterBorder.destroy(),this.tableCenterBorder=void 0,this.tableLeftBorder&&this.tableLeftBorder.destroy(),this.tableLeftBorder=void 0,this.tableCenterVerticalBorder&&this.tableCenterVerticalBorder.destroy(),this.tableCenterVerticalBorder=void 0,this.tableRightBorder&&this.tableRightBorder.destroy(),this.tableRightBorder=void 0,this.tableTopBorder&&this.tableTopBorder.destroy(),this.tableTopBorder=void 0,this.tableCenterHorizontalBorder&&this.tableCenterHorizontalBorder.destroy(),this.tableCenterHorizontalBorder=void 0,this.tableBottomBorder&&this.tableBottomBorder.destroy(),this.tableBottomBorder=void 0,this.horizontalMerge&&this.horizontalMerge.destroy(),this.horizontalMerge=void 0,this.insertRowAbove&&this.insertRowAbove.destroy(),this.insertRowAbove=void 0,this.insertRowBelow&&this.insertRowBelow.destroy(),this.insertRowBelow=void 0,this.insertColumnLeft&&this.insertColumnLeft.destroy(),this.insertColumnLeft=void 0,this.insertColumnRight&&this.insertColumnRight.destroy(),this.insertColumnRight=void 0,this.deleteRow&&this.deleteRow.destroy(),this.deleteRow=void 0,this.deleteColumn&&this.deleteColumn.destroy(),this.deleteColumn=void 0,this.alignBottom&&this.alignBottom.destroy(),this.alignBottom=void 0,this.alignCenterHorizontal&&this.alignCenterHorizontal.destroy(),this.alignCenterHorizontal=void 0,this.alignTop&&this.alignTop.destroy(),this.alignTop=void 0,this.groupButtonClass=void 0,this.borderColor=void 0,this.elementId=void 0},e}())},function(e,t,i){"use strict";i.d(t,"a",function(){return s});var n=i(0),r=(i.n(n),i(79)),o=i(74),s=function(){function e(e,t,i,n){this.isInitial=!0,this.container=e,this.text=new r.a(e,n),this.paragraph=new o.a(e),this.initializeTextProperties(t,i,n),this.wireEvents()}return Object.defineProperty(e.prototype,"documentEditor",{get:function(){return this.container.documentEditor},enumerable:!0,configurable:!0}),e.prototype.enableDisableElements=function(e){e?i.i(n.classList)(this.element,[],["e-de-overlay"]):i.i(n.classList)(this.element,["e-de-overlay"],[])},e.prototype.updateStyles=function(){this.paragraph.updateStyleNames()},Object.defineProperty(e.prototype,"appliedHighlightColor",{get:function(){return this.text.appliedHighlightColor},set:function(e){this.text.appliedHighlightColor=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"appliedBulletStyle",{get:function(){return this.paragraph.appliedBulletStyle},set:function(e){this.paragraph.appliedBulletStyle=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"appliedNumberingStyle",{get:function(){return this.paragraph.appliedNumberingStyle},set:function(e){this.paragraph.appliedNumberingStyle=e},enumerable:!0,configurable:!0}),e.prototype.showTextProperties=function(e){e&&this.onSelectionChange(),!e&&"none"===this.element.style.display||e&&"block"===this.element.style.display||(this.element.style.display=e?"block":"none",this.documentEditor.resize())},e.prototype.initializeTextProperties=function(e,t,r){this.element=i.i(n.createElement)("div",{className:"e-de-prop-pane e-de-scrollbar-hide"}),this.element.setAttribute("tabindex","0"),this.text.initializeTextPropertiesDiv(this.element,r),this.paragraph.initializeParagraphPropertiesDiv(this.element,r),this.paragraph.updateStyleNames(),t||this.container.propertiesPaneContainer.appendChild(this.element)},e.prototype.generateUniqueID=function(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)},e.prototype.wireEvents=function(){this.text.wireEvent(),this.paragraph.wireEvent()},e.prototype.onSelectionChange=function(){this.text.onSelectionChange(),this.paragraph.onSelectionChange()},e.prototype.destroy=function(){this.text&&(this.text.destroy(),this.text=void 0),this.paragraph&&(this.paragraph.destroy(),this.paragraph=void 0),this.container=void 0},e}()},function(e,t,i){"use strict";i.d(t,"a",function(){return d});var n=i(0),r=(i.n(n),i(10)),o=(i.n(r),i(3)),s=(i.n(o),i(19)),a=(i.n(s),i(5)),l=(i.n(a),i(43)),d=(i.n(l),function(){function e(e,t){var r=this;this.isRetrieving=!1,this.appliedHighlightColor="rgb(255, 255, 0)",this.createChangecase=function(e){var t=[{text:r.localObj.getConstant("UPPERCASE"),id:"uppercase"}];r.changeCaseDropdown=new s.DropDownButton({items:t,iconCss:"e-icons e-de-ctnr-change-case",enableRtl:r.isRtl});var o=i.i(n.createElement)("div",{id:e.id+"_changeCase",className:"e-de-ctnr-group-btn"}),a=i.i(n.createElement)("button",{id:o.id+"_dropdownBtn",attrs:{type:"button"}});o.appendChild(a),e.appendChild(o),r.changeCaseDropdown.appendTo(a)},this.changeCase=function(e){if(!r.isRetrieving){switch(e.item.id){case"uppercase":!r.documentEditor.isReadOnly&&r.documentEditor.editor&&r.documentEditor.editor.changeCase("Uppercase")}}},this.container=e,this.isRtl=t}return Object.defineProperty(e.prototype,"documentEditor",{get:function(){return this.container.documentEditor},enumerable:!0,configurable:!0}),e.prototype.initializeTextPropertiesDiv=function(e,t){this.localObj=new n.L10n("documenteditorcontainer",this.container.defaultLocale,this.container.locale),this.textProperties=e;var r=this.documentEditor.element.id+"_font_properties",o=this.createDiv(r+"_text",e);i.i(n.classList)(o,["e-de-cntr-pane-padding","e-de-prop-separator-line"],[]);var s=this.createDiv(r+"_sizeStyle",o,"display:inline-flex;");i.i(n.classList)(s,["e-de-ctnr-segment"],[]),t&&i.i(n.classList)(s,["e-de-ctnr-segment-rtl"],[]);var a=this.createDiv(r+"_fontFamilyDiv",s),l=i.i(n.createElement)("input",{id:r+"_fontFamily",className:"e-prop-font-style"});a.appendChild(l),i.i(n.classList)(a,["e-de-panel-left-width"],[]),this.createDropDownListForFamily(l);var d=this.createDiv(r+"_fontSizeDiv",s),h="e-de-ctnr-group-btn e-de-char-fmt-btn-left e-btn-group";t&&(h="e-rtl "+h);var c=i.i(n.createElement)("input",{id:r+"_fontSize",innerHTML:"type:number",className:"e-prop-font-style"});d.appendChild(c),i.i(n.classList)(d,["e-de-panel-right-width"],[]),this.createDropDownListForSize(c);var p=i.i(n.createElement)("div",{id:r+"_properties",styles:"display:inline-flex;",className:"e-de-ctnr-segment"});t&&i.i(n.classList)(p,["e-de-ctnr-segment-rtl"],[]),o.appendChild(p);var u=i.i(n.createElement)("div",{id:r+"_leftDiv",className:h,styles:"display:inline-flex;"});p.appendChild(u),this.bold=this.createButtonTemplate(r+"_bold","e-de-ctnr-bold e-icons",u,"e-de-prop-font-button","40.5","Bold Tooltip"),this.italic=this.createButtonTemplate(r+"_italic","e-de-ctnr-italic e-icons",u,"e-de-prop-font-button","40.5","Italic Tooltip"),this.underline=this.createButtonTemplate(r+"_underline","e-de-ctnr-underline e-icons",u,"e-de-prop-font-button","40.5","Underline Tooltip"),this.strikethrough=this.createButtonTemplate(r+"_strikethrough","e-de-ctnr-strikethrough e-icons",u,"e-de-prop-font-last-button","40.5","Strikethrough"),h="e-de-ctnr-group-btn e-de-char-fmt-btn-right e-btn-group",t&&(h="e-rtl "+h);var g=i.i(n.createElement)("div",{id:r+"_rightDiv",className:h,styles:"display:inline-flex;"});p.appendChild(g),this.superscript=this.createButtonTemplate(r+"_superscript","e-de-ctnr-superscript e-icons",g,"e-de-prop-font-button","38.5","Superscript Tooltip"),this.subscript=this.createButtonTemplate(r+"_subscript","e-de-ctnr-subscript e-icons",g,"e-de-prop-font-last-button","38.5","Subscript Tooltip");var f=i.i(n.createElement)("div",{id:r+"_colorDiv",styles:"display:inline-flex;",className:"e-de-ctnr-segment"});t&&i.i(n.classList)(p,["e-de-ctnr-segment-rtl"],[]);var m=i.i(n.createElement)("div",{id:r+"_color",className:"e-de-font-clr-picker e-de-ctnr-group-btn",styles:"display:inline-flex;"});t&&i.i(n.classList)(m,["e-rtl"],[]),f.appendChild(m),o.appendChild(f),this.fontColor=this.createFontColorPicker(r+"_textColor",40.5,m,this.localObj.getConstant("Font color")),i.i(n.classList)(m.firstElementChild.lastElementChild.lastElementChild.firstChild,["e-de-ctnr-fontcolor","e-icons"],["e-caret"]),this.initializeHighlightColorElement(),this.highlightColor=this.createHighlightColorSplitButton(r+"_highlightColor",34.5,m,this.localObj.getConstant("Text highlight color")),i.i(n.classList)(this.highlightColor.element.nextElementSibling.firstElementChild,["e-de-ctnr-highlight","e-icons"],["e-caret"]),this.highlightColorInputElement=this.highlightColor.element.firstChild,this.clearFormat=this.createButtonTemplate(r+"_clearFormat","e-de-ctnr-clearall e-icons",m,"e-de-prop-font-last-button","40.5","Clear all formatting");var v=i.i(n.createElement)("div",{id:r+"_rightDiv2",className:h.replace("e-btn-group",""),styles:"display:inline-flex;"});t&&i.i(n.classList)(v,["e-rtl"],[]),v.setAttribute("title",this.container.localObj.getConstant("Change case Tooltip")),o.appendChild(v),this.createChangecase(v)},e.prototype.createHighlightColorSplitButton=function(e,t,r,o){var a=this,l=i.i(n.createElement)("button",{id:e,attrs:{type:"button"}});r.appendChild(l);var d=new s.SplitButton({cssClass:"e-de-btn-hghlclr",iconCss:"e-de-ctnr-hglt-color",target:this.highlightColorElement,close:this.closePopup.bind(this),beforeOpen:this.openPopup.bind(this),enableRtl:this.isRtl});return d.appendTo(l),d.click=function(){a.applyHighlightColor(a.highlightColorInputElement.style.backgroundColor)},d.element.firstChild.style.backgroundColor="rgb(255, 255, 0)",d.element.parentElement.setAttribute("title",o),d.element.parentElement.setAttribute("aria-label",o),d},e.prototype.openPopup=function(){this.highlightColorElement.style.display="block"},e.prototype.closePopup=function(){this.highlightColorElement.style.display="none"},e.prototype.initializeHighlightColorElement=function(){this.highlightColorElement=i.i(n.createElement)("div",{styles:"display:none;width:157px",className:"e-de-cntr-highlight-pane"});var e=this.createHightlighColorPickerDiv("#ffff00","yellowDiv"),t=this.createHightlighColorPickerDiv("#00ff00","brightGreenDiv"),r=this.createHightlighColorPickerDiv("#00ffff","turquoiseDiv"),o=this.createHightlighColorPickerDiv("#ff00ff","hotPinkDiv"),s=this.createHightlighColorPickerDiv("#0000ff","blueDiv"),a=this.createHightlighColorPickerDiv("#ff0000","redDiv"),l=this.createHightlighColorPickerDiv("#000080","darkBlueDiv"),d=this.createHightlighColorPickerDiv("#008080","tealDiv"),h=this.createHightlighColorPickerDiv("#008000","greenDiv"),c=this.createHightlighColorPickerDiv("#800080","violetDiv"),p=this.createHightlighColorPickerDiv("#800000","darkRedDiv"),u=this.createHightlighColorPickerDiv("#808000","darkYellowDiv"),g=this.createHightlighColorPickerDiv("#808080","gray50Div"),f=this.createHightlighColorPickerDiv("#c0c0c0","gray25Div"),m=this.createHightlighColorPickerDiv("#000000","blackDiv"),v=i.i(n.createElement)("div",{className:"e-hglt-no-color"});this.highlightColorElement.appendChild(v);var y=i.i(n.createElement)("div",{styles:"width:24px;height:24px;background-color:#ffffff;margin:3px;",id:"noColorDiv"});v.appendChild(y);var w=i.i(n.createElement)("div",{innerHTML:this.localObj.getConstant("No color"),className:"e-de-ctnr-hglt-no-color"});y.appendChild(w),e.addEventListener("click",this.onHighLightColor.bind(this)),t.addEventListener("click",this.onHighLightColor.bind(this)),r.addEventListener("click",this.onHighLightColor.bind(this)),o.addEventListener("click",this.onHighLightColor.bind(this)),s.addEventListener("click",this.onHighLightColor.bind(this)),a.addEventListener("click",this.onHighLightColor.bind(this)),l.addEventListener("click",this.onHighLightColor.bind(this)),d.addEventListener("click",this.onHighLightColor.bind(this)),h.addEventListener("click",this.onHighLightColor.bind(this)),c.addEventListener("click",this.onHighLightColor.bind(this)),p.addEventListener("click",this.onHighLightColor.bind(this)),u.addEventListener("click",this.onHighLightColor.bind(this)),g.addEventListener("click",this.onHighLightColor.bind(this)),f.addEventListener("click",this.onHighLightColor.bind(this)),m.addEventListener("click",this.onHighLightColor.bind(this)),v.addEventListener("click",this.onHighLightColor.bind(this))},e.prototype.createHightlighColorPickerDiv=function(e,t){var r=i.i(n.createElement)("div",{className:"e-de-ctnr-hglt-btn",id:t});return r.style.backgroundColor=e,this.highlightColorElement.appendChild(r),r},e.prototype.onHighLightColor=function(e){this.documentEditor.selection&&(this.applyHighlightColor(e.currentTarget.style.backgroundColor),this.highlightColor.toggle())},e.prototype.applyHighlightColorAsBackground=function(e){this.removeSelectedColorDiv(),"NoColor"===e?this.highlightColorElement.querySelector("#noColorDiv").classList.add("e-color-selected"):"Yellow"===e?this.highlightColorElement.querySelector("#yellowDiv").classList.add("e-color-selected"):"BrightGreen"===e?this.highlightColorElement.querySelector("#brightGreenDiv").classList.add("e-color-selected"):"Turquoise"===e?this.highlightColorElement.querySelector("#turquoiseDiv").classList.add("e-color-selected"):"Pink"===e?this.highlightColorElement.querySelector("#hotPinkDiv").classList.add("e-color-selected"):"Red"===e?this.highlightColorElement.querySelector("#redDiv").classList.add("e-color-selected"):"DarkBlue"===e?this.highlightColorElement.querySelector("#darkBlueDiv").classList.add("e-color-selected"):"Teal"===e?this.highlightColorElement.querySelector("#tealDiv").classList.add("e-color-selected"):"Green"===e?this.highlightColorElement.querySelector("#greenDiv").classList.add("e-color-selected"):"Violet"===e?this.highlightColorElement.querySelector("#violetDiv").classList.add("e-color-selected"):"DarkRed"===e?this.highlightColorElement.querySelector("#darkRedDiv").classList.add("e-color-selected"):"DarkYellow"===e?this.highlightColorElement.querySelector("#darkYellowDiv").classList.add("e-color-selected"):"Gray50"===e?this.highlightColorElement.querySelector("#gray50Div").classList.add("e-color-selected"):"Gray25"===e?this.highlightColorElement.querySelector("#gray25Div").classList.add("e-color-selected"):"Black"===e?this.highlightColorElement.querySelector("#blackDiv").classList.add("e-color-selected"):"Blue"===e&&this.highlightColorElement.querySelector("#blueDiv").classList.add("e-color-selected")},e.prototype.removeSelectedColorDiv=function(){this.highlightColorElement.querySelector("#noColorDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#yellowDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#brightGreenDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#turquoiseDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#hotPinkDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#redDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#darkBlueDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#tealDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#greenDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#violetDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#darkRedDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#darkYellowDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#gray50Div").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#gray25Div").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#blackDiv").classList.remove("e-color-selected")},e.prototype.applyHighlightColor=function(e){this.appliedHighlightColor=e;var t=this.getHighLightColor(e);"NoColor"===t&&(this.documentEditor.selection.characterFormat.highlightColor=null),this.documentEditor.selection.characterFormat.highlightColor=t,this.documentEditor.focusIn()},e.prototype.getHighLightColor=function(e){switch(e){case"rgb(255, 255, 0)":return"Yellow";case"rgb(0, 255, 0)":return"BrightGreen";case"rgb(0, 255, 255)":return"Turquoise";case"rgb(255, 0, 255)":return"Pink";case"rgb(0, 0, 255)":return"Blue";case"rgb(255, 0, 0)":return"Red";case"rgb(0, 0, 128)":return"DarkBlue";case"rgb(0, 128, 128)":return"Teal";case"rgb(0, 128, 0)":return"Green";case"rgb(128, 0, 128)":return"Violet";case"rgb(128, 0, 0)":return"DarkRed";case"rgb(128, 128, 0)":return"DarkYellow";case"rgb(128, 128, 128)":return"Gray50";case"rgb(192, 192, 192)":return"Gray25";case"rgb(0, 0, 0)":return"Black";default:return"NoColor"}},e.prototype.createDiv=function(e,t,r){var o;return o=r?i.i(n.createElement)("div",{id:e,styles:r}):i.i(n.createElement)("div",{id:e}),t.appendChild(o),o},e.prototype.createButtonTemplate=function(e,t,r,s,a,l){var d=i.i(n.createElement)("Button",{id:e,attrs:{type:"button"}});r.appendChild(d);var h=new o.Button({cssClass:s,iconCss:t,enableRtl:this.isRtl});switch(h.appendTo(d),d.setAttribute("title",this.localObj.getConstant(l)),d.setAttribute("aria-label",this.localObj.getConstant(l)),d.setAttribute("aria-pressed","false"),l){case"Bold Tooltip":this.boldBtn=h;break;case"Italic Tooltip":this.italicBtn=h;break;case"Underline Tooltip":this.underlineBtn=h;break;case"Strikethrough":this.strikethroughBtn=h;break;case"Superscript Tooltip":this.superscriptBtn=h;break;case"Subscript Tooltip":this.subscriptBtn=h;break;default:this.clearFormatBtn=h}return d},e.prototype.createFontColorPicker=function(e,t,r,o){var s=i.i(n.createElement)("input",{id:e,attrs:{type:"color"}});return s.style.width=t+"px",r.appendChild(s),this.fontColorInputElement=new a.ColorPicker({value:"#000000",showButtons:!0,enableRtl:this.isRtl,locale:this.container.locale,enableOpacity:!1},s),this.fontColorInputElement.element.parentElement.setAttribute("title",o),this.fontColorInputElement.element.parentElement.setAttribute("aria-label",o),s},e.prototype.createDropDownListForSize=function(e){var t=this,i=["8","9","10","11","12","14","16","18","20","22","24","26","28","36","48","72","96"];this.fontSize=new r.ComboBox({dataSource:i,popupHeight:"180px",popupWidth:"80px",cssClass:"e-de-prop-dropdown",allowCustom:!0,showClearButton:!1,enableRtl:this.isRtl}),this.fontSize.focus=function(){t.isRetrieving=!1,t.fontSize.element.select()},this.fontSize.value=this.documentEditor.selection.characterFormat.fontSize.toString(),this.fontSize.appendTo(e),this.fontSize.element.parentElement.setAttribute("title",this.localObj.getConstant("Font Size"))},e.prototype.createDropDownListForFamily=function(e){var t=this,o=!1,s="";this.container.enableCsp||(s=i.i(n.initializeCSPTemplate)(function(e){return'<span style="font-family: '+e.FontName+';">'+e.FontName+"</span>"}),o=!0),this.fontFamily=new r.ComboBox({dataSource:void 0,query:(new l.Query).select(["FontName"]),fields:{text:"FontName",value:"FontValue"},popupHeight:"150px",cssClass:"e-de-prop-dropdown",allowCustom:!0,showClearButton:!1,enableRtl:this.isRtl,itemTemplate:s}),this.fontFamily.appendTo(e),this.fontFamily.isStringTemplate=o;for(var a=this.container.documentEditorSettings.fontFamilies,d=0;d<a.length;d++){var h=a[d],c={FontName:h,FontValue:h};this.fontFamily.addItem(c,d)}this.fontFamily.focus=function(){t.isRetrieving=!1,t.fontFamily.element.select()},this.fontFamily.element.parentElement.setAttribute("title",this.localObj.getConstant("Font"))},e.prototype.wireEvent=function(){var e=this;this.fontFamily.addEventListener("change",function(){e.changeFontFamily()}),this.fontSize.addEventListener("change",function(){e.changeFontSize()}),this.bold.addEventListener("click",function(){e.isRetrieving=!1,e.boldAction()}),this.italic.addEventListener("click",function(){e.isRetrieving=!1,e.italicAction()}),this.underline.addEventListener("click",function(){e.isRetrieving=!1,e.underlineAction()}),this.strikethrough.addEventListener("click",function(){e.isRetrieving=!1,e.strikethroughAction()}),this.superscript.addEventListener("click",function(){e.isRetrieving=!1,e.superscriptAction()}),this.subscript.addEventListener("click",function(){e.isRetrieving=!1,e.subscriptAction()}),this.fontColorInputElement.addEventListener("change",function(t){e.isRetrieving=!1,e.changeFontColor(t)}),this.clearFormat.addEventListener("click",function(){e.isRetrieving=!1,e.clearFormatAction()}),this.changeCaseDropdown.addEventListener("select",function(t){e.isRetrieving=!1,e.changeCase(t)})},e.prototype.unwireEvents=function(){this.fontFamily.change=void 0,this.fontSize.change=void 0,this.bold.click=void 0,this.italic.click=void 0,this.underline.click=void 0,this.strikethrough.click=void 0,this.superscript.click=void 0,this.subscript.click=void 0,this.fontColorInputElement.change=void 0,this.highlightColorElement.click=void 0,this.highlightColor.click=void 0,this.clearFormat.click=void 0,this.changeCaseDropdown.select=void 0},e.prototype.boldAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editor&&(this.documentEditor.editor.toggleBold(),this.documentEditor.focusIn())},e.prototype.italicAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editor&&(this.documentEditor.editor.toggleItalic(),this.documentEditor.focusIn())},e.prototype.underlineAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editor&&(this.documentEditor.editor.toggleUnderline("Single"),this.documentEditor.focusIn())},e.prototype.strikethroughAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editor&&(this.documentEditor.editor.toggleStrikethrough(),this.documentEditor.focusIn())},e.prototype.clearFormatAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editor&&this.documentEditor.editor.clearFormatting()},e.prototype.subscriptAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editor&&(this.documentEditor.editor.toggleSubscript(),this.documentEditor.focusIn())},e.prototype.superscriptAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editor&&(this.documentEditor.editor.toggleSuperscript(),this.documentEditor.focusIn())},e.prototype.changeFontColor=function(e){var t=this;this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.selection&&(this.documentEditor.selection.characterFormat.fontColor=e.currentValue.hex,setTimeout(function(){t.documentEditor.focusIn()},30))},e.prototype.changeFontFamily=function(){var e=this;this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.selection&&""!==this.fontFamily.value&&(setTimeout(function(){e.documentEditor.selection.characterFormat.fontFamily=n.SanitizeHtmlHelper.sanitize(e.fontFamily.value)},10),this.documentEditor.focusIn())},e.prototype.changeFontSize=function(){var e=this;this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.selection&&""!==this.fontSize.value&&(setTimeout(function(){e.documentEditor.selection.characterFormat.fontSize=e.fontSize.value},10),this.documentEditor.focusIn())},e.prototype.onSelectionChange=function(){if(this.isRetrieving=!0,this.documentEditor.selection){if(this.documentEditor.selection.characterFormat.fontFamily){var e=void 0;if(e=i.i(n.isNullOrUndefined)(this.documentEditor.selection.characterFormat.renderedFontFamily)||i.i(n.isNullOrUndefined)(this.documentEditor.selection.characterFormat.fontFamily)?this.documentEditor.selection.characterFormat.fontFamily:this.documentEditor.selection.characterFormat.renderedFontFamily,this.fontFamily.value=e,this.fontFamily.dataBind(),i.i(n.isNullOrUndefined)(this.fontFamily.getDataByValue(e))){var t={FontName:e,FontValue:e};this.fontFamily.addItem(t)}}else this.fontFamily.value="";if(this.documentEditor.selection.characterFormat.fontSize?(this.fontSize.value=this.documentEditor.selection.characterFormat.fontSize.toString(),this.fontSize.dataBind()):this.fontSize.value="",this.documentEditor.selection.characterFormat.bold?this.bold.classList.contains("e-btn-toggle")||(this.bold.classList.add("e-btn-toggle"),this.bold.setAttribute("aria-pressed","true")):this.bold.classList.contains("e-btn-toggle")&&(this.bold.classList.remove("e-btn-toggle"),this.bold.setAttribute("aria-pressed","false")),this.documentEditor.selection.characterFormat.italic?this.italic.classList.contains("e-btn-toggle")||(this.italic.classList.add("e-btn-toggle"),this.italic.setAttribute("aria-pressed","true")):this.italic.classList.contains("e-btn-toggle")&&(this.italic.classList.remove("e-btn-toggle"),this.italic.setAttribute("aria-pressed","false")),this.documentEditor.selection.characterFormat.underline&&"None"!==this.documentEditor.selection.characterFormat.underline?this.underline.classList.contains("e-btn-toggle")||(this.underline.classList.add("e-btn-toggle"),this.underline.setAttribute("aria-pressed","true")):this.underline.classList.contains("e-btn-toggle")&&(this.underline.classList.remove("e-btn-toggle"),this.underline.setAttribute("aria-pressed","false")),this.documentEditor.selection.characterFormat.strikethrough&&"None"!==this.documentEditor.selection.characterFormat.strikethrough?this.strikethrough.classList.contains("e-btn-toggle")||(this.strikethrough.classList.add("e-btn-toggle"),this.strikethrough.setAttribute("aria-pressed","true")):this.strikethrough.classList.contains("e-btn-toggle")&&(this.strikethrough.classList.remove("e-btn-toggle"),this.strikethrough.setAttribute("aria-pressed","false")),this.documentEditor.selection.characterFormat.baselineAlignment&&"Subscript"===this.documentEditor.selection.characterFormat.baselineAlignment?this.subscript.classList.contains("e-btn-toggle")||(this.subscript.classList.add("e-btn-toggle"),this.subscript.setAttribute("aria-pressed","true")):this.subscript.classList.contains("e-btn-toggle")&&(this.subscript.classList.remove("e-btn-toggle"),this.subscript.setAttribute("aria-pressed","false")),this.documentEditor.selection.characterFormat.baselineAlignment&&"Superscript"===this.documentEditor.selection.characterFormat.baselineAlignment?this.superscript.classList.contains("e-btn-toggle")||(this.superscript.classList.add("e-btn-toggle"),this.superscript.setAttribute("aria-pressed","true")):this.superscript.classList.contains("e-btn-toggle")&&(this.superscript.classList.remove("e-btn-toggle"),this.superscript.setAttribute("aria-pressed","false")),this.documentEditor.selection.characterFormat.fontColor){var r=this.documentEditor.selection.characterFormat.fontColor;"empty"!==r&&"#00000000"!==r||(r="#000000"),this.fontColorInputElement.value=r}this.documentEditor.selection.characterFormat.highlightColor&&(this.highlightColorInputElement.style.backgroundColor=this.appliedHighlightColor,this.applyHighlightColorAsBackground(this.documentEditor.selection.characterFormat.highlightColor))}},e.prototype.destroy=function(){this.highlightColor&&(this.highlightColor.destroy(),this.highlightColor=void 0),this.fontColorInputElement&&(this.fontColorInputElement.destroy(),this.fontColorInputElement=void 0),this.fontSize&&(this.fontSize.destroy(),this.fontSize=void 0),this.fontFamily&&(this.fontFamily.destroy(),this.fontFamily=void 0),this.changeCaseDropdown&&(this.changeCaseDropdown.destroy(),this.changeCaseDropdown=void 0),this.boldBtn&&(this.boldBtn.destroy(),this.boldBtn=void 0),this.italicBtn&&(this.italicBtn.destroy(),this.italicBtn=void 0),this.underlineBtn&&(this.underlineBtn.destroy(),this.underlineBtn=void 0),this.strikethroughBtn&&(this.strikethroughBtn.destroy(),this.strikethroughBtn=void 0),this.subscriptBtn&&(this.subscriptBtn.destroy(),this.subscriptBtn=void 0),this.superscriptBtn&&(this.superscriptBtn.destroy(),this.superscriptBtn=void 0),this.clearFormatBtn&&(this.clearFormatBtn.destroy(),this.clearFormatBtn=void 0),this.container=void 0},e}())},function(e,t,i){"use strict";var n=i(81);i.d(t,"a",function(){return n.a})},function(e,t,i){"use strict";i.d(t,"a",function(){return p});var n=i(0),r=(i.n(n),i(15)),o=(i.n(r),i(3)),s=(i.n(o),i(19)),a=(i.n(s),i(8)),l=(i.n(a),i(11)),d=i(42),h=i(18),c=(i.n(h),"_use_local_clipboard"),p=function(){function e(e){this.isCommentEditing=!1,this.container=e,this.importHandler=new l.l}return Object.defineProperty(e.prototype,"documentEditor",{get:function(){return this.container.documentEditor},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"toolbar"},e.prototype.enableItems=function(e,t){this.toolbar.enableItems(e,t)},e.prototype.initToolBar=function(e){this.toolbarItems=e,this.renderToolBar(),this.wireEvent()},e.prototype.renderToolBar=function(){if(!i.i(n.isNullOrUndefined)(this.container)){var e=this.container.toolbarContainer,t=i.i(n.createElement)("div",{className:"e-de-tlbr-wrapper"}),r=i.i(n.createElement)("div",{className:"e-de-toolbar"});this.initToolbarItems(),t.appendChild(r),e.appendChild(t);var s=this.container.localObj,a=i.i(n.createElement)("div",{className:"e-de-ctnr-properties-pane-btn"});this.buttonElement=i.i(n.createElement)("button",{attrs:{type:"button","aria-label":s.getConstant("Hide properties pane"),"aria-pressed":"true"}}),a.appendChild(this.buttonElement);var l="e-tbar-btn e-tbtn-txt e-control e-btn e-de-showhide-btn",d="e-icons e-de-ctnr-showhide";this.container.enableRtl&&(l+="-rtl",d="e-icons e-de-ctnr-showhide e-de-flip"),this.propertiesPaneButton=new o.Button({cssClass:l,iconCss:d}),this.container.showPropertiesPane?this.buttonElement.title=s.getConstant("Hide properties pane"):(this.buttonElement.title=s.getConstant("Show properties pane"),a.classList.add("e-de-pane-disable-clr")),this.propertiesPaneButton.appendTo(this.buttonElement),n.EventHandler.add(this.buttonElement,"click",this.showHidePropertiesPane,this),e.appendChild(a),this.toolbar.appendTo(r),this.initToolbarDropdown(r)}},e.prototype.initToolbarDropdown=function(e){var t=this;if(this.container){var r=this.container.localObj,o=this.container.element.id+"_toolbar";if(this.toolbarItems.indexOf("Image")>=0&&(this.imgDropDwn=new s.DropDownButton({items:[{text:r.getConstant("Upload from computer"),iconCss:"e-icons e-de-ctnr-upload",id:o+"_image_local"}],cssClass:"e-de-toolbar-btn-first e-caret-hide",select:this.onDropDownButtonSelect.bind(this)}),this.imgDropDwn.appendTo("#"+o+"_image")),this.toolbarItems.indexOf("PageSetup")>=0&&(this.PageSetUpDropDwn=new s.DropDownButton({items:[{text:r.getConstant("Page Setup"),iconCss:"e-icons e-de-ctnr-page-size",id:o+"_page_set"},{text:r.getConstant("Columns"),iconCss:"e-icons e-de-ctnr-columns",id:o+"_columns"}],cssClass:"e-de-toolbar-btn-first e-caret-hide",select:this.onDropDownButtonSelect.bind(this)}),this.PageSetUpDropDwn.appendTo("#"+o+"_page_setup")),this.toolbarItems.indexOf("Break")>=0){var a=[{text:r.getConstant("Page"),iconCss:"e-de-listview e-de-listview-icon e-icons e-de-ctnr-page-break",id:"_page_break",category:r.getConstant("Page Breaks")},{text:r.getConstant("Column"),iconCss:"e-de-listview e-de-listview-icon e-icons e-de-ctnr-page-break-column",id:"_column_break",category:r.getConstant("Page Breaks")},{text:r.getConstant("Next Page"),iconCss:"e-de-listview e-de-listview-icon e-icons e-de-ctnr-section-break",id:"_section_break",category:r.getConstant("Section Breaks")},{text:r.getConstant("Continuous"),iconCss:"e-de-listview e-de-listview-icon e-icons e-de-ctnr-section-break-continuous",id:"_section_break_continuous",category:r.getConstant("Section Breaks")}],l={target:"#"+o+"_break_listView",cssClass:"e-caret-hide"};this.breakDropDwn=new s.DropDownButton(l,"#"+o+"_break"),this.breakListView=new h.ListView({dataSource:a,width:"170px",fields:{iconCss:"iconCss",groupBy:"category"},showIcon:!0,select:this.onListViewSelection.bind(this)}),this.breakListView.appendTo("#"+o+"_break_listView")}if(this.filePicker=i.i(n.createElement)("input",{attrs:{type:"file",accept:".doc,.docx,.rtf,.txt,.htm,.html,.sfdt"},className:"e-de-ctnr-file-picker"}),n.Browser.isIE&&document.body.appendChild(this.filePicker),this.imagePicker=i.i(n.createElement)("input",{attrs:{type:"file",accept:".jpg,.jpeg,.png,.bmp,.svg"},className:"e-de-ctnr-file-picker"}),n.Browser.isIE&&document.body.appendChild(this.imagePicker),this.toolbarItems.indexOf("LocalClipboard")>=0&&this.toggleButton(o+c,this.container.enableLocalPaste),this.toolbarItems.indexOf("TrackChanges")>=0&&this.toggleButton(o+"_track",this.container.enableTrackChanges),this.toolbarItems.indexOf("RestrictEditing")>=0){this.toggleButton(o+"_restrict_edit",this.container.restrictEditing);var d="";this.container.restrictEditing&&(d=" e-de-selected-item"),this.restrictDropDwn=new s.DropDownButton({items:[{text:r.getConstant("Read only"),id:o+"_read_only",iconCss:"e-icons"+d},{text:r.getConstant("Protections"),id:o+"_protections",iconCss:"e-icons"}],cssClass:"e-de-toolbar-btn-first e-caret-hide",select:this.onDropDownButtonSelect.bind(this),beforeItemRender:function(e){t.onBeforeRenderRestrictDropdown(e,o)}}),this.restrictDropDwn.appendTo("#"+o+"_restrict_edit")}this.toolbarItems.indexOf("FormFields")>=0&&(this.formFieldDropDown=new s.DropDownButton({items:[{text:r.getConstant("Text Form"),iconCss:"e-icons e-de-textform",id:o+"_text_form"},{text:r.getConstant("Check Box"),iconCss:"e-icons e-de-checkbox-form",id:o+"_checkbox"},{text:r.getConstant("DropDown"),iconCss:"e-icons e-de-dropdownform",id:o+"_dropdown"}],cssClass:"e-de-toolbar-btn-first e-caret-hide",select:this.onDropDownButtonSelect.bind(this)}),this.formFieldDropDown.appendTo("#"+o+"_form_fields"))}},e.prototype.onListViewSelection=function(e){var t=this.container.element.id+"_toolbar",i=e.item.id;i===t+"_break_listView__page_break"?this.container.documentEditor.editorModule.insertPageBreak():i===t+"_break_listView__section_break"?this.container.documentEditor.editorModule.insertSectionBreak():i===t+"_break_listView__section_break_continuous"?this.container.documentEditor.editorModule.insertSectionBreak(d.SectionBreakType.Continuous):i===t+"_break_listView__column_break"&&this.container.documentEditor.editorModule.insertColumnBreak(),e.item.classList.remove("e-active")},e.prototype.onBeforeRenderRestrictDropdown=function(e,t){var r=e.element.getElementsByClassName("e-menu-icon")[0];if(!i.i(n.isNullOrUndefined)(r)&&(e.item.id===t+"_read_only"&&this.toggleRestrictIcon(r,this.container.restrictEditing),e.item.id===t+"_protections")){var o=document.getElementsByClassName("e-de-restrict-pane")[0];if(!i.i(n.isNullOrUndefined)(o)){var s=!("none"===o.style.display);this.toggleRestrictIcon(r,s)}}},e.prototype.toggleRestrictIcon=function(e,t){t?e.classList.add("e-de-selected-item"):e.classList.remove("e-de-selected-item")},e.prototype.showHidePropertiesPane=function(){var e=document.getElementsByClassName("e-de-ctnr-properties-pane-btn")[0],t=this.container.localObj;"none"===this.container.propertiesPaneContainer.style.display?(this.container.showPropertiesPane=!0,e.classList.remove("e-de-pane-disable-clr"),this.buttonElement.title=t.getConstant("Hide properties pane"),this.buttonElement.setAttribute("aria-label",t.getConstant("Hide properties pane")),this.buttonElement.setAttribute("aria-pressed","true"),i.i(n.classList)(e,["e-de-pane-enable-clr"],[]),this.container.trigger(l.e,{type:"PropertiesPane"})):this.container.previousContext.indexOf("Header")>=0||this.container.previousContext.indexOf("Footer")>=0?this.container.showHeaderProperties=!this.container.showHeaderProperties:(this.container.showPropertiesPane=!1,e.classList.remove("e-de-pane-enable-clr"),this.buttonElement.title=t.getConstant("Show properties pane"),this.buttonElement.setAttribute("aria-label",t.getConstant("Show properties pane")),this.buttonElement.setAttribute("aria-pressed","false"),i.i(n.classList)(e,["e-de-pane-disable-clr"],[])),this.enableDisablePropertyPaneButton(this.container.showPropertiesPane),this.container.showPropertiesPaneOnSelection(),this.documentEditor.focusIn()},e.prototype.onWrapText=function(e){var t="",i=e.lastIndexOf(" ");return-1!==i?(t=e.slice(0,i),e.slice(i),t+='<div class="e-de-text-wrap">'+e.slice(i)+"</div>"):t=e,t},e.prototype.wireEvent=function(){this.propertiesPaneButton.on("click",this.togglePropertiesPane.bind(this)),n.EventHandler.add(this.filePicker,"change",this.onFileChange,this),n.EventHandler.add(this.imagePicker,"change",this.onImageChange,this)},e.prototype.initToolbarItems=function(){this.toolbar=new r.Toolbar({enableRtl:this.container.enableRtl,clicked:this.clickHandler.bind(this),items:this.getToolbarItems()})},e.prototype.reInitToolbarItems=function(e){for(var t=this,r=0;r<e.length;r++)switch(e[parseInt(r.toString(),10)]){case"RestrictEditing":i.i(n.isNullOrUndefined)(this.restrictDropDwn)||this.restrictDropDwn.destroy();break;case"Break":i.i(n.isNullOrUndefined)(this.breakDropDwn)||this.breakDropDwn.destroy();break;case"PageSetup":i.i(n.isNullOrUndefined)(this.PageSetUpDropDwn)||this.PageSetUpDropDwn.destroy();break;case"Image":i.i(n.isNullOrUndefined)(this.imgDropDwn)||this.imgDropDwn.destroy();break;case"FormFields":i.i(n.isNullOrUndefined)(this.formFieldDropDown)||this.formFieldDropDown.destroy()}this.toolbarItems=e;var o=this.container.toolbarContainer;this.toolbar.items=this.getToolbarItems(),this.toolbarTimer=setTimeout(function(){t.toolbarTimer&&clearTimeout(t.toolbarTimer),t.initToolbarDropdown(o),e.indexOf("Open")>=0&&n.EventHandler.add(t.filePicker,"change",t.onFileChange,t),e.indexOf("Image")>=0&&n.EventHandler.add(t.imagePicker,"change",t.onImageChange,t)},200)},e.prototype.getToolbarItems=function(){for(var e,t=this.container.localObj,i=this.container.element.id+"_toolbar",n=[],r=this.toolbarItems,o=0;o<this.toolbarItems.length;o++)switch(e=0===o?"e-de-toolbar-btn-start":"Separator"===r[o+1]&&"Separator"===r[o-1]?"e-de-toolbar-btn":"Separator"===r[o+1]?"e-de-toolbar-btn-last":"Separator"===r[o-1]?"e-de-toolbar-btn-first":o===this.toolbarItems.length-1?"e-de-toolbar-btn-end":"e-de-toolbar-btn-middle",r[parseInt(o.toString(),10)]){case"Separator":n.push({type:"Separator",cssClass:"e-de-separator"});break;case"New":n.push({prefixIcon:"e-de-ctnr-new",tooltipText:t.getConstant("Create a new document"),id:i+"_new",text:t.getConstant("New"),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Create a new document")}});break;case"Open":n.push({prefixIcon:"e-de-ctnr-open",tooltipText:t.getConstant("Open a document"),id:i+"_open",text:t.getConstant("Open"),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Open a document")}});break;case"Undo":n.push({prefixIcon:"e-de-ctnr-undo",tooltipText:t.getConstant("Undo Tooltip"),id:i+"_undo",text:t.getConstant("Undo"),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Undo Tooltip")}});break;case"Redo":n.push({prefixIcon:"e-de-ctnr-redo",tooltipText:t.getConstant("Redo Tooltip"),id:i+"_redo",text:t.getConstant("Redo"),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Redo Tooltip")}});break;case"Comments":n.push({prefixIcon:"e-de-cnt-cmt-add",tooltipText:t.getConstant("Show comments"),id:i+"_comment",text:t.getConstant("Comments"),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Show comments")}});break;case"TrackChanges":n.push({prefixIcon:"e-de-cnt-track",tooltipText:t.getConstant("Track Changes"),id:i+"_track",text:this.onWrapText(t.getConstant("TrackChanges")),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("TrackChanges"),"aria-pressed":this.container.enableTrackChanges,role:"button","aria-hidden":"true"}});break;case"Image":n.push({template:'<button title="'+t.getConstant("Insert inline picture from a file")+'" class="e-tbar-btn e-tbtn-txt e-control e-btn e-lib e-dropdown-btn e-de-toolbar-btn-first e-caret-hide" type="button" id="'+i+'_image"><span class="e-btn-icon e-icons e-de-ctnr-image e-icon-left"></span><span class="e-tbar-btn-text">'+t.getConstant("Image")+'</span><span class="e-btn-icon e-icons e-icon-right e-caret"></span></button>',id:i+"_image",htmlAttributes:{"aria-label":t.getConstant("Insert inline picture from a file"),"aria-haspopup":!1}});break;case"Table":n.push({prefixIcon:"e-de-ctnr-table",tooltipText:t.getConstant("Insert a table into the document"),id:i+"_table",text:t.getConstant("Table"),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Insert a table into the document"),"aria-haspopup":!0}});break;case"Hyperlink":n.push({prefixIcon:"e-de-ctnr-link",tooltipText:t.getConstant("Create Hyperlink"),id:i+"_link",text:t.getConstant("Link"),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Create Hyperlink"),"aria-haspopup":!0}});break;case"Bookmark":n.push({prefixIcon:"e-de-ctnr-bookmark",tooltipText:t.getConstant("Insert a bookmark in a specific place in this document"),id:i+"_bookmark",text:t.getConstant("Bookmark"),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Insert a bookmark in a specific place in this document"),"aria-haspopup":!0}});break;case"TableOfContents":n.push({prefixIcon:"e-de-ctnr-tableofcontent",tooltipText:t.getConstant("Provide an overview of your document by adding a table of contents"),id:i+"_toc",text:this.onWrapText(t.getConstant("Table of Contents")),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Table of Contents")}});break;case"Header":n.push({prefixIcon:"e-de-ctnr-header",tooltipText:t.getConstant("Add or edit the header"),id:i+"_header",text:t.getConstant("Header"),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Add or edit the header")}});break;case"Footer":n.push({prefixIcon:"e-de-ctnr-footer",tooltipText:t.getConstant("Add or edit the footer"),id:i+"_footer",text:t.getConstant("Footer"),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Add or edit the footer")}});break;case"PageSetup":n.push({template:'<button title="'+t.getConstant("Page Setup")+'" class="e-tbar-btn e-tbtn-txt e-control e-btn e-lib e-dropdown-btn e-caret-hide" type="button" id="'+i+'_page_setup"><span class="e-btn-icon e-icons e-de-ctnr-pagesetup e-icon-left"></span><span class="e-tbar-btn-text">'+this.onWrapText(t.getConstant("Page Setup"))+'</span><span class="e-btn-icon e-icons e-icon-right e-caret"></span></button>',id:i+"_page_setup",htmlAttributes:{"aria-label":t.getConstant("Page Setup")}});break;case"PageNumber":n.push({prefixIcon:"e-de-ctnr-pagenumber",tooltipText:t.getConstant("Add page numbers"),id:i+"_page_number",text:this.onWrapText(t.getConstant("Page Number")),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Page Number")}});break;case"Break":n.push({template:'<button title="'+t.getConstant("Break")+'" class="e-tbar-btn e-tbtn-txt e-control e-btn e-lib e-dropdown-btn e-caret-hide" type="button" id="'+i+'_break"><span class="e-btn-icon e-icons e-de-ctnr-break e-icon-left"></span><span class="e-tbar-btn-text">'+t.getConstant("Break")+'</span><span class="e-btn-icon e-icons e-icon-right e-caret"></span></button><div id="'+i+'_break_listView"></div>',id:i+"_break",htmlAttributes:{"aria-label":t.getConstant("Break")}});break;case"Find":n.push({prefixIcon:"e-de-ctnr-find",tooltipText:t.getConstant("Find Text"),id:i+"_find",text:t.getConstant("Find"),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Find Text")}});break;case"LocalClipboard":n.push({prefixIcon:"e-de-ctnr-paste",tooltipText:t.getConstant("Toggle between the internal clipboard and system clipboard"),id:i+c,text:this.onWrapText(t.getConstant("Local Clipboard")),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Local Clipboard"),"aria-pressed":this.container.enableLocalPaste,role:"button","aria-hidden":"true"}});break;case"RestrictEditing":n.push({template:'<button title="'+t.getConstant("Restrict editing")+'" class="e-tbar-btn e-tbtn-txt e-control e-btn e-lib e-dropdown-btn e-de-toolbar-btn-first e-caret-hide" type="button" id="'+i+'_restrict_edit"><span class="e-btn-icon e-de-ctnr-lock e-icons e-icon-left"></span><span class="e-tbar-btn-text">'+this.onWrapText(t.getConstant("Restrict Editing"))+'</span><span class="e-btn-icon e-icons e-icon-right e-caret"></span></button>',htmlAttributes:{"aria-label":t.getConstant("Restrict editing")}});break;case"FormFields":n.push({template:'<button title="'+t.getConstant("Form Fields")+'" class="e-tbar-btn e-tbtn-txt e-control e-btn e-lib e-dropdown-btn e-de-toolbar-btn-first e-caret-hide" type="button" id="'+i+'_form_fields"><span class="e-btn-icon e-de-formfield e-icons e-icon-left"></span><span class="e-tbar-btn-text">'+this.onWrapText(t.getConstant("Form Fields"))+'</span><span class="e-btn-icon e-icons e-icon-right e-caret"></span></button>',id:i+"_form_fields",htmlAttributes:{"aria-label":t.getConstant("Form Fields")}});break;case"UpdateFields":n.push({prefixIcon:"e-de-update-field",tooltipText:t.getConstant("Update cross reference fields"),id:i+"_update_fields",text:this.onWrapText(t.getConstant("Update Fields")),cssClass:e+" e-de-formfields",htmlAttributes:{"aria-label":t.getConstant("Update cross reference fields")}});break;case"InsertFootnote":n.push({prefixIcon:"e-de-footnote",tooltipText:t.getConstant("Footnote Tooltip"),text:this.onWrapText(t.getConstant("Insert Footnote")),id:i+"_footnote",cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Insert Footnote")}});break;case"InsertEndnote":n.push({prefixIcon:"e-de-endnote",tooltipText:t.getConstant("Endnote Tooltip"),text:this.onWrapText(t.getConstant("Insert Endnote")),id:i+"_endnote",cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Insert Endnote")}});break;default:n.push(r[parseInt(o.toString(),10)])}for(var o=0;o<n.length;o++){var s=void 0;"Separator"!==n[o].text&&(s=o.toString(),n[o].htmlattributes={tabindex:s})}return n},e.prototype.clickHandler=function(e){var t=this.container.element.id+"_toolbar";switch(e.item.id){case t+"_new":this.container.documentEditor.openBlank(),this.documentEditor.focusIn();break;case t+"_open":this.filePicker.value="",this.filePicker.click(),this.documentEditor.focusIn();break;case t+"_undo":this.container.documentEditor.editorHistory.undo();break;case t+"_redo":this.container.documentEditor.editorHistory.redo();break;case t+"_table":this.container.documentEditor.showDialog("Table");break;case t+"_link":this.container.documentEditor.showDialog("Hyperlink");break;case t+"_bookmark":this.container.documentEditor.showDialog("Bookmark");break;case t+"_comment":this.documentEditor.editor.isUserInsert=!0,this.documentEditor.editor.insertComment(""),this.documentEditor.editor.isUserInsert=!1;break;case t+"_track":this.toggleTrackChangesInternal(e.item.id);break;case t+"_header":this.container.documentEditor.selection.goToHeader(),this.container.statusBar.toggleWebLayout();break;case t+"_toc":this.onToc();break;case t+"_footer":this.container.documentEditor.selection.goToFooter(),this.container.statusBar.toggleWebLayout();break;case t+"_page_number":this.container.documentEditor.editor.insertPageNumber();break;case t+"_find":this.container.documentEditor.showOptionsPane();break;case t+c:this.toggleLocalPaste(e.item.id);break;case t+"_update_fields":this.documentEditor.updateFields();break;case t+"_footnote":this.documentEditor.editor.insertFootnote();break;case t+"_endnote":this.documentEditor.editor.insertEndnote();break;default:this.container.trigger(l.x,e)}e.item.id!==t+"_find"&&e.item.id!==t+"_image"&&e.item.id!==t+"_bookmark"&&e.item.id!==t+"_table"&&e.item.id!==t+"_link"&&this.container.documentEditor.focusIn()},e.prototype.toggleLocalPaste=function(e){this.container.enableLocalPaste=!this.container.enableLocalPaste,this.toggleButton(e,this.container.enableLocalPaste)},e.prototype.toggleEditing=function(){this.container.restrictEditing=!this.container.restrictEditing,this.container.showPropertiesPane=!this.container.restrictEditing},e.prototype.toggleRestrictEditing=function(e){var t=this.container.element.id+"_toolbar_restrict_edit";document.getElementById(t)&&this.toggleButton(t,e)},e.prototype.toggleButton=function(e,t){var r=document.getElementById(e);t?(i.i(n.classList)(r,["e-btn-toggle"],[]),r.setAttribute("aria-pressed","true")):(i.i(n.classList)(r,[],["e-btn-toggle"]),r.setAttribute("aria-pressed","false"))},e.prototype.toggleTrackChangesInternal=function(e,t){i.i(n.isNullOrUndefined)(t)||(this.container.enableTrackChanges=!t),this.container.enableTrackChanges=!this.container.enableTrackChanges,this.toggleButton(e,this.container.enableTrackChanges)},e.prototype.togglePropertiesPane=function(){this.container.showPropertiesPane=!this.container.showPropertiesPane},e.prototype.onDropDownButtonSelect=function(e){var t=this,i=this.container.element.id+"_toolbar",n=e.item.id;n===i+"_image_local"?(this.imagePicker.value="",this.imagePicker.click()):n===i+"_page_set"?this.container.documentEditor.showDialog("PageSetup"):n===i+"_columns"?this.container.documentEditor.showDialog("Columns"):n===i+"_image_url"||(n===i+"_read_only"?this.toggleEditing():n===i+"_protections"?this.documentEditor.documentHelper.restrictEditingPane.showHideRestrictPane(!0):n===i+"_checkbox"?this.documentEditor.editor.insertFormField("CheckBox"):n===i+"_dropdown"?this.documentEditor.editor.insertFormField("DropDown"):n===i+"_text_form"&&this.documentEditor.editor.insertFormField("Text")),setTimeout(function(){t.documentEditor.focusIn()},30)},e.prototype.onFileChange=function(){var e=this,t=this.filePicker.files[0],i=t.size,r={fileSize:i,isCanceled:void 0};if(this.documentEditor.trigger(l.y,r),!r.isCanceled&&t){var o=t.name.substr(t.name.lastIndexOf("."));if(".sfdt"===o||".txt"===o){var s=new FileReader;s.onload=function(){".txt"===o?e.container.documentEditor.documentHelper.openTextFile(s.result):e.container.documentEditor.open(s.result)},s.readAsText(t)}else if(this.isSupportedFormatType(o.toLowerCase()))this.convertToSfdt(t);else{var d=new n.L10n("documenteditor",this.documentEditor.defaultLocale);a.DialogUtility.alert({content:d.getConstant("Unsupported format"),closeOnEscape:!0,showCloseIcon:!0,position:{X:"Center",Y:"Center"}}).enableRtl=this.container.enableRtl}this.container.documentEditor.documentName=t.name.substr(0,t.name.lastIndexOf("."))}},e.prototype.isSupportedFormatType=function(e){switch(e){case".dotx":case".docx":case".docm":case".dotm":case".dot":case".doc":case".rtf":case".txt":case".xml":case".html":return!0;default:return!1}},e.prototype.convertToSfdt=function(e){i.i(a.showSpinner)(this.container.containerTarget),this.importHandler.url=this.container.serviceUrl+this.container.serverActionSettings.import,this.importHandler.onSuccess=this.successHandler.bind(this),this.importHandler.onFailure=this.failureHandler.bind(this),this.importHandler.onError=this.failureHandler.bind(this),this.importHandler.customHeaders=this.container.headers;var t={serverActionType:"Import",headers:this.container.headers,timeout:0,cancel:!1,withCredentials:!1};this.container.trigger(d.beforeXmlHttpRequestSend,t);var n=new FormData;n.append("files",e),t.cancel?i.i(a.hideSpinner)(this.container.containerTarget):this.importHandler.send(n,t)},e.prototype.failureHandler=function(e){"onError"===e.name?a.DialogUtility.alert({content:this.container.localObj.getConstant("Error in establishing connection with web server"),closeOnEscape:!0,showCloseIcon:!0,position:{X:"Center",Y:"Center"}}).enableRtl=this.container.enableRtl:(alert("Failed to load the file"),this.documentEditor.fireServiceFailure(e)),i.i(a.hideSpinner)(this.container.containerTarget)},e.prototype.successHandler=function(e){this.container.documentEditor.open(e.data),i.i(a.hideSpinner)(this.container.containerTarget)},e.prototype.onImageChange=function(){var e=this,t=this.imagePicker.files[0],i=new FileReader;i.onload=function(){e.insertImage(i.result)},i.readAsDataURL(t)},e.prototype.insertImage=function(e){var t=document.createElement("img"),i=this.container;t.addEventListener("load",function(){i.documentEditor.editor.insertImageInternal(e,!0,this.width,this.height,this.alt)}),t.src=e},e.prototype.enableDisableFormField=function(e){var t=document.getElementById("container_toolbar_form_fields");i.i(n.isNullOrUndefined)(t)||this.toolbar.enableItems(t.parentElement,e)},e.prototype.enableDisableInsertComment=function(e){this.isCommentEditing=!e;var t=this.container.element.id+"_toolbar",r=t+"_comment",o=document.getElementById(r);!this.container.enableComment&&o?this.toolbar.removeItems(o.parentElement):o&&(i.i(n.isNullOrUndefined)(this.documentEditor)||!this.documentEditor.isReadOnly&&!this.documentEditor.documentHelper.isDocumentProtected||(e=this.documentEditor.documentHelper.isCommentOnlyMode||!this.documentEditor.isReadOnlyMode),this.toolbar.enableItems(o.parentElement,e))},e.prototype.toggleTrackChanges=function(e){var t=this.container.element.id+"_toolbar_track";document.getElementById(t)&&this.toggleTrackChangesInternal(t,e)},e.prototype.enableDisableToolBarItem=function(e,t){for(var r=this.container.element.id+"_toolbar",o=0,s=this.toolbar.items;o<s.length;o++){var a=s[o],l=a.id;if(l!==r+"_new"&&l!==r+"_open"&&l!==r+"_find"&&l!==r+c&&l!==r+"_restrict_edit"&&"Separator"!==a.type){if(e&&this.isCommentEditing&&l===r+"_comment")continue;if(l!==r+"_undo"&&l!==r+"_redo"&&l!==r+"_table"&&l!==r+"_link"&&l!==r+"_bookmark"&&l!==r+"_comment"&&l!==r+"_header"&&l!==r+"_toc"&&l!==r+"_footer"&&l!==r+"_page_setup"&&l!==r+"_page_number"&&l!==r+"_image"&&l!==r+"_form_fields"&&l!==r+"_break"&&l!==r+"_track"&&l!==r+"_footnote"&&l!==r+"_endnote"&&l!==r+"_update_fields")continue;if(t&&this.documentEditor.documentHelper.isFormFillProtectedMode&&l===r+"_update_fields")continue;var d=document.getElementById(a.id);i.i(n.isNullOrUndefined)(d)||i.i(n.isNullOrUndefined)(d.parentElement)||this.toolbar.enableItems(d.parentElement,e)}}i.i(n.isNullOrUndefined)(this.documentEditor)||this.enableDisableFormField(!this.documentEditor.enableHeaderAndFooter&&e&&!this.documentEditor.isReadOnlyMode),(this.documentEditor.selection.isinFootnote||this.documentEditor.selection.isinEndnote||this.documentEditor.enableHeaderAndFooter)&&(this.containsItem(r+"_endnote")&&this.toolbar.enableItems(document.getElementById(r+"_endnote").parentElement,!1),this.containsItem(r+"_footnote")&&this.toolbar.enableItems(document.getElementById(r+"_footnote").parentElement,!1),this.containsItem(r+"_break")&&this.toolbar.enableItems(document.getElementById(r+"_break").parentElement,!1)),t&&!this.container.showPropertiesPane||(t&&(e=this.container.showPropertiesPane),i.i(n.classList)(this.propertiesPaneButton.element.parentElement,e?[]:["e-de-overlay"],e?["e-de-overlay"]:[]));var h=this.documentEditor.documentHelper.protectionType;(e||this.documentEditor.documentHelper.isDocumentProtected&&("FormFieldsOnly"===h||"CommentsOnly"===h))&&this.enableDisableUndoRedo(),this.documentEditor.documentHelper.isTrackedOnlyMode&&this.containsItem(r+"_track")&&this.toolbar.enableItems(document.getElementById(r+"_track").parentElement,!1)},e.prototype.containsItem=function(e){for(var t=0,i=this.toolbar.items;t<i.length;t++){if(i[t].id===e)return!0}return!1},e.prototype.enableDisableUndoRedo=function(){var e=this.container.element.id+"_toolbar";if(this.toolbarItems.indexOf("Undo")>=0){var t=document.getElementById(e+"_undo");i.i(n.isNullOrUndefined)(t)||this.toolbar.enableItems(t.parentElement,this.container.documentEditor.editorHistory.canUndo())}if(this.toolbarItems.indexOf("Redo")>=0){var r=document.getElementById(e+"_redo");i.i(n.isNullOrUndefined)(r)||this.toolbar.enableItems(r.parentElement,this.container.documentEditor.editorHistory.canRedo())}},e.prototype.onToc=function(){if("TableOfContents"===this.container.previousContext&&"none"===this.container.propertiesPaneContainer.style.display)return this.container.showPropertiesPane=!1,void this.documentEditor.focusIn();"block"===this.container.headerFooterProperties.element.style.display&&this.documentEditor.selection.closeHeaderFooter(),this.enableDisablePropertyPaneButton(!1),this.container.showProperties("toc")},e.prototype.enableDisablePropertyPaneButton=function(e){e?i.i(n.classList)(this.propertiesPaneButton.element.firstChild,["e-pane-enabled"],["e-pane-disabled"]):i.i(n.classList)(this.propertiesPaneButton.element.firstChild,["e-pane-disabled"],["e-pane-enabled"])},e.prototype.destroy=function(){if(this.restrictDropDwn&&(this.restrictDropDwn.destroy(),this.restrictDropDwn=void 0),this.imgDropDwn&&(this.imgDropDwn.destroy(),this.imgDropDwn=void 0),this.PageSetUpDropDwn&&(this.PageSetUpDropDwn.destroy(),this.PageSetUpDropDwn=void 0),this.breakDropDwn&&(this.breakDropDwn.destroy(),this.breakDropDwn=void 0),this.formFieldDropDown&&(this.formFieldDropDown.destroy(),this.formFieldDropDown=void 0),this.toolbar){var e=this.toolbar.element;this.toolbar.destroy(),this.toolbar=void 0,e.parentElement.removeChild(e)}this.container.toolbarContainer&&(this.container.containerTarget.removeChild(this.container.toolbarContainer),this.container.toolbarContainer=void 0),this.container.toolbarModule&&(this.container.toolbarModule=void 0),this.propertiesPaneButton&&this.propertiesPaneButton.destroy(),this.breakListView&&(this.breakListView.destroy(),this.breakListView=void 0),this.propertiesPaneButton=void 0,this.toolbarItems=[],this.toolbarItems=void 0,this.container=void 0},e}()},function(e,t,i){"use strict";i.d(t,"d",function(){return n}),i.d(t,"e",function(){return r}),i.d(t,"f",function(){return o}),i.d(t,"g",function(){return s}),i.d(t,"h",function(){return a}),i.d(t,"i",function(){return l}),i.d(t,"j",function(){return d}),i.d(t,"k",function(){return h}),i.d(t,"l",function(){return c}),i.d(t,"m",function(){return p}),i.d(t,"n",function(){return u}),i.d(t,"o",function(){return g}),i.d(t,"p",function(){return f}),i.d(t,"q",function(){return m}),i.d(t,"r",function(){return v}),i.d(t,"s",function(){return y}),i.d(t,"t",function(){return w}),i.d(t,"u",function(){return b}),i.d(t,"v",function(){return x}),i.d(t,"w",function(){return C}),i.d(t,"x",function(){return I}),i.d(t,"y",function(){return F}),i.d(t,"z",function(){return k}),i.d(t,"A",function(){return P}),i.d(t,"B",function(){return T}),i.d(t,"C",function(){return S}),i.d(t,"D",function(){return W}),i.d(t,"E",function(){return N}),i.d(t,"F",function(){return H}),i.d(t,"G",function(){return E}),i.d(t,"H",function(){return O}),i.d(t,"I",function(){return _}),i.d(t,"J",function(){return B}),i.d(t,"K",function(){return L}),i.d(t,"L",function(){return R}),i.d(t,"M",function(){return A}),i.d(t,"N",function(){return D}),i.d(t,"O",function(){return U}),i.d(t,"P",function(){return M}),i.d(t,"Q",function(){return V}),i.d(t,"R",function(){return z}),i.d(t,"S",function(){return j}),i.d(t,"T",function(){return q}),i.d(t,"U",function(){return G}),i.d(t,"V",function(){return K}),i.d(t,"W",function(){return Z}),i.d(t,"X",function(){return X}),i.d(t,"Y",function(){return J}),i.d(t,"Z",function(){return Y}),i.d(t,"_0",function(){return Q}),i.d(t,"_1",function(){return $}),i.d(t,"_2",function(){return ee}),i.d(t,"_3",function(){return te}),i.d(t,"_4",function(){return ie}),i.d(t,"_5",function(){return ne}),i.d(t,"_6",function(){return re}),i.d(t,"_7",function(){return oe}),i.d(t,"_8",function(){return se}),i.d(t,"_9",function(){return ae}),i.d(t,"_10",function(){return le}),i.d(t,"_11",function(){return de}),i.d(t,"_12",function(){return he}),i.d(t,"_13",function(){return ce}),i.d(t,"_14",function(){return pe}),i.d(t,"_15",function(){return ue}),i.d(t,"_16",function(){return ge}),i.d(t,"_17",function(){return fe}),i.d(t,"_18",function(){return me}),i.d(t,"_19",function(){return ve}),i.d(t,"_20",function(){return ye}),i.d(t,"_21",function(){return we}),i.d(t,"_22",function(){return be}),i.d(t,"_23",function(){return xe}),i.d(t,"_24",function(){return Ce}),i.d(t,"_25",function(){return Ie}),i.d(t,"_26",function(){return Fe}),i.d(t,"_27",function(){return ke}),i.d(t,"_28",function(){return Pe}),i.d(t,"_29",function(){return Te}),i.d(t,"_30",function(){return Se}),i.d(t,"_31",function(){return We}),i.d(t,"_32",function(){return Ne}),i.d(t,"_33",function(){return He}),i.d(t,"_34",function(){return Ee}),i.d(t,"_35",function(){return Oe}),i.d(t,"_36",function(){return _e}),i.d(t,"_37",function(){return Be}),i.d(t,"_38",function(){return Le}),i.d(t,"_39",function(){return Re}),i.d(t,"_40",function(){return Ae}),i.d(t,"_41",function(){return De}),i.d(t,"_42",function(){return Ue}),i.d(t,"_43",function(){return Me}),i.d(t,"_44",function(){return Ve}),i.d(t,"_45",function(){return ze}),i.d(t,"_46",function(){return je}),i.d(t,"_47",function(){return qe}),i.d(t,"_48",function(){return Ge}),i.d(t,"_49",function(){return Ke}),i.d(t,"_50",function(){return Ze}),i.d(t,"_51",function(){return Xe}),i.d(t,"_52",function(){return Je}),i.d(t,"_53",function(){return Ye}),i.d(t,"_54",function(){return Qe}),i.d(t,"_55",function(){return $e}),i.d(t,"_56",function(){return et}),i.d(t,"_57",function(){return tt}),i.d(t,"_58",function(){return it}),i.d(t,"_59",function(){return nt}),i.d(t,"_60",function(){return rt}),i.d(t,"_61",function(){return ot}),i.d(t,"_62",function(){return st}),i.d(t,"_63",function(){return at}),i.d(t,"_64",function(){return lt}),i.d(t,"_65",function(){return dt}),i.d(t,"_66",function(){return ht}),i.d(t,"_67",function(){return ct}),i.d(t,"_68",function(){return pt}),i.d(t,"_69",function(){return ut}),i.d(t,"_70",function(){return gt}),i.d(t,"_71",function(){return ft}),i.d(t,"_72",function(){return mt}),i.d(t,"_73",function(){return vt}),i.d(t,"_74",function(){return yt}),i.d(t,"_75",function(){return wt}),i.d(t,"_76",function(){return bt}),i.d(t,"_77",function(){return xt}),i.d(t,"_78",function(){return Ct}),i.d(t,"_79",function(){return It}),i.d(t,"_80",function(){return Ft}),i.d(t,"_81",function(){return kt}),i.d(t,"_82",function(){return Pt}),i.d(t,"_83",function(){return Tt}),i.d(t,"_84",function(){return St}),i.d(t,"_85",function(){return Wt}),i.d(t,"_86",function(){return Nt}),i.d(t,"_87",function(){return Ht}),i.d(t,"_88",function(){return Et}),i.d(t,"_89",function(){return Ot}),i.d(t,"_90",function(){return _t}),i.d(t,"_91",function(){return Bt}),i.d(t,"_92",function(){return Lt}),i.d(t,"_93",function(){return Rt}),i.d(t,"_94",function(){return At}),i.d(t,"_95",function(){return Dt}),i.d(t,"_96",function(){return Ut}),i.d(t,"_97",function(){return Mt}),i.d(t,"_98",function(){return Vt}),i.d(t,"_99",function(){return zt}),i.d(t,"_100",function(){return jt}),i.d(t,"_101",function(){return qt}),i.d(t,"_102",function(){return Gt}),i.d(t,"_103",function(){return Kt}),i.d(t,"_104",function(){return Zt}),i.d(t,"_105",function(){return Xt}),i.d(t,"_106",function(){return Jt}),i.d(t,"_107",function(){return Yt}),i.d(t,"_108",function(){return Qt}),i.d(t,"_109",function(){return $t}),i.d(t,"_110",function(){return ei}),i.d(t,"_111",function(){return ti}),i.d(t,"_112",function(){return ii}),i.d(t,"_113",function(){return ni}),i.d(t,"_114",function(){return ri}),i.d(t,"_115",function(){return oi}),i.d(t,"_116",function(){return si}),i.d(t,"_117",function(){return ai}),i.d(t,"_118",function(){return li}),i.d(t,"_119",function(){return di}),i.d(t,"_120",function(){return hi}),i.d(t,"_121",function(){return ci}),i.d(t,"_122",function(){return pi}),i.d(t,"_123",function(){return ui}),i.d(t,"_124",function(){return gi}),i.d(t,"_125",function(){return fi}),i.d(t,"_126",function(){return mi}),i.d(t,"_127",function(){return vi}),i.d(t,"_128",function(){return yi}),i.d(t,"_129",function(){return wi}),i.d(t,"_130",function(){return bi}),i.d(t,"_131",function(){return xi}),i.d(t,"_132",function(){return Ci}),i.d(t,"_133",function(){return Ii}),i.d(t,"_134",function(){return Fi}),i.d(t,"_135",function(){return ki}),i.d(t,"_136",function(){return Pi}),i.d(t,"_137",function(){return Ti}),i.d(t,"_138",function(){return Si}),i.d(t,"_139",function(){return Wi}),i.d(t,"_140",function(){return Ni}),i.d(t,"_141",function(){return Hi}),i.d(t,"_142",function(){return Ei}),i.d(t,"_143",function(){return Oi}),i.d(t,"_144",function(){return _i}),i.d(t,"_145",function(){return Bi}),i.d(t,"_146",function(){return Li}),i.d(t,"_147",function(){return Ri}),i.d(t,"_148",function(){return Ai}),i.d(t,"_149",function(){return Di}),i.d(t,"_150",function(){return Ui});i.d(t,"_151",function(){return Mi}),i.d(t,"_152",function(){return Vi}),i.d(t,"_153",function(){return zi}),i.d(t,"_154",function(){return ji}),i.d(t,"_155",function(){return qi}),i.d(t,"_156",function(){return Gi}),i.d(t,"_157",function(){return Ki}),i.d(t,"_158",function(){return Zi}),i.d(t,"_159",function(){return Xi}),i.d(t,"_160",function(){return Ji}),i.d(t,"_161",function(){return Yi}),i.d(t,"_162",function(){return Qi}),i.d(t,"_163",function(){return $i}),i.d(t,"_164",function(){return en}),i.d(t,"_165",function(){return tn}),i.d(t,"_166",function(){return nn}),i.d(t,"_167",function(){return rn}),i.d(t,"_168",function(){return on}),i.d(t,"_169",function(){return sn}),i.d(t,"_170",function(){return an}),i.d(t,"_171",function(){return ln}),i.d(t,"_172",function(){return dn}),i.d(t,"_173",function(){return hn}),i.d(t,"_174",function(){return cn}),i.d(t,"_175",function(){return pn}),i.d(t,"_176",function(){return un}),i.d(t,"_177",function(){return gn}),i.d(t,"_178",function(){return fn}),i.d(t,"_179",function(){return mn}),i.d(t,"_180",function(){return vn}),i.d(t,"_181",function(){return yn}),i.d(t,"_182",function(){return wn}),i.d(t,"_183",function(){return bn}),i.d(t,"_184",function(){return xn}),i.d(t,"_185",function(){return Cn}),i.d(t,"_186",function(){return In}),i.d(t,"_187",function(){return Fn}),i.d(t,"_188",function(){return kn}),i.d(t,"_189",function(){return Pn}),i.d(t,"_190",function(){return Tn}),i.d(t,"_191",function(){return Sn}),i.d(t,"_192",function(){return Wn}),i.d(t,"_193",function(){return Nn}),i.d(t,"_194",function(){return Hn}),i.d(t,"_195",function(){return En}),i.d(t,"_196",function(){return On}),i.d(t,"_197",function(){return _n}),i.d(t,"_198",function(){return Bn}),i.d(t,"_199",function(){return Ln}),i.d(t,"_200",function(){return Rn}),i.d(t,"_201",function(){return An}),i.d(t,"_202",function(){return Dn}),i.d(t,"_203",function(){return Un}),i.d(t,"_204",function(){return Mn}),i.d(t,"_205",function(){return Vn}),i.d(t,"_206",function(){return zn}),i.d(t,"_207",function(){return jn}),i.d(t,"_208",function(){return qn}),i.d(t,"_209",function(){return Gn}),i.d(t,"_210",function(){return Kn}),i.d(t,"_211",function(){return Zn}),i.d(t,"_212",function(){return Xn}),i.d(t,"_213",function(){return Jn}),i.d(t,"_214",function(){return Yn}),i.d(t,"_215",function(){return Qn}),i.d(t,"_216",function(){return $n}),i.d(t,"_217",function(){return er}),i.d(t,"_218",function(){return tr}),i.d(t,"_219",function(){return ir}),i.d(t,"_220",function(){return nr}),i.d(t,"_221",function(){return rr}),i.d(t,"_222",function(){return or}),i.d(t,"_223",function(){return sr}),i.d(t,"_224",function(){return ar}),i.d(t,"_225",function(){return lr}),i.d(t,"_226",function(){return dr}),i.d(t,"_227",function(){return hr}),i.d(t,"_228",function(){return cr}),i.d(t,"_229",function(){return pr}),i.d(t,"_230",function(){return ur}),i.d(t,"_231",function(){return gr}),i.d(t,"_232",function(){return fr}),i.d(t,"_233",function(){return mr}),i.d(t,"_234",function(){return vr}),i.d(t,"_235",function(){return yr}),i.d(t,"_236",function(){return wr}),i.d(t,"_237",function(){return br}),i.d(t,"_238",function(){return xr}),i.d(t,"_239",function(){return Cr}),i.d(t,"_240",function(){return Ir}),i.d(t,"_241",function(){return Fr}),i.d(t,"_242",function(){return kr}),i.d(t,"_243",function(){return Pr}),i.d(t,"_244",function(){return Tr}),i.d(t,"_245",function(){return Sr}),i.d(t,"_246",function(){return Wr}),i.d(t,"_247",function(){return Nr}),i.d(t,"_248",function(){return Hr}),i.d(t,"_249",function(){return Er}),i.d(t,"_250",function(){return Or}),i.d(t,"_251",function(){return _r}),i.d(t,"_252",function(){return Br}),i.d(t,"_253",function(){return Lr}),i.d(t,"_254",function(){return Rr}),i.d(t,"_255",function(){return Ar}),i.d(t,"_256",function(){return Dr}),i.d(t,"_257",function(){return Ur}),i.d(t,"_258",function(){return Mr}),i.d(t,"_259",function(){return Vr}),i.d(t,"_260",function(){return zr}),i.d(t,"_261",function(){return jr}),i.d(t,"_262",function(){return qr}),i.d(t,"_263",function(){return Gr}),i.d(t,"_264",function(){return Kr}),i.d(t,"_265",function(){return Zr}),i.d(t,"_266",function(){return Xr}),i.d(t,"_267",function(){return Jr}),i.d(t,"_268",function(){return Yr}),i.d(t,"_269",function(){return Qr}),i.d(t,"_270",function(){return $r}),i.d(t,"_271",function(){return eo}),i.d(t,"_272",function(){return to}),i.d(t,"_273",function(){return io}),i.d(t,"_274",function(){return no}),i.d(t,"_275",function(){return ro}),i.d(t,"_276",function(){return oo}),i.d(t,"_277",function(){return so}),i.d(t,"b",function(){return ao}),i.d(t,"_278",function(){return lo}),i.d(t,"_279",function(){return ho}),i.d(t,"_280",function(){return co}),i.d(t,"_281",function(){return po}),i.d(t,"_282",function(){return uo}),i.d(t,"_283",function(){return go}),i.d(t,"_284",function(){return fo}),i.d(t,"_285",function(){return mo}),i.d(t,"_286",function(){return vo}),i.d(t,"_287",function(){return yo}),i.d(t,"_288",function(){return wo}),i.d(t,"_289",function(){return bo}),i.d(t,"_290",function(){return xo}),i.d(t,"_291",function(){return Co}),i.d(t,"_292",function(){return Io}),i.d(t,"_293",function(){return Fo}),i.d(t,"_294",function(){return ko}),i.d(t,"_295",function(){return Po}),i.d(t,"_296",function(){return To}),i.d(t,"_297",function(){return So}),i.d(t,"_298",function(){return Wo}),i.d(t,"_299",function(){return No}),i.d(t,"_300",function(){return Ho}),i.d(t,"_301",function(){return Eo}),i.d(t,"_302",function(){return Oo}),i.d(t,"_303",function(){return _o}),i.d(t,"_304",function(){return Bo}),i.d(t,"_305",function(){return Lo}),i.d(t,"_306",function(){return Ro}),i.d(t,"_307",function(){return Ao}),i.d(t,"_308",function(){return Do}),i.d(t,"_309",function(){return Uo}),i.d(t,"_310",function(){return Mo}),i.d(t,"_311",function(){return Vo}),i.d(t,"_312",function(){return zo}),i.d(t,"_313",function(){return jo}),i.d(t,"_314",function(){return qo}),i.d(t,"_315",function(){return Go}),i.d(t,"_316",function(){return Ko}),i.d(t,"_317",function(){return Zo}),i.d(t,"_318",function(){return Xo}),i.d(t,"_319",function(){return Jo}),i.d(t,"_320",function(){return Yo}),i.d(t,"_321",function(){return Qo}),i.d(t,"_322",function(){return $o}),i.d(t,"_323",function(){return es}),i.d(t,"_324",function(){return ts}),i.d(t,"c",function(){return is}),i.d(t,"_325",function(){return ns}),i.d(t,"_326",function(){return rs}),i.d(t,"_327",function(){return os}),i.d(t,"_328",function(){return ss}),i.d(t,"_329",function(){return as}),i.d(t,"_330",function(){return ls}),i.d(t,"a",function(){return ds});var n=["sections","sec"],r=["fontSubstitutionTable","fst"],o=["characterFormat","cf"],s=["paragraphFormat","pf"],a=["lists","li"],l=["abstractLists","al"],d=["background","bg"],h=["styles","sty"],c=["comments","cm"],p=["revisions","r"],u=["customXml","cx"],g=["defaultTabWidth","dtw"],f=["formatting","fmt"],m=["trackChanges","tc"],v=["protectionType","pt"],y=["enforcement","enf"],w=["hashValue","hv"],b=["saltValue","sv"],x=["cryptProviderType","cpt"],C=["cryptAlgorithmClass","cac"],I=["cryptAlgorithmType","cat"],F=["isCreatedUsingHtmlSpanTag","ishst"],k=["cryptAlgorithmSid","cas"],P=["cryptSpinCount","csc"],T=["dontUseHTMLParagraphAutoSpacing","dhtml"],S=["alignTablesRowByRow","atrr"],W=["formFieldShading","ffs"],N=["lastParagraphMarkCopied","lpmc"],H=["footnotes","fn"],E=["endnotes","en"],O=["compatibilityMode","comp"],_=["themeFontLanguages","tfl"],B=["themes","thm"],L=["name","n"],R=["basedOn","b"],A=["next","nx"],D=["link","l"],U=["localeId","id"],M=["localeIdFarEast","idfe"],V=["localeIdBidi","idbi"],z=["bold","b"],j=["italic","i"],q=["underline","u"],G=["baselineAlignment","ba"],K=["strikethrough","st"],Z=["highlightColor","hc"],X=["fontSize","fsz"],J=["fontColor","fc"],Y=["fontFamily","ff"],Q=["styleName","stn"],$=["bidi","bi"],ee=["bdo","bdo"],te=["breakClearType","bct"],ie=["fontSizeBidi","fszbi"],ne=["fontFamilyBidi","ffbi"],re=["boldBidi","bbi"],oe=["italicBidi","ibi"],se=["allCaps","ac"],ae=["complexScript","cs"],le=["fontFamilyAscii","ffa"],de=["fontFamilyFarEast","fffe"],he=["fontFamilyNonFarEast","ffnfe"],ce=["revisionIds","rids"],pe=["listId","lid"],ue=["characterSpacing","csp"],ge=["scaling","sc"],fe=["listLevelNumber","lilno"],me=["leftIndent","lin"],ve=["rightIndent","rin"],ye=["firstLineIndent","fin"],we=["textAlignment","ta"],be=["afterSpacing","as"],xe=["beforeSpacing","bs"],Ce=["spaceAfterAuto","saa"],Ie=["spaceBeforeAuto","sba"],Fe=["lineSpacing","ls"],ke=["lineSpacingType","lst"],Pe=["listFormat","lif"],Te=["keepWithNext","kwn"],Se=["widowControl","wc"],We=["keepLinesTogether","klt"],Ne=["outlineLevel","ol"],He=["contextualSpacing","cs"],Ee=["borders","bdrs"],Oe=["tabs","tb"],_e=["headerDistance","hd"],Be=["footerDistance","fd"],Le=["differentFirstPage","dfp"],Re=["differentOddAndEvenPages","doep"],Ae=["pageWidth","pw"],De=["pageHeight","ph"],Ue=["leftMargin","lm"],Me=["rightMargin","rm"],Ve=["topMargin","tm"],ze=["bottomMargin","bm"],je=["restartPageNumbering","rpn"],qe=["pageStartingNumber","psn"],Ge=["endnoteNumberFormat","enf"],Ke=["footNoteNumberFormat","fnf"],Ze=["restartIndexForFootnotes","rif"],Xe=["restartIndexForEndnotes","rie"],Je=["initialFootNoteNumber","ifn"],Ye=["initialEndNoteNumber","ien"],Qe=["pageNumberStyle","pgns"],$e=["columns","cols"],et=["numberOfColumns","ncols"],tt=["equalWidth","eqw"],it=["lineBetweenColumns","lbtc"],nt=["breakCode","bc"],rt=["cellWidth","cw"],ot=["columnSpan","colsp"],st=["rowSpan","rwsp"],at=["verticalAlignment","va"],lt=["allowBreakAcrossPages","abrk"],dt=["isHeader","hdr"],ht=["heightType","ht"],ct=["beforeWidth","bw"],pt=["afterWidth","aw"],ut=["gridBefore","gb"],gt=["gridBeforeWidth","gbw"],ft=["gridBeforeWidthType","gbwt"],mt=["gridAfter","ga"],vt=["gridAfterWidth","gaw"],yt=["gridAfterWidthType","gawt"],wt=["allowAutoFit","auft"],bt=["cellSpacing","csp"],xt=["shading","sd"],Ct=["tableAlignment","ta"],It=["preferredWidth","pw"],Ft=["preferredWidthType","pwt"],kt=["horizontalPositionAbs","hpa"],Pt=["texture","t"],Tt=["backgroundColor","bgc"],St=["foregroundColor","fgc"],Wt=["shadow","sh"],Nt=["hasNoneStyle","hns"],Ht=["vertical","v"],Et=["horizontal","h"],Ot=["diagonalUp","du"],_t=["diagonalDown","dd"],Bt=["lineStyle","ls"],Lt=["lineWidth","lw"],Rt=["layout","l"],At=["dataFormat","df"],Dt=["yValue","y"],Ut=["chartData","chd"],Mt=["categoryXName","cx"],Vt=["line","l"],zt=["foreColor","fc"],jt=["pattern","pt"],qt=["layoutX","x"],Gt=["layoutY","y"],Kt=["direction","dir"],Zt=["endStyle","est"],Xt=["numberValue","no"],Jt=["markerStyle","mst"],Yt=["markerColor","mc"],Qt=["markerSize","msz"],$t=["forward","fw"],ei=["backward","bw"],ti=["intercept","itr"],ii=["isDisplayRSquared","idrs"],ni=["isDisplayEquation","ideq"],ri=["seriesName","sn"],oi=["dataLabel","sl"],si=["errorBar","eb"],ai=["seriesFormat","sf"],li=["trendLines","tl"],di=["dataPoints","dp"],hi=["firstSliceAngle","fsa"],ci=["holeSize","hsz"],pi=["isLegendKey","lk"],ui=["isBubbleSize","bsz"],gi=["isCategoryName","icn"],fi=["isSeriesName","isn"],mi=["isValue","iv"],vi=["isPercentage","ip"],yi=["isLeaderLines","il"],wi=["showSeriesKeys","sk"],bi=["hasHorzBorder","hhbdr"],xi=["hasVertBorder","hvbdr"],Ci=["hasBorders","hbdr"],Ii=["categoryType","ct"],Fi=["chartCategory","c"],ki=["chartSeries","cs"],Pi=["chartArea","ca"],Ti=["chartTitleArea","cta"],Si=["plotArea","pa"],Wi=["chartLegend","cl"],Ni=["chartPrimaryCategoryAxis","cpca"],Hi=["chartPrimaryValueAxis","cpva"],Ei=["chartTitle","ctt"],Oi=["chartType","ct"],_i=["gapWidth","gw"],Bi=["overlap","o"],Li=["chartDataTable","cdt"],Ri=["text","tlp"],Ai=["shapeId","sid"],Di=["alternativeText","at"],Ui=["visible","v"],Mi=["belowText","b"],Vi=["horizontalRule","ihr"],zi=["width","w"],ji=["height","h"],qi=["widthScale","ws"],Gi=["heightScale","hs"],Ki=["lineFormat","lf"],Zi=["fillFormat","ff"],Xi=["textWrappingStyle","tws"],Ji=["textWrappingType","twt"],Yi=["verticalRelativePercent","vrp"],Qi=["horizontalRelativePercent","hrp"],$i=["heightRelativePercent","hrp"],en=["widthRelativePercent","wrp"],tn=["zOrderPosition","z"],nn=["layoutInCell","lc"],rn=["lockAnchor","la"],on=["autoShapeType","ast"],sn=["textFrame","tf"],an=["color","c"],ln=["fill","f"],dn=["textVerticalAlignment","tva"],hn=["imageString","img"],cn=["metaFileImageString","mtimg"],pn=["length","l"],un=["isInlineImage","inimg"],gn=["isMetaFile","imf"],fn=["top","tp"],mn=["bottom","bt"],vn=["right","rg"],yn=["left","lt"],wn=["getimageheight","gih"],bn=["getimagewidth","giw"],xn=["hasFieldEnd","hfe"],Cn=["formFieldData","ffd"],In=["fieldType","ft"],Fn=["enabled","e"],kn=["helpText","h"],Pn=["statusText","st"],Tn=["textInput","ti"],Sn=["checkBox","c"],Wn=["dropDownList","ddl"],Nn=["maxLength","ml"],Hn=["defaultValue","dv"],En=["format","f"],On=["sizeType","szt"],_n=["size","sz"],Bn=["checked","chk"],Ln=["dropDownItems","ddi"],Rn=["selectedIndex","si"],An=["commentId","cid"],Dn=["commentCharacterType","cct"],Un=["author","a"],Mn=["initial","i"],Vn=["date","dt"],zn=["done","dn"],jn=["replyComments","rc"],qn=["revisionType","rt"],Gn=["revisionId","rid"],Kn=["itemID","iid"],Zn=["xml","x"],Xn=["footnoteType","fnt"],Jn=["symbolCode","sc"],Yn=["symbolFontName","sfn"],Qn=["customMarker","cm"],$n=["inlines","i"],er=["contentControlProperties","ccp"],tr=["lockContentControl","lcc"],ir=["lockContents","lc"],nr=["tag","tg"],rr=["title","tt"],or=["hasPlaceHolderText","hpt"],sr=["multiline","mul"],ar=["isTemporary","it"],lr=["dateCalendarType","dtct"],dr=["dateStorageFormat","dtsf"],hr=["dateDisplayLocale","dtdl"],cr=["dateDisplayFormat","dtdf"],pr=["isChecked","ichk"],ur=["uncheckedState","uchk"],gr=["checkedState","chks"],fr=["contentControlListItems","ccli"],mr=["xmlMapping","x"],vr=["font","f"],yr=["value","v"],wr=["displayText","dt"],br=["isMapped","imap"],xr=["isWordMl","iwml"],Cr=["prefixMapping","pmap"],Ir=["xPath","xp"],Fr=["storeItemId","siid"],kr=["customXmlPart","cxp"],Pr=["id","i"],Tr=["cellFormat","tcpr"],Sr=["rowFormat","trpr"],Wr=["cells","c"],Nr=["rows","r"],Hr=["description","desc"],Er=["wrapTextAround","wta"],Or=["isLegalStyleNumbering","isLgl"],_r=["positioning","p"],Br=["tableFormat","tblpr"],Lr=["allowOverlap","ao"],Rr=["distanceTop","dt"],Ar=["distanceRight","dr"],Dr=["distanceLeft","dl"],Ur=["distanceBottom","db"],Mr=["verticalOrigin","vo"],Vr=["verticalPosition","vp"],zr=["horizontalOrigin","ho"],jr=["horizontalAlignment","ha"],qr=["horizontalPosition","hp"],Gr=["blocks","b"],Kr=["header","h"],Zr=["footer","f"],Xr=["evenHeader","eh"],Jr=["evenFooter","ef"],Yr=["firstPageHeader","fph"],Qr=["firstPageFooter","fpf"],$r=["headersFooters","hf"],eo=["sectionFormat","secpr"],to=["listLevelPattern","lilp"],io=["followCharacter","fchar"],no=["startAt","sa"],ro=["restartLevel","rl"],oo=["levelNumber","lvlno"],so=["numberFormat","nf"],ao=["abstractListId","alid"],lo="nsid",ho=["levels","lvl"],co=["overrideListLevel","o"],po=["levelOverrides","lo"],uo=["separator","s"],go=["continuationSeparator","cs"],fo=["continuationNotice","cn"],mo=["bookmarkType","bkt"],vo=["properties","p"],yo=["tabJustification","tj"],wo=["position","p"],bo=["deletePosition","dp"],xo=["leader","l"],Co=["tabLeader","tl"],Io=["editRangeId","erid"],Fo=["columnFirst","cft"],ko=["columnLast","clt"],Po=["user","u"],To=["group","g"],So=["editableRangeStart","ers"],Wo=["space","sp"],No=["fontScheme","fsc"],Ho=["fontSchemeName","fscn"],Eo=["majorFontScheme","majfs"],Oo=["minorFontScheme","minfs"],_o=["fontSchemeList","fsl"],Bo=["fontTypeface","ft"],Lo=["typeface","t"],Ro=["panose","p"],Ao=["type","t"],Do=["majorUnit","maju"],Uo=["maximumValue","maxv"],Mo=["minimumValue","minv"],Vo=["hasMajorGridLines","hmajgl"],zo=["hasMinorGridLines","hmingl"],jo=["majorTickMark","majtm"],qo=["minorTickMark","mintm"],Go=["tickLabelPosition","tlp"],Ko=["rgb","rgb"],Zo=["appearance","a"],Xo=["lineFormatType","lft"],Jo=["allowSpaceOfSameStyleInTable","stytbl"],Yo=["weight","w"],Qo=["inlineFormat","inf"],$o=["fontName","fn"],es=["isCompressed","comp"],ts=["columnIndex","ci"],is=["images","imgs"],ns=["isAfterParagraphMark","apm"],rs=["isAfterCellMark","acm"],os=["isAfterRowMark","arm"],ss=["grid","grd"],as=["columnCount","colc"],ls=["isAfterTableMark","atm"],ds=["iOps"]},function(e,t,i){"use strict";i.d(t,"a",function(){return o});var n=i(1),r=i(0),o=(i.n(r),function(){function e(e){this.version=0,this.userMap={},this.connectionId="",this.pendingOps=[],this.commentsStart=[],this.commentsEnd=[],this.deletedComments=[],this.serviceUrl="",this.isSyncServerChanges=!1,this.logEventEnabled=!0,this.message="",this.documentEditor=e}return e.prototype.getModuleName=function(){return"CollaborativeEditingHandler"},e.prototype.updateRoomInfo=function(e,t,i){this.roomName=e,this.serviceUrl=i,this.version=t},e.prototype.sendActionToServer=function(e){(i.i(r.isNullOrUndefined)(e)||0!==e.length)&&(this.pendingOps.push(e),this.isAcknowledgePending()||this.sendLocalOperation(),this.transformRemoteCursor(this.connectionId,e[0],e[0].offset))},e.prototype.applyRemoteAction=function(e,t){switch(e){case"connectionId":this.connectionId=t;break;case"removeUser":this.removeCarets(t);break;case"action":this.dataReceived(t)}},e.prototype.isAcknowledgePending=function(){return!i.i(r.isNullOrUndefined)(this.acknowledgmentPending)},e.prototype.handleAcknowledgementReceived=function(e){var t=this.getVersionDifference(e);t>1?this.checkAndRetriveChangesFromServer():(this.logMessage("Ack received: "+e.version),this.logMessage("Ack version diff: "+t),this.updateVersion(e.version),this.acknowledgementReceived(),this.sendLocalOperation())},e.prototype.updateVersion=function(e){e>this.version&&(this.version=e)},e.prototype.acknowledgementReceived=function(){this.acknowledgmentPending=void 0},e.prototype.sendLocalOperation=function(){var e=this;if(this.pendingOps.length>0){var t=this.pendingOps.shift(),i={};i.currentUser=this.documentEditor.currentUser,i.roomName=this.roomName,i.connectionId=this.connectionId,i.version=this.version,i.operations=t,this.acknowledgmentPending=t;var n=new XMLHttpRequest;n.open("Post",this.serviceUrl+"UpdateAction",!0),n.setRequestHeader("Content-Type","application/json;charset=UTF-8"),n.onreadystatechange=function(){if(4===n.readyState)if(200===n.status||304===n.status){var t=JSON.parse(n.responseText);e.isSyncServerChanges||e.handleAcknowledgementReceived(t)}else alert("Failed to save the changes")},this.logMessage("Sent: "+JSON.stringify(i)),n.send(JSON.stringify(i))}},e.prototype.dataReceived=function(e){if(e.connectionId===this.connectionId||this.isSyncServerChanges)return void this.logMessage(this.isSyncServerChanges?"SignalR Server sync"+e.version:"SignalR Same user sync:"+e.version);var t=this.getVersionDifference(e);if(t<=0)return void this.logMessage("SignalR return diff:<=0"+e.version);if(t>1)return this.logMessage("SignalR return diff:>=1"+e.version),void this.checkAndRetriveChangesFromServer();this.logMessage("SignalR ack: "+e.version);try{this.logMessage("Received: "+JSON.stringify(e)),this.handleRemoteOperation(e)}catch(e){e instanceof Error?(this.logMessage("Error while handling remote operation: "+e),this.logMessage("Error while handling remote operation: "+e.stack)):this.logMessage("Error while handling remote operation: "+e)}},e.prototype.getVersionDifference=function(e){return e.version-this.version},e.prototype.handleRemoteOperation=function(e){this.documentEditor.editor.isRemoteAction=!0;var t=this.documentEditor.selection.getAbsolutePositionFromRelativePosition(this.documentEditor.selection.start),n=this.documentEditor.selection.getAbsolutePositionFromRelativePosition(this.documentEditor.selection.end)-t;i.i(r.isNullOrUndefined)(this.acknowledgmentPending)||(this.logMessage("Acknowledge transform:"+this.acknowledgmentPending[0].text+"version:"+e.version),this.transform([this.acknowledgmentPending],e.operations)),this.pendingOps.length>0&&this.logMessage("Pending transform:"+this.pendingOps.length+"version:"+e.version),this.transform(this.pendingOps,e.operations),this.applyRemoteOperation(e,t,n),this.updateVersion(e.version),this.documentEditor.editor.isRemoteAction=!1,this.documentEditor.editorHistory.canUndo()&&(this.documentEditor.editorHistory.undoStack.length=0),this.documentEditor.editorHistory.canRedo()&&(this.documentEditor.editorHistory.redoStack.length=0)},e.prototype.transform=function(e,t){for(var i=0;i<t.length;i++){var n=t[i];if(e.length>0)for(var r=0;r<e.length;r++)for(var o=0;o<e[r].length;o++){var s=e[r][o];this.transformSelectionOperation(s,n);var a=n.offset;this.transformOperation(s,n,t),this.logMessage("Transformed offset:"+(n.offset-a))}}},e.prototype.skipAction=function(e){for(var t=0;t<e.length;t++){var i=e[t];i.length=0,i.skipOperation=!0}},e.prototype.applyRemoteOperation=function(e,t,o){var s,a=this.documentEditor.currentUser,l=[],d=this.documentEditor.commentReviewPane.commentPane.isEditMode,h=this.documentEditor.editorHistory.lastOperation,c=!1;i.i(r.isNullOrUndefined)(this.documentEditor.commentReviewPane.commentPane.currentEditingComment)||(s=this.documentEditor.commentReviewPane.commentPane.currentEditingComment.textArea);for(var p=0;p<e.operations.length;p++){var u=e.operations[p].markerData,g=void 0,f=this.documentEditor.enableTrackChanges;if(i.i(r.isNullOrUndefined)(u)||i.i(r.isNullOrUndefined)(u.author)||(this.documentEditor.currentUser=u.author),!i.i(r.isNullOrUndefined)(u)&&!i.i(r.isNullOrUndefined)(u.isSkipTracking)&&u.isSkipTracking&&this.documentEditor.enableTrackChanges&&(this.documentEditor.enableTrackChanges=!1),!(e.operations[p].skipOperation||!i.i(r.isNullOrUndefined)(e.operations[p].markerData)&&e.operations[p].markerData.skipOperation))if("Update"!==e.operations[p].action){var m=this.getRelativePositionFromAbsolutePosition(e.operations[p].offset,!1,!1,!1),v=e.operations[p],y=m;if(i.i(r.isNullOrUndefined)(e.operations[p].action))this.documentSettings(e.operations[p]);else if("Delete"!==e.operations[p].action&&"Format"!==e.operations[p].action||("Delete"===e.operations[p].action&&(this.documentEditor.selection.isEndOffset=!0),y=this.getRelativePositionFromAbsolutePosition(e.operations[p].offset+e.operations[p].length,!1,!1,!1),this.documentEditor.selection.isEndOffset=!1),"Insert"===v.action&&v.text!==n.n.Row&&v.text!==n.n.Cell&&(i.i(r.isNullOrUndefined)(v.markerData)||i.i(r.isNullOrUndefined)(v.markerData.isAcceptOrReject))?this.documentEditor.selection.select(m,y):"Delete"===v.action&&v.text!==n.n.Cell&&(i.i(r.isNullOrUndefined)(v.markerData)||i.i(r.isNullOrUndefined)(v.markerData.isAcceptOrReject))?this.documentEditor.selection.select(m,y):"Format"===v.action&&(i.i(r.isNullOrUndefined)(v.markerData)||i.i(r.isNullOrUndefined)(v.markerData.isAcceptOrReject))&&this.documentEditor.selection.select(m,y),i.i(r.isNullOrUndefined)(v.markerData)||(this.documentEditor.editor.revisionData=[],i.i(r.isNullOrUndefined)(v.markerData.revisionForFootnoteEndnoteContent)||this.documentEditor.editor.revisionData.push(v.markerData.revisionForFootnoteEndnoteContent),i.i(r.isNullOrUndefined)(v.markerData.revisionId)||this.documentEditor.editor.revisionData.push(v.markerData),!i.i(r.isNullOrUndefined)(v.markerData.splittedRevisions)&&v.markerData.splittedRevisions.length>0&&(this.documentEditor.editor.revisionData=this.documentEditor.editor.revisionData.concat(v.markerData.splittedRevisions))),i.i(r.isNullOrUndefined)(v.markerData)||i.i(r.isNullOrUndefined)(v.markerData.isAcceptOrReject)||""===v.markerData.isAcceptOrReject){if("Insert"===v.action)if("Paste"===v.type)this.documentEditor.editor.isPasteListUpdated=!1,this.documentEditor.editor.pasteContents(n._417.getSfdtDocument(v.pasteContent));else if("PasteToc"===v.type)this.documentEditor.editor.isInsertingTOC=!0,this.documentEditor.editor.pasteContents(n._417.getSfdtDocument(v.pasteContent)),this.documentEditor.editor.isInsertingTOC=!1;else if(v.text===n.n.Image.toString())this.insertImage(v.imageData);else if(v.text===n.n.Section_Break.toString()&&"NewPage"===v.type)this.documentEditor.editor.insertSectionBreak();else if(v.text===n.n.Section_Break.toString()&&"Continuous"===v.type)this.documentEditor.editor.insertSectionBreak(n.m.Continuous);else if(!u||v.text!==n.n.Marker_Start&&v.text!==n.n.Marker_End&&v.text!==n.n.Field_Separator)if(u&&!i.i(r.isNullOrUndefined)(u.dropDownIndex)&&"DropDown"===v.type){var w=this.documentEditor.selection.start.currentWidget.getInline(this.documentEditor.selection.start.offset,0),b=w.element;b instanceof n._507&&this.documentEditor.editor.updateFormField(b,u.dropDownIndex,!1)}else if(v.text===n.n.Section_Break.toString()&&"NewPage"===v.type)this.documentEditor.editor.insertSectionBreak();else if(v.text===n.n.Section_Break.toString()&&"Continuous"===v.type)this.documentEditor.editor.insertSectionBreak(n.m.Continuous);else if(v.text===n.n.Table)p=e.operations.length,this.buildTable(e.operations),g=this.getOperationLength(e.operations);else if(v.text===n.n.Row)p=e.operations.length,i.i(r.isNullOrUndefined)(v.format)&&e.operations.reverse(),this.buildRow(e.operations),g=this.getOperationLength(e.operations);else if(v.text===n.n.Cell){var x=void 0,C=void 0;"CellFormat"===v.type&&(v.length>0&&(x=e.operations[p-1].format,C=e.operations[p-2].format),this.buildCell(v,x,C))}else if(v.text===n.n.PageBreak.toString())this.documentEditor.editor.insertPageBreak();else if(v.text===n.n.ColumnBreak.toString())this.documentEditor.editor.insertColumnBreak();else{if(v.format){var I=new n._439,F=JSON.parse(v.format);this.documentEditor.parser.parseCharacterFormat(0,F,I),this.documentEditor.selection.characterFormat.copyFormat(I)}this.documentEditor.editor.insertText(v.text)}else{var k=void 0;if(u.type&&"Bookmark"===u.type)if(v.text===n.n.Marker_Start)l=this.documentEditor.editor.createBookmarkElements(u.bookmarkName),k=l[0],this.documentEditor.documentHelper.isBookmarkInserted=!1,this.documentEditor.editor.insertElementsInternal(this.documentEditor.selection.start,[k]);else{var P=l[0];P&&(k=P.reference,this.documentEditor.documentHelper.isBookmarkInserted=!0,this.documentEditor.editor.insertElementsInternal(this.documentEditor.selection.start,[k]),this.documentEditor.selection.selectBookmark(u.bookmarkName),P.properties=this.documentEditor.selection.getBookmarkProperties(P),k.properties=this.documentEditor.selection.getBookmarkProperties(k))}else if(u.type&&"EditRange"===u.type){var T=u.user,S=u.editRangeId;if(v.text===n.n.Marker_Start)k=this.documentEditor.editor.addEditElement(T,S),k.columnFirst=parseInt(u.columnFirst),k.columnLast=parseInt(u.columnLast),k.line=this.documentEditor.selection.start.currentWidget;else for(var W=this.documentEditor.documentHelper.editRanges.get(T),N=0,H=W;N<H.length;N++){var E=H[N];if(E.editRangeId===S){k=E.editRangeEnd,k.line=this.documentEditor.selection.start.currentWidget;break}}this.documentEditor.editor.insertElementsInternal(this.documentEditor.selection.start,[k]),this.documentEditor.editor.fireContentChange()}else if(u.type&&"Field"===u.type){c=!0;var O=v.text===n.n.Marker_Start?0:v.text===n.n.Marker_End?1:v.text===n.n.Field_Separator?2:void 0;if(!i.i(r.isNullOrUndefined)(O)&&i.i(r.isNullOrUndefined)(u.checkBoxValue)){var _=new n._507(O);if(0===O&&!i.i(r.isNullOrUndefined)(u.formFieldData)){var B=this.documentEditor.editor.getFormFieldData(v.type);this.documentEditor.parser.parseFormFieldData(0,u.formFieldData,B),_.formFieldData=B}var I=new n._439,L=JSON.parse(v.format);this.documentEditor.parser.parseCharacterFormat(0,L,I),_.characterFormat.copyFormat(I),this.documentEditor.editor.initInsertInline(_)}else{var w=this.documentEditor.selection.start.currentWidget.getInline(this.documentEditor.selection.start.offset,0),b=w.element;b instanceof n._507&&this.documentEditor.editor.toggleCheckBoxFormField(b,!0,u.checkBoxValue)}}else if(i.i(r.isNullOrUndefined)(u)||i.i(r.isNullOrUndefined)(u.commentId))i.i(r.isNullOrUndefined)(v.markerData.type)||"Footnote"!==v.markerData.type&&"Endnote"!==v.markerData.type||("Footnote"===v.markerData.type?this.documentEditor.editor.insertFootnote():"Endnote"===v.markerData.type&&this.documentEditor.editor.insertEndnote());else{var R=v.text===n.n.Marker_Start?0:1,A=this.documentEditor.documentHelper.layout.getCommentById(this.deletedComments,u.commentId),D=void 0;if(i.i(r.isNullOrUndefined)(A)&&(A=this.documentEditor.documentHelper.layout.getCommentById(this.documentEditor.documentHelper.comments,u.commentId),i.i(r.isNullOrUndefined)(A)&&!i.i(r.isNullOrUndefined)(u.ownerCommentId)&&(D=this.documentEditor.documentHelper.layout.getCommentById(this.documentEditor.documentHelper.comments,u.ownerCommentId),A=this.documentEditor.documentHelper.layout.getCommentById(D.replyComments,u.commentId))),i.i(r.isNullOrUndefined)(A)){var U=new n._551(R);U.commentId=u.commentId,this.documentEditor.editor.insertElementsInternal(this.documentEditor.selection.start,[U]),0===R?this.commentsStart.push(U):this.commentsEnd.push(U)}else{var U=new n._551(R);U.commentId=u.commentId,this.documentEditor.editor.insertElementsInternal(this.documentEditor.selection.start,[U]),U.comment=A;var M=this.documentEditor.selection.start.currentWidget.children.indexOf(U);A.commentStart=this.documentEditor.selection.start.currentWidget.children[M]}}}else if("Delete"===v.action)if(v.text===n.n.Marker_Start||v.text===n.n.Marker_End)if(i.i(r.isNullOrUndefined)(u)||i.i(r.isNullOrUndefined)(u.commentId)){var V=this.documentEditor.selection,z=V.start.offset-1;this.documentEditor.editor.removeAtOffset(V.start.currentWidget,this.documentEditor.selection,z)}else{var A=this.documentEditor.documentHelper.layout.getCommentById(this.deletedComments,u.commentId),D=void 0;i.i(r.isNullOrUndefined)(A)&&(A=this.documentEditor.documentHelper.layout.getCommentById(this.documentEditor.documentHelper.comments,u.commentId),i.i(r.isNullOrUndefined)(A)&&!i.i(r.isNullOrUndefined)(u.ownerCommentId)&&(D=this.documentEditor.documentHelper.layout.getCommentById(this.documentEditor.documentHelper.comments,u.ownerCommentId),A=this.documentEditor.documentHelper.layout.getCommentById(D.replyComments,u.commentId)));var V=this.documentEditor.selection,R=v.text===n.n.Marker_Start?0:1;if(1===R){var j=A.commentEnd;-1!==j.indexInOwner&&this.documentEditor.editor.removeAtOffset(V.start.currentWidget,this.documentEditor.selection,V.start.offset)}else{var q=A.commentStart;-1!==q.indexInOwner&&this.documentEditor.editor.removeAtOffset(V.start.currentWidget,this.documentEditor.selection,V.start.offset),q.removeCommentMark()}}else v.text===n.n.Cell?this.buildDeleteCells(v):this.documentEditor.editor.onBackSpace();else if("Format"===v.action)if(i.i(r.isNullOrUndefined)(v.markerData)||i.i(r.isNullOrUndefined)(v.markerData.revisionId))if(v.text===n.n.Row){var G=this.getRelativePositionFromAbsolutePosition(v.offset,!1,!0,!1);if(!i.i(r.isNullOrUndefined)(G.rowWidget)){var K=G.rowWidget.ownerTable,Z=JSON.parse(v.format);this.documentEditor.documentHelper.owner.parser.parseRowFormat(Z,G.rowWidget.rowFormat,0),K.calculateGrid(!1),this.documentEditor.documentHelper.layout.reLayoutTable(K)}}else if(v.text===n.n.Cell){if("TableFormat"===v.type){var X=this.getRelativePositionFromAbsolutePosition(v.offset,!0,!1,!1),K=JSON.parse(v.format);this.documentEditor.documentHelper.owner.parser.parseTableFormat(K,X.tableWidget.tableFormat,0),X.tableWidget.calculateGrid(!1),this.documentEditor.documentHelper.layout.reLayoutTable(X.tableWidget)}if("RowFormat"===v.type){var Z=this.getRelativePositionFromAbsolutePosition(v.offset,!1,!0,!1),J=JSON.parse(v.format);this.documentEditor.documentHelper.owner.parser.parseRowFormat(J,Z.rowWidget.rowFormat,0)}if("CellFormat"===v.type){var Y=this.getRelativePositionFromAbsolutePosition(v.offset,!1,!1,!0),Q=JSON.parse(v.format);this.documentEditor.documentHelper.owner.parser.parseCellFormat(Q,Y.cellWidget.cellFormat,0)}}else if(v.text===n.n.Image){var w=this.documentEditor.selection.start.currentWidget.getInline(this.documentEditor.selection.start.offset,0),b=w.element;b instanceof n._531&&this.documentEditor.editor.onImageFormat(b,n._417.convertPointToPixel(v.imageData.width),n._417.convertPointToPixel(v.imageData.height),void 0)}else if("ListFormat"===v.type){var $=JSON.parse(v.format),ee=new n._442(void 0);this.documentEditor.parser.parseParagraphFormat(0,$,ee),this.updateList(v,ee);var te=this.documentEditor.documentHelper.getListById($.listFormat.nsid,!0);i.i(r.isNullOrUndefined)(te)||(ee.listFormat.listId=te.listId,ee.listFormat.list=te),this.documentEditor.editor.onApplyParagraphFormat(v.text,ee.listFormat,!1,!1)}else if("RestartNumbering"===v.type){var ie=this.updateList(v),te=this.documentEditor.documentHelper.getListById(ie,!0);this.documentEditor.editor.restartListAtInternal(this.documentEditor.selection,te.listId,te.nsid)}else if("ContinueNumbering"===v.type){var $=JSON.parse(v.format),ee=new n._442(void 0);this.documentEditor.parser.parseParagraphFormat(0,$,ee);var te=this.documentEditor.documentHelper.getListById(ee.listFormat.nsid,!0);i.i(r.isNullOrUndefined)(te)||(ee.listFormat.listId=te.listId,ee.listFormat.list=te),this.documentEditor.editor.applyContinueNumberingInternal(this.documentEditor.selection,ee)}else"CharacterFormat"===v.type?this.insertCharaterFormat(v.type,v.format):"ParagraphFormat"===v.type?this.insertParagraphFormat(v.text,v.format):"TableFormat"===v.type?this.insertTableFormat(v.text,v.format,v.offset):"SectionFormat"===v.type?this.insertSectionFormat(v.text,v.format):"RowFormat"===v.type?this.insertRowFormat(v.text,v.format):"CellFormat"===v.type&&this.insertCellFormat(v.format);else if(!i.i(r.isNullOrUndefined)(v.markerData.revisionType)&&"Deletion"===v.markerData.revisionType){if(v.text===n.n.Row){var ne=this.getRelativePositionFromAbsolutePosition(v.offset,!1,!0,!1);if(!i.i(r.isNullOrUndefined)(ne.rowWidget)){var J=ne.rowWidget;this.documentEditor.editor.trackRowDeletion(J),this.documentEditor.trackChangesPane.updateTrackChanges();continue}}this.documentEditor.editor.onBackSpace()}this.documentEditor.editor.revisionData=[],this.documentEditor.enableTrackChanges=f,this.documentEditor.currentUser=a;var re=this.documentEditor.selection.startOffset;if(this.updateRemoteSelection(e,this.documentEditor.selection.getAbsolutePositionFromRelativePosition(re)),!i.i(r.isNullOrUndefined)(g)){var oe=v.length;v.length=g,g=oe}var se=this.transformSection(v.action,v,t)[1],ae=this.transformSection(v.action,v,t+o)[1];t=se,this.documentEditor.selection.select(this.getRelativePositionFromAbsolutePosition(se,!1,!1,!1),this.getRelativePositionFromAbsolutePosition(ae,!1,!1,!1)),i.i(r.isNullOrUndefined)(g)||(v.length=g),this.transformRemoteCursor(e.connectionId,v,v.offset),!i.i(r.isNullOrUndefined)(this.documentEditor.search)&&!i.i(r.isNullOrUndefined)(this.documentEditor.optionsPaneModule)&&this.documentEditor.search.searchResults.length>0&&this.documentEditor.optionsPaneModule.isOptionsPaneShow&&this.documentEditor.optionsPaneModule.searchIconClickInternal()}else{var le=this.documentEditor.editor.getRevision(v.markerData.revisionId);"Accept"===v.markerData.isAcceptOrReject?le.accept():"Reject"===v.markerData.isAcceptOrReject&&le.reject()}}else if(e.operations[p].text===n.n.Marker_Start.toString()+n.n.Marker_End.toString()){var de=void 0,he=this.documentEditor.documentHelper.layout.getCommentById(this.documentEditor.documentHelper.comments,u.commentId);!i.i(r.isNullOrUndefined)(u.ownerCommentId)&&u.isReply&&(de=this.documentEditor.documentHelper.layout.getCommentById(this.documentEditor.documentHelper.comments,u.ownerCommentId),i.i(r.isNullOrUndefined)(de)||(he=this.documentEditor.documentHelper.layout.getCommentById(de.replyComments,u.commentId)));var ce=!i.i(r.isNullOrUndefined)(he);if(!i.i(r.isNullOrUndefined)(he)&&(i.i(r.isNullOrUndefined)(u.done)||!i.i(r.isNullOrUndefined)(u.date))&&he.text!==u.text){var pe=this.documentEditor.commentReviewPane.commentPane.comments.get(he);pe.commentText.innerText=u.text,he.text=u.text;continue}if(ce||"remove"===u.commentAction){if(i.i(r.isNullOrUndefined)(he))continue;if(!i.i(r.isNullOrUndefined)(u.done)&&i.i(r.isNullOrUndefined)(u.date)){var ue=this.documentEditor.documentHelper.layout.getCommentById(this.documentEditor.documentHelper.comments,u.commentId);u.done?this.documentEditor.editor.resolveComment(ue):this.documentEditor.editor.reopenComment(ue);continue}if("remove"===u.commentAction){var pe=this.documentEditor.commentReviewPane.commentPane.comments.get(i.i(r.isNullOrUndefined)(de)?he:de);pe.showDrawer(),this.documentEditor.editor.deleteCommentWidget(he),this.deletedComments.push(he),pe.hideDrawer()}}else{var U=new n._552(u.date);U.commentId=u.commentId;var q=this.getObjectByCommentId(this.commentsStart,U.commentId),j=this.getObjectByCommentId(this.commentsEnd,U.commentId);if(i.i(r.isNullOrUndefined)(q)||i.i(r.isNullOrUndefined)(j)||this.documentEditor.editor.updateCommentElement(U,q,j,u),u.isReply){var ge=this.documentEditor.documentHelper.layout.getCommentById(this.documentEditor.documentHelper.comments,u.ownerCommentId);U.ownerComment=ge,ge.replyComments.splice(u.commentIndex,0,U),this.documentEditor.commentReviewPane.addReply(U,!1,!1)}else if(!i.i(r.isNullOrUndefined)(q)&&!i.i(r.isNullOrUndefined)(j)){this.documentEditor.editor.addCommentWidget(U,!0,!0,!1),this.commentsStart.splice(this.commentsStart.indexOf(q),1),this.commentsEnd.splice(this.commentsEnd.indexOf(j),1);var ue=this.documentEditor.commentReviewPane.commentPane.comments.get(U);ue.postComment()}}}else if(!i.i(r.isNullOrUndefined)(e.operations[p].styleData)){var fe=JSON.parse(e.operations[p].styleData),me=new n._438;this.documentEditor.parser.parseStyles(fe,me);for(var ve=0;ve<me.length;ve++){var ye=me.getItem(ve),we=this.documentEditor.documentHelper.styles.findByName(ye.name);i.i(r.isNullOrUndefined)(fe[n._7[1]])||(this.documentEditor.parser.parseAbstractList(fe,this.documentEditor.documentHelper.abstractLists),i.i(r.isNullOrUndefined)(fe[n._6[1]])||this.documentEditor.parser.parseList(fe,this.documentEditor.documentHelper.lists)),i.i(r.isNullOrUndefined)(we)?this.documentEditor.documentHelper.styles.push(ye):(this.documentEditor.updateStyle(we,ye),this.documentEditor.isShiftingEnabled=!0,this.documentEditor.editorModule.layoutWholeDocument(),this.documentEditor.isShiftingEnabled=!1)}}}if(c&&(this.documentEditor.editor.layoutWholeDocument(),c=!1),!i.i(r.isNullOrUndefined)(this.rowWidget)){var be=this.rowWidget.ownerTable.combineWidget(this.documentEditor.viewer);be.updateRowIndex(0),be.calculateGrid(!0),this.documentEditor.documentHelper.layout.reLayoutTable(be),this.documentEditor.editor.reLayout(this.documentEditor.selection),this.rowWidget=void 0}i.i(r.isNullOrUndefined)(this.table)||(this.table.calculateGrid(),this.documentEditor.editor.updateTable(this.table),this.documentEditor.editor.reLayout(this.documentEditor.selection,!0),this.table=void 0),this.documentEditor.currentUser=a,this.documentEditor.commentReviewPane.commentPane.isEditMode=d,this.documentEditor.editorHistory.lastOperation=h,i.i(r.isNullOrUndefined)(this.documentEditor.commentReviewPane.commentPane.currentEditingComment)||(this.documentEditor.commentReviewPane.commentPane.currentEditingComment.textArea=s)},e.prototype.updateList=function(e,t){var o=-1;if(e.listData){var s=JSON.parse(e.listData);if(s.hasOwnProperty("optimizeSfdt")&&(this.documentEditor.parser.keywordIndex=s.optimizeSfdt?1:0),i.i(r.isNullOrUndefined)(t))s.hasOwnProperty(n._330)&&(o=s[n._330]),this.updateListCollection(s,this.documentEditor.parser.keywordIndex);else{var a=this.documentEditor.documentHelper.getListById(t.listFormat.nsid,!0);if(i.i(r.isNullOrUndefined)(a))this.updateListCollection(s,this.documentEditor.parser.keywordIndex);else{var l=[];if(this.documentEditor.parser.parseAbstractList(s,l),!i.i(r.isNullOrUndefined)(a.abstractList)&&a.abstractList.levels.length<t.listFormat.listLevelNumber){a.abstractList.levels=[];for(var d=0;d<l[0].levels.length;d++)a.abstractList.levels.push(l[0].levels[d])}}}}return o},e.prototype.getOperationLength=function(e){for(var t=0,i=0;i<e.length;i++)e[parseInt(i.toString(),10)].text!==n.n.Table&&e[parseInt(i.toString(),10)].text!==n.n.Row&&e[parseInt(i.toString(),10)].text!==n.n.Cell||(t+=e[parseInt(i.toString(),10)].length);return t},e.prototype.updateListCollection=function(e,t){for(var o=this.documentEditor.editor.getUniqueListOrAbstractListId(!0),s=this.documentEditor.editor.getUniqueListOrAbstractListId(!1),a=0;a<e[n._6[t]].length;a++)!function(a){var l=e[n._6[t]][a],d=e[n._7[t]].filter(function(e){return e[n._329[t]]===l[n._329[t]]})[0];i.i(r.isNullOrUndefined)(d)||(d[n._329[t]]=s,l[n._65[t]]=o,l[n._329[t]]=s,o++,s++)}(a);this.documentEditor.parser.parseAbstractList(e,this.documentEditor.documentHelper.abstractLists),this.documentEditor.parser.parseList(e,this.documentEditor.documentHelper.lists)},e.prototype.getObjectByCommentId=function(e,t){for(var i=0,n=e;i<n.length;i++){var r=n[i];if(r.commentId===t)return r}},e.prototype.transformOperation=function(e,t,o){if("Insert"!==e.action||"Insert"!==t.action&&"Format"!==t.action)if("Delete"!==e.action||"Delete"!==t.action&&"Format"!==t.action)if("Insert"!==e.action||"Delete"!==t.action&&"Format"!==t.action){if("Delete"===e.action&&("Insert"===t.action||"Format"===t.action))if(e.offset<=t.offset&&e.offset+e.length<=t.offset)t.offset=t.offset-e.length;else if(e.offset<t.offset&&e.offset+e.length>=t.offset+t.length)if(i.i(r.isNullOrUndefined)(t.markerData)||i.i(r.isNullOrUndefined)(t.markerData.type)||"Field"===t.markerData.type||t.text!==n.n.Marker_End&&t.text!==n.n.Marker_Start)t.length=0,t.skipOperation=!0,i.i(r.isNullOrUndefined)(t.markerData)||i.i(r.isNullOrUndefined)(t.markerData.type)||"Field"!==t.markerData.type||t.text!==n.n.Marker_Start&&t.text!==n.n.Marker_End||this.skipAction(o);else{if(!i.i(r.isNullOrUndefined)(t.markerData.commentId)&&t.text===n.n.Marker_End)return this.skipAction(o),[e,t];var s=t.offset-e.offset;t.offset-=s}else e.offset>t.offset&&"Format"!==t.action&&(e.offset=e.offset+t.length)}else{if(e.offset<=t.offset)return t.offset=t.offset+e.length,[e,t];if(e.offset>=t.offset+t.length&&"Format"!==t.action)return e.offset=e.offset-t.length,[e,t];e.offset>t.offset&&e.offset<t.offset+t.length&&(t.length+=e.length)}else{if(e.offset<t.offset)return t.offset=t.offset-e.length,[e,t];if(e.offset>t.offset&&"Format"!==t.action)return e.offset=e.offset-t.length,[e,t]}else{if(e.offset<t.offset)return t.offset=t.offset+e.length,[e,t];if(e.offset>=t.offset&&"Format"!==t.action)return e.offset=e.offset+t.length,[e,t]}return[e,t]},e.prototype.transformSection=function(e,t,i){if("Insert"===e){if(t.offset<=i)return[t.offset,i+t.length]}else if("Delete"===e&&t.offset<=i)return[t.offset,i-t.length];return[t.offset,i]},e.prototype.transformRemoteCursor=function(e,t,i){if(!this.documentEditor.editor.isIncrementalSave)for(var n=Object.keys(this.userMap),r=0;r<n.length;r++){var o=n[r];if(o!==e){var s=this.userMap[o].offset,a=this.transformSection(t.action,t,s)[1];this.userMap[o].offset=a,this.updateCaretPositionInteral(this.userMap[o].caret,a)}}},e.prototype.updateRemoteSelection=function(e,t){if(!this.documentEditor.editor.isIncrementalSave&&e.connectionId){var n="",o=void 0;void 0!==this.userMap[e.connectionId]?(n=this.userMap[e.connectionId].color,o=this.userMap[e.connectionId].caret):(n=this.getColorForMember(100*Math.random()),o=i.i(r.createElement)("div",{className:"e-de-blink-cursor",styles:"position:absolute;border-left: 2px solid "+n}),this.userMap[e.connectionId]=new s(n,o,t,e.currentUser)),this.userMap[e.connectionId].offset=t,this.updateCaretPositionInteral(o,t)}},e.prototype.removeCarets=function(e){void 0!==this.userMap[e]&&(this.userMap[e].caret.remove(),delete this.userMap[e])},e.prototype.getColorForMember=function(e){return"hsl("+e%20*360/7%360+", 100%, 35%)"},e.prototype.updateCaretPositionInteral=function(e,t){var i=this.documentEditor.zoomFactor,n=this.documentEditor.selection,r=n.getTextPosBasedOnLogicalIndex(this.getRelativePositionFromAbsolutePosition(t,!1,!1,!1)),o=r.location;e.style.display="block",e.parentElement||this.documentEditor.documentHelper.viewerContainer.appendChild(e);var s=n.getSelectionPage(r);if(s){e.style.left=s.boundingRectangle.x+Math.round(o.x)*i+"px";var a=n.updateCaretSize(r),l=a.topMargin;e.style.height=a.height*i+"px";var d=n.getPageTop(s);e.style.top=d+Math.round(o.y+l)*i+"px","Subscript"===n.characterFormat.baselineAlignment&&(e.style.top=parseFloat(e.style.top)+parseFloat(e.style.height)/2+"px")}},e.prototype.getBlockPosition=function(e,t,i,r,o,s,a){var l;if(i instanceof n._500){var d=this.getBlockTotalLength(e,t,i,r,o,s,a);if(r.done)return r.done=!0,d;t=d.currentLength,l=d.paragraph}else if(i instanceof n._502){if((e-=1)===t&&(o||this.documentEditor.selection.isEndOffset))return r.done=!0,{offset:e,currentLength:t,paragraph:l,tableWidget:i};for(var h=i.firstChild;h;){if((e-=1)===t){if(s||this.documentEditor.selection.isEndOffset){r.done=!0;var c=h.index;return{offset:e,currentLength:t,paragraph:l,rowOrCellIndex:c,rowWidget:h}}if(a){r.done=!0;var p=l.associatedCell,c=p.cellIndex+1;return{offset:e,currentLength:t,paragraph:l,rowOrCellIndex:c,cellWidget:p}}}for(var u=h.firstChild;u;){if((e-=1)===t&&a){r.done=!0;var c=u.cellIndex;return{offset:e,currentLength:t,paragraph:l,rowOrCellIndex:c,cellWidget:u}}for(var g=u.firstChild;g;){var f=this.getBlockPosition(e,t,g,r,o,s,a);if(r.done){if(s){r.done=!0;var m=u.ownerRow,c=m.index+1;return{offset:e,currentLength:t,paragraph:l,rowOrCellIndex:c,rowWidget:m}}if(a){r.done=!0;var p=u,c=p.cellIndex+1;return{offset:e,currentLength:t,paragraph:l,rowOrCellIndex:c,cellWidget:p}}return f}e=f.offset,t=f.currentLength,l=f.paragraph,g=g.getSplitWidgets().pop().nextRenderedWidget}u=u.nextWidget}h=h.getSplitWidgets().pop().nextRenderedWidget}}return{offset:e,currentLength:t,paragraph:l}},e.prototype.getBlockTotalLength=function(e,t,o,s,a,l,d){var h=o.getSplitWidgets(),c=0;if(t+1>=e)return s.done=!0,{offset:e-1,currentLength:t,paragraph:o};for(var p=0,u=0;u<h.length;u++)for(var g=0;g<h[u].childWidgets.length;g++)for(var f=h[u].childWidgets[g],m=0;m<f.children.length;m++){var v=f.children[m];if(!(v instanceof n._532)){if(v instanceof n._527&&!i.i(r.isNullOrUndefined)(v.textFrame)&&v.textFrame.childWidgets.length>0||v instanceof n._514){var y=void 0;if(v instanceof n._527)v.textFrame.childWidgets.length>0&&(y=this.getBlockPosition(e,t+p+c+1,v.textFrame.childWidgets[0],s,a,l,d));else for(var w=t+p+c+1,b=0;b<v.bodyWidget.childWidgets.length&&!s.done;b++)y=this.getBlockPosition(e,w,v.bodyWidget.childWidgets[b],s,a,l,d),w=y.currentLength;if(e=y.offset,p+=y.currentLength-(t+c+1+p),s.done)return t=y.currentLength,y}if(c+=v.length,t+p+c+1>=e)return s.done=!0,{offset:e-1,currentLength:t+p,paragraph:o}}}return t+p+c+1+1==e&&this.documentEditor.selection.isEndOffset?(s.done=!0,{offset:e-1,currentLength:t+p,paragraph:o}):(t+=c+p+1,{offset:e,currentLength:t,paragraph:o})},e.prototype.getRelativePositionFromAbsolutePosition=function(e,t,i,n){var r=this.documentEditor,o=this.documentEditor.documentHelper.pages[0].bodyWidgets[0].childWidgets[0],s=0,a={done:!1},l=this.getBlockByIndex(o,e,s,a,t,i,n);if(a.done){var d=l.offset-l.currentLength;d<0&&(d=0);var h={paragraph:l.paragraph,offset:d};return t||i||n?l:r.selection.getHierarchicalIndex(h.paragraph,h.offset.toString())}if(l.offset===l.currentLength+1&&this.documentEditor.selection.isEndOffset){var c=this.documentEditor.selection.getParagraphLength(l.paragraph);return s=l.currentLength-c,r.selection.getHierarchicalIndex(l.paragraph,(l.offset-s).toString())}var p=this.getBlockIndexFromHeaderFooter(l.offset,l.currentLength,a,t,i,n);if(a.done){var d=p.offset-p.currentLength;d<0&&(d=0);var h={paragraph:p.paragraph,offset:d};return t||i||n?p:r.selection.getHierarchicalIndex(h.paragraph,h.offset.toString())}return""},e.prototype.getBlockIndexFromHeaderFooter=function(e,t,i,n,r,o){for(var s,a=this.documentEditor.documentHelper.headersFooters,l=0,d=a;l<d.length;l++)for(var h=d[l],c=0;c<6;c++){var p=h[c];if(p){if(s=this.getBlockByIndex(p.childWidgets[0],e,t,i,n,r,o),t=s.currentLength,i.done)return s}else t++,s.currentLength=t}return s},e.prototype.getBlockByIndex=function(e,t,i,n,r,o,s){var a;do{if(a=this.getBlockPosition(t,i,e,n,r,o,s),i=a.currentLength,t=a.offset,n.done)return a;e=e.getSplitWidgets().pop().nextRenderedWidget}while(e);return a},e.prototype.insertImage=function(e){i.i(r.isNullOrUndefined)(e.metaString)?this.documentEditor.editor.insertImageInternal(e.imageString,!0,n._417.convertPointToPixel(e.width),n._417.convertPointToPixel(e.height)):(this.documentEditor.editor.isImageInsert=!0,this.documentEditor.editor.insertImageInternal(e.metaString,!0,n._417.convertPointToPixel(e.width),n._417.convertPointToPixel(e.height)))},e.prototype.buildTable=function(e){for(var t=0,o=0,s=0;s<e.length;s++)e[s].text===n.n.Row&&(i.i(r.isNullOrUndefined)(e[s].markerData)||this.documentEditor.editor.revisionData.push(e[s].markerData),t++);for(var s=0;s<e.length&&(e[s].text===n.n.Cell&&(s+=2,o++),e[s].text===n.n.Table||!i.i(r.isNullOrUndefined)(e[s+1])&&e[s+1].text!==n.n.Row);s++);this.documentEditor.editor.insertTable(t,o),this.documentEditor.editor.revisionData=[]},e.prototype.buildRow=function(e){var t,o=[],s=[],a=[],l=0,d=0,h=this.getRelativePositionFromAbsolutePosition(e[0].offset,!1,!0,!1),c=h.rowWidget.ownerTable.combineWidget(this.documentEditor.viewer);if(!i.i(r.isNullOrUndefined)(e[0].markerData)&&i.i(r.isNullOrUndefined)(e[0].format)){var p=h.rowWidget;if(p.rowFormat.revisions.length>0){return void p.rowFormat.revisions[0].accept()}}for(var u=0;u<e.length;u++){var g=e[u];if(g.text===n.n.Cell&&(l++,o.push(JSON.parse(g.format)),s.push(JSON.parse(e[u+1].format)),a.push(JSON.parse(e[u+2].format)),u+=2),i.i(r.isNullOrUndefined)(e[u+1])||e[u+1].text===n.n.Row)break}for(var u=0;u<e.length;u++)e[u].text===n.n.Row&&(i.i(r.isNullOrUndefined)(e[u].markerData)||this.documentEditor.editor.revisionData.push(e[u].markerData),d++,t=JSON.parse(e[u].format));this.documentEditor.editor.rowInsertionForCE(h.rowOrCellIndex,l,d,c,t,o,s,a),o=[],s=[],a=[],this.documentEditor.editor.revisionData=[]},e.prototype.buildCell=function(e,t,i){var n=this.getRelativePositionFromAbsolutePosition(e.offset,!1,!1,!0);e.length>0?(this.rowWidget=n.cellWidget.ownerRow,this.documentEditor.editor.cellInsertionForCE(n.rowOrCellIndex,this.rowWidget,JSON.parse(e.format),JSON.parse(t),JSON.parse(i))):this.documentEditor.documentHelper.owner.parser.parseCellFormat(JSON.parse(e.format),n.cellWidget.cellFormat,0)},e.prototype.buildDeleteCells=function(e){var t=this.getRelativePositionFromAbsolutePosition(e.offset,!1,!1,!0);if(!i.i(r.isNullOrUndefined)(t.cellWidget)){var n=this.documentEditor.selection.getFirstParagraph(t.cellWidget),o=this.documentEditor.selection.getLastParagraph(t.cellWidget);i.i(r.isNullOrUndefined)(n)||i.i(r.isNullOrUndefined)(o)||(this.documentEditor.selection.start.setPosition(n.firstChild,!0),this.documentEditor.selection.end.setPositionParagraph(o.lastChild,o.lastChild.getEndOffset()+1)),this.documentEditor.editor.checkAndRemoveComments(),this.table=t.cellWidget.ownerTable.combineWidget(this.documentEditor.viewer);var s=void 0;if(t.cellWidget.nextWidget){var a=t.cellWidget.nextWidget;s=this.documentEditor.selection.getFirstParagraph(a)}else if(t.cellWidget.previousWidget){var l=t.cellWidget.previousWidget;s=this.documentEditor.selection.getFirstParagraph(l)}i.i(r.isNullOrUndefined)(s)&&(s=this.documentEditor.editor.getParagraphForSelection(this.table)),e.length+=this.documentEditor.editor.onDeleteColumn(this.table,[t.cellWidget]),this.table.updateRowIndex(0),this.documentEditor.selection.selectParagraphInternal(s,!0)}},e.prototype.transformSelectionOperation=function(e,t){if("Delete"===e.action&&"Delete"===t.action){var i=t.offset,n=t;if(e.offset+e.length<=n.offset||e.offset>=n.offset+n.length)return;if(e.offset>=n.offset&&e.offset+e.length<=n.offset+n.length)return t.offset=t.offset,t.length-=e.length,void(t.length<=0&&(t.skipOperation=!0));if(e.offset<n.offset&&e.offset+e.length<=n.offset+n.length)return t.offset=e.offset+e.length,void(t.length-=t.offset-i);if(e.offset>=n.offset&&e.offset+e.length>n.offset+n.length)return void(t.length-=t.offset+t.length-e.offset);if(e.offset<n.offset&&e.offset+e.length>n.offset+n.length)return n.offset=e.offset,n.length=0,void(t.skipOperation=!0)}},e.prototype.documentSettings=function(e){switch(this.documentEditor.skipSettingsOps=!0,e.text){case"enableTrackChanges":this.documentEditor.enableTrackChanges=e.enableTrackChanges;break;case"protection":this.documentEditor.documentHelper.restrictEditingPane.showHideRestrictPane(!0),i.i(r.isNullOrUndefined)(e.protectionData.saltValue)?i.i(r.isNullOrUndefined)(e.protectionData.hashValue)?this.documentEditor.editor.unProtectDocument():this.documentEditor.editor.validateHashValue(e.protectionData.hashValue):""===e.protectionData.hashValue&&""===e.protectionData.saltValue?this.documentEditor.editor.protectDocument(e.protectionData.protectionType):this.documentEditor.editor.enforceProtectionAssign(e.protectionData.saltValue,e.protectionData.hashValue,e.protectionData.protectionType)}},e.prototype.checkAndRetriveChangesFromServer=function(){var e=this;if(!this.isSyncServerChanges){var t={version:this.version,connectionId:this.connectionId,roomName:this.roomName},i=new XMLHttpRequest;i.open("Post",this.serviceUrl+"GetActionsFromServer",!0),i.setRequestHeader("Content-Type","application/json;charset=UTF-8"),i.onreadystatechange=function(){4===i.readyState&&(200===i.status||304===i.status?e.applyChangesFromServer(i.responseText):alert("Fail to load the document"))},i.send(JSON.stringify(t)),this.isSyncServerChanges=!0}},e.prototype.applyChangesFromServer=function(e){var t=JSON.parse(e);if(t.length>0){for(var i=0;i<t.length;i++){var n=t[i];n.connectionId===this.connectionId?this.acknowledgementReceived():this.handleRemoteOperation(n),this.updateVersion(n.version),this.logMessage("Server sync ack:"+n.version)}this.updateVersion(t[t.length-1].version)}this.isSyncServerChanges=!1,this.isAcknowledgePending()||this.acknowledgementReceived(),this.sendLocalOperation()},e.prototype.insertCharaterFormat=function(e,t){var i=new n._439(void 0),r=JSON.parse(t),o=Object.keys(r);this.documentEditor.documentHelper.owner.parser.parseCharacterFormat(0,r,i),o.length>1?(this.documentEditor.documentHelper.owner.fontDialogModule.onCharacterFormat(this.documentEditor.selection,i),this.documentEditor.editor.onApplyCharacterFormat("CharacterFormat",i)):1===o.length?-1!==o.indexOf("styleName")?this.documentEditor.editor.applyStyle(r.styleName,!0):-1!==o.indexOf("allCaps")?this.documentEditor.editor.changeCase("Uppercase"):"increment"===e||"decrement"===e?this.documentEditor.editor.onApplyCharacterFormat(o[0],e,!0):this.documentEditor.editor.onApplyCharacterFormat(o[0],r[o[0]]):this.documentEditor.editor.clearFormatting()},e.prototype.insertParagraphFormat=function(e,t){var o=new n._442(void 0),s=JSON.parse(t),a=!1;i.i(r.isNullOrUndefined)(s.isFirstParaForList)||(delete s.isFirstParaForList,a=!0);var l=Object.keys(s);this.documentEditor.documentHelper.owner.parser.parseParagraphFormat(0,JSON.parse(t),o),1===l.length?-1!==l.indexOf("styleName")?this.documentEditor.editor.applyStyle(s.styleName,!0):"borders"===l[0]?this.documentEditor.editor.onApplyParagraphFormat(l[0],o.borders,!1,!1):this.documentEditor.editor.onApplyParagraphFormat(l[0],s[l[0]],a,!1):this.documentEditor.editor.updateSelectionParagraphFormatting(null,o,!1)},e.prototype.insertTableFormat=function(e,t,o){var s=new n._443(void 0),a=JSON.parse(t),l=Object.keys(a);this.documentEditor.documentHelper.owner.parser.parseTableFormat(a,s,0);var d=this.getRelativePositionFromAbsolutePosition(o,!0,!1,!1),h=d.tableWidget;if(!i.i(r.isNullOrUndefined)(e)){var c="TableAutoFitToContents"===e?"FitToContents":"TableAutoFitToWindow"===e?"FitToWindow":"FixedColumnWidth";return void this.documentEditor.editor.insertAutoFitTable(c,h)}1===l.length?this.documentEditor.editor.onApplyTableFormat(l[0],a[l[0]],h):-1!==l.indexOf("borders")||-1!==l.indexOf("shading")?(this.documentEditor.editor.isBordersAndShadingDialog=!0,this.documentEditor.editor.onTableFormat(s,!0,h),this.documentEditor.editor.isBordersAndShadingDialog=!1):-1!==l.indexOf("cellSpacing")||-1!==l.indexOf("leftMargin")||-1!==l.indexOf("topMargin")||-1!==l.indexOf("rightMargin")||-1!==l.indexOf("bottomMargin")?this.documentEditor.documentHelper.owner.tableOptionsDialogModule.applySubTableOptions(s,h):this.documentEditor.editor.onTableFormat(s,!1,h)},e.prototype.insertRowFormat=function(e,t){var i=new n._444(void 0),r=JSON.parse(t),o=Object.keys(r);this.documentEditor.documentHelper.owner.parser.parseRowFormat(r,i,0),1===o.length?this.documentEditor.editor.onApplyTableRowFormat(o[0],r[o[0]]):this.documentEditor.editor.onRowFormat(i)},e.prototype.insertCellFormat=function(e){var t=new n._445(void 0),i=JSON.parse(e),r=Object.keys(i);this.documentEditor.documentHelper.owner.parser.parseCellFormat(i,t,0),1===r.length?"shading"===r[0]?this.documentEditor.editor.onApplyTableCellFormat(r[0],t.shading):"borders"===r[0]?this.documentEditor.editor.onApplyTableCellFormat(r[0],t.borders):this.documentEditor.editor.onApplyTableCellFormat(r[0],i[r[0]]):-1!==r.indexOf("preferredWidth")||-1!==r.indexOf("preferredWidthType")||-1!==r.indexOf("verticalAlignment")||-1!==r.indexOf("borders")||-1!==r.indexOf("shading")?(-1===r.indexOf("borders")&&-1===r.indexOf("shading")||(this.documentEditor.editor.isBordersAndShadingDialog=!0),this.documentEditor.editor.onCellFormat(t),this.documentEditor.editor.isBordersAndShadingDialog=!1):this.documentEditor.documentHelper.owner.cellOptionsDialogModule.applySubCellOptions(t)},e.prototype.insertSectionFormat=function(e,t){var i=JSON.parse(t),r=Object.keys(i);if("linkToPrevious"===r[0]){var o=this.documentEditor.selection.start.paragraph.bodyWidget,s=o.sectionIndex,a=o.headerFooterType;this.documentEditor.editor.removeInlineHeaderFooterWidget(s,a,e,i.linkToPrevious)}else if(r.length>1){var l=new n._433;this.documentEditor.documentHelper.owner.parser.parseSectionFormat(0,i,l),this.documentEditor.editor.onApplySectionFormat(void 0,l)}else this.documentEditor.editor.onApplySectionFormat(Object.keys(i)[0],i[Object.keys(i)[0]])},e.prototype.logMessage=function(e){this.logEventEnabled&&(this.message+=e+" \n")},e.prototype.destory=function(){this.version=void 0,this.documentEditor=void 0,this.roomName=void 0,this.userMap=void 0,this.connectionId=void 0,this.acknowledgmentPending=void 0,this.pendingOps=void 0,this.serviceUrl=void 0,this.isSyncServerChanges=void 0,this.message=void 0,this.rowWidget=void 0},e}()),s=function(){function e(e,t,i,n){this.color=e,this.caret=t,this.offset=i,this.userName=n,this.initializeElement()}return e.prototype.initializeElement=function(){this.hoverDiv=i.i(r.createElement)("div",{className:"e-de-user-info e-de-user-name-collapse",styles:"z-index: 1; visibility: hidden;left:-4px;position:absolute;width:20px;height:20px;pointer-events:all;"}),this.userViewContainer=i.i(r.createElement)("div"),this.spanViewContainer=i.i(r.createElement)("div",{styles:"background-color:"+this.color+";left: 0px; top: 15px; visibility: visible;"}),this.spanView=i.i(r.createElement)("span",{styles:"background-color:"+this.color+"; left: 0px;top:-4px;pointer:default"}),this.spanViewContainer.appendChild(this.spanView),this.userViewContainer.appendChild(this.spanViewContainer),this.hoverDiv.appendChild(this.userViewContainer),this.caret.appendChild(this.hoverDiv),this.hoverDiv.addEventListener("mouseenter",this.onMouseEnter.bind(this)),this.hoverDiv.addEventListener("mouseleave",this.onMouseLeave.bind(this))},e.prototype.onMouseEnter=function(){this.hoverDiv.classList.remove("e-de-user-name-collapse"),this.hoverDiv.classList.add("e-de-user-name-expended"),this.spanView.innerText=this.userName},e.prototype.onMouseLeave=function(){this.hoverDiv.classList.add("e-de-user-name-collapse"),this.hoverDiv.classList.remove("e-de-user-name-expended"),this.spanView.innerText=""},e}()},function(e,t,i){"use strict";var n=i(83);i.d(t,"a",function(){return n.a})},function(e,t,i){"use strict";i.d(t,"a",function(){return c}),i.d(t,"b",function(){return p}),i.d(t,"c",function(){return u});var n=i(0),r=(i.n(n),i(2)),o=i(19),s=(i.n(o),i(3)),a=(i.n(s),i(15)),l=(i.n(a),i(8)),d=(i.n(l),i(11)),h=i(4),c=function(){function e(e){var t=this;this.isNewComment=!1,this.isUserClosed=!1,this.selectedTab=0,this.onTabSelection=function(e){e.preventFocus=!0,t.selectedTab=e.selectedIndex,1===t.selectedTab?t.owner.trackChangesPane.updateHeight():t.commentPane.updateHeight(),setTimeout(function(){t.owner&&t.owner.resize()},10)},this.owner=e;var i=new n.L10n("documenteditor",this.owner.defaultLocale);i.setLocale(this.owner.locale),this.initReviewPane(i),this.parentPaneElement.style.display="none"}return Object.defineProperty(e.prototype,"previousSelectedComment",{get:function(){return this.previousSelectedCommentInt},set:function(e){if(!i.i(n.isNullOrUndefined)(e)&&e!==this.previousSelectedCommentInt&&this.commentPane.comments.containsKey(e)){var t=this.commentPane.getCommentStart(e),r=t.commentMark;r&&(i.i(n.classList)(r,[],["e-de-cmt-mark-selected"]),this.commentPane.removeSelectionMark("e-de-cmt-selection"),this.commentPane.removeSelectionMark("e-de-cmt-mark-selected"));var o=this.commentPane.comments.get(e);o.hideDrawer();for(var s=0;s<e.replyComments.length;s++)(o=this.commentPane.comments.get(e.replyComments[s]))&&(o.hideDrawer(),o.hideMenuItems())}this.previousSelectedCommentInt=e},enumerable:!0,configurable:!0}),e.prototype.selectReviewTab=function(e){"Changes"===e?this.reviewTab.select(1):this.reviewTab.select(0)},e.prototype.showHidePane=function(e,t){this.parentPaneElement&&(this.updateTabHeaderWidth(),e?(this.parentPaneElement.style.display="block","Changes"===t&&this.owner.showRevisions?(this.isCommentTabVisible=!1,this.owner.notify("reviewPane",{comment:this.isCommentTabVisible,changes:!0}),this.reviewTab.select(1)):(this.owner.trackChangesPane.isChangesTabVisible=!1,this.owner.notify("reviewPane",{comment:!0,changes:this.owner.trackChangesPane.isChangesTabVisible,isUserClosed:!1}),this.reviewTab.select(0)),this.owner.trackChangesPane.updateTrackChanges(this.owner.showRevisions),this.commentPane.updateCommentStatus()):this.parentPaneElement.style.display="none",this.owner.showRevisions||(this.owner.trackChangesPane.isChangesTabVisible=!1,this.owner.notify("reviewPane",{comment:this.isCommentTabVisible,changes:this.owner.trackChangesPane.isChangesTabVisible}),this.reviewTab.hideTab(1,!0)),this.owner.showComments||(this.isCommentTabVisible=!1,this.owner.notify("reviewPane",{comment:this.isCommentTabVisible,changes:this.owner.trackChangesPane.isChangesTabVisible}),this.reviewTab.hideTab(0,!0))),e&&(this.enableDisableItems(),this.commentPane.updateHeight()),this.owner&&(this.owner.resize(),this.owner.enableAutoFocus&&this.owner.documentHelper.updateFocus())},e.prototype.reviewPaneHelper=function(e){var t=this;if(i.i(n.isNullOrUndefined)(e.isUserClosed)){if(this.isUserClosed)return}else{if(e.isUserClosed===this.isUserClosed)return;this.isUserClosed=e.isUserClosed,this.owner&&setTimeout(function(){t.owner&&t.owner.resize()},10)}i.i(n.isNullOrUndefined)(e.comment)&&i.i(n.isNullOrUndefined)(e.changes)||(e.comment||e.changes?("none"===this.parentPaneElement.style.display&&(this.parentPaneElement.style.display="block"),this.owner&&setTimeout(function(){t.owner&&t.owner.resize()},10)):(this.parentPaneElement.style.display="none",this.owner&&setTimeout(function(){t.owner&&t.owner.resize()},10)))},e.prototype.updateTabHeaderWidth=function(){var e=this.reviewTab.getRootElement().getElementsByClassName("e-tab-wrap");e[0].style.padding="0 8px",e[1].style.padding="0 8px"},e.prototype.initReviewPane=function(e){var t=this.owner.documentHelper.optionsPaneContainer;t.style.display="flex",this.initPaneHeader(e),t.appendChild(this.addReviewTab(e)),this.initCommentPane(),this.owner.on("reviewPane",this.reviewPaneHelper,this)},e.prototype.addReviewTab=function(e){var t=i.i(n.createElement)("div",{innerHTML:e.getConstant("Comments")}),r=i.i(n.createElement)("div",{innerHTML:e.getConstant("Changes")});this.parentPaneElement=i.i(n.createElement)("div",{styles:"height:100%;overflow:auto;display:none",className:"e-de-review-pane"}),this.element=i.i(n.createElement)("div",{className:"e-de-property-tab",id:this.owner.element.id+"Review_Tab"});var o=[{header:{text:t},content:this.reviewPane},{header:{text:r}}];return this.reviewTab=new a.Tab({items:o,selected:this.onTabSelection,animation:{previous:{effect:"None"},next:{effect:"None"}}}),this.reviewTab.appendTo(this.element),this.owner.enableRtl&&(this.reviewTab.enableRtl=!0),this.reviewTab.enablePersistence=!0,this.parentPaneElement.appendChild(this.element),this.parentPaneElement},e.prototype.initPaneHeader=function(e){return this.headerContainer=i.i(n.createElement)("div"),this.reviewPane=i.i(n.createElement)("div",{className:"e-de-cmt-pane"}),this.owner.enableRtl&&i.i(n.classList)(this.reviewPane,["e-rtl"],[]),this.headerContainer.appendChild(this.initToolbar(e)),this.reviewPane.appendChild(this.headerContainer),this.reviewPane.style.display="block",this.reviewPane},e.prototype.closePane=function(){if(this.commentPane&&this.commentPane.isEditMode)if(!i.i(n.isNullOrUndefined)(this.commentPane.currentEditingComment)&&this.commentPane.isInsertingReply&&""===this.commentPane.currentEditingComment.replyViewTextBox.value)this.owner.documentHelper.currentSelectedComment=void 0,this.commentPane.currentEditingComment.cancelReply(),this.owner.showComments=!1;else if(this.isNewComment||!i.i(n.isNullOrUndefined)(this.commentPane.currentEditingComment)&&this.commentPane.isInsertingReply&&""!==this.commentPane.currentEditingComment.replyViewTextBox.value||!i.i(n.isNullOrUndefined)(this.commentPane.currentEditingComment)&&!this.commentPane.isInsertingReply&&this.commentPane.currentEditingComment.textArea.value!==this.commentPane.currentEditingComment.comment.text){var e=new n.L10n("documenteditor",this.owner.defaultLocale);e.setLocale(this.owner.locale),this.confirmDialog=l.DialogUtility.confirm({title:e.getConstant("Un-posted comments"),content:e.getConstant("Discard Comment"),okButton:{text:e.getConstant("Discard"),click:this.discardButtonClick.bind(this)},cancelButton:{text:e.getConstant("Cancel"),click:this.closeDialogUtils.bind(this)},showCloseIcon:!0,closeOnEscape:!0,animationSettings:{effect:"Zoom"},position:{X:"Center",Y:"Center"}})}else this.owner.documentHelper.currentSelectedComment=void 0,this.commentPane.currentEditingComment.cancelEditing(),this.owner.showComments=!1;else this.owner.showComments=!1,this.owner.documentHelper.currentSelectedComment=void 0,this.owner.documentHelper.currentSelectedRevision=void 0,this.owner.notify("reviewPane",{changes:!1,comment:!1,isUserClosed:!0})},e.prototype.discardButtonClick=function(){if(this.commentPane.currentEditingComment){this.isNewComment;this.commentPane.currentEditingComment&&this.commentPane.isInsertingReply?this.commentPane.currentEditingComment.cancelReply():this.commentPane.currentEditingComment.cancelEditing(),this.owner.documentHelper.currentSelectedComment=void 0,this.closeDialogUtils(),this.owner.showComments=!1}},e.prototype.closeDialogUtils=function(){this.confirmDialog.close(),this.confirmDialog=void 0},e.prototype.initToolbar=function(e){return this.toolbarElement=i.i(n.createElement)("div"),this.toolbar=new a.Toolbar({items:[{prefixIcon:"e-de-new-cmt e-de-cmt-tbr",tooltipText:e.getConstant("New Comment"),text:e.getConstant("New Comment"),click:this.insertComment.bind(this)},{prefixIcon:"e-de-nav-left-arrow e-de-cmt-tbr",align:"Right",tooltipText:e.getConstant("Previous Comment"),click:this.navigatePreviousComment.bind(this)},{prefixIcon:"e-de-nav-right-arrow e-de-cmt-tbr",align:"Right",tooltipText:e.getConstant("Next Comment"),click:this.navigateNextComment.bind(this)}],enableRtl:this.owner.enableRtl}),this.toolbar.appendTo(this.toolbarElement),this.toolbarElement},e.prototype.insertComment=function(){this.owner&&this.owner.editorModule&&(this.owner.editor.isUserInsert=!0,this.owner.editorModule.insertComment(""),this.owner.editor.isUserInsert=!1)},e.prototype.addComment=function(e,t,i){if(this.isNewComment=t,this.selectReviewTab("Comments"),this.owner.documentHelper.currentSelectedComment=e,this.commentPane.insertComment(e),!t){this.commentPane.comments.get(e).cancelEditing(),this.enableDisableToolbarItem()}i&&this.selectComment(e)},e.prototype.deleteComment=function(e){this.commentPane&&this.commentPane.deleteComment(e)},e.prototype.selectComment=function(e){this.commentPane.isEditMode||(e.isReply&&(e=e.ownerComment),this.owner&&this.owner.viewer&&this.owner.documentHelper.currentSelectedComment!==e&&(this.owner.documentHelper.currentSelectedComment=e),this.commentPane.selectComment(e))},e.prototype.resolveComment=function(e){this.commentPane.resolveComment(e)},e.prototype.reopenComment=function(e){this.commentPane.reopenComment(e)},e.prototype.addReply=function(e,t,i){if(this.isNewComment=t,this.commentPane.insertReply(e),!t){this.commentPane.comments.get(e).cancelEditing(),this.enableDisableToolbarItem()}i&&this.selectComment(e.ownerComment)},e.prototype.navigatePreviousComment=function(){this.owner&&this.owner.editorModule&&this.owner.selection.navigatePreviousComment()},e.prototype.navigateNextComment=function(){this.owner&&this.owner.editorModule&&this.owner.selection.navigateNextComment()},e.prototype.enableDisableItems=function(){this.enableDisableToolbarItem();for(var e=this.commentPane.comments.keys,t=0;t<e.length;t++){var r=this.commentPane.comments.get(e[t]);this.owner.isReadOnly?(i.i(n.isNullOrUndefined)(r.replyViewTextBox)||(r.replyViewTextBox.style.display="none"),r.menuBar.style.display="none",r.resolveView&&(r.resolveView.style.display="none")):(i.i(n.isNullOrUndefined)(r.replyViewTextBox)||(r.replyViewTextBox.style.display="block"),r.menuBar.style.display="block",r.resolveView&&(r.resolveView.style.display=""))}},e.prototype.enableDisableToolbarItem=function(){if(this.toolbar){var e=!0;this.commentPane.isEditMode&&(e=!this.commentPane.isEditMode),this.owner.isReadOnly&&(e=!this.owner.isReadOnly);var t=this.toolbar.element.querySelectorAll(".e-de-cmt-tbr");this.toolbar.enableItems(t[0].parentElement.parentElement,e),e&&this.owner&&this.owner.viewer&&(e=!(0===this.owner.documentHelper.comments.length)),this.toolbar.enableItems(t[1].parentElement.parentElement,e),this.toolbar.enableItems(t[2].parentElement.parentElement,e)}},e.prototype.initCommentPane=function(){this.commentPane=new p(this.owner,this),this.commentPane.initCommentPane()},e.prototype.layoutComments=function(){for(var e=0;e<this.owner.documentHelper.comments.length;e++){var t=this.owner.documentHelper.comments[e];if(this.isUnreferredComment(t))this.owner.documentHelper.comments.splice(e,1),e--;else{for(var i=0;i<t.replyComments.length;i++)this.isUnreferredComment(t.replyComments[i])&&(t.replyComments.splice(i,1),i--);this.commentPane.addComment(t)}}},e.prototype.isUnreferredComment=function(e){return!(!i.i(n.isNullOrUndefined)(e.commentStart)&&!i.i(n.isNullOrUndefined)(e.commentEnd))},e.prototype.clear=function(){this.previousSelectedCommentInt=void 0,this.isNewComment=!1,this.isUserClosed=!1,this.isNewComment=!1,this.commentPane.clear()},e.prototype.discardComment=function(e){e&&(this.owner.editorHistory?(this.owner.editorHistory.undo(),this.owner.editorHistory.redoStack.pop(),this.owner.editor.isSkipOperationsBuild=!0,this.owner.editor.deleteCommentInternal(e),this.owner.editor.isSkipOperationsBuild=!1):this.owner.editor&&this.owner.editor.deleteCommentInternal(e))},e.prototype.destroy=function(){this.commentPane&&this.commentPane.destroy(),this.commentPane=void 0,this.toolbar&&this.toolbar.destroy(),this.toolbar=void 0,this.toolbarElement&&this.toolbarElement.parentElement&&this.toolbarElement.parentElement.removeChild(this.toolbarElement),this.toolbarElement=void 0,this.headerContainer&&this.headerContainer.parentElement&&this.headerContainer.parentElement.removeChild(this.headerContainer),this.headerContainer=void 0,this.previousSelectedCommentInt=void 0,this.reviewPane&&this.reviewPane.parentElement&&this.reviewPane.parentElement.removeChild(this.reviewPane),this.owner.isDestroyed||this.owner.off("reviewPane",this.reviewPaneHelper),i.i(n.isNullOrUndefined)(this.reviewTab)||this.reviewTab.destroy(),this.reviewTab=void 0,i.i(n.isNullOrUndefined)(this.confirmDialog)||this.confirmDialog.destroy(),this.confirmDialog=void 0,i.i(n.isNullOrUndefined)(this.previousSelectedCommentInt)||this.previousSelectedCommentInt.destroy(),this.previousSelectedCommentInt=void 0,this.reviewPane&&(this.reviewPane.innerHTML="",this.reviewPane.parentElement&&this.reviewPane.parentElement.removeChild(this.reviewPane)),this.reviewPane=void 0,this.parentPaneElement&&(this.parentPaneElement.innerHTML="",this.parentPaneElement.parentElement&&this.parentPaneElement.parentElement.removeChild(this.parentPaneElement)),this.parentPaneElement=void 0,this.owner=void 0},e}(),p=function(){function e(e,t){this.isEditModeInternal=!1,this.isInsertingReply=!1,this.owner=e,this.parentPane=t,this.parent=t.reviewPane,this.comments=new d.g}return Object.defineProperty(e.prototype,"isEditMode",{get:function(){return this.isEditModeInternal},set:function(e){this.isEditModeInternal=e;for(var t=this.comments.keys,i=0;i<t.length;i++){var n=this.comments.get(t[i]);e?n.menuBar.style.display="none":n.comment.isReply||(n.menuBar.style.display="block")}this.parentPane&&this.parentPane.enableDisableToolbarItem(),this.owner&&(this.isEditModeInternal?this.owner.trigger(d.h):this.owner.trigger(d.i))},enumerable:!0,configurable:!0}),e.prototype.initCommentPane=function(){this.commentPane=i.i(n.createElement)("div",{className:"e-de-cmt-container"});var e=new n.L10n("documenteditor",this.owner.defaultLocale);e.setLocale(this.owner.locale),this.noCommentIndicator=i.i(n.createElement)("div",{className:"e-de-cmt-no-cmt",innerHTML:e.getConstant("No comments in this document")}),this.commentPane.appendChild(this.noCommentIndicator),this.parent.appendChild(this.commentPane)},e.prototype.addComment=function(e){var t=new u(this.owner,this,e),i=t.layoutComment(!1);this.comments.add(e,t),this.commentPane.appendChild(i);for(var n=0;n<e.replyComments.length;n++){var r=new u(this.owner,this,e.replyComments[n]);this.comments.add(e.replyComments[n],r),i.insertBefore(r.layoutComment(!0),t.replyViewContainer)}this.updateCommentStatus(),t.hideDrawer()},e.prototype.updateHeight=function(){var e=this.parentPane.reviewTab.getRootElement().getElementsByClassName("e-tab-header")[0].getBoundingClientRect().height;this.commentPane.style.height=this.parentPane.parentPaneElement.clientHeight-this.parentPane.headerContainer.clientHeight-e+"px"},e.prototype.insertReply=function(e){var t=e.ownerComment,i=this.comments.get(t),n=new u(this.owner,this,e);this.comments.add(e,n);var r=n.layoutComment(!0),o=t.replyComments.indexOf(e);if(o===t.replyComments.length-1)i.parentElement.insertBefore(r,i.replyViewContainer);else{var s=t.replyComments[o+1];i.parentElement.insertBefore(r,this.comments.get(s).parentElement)}n.editComment()},e.prototype.insertComment=function(e){var t=new u(this.owner,this,e),i=t.layoutComment(!1);if(this.comments.add(e,t),this.owner.documentHelper.comments.indexOf(e)===this.owner.documentHelper.comments.length-1)this.commentPane.appendChild(i);else{var n=this.owner.documentHelper.comments.indexOf(e),r=this.comments.get(this.owner.documentHelper.comments[n+1]).parentElement;this.commentPane.insertBefore(i,r),i.focus()}this.updateCommentStatus(),t.editComment()},e.prototype.removeSelectionMark=function(e){if(this.parent)for(var t=this.parent.getElementsByClassName(e),r=0;r<t.length;r++)i.i(n.classList)(t[r],[],[e])},e.prototype.selectComment=function(e){if(this.removeSelectionMark("e-de-cmt-selection"),e.isReply&&(e=e.ownerComment),e){this.owner.notify("reviewPane",{comment:!0,changes:this.owner.trackChangesPane.isChangesTabVisible});var t=this.comments.get(e),r=t.parentElement;r&&(i.i(n.classList)(r,["e-de-cmt-selection"],[]),r.focus());var o=this.getCommentStart(e);o.commentMark||o.renderCommentMark(),i.i(n.classList)(o.commentMark,["e-de-cmt-mark-selected"],[]),t.showDrawer()}},e.prototype.getCommentStart=function(e){var t=new n.L10n("documenteditor",this.owner.defaultLocale);t.setLocale(this.owner.locale);var i=void 0;return e&&e.commentStart&&(i=e.commentStart),void 0!==i.commentMark&&(i.commentMark.title=t.getConstant("Click to see this comment")),this.getFirstCommentInLine(i)},e.prototype.getFirstCommentInLine=function(e){for(var t=0;t<e.line.children.length;t++){var i=e.line.children[t];if(i instanceof r.B&&0===i.commentType)return i}return e},e.prototype.deleteComment=function(e){var t=this.comments.get(e);if(!i.i(n.isNullOrUndefined)(t)){i.i(n.isNullOrUndefined)(this.currentEditingComment)||t.comment.commentId!=this.currentEditingComment.comment.commentId||(this.isEditMode=!1,this.currentEditingComment=void 0),t.parentElement&&t.parentElement.parentElement&&t.parentElement.parentElement.removeChild(t.parentElement);for(var r=0;r<e.replyComments.length;r++){var o=e.replyComments[r];this.comments.containsKey(o)&&this.comments.remove(o)}this.comments.remove(e),t.destroy()}this.updateCommentStatus()},e.prototype.resolveComment=function(e){var t=this.comments.get(e);t&&t.resolveComment()},e.prototype.reopenComment=function(e){var t=this.comments.get(e);t&&t.reopenComment()},e.prototype.updateCommentStatus=function(){0===this.owner.documentHelper.comments.length?(this.noCommentIndicator.parentElement||this.commentPane.appendChild(this.noCommentIndicator),this.noCommentIndicator.style.display="block",this.parentPane.isCommentTabVisible=!1,this.owner.notify("reviewPane",{comment:!1,changes:this.owner.trackChangesPane.isChangesTabVisible}),this.parentPane.reviewTab.hideTab(0)):this.owner.showComments&&(this.parentPane.isCommentTabVisible=!0,this.noCommentIndicator.style.display="none",this.owner.notify("reviewPane",{comment:!0,changes:this.owner.trackChangesPane.isChangesTabVisible}),this.parentPane.reviewTab.hideTab(0,!1)),this.parentPane&&this.parentPane.enableDisableToolbarItem()},e.prototype.clear=function(){this.isEditMode=!1,this.currentEditingComment=void 0,this.isInsertingReply=!1,this.removeChildElements(),this.commentPane.innerHTML="",this.updateCommentStatus()},e.prototype.removeChildElements=function(){for(var e=this.comments.keys,t=0;t<e.length;t++)this.comments.get(e[t]).destroy();this.comments.clear()},e.prototype.destroy=function(){this.removeChildElements(),this.noCommentIndicator&&this.noCommentIndicator&&this.noCommentIndicator.parentElement.removeChild(this.noCommentIndicator),this.noCommentIndicator=void 0,this.commentPane&&(this.commentPane.innerHTML="",this.commentPane.parentElement&&this.commentPane.parentElement.removeChild(this.commentPane)),this.commentPane=void 0,this.parent&&(this.parent.innerHTML="",this.parent.parentElement&&this.parent.parentElement.removeChild(this.parent)),this.parent=void 0,this.parentPane=void 0,this.currentEditingComment=void 0,this.owner=void 0},e}(),u=function(){function e(e,t,i){this.isReply=!1,this.isDrawerExpand=!1,this.owner=e,this.comment=i,this.commentPane=t}return e.prototype.layoutComment=function(e){this.isReply=e;var t="e-de-cmt-sub-container";e&&(t+=" e-de-cmt-reply");var r=new n.L10n("documenteditor",this.owner.defaultLocale);return r.setLocale(this.owner.locale),this.parentElement=i.i(n.createElement)("div",{className:t}),this.initCommentHeader(r),this.initCommentView(r),this.initDateView(),this.comment.isReply?this.menuBar.style.display="none":(this.parentElement.tabIndex=0,this.initReplyView(r),this.initResolveOption(r),this.initDrawer(),this.comment.isResolved&&this.resolveComment()),this.commentView.addEventListener("mouseenter",this.showMenuItems.bind(this)),this.commentView.addEventListener("mouseleave",this.hideMenuItemOnMouseLeave.bind(this)),this.parentElement},e.prototype.initCommentHeader=function(e){var t=i.i(n.createElement)("div",{className:"e-de-cmt-view"}),r=i.i(n.createElement)("div",{className:"e-de-cmt-author"}),s=i.i(n.createElement)("div",{className:"e-de-cmt-author-name"});s.textContent=this.comment.author,i.i(n.isNullOrUndefined)(this.comment.author)||(r.style.display="flex",this.owner.documentHelper.getAvatar(r,s,this.comment,void 0)),this.menuBar=i.i(n.createElement)("button",{className:"e-de-cp-option",attrs:{type:"button"}});var a=[{text:e.getConstant("Edit")},{text:e.getConstant("Delete")},{text:e.getConstant("Reply")},{text:e.getConstant("Resolve")}],l=new o.DropDownButton({items:this.isReply?a.splice(0,2):a,select:this.userOptionSelectEvent.bind(this),iconCss:"e-de-menu-icon",cssClass:"e-caret-hide",enableRtl:this.owner.enableRtl});this.menuBar.title=e.getConstant("More Options")+"...",l.appendTo(this.menuBar),r.appendChild(this.menuBar),this.dropDownButton=l,t.appendChild(r),this.commentView=t,this.parentElement.appendChild(t),t.addEventListener("click",this.selectComment.bind(this))},e.prototype.selectComment=function(){if(this.commentPane)if(this.commentPane.isEditMode){if(this.commentPane.isEditMode&&this.commentPane.isInsertingReply&&this.commentPane.currentEditingComment&&""===this.commentPane.currentEditingComment.replyViewTextBox.value){var e=this.comment;if(e&&e.isReply&&(e=this.comment.ownerComment),e&&this.owner.documentHelper.currentSelectedComment===e)return;this.commentPane.currentEditingComment.cancelReply(),this.owner.selection.selectComment(this.comment)}}else this.owner.selection.selectComment(this.comment)},e.prototype.initCommentView=function(e){this.commentText=i.i(n.createElement)("div",{className:"e-de-cmt-readonly"}),this.commentText.innerText=this.comment.text,this.commentView.appendChild(this.commentText),this.initEditView(e)},e.prototype.initEditView=function(e){this.textAreaContainer=i.i(n.createElement)("div",{styles:"display:none"}),this.textArea=i.i(n.createElement)("textarea",{className:"e-de-cmt-textarea e-input"}),this.textArea.placeholder=e.getConstant("Type your comment here"),this.textArea.rows=1,this.textArea.value=this.comment.text.trim(),this.textArea.addEventListener("keydown",this.updateTextAreaHeight.bind(this)),this.textArea.addEventListener("keyup",this.enableDisablePostButton.bind(this));var t=i.i(n.createElement)("div",{className:"e-de-cmt-action-button"}),r=i.i(n.createElement)("button",{className:"e-de-cmt-post-btn e-btn e-flat",attrs:{type:"button"}});this.postButton=new s.Button({cssClass:"e-btn e-flat e-primary e-de-overlay",iconCss:"e-de-cmt-post",disabled:!0},r),r.addEventListener("click",this.postComment.bind(this)),r.title=e.getConstant("Post"),r.setAttribute("aria-label",e.getConstant("Post"));var o=i.i(n.createElement)("button",{className:"e-de-cmt-cancel-btn e-btn e-flat",attrs:{type:"button"}});this.cancelButton=new s.Button({cssClass:"e-btn e-flat",iconCss:"e-de-cmt-cancel"},o),o.title=e.getConstant("Cancel"),o.setAttribute("aria-label",e.getConstant("Cancel")),o.addEventListener("click",this.cancelEditing.bind(this)),t.appendChild(r),t.appendChild(o),this.textAreaContainer.appendChild(this.textArea),this.textAreaContainer.appendChild(t),this.commentView.appendChild(this.textAreaContainer)},e.prototype.initDateView=function(){this.commentDate=i.i(n.createElement)("div",{className:"e-de-cmt-date"}),this.commentDate.innerText=h.a.getModifiedDate(this.comment.date),this.commentView.appendChild(this.commentDate)},e.prototype.initDrawer=function(){this.drawerElement=i.i(n.createElement)("div",{styles:"display:none;",className:"e-de-cmt-drawer-cnt"});var e=i.i(n.createElement)("div",{className:"e-de-cmt-drawer"}),t=i.i(n.createElement)("span");e.appendChild(t),this.drawerElement.appendChild(e),this.drawerSpanElement=t,this.drawerAction=e,this.drawerAction.addEventListener("click",this.showOrHideDrawer.bind(this)),this.parentElement.appendChild(this.drawerElement)},e.prototype.initReplyView=function(e){this.replyViewContainer=i.i(n.createElement)("div",{className:"e-de-cmt-rply-view"}),this.commentPane.parentPane.isNewComment&&(this.replyViewContainer.style.display="none"),this.replyViewTextBox=i.i(n.createElement)("textarea",{className:"e-de-cmt-textarea e-input"}),this.replyViewTextBox.placeholder=e.getConstant("Reply"),this.replyViewTextBox.rows=1,this.replyViewTextBox.value="",this.replyViewTextBox.readOnly=!0,this.replyViewTextBox.addEventListener("click",this.enableReplyView.bind(this)),this.replyViewTextBox.addEventListener("keydown",this.updateReplyTextAreaHeight.bind(this)),this.replyViewTextBox.addEventListener("keyup",this.enableDisableReplyPostButton.bind(this));var t=i.i(n.createElement)("div",{styles:"display:none",className:"e-de-cmt-action-button"}),r=i.i(n.createElement)("button",{className:"e-de-cmt-post-btn e-de-overlay e-btn e-flat",attrs:{type:"button"}});this.replyPostButton=new s.Button({cssClass:"e-btn e-flat e-primary",iconCss:"e-de-cmt-post",disabled:!0},r),r.addEventListener("click",this.postReply.bind(this)),r.title=e.getConstant("Post");var o=i.i(n.createElement)("button",{className:"e-de-cmt-cancel-btn e-btn e-flat",attrs:{type:"button"}});o.setAttribute("aria-label",e.getConstant("Cancel")),this.replyCancelButton=new s.Button({cssClass:"e-btn e-flat",iconCss:"e-de-cmt-cancel"},o),o.addEventListener("click",this.cancelReply.bind(this)),o.title=e.getConstant("Cancel"),t.appendChild(r),t.appendChild(o),this.replyFooter=t,this.replyViewContainer.appendChild(this.replyViewTextBox),this.replyViewContainer.appendChild(t),this.parentElement.appendChild(this.replyViewContainer)},e.prototype.initResolveOption=function(e){var t=i.i(n.createElement)("div",{className:"e-de-cmt-resolve-btn"}),r=i.i(n.createElement)("button",{className:"e-de-cmt-post-btn e-btn e-flat",attrs:{type:"button"}});this.reopenButton=new s.Button({cssClass:"e-btn e-flat",iconCss:"e-de-cmt-reopen"},r),r.title=e.getConstant("Reopen"),r.setAttribute("aria-label",e.getConstant("Reopen")),r.addEventListener("click",this.reopenButtonClick.bind(this));var o=i.i(n.createElement)("button",{className:"e-de-cmt-cancel-btn e-btn e-flat",attrs:{type:"button"}});o.title=e.getConstant("Delete"),o.setAttribute("aria-label",e.getConstant("Delete")),this.deleteButton=new s.Button({cssClass:"e-btn e-flat",iconCss:"e-de-cmt-delete"},o),o.addEventListener("click",this.deleteComment.bind(this)),t.appendChild(r),t.appendChild(o),this.resolveView=t,this.parentElement.appendChild(t)},e.prototype.reopenButtonClick=function(){this.owner.editor.reopenComment(this.comment)},e.prototype.deleteComment=function(){var e={author:this.comment.author,cancel:!1};this.owner.trigger(d.j,e);var t={author:this.comment.author,cancel:e.cancel,type:"Delete"};this.owner.trigger(d.k,t),t.cancel||this.owner.editorModule.deleteCommentInternal(this.comment)},e.prototype.updateReplyTextAreaHeight=function(){var e=this;setTimeout(function(){if(!i.i(n.isNullOrUndefined)(e.replyViewTextBox)){e.replyViewTextBox.style.height="auto";var t=e.replyViewTextBox.scrollHeight;e.replyViewTextBox.style.height=t+"px"}})},e.prototype.enableDisableReplyPostButton=function(){this.replyPostButton.disabled=""===this.replyViewTextBox.value,this.replyPostButton.disabled?i.i(n.classList)(this.replyPostButton.element,["e-de-overlay"],[]):this.replyPostButton.element.classList.contains("e-de-overlay")&&i.i(n.classList)(this.replyPostButton.element,[],["e-de-overlay"])},e.prototype.enableReplyView=function(){var e=this,t={author:this.comment.author,cancel:!1,type:"Reply"};this.owner.trigger(d.k,t),t.cancel&&"Reply"===t.type||this.commentPane.isEditMode||(this.commentPane.currentEditingComment=this,this.commentPane.isInsertingReply=!0,this.owner.documentHelper.currentSelectedComment!==this.comment&&this.owner.selection.selectComment(this.comment),this.commentPane.isEditMode=!0,this.replyViewTextBox.readOnly=!1,this.replyFooter.style.display="block",setTimeout(function(){e.replyViewTextBox.focus()}))},e.prototype.postReply=function(){var e=n.SanitizeHtmlHelper.sanitize(this.replyViewTextBox.value);this.cancelReply(),this.updateReplyTextAreaHeight(),this.owner.editorModule.replyComment(this.comment,e),this.owner.editor.isSkipOperationsBuild||this.owner.editor.isRemoteAction||this.owner.fireContentChange(),this.owner.editor.isSkipOperationsBuild=!1},e.prototype.cancelReply=function(){this.commentPane.currentEditingComment=void 0,this.commentPane.isInsertingReply=!0,this.commentPane.isEditMode=!1,this.replyPostButton.disabled=!0,this.replyViewTextBox.value="",this.replyViewTextBox.readOnly=!0,this.replyFooter.style.display="none"},e.prototype.updateTextAreaHeight=function(){var e=this;setTimeout(function(){if(!i.i(n.isNullOrUndefined)(e.textArea)){e.textArea.style.height="auto";var t=e.textArea.scrollHeight;e.textArea.style.height=t+"px"}})},e.prototype.showMenuItems=function(){this.comment.isReply&&!this.owner.isReadOnly&&(this.commentPane.isEditMode||i.i(n.isNullOrUndefined)(this.comment)||this.comment.isResolved||(this.menuBar.style.display="block"));var e=this.commentPane.getCommentStart(this.comment);i.i(n.isNullOrUndefined)(e)||i.i(n.isNullOrUndefined)(e.commentMark)||e.commentMark.classList.add("e-de-cmt-mark-hover")},e.prototype.hideMenuItemOnMouseLeave=function(){if(this.comment.isReply&&this.owner.documentHelper.currentSelectedComment!==this.comment.ownerComment&&this.hideMenuItems(),this.commentPane){var e=this.commentPane.getCommentStart(this.comment);i.i(n.isNullOrUndefined)(e)||i.i(n.isNullOrUndefined)(e.commentMark)||e.commentMark.classList.remove("e-de-cmt-mark-hover")}},e.prototype.hideMenuItems=function(){this.menuBar.style.display="none"},e.prototype.enableDisablePostButton=function(){this.postButton.disabled=""===this.textArea.value,this.postButton.disabled?i.i(n.classList)(this.postButton.element,["e-de-overlay"],[]):this.postButton.element.classList.contains("e-de-overlay")&&i.i(n.classList)(this.postButton.element,[],["e-de-overlay"])},e.prototype.editComment=function(){var e=this,t={author:this.comment.author,cancel:!1,type:"Edit"};this.owner.trigger(d.k,t),t.cancel&&"Edit"===t.type||(this.commentPane.currentEditingComment=this,this.commentPane.isInsertingReply=!1,this.commentPane.isEditMode=!0,this.commentText.style.display="none",this.textAreaContainer.style.display="block",this.commentDate.style.display="none",this.menuBar.style.display="none",this.updateTextAreaHeight(),setTimeout(function(){e.textArea&&e.textArea.focus()}))},e.prototype.resolveComment=function(){i.i(n.classList)(this.parentElement,["e-de-cmt-resolved"],[]);var e=new n.L10n("documenteditor",this.owner.defaultLocale);e.setLocale(this.owner.locale),this.dropDownButton.items=[{text:e.getConstant("Reopen")},{text:e.getConstant("Delete")}]},e.prototype.reopenComment=function(){i.i(n.classList)(this.parentElement,[],["e-de-cmt-resolved"]);var e=new n.L10n("documenteditor",this.owner.defaultLocale);e.setLocale(this.owner.locale),this.dropDownButton.items=[{text:e.getConstant("Edit")},{text:e.getConstant("Delete")},{text:e.getConstant("Reply")},{text:e.getConstant("Resolve")}],this.showDrawer()},e.prototype.postComment=function(){var e={author:this.comment.author,cancel:!1,type:"Post"};if(this.owner.trigger(d.k,e),!e.cancel||"Post"!==e.type){var t=n.SanitizeHtmlHelper.sanitize(this.textArea.value);if(this.owner.editor&&""!=this.comment.text&&this.comment.text!=t){this.owner.editor.initHistory("EditComment");var r={commentId:this.comment.commentId,text:this.comment.text};this.owner.editorHistory.currentBaseHistoryInfo.modifiedProperties.push(r),this.owner.editorHistory.currentBaseHistoryInfo.removedNodes.push(this.comment),this.owner.editorHistory.updateHistory()}this.commentText.innerText=t,this.comment.text=t,this.showCommentView(),this.commentPane&&this.commentPane.parentPane&&(this.commentPane.parentPane.isNewComment=!1),i.i(n.isNullOrUndefined)(this.replyViewContainer)||(this.replyViewContainer.style.display=""),this.owner.editor.isSkipOperationsBuild||this.owner.editor.isRemoteAction||this.owner.fireContentChange()}},e.prototype.showCommentView=function(){this.commentPane.isEditMode=!1,this.textAreaContainer.style.display="none",this.commentText.style.display="block",this.commentDate.style.display="block",this.menuBar.style.display="block"},e.prototype.cancelEditing=function(){if(this.showCommentView(),this.textArea.value=this.comment.text.trim(),this.commentPane.parentPane.isNewComment){this.commentPane&&this.commentPane.parentPane&&(this.commentPane.parentPane.isNewComment=!1);var e=this.owner;e.editor.isSkipOperationsBuild=!0,this.commentPane.parentPane.discardComment(this.comment),e.editor.isSkipOperationsBuild=!1}},e.prototype.showOrHideDrawer=function(){this.isDrawerExpand?this.hideDrawer():this.showDrawer()},e.prototype.hideDrawer=function(){if(this.parentElement){var e=new n.L10n("documenteditor",this.owner.defaultLocale);e.setLocale(this.owner.locale);var t=this.parentElement.getElementsByClassName("e-de-cmt-sub-container");if(t.length>1){for(var r=1;r<t.length;r++)t[r].style.display="none";this.drawerElement.style.display="block",i.i(n.classList)(this.drawerSpanElement,[],["e-de-nav-up"]),this.drawerSpanElement.innerText="+"+(t.length-1)+" "+e.getConstant("more")+"..."}this.isDrawerExpand=!1}},e.prototype.showDrawer=function(){if(this.parentElement){var e=this.parentElement.getElementsByClassName("e-de-cmt-sub-container");if(e.length>1){for(var t=0;t<e.length;t++)e[t].style.display="block";this.drawerElement.style.display="block",this.drawerSpanElement.innerText="",i.i(n.classList)(this.drawerSpanElement,["e-de-nav-up"],[])}this.isDrawerExpand=!0}},e.prototype.userOptionSelectEvent=function(e){var t=e.item.text,i=new n.L10n("documenteditor",this.owner.defaultLocale);switch(i.setLocale(this.owner.locale),t){case i.getConstant("Edit"):this.editComment();break;case i.getConstant("Reply"):this.enableReplyView();break;case i.getConstant("Delete"):this.deleteComment();break;case i.getConstant("Resolve"):this.owner.editor.resolveComment(this.comment);break;case i.getConstant("Reopen"):this.owner.editor.reopenComment(this.comment)}},e.prototype.unwireEvent=function(){this.drawerAction&&this.drawerAction.removeEventListener("click",this.showOrHideDrawer.bind(this)),this.textArea&&(this.textArea.removeEventListener("keydown",this.updateTextAreaHeight.bind(this)),this.textArea.removeEventListener("keyup",this.enableDisablePostButton.bind(this))),this.postButton&&this.postButton.removeEventListener("click",this.postComment.bind(this)),this.cancelButton&&this.cancelButton.removeEventListener("click",this.cancelEditing.bind(this)),this.commentView&&(this.commentView.removeEventListener("click",this.selectComment.bind(this)),this.commentView.removeEventListener("mouseenter",this.showMenuItems.bind(this)),this.commentView.removeEventListener("mouseleave",this.hideMenuItemOnMouseLeave.bind(this)))},e.prototype.destroy=function(){this.unwireEvent(),this.comment&&(this.comment=void 0),this.dropDownButton&&this.dropDownButton.destroy(),this.dropDownButton=void 0,this.postButton&&this.postButton.destroy(),this.postButton=void 0,this.cancelButton&&this.cancelButton.destroy(),this.cancelButton=void 0,this.replyPostButton&&(this.replyPostButton.destroy(),this.replyPostButton=void 0),this.replyCancelButton&&(this.replyCancelButton.destroy(),this.replyCancelButton=void 0),this.reopenButton&&(this.reopenButton.destroy(),this.reopenButton=void 0),this.deleteButton&&(this.deleteButton.destroy(),this.deleteButton=void 0),this.parentElement&&(this.parentElement.innerHTML="",this.parentElement.parentElement&&this.parentElement.parentElement.removeChild(this.parentElement)),this.parentElement=void 0,this.commentView&&(this.commentView.innerHTML="",this.commentView.parentElement&&this.commentView.parentElement.removeChild(this.commentView)),this.commentView=void 0,this.replyViewContainer=void 0,this.replyViewTextBox=void 0,this.replyFooter=void 0,this.resolveView=void 0,this.menuBar=void 0,this.drawerAction=void 0,this.commentText=void 0,this.commentDate=void 0,this.textAreaContainer=void 0,this.textArea=void 0,this.drawerElement=void 0,this.drawerSpanElement=void 0,this.commentPane=void 0,this.owner=void 0},e}()},function(e,t,i){"use strict";var n=i(85);i.d(t,"a",function(){return n.a}),i.d(t,"b",function(){return n.b}),i.d(t,"c",function(){return n.c})},function(e,t,i){"use strict";i.d(t,"a",function(){return d});var n=i(15),r=(i.n(n),i(0)),o=(i.n(r),i(2)),s=i(4),a=i(3),l=(i.n(a),i(8)),d=(i.n(l),function(){function e(e){var t=this;this.contextMenuInstance=void 0,this.menuItems=[],this.customMenuItems=[],this.ids=[],this.spellContextItems=[],this.customItems=[],this.onContextMenuInternal=function(e){MouseEvent;if(t.documentHelper.owner.isSpellCheck&&t.spellChecker.allowSpellCheckAndSuggestion){e.preventDefault(),t.currentContextInfo=t.spellChecker.findCurretText();var n,o,s=t.spellChecker.manageSpecialCharacters(t.currentContextInfo.text,void 0,!0);!i.i(r.isNullOrUndefined)(s)&&t.spellChecker.errorWordCollection.containsKey(s)?(t.spellChecker.currentContextInfo=t.currentContextInfo,t.spellChecker.errorSuggestions.containsKey(s)?(o=t.spellChecker.errorSuggestions.get(s).slice(),n=t.spellChecker.handleSuggestions(o),t.processSuggestions(o,n,e)):t.spellChecker.enableOptimizedSpellCheck?t.spellChecker.callSpellChecker(t.spellChecker.languageID,s,!1,!0,!1,!1).then(function(a){var l=JSON.parse(a);o=l.Suggestions,i.i(r.isNullOrUndefined)(o)||(t.spellChecker.errorSuggestions.add(s,o.slice()),n=t.spellChecker.handleSuggestions(o)),t.processSuggestions(o,n,e)}):t.processSuggestions(o,n,e)):(t.hideSpellContextItems(),t.showContextMenuOnSel(e))}else t.hideSpellContextItems(),t.showContextMenuOnSel(e)},this.documentHelper=e,this.locale=new r.L10n("documenteditor",this.documentHelper.owner.defaultLocale),this.locale.setLocale(this.documentHelper.owner.locale),this.initContextMenu(this.locale,this.documentHelper.owner.enableRtl)}return Object.defineProperty(e.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spellChecker",{get:function(){return this.documentHelper.owner.spellChecker},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"ContextMenu"},e.prototype.initContextMenu=function(e,t){var o=this,s=this.documentHelper.owner.element.id;this.contextMenu=document.createElement("div"),this.contextMenu.id=this.documentHelper.owner.containerId+"e-de-contextmenu",document.body.appendChild(this.contextMenu);var a=document.createElement("ul");a.contentEditable="false",a.style.width="auto",a.id=this.documentHelper.owner.containerId+"e-de-contextmenu-list",a.style.listStyle="none",a.style.margin="0px",a.style.maxHeight="auto",a.oncontextmenu=this.disableBrowserContextmenu,this.contextMenu.appendChild(a),this.menuItems=[{text:e.getConstant("Lock"),iconCss:"e-icons e-de-ctnr-lock",id:s+"_contextmenu_lock"},{text:e.getConstant("Unlock"),iconCss:"e-icons",id:s+"_contextmenu_unlock"},{text:e.getConstant("Cut"),iconCss:"e-icons e-de-cut",id:s+"_contextmenu_cut"},{text:e.getConstant("Copy"),iconCss:"e-icons e-de-copy",id:s+"_contextmenu_copy"},{text:e.getConstant("Paste"),iconCss:"e-icons e-de-paste",id:s+"_contextmenu_paste"},{separator:!0},{text:e.getConstant("New Comment"),iconCss:"e-icons e-de-cmt-add",id:s+"_add_comment"},{separator:!0},{text:e.getConstant("Accept Changes"),iconCss:"e-icons e-de-acceptchange",id:s+"_contextmenu_accept_changes"},{text:e.getConstant("Reject Changes"),iconCss:"e-icons e-de-rejectchange",id:s+"_contextmenu_reject_changes"},{text:e.getConstant("Update Field"),iconCss:"e-icons e-de-update-field",id:s+"_contextmenu_update_field"},{text:e.getConstant("Edit Field")+"...",iconCss:"e-icons e-de-edit_field",id:s+"_contextmenu_edit_field"},{text:e.getConstant("Continue Numbering"),iconCss:"e-icons e-de-continue-numbering",id:s+"_contextmenu_continue_numbering"},{text:e.getConstant("Restart At")+" 1",iconCss:"e-icons e-de-restart-at",id:s+"_contextmenu_restart_at"},{separator:!0},{text:e.getConstant("Hyperlink")+"...",iconCss:"e-icons e-de-insertlink",id:s+"_contextmenu_hyperlink"},{text:e.getConstant("Edit Hyperlink")+"...",iconCss:"e-icons e-de-edit-hyperlink",id:s+"_contextmenu_edit_hyperlink"},{text:e.getConstant("Open Hyperlink"),iconCss:"e-icons e-de-open-hyperlink",id:s+"_contextmenu_open_hyperlink"},{text:e.getConstant("Copy Hyperlink"),iconCss:"e-icons e-de-copy-hyperlink",id:s+"_contextmenu_copy_hyperlink"},{text:e.getConstant("Remove Hyperlink"),iconCss:"e-icons e-de-remove-hyperlink",id:s+"_contextmenu_remove_hyperlink"},{text:e.getConstant("Properties"),iconCss:"e-icons e-de-formproperties",id:s+"_properties"},{separator:!0},{text:e.getConstant("Font")+"...",iconCss:"e-icons e-de-fonts",id:s+"_contextmenu_font_dialog"},{text:e.getConstant("Paragraph")+"...",iconCss:"e-icons e-de-paragraph",id:s+"_contextmenu_paragraph_dialog"},{text:e.getConstant("Notes Options")+"...",id:s+"_contextmenu_note_options"},{separator:!0},{text:e.getConstant("Table Properties")+"...",id:s+"_contextmenu_table_dialog",iconCss:"e-icons e-de-table"},{text:e.getConstant("Merge Cells"),id:s+"_contextmenu_merge_cell",iconCss:"e-icons e-de-ctnr-mergecell"},{text:e.getConstant("AutoFit"),id:s+"_contextmenu_auto_fit",iconCss:"e-icons",items:[{text:e.getConstant("AutoFit to Contents"),id:s+"_contextmenu_auto_fit_contents",iconCss:"e-icons e-de-icon-autofit e-de-autofit-contents"},{text:e.getConstant("AutoFit to Window"),id:s+"_contextmenu_auto_fit_window",iconCss:"e-icons e-de-icon-auto-fitwindow e-de-autofit-window"},{text:e.getConstant("Fixed Column Width"),id:s+"_contextmenu_fixed_column_width",iconCss:"e-icons e-de-icon-fixed-columnwidth e-de-fixed-column"}]},{text:e.getConstant("Insert"),id:s+"_contextmenu_insert_table",iconCss:"e-icons",items:[{text:e.getConstant("Insert Above"),id:s+"_contextmenu_insert_above",iconCss:"e-icons e-de-insertabove"},{text:e.getConstant("Insert Below"),id:s+"_contextmenu_insert_below",iconCss:"e-icons e-de-insertbelow"},{text:e.getConstant("Insert Left"),id:s+"_contextmenu_insert_left",iconCss:"e-icons e-de-insertleft"},{text:e.getConstant("Insert Right"),id:s+"_contextmenu_insert_right",iconCss:"e-icons e-de-insertright"}]},{text:e.getConstant("Delete"),id:s+"_contextmenu_delete_table",iconCss:"e-icons",items:[{text:e.getConstant("Delete Table"),id:s+"_contextmenu_complete_table_delete",iconCss:"e-icons e-de-delete-table"},{text:e.getConstant("Delete Row"),id:s+"_contextmenu_delete_row",iconCss:"e-icons e-de-deleterow"},{text:e.getConstant("Delete Column"),id:s+"_contextmenu_delete_column",iconCss:"e-icons e-de-deletecolumn"}]}];var l={target:"#"+this.documentHelper.owner.containerId+"e-de-contextmenu",enableRtl:t,items:this.addMenuItems(this.menuItems),cssClass:"e-de-contextmenu-wrapper",select:function(e){var t=e.element.id;o.handleContextMenuItem(t)}};this.contextMenuInstance=new n.ContextMenu(l,"#"+this.documentHelper.owner.containerId+"e-de-contextmenu-list"),this.contextMenuInstance.beforeOpen=function(){for(var e=0;e<o.customMenuItems.length;e++)void 0!==o.customMenuItems[e].id?o.ids[e]=o.customMenuItems[e].id:o.ids[e]=o.customMenuItems[e+1].id;if(o.documentHelper.owner.fireCustomContextMenuBeforeOpen(o.ids),o.enableCustomContextMenu)for(var e=0;e<o.menuItems.length;e++)void 0!==o.menuItems[e].id?document.getElementById(o.menuItems[e].id).style.display="none":document.getElementById(o.menuItems[e-1].id).nextSibling.style.display="none";o.viewer&&o.documentHelper.selection&&(i.i(r.classList)(o.documentHelper.selection.caret,[],["e-de-cursor-animation"]),o.documentHelper.selection.showCaret())},i.i(r.isNullOrUndefined)(this.documentHelper.owner.documentEditorSettings.popupTarget)||this.documentHelper.owner.documentEditorSettings.popupTarget.append(document.getElementsByClassName("e-de-contextmenu-wrapper")[0]),this.contextMenuInstance.onClose=function(){o.viewer&&o.documentHelper.selection&&(i.i(r.classList)(o.documentHelper.selection.caret,["e-de-cursor-animation"],[]),s+"_contextmenu_font_dialog"!==o.itemsmenu&&s+"_contextmenu_hyperlink"!==o.itemsmenu&&s+"_contextmenu_table_dialog"!==o.itemsmenu&&s+"_contextmenu_paragraph_dialog"!==o.itemsmenu&&o.documentHelper.updateFocus())}},e.prototype.disableBrowserContextmenu=function(){return!1},e.prototype.openPasteDialog=function(){var e=this,t=i.i(r.createElement)("div"),n=i.i(r.createElement)("div"),o=i.i(r.createElement)("p"),s=this.locale.getConstant("Paste Content Dialog");this.documentHelper.isIosDevice?o.textContent=s+" Command + V.":o.textContent=s+" Ctrl + V.",n.appendChild(o),t.appendChild(n);var d=i.i(r.createElement)("div");(this.pasteCheckBoxDialog=i.i(r.createElement)("input",{attrs:{type:"checkbox"}}),d.appendChild(this.pasteCheckBoxDialog),new a.CheckBox({label:this.locale.getConstant("Paste Content CheckBox")}).appendTo(this.pasteCheckBoxDialog),t.appendChild(d),JSON.parse(localStorage.getItem("ej_de_hidePasteAlert")))||l.DialogUtility.alert({title:this.locale.getConstant("Information"),content:t,okButton:{text:this.locale.getConstant("Ok")},showCloseIcon:!0,closeOnEscape:!0,animationSettings:{effect:"Zoom"},close:function(){e.pasteCheckBoxDialog.checked&&localStorage.setItem("ej_de_hidePasteAlert","true")}})},e.prototype.handleContextMenuItem=function(e){var t=this.documentHelper.owner.element.id;switch(this.itemsmenu=e,e){case t+"_contextmenu_lock":this.documentHelper.owner.collaborativeEditingModule&&this.documentHelper.owner.collaborativeEditingModule.lockContent(this.documentHelper.owner.currentUser);break;case t+"_contextmenu_unlock":this.documentHelper.owner.collaborativeEditingModule&&this.documentHelper.owner.collaborativeEditingModule.unlockContent(this.documentHelper.owner.currentUser);break;case t+"_contextmenu_copy":this.documentHelper.selection.copy();break;case t+"_contextmenu_cut":this.documentHelper.owner.editor.cut();break;case t+"_contextmenu_paste":this.documentHelper.owner.isReadOnlyMode||(this.documentHelper.owner.enableLocalPaste?this.documentHelper.owner.editorModule.pasteInternal(void 0):this.openPasteDialog());break;case t+"_add_comment":this.documentHelper.owner.isReadOnlyMode&&!this.documentHelper.isCommentOnlyMode||(this.documentHelper.owner.editor.isUserInsert=!0,this.documentHelper.owner.editorModule.insertComment(),this.documentHelper.owner.editor.isUserInsert=!1);break;case t+"_contextmenu_update_field":var i=this.documentHelper.owner.isReadOnlyMode;this.documentHelper.selection.isReferenceField()&&(!i||i&&"FormFieldsOnly"===this.documentHelper.protectionType)?this.documentHelper.selection.updateRefField():this.documentHelper.owner.isReadOnlyMode||this.documentHelper.owner.editorModule.updateToc();break;case t+"_contextmenu_edit_field":this.documentHelper.owner.isReadOnlyMode||this.documentHelper.owner.tableOfContentsDialogModule.show();break;case t+"_contextmenu_font_dialog":this.documentHelper.owner.fontDialogModule&&this.documentHelper.owner.fontDialogModule.showFontDialog();break;case t+"_contextmenu_open_hyperlink":this.documentHelper.selection.navigateHyperlink();break;case t+"_contextmenu_copy_hyperlink":this.documentHelper.selection.copyHyperlink();break;case t+"_contextmenu_edit_hyperlink":case t+"_contextmenu_hyperlink":this.documentHelper.owner.hyperlinkDialogModule&&this.documentHelper.owner.hyperlinkDialogModule.show();break;case t+"_contextmenu_remove_hyperlink":this.documentHelper.owner.editor.removeHyperlink();break;case t+"_contextmenu_paragraph_dialog":this.documentHelper.owner.paragraphDialogModule&&this.documentHelper.owner.paragraphDialogModule.show();break;case t+"_contextmenu_table_dialog":this.documentHelper.owner.tablePropertiesDialogModule.show();break;case t+"_contextmenu_merge_cell":this.documentHelper.owner.editor.mergeCells();break;case t+"_contextmenu_insert_above":this.documentHelper.owner.editor.insertRow(!0);break;case t+"_contextmenu_insert_below":this.documentHelper.owner.editor.insertRow(!1);break;case t+"_contextmenu_insert_left":this.documentHelper.owner.editor.insertColumn(!0);break;case t+"_contextmenu_insert_right":this.documentHelper.owner.editor.insertColumn(!1);break;case t+"_contextmenu_complete_table_delete":this.documentHelper.owner.editor.deleteTable();break;case t+"_contextmenu_delete_row":this.documentHelper.owner.editor.deleteRow();break;case t+"_contextmenu_delete_column":this.documentHelper.owner.editor.deleteColumn();break;case t+"_contextmenu_continue_numbering":this.documentHelper.owner.editorModule.applyContinueNumbering();break;case t+"_contextmenu_restart_at":this.documentHelper.owner.editorModule.applyRestartNumbering(this.documentHelper.selection);break;case t+"_contextmenu_auto_fit_contents":this.documentHelper.owner.editor.autoFitTable("FitToContents");break;case t+"_contextmenu_auto_fit_window":this.documentHelper.owner.editor.autoFitTable("FitToWindow");break;case t+"_contextmenu_fixed_column_width":this.documentHelper.owner.editor.autoFitTable("FixedColumnWidth");break;case t+"_contextmenu_spelling_dialog":var n=this.spellChecker.retriveText();this.currentContextInfo=null,this.documentHelper.owner.spellCheckDialog.show(n.text,n.element);break;case t+"_contextmenu_accept_changes":this.documentHelper.selection.handleAcceptReject(!0);break;case t+"_contextmenu_reject_changes":this.documentHelper.selection.handleAcceptReject(!1);break;case t+"_properties":var r=this.documentHelper.selection.getCurrentFormField();r instanceof o.b&&(r.formFieldData instanceof o.l?this.documentHelper.owner.textFormFieldDialogModule.show():r.formFieldData instanceof o.m?this.documentHelper.owner.checkBoxFormFieldDialogModule.show():r.formFieldData instanceof o.n&&this.documentHelper.owner.dropDownFormFieldDialogModule.show());break;case t+"_contextmenu_note_options":this.documentHelper.owner.showFootNotesDialog();break;default:var s=this.documentHelper.owner.element.id+"_contextmenu_otherSuggestions_spellcheck_";if(e.substring(0,s.length)===s){var a=e.substring(e.lastIndexOf("_")+1);this.callSelectedOption(a);break}this.documentHelper.owner.fireCustomContextMenuSelect(e)}},e.prototype.callSelectedOption=function(e){"Add to Dictionary"===e?this.spellChecker.handleAddToDictionary():"Ignore All"===e?this.spellChecker.handleIgnoreAllItems():this.spellChecker.manageReplace(e)},e.prototype.addCustomMenu=function(e,t,i){var n=JSON.parse(s.a.sanitizeString(JSON.stringify(e)));this.destroy(),0===this.spellContextItems.length&&(this.customItems=e);for(var r=0;r<n.length;r++)this.customMenuItems.push(n[r]),this.customMenuItems[r].id=this.documentHelper.owner.element.id+this.customMenuItems[r].id;this.enableCustomContextMenu=t,this.enableCustomContextMenuBottom=i,this.initContextMenu(this.locale)},e.prototype.addMenuItems=function(e){return this.enableCustomContextMenuBottom?e.concat(this.customMenuItems):this.customMenuItems.concat(e)},e.prototype.showContextMenuOnSel=function(e){var t=!(e instanceof MouseEvent),i=0,n=0;if(t){var o=this.documentHelper.getTouchOffsetValue(e);i=o.x,n=o.y}else n=(r.Browser.isIE?e.clientY:e.y)+document.body.scrollTop+document.documentElement.scrollTop,i=(r.Browser.isIE?e.clientX:e.x)+document.body.scrollLeft+document.documentElement.scrollLeft;this.showHideElements(this.documentHelper.selection)&&(t&&(this.documentHelper.isMouseDown=!1),this.contextMenuInstance.open(n,i),e.preventDefault())},e.prototype.hideSpellContextItems=function(){if(this.spellContextItems.length>0)for(var e=0;e<this.spellContextItems.length;e++){var t=document.getElementById(this.documentHelper.owner.element.id+this.spellContextItems[e].id);i.i(r.isNullOrUndefined)(t)||(t.style.display="none")}},e.prototype.processSuggestions=function(e,t,n){this.spellContextItems=this.constructContextmenu(e,t),this.addCustomMenu(this.spellContextItems),this.noSuggestion=document.getElementById(this.documentHelper.owner.element.id+"_contextmenu_no_suggestion"),i.i(r.isNullOrUndefined)(this.noSuggestion)||(this.noSuggestion.style.display="block",i.i(r.classList)(this.noSuggestion,["e-disabled"],["e-focused"])),this.showContextMenuOnSel(n)},e.prototype.constructContextmenu=function(e,t){var n=this.customItems.length>0?this.customItems.slice():[];if(i.i(r.isNullOrUndefined)(e)||0===e.length)n.push({text:this.locale.getConstant("no suggestions"),id:"_contextmenu_no_suggestion",classList:["e-focused"],iconCss:""});else for(var o=0;o<e.length;o++)n.push({text:e[o],id:"_contextmenu_otherSuggestions_spellcheck_"+e[o],iconCss:""});return n.push({separator:!0,id:"_contextmenu_suggestion_separator"}),!i.i(r.isNullOrUndefined)(t)&&t.length>1?(n.push({text:this.locale.getConstant("More Suggestion"),items:t}),n.push({separator:!0,id:"_contextmenu_moreSuggestion_separator"})):n.push({text:this.locale.getConstant("Add to Dictionary"),id:"_contextmenu_otherSuggestions_spellcheck_Add to Dictionary",iconCss:""}),n.push({text:this.locale.getConstant("Ignore Once"),id:"_contextmenu_otherSuggestions_spellcheck_Ignore Once",iconCss:""}),n.push({text:this.locale.getConstant("Ignore All"),id:"_contextmenu_otherSuggestions_spellcheck_Ignore All",iconCss:""}),n.push({separator:!0,id:"_contextmenu_change_separator"}),n.push({text:this.locale.getConstant("Spelling"),id:"_contextmenu_spelling_dialog",iconCss:"e-icons e-de-spellcheck",items:[]}),n.push({separator:!0,id:"_contextmenu_spelling_separator"}),n},e.prototype.showHideElements=function(e){if(i.i(r.isNullOrUndefined)(e))return!1;e.hideToolTip();var t=this.documentHelper.owner,n=t.element.id,s=document.getElementById(n+"_contextmenu_lock"),a=document.getElementById(n+"_contextmenu_unlock"),l=document.getElementById(n+"_contextmenu_copy"),d=document.getElementById(n+"_contextmenu_cut"),h=document.getElementById(n+"_contextmenu_paste"),c=document.getElementById(n+"_contextmenu_update_field"),p=document.getElementById(n+"_contextmenu_edit_field"),u=document.getElementById(n+"_contextmenu_font_dialog"),g=document.getElementById(n+"_contextmenu_paragraph_dialog"),f=document.getElementById(n+"_contextmenu_table_dialog"),m=document.getElementById(n+"_contextmenu_insert_table"),v=document.getElementById(n+"_contextmenu_delete_table"),y=document.getElementById(n+"_contextmenu_merge_cell"),w=document.getElementById(n+"_contextmenu_hyperlink"),b=document.getElementById(n+"_contextmenu_open_hyperlink"),x=document.getElementById(n+"_contextmenu_edit_hyperlink"),C=document.getElementById(n+"_contextmenu_copy_hyperlink"),I=document.getElementById(n+"_contextmenu_remove_hyperlink"),F=document.getElementById(n+"_properties"),k=document.getElementById(n+"_contextmenu_continue_numbering"),P=document.getElementById(n+"_contextmenu_restart_at"),T=document.getElementById(n+"_contextmenu_auto_fit"),S=document.getElementById(n+"_add_comment"),W=document.getElementById(n+"_contextmenu_note_options");this.documentHelper.owner.enableLockAndEdit?this.documentHelper.editRanges.containsKey(this.documentHelper.owner.currentUser)?(s.style.display="none",a.style.display="block",this.documentHelper.selection.isSelectionInEditRegion()?i.i(r.classList)(a,["e-blankicon"],["e-disabled"]):i.i(r.classList)(a,["e-disabled","e-blankicon"],[])):(s.style.display="block",this.documentHelper.owner.collaborativeEditingModule&&this.documentHelper.owner.collaborativeEditingModule.canLock()?i.i(r.classList)(a,["e-disabled"],[]):i.i(r.classList)(a,[],["e-disabled"]),a.style.display="none"):(s.style.display="none",a.style.display="none");var N=!1;d.style.display="none",h.style.display="none",h.nextSibling.style.display="none";var H=document.getElementById(n+"_contextmenu_accept_changes"),E=document.getElementById(n+"_contextmenu_reject_changes");w.style.display="none",W.style.display="none",W.nextSibling.style.display="none",u.previousSibling.style.display="none",b.style.display="none",C.style.display="none",x.style.display="none",I.style.display="none",I.nextSibling.style.display="none",F.style.display="none",y.style.display="none",T.style.display="none",u.style.display="none",g.style.display="none",m.style.display="none",v.style.display="none",f.style.display="none",c.style.display="none";var O=e.getHyperlinkField(),_=!1;H.style.display="none",E.style.display="none",O instanceof o.b&&e.isReferenceField(O)&&(_=!0),O instanceof o.b&&_&&("FormFieldsOnly"===this.documentHelper.protectionType||!this.documentHelper.owner.isReadOnlyMode)&&(c.style.display="block"),p.style.display="none",k.style.display="none",P.style.display="none",P.nextSibling.style.display="none";var B=e.isEmpty;i.i(r.classList)(d,B?["e-disabled"]:[],B?[]:["e-disabled"]),i.i(r.classList)(l,B?["e-disabled"]:[],B?[]:["e-disabled"]);var L=this.documentHelper.owner.isReadOnlyMode||this.documentHelper.owner.enableHeaderAndFooter||!this.documentHelper.owner.enableComment;if(S.style.display=L?"none":"block",this.documentHelper.isCommentOnlyMode&&(S.style.display="block"),S.previousSibling.style.display=L?"none":"block",S.nextSibling.style.display=L?"none":"block",t.isReadOnlyMode)return!i.i(r.isNullOrUndefined)(O)&&O instanceof o.b&&(b.style.display="block",C.style.display="block"),!0;if(this.viewer&&this.documentHelper.owner&&this.documentHelper.owner.commentReviewPane&&this.documentHelper.owner.commentReviewPane.commentPane.isEditMode?i.i(r.classList)(S,["e-disabled"],[]):i.i(r.classList)(S,[],["e-disabled"]),H.previousSibling.style.display="none",d.style.display="block",h.style.display="block",h.nextSibling.style.display="block",i.i(r.classList)(m,["e-blankicon"],[]),i.i(r.classList)(v,["e-blankicon"],[]),i.i(r.classList)(p,["e-blankicon"],[]),i.i(r.classList)(T,["e-blankicon"],[]),!r.Browser.isIE){if(JSON.parse(localStorage.getItem("ej_de_hidePasteAlert"))){var R=t.enableLocalPaste&&!i.i(r.isNullOrUndefined)(t.editor.copiedData);i.i(r.classList)(h,R?[]:["e-disabled"],R?["e-disabled"]:[])}}if("TableOfContents"===e.contextType)c.style.display="block",p.style.display="block";else{var A=e.start,D=e.end;"List"===e.contextType&&"Bullet"!==t.selection.getListLevel(A.paragraph).listLevelPattern&&(k.style.display="block",P.style.display="block",P.nextSibling.style.display="block");A.paragraph.isInsideTable&&(!D.paragraph.isInsideTable||A.paragraph.associatedCell!==D.paragraph.associatedCell||e.isCellSelected(A.paragraph.associatedCell,A,D))?w.classList.add("e-disabled"):w.classList.contains("e-disabled")&&w.classList.remove("e-disabled"),O instanceof o.b&&!_?(b.style.display="block",e.isImageField()||(C.style.display="block"),t.hyperlinkDialogModule&&(x.style.display="block"),I.style.display="block",I.nextSibling.style.display="block",N=!0,F.style.display="none"):t.hyperlinkDialogModule&&(w.style.display="block",u.previousSibling.style.display="block",N=!0),e.isFormField()&&this.documentHelper.owner.enableFormField&&(w.style.display="none",F.style.display="block"),O instanceof o.b&&_&&(w.style.display="none",c.style.display="block")}return this.documentHelper.owner.selection.start.paragraph.isInsideTable&&this.documentHelper.owner.selection.end.paragraph.isInsideTable&&(t.tablePropertiesDialogModule&&(f.style.display="block"),m.style.display="block",v.style.display="block",this.documentHelper.owner.editor.canMergeCells()&&(y.style.display="block"),T.style.display=this.documentHelper.selection.isTableSelected()?"block":"none"),this.documentHelper.owner.fontDialogModule&&(u.style.display="block"),this.documentHelper.owner.paragraphDialogModule?g.style.display="block":N||this.documentHelper.owner.fontDialogModule||L||(S.nextSibling.style.display="none"),"Image"===e.contextType&&(u.style.display="none",g.style.display="none",u.previousSibling.style.display="none",I.nextSibling.style.display="none"),this.documentHelper.selection.hasRevisions()&&(H.previousSibling.style.display=this.documentHelper.owner.enableHeaderAndFooter?"none":"block",this.documentHelper.isTrackedOnlyMode?(H.style.display="none",E.style.display="none"):(H.style.display="block",E.style.display="block")),(this.documentHelper.selection.isinFootnote||this.documentHelper.selection.isinEndnote)&&(W.style.display="block"),!0},e.prototype.destroy=function(){this.contextMenuInstance&&this.contextMenuInstance.destroy(),this.contextMenuInstance=void 0,this.contextMenu&&this.contextMenu.parentElement&&(this.contextMenu.parentElement.removeChild(this.contextMenu),this.contextMenu.innerHTML=""),this.contextMenu=void 0,this.menuItems=[],this.customMenuItems=[],this.ids=[]},e.prototype.componentDestroy=function(){this.contextMenuInstance&&this.contextMenuInstance.destroy(),this.contextMenuInstance=void 0,this.contextMenu&&this.contextMenu.parentElement&&(this.contextMenu.parentElement.removeChild(this.contextMenu),this.contextMenu.innerHTML=""),this.contextMenu=void 0,this.menuItems=[],this.menuItems=void 0,this.customMenuItems=[],this.customMenuItems=void 0,this.ids=[],this.ids=void 0,this.customItems=[],this.customItems=void 0,this.spellContextItems=[],this.spellContextItems=void 0,this.documentHelper=void 0},e}())},function(e,t,i){"use strict";i.d(t,"a",function(){return s});var n=i(18),r=(i.n(n),i(3)),o=(i.n(r),i(0)),s=(i.n(o),function(){function e(e){var t=this;this.onKeyUpOnTextBox=function(){t.enableOrDisableButton()},this.addBookmark=function(){t.documentHelper.owner.editorModule.insertBookmark(o.SanitizeHtmlHelper.sanitize(t.textBoxInput.value)),t.documentHelper.hideDialog()},this.selectHandler=function(e){t.focusTextBox(e.text)},this.gotoBookmark=function(){t.documentHelper.selection.selectBookmark(t.textBoxInput.value)},this.deleteBookmark=function(){t.documentHelper.owner.editorModule.deleteBookmark(t.textBoxInput.value),t.show()},this.documentHelper=e}return e.prototype.getModuleName=function(){return"BookmarkDialog"},e.prototype.initBookmarkDialog=function(e,t,s){var a=this.documentHelper.owner.containerId+"_insert_bookmark";this.target=i.i(o.createElement)("div",{id:a,className:"e-de-bookmark"});var l=e.getConstant("Bookmark name")+":",d=i.i(o.createElement)("div",{innerHTML:l,className:"e-bookmark-dlgfields"});this.target.appendChild(d);var h=i.i(o.createElement)("div",{className:"e-bookmark-common"});this.target.appendChild(h);var c=i.i(o.createElement)("div",{className:"e-bookmark-list"});h.appendChild(c),s&&c.classList.add("e-de-rtl");var p=i.i(o.createElement)("div",{className:"e-bookmark-textboxdiv"});c.appendChild(p),this.textBoxInput=i.i(o.createElement)("input",{className:"e-input e-bookmark-textbox-input",id:"bookmark_text_box",attrs:{autofocus:"true"}}),this.textBoxInput.setAttribute("type","text"),this.textBoxInput.setAttribute("aria-label",e.getConstant("Bookmark name")),p.appendChild(this.textBoxInput);var u=i.i(o.createElement)("div",{className:"e-bookmark-listViewDiv",id:"bookmark_listview",attrs:{tabindex:"-1",role:"listbox"}});u.setAttribute("aria-label",e.getConstant("BookMarkList")),c.appendChild(u),this.listviewInstance=new n.ListView({dataSource:t,cssClass:"e-bookmark-listview"});var g=void 0===t||0===t.length;this.listviewInstance.appendTo(u),this.listviewInstance.addEventListener("select",this.selectHandler);var f=i.i(o.createElement)("div",{className:"e-bookmark-button"});h.appendChild(f);var m=i.i(o.createElement)("div",{className:"e-bookmark-addbutton"});f.appendChild(m);var v=i.i(o.createElement)("button",{innerHTML:e.getConstant("Add"),id:"add",attrs:{type:"button"}});v.setAttribute("aria-label",e.getConstant("Add")),m.appendChild(v),this.addButton=new r.Button({cssClass:"e-button-custom"}),this.addButton.disabled=!0,this.addButton.appendTo(v),this.textBoxInput.addEventListener("input",this.onKeyUpOnTextBox),this.textBoxInput.addEventListener("keyup",this.onKeyUpOnTextBox),v.addEventListener("click",this.addBookmark);var y=i.i(o.createElement)("div",{className:"e-bookmark-deletebutton"});f.appendChild(y);var w=i.i(o.createElement)("button",{innerHTML:e.getConstant("Delete"),id:"delete",attrs:{type:"button"}});w.setAttribute("aria-label",e.getConstant("Delete")),y.appendChild(w),this.deleteButton=new r.Button({cssClass:"e-button-custom"}),this.deleteButton.disabled=g,this.deleteButton.appendTo(w),w.addEventListener("click",this.deleteBookmark);var b=i.i(o.createElement)("div",{className:"e-bookmark-gotobutton"});f.appendChild(b);var x=i.i(o.createElement)("button",{innerHTML:e.getConstant("Go To"),id:"goto",attrs:{type:"button"}});x.setAttribute("aria-label",e.getConstant("Go To")),b.appendChild(x),this.gotoButton=new r.Button({cssClass:"e-button-custom"}),this.gotoButton.disabled=g,this.gotoButton.appendTo(x),x.addEventListener("click",this.gotoBookmark)},e.prototype.show=function(){var e=this.documentHelper.getBookmarks(),t=new o.L10n("documenteditor",this.documentHelper.owner.defaultLocale);if(t.setLocale(this.documentHelper.owner.locale),this.initBookmarkDialog(t,e,this.documentHelper.owner.enableRtl),this.documentHelper.dialog.header=t.getConstant("Bookmark"),this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=this.documentHelper.updateFocus,this.documentHelper.dialog.close=this.documentHelper.updateFocus,this.documentHelper.dialog.buttons=[{click:this.removeObjects.bind(this),buttonModel:{content:t.getConstant("Cancel"),cssClass:"e-flat e-hyper-insert",isPrimary:!0}}],this.documentHelper.dialog.dataBind(),!(void 0===e||0===e.length)){var i=e[0];this.listviewInstance.selectItem(i)}this.documentHelper.dialog.show()},e.prototype.enableOrDisableButton=function(){i.i(o.isNullOrUndefined)(this.addButton)||(this.addButton.disabled=""===this.textBoxInput.value)},e.prototype.focusTextBox=function(e){this.textBoxInput.value=e;var t=document.getElementById("bookmark_text_box");t.setSelectionRange(0,e.length),t.focus(),this.enableOrDisableButton()},e.prototype.removeObjects=function(){this.documentHelper.hideDialog()},e.prototype.destroy=function(){this.textBoxInput&&(this.textBoxInput.remove(),this.textBoxInput=void 0),this.listviewInstance&&(this.listviewInstance.destroy(),this.listviewInstance=void 0),this.documentHelper=void 0},e}())},function(e,t,i){"use strict";i.d(t,"a",function(){return a});var n=i(0),r=(i.n(n),i(5)),o=(i.n(r),i(9)),s=i(10),a=(i.n(s),function(){function e(e){var t=this;this.cellFormat=new o.f,this.tableFormat=new o.b,this.isShadingChanged=!1,this.applyBordersShadingsProperties=function(){var e=t.documentHelper.owner.tablePropertiesDialogModule,r=t.documentHelper.selection.start.paragraph.associatedCell,s=void 0;(t.checkClassName(t.previewDivTopTop)||t.checkClassName(t.previewDivTopBottom)||t.checkClassName(t.previewDivTopCenter)||t.checkClassName(t.previewDivBottomcenter)||t.checkClassName(t.previewDivBottomLeft)||t.checkClassName(t.previewDivBottomRight)||t.checkClassName(t.previewDivDiagonalRight)||t.checkClassName(t.previewDivLeftDiagonal))&&(s=new o.d,t.checkClassName(t.previewDivTopTop)&&(s.top=t.getBorder("top")),t.checkClassName(t.previewDivTopBottom)&&(s.bottom=t.getBorder("bottom")),t.checkClassName(t.previewDivBottomLeft)&&(s.left=t.getBorder("left")),t.checkClassName(t.previewDivBottomRight)&&(s.right=t.getBorder("right")),t.checkClassName(t.previewDivTopCenter)&&(s.horizontal=t.getBorder("horizontal")),t.checkClassName(t.previewDivBottomcenter)&&(s.vertical=t.getBorder("vertical")),t.checkClassName(t.previewDivLeftDiagonal)&&(s.diagonalDown=t.getBorder("diagonalDown")),t.checkClassName(t.previewDivDiagonalRight)&&(s.diagonalUp=t.getBorder("diagonalUp")));var a=new o.o,l=t.documentHelper.owner.editorModule;if(a.backgroundColor=t.shadingColorPicker.value,"Cell"===t.ulelementShading.value)e&&(e.isCellBordersAndShadingUpdated=!0),t.cellFormat.borders=new o.d,i.i(n.isNullOrUndefined)(s)?t.noneDiv.classList.contains("e-de-table-border-inside-setting-click")&&l.applyBordersInternal(t.cellFormat.borders,new o.d):l.applyBordersInternal(t.cellFormat.borders,s),i.i(n.isNullOrUndefined)(r.cellFormat.shading)||(a.foregroundColor=r.cellFormat.shading.foregroundColor,a.textureStyle=r.cellFormat.shading.textureStyle),t.cellFormat.shading=new o.o,l.applyShading(t.cellFormat.shading,a);else if("Table"===t.ulelementShading.value){e&&(e.isTableBordersAndShadingUpdated=!0);var d=t.documentHelper.owner.selection.tableFormat.table.tableFormat;t.tableFormat.copyFormat(d),t.tableFormat.borders=new o.d,i.i(n.isNullOrUndefined)(s)?t.noneDiv.classList.contains("e-de-table-border-inside-setting-click")&&l.applyBordersInternal(t.tableFormat.borders,new o.d):l.applyBordersInternal(t.tableFormat.borders,s),i.i(n.isNullOrUndefined)(d.shading)||(a.foregroundColor=d.shading.foregroundColor,a.textureStyle=d.shading.textureStyle),t.tableFormat.shading=new o.o,t.isShadingChanged=d.shading.backgroundColor!==a.backgroundColor,l.applyShading(t.tableFormat.shading,a)}else if("Paragraph"===t.ulelementShading.value){var h=t.noneDiv.classList.contains("e-de-table-border-inside-setting-click");i.i(n.isNullOrUndefined)(t.paragraphFormat)?l.onApplyParagraphFormat("borders",h?new o.d:s,!1,!1):l.applyBordersInternal(t.paragraphFormat.borders,h?new o.d:s)}t.applyFormat(),t.closeDialog()},this.closeDialog=function(){t.documentHelper.dialog.hide(),t.closeBordersShadingsDialog()},this.closeBordersShadingsDialog=function(){t.paragraphFormat=void 0,t.documentHelper.dialog2.element.style.pointerEvents="",t.documentHelper.updateFocus()},this.handleSettingCheckBoxAction=function(e){var i=e.target.id,n=t.target.id;i===n+"_None_Div"||i===n+"_None_Div_Container"||i===n+"_None_Div_Transparent"?(t.updateClassForSettingDivElements(),t.noneDiv.classList.add("e-de-table-border-inside-setting-click"),t.setSettingPreviewDivElement("none")):i===n+"_Box_Div"||i===n+"_Box_Div_Container"||i===n+"_Box_Div_Transparent"?(t.updateClassForSettingDivElements(),t.boxDiv.classList.add("e-de-table-border-inside-setting-click"),t.setSettingPreviewDivElement("box")):i===n+"_All_Div"||i===n+"_All_Div_Container"||i===n+"_All_Div_Transparent"?(t.updateClassForSettingDivElements(),t.allDiv.classList.add("e-de-table-border-inside-setting-click"),t.setSettingPreviewDivElement("all")):(t.ulelementShading.value,t.updateClassForSettingDivElements(),t.customDiv.classList.add("e-de-table-border-inside-setting-click"),t.setSettingPreviewDivElement("customDiv"))},this.handlePreviewCheckBoxAction=function(e){var i=e.target,n=i.id,r=t.target.id,o="e-de-table-border-inside-preview-click";t.customDiv.click(),n===r+"_Preview_Div_TopTop_Container"||n===r+"_Preview_Div_TopTop"||n===r+"_previewDivTopTopTransParent"?(t.handlePreviewCheckBoxShowHide(r,o,t.previewDivTopTop),t.showHidePreviewDivElements(r,o,"_Preview_Div","_Preview_Div_TopTop","TopTop")):n===r+"_Preview_Div_TopCenter_Container"||n===r+"_Preview_Div_TopCenter"||n===r+"_previewDivTopCenterTransParent"?(t.handlePreviewCheckBoxShowHide(r,o,t.previewDivTopCenter),t.showHidePreviewDivElements(r,o,"_Preview_Div_Horizontal","_Preview_Div_TopCenter","TopCenter")):n===r+"_Preview_Div_TopBottom_Container"||n===r+"_Preview_Div_TopBottom"||n===r+"_previewDivTopBottomTransParent"?(t.handlePreviewCheckBoxShowHide(r,o,t.previewDivTopBottom),t.showHidePreviewDivElements(r,o,"_Preview_Div","_Preview_Div_TopBottom","TopBottom")):n===r+"_Preview_Div_LeftDiagonal_Container"||n===r+"_Preview_Div_LeftDiagonal"||n===r+"_previewDivLeftDiagonalTransParent"?(t.handlePreviewCheckBoxShowHide(r,o,t.previewDivLeftDiagonal),t.showHidePreviewDivElements(r,o,"_Preview_Div_Left_Diagonal","_Preview_Div_LeftDiagonal","LeftDiagonal")):n===r+"_Preview_Div_BottomLeft_Container"||n===r+"_Preview_Div_BottomLeft"||n===r+"_previewDivBottomLeftTransparent"?(t.handlePreviewCheckBoxShowHide(r,o,t.previewDivBottomLeft),t.showHidePreviewDivElements(r,o,"_Preview_Div","_Preview_Div_BottomLeft","BottomLeft")):n===r+"_Preview_Div_BottomCenter_Container"||n===r+"_Preview_Div_BottomCenter"||n===r+"_previewDivBottomcenterTransparent"?(t.handlePreviewCheckBoxShowHide(r,o,t.previewDivBottomcenter),t.showHidePreviewDivElements(r,o,"_Preview_Div_Vertical","_Preview_Div_BottomCenter","BottomCenter")):n===r+"_Preview_Div_BottomRight_Container"||n===r+"_Preview_Div_BottomRight"||n===r+"_previewDivBottomRightTransparent"?(t.handlePreviewCheckBoxShowHide(r,o,t.previewDivBottomRight),t.showHidePreviewDivElements(r,o,"_Preview_Div","_Preview_Div_BottomRight","BottomRight")):n!==r+"_Preview_Div_RightDiagonal_Container"&&n!==r+"_Preview_Div_RightDiagonal"&&n!==r+"_previewDivDiagonalRightTransparent"||(t.handlePreviewCheckBoxShowHide(r,o,t.previewDivDiagonalRight),t.showHidePreviewDivElements(r,o,"_Preview_Div_Right_Diagonal","_Preview_Div_RightDiagonal","RightDiagonal"))},this.applyTableCellPreviewBoxes=function(){i.i(n.isNullOrUndefined)(t.ulelementShading)||("Cell"===t.ulelementShading.value?(t.shadingColorPicker.disabled=!1,t.previewDivBottomcenterContainer.style.visibility="hidden",t.previewDivTopCenterContainer.style.visibility="hidden",t.previewVerticalDiv.style.display="none",t.previewHorizontalDiv.style.display="none",t.previewDivLeftDiagonal.style.display="",t.previewDivDiagonalRight.style.display="",t.previewDivBottomRightContainer.style.left="80px",i.i(n.classList)(t.noneDivTransparent,["e-de-table-border-none-setting"],["e-de-para-border-none-setting"]),i.i(n.classList)(t.boxDivTransparent,["e-de-table-border-box-setting"],["e-de-para-border-box-setting"]),i.i(n.classList)(t.allDivTransparent,["e-de-table-border-all-setting"],["e-de-para-border-shadow-setting"]),i.i(n.classList)(t.customDivTransparent,["e-de-table-border-custom-setting"],["e-de-para-border-custom-setting"])):"Table"===t.ulelementShading.value?(t.shadingColorPicker.disabled=!1,t.previewDivLeftDiagonal.style.display="none",t.previewDivDiagonalRight.style.display="none",t.previewDivBottomcenterContainer.style.visibility="visible",t.previewDivTopCenterContainer.style.visibility="visible",t.previewVerticalDiv.style.display="",t.previewHorizontalDiv.style.display="",t.previewDivBottomRightContainer.style.left="110px",i.i(n.classList)(t.noneDivTransparent,["e-de-table-border-none-setting"],["e-de-para-border-none-setting"]),i.i(n.classList)(t.boxDivTransparent,["e-de-table-border-box-setting"],["e-de-para-border-box-setting"]),i.i(n.classList)(t.allDivTransparent,["e-de-table-border-all-setting"],["e-de-para-border-shadow-setting"]),i.i(n.classList)(t.customDivTransparent,["e-de-table-border-custom-setting"],["e-de-para-border-custom-setting"])):(t.shadingColorPicker.disabled=!0,t.previewDivBottomcenterContainer.style.visibility="hidden",t.previewDivTopCenterContainer.style.visibility="hidden",t.previewVerticalDiv.style.display="none",t.previewHorizontalDiv.style.display="none",t.previewLeftDiagonalDiv.style.display="none",t.previewRightDiagonalDiv.style.display="none",i.i(n.classList)(t.noneDivTransparent,["e-de-para-border-none-setting"],["e-de-table-border-none-setting"]),i.i(n.classList)(t.boxDivTransparent,["e-de-para-border-box-setting"],["e-de-table-border-box-setting"]),i.i(n.classList)(t.allDivTransparent,["e-de-para-border-shadow-setting"],["e-de-table-border-all-setting"]),i.i(n.classList)(t.customDivTransparent,["e-de-para-border-custom-setting"],["e-de-table-border-custom-setting"])))},this.applyPreviewTableBackgroundColor=function(e){if(!i.i(n.isNullOrUndefined)(e.currentValue)){var r=e.currentValue.hex;t.previewDiv.style.backgroundColor=r}},this.applyPreviewTableBorderColor=function(e){if(!i.i(n.isNullOrUndefined)(e.currentValue)){var r=e.currentValue.hex;t.previewDiv.style.borderColor=r,t.previewRightDiagonalDiv.style.backgroundColor=r,t.previewLeftDiagonalDiv.style.backgroundColor=r,t.previewVerticalDiv.style.backgroundColor=r,t.previewHorizontalDiv.style.backgroundColor=r}},this.documentHelper=e}return e.prototype.getModuleName=function(){return"BordersAndShadingDialog"},e.prototype.initBordersAndShadingsDialog=function(e,t){this.target=i.i(n.createElement)("div",{id:this.documentHelper.owner.containerId+"_table_border_shadings",className:"e-de-table-border-shading-dlg"});var o=i.i(n.createElement)("div",{innerHTML:e.getConstant("Borders"),className:"e-de-table-border-heading"}),a=i.i(n.createElement)("div",{className:"e-de-dlg-row"}),l=i.i(n.createElement)("div",{}),d=i.i(n.createElement)("div",{}),h=i.i(n.createElement)("div",{className:"e-de-table-border-preview-container"}),c=i.i(n.createElement)("div",{className:"e-de-dlg-row"}),p=i.i(n.createElement)("div",{}),u=i.i(n.createElement)("div",{className:"e-de-container-row"}),g=i.i(n.createElement)("div",{className:"e-de-subcontainer-left"}),f=i.i(n.createElement)("input",{}),m=i.i(n.createElement)("div",{className:"e-de-container-row"}),v=i.i(n.createElement)("div",{className:"e-de-subcontainer-left"}),y=i.i(n.createElement)("input",{}),w=i.i(n.createElement)("div",{className:"e-de-subcontainer-right"}),b=i.i(n.createElement)("div",{innerHTML:e.getConstant("Color"),className:"e-de-table-border-clr-heading"}),x=i.i(n.createElement)("input",{attrs:{type:"color"},className:"e-dlg-clr-pkr-top"}),C=i.i(n.createElement)("div",{innerHTML:e.getConstant("Setting"),className:"e-de-table-setting-heading"}),I=i.i(n.createElement)("div",{className:"e-de-dlg-row"}),F=i.i(n.createElement)("div",{id:this.target.id+"_None_Div_Container"});this.noneDiv=i.i(n.createElement)("div",{id:this.target.id+"_None_Div",className:"e-de-table-border-inside-setting e-de-table-border-setting-genral"});var k=i.i(n.createElement)("label",{innerHTML:e.getConstant("None"),className:"e-de-table-setting-labels-heading",id:this.target.id+"_None_Div_Label"}),P=i.i(n.createElement)("div",{id:this.target.id+"_Box_Div_Container"});this.boxDiv=i.i(n.createElement)("div",{id:this.target.id+"_Box_Div",className:"e-de-table-border-inside-setting e-de-table-border-setting-genral"});var T=i.i(n.createElement)("label",{innerHTML:e.getConstant("Box"),className:"e-de-table-setting-labels-heading",id:this.target.id+"_Box_Div_Label"}),S=i.i(n.createElement)("div",{id:this.target.id+"_All_Div_Container"});this.allDiv=i.i(n.createElement)("div",{id:this.target.id+"_All_Div",className:"e-de-table-border-inside-setting e-de-table-border-setting-genral"});var W=i.i(n.createElement)("label",{innerHTML:e.getConstant("All"),className:"e-de-table-setting-labels-heading",id:this.target.id+"_All_Div_Label"}),N=i.i(n.createElement)("div",{id:this.target.id+"_Custom_Div_Container"});this.customDiv=i.i(n.createElement)("div",{id:this.target.id+"_Custom_Div",className:"e-de-table-border-inside-setting e-de-table-border-setting-genral"});var H=i.i(n.createElement)("label",{innerHTML:e.getConstant("Custom"),className:"e-de-table-setting-labels-heading",id:this.target.id+"_Custom_Div_Label"});this.noneDivTransparent=i.i(n.createElement)("div",{id:this.target.id+"_None_Div_Transparent",className:"e-icons e-de-table-border-setting e-de-table-border-none-setting"}),this.boxDivTransparent=i.i(n.createElement)("div",{id:this.target.id+"_Box_Div_Transparent",className:"e-icons e-de-table-border-setting e-de-table-border-box-setting"}),this.allDivTransparent=i.i(n.createElement)("div",{id:this.target.id+"_All_Div_Transparent",className:"e-icons e-de-table-border-setting e-de-table-border-all-setting"}),this.customDivTransparent=i.i(n.createElement)("div",{id:this.target.id+"_Custom_Div_Transparent",className:"e-icons e-de-table-border-setting e-de-table-border-custom-setting"}),t&&(this.noneDivTransparent.classList.add("e-de-rtl"),this.boxDivTransparent.classList.add("e-de-rtl"),this.allDivTransparent.classList.add("e-de-rtl"),this.customDivTransparent.classList.add("e-de-rtl"));var E=i.i(n.createElement)("div",{innerHTML:e.getConstant("Preview"),className:"e-de-table-setting-heading"});this.previewDiv=i.i(n.createElement)("div",{id:this.target.id+"_Preview_Div",className:"e-de-border-dlg-preview-div",styles:"position: relative"}),this.previewRightDiagonalDiv=i.i(n.createElement)("div",{styles:"position: absolute;width:1px;height:111px;left: 38px;top: -17px;transform: rotate(135deg); background-color: black",id:this.target.id+"_Preview_Div_Right_Diagonal",className:"e-de-border-dlg-preview-inside-divs"}),this.previewLeftDiagonalDiv=i.i(n.createElement)("div",{styles:"position: absolute;width: 1px;height: 111px;left: 38px;top: -17px;transform:rotate(45deg); background-color: black",id:this.target.id+"_Preview_Div_Left_Diagonal",className:"e-de-border-dlg-preview-inside-divs"}),this.previewVerticalDiv=i.i(n.createElement)("div",{styles:"width: 1px;height: 80px;position: absolute;left: 39px;top: -1px; background-color: black",id:this.target.id+"_Preview_Div_Vertical",className:"e-de-border-dlg-preview-inside-divs"}),this.previewHorizontalDiv=i.i(n.createElement)("div",{styles:"width: 80px;height: 1px;position: absolute;left: -1px;top: 41px; background-color: black",id:this.target.id+"_Preview_Div_Horizontal",className:"e-de-border-dlg-preview-inside-divs"});var O=i.i(n.createElement)("div");this.previewDivTopTopContainer=i.i(n.createElement)("div",{styles:"margin-top: 0",className:"e-de-table-border-icon-container",id:this.target.id+"_Preview_Div_TopTop_Container"}),this.previewDivTopTop=i.i(n.createElement)("div",{id:this.target.id+"_Preview_Div_TopTop",className:"e-de-table-border-inside-preview e-de-table-border-preview-genral"}),this.previewDivTopCenterContainer=i.i(n.createElement)("div",{className:"e-de-table-border-icon-container",id:this.target.id+"_Preview_Div_TopCenter_Container"}),this.previewDivTopCenter=i.i(n.createElement)("div",{id:this.target.id+"_Preview_Div_TopCenter",className:"e-de-table-border-inside-preview e-de-table-border-preview-genral"}),this.previewDivTopBottomContainer=i.i(n.createElement)("div",{className:"e-de-table-border-icon-container",id:this.target.id+"_Preview_Div_TopBottom_Container"}),this.previewDivTopBottom=i.i(n.createElement)("div",{id:this.target.id+"_Preview_Div_TopBottom",className:"e-de-table-border-inside-preview e-de-table-border-preview-genral"}),this.previewDivLeftDiagonalContainer=i.i(n.createElement)("div",{className:"e-de-table-border-icon-container",id:this.target.id+"_Preview_Div_LeftDiagonal_Container"}),this.previewDivLeftDiagonal=i.i(n.createElement)("div",{id:this.target.id+"_Preview_Div_LeftDiagonal",className:"e-de-table-border-inside-preview e-de-table-border-preview-genral"});var _=i.i(n.createElement)("div",{className:"e-de-dlg-row"});this.previewDivBottomLeftContainer=i.i(n.createElement)("div",{id:this.target.id+"_Preview_Div_BottomLeft_Container",className:"e-de-table-border-icon-container"}),this.previewDivBottomLeft=i.i(n.createElement)("div",{id:this.target.id+"_Preview_Div_BottomLeft",className:"e-de-table-border-inside-preview e-de-table-border-preview-genral"}),this.previewDivBottomcenterContainer=i.i(n.createElement)("div",{id:this.target.id+"_Preview_Div_BottomCenter_Container",className:"e-de-table-border-icon-container"}),this.previewDivBottomcenter=i.i(n.createElement)("div",{id:this.target.id+"_Preview_Div_BottomCenter",className:"e-de-table-border-inside-preview e-de-table-border-preview-genral"}),this.previewDivBottomRightContainer=i.i(n.createElement)("div",{id:this.target.id+"_Preview_Div_BottomRight_Container",className:"e-de-table-border-icon-container"}),this.previewDivBottomRight=i.i(n.createElement)("div",{id:this.target.id+"_Preview_Div_BottomRight",className:"e-de-table-border-inside-preview e-de-table-border-preview-genral"}),this.previewDivDiagonalRightContainer=i.i(n.createElement)("div",{className:"e-de-table-border-icon-container",id:this.target.id+"_Preview_Div_RightDiagonal_Container"}),this.previewDivDiagonalRight=i.i(n.createElement)("div",{id:this.target.id+"_Preview_Div_RightDiagonal",className:"e-de-table-border-inside-preview e-de-table-border-preview-genral"}),this.previewDivTopTopTransParent=i.i(n.createElement)("div",{id:this.target.id+"_previewDivTopTopTransParent",className:"e-icons e-de-table-border-preview e-de-table-border-toptop-alignment"}),this.previewDivTopCenterTransParent=i.i(n.createElement)("div",{id:this.target.id+"_previewDivTopCenterTransParent",className:"e-icons e-de-table-border-preview e-de-table-border-topcenter-alignment"}),this.previewDivTopBottomTransParent=i.i(n.createElement)("div",{id:this.target.id+"_previewDivTopBottomTransParent",className:"e-icons e-de-table-border-preview e-de-table-border-topbottom-alignment"}),this.previewDivLeftDiagonalTransParent=i.i(n.createElement)("div",{id:this.target.id+"_previewDivLeftDiagonalTransParent",className:"e-icons e-de-table-border-preview e-de-table-border-diagionalup-alignment"}),this.previewDivBottomLeftTransparent=i.i(n.createElement)("div",{id:this.target.id+"_previewDivBottomLeftTransparent",className:"e-icons e-de-table-border-preview e-de-table-border-bottomleft-alignment"}),this.previewDivBottomcenterTransparent=i.i(n.createElement)("div",{id:this.target.id+"_previewDivBottomcenterTransparent",className:"e-icons e-de-table-border-preview e-de-table-border-bottomcenter-alignment"}),this.previewDivBottomRightTransparent=i.i(n.createElement)("div",{id:this.target.id+"_previewDivBottomRightTransparent",className:"e-icons e-de-table-border-preview e-de-table-border-bottomright-alignment"}),this.previewDivDiagonalRightTransparent=i.i(n.createElement)("div",{id:this.target.id+"_previewDivDiagonalRightTransparent",className:"e-icons e-de-table-border-preview e-de-table-border-diagionaldown-alignment"}),this.shadingContiner=i.i(n.createElement)("div",{});var B=i.i(n.createElement)("div",{innerHTML:e.getConstant("Shading"),className:"e-de-table-border-heading"}),L=i.i(n.createElement)("div",{className:"e-de-dlg-row"}),R=i.i(n.createElement)("div",{className:"e-de-table-border-clr-left-container"}),A=i.i(n.createElement)("div",{innerHTML:e.getConstant("Fill"),className:"e-de-table-border-clr-heading"}),D=i.i(n.createElement)("input",{attrs:{type:"color"},id:this.target.id+"_shading_color"}),U=i.i(n.createElement)("div",{className:"e-de-subcontainer-right"}),M=i.i(n.createElement)("input",{id:this.target.id+"_shading"}),V=[{Value:"Cell",Name:e.getConstant("Cell ")},{Value:"Table",Name:e.getConstant("Table")},{Value:"Paragraph",Name:e.getConstant("Paragraph")}];U.appendChild(M),this.noneDiv.appendChild(this.noneDivTransparent),this.boxDiv.appendChild(this.boxDivTransparent),this.allDiv.appendChild(this.allDivTransparent),this.customDiv.appendChild(this.customDivTransparent),F.appendChild(this.noneDiv),F.appendChild(k),P.appendChild(this.boxDiv),P.appendChild(T),S.appendChild(this.allDiv),S.appendChild(W),N.appendChild(this.customDiv),N.appendChild(H),l.appendChild(C),l.appendChild(I),I.appendChild(F),I.appendChild(P),I.appendChild(S),I.appendChild(N),this.previewDivBottomcenter.appendChild(this.previewDivBottomcenterTransparent),this.previewDivBottomRight.appendChild(this.previewDivBottomRightTransparent),this.previewDivBottomLeft.appendChild(this.previewDivBottomLeftTransparent),this.previewDivTopTop.appendChild(this.previewDivTopTopTransParent),this.previewDivTopCenter.appendChild(this.previewDivTopCenterTransParent),this.previewDivTopBottom.appendChild(this.previewDivTopBottomTransParent),this.previewDivDiagonalRight.appendChild(this.previewDivDiagonalRightTransparent),this.previewDivLeftDiagonal.appendChild(this.previewDivLeftDiagonalTransParent),this.previewDivBottomcenterContainer.appendChild(this.previewDivBottomcenter),this.previewDivBottomLeftContainer.appendChild(this.previewDivBottomLeft),this.previewDivBottomRightContainer.appendChild(this.previewDivBottomRight),this.previewDivDiagonalRightContainer.appendChild(this.previewDivDiagonalRight),this.previewDivLeftDiagonalContainer.appendChild(this.previewDivLeftDiagonal),this.previewDivTopBottomContainer.appendChild(this.previewDivTopBottom),this.previewDivTopCenterContainer.appendChild(this.previewDivTopCenter),this.previewDivTopTopContainer.appendChild(this.previewDivTopTop),h.appendChild(E),h.appendChild(c),c.appendChild(O),c.appendChild(p),p.appendChild(this.previewDiv),p.appendChild(_),this.previewDiv.appendChild(this.previewLeftDiagonalDiv),this.previewDiv.appendChild(this.previewRightDiagonalDiv),this.previewDiv.appendChild(this.previewHorizontalDiv),this.previewDiv.appendChild(this.previewVerticalDiv),_.appendChild(this.previewDivBottomLeftContainer),_.appendChild(this.previewDivBottomcenterContainer),_.appendChild(this.previewDivBottomRightContainer),_.appendChild(this.previewDivDiagonalRightContainer),O.appendChild(this.previewDivTopTopContainer),O.appendChild(this.previewDivTopCenterContainer),O.appendChild(this.previewDivTopBottomContainer),O.appendChild(this.previewDivLeftDiagonalContainer),L.appendChild(R),R.appendChild(A),R.appendChild(D),L.appendChild(U),this.shadingContiner.appendChild(B),this.shadingContiner.appendChild(L),d.appendChild(u),u.appendChild(g),g.appendChild(f),d.appendChild(m),m.appendChild(v),v.appendChild(y),m.appendChild(w),w.appendChild(b),w.appendChild(x),x.setAttribute("aria-label",b.innerHTML),a.appendChild(l),a.appendChild(h),this.target.appendChild(o),this.target.appendChild(a),this.target.appendChild(d),this.target.appendChild(this.shadingContiner),F.addEventListener("click",this.handleSettingCheckBoxAction),P.addEventListener("click",this.handleSettingCheckBoxAction),S.addEventListener("click",this.handleSettingCheckBoxAction),N.addEventListener("click",this.handleSettingCheckBoxAction),this.previewDivBottomcenterContainer.addEventListener("click",this.handlePreviewCheckBoxAction),this.previewDivBottomLeftContainer.addEventListener("click",this.handlePreviewCheckBoxAction),this.previewDivBottomRightContainer.addEventListener("click",this.handlePreviewCheckBoxAction),this.previewDivTopTopContainer.addEventListener("click",this.handlePreviewCheckBoxAction),this.previewDivTopBottomContainer.addEventListener("click",this.handlePreviewCheckBoxAction),this.previewDivTopCenterContainer.addEventListener("click",this.handlePreviewCheckBoxAction),this.previewDivDiagonalRightContainer.addEventListener("click",this.handlePreviewCheckBoxAction),this.previewDivLeftDiagonalContainer.addEventListener("click",this.handlePreviewCheckBoxAction),this.borderWidth=new r.NumericTextBox({value:.5,min:.25,max:6,decimals:2,step:.25,floatLabelType:"Always",placeholder:e.getConstant("Width"),enablePersistence:!1}),this.borderWidth.appendTo(y);var z=[{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 5.5H98" stroke-linejoin="round"/></svg></div>',LineStyle:"Single"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 5.5H98" stroke-linejoin="round" stroke-dasharray="1 1"/></svg></div>',LineStyle:"Dot"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0_1347_1852)"><path d="M3.05176e-05 5.5H98" stroke-linejoin="round" stroke-dasharray="4 1"/></g><defs><clipPath id="clip0_1347_1852"><rect width="98" height="10" fill="white"/></clipPath></defs></svg></div>',LineStyle:"DashSmallGap"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 5.5H98" stroke-linejoin="round" stroke-dasharray="4 4"/></svg></div>',LineStyle:"DashLargeGap"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 5.5H98" stroke-linejoin="round" stroke-dasharray="7 3 3 3"/></svg></div>',LineStyle:"DashDot"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 4.5H98" stroke-linejoin="round" stroke-dasharray="6 2 2 2 2 2"/></svg></div>',LineStyle:"DashDotDot"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 3.5H98" stroke-linejoin="round"/><path d="M0 5.5H98" stroke-linejoin="round"/></svg></div>',LineStyle:"Double"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 5.5H98" stroke-linejoin="round"/><path d="M0 3.5H98" stroke-linejoin="round"/><path d="M0 7.5H98" stroke-linejoin="round"/></svg></div>',LineStyle:"Triple"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 4H98" stroke-width="4" stroke-linejoin="round"/><path d="M0 4H98" stroke-width="4" stroke-linejoin="round"/><path d="M0 7.5H98" stroke-linejoin="round"/></svg></div>',LineStyle:"ThinThickSmallGap"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 6H98" stroke-width="4" stroke-linejoin="round"/><path d="M0 2.5H98" stroke-linejoin="round"/></svg></div>',LineStyle:"ThickThinSmallGap"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 5H98" stroke-width="4" stroke-linejoin="round"/><path d="M0 1.5H98" stroke-linejoin="round"/><path d="M0 8.5H98" stroke-linejoin="round"/></svg></div>',LineStyle:"ThinThickThinSmallGap"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 3H98" stroke-width="4" stroke-linejoin="round"/><path d="M0 8H98" stroke-width="2" stroke-linejoin="round"/></svg></div>',LineStyle:"ThickThinMediumGap"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 7H98" stroke-width="4" stroke-linejoin="round"/><path d="M0 2H98" stroke-width="2" stroke-linejoin="round"/></svg></div>',LineStyle:"ThinThickMediumGap"},{Svg:'<div class="e-de-svg-border-fill-color"><svg style="width:98%;" height="23" viewBox="0 0 98 23" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M98 8H0V9H98V8ZM98 10H0V14H98V10ZM0 15H98V16H0V15Z" /></svg></div>',LineStyle:"ThinThickThinMediumGap"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 8.5H98" stroke-linejoin="round"/><path d="M0 3H98" stroke-width="2" stroke-linejoin="round"/></svg></div>',LineStyle:"ThinThickLargeGap"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 2.5H98" stroke-linejoin="round"/><path d="M0 8H98" stroke-width="2" stroke-linejoin="round"/></svg></div>',LineStyle:"ThickThinLargeGap"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0_1347_1892)"><g clip-path="url(#clip0_1407_5)"><path d="M0 0.5H98" stroke-linejoin="round"/><path d="M0 9.5H98" stroke-linejoin="round"/><path d="M0 5H98" stroke-width="2" stroke-linejoin="round"/></g><defs><clipPath id="clip0_1407_5"><rect width="98" height="10" fill="white"/></clipPath></defs></svg></div>',LineStyle:"ThinThickThinLargeGap"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M3 3H5V4H3V3ZM2 5V4H3V5H2ZM1 6V5H2V6H1ZM1 6V7H0V6H1ZM6 5H5V4H6V5ZM7 6H6V5H7V6ZM9 6V7H7V6H9ZM10 5V6H9V5H10ZM11 4V5H10V4H11ZM13 4H11V3H13V4ZM14 5H13V4H14V5ZM15 6H14V5H15V6ZM17 6V7H15V6H17ZM18 5V6H17V5H18ZM19 4V5H18V4H19ZM21 4H19V3H21V4ZM22 5H21V4H22V5ZM23 6H22V5H23V6ZM25 6V7H23V6H25ZM26 5V6H25V5H26ZM27 4V5H26V4H27ZM29 4H27V3H29V4ZM30 5H29V4H30V5ZM31 6H30V5H31V6ZM33 6V7H31V6H33ZM34 5V6H33V5H34ZM35 4V5H34V4H35ZM37 4H35V3H37V4ZM38 5H37V4H38V5ZM39 6H38V5H39V6ZM41 6V7H39V6H41ZM42 5V6H41V5H42ZM43 4V5H42V4H43ZM45 4H43V3H45V4ZM46 5H45V4H46V5ZM47 6H46V5H47V6ZM49 6V7H47V6H49ZM50 5V6H49V5H50ZM51 4V5H50V4H51ZM53 4H51V3H53V4ZM54 5H53V4H54V5ZM55 6H54V5H55V6ZM57 6V7H55V6H57ZM58 5V6H57V5H58ZM59 4V5H58V4H59ZM61 4H59V3H61V4ZM62 5H61V4H62V5ZM63 6H62V5H63V6ZM65 6V7H63V6H65ZM66 5V6H65V5H66ZM67 4V5H66V4H67ZM69 4H67V3H69V4ZM70 5H69V4H70V5ZM71 6H70V5H71V6ZM73 6V7H71V6H73ZM74 5V6H73V5H74ZM75 4V5H74V4H75ZM77 4H75V3H77V4ZM78 5H77V4H78V5ZM79 6H78V5H79V6ZM81 6V7H79V6H81ZM82 5V6H81V5H82ZM83 4V5H82V4H83ZM85 4H83V3H85V4ZM86 5H85V4H86V5ZM87 6H86V5H87V6ZM89 6V7H87V6H89ZM90 5V6H89V5H90ZM91 4V5H90V4H91ZM93 4H91V3H93V4ZM94 5H93V4H94V5ZM95 6V5H94V6H95ZM95 6V7H97V6H95Z" fill="black"/></svg></div>',LineStyle:"SingleWavy"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M3 2H5V3H3V2ZM2 4V3H3V4H2ZM2 4V5H1V4H2ZM6 4H5V3H6V4ZM9 4V5H6V4H9ZM10 3V4H9V3H10ZM12 3H10V2H12V3ZM13 4H12V3H13V4ZM16 4V5H13V4H16ZM17 3V4H16V3H17ZM19 3H17V2H19V3ZM20 4H19V3H20V4ZM23 4V5H20V4H23ZM24 3V4H23V3H24ZM26 3H24V2H26V3ZM27 4H26V3H27V4ZM30 4V5H27V4H30ZM31 3V4H30V3H31ZM33 3H31V2H33V3ZM34 4H33V3H34V4ZM37 4V5H34V4H37ZM38 3V4H37V3H38ZM40 3H38V2H40V3ZM41 4H40V3H41V4ZM44 4V5H41V4H44ZM45 3V4H44V3H45ZM47 3H45V2H47V3ZM48 4H47V3H48V4ZM51 4V5H48V4H51ZM52 3V4H51V3H52ZM54 3H52V2H54V3ZM55 4H54V3H55V4ZM58 4V5H55V4H58ZM59 3V4H58V3H59ZM61 3H59V2H61V3ZM62 4H61V3H62V4ZM65 4V5H62V4H65ZM66 3V4H65V3H66ZM68 3H66V2H68V3ZM69 4H68V3H69V4ZM72 4V5H69V4H72ZM73 3V4H72V3H73ZM75 3H73V2H75V3ZM76 4H75V3H76V4ZM79 4V5H76V4H79ZM80 3V4H79V3H80ZM82 3H80V2H82V3ZM83 4H82V3H83V4ZM86 4V5H83V4H86ZM87 3V4H86V3H87ZM89 3H87V2H89V3ZM90 4H89V3H90V4ZM93 4V5H90V4H93ZM94 3V4H93V3H94ZM96 3H94V2H96V3ZM96 3H97V4H96V3ZM2 7H1V8H2V7ZM3 6H2V7H3V6ZM5 6H3V5H5V6ZM6 7H5V6H6V7ZM9 7V8H6V7H9ZM10 6V7H9V6H10ZM12 6H10V5H12V6ZM13 7H12V6H13V7ZM16 7H13V8H16V7ZM17 6H16V7H17V6ZM19 6V5H17V6H19ZM20 7V6H19V7H20ZM23 7H20V8H23V7ZM24 6H23V7H24V6ZM26 6V5H24V6H26ZM27 7V6H26V7H27ZM30 7V8H27V7H30ZM31 6V7H30V6H31ZM33 6H31V5H33V6ZM34 7H33V6H34V7ZM37 7V8H34V7H37ZM38 6V7H37V6H38ZM40 6H38V5H40V6ZM41 7H40V6H41V7ZM44 7H41V8H44V7ZM45 6H44V7H45V6ZM47 6V5H45V6H47ZM48 7V6H47V7H48ZM51 7H48V8H51V7ZM52 6H51V7H52V6ZM54 6V5H52V6H54ZM55 7V6H54V7H55ZM58 7V8H55V7H58ZM59 6V7H58V6H59ZM61 6H59V5H61V6ZM62 7H61V6H62V7ZM65 7V8H62V7H65ZM66 6V7H65V6H66ZM68 6H66V5H68V6ZM69 7H68V6H69V7ZM72 7H69V8H72V7ZM73 6H72V7H73V6ZM75 6V5H73V6H75ZM76 7V6H75V7H76ZM79 7H76V8H79V7ZM80 6H79V7H80V6ZM82 6V5H80V6H82ZM83 7V6H82V7H83ZM86 7V8H83V7H86ZM87 6V7H86V6H87ZM89 6H87V5H89V6ZM90 7H89V6H90V7ZM93 7V8H90V7H93ZM94 6V7H93V6H94ZM96 6H94V5H96V6ZM96 6V7H97V6H96Z" fill="black"/></svg></div>',LineStyle:"DoubleWavy"},{Svg:'<div class="e-de-svg-border-fill-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M0 3H4V4H3V5H2V6H1V7H0V3ZM3 6V5H4V6H3ZM5 5V6H4V7H9V6H10V7H11V6H12V7H17V6H18V7H19V6H20V7H25V6H26V7H27V6H28V7H33V6H34V7H35V6H36V7H41V6H42V7H43V6H44V7H49V6H50V7H51V6H52V7H57V6H58V7H59V6H60V7H65V6H66V7H67V6H68V7H73V6H74V7H75V6H76V7H81V6H82V7H83V6H84V7H89V6H90V7H91V6H92V7H97V6H98V5V3H95V4H94V3H93V4H92V3H87V4H86V3H85V4H84V3H79V4H78V3H77V4H76V3H71V4H70V3H69V4H68V3H63V4H62V3H61V4H60V3H55V4H54V3H53V4H52V3H47V4H46V3H45V4H44V3H39V4H38V3H37V4H36V3H31V4H30V3H29V4H28V3H23V4H22V3H21V4H20V3H15V4H14V3H13V4H12V3H7V4H6V3H5V4H4V5H5ZM5 5H6V4H5V5ZM12 5V4H11V5H10V6H11V5H12ZM13 5V6H12V5H13ZM13 5V4H14V5H13ZM20 5V4H19V5H18V6H19V5H20ZM21 5H22V4H21V5ZM21 5H20V6H21V5ZM28 5V4H27V5H26V6H27V5H28ZM29 5V6H28V5H29ZM29 5H30V4H29V5ZM36 5V4H35V5H34V6H35V5H36ZM37 5V4H38V5H37ZM37 5H36V6H37V5ZM44 5V4H43V5H42V6H43V5H44ZM45 5V6H44V5H45ZM45 5V4H46V5H45ZM52 5V4H51V5H50V6H51V5H52ZM53 5H54V4H53V5ZM53 5H52V6H53V5ZM60 5V4H59V5H58V6H59V5H60ZM61 5V6H60V5H61ZM61 5H62V4H61V5ZM68 5V4H67V5H66V6H67V5H68ZM69 5V4H70V5H69ZM69 5H68V6H69V5ZM76 5V4H75V5H74V6H75V5H76ZM77 5V6H76V5H77ZM77 5V4H78V5H77ZM84 5V4H83V5H82V6H83V5H84ZM85 5H86V4H85V5ZM85 5H84V6H85V5ZM92 5V4H91V5H90V6H91V5H92ZM93 5V6H92V5H93ZM93 5H94V4H93V5ZM3 6H2V7H3V6Z" /></svg></div>',LineStyle:"DashDotStroked"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 8H98" stroke-width="2" stroke-linejoin="round"/><path d="M0 5H98" stroke="#808080" stroke-width="4" stroke-linejoin="round"/><path d="M0 2H98" stroke="#C0C0C0" stroke-width="2" stroke-linejoin="round"/></svg></div>',LineStyle:"Emboss3D"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 2H98" stroke-width="2" stroke-linejoin="round"/><path d="M0 5H98" stroke="#808080" stroke-width="4" stroke-linejoin="round"/><path d="M0 8H98" stroke="#C0C0C0" stroke-width="2" stroke-linejoin="round"/></svg></div>',LineStyle:"Engrave3D"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 1.5H98" stroke="#A0A0A0" stroke-linejoin="round"/><path d="M0 8.5H98" stroke-linejoin="round"/></svg></div>',LineStyle:"Outset"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 1.5H98" stroke-linejoin="round"/><path d="M0 8.5H98" stroke="#A0A0A0" stroke-linejoin="round"/></svg></div>',LineStyle:"Inset"}];y.setAttribute("aria-labelledby",e.getConstant("width"));var j=i.i(n.initializeCSPTemplate)(function(e){return"<div>"+e.Svg+"</div>"});this.borderStyle=new s.DropDownList({popupHeight:"150px",dataSource:z,floatLabelType:"Always",fields:{text:"Svg",value:"LineStyle"},itemTemplate:j,valueTemplate:j,placeholder:e.getConstant("Style"),enableRtl:t}),this.borderStyle.appendTo(f),f.setAttribute("aria-lablledby",e.getConstant("Style")),this.ulelementShading=new s.DropDownList({dataSource:V,fields:{text:"Name",value:"Value"},change:this.applyTableCellPreviewBoxes,index:1,floatLabelType:"Always",placeholder:e.getConstant("Apply To"),enableRtl:t,htmlAttributes:{"aria-labelledby":e.getConstant("Apply To")}}),this.ulelementShading.appendTo(M),this.borderColorPicker=new r.ColorPicker({value:"#000000",change:this.applyPreviewTableBorderColor,enableRtl:t,locale:this.documentHelper.owner.locale,cssClass:"e-de-dlg-clr-picker",enableOpacity:!1}),this.borderColorPicker.appendTo(x),this.shadingColorPicker=new r.ColorPicker({value:"#FFFFFF",change:this.applyPreviewTableBackgroundColor,enableRtl:t,locale:this.documentHelper.owner.locale,cssClass:"e-de-dlg-clr-picker",enableOpacity:!1}),this.shadingColorPicker.appendTo(D),t&&A.classList.add("e-de-rtl")},e.prototype.applyFormat=function(){var e=this.documentHelper.owner.editorModule;"Paragraph"!==this.ulelementShading.value&&(e.initComplexHistory("BordersAndShading"),e.isBordersAndShadingDialog=!0,"Cell"===this.ulelementShading.value?e.onCellFormat(this.cellFormat):"Table"===this.ulelementShading.value&&e.onTableFormat(this.tableFormat,!0),i.i(n.isNullOrUndefined)(this.documentHelper.owner.editorHistory.currentHistoryInfo)||this.documentHelper.owner.editorHistory.updateComplexHistory()),"Cell"===this.ulelementShading.value?e.isCellFormatApplied=!0:e.isCellFormatApplied=!1,e.isBordersAndShadingDialog=!1},e.prototype.getBorder=function(e){var t=new o.g;return t.color=this.borderColorPicker.value,t.lineStyle=this.borderStyle.value,t.lineWidth=this.borderWidth.value,t.space="left"===e||"right"===e?4:1,t},e.prototype.checkClassName=function(e){return e.classList.contains("e-de-table-border-inside-preview-click")},e.prototype.show=function(){var e=new n.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),this.target||this.initBordersAndShadingsDialog(e,this.documentHelper.owner.enableRtl),this.loadBordersShadingsPropertiesDialog(e),this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.header=e.getConstant("Borders and Shading"),this.documentHelper.dialog.beforeOpen=this.documentHelper.updateFocus,this.documentHelper.dialog.close=this.closeBordersShadingsDialog,this.documentHelper.dialog.position={X:"center",Y:"center"},this.documentHelper.dialog.width="auto",this.documentHelper.dialog.height="auto",this.documentHelper.dialog.buttons=[{click:this.applyBordersShadingsProperties,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-table-border-shading-okay",isPrimary:!0}},{click:this.closeDialog,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-table-border-shading-cancel"}}],this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show()},e.prototype.updateClassForSettingDivElements=function(){for(var e=this.target.getElementsByClassName("e-de-table-border-inside-setting"),t=0;t<e.length;t++)if(-1!==e[parseInt(t.toString(),10)].className.indexOf("e-de-table-border-inside-setting-click")){var i=e[parseInt(t.toString(),10)].className;i=i.replace("e-de-table-border-inside-setting-click",""),e[parseInt(t.toString(),10)].className=i}},e.prototype.setSettingPreviewDivElement=function(e){switch(e){case"none":this.previewDivTopTop.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivTopCenter.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivTopBottom.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivLeftDiagonal.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivDiagonalRight.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivBottomRight.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivBottomLeft.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivBottomcenter.classList.remove("e-de-table-border-inside-preview-click"),this.isShowHidePreviewTableElements("none");break;case"box":this.previewDivTopCenter.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivLeftDiagonal.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivDiagonalRight.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivBottomcenter.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivTopTop.classList.add("e-de-table-border-inside-preview-click"),this.previewDivTopBottom.classList.add("e-de-table-border-inside-preview-click"),this.previewDivBottomRight.classList.add("e-de-table-border-inside-preview-click"),this.previewDivBottomLeft.classList.add("e-de-table-border-inside-preview-click"),this.isShowHidePreviewTableElements("box");break;case"all":"Cell"===this.ulelementShading.value||"Table"===this.ulelementShading.value?(this.previewDivLeftDiagonal.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivDiagonalRight.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivBottomcenter.classList.add("e-de-table-border-inside-preview-click"),this.previewDivTopTop.classList.add("e-de-table-border-inside-preview-click"),this.previewDivTopBottom.classList.add("e-de-table-border-inside-preview-click"),this.previewDivBottomRight.classList.add("e-de-table-border-inside-preview-click"),this.previewDivBottomLeft.classList.add("e-de-table-border-inside-preview-click"),this.previewDivTopCenter.classList.add("e-de-table-border-inside-preview-click"),this.isShowHidePreviewTableElements("all")):(this.previewDivLeftDiagonal.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivDiagonalRight.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivBottomcenter.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivTopTop.classList.add("e-de-table-border-inside-preview-click"),this.previewDivTopBottom.classList.add("e-de-table-border-inside-preview-click"),this.previewDivBottomRight.classList.add("e-de-table-border-inside-preview-click"),this.previewDivBottomLeft.classList.add("e-de-table-border-inside-preview-click"),this.previewDivTopCenter.classList.remove("e-de-table-border-inside-preview-click"),this.isShowHidePreviewTableElements("all"))}},e.prototype.isShowHidePreviewTableElements=function(e){switch(e){case"none":this.previewDiv.style.border="none",this.previewRightDiagonalDiv.style.display="none",this.previewLeftDiagonalDiv.style.display="none",this.previewHorizontalDiv.style.display="none",this.previewVerticalDiv.style.display="none";break;case"box":this.previewDiv.style.border="1px solid rgba(0, 0, 0, .54)",this.previewRightDiagonalDiv.style.display="none",this.previewLeftDiagonalDiv.style.display="none",this.previewHorizontalDiv.style.display="none",this.previewVerticalDiv.style.display="none";break;case"all":"Cell"===this.ulelementShading.value||"Table"===this.ulelementShading.value?(this.previewDiv.style.border="1px solid rgba(0, 0, 0, .54)",this.previewRightDiagonalDiv.style.display="none",this.previewLeftDiagonalDiv.style.display="none",this.previewHorizontalDiv.style.display="block",this.previewVerticalDiv.style.display="block"):(this.previewDiv.style.border="1px solid rgba(0, 0, 0, .54)",this.previewRightDiagonalDiv.style.display="none",this.previewLeftDiagonalDiv.style.display="none",this.previewHorizontalDiv.style.display="none",this.previewVerticalDiv.style.display="none")}},e.prototype.handlePreviewCheckBoxShowHide=function(e,t,i){i.classList.contains(t)?i.classList.remove(t):i.classList.add(t)},e.prototype.showHidePreviewDivElements=function(e,t,i,n,r){var o=document.getElementById(e+i),s=document.getElementById(e+n);"TopTop"===r?this.setPropertyPreviewDivElement(o,s,t,"border-top"):"TopCenter"===r?this.setPropertyPreviewDivElement(o,s,t,"display"):"TopBottom"===r?this.setPropertyPreviewDivElement(o,s,t,"border-bottom"):"LeftDiagonal"===r?this.setPropertyPreviewDivElement(o,s,t,"display"):"BottomLeft"===r?this.setPropertyPreviewDivElement(o,s,t,"border-left"):"BottomCenter"===r?this.setPropertyPreviewDivElement(o,s,t,"display"):"BottomRight"===r?this.setPropertyPreviewDivElement(o,s,t,"border-right"):"RightDiagonal"===r&&this.setPropertyPreviewDivElement(o,s,t,"display")},e.prototype.setPropertyPreviewDivElement=function(e,t,i,n){t.classList.contains(i)&&"border"===n.split("-")[0]?e.style[""+n]="1px solid rgba(0, 0, 0, .54)":t.classList.contains(i)&&"display"===n?e.style[""+n]="block":e.style[""+n]="none"},e.prototype.loadBordersShadingsPropertiesDialog=function(e){var t,r,o,s;if(i.i(n.isNullOrUndefined)(this.documentHelper.selection.tableFormat.table)){this.shadingContiner.style.display="none",this.ulelementShading.dataSource=[{Value:"Paragraph",Name:e.getConstant("Paragraph")}],this.ulelementShading.dataBind();var a=this.documentHelper.selection.start.paragraph.paragraphFormat;this.ulelementShading.value="Paragraph",this.cloneBorders(a.borders);var l=this.getSelectionBorderFormat();l.hasValues()?(t=this.getLineStyle(l.lineStyle),r=l.color,s=l.lineWidth):(t=0,r="#000000",s=.5),this.shadingColorPicker.disabled=!0}else{this.shadingContiner.style.display="block",this.ulelementShading.dataSource=[{Value:"Cell",Name:e.getConstant("Cell")},{Value:"Table",Name:e.getConstant("Table")},{Value:"Paragraph",Name:e.getConstant("Paragraph")}],this.ulelementShading.dataBind();var d=this.documentHelper.selection.tableFormat.table.tableFormat;i.i(n.isNullOrUndefined)(d)||i.i(n.isNullOrUndefined)(d.borders)||(this.cloneBorders(d.borders),i.i(n.isNullOrUndefined)(d.borders)||i.i(n.isNullOrUndefined)(d.borders.top)?(t=0,r="#000000",s=0,o="#000000"):(t=this.getLineStyle(d.borders.top.lineStyle),r=d.borders.top.color,s=d.borders.top.getLineWidth(),o=d.shading.backgroundColor),this.ulelementShading.value="Table",this.shadingColorPicker.value=o,this.shadingColorPicker.disabled=!1)}this.borderColorPicker.value=r,this.previewDivLeftDiagonal.style.display="none",this.previewDivDiagonalRight.style.display="none",this.borderWidth.value=s,this.borderStyle.index=t},e.prototype.getSelectionBorderFormat=function(){var e=new o.g,t=this.documentHelper.selection.paragraphFormat.borders;return"None"!==t.top.lineStyle?this.copyToBorder(e,t.top):"None"!==t.left.lineStyle?this.copyToBorder(e,t.left):"None"!==t.bottom.lineStyle?this.copyToBorder(e,t.bottom):"None"!==t.right.lineStyle?this.copyToBorder(e,t.right):e},e.prototype.copyToBorder=function(e,t){return i.i(n.isNullOrUndefined)(t.lineStyle)||(e.lineStyle=t.lineStyle),i.i(n.isNullOrUndefined)(t.color)||(e.color=t.color),i.i(n.isNullOrUndefined)(t.lineWidth)||(e.lineWidth=t.lineWidth),e},e.prototype.cloneBorders=function(e){var t=!1,i=!1,n=!1,r=!1,o=!1,s=!1,a=!1,l=!1,d=!1;null!==e&&(e.top&&(e.top.hasNoneStyle||"None"!==e.top.lineStyle)&&(t=!0),e.bottom&&(e.bottom.hasNoneStyle||"None"!==e.bottom.lineStyle)&&(i=!0),e.left&&(e.left.hasNoneStyle||"None"!==e.left.lineStyle)&&(n=!0),e.right&&(e.right.hasNoneStyle||"None"!==e.right.lineStyle)&&(r=!0),e.horizontal&&(e.horizontal.hasNoneStyle||"None"!==e.horizontal.lineStyle)&&(o=!0),e.vertical&&(e.vertical.hasNoneStyle||"None"!==e.vertical.lineStyle)&&(s=!0),e.diagonalDown&&(e.diagonalDown.hasNoneStyle||"None"!==e.diagonalDown.lineStyle)&&(a=!0),e.diagonalUp&&(e.diagonalUp.hasNoneStyle||"None"!==e.diagonalUp.lineStyle)&&(d=!0),t&&i&&n&&r?t&&i&&n&&r&&o&&s&&!d&&!a?t&&i&&n&&r&&o&&s&&!d&&!a&&(e.top.hasNoneStyle&&e.bottom.hasNoneStyle&&e.left.hasNoneStyle&&e.right.hasNoneStyle&&e.horizontal.hasNoneStyle&&e.vertical.hasNoneStyle?(this.setSettingPreviewDivElement("none"),this.customDiv.classList.remove("e-de-table-border-inside-setting-click"),this.noneDiv.classList.add("e-de-table-border-inside-setting-click"),this.boxDiv.classList.remove("e-de-table-border-inside-setting-click"),this.allDiv.classList.remove("e-de-table-border-inside-setting-click")):(this.setSettingPreviewDivElement("all"),this.allDiv.classList.add("e-de-table-border-inside-setting-click"),this.customDiv.classList.remove("e-de-table-border-inside-setting-click"),this.noneDiv.classList.remove("e-de-table-border-inside-setting-click"),this.boxDiv.classList.remove("e-de-table-border-inside-setting-click"))):n&&i&&t&&r&&!o&&!s?e.top.hasNoneStyle&&e.bottom.hasNoneStyle&&e.left.hasNoneStyle&&e.right.hasNoneStyle&&e.horizontal.hasNoneStyle&&e.vertical.hasNoneStyle?(this.setSettingPreviewDivElement("none"),this.boxDiv.classList.remove("e-de-table-border-inside-setting-click"),this.allDiv.classList.remove("e-de-table-border-inside-setting-click"),this.customDiv.classList.remove("e-de-table-border-inside-setting-click"),this.noneDiv.classList.add("e-de-table-border-inside-setting-click")):(this.setSettingPreviewDivElement("box"),this.customDiv.classList.remove("e-de-table-border-inside-setting-click"),this.noneDiv.classList.remove("e-de-table-border-inside-setting-click"),this.boxDiv.classList.add("e-de-table-border-inside-setting-click"),this.allDiv.classList.remove("e-de-table-border-inside-setting-click")):l=!0:l=!0,this.previewDivLeftDiagonal.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivDiagonalRight.classList.remove("e-de-table-border-inside-preview-click"),t||i||n||r||o||s?l&&(this.customDiv.classList.add("e-de-table-border-inside-setting-click"),this.noneDiv.classList.remove("e-de-table-border-inside-setting-click"),this.boxDiv.classList.remove("e-de-table-border-inside-setting-click"),this.allDiv.classList.remove("e-de-table-border-inside-setting-click"),"Cell"===this.ulelementShading.value||"Table"===this.ulelementShading.value?t?this.previewDivTopTop.classList.add("e-de-table-border-inside-preview-click"):this.previewDivTopTop.classList.remove("e-de-table-border-inside-preview-click"):t?(this.previewDivTopTop.classList.add("e-de-table-border-inside-preview-click"),this.previewDiv.style.borderTop="1px solid rgba(0,0,0,.54)"):(this.previewDivTopTop.classList.remove("e-de-table-border-inside-preview-click"),this.previewDiv.style.borderTop="0px"),"Cell"==this.ulelementShading.value||"Table"===this.ulelementShading.value?i?this.previewDivTopBottom.classList.add("e-de-table-border-inside-preview-click"):this.previewDivTopBottom.classList.remove("e-de-table-border-inside-preview-click"):i?(this.previewDivTopBottom.classList.add("e-de-table-border-inside-preview-click"),this.previewDiv.style.borderBottom="1px solid rgba(0,0,0,.54)"):(this.previewDivTopBottom.classList.remove("e-de-table-border-inside-preview-click"),this.previewDiv.style.borderBottom="0px"),"Cell"==this.ulelementShading.value||"Table"===this.ulelementShading.value?n?this.previewDivBottomLeft.classList.add("e-de-table-border-inside-preview-click"):this.previewDivBottomLeft.classList.remove("e-de-table-border-inside-preview-click"):n?(this.previewDivBottomLeft.classList.add("e-de-table-border-inside-preview-click"),this.previewDiv.style.borderLeft="1px solid rgba(0,0,0,.54)"):(this.previewDivBottomLeft.classList.remove("e-de-table-border-inside-preview-click"),this.previewDiv.style.borderLeft="0px"),"Cell"==this.ulelementShading.value||"Table"===this.ulelementShading.value?r?this.previewDivBottomRight.classList.add("e-de-table-border-inside-preview-click"):this.previewDivBottomRight.classList.remove("e-de-table-border-inside-preview-click"):r?(this.previewDivBottomRight.classList.add("e-de-table-border-inside-preview-click"),this.previewDiv.style.borderRight="1px solid rgba(0,0,0,.54)"):(this.previewDivBottomRight.classList.remove("e-de-table-border-inside-preview-click"),this.previewDiv.style.borderRight="0px"),s?this.previewDivBottomcenter.classList.add("e-de-table-border-inside-preview-click"):this.previewDivBottomcenter.classList.remove("e-de-table-border-inside-preview-click"),o?this.previewDivTopCenter.classList.add("e-de-table-border-inside-preview-click"):this.previewDivTopCenter.classList.remove("e-de-table-border-inside-preview-click")):"Cell"===this.ulelementShading.value||"Table"===this.ulelementShading.value?(this.customDiv.classList.remove("e-de-table-border-inside-setting-click"),this.noneDiv.classList.add("e-de-table-border-inside-setting-click"),this.boxDiv.classList.remove("e-de-table-border-inside-setting-click"),this.allDiv.classList.remove("e-de-table-border-inside-setting-click")):(this.setSettingPreviewDivElement("none"),this.customDiv.classList.remove("e-de-table-border-inside-setting-click"),this.noneDiv.classList.add("e-de-table-border-inside-setting-click"),this.boxDiv.classList.remove("e-de-table-border-inside-setting-click"),this.allDiv.classList.remove("e-de-table-border-inside-setting-click")))},e.prototype.getLineStyle=function(e){switch(e){case"Single":return 0;case"Dot":return 1;case"DashSmallGap":return 2;case"DashLargeGap":return 3;case"DashDot":return 4;case"DashDotDot":return 5;case"Double":return 6;case"Triple":return 7;case"ThinThickSmallGap":return 8;case"ThickThinSmallGap":return 9;case"ThinThickThinSmallGap":return 10;case"ThinThickMediumGap":return 11;case"ThickThinMediumGap":return 12;case"ThinThickThinMediumGap":return 13;case"ThinThickLargeGap":return 14;case"ThickThinLargeGap":return 15;case"ThinThickThinLargeGap":return 16;case"SingleWavy":return 17;case"DoubleWavy":return 18;case"DashDotStroked":return 29;case"Emboss3D":return 20;case"Engrave3D":return 21;case"Outset":return 22;case"Inset":return 23}return 0},e.prototype.destroy=function(){if(!i.i(n.isNullOrUndefined)(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[e]),e--;this.target=void 0}this.cellFormat&&(this.cellFormat.destroy(),this.cellFormat=void 0),this.tableFormat&&(this.tableFormat.destroy(),this.tableFormat=void 0),this.paragraphFormat&&(this.paragraphFormat.destroy(),this.paragraphFormat=void 0),this.dialog=void 0,this.target=void 0,i.i(n.isNullOrUndefined)(this.borderStyle)||this.borderStyle.destroy(),this.borderStyle=void 0,i.i(n.isNullOrUndefined)(this.borderColorPicker)||this.borderColorPicker.destroy(),this.borderColorPicker=void 0,i.i(n.isNullOrUndefined)(this.shadingColorPicker)||this.shadingColorPicker.destroy(),this.shadingColorPicker=void 0,i.i(n.isNullOrUndefined)(this.ulelementShading)||this.ulelementShading.destroy(),this.ulelementShading=void 0,this.noneDivTransparent=void 0,this.boxDivTransparent=void 0,this.allDivTransparent=void 0,this.customDivTransparent=void 0,this.previewDiv=void 0,this.previewRightDiagonalDiv=void 0,this.previewLeftDiagonalDiv=void 0,this.previewVerticalDiv=void 0,this.previewHorizontalDiv=void 0,this.previewDivTopTopContainer=void 0,this.previewDivTopTop=void 0,this.previewDivTopCenterContainer=void 0,this.previewDivTopCenter=void 0,this.previewDivTopBottomContainer=void 0,this.previewDivTopBottom=void 0,this.previewDivLeftDiagonalContainer=void 0,this.previewDivLeftDiagonal=void 0,this.previewDivBottomLeftContainer=void 0,this.previewDivBottomLeft=void 0,this.previewDivBottomcenterContainer=void 0,this.previewDivBottomcenter=void 0,this.previewDivBottomRightContainer=void 0,this.previewDivBottomRight=void 0,this.previewDivDiagonalRightContainer=void 0,this.previewDivDiagonalRight=void 0,this.previewDivTopTopTransParent=void 0,this.previewDivTopCenterTransParent=void 0,this.previewDivTopBottomTransParent=void 0,this.previewDivLeftDiagonalTransParent=void 0,this.previewDivBottomLeftTransparent=void 0,this.previewDivBottomcenterTransparent=void 0,this.previewDivBottomRightTransparent=void 0,this.previewDivDiagonalRightTransparent=void 0,this.shadingContiner=void 0,this.noneDiv=void 0,this.customDiv=void 0,this.allDiv=void 0,this.boxDiv=void 0,this.documentHelper=void 0},e}())},function(e,t,i){"use strict";i.d(t,"a",function(){return d});var n=i(0),r=(i.n(n),i(15)),o=(i.n(r),i(24)),s=i(14),a=i(23),l=i(30),d=function(){function e(e){var t=this;this.isBullet=!1,this.numberListClick=function(e){t.isBullet=!1,t.setActiveElement(e),e.currentTarget.classList.contains("e-de-list-numbered-none")?(t.numberFormat=void 0,t.listLevelPattern=void 0):e.currentTarget.classList.contains("e-de-list-numbered-number-dot")?(t.numberFormat="%1.",t.listLevelPattern="Arabic"):e.currentTarget.classList.contains("e-de-list-numbered-number-brace")?(t.numberFormat="%1)",t.listLevelPattern="Arabic"):e.currentTarget.classList.contains("e-de-list-numbered-up-roman")?(t.numberFormat="%1.",t.listLevelPattern="UpRoman"):e.currentTarget.classList.contains("e-de-list-numbered-up-letter")?(t.numberFormat="%1.",t.listLevelPattern="UpLetter"):e.currentTarget.classList.contains("e-de-list-numbered-low-letter-brace")?(t.numberFormat="%1)",t.listLevelPattern="LowLetter"):e.currentTarget.classList.contains("e-de-numbered-low-letter-dot")?(t.numberFormat="%1.",t.listLevelPattern="LowLetter"):e.currentTarget.classList.contains("e-de-list-numbered-low-roman")&&(t.numberFormat="%1.",t.listLevelPattern="LowRoman")},this.bulletListClick=function(e){t.isBullet=!0,t.setActiveElement(e),e.currentTarget.classList.contains("e-bullet-none")?(t.symbol=void 0,t.fontFamily=void 0):e.currentTarget.classList.contains("e-bullet-dot")?(t.symbol=String.fromCharCode(61623),t.fontFamily="Symbol"):e.currentTarget.classList.contains("e-bullet-circle")?(t.symbol=String.fromCharCode(61551)+String.fromCharCode(32),t.fontFamily="Symbol"):e.currentTarget.classList.contains("e-bullet-square")?(t.symbol=String.fromCharCode(61607),t.fontFamily="Wingdings"):e.currentTarget.classList.contains("e-bullet-flower")?(t.symbol=String.fromCharCode(61558),t.fontFamily="Wingdings"):e.currentTarget.classList.contains("e-bullet-arrow")?(t.symbol=String.fromCharCode(61656),t.fontFamily="Wingdings"):e.currentTarget.classList.contains("e-bullet-tick")&&(t.symbol=String.fromCharCode(61692),t.fontFamily="Wingdings")},this.loadNumberingBulletDialog=function(){t.documentHelper.updateFocus()},this.closeNumberingBulletDialog=function(){t.unWireEventsAndBindings(),t.documentHelper.updateFocus()},this.onCancelButtonClick=function(){t.isBullet=!1,t.listLevelPattern=void 0,t.numberFormat=void 0,t.symbol=void 0,t.fontFamily=void 0,t.documentHelper.dialog.hide(),t.unWireEventsAndBindings()},this.onOkButtonClick=function(){t.documentHelper.owner.documentHelper.lists.length>0?(t.listFormat.list.listId=t.documentHelper.owner.documentHelper.lists[t.documentHelper.owner.documentHelper.lists.length-1].listId+1,t.listFormat.listId=t.listFormat.list.listId):(t.listFormat.list.listId=0,t.listFormat.listId=0),t.documentHelper.owner.documentHelper.abstractLists.length>0?t.abstractList.abstractListId=t.documentHelper.owner.documentHelper.abstractLists[t.documentHelper.owner.documentHelper.abstractLists.length-1].abstractListId+1:t.abstractList.abstractListId=0,t.listFormat.list.abstractListId=t.abstractList.abstractListId;var e=new a.a(t.abstractList);e.listLevelPattern=i.i(n.isNullOrUndefined)(t.listLevelPattern)?"Bullet":t.listLevelPattern,e.numberFormat=t.isBullet?t.symbol:t.numberFormat,"Bullet"!==e.listLevelPattern&&(e.startAt=1),e.characterFormat.fontFamily=i.i(n.isNullOrUndefined)(t.fontFamily)?"Verdana":t.fontFamily,e.paragraphFormat.leftIndent=36,e.paragraphFormat.firstLineIndent=-18,t.abstractList.levels.push(e),t.listFormat.listLevelNumber=0,t.listFormat.list.abstractList=t.abstractList,t.documentHelper.hideDialog()},this.documentHelper=e}return e.prototype.getModuleName=function(){return"BulletsAndNumberingDialog"},e.prototype.initNumberingBulletDialog=function(e){var t=this.documentHelper.owner.containerId;this.target=i.i(n.createElement)("div",{id:t+"_insertNumberBulletDialog",className:"e-de-number-bullet-dlg"});var o=i.i(n.createElement)("div",{id:t+"_tabNumberBulletDialog",className:"e-de-tab-number-bullet-dlg"});this.target.appendChild(o),this.createNumberList(t,e),this.createBulletList(t,e),this.tabObj=new r.Tab({items:[{header:{text:i.i(n.createElement)("div",{innerHTML:e.getConstant("Numbering")})},content:this.numberListDiv},{header:{text:i.i(n.createElement)("div",{innerHTML:e.getConstant("Bullets")})},content:this.bulletListDiv}],heightAdjustMode:"None",width:"auto",selecting:this.onTabSelect.bind(this)}),this.tabObj.isStringTemplate=!0,this.tabObj.appendTo(o)},e.prototype.onTabSelect=function(e){e.preventFocus=!0,1===e.selectingIndex&&(this.bulletListDiv.style.display="block")},e.prototype.createNumberList=function(e,t){this.numberListDiv=i.i(n.createElement)("div",{className:"e-de-style-numbered-list",id:e+"_Number"});var r=this.numberListDiv,o=i.i(n.createElement)("ul",{styles:"display: block; outline: 0px;",id:"listMenu",className:"e-de-ui-wfloating-menu e-de-ui-bullets-menu e-de-list-container e-de-list-thumbnail"});r.appendChild(o);var s=this.createNumberNoneListTag(o,t),a=this.createNumberListTag(o,"1.","2.","3.","e-de-list-numbered-number-dot"),l=this.createNumberListTag(o,"1)","2)","3)","e-de-list-numbered-number-brace"),d=this.createNumberListTag(o,"I.","II.","III.","e-de-list-numbered-up-roman"),h=this.createNumberListTag(o,"A.","B.","C.","e-de-list-numbered-up-letter"),c=this.createNumberListTag(o,"a.","b.","c.","e-de-numbered-low-letter-dot"),p=this.createNumberListTag(o,"a)","b)","c)","e-de-list-numbered-low-letter-brace"),u=this.createNumberListTag(o,"i.","ii.","iii.","e-de-list-numbered-low-roman");s.addEventListener("click",this.numberListClick),a.addEventListener("click",this.numberListClick),l.addEventListener("click",this.numberListClick),d.addEventListener("click",this.numberListClick),h.addEventListener("click",this.numberListClick),p.addEventListener("click",this.numberListClick),c.addEventListener("click",this.numberListClick),u.addEventListener("click",this.numberListClick),this.target.appendChild(r)},e.prototype.createNumberListTag=function(e,t,r,o,s){var a=i.i(n.createElement)("li",{styles:"display:block",className:"e-de-ui-wfloating-menuitem e-de-ui-wfloating-menuitem-md e-de-list-items  e-de-list-item-size "+s});e.appendChild(a);var l="<div>"+t+'<span class="e-de-ui-list-line"></span></div><div>'+r+'<span class="e-de-ui-list-line">';l+="</span></div><div>"+o+'<span class="e-de-ui-list-line"> </span></div >';var d=i.i(n.createElement)("div",{className:"e-de-ui-list-header-presetmenu",id:"e-de-ui-zlist0",innerHTML:l});return a.style.cssFloat="left",a.appendChild(d),a},e.prototype.createNumberNoneListTag=function(e,t){var r=i.i(n.createElement)("li",{styles:"display:block",className:"e-de-ui-wfloating-menuitem e-de-ui-wfloating-menuitem-md e-de-list-items  e-de-list-item-size e-de-list-numbered-none"});e.appendChild(r);var o='<div class="e-de-ui-bullets e-de-bullet-icons">'+t.getConstant("None")+"</div>",s=i.i(n.createElement)("div",{className:"e-de-ui-list-header-presetmenu",id:"e-de-ui-zlist0",innerHTML:o});return r.style.cssFloat="left",r.appendChild(s),r},e.prototype.createBulletListTag=function(e,t,r,o){var s=i.i(n.createElement)("li",{styles:"display:block;",className:"e-de-ui-wfloating-menuitem e-de-ui-wfloating-bullet-menuitem-md e-de-list-items  e-de-list-item-size "+r});e.appendChild(s);var a="e-bullet-none"===r,l=i.i(n.createElement)("div",{className:"e-de-ui-bullet-list-header-presetmenu e-de-bullet-icon-size",styles:a?"font-size:9px;text-align: center;top: 13px;left:-2px;line-height:normal;position: relative":""}),d=i.i(n.createElement)("div",{className:a?"":t,innerHTML:a?o.getConstant("None"):""});return l.appendChild(d),s.appendChild(l),s},e.prototype.createBulletList=function(e,t){this.bulletListDiv=i.i(n.createElement)("div",{className:"e-de-ui-bullet-list-header-presetmenu",id:e+"_Bullet"});var r=this.bulletListDiv;r.style.display="none";var o=i.i(n.createElement)("ul",{styles:"display: block; outline: 0px;",id:"listMenu",className:"e-de-ui-wfloating-menu e-de-ui-bullets-menu e-de-list-container e-de-list-thumbnail"});r.appendChild(o);var s=this.createBulletListTag(o,"e-de-icon-bullet-list-none e-de-bullet-icons","e-bullet-none",t),a=this.createBulletListTag(o,"e-de-icon-bullet-list-dot e-de-bullet-icons","e-bullet-dot"),l=this.createBulletListTag(o,"e-de-icon-bullet-list-circle e-de-bullet-icons","e-bullet-circle"),d=this.createBulletListTag(o,"e-de-icon-bullet-list-square e-de-bullet-icons","e-bullet-square"),h=this.createBulletListTag(o,"e-de-icon-bullet-list-flower e-de-bullet-icons","e-bullet-flower"),c=this.createBulletListTag(o,"e-de-icon-bullet-list-arrow e-de-bullet-icons","e-bullet-arrow"),p=this.createBulletListTag(o,"e-de-icon-bullet-list-tick e-de-bullet-icons","e-bullet-tick");s.addEventListener("click",this.bulletListClick),a.addEventListener("click",this.bulletListClick),l.addEventListener("click",this.bulletListClick),d.addEventListener("click",this.bulletListClick),h.addEventListener("click",this.bulletListClick),c.addEventListener("click",this.bulletListClick),p.addEventListener("click",this.bulletListClick),this.target.appendChild(r)},e.prototype.showNumberBulletDialog=function(e,t){i.i(n.isNullOrUndefined)(e)?this.listFormat=new l.a:this.listFormat=e,i.i(n.isNullOrUndefined)(this.listFormat.list)&&(this.listFormat.list=new o.a),i.i(n.isNullOrUndefined)(t)?this.abstractList=new s.a:this.abstractList=t;var r=new n.L10n("documenteditor",this.documentHelper.owner.defaultLocale);r.setLocale(this.documentHelper.owner.locale),this.target||this.initNumberingBulletDialog(r),this.documentHelper.dialog.header=r.getConstant("Numbering and Bullets"),this.documentHelper.dialog.width="auto",this.documentHelper.dialog.height="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=this.loadNumberingBulletDialog,this.documentHelper.dialog.close=this.closeNumberingBulletDialog,this.documentHelper.dialog.position={X:"center",Y:"center"},this.documentHelper.dialog.buttons=[{click:this.onOkButtonClick,buttonModel:{content:r.getConstant("Ok"),cssClass:"e-flat e-numbering-bullet-okay",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:r.getConstant("Cancel"),cssClass:"e-flat e-numbering-bullet-cancel"}}],this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show(),this.tabObj.refresh()},e.prototype.setActiveElement=function(e){for(var t=e.currentTarget.parentElement,i=0;i<t.childElementCount;i++)t.childNodes[i].classList.contains("e-de-list-active")&&t.childNodes[i].classList.remove("e-de-list-active");e.currentTarget.classList.add("e-de-list-active")},e.prototype.unWireEventsAndBindings=function(){},e.prototype.destroy=function(){if(this.documentHelper=void 0,this.listFormat&&(this.listFormat.destroy(),this.listFormat=void 0),this.tabObj&&(this.tabObj.destroy(),this.tabObj=void 0),this.abstractList&&(this.abstractList.destroy(),this.abstractList=void 0),this.target&&this.target.parentElement){this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[parseInt(e.toString(),10)]),e--;this.target=void 0}this.bulletListDiv=void 0,this.numberListDiv=void 0},e}()},function(e,t,i){"use strict";i.d(t,"a",function(){return a});var n=i(3),r=(i.n(n),i(5)),o=(i.n(r),i(7)),s=i(0),a=(i.n(s),function(){function e(e){var t=this;this.removeEvents=function(){t.documentHelper.dialog2.element.style.pointerEvents="",t.documentHelper.updateFocus()},this.changeSameAsTable=function(){t.sameAsTableCheckBox.checked?(t.leftMarginBox.enabled=!1,t.rightMarginBox.enabled=!1,t.bottomMarginBox.enabled=!1,t.topMarginBox.enabled=!1):(t.leftMarginBox.enabled=!0,t.rightMarginBox.enabled=!0,t.bottomMarginBox.enabled=!0,t.topMarginBox.enabled=!0)},this.applyTableCellProperties=function(){var e=t.documentHelper.selection.cellFormat;i.i(s.isNullOrUndefined)(t.bottomMarginBox.value||t.leftMarginBox.value||t.rightMarginBox.value||t.topMarginBox.value)||e.bottomMargin===t.bottomMarginBox.value&&e.leftMargin===t.leftMarginBox.value&&e.rightMargin===t.rightMarginBox.value&&e.topMargin===t.topMarginBox.value||(t.documentHelper.owner.tablePropertiesDialogModule.isCellOptionsUpdated=!0,t.applyTableOptions(t.cellFormat),t.documentHelper.owner.tablePropertiesDialogModule.applyTableSubProperties()),t.closeCellMarginsDialog()},this.closeCellMarginsDialog=function(){t.documentHelper.dialog.hide(),t.documentHelper.dialog.element.style.pointerEvents=""},this.documentHelper=e}return Object.defineProperty(e.prototype,"cellFormat",{get:function(){return i.i(s.isNullOrUndefined)(this.cellFormatIn)?this.cellFormatIn=new o.H:this.cellFormatIn},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"CellOptionsDialog"},e.prototype.initCellMarginsDialog=function(t,r){this.owner=this.documentHelper.owner.viewer,this.target=i.i(s.createElement)("div",{className:"e-de-table-cell-margin-dlg"});var o=i.i(s.createElement)("div"),a=i.i(s.createElement)("Label",{className:"e-de-para-dlg-heading"});a.innerHTML=t.getConstant("Cell margins"),o.appendChild(a);var l=i.i(s.createElement)("TABLE",{styles:"padding-bottom: 8px;padding-top: 8px;",className:"e-de-cell-margin-top"}),d=i.i(s.createElement)("tr"),h=i.i(s.createElement)("td",{className:"e-de-tbl-btn-separator"}),c=i.i(s.createElement)("input",{attrs:{type:"checkbox"},id:this.target.id+"_sameAsCheckBox"});c.setAttribute("aria-label",t.getConstant("Same as the whole table")),h.appendChild(c),d.appendChild(h),l.appendChild(d),o.appendChild(l),e.getCellMarginDialogElements(this,o,t,!0);var p=document.createElement("div");this.target.appendChild(p),this.sameAsTableCheckBox=new n.CheckBox({label:t.getConstant("Same as the whole table"),change:this.changeSameAsTable,enableRtl:r}),c.setAttribute("aria-label",t.getConstant("Same as the whole table")),this.sameAsTableCheckBox.appendTo(c),this.sameAsTableCheckBox.addEventListener("change",this.changeSameAsTable)},e.prototype.show=function(){var e=new s.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),this.target||this.initCellMarginsDialog(e,this.documentHelper.owner.enableRtl),this.loadCellMarginsDialog(),this.documentHelper.dialog.header=e.getConstant("Cell Options"),this.documentHelper.dialog.position={X:"center",Y:"center"},this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=void 0,this.documentHelper.dialog.open=void 0,this.documentHelper.dialog.close=this.removeEvents,this.documentHelper.dialog.buttons=[{click:this.applyTableCellProperties,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-table-cell-margin-okay",isPrimary:!0}},{click:this.closeCellMarginsDialog,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-table-cell-margin-cancel"}}],this.documentHelper.dialog.show()},e.prototype.loadCellMarginsDialog=function(){var e=this.documentHelper.selection.cellFormat;if(this.sameAsTable=i.i(s.isNullOrUndefined)(e.leftMargin||e.topMargin||e.rightMargin||e.bottomMargin),this.sameAsTable){var t=this.documentHelper.selection.tableFormat;this.loadCellProperties(t,!1,!0)}else this.loadCellProperties(e,!0,!1)},e.prototype.loadCellProperties=function(e,t,i){this.leftMarginBox.value=e.leftMargin,this.rightMarginBox.value=e.rightMargin,this.topMarginBox.value=e.topMargin,this.bottomMarginBox.value=e.bottomMargin,this.leftMarginBox.enabled=t,this.rightMarginBox.enabled=t,this.topMarginBox.enabled=t,this.bottomMarginBox.enabled=t,this.sameAsTableCheckBox.checked=i},e.prototype.applySubCellOptions=function(e){this.documentHelper.owner.editorHistory.initComplexHistory(this.documentHelper.selection,"CellMarginsSelection"),this.documentHelper.owner.editorModule.initHistory("CellOptions"),i.i(s.isNullOrUndefined)(this.documentHelper.owner.editorHistory.currentBaseHistoryInfo)||(this.documentHelper.owner.editorHistory.currentBaseHistoryInfo.insertedFormat=e),this.documentHelper.selection.start.paragraph.associatedCell.ownerTable.combineWidget(this.owner),this.applyCellMarginValue(this.documentHelper.selection.start.paragraph.associatedCell.ownerRow.combineWidget(this.owner),this.documentHelper.selection.start,this.documentHelper.selection.end,e),this.documentHelper.owner.editorModule.reLayout(this.documentHelper.selection,!1),i.i(s.isNullOrUndefined)(this.documentHelper.owner.editorHistory.currentHistoryInfo)||this.documentHelper.owner.editorHistory.updateComplexHistory()},e.prototype.applyCellMarginValue=function(e,t,n,r){if(this.applyCellMarginsInternal(e,r),n.paragraph.associatedCell.ownerRow!==e){var o=e.nextWidget;i.i(s.isNullOrUndefined)(o)||this.applyCellMarginValue(o,t,n,r)}},e.prototype.applyCellMarginsInternal=function(e,t){if(!i.i(s.isNullOrUndefined)(this.documentHelper.owner.editorHistory.currentBaseHistoryInfo)){var n=e.childWidgets[0].cellFormat;t=this.documentHelper.owner.editorHistory.currentBaseHistoryInfo.addModifiedCellOptions(n,t,e.ownerTable)}i.i(s.isNullOrUndefined)(t)||this.applyCellMarginsForCells(e,t)},e.prototype.applyCellMarginsForCells=function(e,t){var i=e.childWidgets;this.iterateCells(i,t)},e.prototype.iterateCells=function(e,t){for(var i=0;i<e.length;i++)this.applySubCellMargins(e[parseInt(i.toString(),10)].cellFormat,t);this.documentHelper.owner.tablePropertiesDialogModule.calculateGridValue(e[0].ownerTable)},e.prototype.applySubCellMargins=function(e,t){e.leftMargin=t.leftMargin,e.topMargin=t.topMargin,e.rightMargin=t.rightMargin,e.bottomMargin=t.bottomMargin},e.prototype.applyTableOptions=function(e){this.sameAsTableCheckBox.checked||(e.leftMargin=this.leftMarginBox.value,e.topMargin=this.topMarginBox.value,e.bottomMargin=this.bottomMarginBox.value,e.rightMargin=this.rightMarginBox.value)},e.prototype.destroy=function(){if(!i.i(s.isNullOrUndefined)(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[parseInt(e.toString(),10)]),e--;this.target=void 0}this.dialog=void 0,this.target=void 0,this.documentHelper=void 0,this.sameAsTableCheckBox=void 0},e.getCellMarginDialogElements=function(e,t,n,o){if(!i.i(s.isNullOrUndefined)(e)){var a=i.i(s.createElement)("div"),l=i.i(s.createElement)("div",{className:"e-de-container-row"}),d=i.i(s.createElement)("div",{className:"e-de-subcontainer-left"}),h=i.i(s.createElement)("input",{attrs:{type:"text"},styles:"width:100%"});d.appendChild(h);var c=i.i(s.createElement)("div",{className:"e-de-subcontainer-right"}),p=i.i(s.createElement)("input",{attrs:{type:"text"},styles:"width:100%"});c.appendChild(p),l.appendChild(d),l.appendChild(c);var u=i.i(s.createElement)("div",{className:o?"e-de-dlg-row":"e-de-container-row"}),g=i.i(s.createElement)("div",{className:"e-de-subcontainer-left"}),f=i.i(s.createElement)("input",{attrs:{type:"text"},styles:"width:100%"});g.appendChild(f);var m=i.i(s.createElement)("div",{className:"e-de-subcontainer-right"}),v=i.i(s.createElement)("input",{attrs:{type:"text"},styles:"width:100%"});m.appendChild(v),u.appendChild(g),u.appendChild(m),a.appendChild(l),a.appendChild(u),t.appendChild(a),e.target.appendChild(t),e.topMarginBox=new r.NumericTextBox({value:0,min:0,max:1584,decimals:2,enablePersistence:!1,placeholder:n.getConstant("Top"),floatLabelType:"Always"}),e.topMarginBox.appendTo(h),e.leftMarginBox=new r.NumericTextBox({value:0,min:0,max:1584,decimals:2,enablePersistence:!1,placeholder:n.getConstant("Left"),floatLabelType:"Always"}),e.leftMarginBox.appendTo(p),e.bottomMarginBox=new r.NumericTextBox({value:0,min:0,max:1584,decimals:2,enablePersistence:!1,placeholder:n.getConstant("Bottom"),floatLabelType:"Always"}),e.bottomMarginBox.appendTo(f),e.rightMarginBox=new r.NumericTextBox({value:0,min:0,max:1584,decimals:2,enablePersistence:!1,placeholder:n.getConstant("Right"),floatLabelType:"Always"}),e.rightMarginBox.appendTo(v),v.setAttribute("aria-labelledby",n.getConstant("Right")),p.setAttribute("aria-labelledby",n.getConstant("Left")),f.setAttribute("aria-labelledby",n.getConstant("Bottom")),h.setAttribute("aria-labelledby",n.getConstant("Top"))}},e}())},function(e,t,i){"use strict";i.d(t,"a",function(){return l});var n=i(0),r=(i.n(n),i(10)),o=(i.n(r),i(3)),s=(i.n(o),i(21)),a=i(5),l=(i.n(a),function(){function e(e){var t=this;this.fontStyleInternal=void 0,this.fontNameList=void 0,this.fontStyleText=void 0,this.fontSizeText=void 0,this.colorPicker=void 0,this.underlineDrop=void 0,this.strikethroughBox=void 0,this.doublestrikethrough=void 0,this.superscript=void 0,this.subscript=void 0,this.allcaps=void 0,this.bold=void 0,this.italic=void 0,this.underline=void 0,this.strikethrough=void 0,this.baselineAlignment=void 0,this.fontSize=void 0,this.fontFamily=void 0,this.fontColor=void 0,this.allCaps=void 0,this.isListDialog=!1,this.characterFormat=void 0,this.loadFontDialog=function(){t.documentHelper.updateFocus();var e;if(e=t.characterFormat?t.characterFormat:t.documentHelper.owner.selection.characterFormat,t.fontNameList.value=e.fontFamily,t.fontNameList.dataBind(),e.bold||e.italic?e.bold&&!e.italic?(t.fontStyleText.value=t.fontSizeText.value,t.fontStyleText.index=1):!e.bold&&e.italic?(t.fontStyleText.value=t.fontSizeText.value,t.fontStyleText.index=2):e.bold&&e.italic&&(t.fontStyleText.value=t.fontSizeText.value,t.fontStyleText.index=3):(t.fontStyleText.value=t.fontSizeText.value,t.fontStyleText.index=0),i.i(n.isNullOrUndefined)(e.fontSize)||(t.fontSizeText.value=e.fontSize),i.i(n.isNullOrUndefined)(e.fontColor))t.colorPicker.value="#000000";else{var r=e.fontColor;"empty"!==r&&"#00000000"!==r||(r="#000000"),t.colorPicker.value=r}"None"===e.underline?t.underlineDrop.index=0:"Single"===e.underline&&(t.underlineDrop.index=1),"SingleStrike"===e.strikethrough?t.strikethroughBox.checked=!0:"DoubleStrike"===e.strikethrough?t.doublestrikethrough.checked=!0:(t.strikethroughBox.checked=!1,t.doublestrikethrough.checked=!1),"Superscript"===e.baselineAlignment?t.superscript.checked=!0:"Subscript"===e.baselineAlignment?t.subscript.checked=!0:(t.superscript.checked=!1,t.subscript.checked=!1),"none"!==t.documentHelper.selection.caret.style.display&&(t.documentHelper.selection.caret.style.display="none"),e.allCaps?t.allcaps.checked=!0:(t.allcaps.checked=!1,t.allCaps=!1)},this.closeFontDialog=function(){t.unWireEventsAndBindings(),t.documentHelper.updateFocus()},this.onCancelButtonClick=function(){t.documentHelper.dialog.hide(),t.unWireEventsAndBindings(),t.documentHelper.updateFocus()},this.onInsertFontFormat=function(){var e;if(e=t.characterFormat?t.characterFormat:new s.a(void 0),i.i(n.isNullOrUndefined)(t.bold)||(e.bold=t.bold),i.i(n.isNullOrUndefined)(t.italic)||(e.italic=t.italic),!i.i(n.isNullOrUndefined)(t.fontSize)&&t.fontSize>0&&(e.fontSize=t.fontSize),i.i(n.isNullOrUndefined)(t.fontColor)||(e.fontColor=t.fontColor),i.i(n.isNullOrUndefined)(t.baselineAlignment)||(e.baselineAlignment=t.baselineAlignment),i.i(n.isNullOrUndefined)(t.strikethrough)||(e.strikethrough=t.strikethrough),i.i(n.isNullOrUndefined)(t.underline)||(e.underline=t.underline),!i.i(n.isNullOrUndefined)(t.fontFamily)){var r=n.SanitizeHtmlHelper.sanitize(t.fontFamily);e.fontFamily=r,e.fontFamilyAscii=r,e.fontFamilyFarEast=r,e.fontFamilyNonFarEast=r,e.fontFamilyBidi=r}i.i(n.isNullOrUndefined)(t.allCaps)||(e.allCaps=t.allCaps),t.characterFormat?t.isListDialog?t.documentHelper.owner.listDialogModule.updateCharacterFormat(e):t.documentHelper.owner.styleDialogModule.updateCharacterFormat():t.onCharacterFormat(t.documentHelper.selection,e),t.documentHelper.hideDialog()},this.fontSizeUpdate=function(e){t.fontSize=e.value},this.fontStyleUpdate=function(e){t.fontStyle=e.value},this.fontFamilyUpdate=function(e){t.fontFamily=e.value},this.underlineUpdate=function(e){t.underline=e.value},this.fontColorUpdate=function(e){i.i(n.isNullOrUndefined)(e.currentValue)||(t.fontColor=e.currentValue.hex)},this.singleStrikeUpdate=function(e){t.enableCheckBoxProperty(e),e.checked?t.strikethrough="SingleStrike":t.strikethrough="None"},this.doubleStrikeUpdate=function(e){t.enableCheckBoxProperty(e),e.checked?t.strikethrough="DoubleStrike":t.strikethrough="None"},this.superscriptUpdate=function(e){t.enableCheckBoxProperty(e),e.checked?t.baselineAlignment="Superscript":t.baselineAlignment="Normal"},this.subscriptUpdate=function(e){t.enableCheckBoxProperty(e),e.checked?t.baselineAlignment="Subscript":t.baselineAlignment="Normal"},this.allcapsUpdate=function(e){t.enableCheckBoxProperty(e),e.checked?t.allCaps=!0:t.allCaps=!1},this.documentHelper=e}return Object.defineProperty(e.prototype,"fontStyle",{get:function(){return this.fontStyleInternal},set:function(e){switch(this.fontStyleInternal=e,this.fontStyle){case"Bold":this.bold=!0,this.italic=!1;break;case"Italic":this.bold=!1,this.italic=!0;break;case"BoldItalic":this.bold=!0,this.italic=!0;break;case"Regular":this.bold=!1,this.italic=!1}},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"FontDialog"},e.prototype.createInputElement=function(e,t,r){return i.i(n.createElement)("input",{attrs:{type:e},id:t,className:r})},e.prototype.initFontDialog=function(e,t){var r,s,l,d,h,c,p;this.documentHelper.owner.containerId;this.target=i.i(n.createElement)("div",{className:"e-de-font-dlg"});var u=this.getFontDiv(e,t);this.target.appendChild(u);var g=this.getFontSizeDiv(e,t);this.target.appendChild(g);var f=i.i(n.createElement)("div",{className:"e-de-container-row"});this.fontColorDiv=i.i(n.createElement)("div",{className:"e-de-font-dlg-display"});var m=i.i(n.createElement)("label",{className:"e-de-font-dlg-header-font-color e-de-font-color-margin",innerHTML:e.getConstant("Font color")});t&&m.classList.add("e-de-rtl"),this.fontColorDiv.appendChild(m);var v=this.createInputElement("color",this.target.id+"_ColorDiv","e-de-font-dlg-color");this.fontColorDiv.appendChild(v),f.appendChild(this.fontColorDiv),this.target.appendChild(f);var y=i.i(n.createElement)("div");p=i.i(n.createElement)("div"),r=i.i(n.createElement)("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Effects")}),p.appendChild(r),y.appendChild(p),this.target.appendChild(y);var w=i.i(n.createElement)("div",{className:"e-de-container-row"}),b=i.i(n.createElement)("div",{className:"e-de-subcontainer-left"});s=this.createInputElement("checkbox",this.target.id+"_strikeThrough",""),b.appendChild(s);var x=i.i(n.createElement)("div",{className:"e-de-font-checkbox"});d=this.createInputElement("checkbox",this.target.id+"_subScript",""),x.appendChild(d),b.appendChild(x),x=i.i(n.createElement)("div",{className:"e-de-font-checkbox"}),c=this.createInputElement("checkbox",this.target.id+"_allCaps",""),x.appendChild(c),b.appendChild(x),w.appendChild(b);var C=i.i(n.createElement)("div",{className:"e-de-subcontainer-right"});l=this.createInputElement("checkbox",this.target.id+"_superScript",""),C.appendChild(l),x=i.i(n.createElement)("div",{className:"e-de-font-checkbox"}),h=this.createInputElement("checkbox",this.target.id+"_doubleStrikeThrough",""),x.appendChild(h),C.appendChild(x),w.appendChild(C),this.target.appendChild(w),this.colorPicker=new a.ColorPicker({change:this.fontColorUpdate,value:"#000000",enableRtl:t,locale:this.documentHelper.owner.locale,enableOpacity:!1}),this.colorPicker.appendTo(v),this.strikethroughBox=new o.CheckBox({change:this.singleStrikeUpdate,cssClass:"e-de-font-content-label",label:e.getConstant("Strikethrough"),enableRtl:t}),this.strikethroughBox.appendTo(s),this.doublestrikethrough=new o.CheckBox({change:this.doubleStrikeUpdate,label:e.getConstant("Double strikethrough"),enableRtl:t}),this.doublestrikethrough.appendTo(h),this.subscript=new o.CheckBox({label:e.getConstant("Subscript"),cssClass:"e-de-font-content-label-width",change:this.subscriptUpdate,enableRtl:t}),this.subscript.appendTo(d),this.superscript=new o.CheckBox({label:e.getConstant("Superscript"),cssClass:"e-de-font-content-label",change:this.superscriptUpdate,enableRtl:t}),this.superscript.appendTo(l),this.allcaps=new o.CheckBox({label:e.getConstant("All caps"),cssClass:"e-de-font-content-label-caps",change:this.allcapsUpdate,enableRtl:t}),this.allcaps.appendTo(c),t&&(b.classList.add("e-de-rtl"),C.classList.add("e-de-rtl"),p.classList.remove("e-de-font-content-checkbox-label"))},e.prototype.getFontSizeDiv=function(e,t){var o,s;this.documentHelper.owner.containerId;s=i.i(n.createElement)("div",{className:"e-de-container-row"});var a=i.i(n.createElement)("div",{className:"e-de-subcontainer-left"}),l=e.getConstant("Size");o=i.i(n.createElement)("select",{id:this.target.id+"_fontSize"}),o.innerHTML="<option>8</option><option>9</option><option>10</option><option>11</option><option>12</option><option>14</option><option>16</option><option>18</option><option>20</option><option>24</option><option>26</option><option>28</option><option>36</option><option>48</option><option>72</option><option>96</option>",a.appendChild(o),s.appendChild(a);var d=i.i(n.createElement)("div",{className:"e-de-subcontainer-right"});t&&d.classList.add("e-de-rtl");var h,c=e.getConstant("Underline style");return h=i.i(n.createElement)("select",{id:this.target.id+"_underLine"}),h.innerHTML='<option value="None">'+e.getConstant("None")+'</option><option value="Single">________</option>',d.appendChild(h),s.appendChild(d),this.fontSizeText=new r.ComboBox({change:this.fontSizeUpdate,allowCustom:!0,showClearButton:!1,enableRtl:t,floatLabelType:"Always",placeholder:l,htmlAttributes:{"aria-labelledby":l}}),this.fontSizeText.appendTo(o),this.underlineDrop=new r.DropDownList({change:this.underlineUpdate,enableRtl:t,floatLabelType:"Always",placeholder:c,htmlAttributes:{"aria-labelledby":c}}),this.underlineDrop.appendTo(h),s},e.prototype.getFontDiv=function(e,t){for(var o=(this.documentHelper.owner.containerId,i.i(n.createElement)("div",{className:"e-de-container-row"})),s=i.i(n.createElement)("div",{className:"e-de-subcontainer-left"}),a=e.getConstant("Font"),l=i.i(n.createElement)("select",{id:this.target.id+"_fontName"}),d=this.documentHelper.owner.documentEditorSettings.fontFamilies,h=0;h<d.length;h++)l.innerHTML+="<option>"+d[h]+"</option>";s.appendChild(l),o.appendChild(s);var c,p;c=i.i(n.createElement)("div",{className:"e-de-subcontainer-right"}),t&&c.classList.add("e-de-rtl");var u=e.getConstant("Font style");return p=i.i(n.createElement)("select",{id:this.target.id+"_fontStyle"}),p.innerHTML='<option value="Regular">'+e.getConstant("Regular")+'</option><option value="Bold">'+e.getConstant("Bold")+'</option><option value="Italic">'+e.getConstant("Italic")+'</option><option value="BoldItalic">'+e.getConstant("Bold")+e.getConstant("Italic")+"</option>",c.appendChild(p),o.appendChild(c),this.fontNameList=new r.ComboBox({change:this.fontFamilyUpdate,enableRtl:t,floatLabelType:"Always",placeholder:a}),this.fontNameList.showClearButton=!1,this.fontNameList.appendTo(l),this.fontStyleText=new r.DropDownList({change:this.fontStyleUpdate,enableRtl:t,floatLabelType:"Always",placeholder:u}),this.fontStyleText.appendTo(p),o},e.prototype.showFontDialog=function(e,t){e&&(this.characterFormat=e),this.isListDialog=t;var i=new n.L10n("documenteditor",this.documentHelper.owner.defaultLocale);i.setLocale(this.documentHelper.owner.locale),this.target||this.initFontDialog(i,this.documentHelper.owner.enableRtl),this.documentHelper.dialog.header=i.getConstant("Font"),this.documentHelper.dialog.width="auto",this.documentHelper.dialog.height="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=this.loadFontDialog,this.documentHelper.dialog.close=this.closeFontDialog,this.documentHelper.dialog.buttons=[{click:this.onInsertFontFormat,buttonModel:{content:i.getConstant("Ok"),cssClass:"e-flat e-font-okay",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:i.getConstant("Cancel"),cssClass:"e-flat e-font-cancel"}}],this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show()},e.prototype.onCharacterFormat=function(e,t){if(this.documentHelper.owner.editorModule.initHistory("CharacterFormat"),e.isEmpty)return e.start.offset===e.getParagraphLength(e.start.paragraph)&&(this.documentHelper.owner.editorModule.applyCharFormatValueInternal(e,e.start.paragraph.characterFormat,void 0,t),this.documentHelper.owner.editorModule.reLayout(e)),void this.documentHelper.updateFocus();this.documentHelper.owner.editorModule.setOffsetValue(this.documentHelper.selection),this.documentHelper.owner.editorModule.updateSelectionCharacterFormatting("CharacterFormat",t,!1)},e.prototype.enableCheckBoxProperty=function(e){this.strikethroughBox.checked&&this.doublestrikethrough.checked&&(this.strikethroughBox.checked=!1,this.doublestrikethrough.checked=!1,e.event.currentTarget.id===this.target.id+"_doubleStrikeThrough"?this.doublestrikethrough.checked=!0:this.strikethroughBox.checked=!0),this.superscript.checked&&this.subscript.checked&&(this.subscript.checked=!1,this.superscript.checked=!1,e.event.currentTarget.id===this.target.id+"_subScript"?this.subscript.checked=!0:this.superscript.checked=!0)},e.prototype.unWireEventsAndBindings=function(){this.fontNameList.value="",this.fontSizeText.value="",this.fontStyleText.value="",this.strikethroughBox.checked=!1,this.doublestrikethrough.checked=!1,this.superscript.checked=!1,this.subscript.checked=!1,this.allcaps.checked=!1,this.bold=void 0,this.italic=void 0,this.underline=void 0,this.strikethrough=void 0,this.baselineAlignment=void 0,this.fontColor=void 0,this.fontSize=void 0,this.fontFamily=void 0},e.prototype.destroy=function(){if(this.documentHelper=void 0,this.characterFormat&&(this.characterFormat.destroy(),this.characterFormat=void 0),!i.i(n.isNullOrUndefined)(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[e]),e--;this.target=void 0}this.fontNameList&&this.fontNameList.destroy(),this.fontNameList=void 0,this.fontStyleText&&this.fontStyleText.destroy(),this.fontStyleText=void 0,this.fontSizeText&&this.fontSizeText.destroy(),this.fontSizeText=void 0,this.colorPicker&&this.colorPicker.destroy(),this.colorPicker=void 0,this.underlineDrop&&this.underlineDrop.destroy(),this.underlineDrop=void 0,this.strikethroughBox&&this.strikethroughBox.destroy(),this.strikethroughBox=void 0,this.doublestrikethrough&&this.doublestrikethrough.destroy(),this.doublestrikethrough=void 0,this.superscript&&this.superscript.destroy(),this.superscript=void 0,this.subscript&&this.subscript.destroy(),this.subscript=void 0,this.allcaps&&this.allcaps.destroy(),this.allcaps=void 0},e}())},function(e,t,i){"use strict";i.d(t,"a",function(){return a});var n=i(0),r=(i.n(n),i(3)),o=(i.n(r),i(2)),s=i(5),a=(i.n(s),function(){function e(e){var t=this;this.changeBidirectional=function(e){"exact"===e.value?(t.autoButton.checked=!t.exactButton.checked,t.exactlyNumber.enabled=!0):(t.exactButton.checked=!t.autoButton.checked,t.exactlyNumber.enabled=!1)},this.changeBidirect=function(e){"check"===e.value?t.notCheckedButton.checked=!t.checkedButton.checked:t.checkedButton.checked=!t.notCheckedButton.checked},this.onCancelButtonClick=function(){t.documentHelper.dialog.hide()},this.insertCheckBoxField=function(){t.closeCheckBoxField();var e=new o.m;e.defaultValue=t.checkedButton.checked,e.name=n.SanitizeHtmlHelper.sanitize(t.bookmarkInputText.value),e.helpText=n.SanitizeHtmlHelper.sanitize(t.tooltipInputText.value),e.checked=e.defaultValue,e.enabled=t.checBoxEnableElement.checked,t.exactButton.checked?(e.sizeType="Exactly",e.size=t.exactlyNumber.value):(e.sizeType="Auto",e.size=11),t.owner.editor.editFormField("CheckBox",e)},this.closeCheckBoxField=function(){t.documentHelper.dialog.hide(),t.documentHelper.dialog.element.style.pointerEvents=""},this.owner=e}return Object.defineProperty(e.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"CheckBoxFormFieldDialog"},e.prototype.initCheckBoxDialog=function(e,t){this.target=i.i(n.createElement)("div");var o=i.i(n.createElement)("div"),a=i.i(n.createElement)("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Check box size")}),l=i.i(n.createElement)("div",{className:"e-de-container-row"}),d=i.i(n.createElement)("div",{className:"e-de-ff-radio-scnd-div"}),h=i.i(n.createElement)("div",{className:"e-de-ff-radio-scnd-div"}),c=i.i(n.createElement)("input",{className:"e-de-rtl-btn-div",attrs:{"aria-label":e.getConstant("Auto")}}),p=i.i(n.createElement)("input",{className:"e-de-rtl-btn-div",attrs:{"aria-label":e.getConstant("Exactly")}});this.autoButton=new r.RadioButton({label:e.getConstant("Auto"),cssClass:"e-small",change:this.changeBidirectional,checked:!0,enableRtl:t}),this.exactButton=new r.RadioButton({label:e.getConstant("Exactly"),value:"exact",cssClass:"e-small",change:this.changeBidirectional,enableRtl:t}),this.exactNumberDiv=i.i(n.createElement)("div",{className:"e-de-ff-chck-exact"});var u=i.i(n.createElement)("input",{attrs:{type:"text","aria-label":e.getConstant("Exactly")}});this.exactlyNumber=new s.NumericTextBox({format:"n",value:10,min:1,max:1584,enablePersistence:!1,enabled:!1,cssClass:"e-de-check-exactnumbr-width",enableRtl:t});var g=i.i(n.createElement)("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Default value")}),f=i.i(n.createElement)("div",{className:"e-de-container-row"}),m=i.i(n.createElement)("div",{className:"e-de-ff-radio-div"}),v=i.i(n.createElement)("div",{className:"e-de-ff-radio-div"}),y=i.i(n.createElement)("input",{className:"e-de-rtl-btn-div",attrs:{"aria-label":e.getConstant("Not checked")}}),w=i.i(n.createElement)("input",{className:"e-de-rtl-btn-div",attrs:{"aria-label":e.getConstant("Checked")}});this.notCheckedButton=new r.RadioButton({label:e.getConstant("Not checked"),enableRtl:t,cssClass:"e-small",change:this.changeBidirect}),this.checkedButton=new r.RadioButton({label:e.getConstant("Checked"),value:"check",enableRtl:t,cssClass:"e-small",change:this.changeBidirect,checked:!0});var b=i.i(n.createElement)("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Field settings")}),x=i.i(n.createElement)("div",{className:"e-de-container-row"}),C=i.i(n.createElement)("div",{className:"e-de-subcontainer-left"}),I=i.i(n.createElement)("div",{className:"e-de-subcontainer-right"});this.tooltipInputText=i.i(n.createElement)("input",{className:"e-input e-bookmark-textbox-input",attrs:{"aira-label":e.getConstant("Tooltip")}}),this.bookmarkInputText=i.i(n.createElement)("input",{className:"e-input e-bookmark-textbox-input",attrs:{"aira-label":e.getConstant("Name")}});var F=i.i(n.createElement)("div"),k=i.i(n.createElement)("input",{attrs:{type:"checkbox"}});k.setAttribute("aria-label",e.getConstant("Check box enabled")),this.checBoxEnableElement=new r.CheckBox({cssClass:"e-de-ff-dlg-check",label:e.getConstant("Check box enabled"),enableRtl:t}),t&&(d.classList.add("e-de-rtl"),h.classList.add("e-de-rtl"),this.exactNumberDiv.classList.add("e-de-rtl"),m.classList.add("e-de-rtl"),v.classList.add("e-de-rtl"),C.classList.add("e-de-rtl"),I.classList.add("e-de-rtl")),this.target.appendChild(o),o.appendChild(g),o.appendChild(f),f.appendChild(m),m.appendChild(y),this.notCheckedButton.appendTo(y),f.appendChild(v),v.appendChild(w),this.checkedButton.appendTo(w),o.appendChild(a),o.appendChild(l),l.appendChild(d),d.appendChild(c),this.autoButton.appendTo(c),l.appendChild(h),h.appendChild(p),this.exactButton.appendTo(p),h.appendChild(this.exactNumberDiv),this.exactNumberDiv.appendChild(u),this.exactlyNumber.appendTo(u),o.appendChild(b),o.appendChild(x),x.appendChild(C),x.appendChild(I),C.appendChild(this.tooltipInputText),I.appendChild(this.bookmarkInputText),o.appendChild(F),F.appendChild(k),this.checBoxEnableElement.appendTo(k),new s.TextBox({placeholder:e.getConstant("Tooltip"),floatLabelType:"Always"},this.tooltipInputText),new s.TextBox({placeholder:e.getConstant("Name"),floatLabelType:"Always"},this.bookmarkInputText)},e.prototype.show=function(){var e=new n.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),i.i(n.isNullOrUndefined)(this.target)&&this.initCheckBoxDialog(e,this.documentHelper.owner.enableRtl),this.loadCheckBoxDialog(),this.documentHelper.dialog.header=e.getConstant("Check Box Form Field"),this.documentHelper.dialog.position={X:"center",Y:"center"},this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="400px",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.buttons=[{click:this.insertCheckBoxField,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-table-cell-margin-okay",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-table-cell-margin-cancel"}}],this.documentHelper.dialog.show()},e.prototype.loadCheckBoxDialog=function(){var e=this.owner.selection.getCurrentFormField();if(e instanceof o.b){this.fieldBegin=e;var t=this.fieldBegin.formFieldData;t.defaultValue?(this.checkedButton.checked=!0,this.notCheckedButton.checked=!1):(this.checkedButton.checked=!1,this.notCheckedButton.checked=!0),"Auto"!==t.sizeType?(this.exactButton.checked=!0,this.autoButton.checked=!1,this.exactlyNumber.enabled=!0):(this.autoButton.checked=!0,this.exactButton.checked=!1,this.exactlyNumber.enabled=!1),t.size&&(this.exactlyNumber.value=t.size),t.enabled?this.checBoxEnableElement.checked=!0:this.checBoxEnableElement.checked=!1,t.name&&""!==t.name?this.bookmarkInputText.value=t.name:this.bookmarkInputText.value="",t.helpText&&""!==t.helpText?this.tooltipInputText.value=t.helpText:this.tooltipInputText.value=""}},e.prototype.destroy=function(){var e=this.target;e&&(e.parentElement&&e.parentElement.removeChild(e),this.target=void 0),this.owner=void 0,this.autoButton&&(this.autoButton.destroy(),this.autoButton=void 0),this.exactButton&&(this.exactButton.destroy(),this.exactButton=void 0),this.notCheckedButton&&(this.notCheckedButton.destroy(),this.notCheckedButton=void 0),this.checkedButton&&(this.checkedButton.destroy(),this.checkedButton=void 0),this.bookmarkInputText=void 0,this.tooltipInputText=void 0,this.checBoxEnableElement&&(this.checBoxEnableElement.destroy(),this.checBoxEnableElement=void 0),this.exactlyNumber&&(this.exactlyNumber.destroy(),this.exactlyNumber=void 0),this.exactNumberDiv=void 0},e}())},function(e,t,i){"use strict";i.d(t,"a",function(){return l});var n=i(0),r=(i.n(n),i(4)),o=i(10),s=(i.n(o),i(3)),a=(i.n(s),i(5)),l=(i.n(a),function(){function e(e){var t=this;this.displayText="",this.navigationUrl=void 0,this.screenTipText="",this.bookmarkDropdown=void 0,this.bookmarkCheckbox=void 0,this.bookmarks=[],this.onKeyUpOnUrlBox=function(e){if(13===e.keyCode)return void(""!==t.displayTextBox.value&&""!==t.urlTextBox.value&&t.onInsertHyperlink());var i=t.urlTextBox.value;"www."===i.substring(0,4).toLowerCase()&&(t.urlTextBox.value="http://"+i),""===t.displayText&&(t.displayTextBox.value=i),t.enableOrDisableInsertButton()},this.onKeyUpOnDisplayBox=function(){t.displayText=t.displayTextBox.value,t.enableOrDisableInsertButton()},this.onScreenTipTextBox=function(){t.screenTipText=t.screenTipTextBox.value},this.onInsertButtonClick=function(){t.onInsertHyperlink()},this.onCancelButtonClick=function(){t.documentHelper.dialog.hide(),t.clearValue(),t.documentHelper.updateFocus()},this.loadHyperlinkDialog=function(){t.documentHelper.updateFocus(),t.bookmarks=[];for(var e=0;e<t.documentHelper.bookmarks.keys.length;e++){var r=t.documentHelper.bookmarks.keys[parseInt(e.toString(),10)];0!==r.indexOf("_")&&t.bookmarks.push(r)}var o=t.documentHelper.selection.getHyperlinkField();if(i.i(n.isNullOrUndefined)(o))t.displayText=t.documentHelper.selection.getText(!0),""!==t.displayText&&(-1!==t.displayText.indexOf(String.fromCharCode(65532))||-1!==t.displayText.indexOf("\r")&&-1!==t.displayText.lastIndexOf("\r")&&-1!==t.displayText.slice(0,-1).indexOf("\r")?(t.displayTextBox.value="<<Selection in document>>",t.displayTextBox.disabled=!0):t.displayTextBox.value=t.displayText);else{if(!i.i(n.isNullOrUndefined)(o.fieldSeparator)){var s=t.documentHelper.selection.getHyperlinkDisplayText(o.fieldSeparator.line.paragraph,o.fieldSeparator,o.fieldEnd,!1,void 0);t.displayText=s.displayText,t.displayTextBox.disabled=s.isNestedField}t.displayTextBox.value=t.displayText,t.screenTipTextBox.value=t.documentHelper.selection.getLinkText(o,!1);var a=t.documentHelper.selection.getLinkText(o,!0);t.urlTextBox.value=t.navigationUrl=a,t.documentHelper.dialog.header=t.localObj.getConstant("Edit Hyperlink")}t.bookmarkDiv.style.display="none",t.addressText.style.display="block",t.urlTextBox.style.display="block",t.bookmarkCheckbox.checked=!1,t.bookmarkDropdown.dataSource=t.documentHelper.bookmarks.keys,t.insertButton=document.getElementsByClassName("e-hyper-insert")[0],t.enableOrDisableInsertButton(),t.urlTextBox.focus(),"none"!==t.documentHelper.selection.caret.style.display&&(t.documentHelper.selection.caret.style.display="none")},this.closeHyperlinkDialog=function(){t.clearValue(),t.documentHelper.updateFocus()},this.onUseBookmarkChange=function(e){e.checked?(t.bookmarkDiv.style.display="block",t.bookmarkDropdown.dataSource=t.bookmarks,t.addressText.style.display="none",t.urlTextBox.style.display="none"):(t.bookmarkDiv.style.display="none",t.addressText.style.display="block",t.urlTextBox.style.display="block"),t.enableOrDisableInsertButton()},this.onBookmarkchange=function(){""!==t.bookmarkDropdown.value&&(t.insertButton.disabled=!1)},this.documentHelper=e}return e.prototype.getModuleName=function(){return"HyperlinkDialog"},e.prototype.initHyperlinkDialog=function(e,t){this.target=i.i(n.createElement)("div",{className:"e-de-hyperlink"});var r=i.i(n.createElement)("div"),l=i.i(n.createElement)("div",{className:"e-de-dlg-container"});this.displayTextBox=i.i(n.createElement)("input",{className:"e-input"}),this.displayTextBox.addEventListener("keyup",this.onKeyUpOnDisplayBox),l.appendChild(this.displayTextBox),r.appendChild(l),this.addressText=i.i(n.createElement)("div",{className:"e-de-dlg-container"}),this.urlTextBox=i.i(n.createElement)("input",{className:"e-input",attrs:{autofocus:"true"}}),this.urlTextBox.addEventListener("input",this.onKeyUpOnUrlBox),this.urlTextBox.addEventListener("keyup",this.onKeyUpOnUrlBox),this.addressText.appendChild(this.urlTextBox),r.appendChild(this.addressText);var d=i.i(n.createElement)("div",{className:"e-de-dlg-container"});this.screenTipTextBox=i.i(n.createElement)("input",{className:"e-input"}),this.screenTipTextBox.addEventListener("keyup",this.onScreenTipTextBox),d.appendChild(this.screenTipTextBox),r.appendChild(d),this.bookmarkDiv=i.i(n.createElement)("div",{styles:"display:none;"});var h=i.i(n.createElement)("div",{className:"e-de-dlg-container"}),c=i.i(n.createElement)("input");h.appendChild(c),this.bookmarkDropdown=new o.DropDownList({dataSource:[],change:this.onBookmarkchange,noRecordsTemplate:e.getConstant("No bookmarks found"),placeholder:e.getConstant("Bookmark"),floatLabelType:"Always"}),this.bookmarkDropdown.appendTo(c),this.bookmarkDiv.appendChild(h),r.appendChild(this.bookmarkDiv);var p=i.i(n.createElement)("div"),u=i.i(n.createElement)("input",{attrs:{type:"checkbox"}});p.appendChild(u),this.bookmarkCheckbox=new s.CheckBox({label:e.getConstant("Use bookmarks"),enableRtl:t,change:this.onUseBookmarkChange}),this.bookmarkCheckbox.appendTo(u),r.appendChild(p),this.target.appendChild(r),new a.TextBox({placeholder:e.getConstant("Text to display"),floatLabelType:"Always"},this.displayTextBox),new a.TextBox({placeholder:e.getConstant("Address"),floatLabelType:"Always"},this.urlTextBox),new a.TextBox({placeholder:e.getConstant("ScreenTip text"),floatLabelType:"Always"},this.screenTipTextBox)},e.prototype.show=function(){this.localObj=new n.L10n("documenteditor",this.documentHelper.owner.defaultLocale),this.localObj.setLocale(this.documentHelper.owner.locale),this.target||this.initHyperlinkDialog(this.localObj,this.documentHelper.owner.enableRtl),this.documentHelper.dialog.header=this.localObj.getConstant("Insert Hyperlink"),this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.buttons=[{click:this.onInsertButtonClick,buttonModel:{content:this.localObj.getConstant("Ok"),cssClass:"e-flat e-hyper-insert",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:this.localObj.getConstant("Cancel"),cssClass:"e-flat e-hyper-cancel"}}],this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.beforeOpen=this.loadHyperlinkDialog,this.documentHelper.dialog.close=this.closeHyperlinkDialog,this.documentHelper.dialog.show()},e.prototype.hide=function(){this.closeHyperlinkDialog()},e.prototype.enableOrDisableInsertButton=function(){i.i(n.isNullOrUndefined)(this.insertButton)||(this.bookmarkCheckbox.checked?this.insertButton.disabled=""===this.bookmarkDropdown.value||null==this.bookmarkDropdown.value:this.insertButton.disabled=""===this.urlTextBox.value||""===this.displayTextBox.value)},e.prototype.onInsertHyperlink=function(){var e=n.SanitizeHtmlHelper.sanitize(this.displayTextBox.value.trim()),t=this.urlTextBox.value.trim();(r.a.startsWith(t,"http://")||r.a.startsWith(t,"https://"))&&(t=n.SanitizeHtmlHelper.sanitize(t.replace(/\s/g,"")));var o=n.SanitizeHtmlHelper.sanitize(this.screenTipTextBox.value.trim()),s=!1;if(i.i(n.isNullOrUndefined)(this.bookmarkDropdown.value)||""===this.bookmarkDropdown.value||!0!==this.bookmarkCheckbox.checked||(t=this.bookmarkDropdown.value,s=!0),""===t)return void this.documentHelper.hideDialog();if(""!==o&&(t=t+'" \\o "'+o),e=""===e&&""!==t?t:this.displayTextBox.value,i.i(n.isNullOrUndefined)(this.navigationUrl)){var a=(this.documentHelper.selection.text!==e||-1===this.documentHelper.selection.text.indexOf("\r"))&&!this.displayTextBox.disabled;this.documentHelper.owner.editorModule.insertHyperlinkInternal(t,e,a,s)}else this.documentHelper.owner.editorModule.editHyperlink(this.documentHelper.selection,t,e,s);this.documentHelper.hideDialog(),this.navigationUrl=void 0},e.prototype.clearValue=function(){this.displayTextBox.value="",this.urlTextBox.value="",this.screenTipText="",this.screenTipTextBox.value="",this.displayText="",this.displayTextBox.disabled=!1,this.bookmarks=[]},e.prototype.destroy=function(){this.displayTextBox&&(this.displayTextBox.innerHTML="",this.displayTextBox=void 0),this.urlTextBox&&(this.urlTextBox.parentElement.removeChild(this.urlTextBox),this.urlTextBox=void 0),this.screenTipTextBox&&(this.screenTipTextBox.parentElement.removeChild(this.screenTipTextBox),this.screenTipTextBox=void 0),this.documentHelper=void 0,i.i(n.isNullOrUndefined)(this.target)||(this.target.parentElement&&this.target.parentElement.removeChild(this.target),this.target.innerHTML="",this.target=void 0)},e}())},function(e,t,i){"use strict";i.d(t,"a",function(){return c});var n=i(5),r=(i.n(n),i(0)),o=(i.n(r),i(9)),s=i(14),a=i(26),l=i(10),d=(i.n(l),i(8)),h=(i.n(d),i(96)),c=function(){function e(e){var t=this;this.dialog=void 0,this.target=void 0,this.documentHelper=void 0,this.viewModel=void 0,this.startAt=void 0,this.textIndent=void 0,this.alignedAt=void 0,this.listLevelElement=void 0,this.followNumberWith=void 0,this.numberStyle=void 0,this.numberFormat=void 0,this.restartBy=void 0,this.isListCharacterFormat=!1,this.onTextIndentChanged=function(e){e.isInteracted&&(t.viewModel.listLevel.paragraphFormat.leftIndent=e.value)},this.onStartValueChanged=function(e){e.isInteracted&&(i.i(r.isNullOrUndefined)(t.viewModel)||i.i(r.isNullOrUndefined)(t.viewModel.listLevel)||(t.viewModel.listLevel.startAt=e.value))},this.onListLevelValueChanged=function(e){t.viewModel.levelNumber=parseInt(e.value.slice(e.value.length-1),10)-1,i.i(r.isNullOrUndefined)(t.listLevel)||(t.updateDialogValues(),t.updateRestartLevelBox())},this.onNumberFormatChanged=function(e){t.viewModel.listLevel.numberFormat=e.target.value},this.onAlignedAtValueChanged=function(e){e.isInteracted&&(t.viewModel.listLevel.paragraphFormat.firstLineIndent=t.alignedAt.value-t.viewModel.listLevel.paragraphFormat.leftIndent)},this.onFollowCharacterValueChanged=function(e){e.isInteracted&&(t.viewModel.followCharacter=e.value)},this.onLevelPatternValueChanged=function(e){if(e.isInteracted){t.viewModel.listLevelPattern=e.value;var i="%"+(t.levelNumber+1).toString(),n=document.getElementById(t.documentHelper.owner.containerId+"_numberFormat");"Bullet"===t.listLevel.listLevelPattern?(t.listLevel.numberFormat=String.fromCharCode(61623),n.value=t.listLevel.numberFormat):("None"===t.listLevel.listLevelPattern&&(t.listLevel.numberFormat=""),t.listLevel.numberFormat.match(i)||"None"===t.listLevel.listLevelPattern||(t.listLevel.numberFormat=i+"."),n.value=t.listLevel.numberFormat)}},this.loadListDialog=function(){t.documentHelper.updateFocus(),i.i(r.isNullOrUndefined)(t.documentHelper.owner)||(t.viewModel=new h.a,t.viewModel.dialog=t,t.documentHelper.selection.paragraphFormat.listLevelNumber>0&&(t.viewModel.levelNumber=t.documentHelper.selection.paragraphFormat.listLevelNumber),t.viewModel.list=t.documentHelper.selection.paragraphFormat.getList(),i.i(r.isNullOrUndefined)(t.listLevel)||(t.updateDialogValues(),"none"!==t.documentHelper.selection.caret.style.display&&(t.documentHelper.selection.caret.style.display="none")))},this.showFontDialog=function(){t.documentHelper.owner.fontDialogModule.showFontDialog(t.listLevel.characterFormat,!0)},this.onApplyList=function(){i.i(r.isNullOrUndefined)(t.owner)||t.documentHelper.selection.paragraphFormat.setList(t.list,!0),t.documentHelper.dialog2.hide(),t.documentHelper.updateFocus()},this.onCancelButtonClick=function(){t.disposeBindingForListUI(),t.documentHelper.dialog2.hide(),t.documentHelper.updateFocus(),t.isListCharacterFormat=!1},this.closeListDialog=function(){t.disposeBindingForListUI(),t.documentHelper.updateFocus(),t.isListCharacterFormat=!1},this.documentHelper=e,this.viewModel=new h.a}return Object.defineProperty(e.prototype,"listLevel",{get:function(){if(!i.i(r.isNullOrUndefined)(this.viewModel))return this.viewModel.listLevel},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"list",{get:function(){if(!i.i(r.isNullOrUndefined)(this.viewModel))return this.viewModel.list},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"levelNumber",{get:function(){return this.listLevel.ownerBase instanceof a.a?this.listLevel.ownerBase.levelNumber:this.listLevel.ownerBase instanceof s.a&&!i.i(r.isNullOrUndefined)(this.listLevel.ownerBase.levels)?this.listLevel.ownerBase.levels.indexOf(this.listLevel):-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"owner",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"ListDialog"},e.prototype.showListDialog=function(){var e=new r.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale);var t=!1;this.target||(this.initListDialog(e,this.documentHelper.owner.enableRtl),t=!0),this.isListCharacterFormat=!0,this.documentHelper.dialog2.header=e.getConstant("Define new Multilevel list"),this.documentHelper.dialog2.height="auto",this.documentHelper.dialog2.width="auto",this.documentHelper.dialog2.content=this.target;var i,n=this.documentHelper.owner.enableRtl;i=n?"e-flat e-list-dlg-font e-de-dlg-target.e-de-rtl e-font-rtl":"e-flat e-list-dlg-font e-font",this.documentHelper.dialog2.buttons=[{click:this.showFontDialog,buttonModel:{content:e.getConstant("Font"),cssClass:i}},{click:this.onApplyList,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-list-dlg",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-list-dlg"}}];this.documentHelper.dialog2.element;this.documentHelper.dialog2.dataBind(),t&&this.wireAndBindEvent(e,n),this.documentHelper.dialog2.beforeOpen=this.loadListDialog,this.documentHelper.dialog2.close=this.closeListDialog,this.documentHelper.dialog2.position={X:"center",Y:"top"},this.documentHelper.dialog2.show()},e.prototype.initListDialog=function(e,t){var n=this.documentHelper.owner.containerId,o=n+"_insert_list";this.target=i.i(r.createElement)("div",{id:o,className:"e-de-list-dlg"});var s=i.i(r.createElement)("div",{innerHTML:'<label id="'+n+'_listLevellabel" style="display:block;" class=e-de-list-ddl-header-list-level>'+e.getConstant("List level")+'</label><label id="'+n+'_modifyLabel" style="display:block;" class=e-de-list-ddl-subheader>'+e.getConstant("Choose level to modify")+'</label><select style="height:20px;width:43%" id="'+n+'_listLevel"><option>'+e.getConstant("Level")+" 1</option><option>"+e.getConstant("Level")+" 2</option><option>"+e.getConstant("Level")+" 3</option><option>"+e.getConstant("Level")+" 4</option><option>"+e.getConstant("Level")+" 5</option><option>"+e.getConstant("Level")+" 6</option><option>"+e.getConstant("Level")+" 7</option><option>"+e.getConstant("Level")+" 8</option><option>"+e.getConstant("Level")+" 9</option></select>"});this.target.appendChild(s);var a,l=i.i(r.createElement)("div");a=t?'<div style="float:right;display:block;width:241px;">':'<div style="float:left;display:block;">';var d=i.i(r.createElement)("div",{innerHTML:a+'<label id="'+n+'_numberFormatLabel" style="display:block;" class=e-de-list-ddl-header>'+e.getConstant("Number format")+'</label><label id="'+n+'_numberStyleLabel" style="display:block;" class=e-de-list-ddl-subheader>'+e.getConstant("Number style for this level")+'</label><select style="height:20px;width:100%" id="'+n+'_numberStyle"><option>'+e.getConstant("Arabic")+"</option><option>"+e.getConstant("UpRoman")+"</option><option>"+e.getConstant("LowRoman")+"</option><option>"+e.getConstant("UpLetter")+"</option><option>"+e.getConstant("LowLetter")+"</option><option>"+e.getConstant("Number")+"</option><option>"+e.getConstant("Leading zero")+"</option><option>"+e.getConstant("Bullet")+"</option><option>"+e.getConstant("Ordinal")+"</option><option>"+e.getConstant("Ordinal Text")+"</option><option>"+e.getConstant("Special")+"</option><option>"+e.getConstant("For East")+'</option></select><label id="'+n+'_startAtLabel" style="display:block;" class=e-de-list-ddl-subheaderbottom>'+e.getConstant("Start at")+'</label><input type="text" id="'+n+'_startAt">'});l.appendChild(d),this.numberFormatDiv=i.i(r.createElement)("div",{className:"e-de-list-dlg-subdiv",innerHTML:'<div><div><label id="'+n+'_formatLabel" style="display:inline-block;width:86%" class=e-de-list-ddl-subheader>'+e.getConstant("Enter formatting for number")+'</label><button type="button" id="'+n+'_list_info" class="e-control e-btn e-primary e-de-list-format-info">i</button></div><input style=width:180px; type="text" id="'+n+'_numberFormat" aria-label="numberFormat" class=e-input></div><label id="'+n+'_restartLabel" style="display:block;" class=e-de-list-ddl-subheaderbottom>'+e.getConstant("Restart list after")+'</label><select style="height:20px;width:100%" id="'+n+'_restartBy"><option>'+e.getConstant("No Restart")+"</option></select></div>"}),l.appendChild(this.numberFormatDiv),this.target.appendChild(l);var h;h=t?"display:block;position:relative; ":"display:block; ";var c=i.i(r.createElement)("div",{innerHTML:a+'<label id="'+n+'_IndentsLabel" style='+h+"class=e-de-list-ddl-header>"+e.getConstant("Position")+'</label><label id="'+n+'_textIndentLabel" style='+h+"class=e-de-list-ddl-subheader>"+e.getConstant("Text indent at")+'</label><input type="text" id="'+n+'_textIndent"><label id="'+n+'_followCharacterLabel" style='+h+"class=e-de-list-ddl-subheaderbottom>"+e.getConstant("Follow number with")+'</label><select style="height:20px;width:100%" id="'+n+'_followCharacter"><option>'+e.getConstant("Tab character")+"</option><option>"+e.getConstant("Space")+"</option><option>"+e.getConstant("Nothing")+'</option></select></div><div id="e-de-list-dlg-div" class="e-de-list-dlg-div"><label id="'+n+'_alignedAtLabel" style="display:block;" class=e-de-list-ddl-subheader>'+e.getConstant("Aligned at")+'</label><input type="text" id="'+n+'_alignedAt"></div>'});this.target.appendChild(c)},e.prototype.wireAndBindEvent=function(e,t){var i=this.documentHelper.owner.containerId;t&&(document.getElementById("e-de-list-dlg-div").classList.add("e-de-rtl"),this.numberFormatDiv.classList.add("e-de-rtl"));var r=document.getElementById(i+"_startAt");r.setAttribute("aria-label","startAt");var o=document.getElementById(i+"_textIndent");o.setAttribute("aria-label","textIndent");var s=document.getElementById(i+"_alignedAt");s.setAttribute("aria-label","alignedAt"),this.startAt=new n.NumericTextBox({format:"#",decimals:0,min:0,max:50,width:"180px",enablePersistence:!1}),this.startAt.addEventListener("change",this.onStartValueChanged),this.startAt.appendTo(r),this.textIndent=new n.NumericTextBox({format:"#",decimals:0,min:0,max:1584,width:"180px",step:4,enablePersistence:!1}),this.textIndent.addEventListener("change",this.onTextIndentChanged),this.textIndent.appendTo(o),this.alignedAt=new n.NumericTextBox({format:"#",max:1584,step:6,width:"180px",enablePersistence:!1}),this.alignedAt.addEventListener("change",this.onAlignedAtValueChanged),this.alignedAt.appendTo(s);var a=document.getElementById(i+"_listLevel");this.listLevelElement=new l.DropDownList({popupHeight:"150px",width:"180px",enableRtl:t,change:this.onListLevelValueChanged}),this.listLevelElement.appendTo(a);var h=document.getElementById(i+"_followCharacter");this.followNumberWith=new l.DropDownList({popupHeight:"150px",width:"180px",enableRtl:t,change:this.onFollowCharacterValueChanged}),this.followNumberWith.appendTo(h);var c=document.getElementById(i+"_numberStyle");this.numberStyle=new l.DropDownList({popupHeight:"150px",width:"180px",enableRtl:t,change:this.onLevelPatternValueChanged}),this.numberStyle.appendTo(c),this.numberFormat=document.getElementById(i+"_numberFormat"),this.numberFormat.addEventListener("change",this.onNumberFormatChanged);var p=document.getElementById(i+"_restartBy");this.restartBy=new l.DropDownList({popupHeight:"150px",width:"180px",enableRtl:t}),this.restartBy.appendTo(p);var u=document.getElementById(i+"_list_info");this.formatInfoToolTip=new d.Tooltip({width:200}),this.formatInfoToolTip.content=e.getConstant("Number format tooltip information"),this.formatInfoToolTip.position="RightTop",this.formatInfoToolTip.appendTo(u)},e.prototype.updateRestartLevelBox=function(){for(var e=this.documentHelper.owner.containerId,t=document.getElementById(e+"_listLevel"),i=document.getElementById(e+"_restartBy"),n=0;n<i.options.length;n)i.options.remove(n);if(0===t.selectedIndex){var r=document.createElement("option");r.value="No Restart",r.innerHTML="No Restart",i.appendChild(r)}else{for(var n=t.selectedIndex;n>0;n--){var o=document.createElement("option");o.value="Level "+n,o.innerHTML="Level "+n,i.appendChild(o)}var r=document.createElement("option");r.value="No Restart",r.innerHTML="No Restart",i.appendChild(r)}i.selectedIndex=0},e.prototype.listPatternConverter=function(e){switch(e){case"Arabic":return 0;case"UpRoman":return 1;case"LowRoman":return 2;case"UpLetter":return 3;case"LowLetter":return 4;case"Number":return 5;case"LeadingZero":return 6;case"Bullet":return 7;case"Ordinal":return 8;case"OrdinalText":return 9;case"Special":return 10;case"FarEast":return 11;default:return 12}},e.prototype.followCharacterConverter=function(e){switch(e){case"Tab":return 0;case"Space":return 1;default:return 2}},e.prototype.calculateAlignedAt=function(){return this.viewModel.listLevel.paragraphFormat.firstLineIndent<0?this.viewModel.listLevel.paragraphFormat.leftIndent+this.viewModel.listLevel.paragraphFormat.firstLineIndent:this.viewModel.listLevel.paragraphFormat.firstLineIndent},e.prototype.updateDialogValues=function(){i.i(r.isNullOrUndefined)(this.listLevel.characterFormat)&&(this.listLevel.characterFormat=new o.c(this.viewModel.listLevel)),i.i(r.isNullOrUndefined)(this.listLevel.paragraphFormat)&&(this.listLevel.paragraphFormat=new o.a(this.viewModel.listLevel)),i.i(r.isNullOrUndefined)(this.viewModel)||i.i(r.isNullOrUndefined)(this.viewModel.listLevel)||(this.startAt.value=this.viewModel.listLevel.startAt,this.textIndent.value=this.viewModel.listLevel.paragraphFormat.leftIndent,this.alignedAt.value=this.calculateAlignedAt(),this.followNumberWith.index=this.followCharacterConverter(this.viewModel.followCharacter),this.numberFormat.value=this.viewModel.listLevel.numberFormat,this.numberFormat.style.fontFamily=this.viewModel.listLevel.characterFormat.fontFamily,this.numberStyle.index=this.listPatternConverter(this.viewModel.listLevelPattern),this.listLevelElement.index=this.viewModel.levelNumber)},e.prototype.updateCharacterFormat=function(e){this.listLevel.characterFormat.copyFormat(e)},e.prototype.disposeBindingForListUI=function(){this.followNumberWith.index=-1,this.numberFormat.value=" ",this.numberStyle.index=-1,this.listLevelElement.index=-1,this.restartBy.index=-1,this.viewModel.destroy()},e.prototype.destroy=function(){if(this.alignedAt&&this.alignedAt.destroy(),this.alignedAt=void 0,this.dialog=void 0,this.followNumberWith&&this.followNumberWith.destroy(),this.followNumberWith=void 0,this.listLevelElement&&this.listLevelElement.destroy(),this.listLevelElement=void 0,this.textIndent&&this.textIndent.destroy(),this.textIndent=void 0,this.startAt&&this.startAt.destroy(),this.startAt=void 0,this.numberStyle&&this.numberStyle.destroy(),this.numberStyle=void 0,this.numberFormat=void 0,this.restartBy&&this.restartBy.destroy(),this.restartBy=void 0,!i.i(r.isNullOrUndefined)(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[parseInt(e.toString(),10)]),e--;this.target=void 0}this.documentHelper=void 0,this.viewModel=void 0},e}()},function(e,t,i){"use strict";i.d(t,"a",function(){return l});var n=i(9),r=i(24),o=i(14),s=i(23),a=i(0),l=(i.n(a),function(){function e(){this.listIn=void 0,this.levelNumberIn=void 0,this.dialog=void 0,this.levelNumber=0}return Object.defineProperty(e.prototype,"levelNumber",{get:function(){return this.levelNumberIn},set:function(e){this.levelNumberIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"list",{get:function(){return this.listIn},set:function(e){i.i(a.isNullOrUndefined)(e)?this.createList():this.listIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"listLevel",{get:function(){if(!i.i(a.isNullOrUndefined)(this.list)&&this.levelNumber>=0&&this.levelNumber<9){if(i.i(a.isNullOrUndefined)(this.dialog.documentHelper.getAbstractListById(this.list.abstractListId))){this.dialog.documentHelper.lists.push(this.list);var e=this.list.abstractList;return this.list.abstractList||(e=new o.a,e.abstractListId=this.list.abstractListId),this.dialog.documentHelper.abstractLists.push(e),e=this.dialog.documentHelper.getAbstractListById(this.list.abstractListId),e.levels.length<=this.levelNumber&&this.dialog.documentHelper.layout.addListLevels(this.list.abstractList),e.levels[this.levelNumber]}return this.dialog.documentHelper.getAbstractListById(this.list.abstractListId).levels.length<=this.levelNumber&&this.dialog.documentHelper.layout.addListLevels(this.list.abstractList),this.dialog.documentHelper.getAbstractListById(this.list.abstractListId).levels[this.levelNumber]}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"listLevelPattern",{get:function(){return i.i(a.isNullOrUndefined)(this.listLevel)?"Arabic":this.listLevel.listLevelPattern},set:function(e){i.i(a.isNullOrUndefined)(this.listLevel)||(this.listLevel.listLevelPattern=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"followCharacter",{get:function(){return i.i(a.isNullOrUndefined)(this.listLevel)?"None":this.listLevel.followCharacter},set:function(e){i.i(a.isNullOrUndefined)(this.listLevel)||(this.listLevel.followCharacter=e)},enumerable:!0,configurable:!0}),e.prototype.createList=function(){this.list=new r.a,this.list.listId=this.dialog.documentHelper.lists.length+1;var e=new o.a;e.abstractListId=this.dialog.documentHelper.abstractLists.length+1,this.list.abstractListId=e.abstractListId,this.list.abstractList=e,this.dialog.documentHelper.lists.push(this.list);var t=new s.a(e);t.paragraphFormat=new n.a(t),t.paragraphFormat.leftIndent=48,t.paragraphFormat.firstLineIndent=-24,t.characterFormat=new n.c(t),t.numberFormat="%1.",t.startAt=1,e.levels.push(t),this.dialog.documentHelper.abstractLists.push(e)},e.prototype.addListLevels=function(){if(!i.i(a.isNullOrUndefined)(this.list)&&!i.i(a.isNullOrUndefined)(this.list.abstractListId))for(var e=this.dialog.documentHelper.getAbstractListById(this.list.abstractListId).levels.length;e<9;e++){var t=new s.a(this.dialog.documentHelper.getAbstractListById(this.list.abstractListId));t.characterFormat=new n.c(t),t.paragraphFormat=new n.a(t),t.paragraphFormat.leftIndent=48*(e+1),t.paragraphFormat.firstLineIndent=-24,t.numberFormat="%"+(e+1).toString()+".",t.listLevelPattern="Arabic",t.followCharacter="Tab",t.startAt=1,t.restartLevel=e,this.dialog.documentHelper.getAbstractListById(this.list.abstractListId).levels.push(t)}},e.prototype.destroy=function(){this.dialog&&this.listIn&&this.dialog.documentHelper.layout.clearInvalidList(this.listIn),this.listIn=void 0,this.levelNumberIn=void 0,this.listLevelPattern=void 0},e}())},function(e,t,i){"use strict";i.d(t,"a",function(){return a});var n=i(5),r=(i.n(n),i(0)),o=(i.n(r),i(10)),s=(i.n(o),i(31)),a=function(){function e(e){var t=this;this.list=void 0,this.noteNumberFormat=void 0,this.sectionFormat=void 0,this.onCancelButtonClick=function(){t.documentHelper.dialog.hide(),t.documentHelper.updateFocus(),t.unWireEventsAndBindings()},this.loadFontDialog=function(){t.documentHelper.updateFocus();var e,i;if(i=t.sectionFormat?t.sectionFormat:t.documentHelper.owner.selection.sectionFormat,t.documentHelper.selection.isinFootnote){var n=i.footNoteNumberFormat,r=i.initialFootNoteNumber;e=t.reversetype(n),t.notesList.value=e,t.startValueTextBox.value=r}else{var o=i.endnoteNumberFormat;e=t.reversetype(o);var r=i.initialEndNoteNumber;t.notesList.value=e,t.startValueTextBox.value=r}},this.onInsertFootnoteClick=function(){var e=new s.a(void 0);if(!i.i(r.isNullOrUndefined)(t.notesList)){var n=t.notesList.value.toString(),o=t.types(n),a=t.startValueTextBox.value;i.i(r.isNullOrUndefined)(t.notesList)||(t.documentHelper.selection.isinFootnote?(e.footNoteNumberFormat=o,e.initialFootNoteNumber=a,t.documentHelper.owner.editorModule.onApplySectionFormat(void 0,e)):(e.endnoteNumberFormat=o,e.initialEndNoteNumber=a,t.documentHelper.owner.editorModule.onApplySectionFormat(void 0,e)))}t.documentHelper.hideDialog()},this.unWireEventsAndBindings=function(){t.notesList.value=void 0},this.documentHelper=e}return e.prototype.getModuleName=function(){return"FootNotesDialog"},e.prototype.notesDialog=function(e,t){var s=this.documentHelper.owner.containerId+"_insert_Footnote";this.target=i.i(r.createElement)("div",{id:s,className:"e-de-insert-footnote"});var a=i.i(r.createElement)("div"),l=i.i(r.createElement)("div");this.footCount=i.i(r.createElement)("input",{attrs:{type:"text"},id:this.documentHelper.owner.containerId+"row"}),l.appendChild(this.footCount);var d=i.i(r.createElement)("div",{className:"e-de-container-row"}),h=i.i(r.createElement)("select",{id:this.target.id+"_papersize",styles:"padding-bottom: 20px;",innerHTML:'<option value="1, 2, 3, ...">'+e.getConstant("1, 2, 3, ...")+'</option><option value="a, b, c, ...">'+e.getConstant("a, b, c, ...")+'</option><option value="A, B, C, ...">'+e.getConstant("A, B, C, ...")+'</option><option value="I, II, III, ...">'+e.getConstant("I, II, III, ...")+'</option><option value="i, ii, iii, ...">'+e.getConstant("i, ii, iii, ...")+"</option>"});d.appendChild(h),this.notesList=new o.DropDownList({enableRtl:t,placeholder:e.getConstant("Start at"),floatLabelType:"Always",htmlAttributes:{"aria-labelledby":e.getConstant("Start at")}}),this.notesList.appendTo(h),a.appendChild(d),a.appendChild(l),this.target.appendChild(a),this.startValueTextBox=new n.NumericTextBox({format:"#",min:1,max:99999,enablePersistence:!1,placeholder:e.getConstant("Number format"),floatLabelType:"Always"}),this.startValueTextBox.appendTo(this.footCount),this.footCount.setAttribute("aria-labelledby",e.getConstant("Number format"))},e.prototype.show=function(){var e=new r.L10n("documenteditor",this.documentHelper.owner.defaultLocale);if(e.setLocale(this.documentHelper.owner.locale),this.target||this.notesDialog(e),"none"!==this.documentHelper.selection.caret.style.display&&(this.documentHelper.selection.caret.style.display="none"),this.documentHelper.selection.isinFootnote?this.documentHelper.dialog.header=e.getConstant("Footnote"):this.documentHelper.dialog.header=e.getConstant("Endnote"),this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=this.loadFontDialog,this.documentHelper.dialog.buttons=[{click:this.onInsertFootnoteClick,buttonModel:{content:e.getConstant("Apply"),cssClass:"e-flat e-table-ok",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-table-cancel"}}],this.startValueTextBox.value=1,this.documentHelper.dialog.close=this.documentHelper.updateFocus,this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show(),this.documentHelper.selection.isinEndnote){var t=this.endnoteListValue(this.list);this.notesList.index=t}},e.prototype.types=function(e){switch(e){case"1, 2, 3, ...":return"Arabic";case"A, B, C, ...":return"UpperCaseLetter";case"a, b, c, ...":return"LowerCaseLetter";case"I, II, III, ...":return"LowerCaseRoman";case"i, ii, iii, ...":return"UpperCaseRoman";default:return"Arabic"}},e.prototype.reversetype=function(e){switch(e){case"Arabic":return"1, 2, 3, ...";case"UpperCaseLetter":return"A, B, C, ...";case"LowerCaseLetter":return"a, b, c, ...";case"UpperCaseRoman":return"I, II, III, ...";case"LowerCaseRoman":return"i, ii, iii, ...";default:return"1, 2, 3, ..."}},e.prototype.endnoteListValue=function(e){return"A, B, C, ..."===e?0:"1, 2, 3, ..."===e?1:"a, b, c, ..."===e?2:3},e.prototype.destroy=function(){this.footCount&&(this.footCount.parentElement&&this.footCount.parentElement.removeChild(this.footCount),this.footCount=void 0),this.startValueTextBox&&(this.startValueTextBox.destroy(),this.startValueTextBox=void 0),this.notesList&&(this.notesList.destroy(),this.notesList=void 0),this.footCount=void 0,this.documentHelper=void 0},e}()},function(e,t,i){"use strict";i.d(t,"a",function(){return c});var n=i(5),r=(i.n(n),i(0)),o=(i.n(r),i(10)),s=(i.n(o),i(3)),a=(i.n(s),i(9)),l=i(15),d=(i.n(l),i(4)),h=i(8),c=(i.n(h),function(){function e(e){var t=this;this.isPortrait=!0,this.loadPageSetupDialog=function(){t.documentHelper.updateFocus();var e=t.documentHelper.selection.sectionFormat;t.topMarginBox.value=e.topMargin,t.leftMarginBox.value=e.leftMargin,t.bottomMarginBox.value=e.bottomMargin,t.rightMarginBox.value=e.rightMargin,t.widthBox.value=e.pageWidth,t.heightBox.value=e.pageHeight,t.checkBox1.checked=e.differentOddAndEvenPages,t.checkBox2.checked=e.differentFirstPage,t.headerBox.value=e.headerDistance,t.footerBox.value=e.footerDistance,t.widthBox.value>t.heightBox.value?t.landscape.checked=!0:t.portrait.checked=!0,t.setPageSize(t.portrait.checked,parseFloat(e.pageWidth.toFixed(1)),parseFloat(e.pageHeight.toFixed(1)))},this.closePageSetupDialog=function(){t.unWireEventsAndBindings(),t.documentHelper.updateFocus()},this.onCancelButtonClick=function(){t.documentHelper.dialog.hide(),t.unWireEventsAndBindings(),t.documentHelper.updateFocus()},this.keyUpInsertPageSettings=function(e){13===e.keyCode&&t.applyPageSetupProperties()},this.applyPageSetupProperties=function(){var e=new a.i,n=new r.L10n("documenteditor",t.documentHelper.owner.defaultLocale);n.setLocale(t.documentHelper.owner.locale);var o=t.documentHelper.selection.sectionFormat;if(e.bottomMargin=t.bottomMarginBox.value,e.topMargin=t.topMarginBox.value,e.leftMargin=t.leftMarginBox.value,e.rightMargin=t.rightMarginBox.value,e.pageWidth=t.widthBox.value,e.pageHeight=t.heightBox.value,e.differentOddAndEvenPages=t.checkBox1.checked,e.differentFirstPage=t.checkBox2.checked,e.headerDistance=t.headerBox.value,e.footerDistance=t.footerBox.value,t.widthBox.value<t.leftMarginBox.value+t.rightMarginBox.value)return void h.DialogUtility.alert(n.getConstant("Left and right margins."));if(t.widthBox.value<t.leftMarginBox.value+t.rightMarginBox.value+36)return void h.DialogUtility.alert(n.getConstant("Column width cannot be less than 36 pt."));if(Math.abs(t.topMarginBox.value+t.bottomMarginBox.value)>t.heightBox.value)return void h.DialogUtility.alert(n.getConstant("The top/bottom margins are too large for the page height in some sections."));e.numberOfColumns=o.numberOfColumns,e.equalWidth=o.equalWidth,e.lineBetweenColumns=o.lineBetweenColumns;for(var s=[],l=d.a.convertPointToPixel(e.pageWidth-e.leftMargin-e.rightMargin),c=0;c<o.columns.length;c++){var p=new a.j,u=d.a.convertPointToPixel(o.columns[parseInt(c.toString(),10)].width),g=d.a.convertPointToPixel(o.columns[parseInt(c.toString(),10)].space),f=(o.numberOfColumns-1)*g;!o.equalWidth&&0!==u||i.i(r.isNullOrUndefined)(l)||(u=(l-f)/o.numberOfColumns),p.width=u,p.space=g,p.index=c,s.push(p)}e.columns=s,o.pageHeight===e.pageHeight&&o.pageWidth===e.pageWidth&&(e.breakCode=o.breakCode),t.documentHelper.owner.editorModule.onApplySectionFormat(void 0,e),t.documentHelper.hideDialog()},this.changeByPaperSize=function(e){var i=e.value;t.documentHelper.selection.sectionFormat.pageWidth>t.documentHelper.selection.sectionFormat.pageHeight||t.landscape.checked?(t.isPortrait=!1,t.portrait.checked=!1):t.isPortrait=!0,"letter"===i?t.isPortrait?(t.widthBox.value=612,t.heightBox.value=792):(t.widthBox.value=792,t.heightBox.value=612):"tabloid"===i?t.isPortrait?(t.widthBox.value=792,t.heightBox.value=1224):(t.widthBox.value=1224,t.heightBox.value=792):"legal"===i?t.isPortrait?(t.widthBox.value=612,t.heightBox.value=1008):(t.widthBox.value=1008,t.heightBox.value=612):"statement"===i?t.isPortrait?(t.widthBox.value=392,t.heightBox.value=612):(t.widthBox.value=612,t.heightBox.value=392):"executive"===i?t.isPortrait?(t.widthBox.value=522,t.heightBox.value=756):(t.widthBox.value=756,t.heightBox.value=522):"a3"===i?t.isPortrait?(t.widthBox.value=841.9,t.heightBox.value=1190.55):(t.widthBox.value=1190.55,t.heightBox.value=841.9):"a4"===i?t.isPortrait?(t.widthBox.value=595.3,t.heightBox.value=841.9):(t.widthBox.value=841.9,t.heightBox.value=595.3):"a5"===i?t.isPortrait?(t.widthBox.value=419.55,t.heightBox.value=595.3):(t.widthBox.value=595.3,t.heightBox.value=419.55):"b4"===i?t.isPortrait?(t.widthBox.value=728.5,t.heightBox.value=1031.8):(t.widthBox.value=1031.8,t.heightBox.value=728.5):"b5"===i?t.isPortrait?(t.widthBox.value=515.9,t.heightBox.value=728.5):(t.widthBox.value=728.5,t.heightBox.value=515.9):"customsize"===i&&(t.isPortrait,t.widthBox.value=t.documentHelper.selection.sectionFormat.pageWidth,t.heightBox.value=t.documentHelper.selection.sectionFormat.pageHeight)},this.onPortrait=function(){t.landscape.checked=!1;var e=t.widthBox.value,i=t.heightBox.value;e>i&&(t.widthBox.value=i,t.heightBox.value=e)},this.onLandscape=function(){t.portrait.checked=!1;var e=t.widthBox.value,i=t.heightBox.value;e<i&&(t.widthBox.value=i,t.heightBox.value=e)},this.unWireEventsAndBindings=function(){t.paperSize.value=void 0,t.topMarginBox.value=void 0,t.bottomMarginBox.value=void 0,t.leftMarginBox.value=void 0,t.rightMarginBox.value=void 0,t.headerBox.value=void 0,t.footerBox.value=void 0,t.widthBox.value=void 0,t.heightBox.value=void 0,t.checkBox1.checked=!1,t.checkBox2.checked=!1,t.portrait.checked=!1,t.landscape.checked=!1},this.documentHelper=e}return e.prototype.getModuleName=function(){return"PageSetupDialog"},e.prototype.initPageSetupDialog=function(e,t){this.target=i.i(r.createElement)("div");var n=i.i(r.createElement)("div");this.target.appendChild(n),this.marginTab=i.i(r.createElement)("div",{styles:"position: relative;",className:"e-de-dlg-tab-first-child"}),this.paperTab=i.i(r.createElement)("div",{styles:"position: relative;",className:"e-de-dlg-tab-first-child"}),this.layoutTab=i.i(r.createElement)("div",{styles:"position: relative;",className:"e-de-dlg-tab-first-child"});var o=i.i(r.createElement)("div",{className:"e-de-page-setup-ppty-tab"}),s=i.i(r.createElement)("div",{className:"e-tab-header"}),a=i.i(r.createElement)("div",{innerHTML:e.getConstant("Margin")}),d=i.i(r.createElement)("div",{innerHTML:e.getConstant("Paper")}),h=i.i(r.createElement)("div",{innerHTML:e.getConstant("Layout")});s.appendChild(a),s.appendChild(d),s.appendChild(h);var c=i.i(r.createElement)("div"),p=i.i(r.createElement)("div"),u=i.i(r.createElement)("div");c.appendChild(this.marginTab),p.appendChild(this.paperTab),u.appendChild(this.layoutTab),n.appendChild(o),this.initMarginProperties(this.marginTab,e,t),this.initPaperSizeProperties(this.paperTab,e,t),this.initLayoutProperties(this.layoutTab,e,t);var g=[{header:{text:a},content:c},{header:{text:d},content:p},{header:{text:h},content:u}];new l.Tab({items:g,enableRtl:t},o).isStringTemplate=!0,this.target.addEventListener("keyup",this.keyUpInsertPageSettings)},e.prototype.initMarginProperties=function(e,t,o){var a=i.i(r.createElement)("div"),l=i.i(r.createElement)("div",{className:"e-de-container-row"});a.appendChild(l);var d=i.i(r.createElement)("div",{className:"e-de-container-row"});a.appendChild(d),o&&(l.classList.add("e-de-rtl"),d.classList.add("e-de-rtl"));var h=i.i(r.createElement)("input",{attrs:{type:"text"}}),c=i.i(r.createElement)("input",{attrs:{type:"text"}}),p=i.i(r.createElement)("div",{className:"e-de-subcontainer-left"});p.appendChild(h),l.appendChild(p);var u=i.i(r.createElement)("div",{className:"e-de-subcontainer-right"});u.appendChild(c),l.appendChild(u);var g=i.i(r.createElement)("input",{attrs:{type:"text"},id:this.target.id+"_left"}),f=i.i(r.createElement)("input",{attrs:{type:"text"}}),m=i.i(r.createElement)("div",{className:"e-de-subcontainer-left"});m.appendChild(g),d.appendChild(m);var v=i.i(r.createElement)("div",{className:"e-de-subcontainer-right"});v.appendChild(f),d.appendChild(v),e.appendChild(a),this.topMarginBox=new n.NumericTextBox({value:71,max:1584,min:-1584,width:170,decimals:2,floatLabelType:"Always",placeholder:t.getConstant("Top")}),this.topMarginBox.appendTo(h),this.leftMarginBox=new n.NumericTextBox({value:73,max:1584,min:0,width:170,decimals:2,floatLabelType:"Always",placeholder:t.getConstant("Left")}),this.leftMarginBox.appendTo(g),this.bottomMarginBox=new n.NumericTextBox({value:72,max:1584,min:-1584,width:170,decimals:2,floatLabelType:"Always",placeholder:t.getConstant("Bottom")}),this.bottomMarginBox.appendTo(c),this.rightMarginBox=new n.NumericTextBox({value:74,max:1584,min:0,width:170,decimals:2,floatLabelType:"Always",placeholder:t.getConstant("Right")}),this.rightMarginBox.appendTo(f);var y=i.i(r.createElement)("div"),w=i.i(r.createElement)("div",{className:"e-de-para-dlg-heading",innerHTML:t.getConstant("Orientation")}),b=i.i(r.createElement)("div",{styles:"display: flex;"});h.setAttribute("aria-labelledby",t.getConstant("Top")),c.setAttribute("aria-labelledby",t.getConstant("Bottom")),g.setAttribute("aria-labelledby",t.getConstant("Left")),f.setAttribute("aria-labelledby",t.getConstant("Right"));var x;x=o?"padding-left: 30px;":"padding-right: 30px;";var C=i.i(r.createElement)("div",{id:"_portraitDiv",styles:x}),I=i.i(r.createElement)("input",{attrs:{type:"radiobutton"}}),F=i.i(r.createElement)("div",{id:"_landscapeDiv"}),k=i.i(r.createElement)("input",{attrs:{type:"radiobutton"}});C.appendChild(I),F.appendChild(k),b.appendChild(C),b.appendChild(F),y.appendChild(w),y.appendChild(b),this.portrait=new s.RadioButton({label:t.getConstant("Portrait"),checked:!0,enableRtl:o,change:this.onPortrait}),this.landscape=new s.RadioButton({label:t.getConstant("Landscape"),enableRtl:o,change:this.onLandscape}),this.portrait.appendTo(I),this.landscape.appendTo(k),e.appendChild(y),I.setAttribute("aria-label",t.getConstant("Portrait")),k.setAttribute("aria-label",t.getConstant("Landscape"))},e.prototype.initPaperSizeProperties=function(e,t,s){var a=i.i(r.createElement)("div",{className:"e-de-container-row"}),l=i.i(r.createElement)("div",{className:"e-de-subcontainer-left"});a.appendChild(l);var d=i.i(r.createElement)("div",{className:"e-de-subcontainer-right"});a.appendChild(d),s&&(l.classList.add("e-de-rtl"),d.classList.add("e-de-rtl"));var h=i.i(r.createElement)("input",{attrs:{type:"text"}});l.appendChild(h);var c=i.i(r.createElement)("input",{attrs:{type:"text"}});d.appendChild(c),e.appendChild(a),this.widthBox=new n.NumericTextBox({value:612,width:170,decimals:2,floatLabelType:"Always",placeholder:t.getConstant("Width")}),this.widthBox.appendTo(h),this.heightBox=new n.NumericTextBox({value:792,width:170,decimals:2,floatLabelType:"Always",placeholder:t.getConstant("Height")}),this.heightBox.appendTo(c),h.setAttribute("arial-label",t.getConstant("Width")),c.setAttribute("arial-label",t.getConstant("Height"));var p=i.i(r.createElement)("div"),u=i.i(r.createElement)("select",{styles:"width:170px;padding-bottom: 20px;",innerHTML:'<option value="letter">'+t.getConstant("Letter")+'</option><option value="tabloid">'+t.getConstant("Tabloid")+'</option><option value="legal">'+t.getConstant("Legal")+'</option><option value="statement">'+t.getConstant("Statement")+'</option><option value="executive">'+t.getConstant("Executive")+'</option><option value="a3">'+t.getConstant("A3")+'</option><option value="a4">'+t.getConstant("A4")+'</option><option value="a5">'+t.getConstant("A5")+'</option><option value="b4">'+t.getConstant("B4")+'</option><option value="b5">'+t.getConstant("B5")+'</option><option value="customsize">'+t.getConstant("Custom Size")+"</option>"});p.appendChild(u),this.paperSize=new o.DropDownList({change:this.changeByPaperSize,width:"170px",enableRtl:s}),this.paperSize.appendTo(u),this.paperSize.htmlAttributes={"aria-labelledby":"PaperSize","aria-describedby":"PaperSize"},e.appendChild(p)},e.prototype.initLayoutProperties=function(e,t,o){var a=i.i(r.createElement)("div",{className:"e-de-dlg-container"}),l=i.i(r.createElement)("div",{styles:"height: 27px;"}),d=i.i(r.createElement)("input",{attrs:{type:"checkbox"}});l.appendChild(d);var h=i.i(r.createElement)("div",{styles:"height: 27px;"}),c=i.i(r.createElement)("input",{attrs:{type:"checkbox"}});l.setAttribute("aria-label",t.getConstant("Different first page")),h.setAttribute("aria-label",t.getConstant("Different odd and even")),h.appendChild(c),a.appendChild(l),a.appendChild(h),this.checkBox1=new s.CheckBox({label:t.getConstant("Different odd and even"),enableRtl:o}),this.checkBox2=new s.CheckBox({label:t.getConstant("Different first page"),enableRtl:o}),this.checkBox1.appendTo(d),this.checkBox2.appendTo(c),e.appendChild(a);var p=i.i(r.createElement)("div"),u=i.i(r.createElement)("label",{className:"e-de-para-dlg-heading",innerHTML:t.getConstant("From edge")});p.appendChild(u),e.appendChild(p);var g=i.i(r.createElement)("div",{className:"e-de-dlg-row"}),f=i.i(r.createElement)("div",{className:"e-de-subcontainer-left"});g.appendChild(f);var m=i.i(r.createElement)("div",{className:"e-de-subcontainer-right"});g.appendChild(m),o&&(m.classList.add("e-de-rtl"),f.classList.add("e-de-rtl"));var v=i.i(r.createElement)("input",{attrs:{type:"text"}});f.appendChild(v);var y=i.i(r.createElement)("input",{attrs:{type:"text"}});m.appendChild(y),e.appendChild(g),this.headerBox=new n.NumericTextBox({value:612,width:170,decimals:2,floatLabelType:"Always",placeholder:t.getConstant("Header")}),this.headerBox.appendTo(v),this.footerBox=new n.NumericTextBox({value:792,width:170,decimals:2,floatLabelType:"Always",placeholder:t.getConstant("Footer")}),this.footerBox.appendTo(y),v.setAttribute("aria-labelledby",t.getConstant("Header")),y.setAttribute("aria-labelledby",t.getConstant("Footer"))},e.prototype.show=function(){var e=new r.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),this.target||this.initPageSetupDialog(e,this.documentHelper.owner.enableRtl),this.documentHelper.dialog.header=e.getConstant("Page Setup"),this.documentHelper.dialog.width="auto",this.documentHelper.dialog.height="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=this.loadPageSetupDialog,this.documentHelper.dialog.close=this.closePageSetupDialog,this.documentHelper.dialog.buttons=[{click:this.applyPageSetupProperties,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-layout-ppty-okay",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-layout-ppty-cancel"}}],this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show();var t=this.documentHelper.dialog.element;t&&this.documentHelper.updateDialogTabHeight(t,this.target)},e.prototype.setPageSize=function(e,t,i){this.paperSize.value=e&&612===t&&792===i||!e&&792===t&&612===i?"letter":e&&792===t&&1224===i||!e&&1224===t&&792===i?"tabloid":e&&612===t&&1008===i||!e&&1008===t&&612===i?"legal":e&&392===t&&612===i||!e&&392===t&&612===i?"statement":e&&522===t&&756===i||!e&&756===t&&522===i?"executive":e&&841.9===t&&1190.5===i||!e&&1190.5===t&&841.9===i?"a3":e&&595.3===t&&841.9===i||!e&&841.9===t&&595.3===i?"a4":e&&419.6===t&&595.3===i||!e&&595.3===t&&419.6===i?"a5":e&&728.5===t&&1031.8===i||!e&&1031.8===t&&728.5===i?"b4":e&&515.9===t&&728.5===i||!e&&728.5===t&&515.9===i?"b5":"customsize"},e.prototype.destroy=function(){if(this.topMarginBox&&(this.topMarginBox.destroy(),this.topMarginBox=void 0),this.leftMarginBox&&(this.leftMarginBox.destroy(),this.leftMarginBox=void 0),this.bottomMarginBox&&(this.bottomMarginBox.destroy(),this.bottomMarginBox=void 0),this.rightMarginBox&&(this.rightMarginBox.destroy(),this.rightMarginBox=void 0),this.headerBox&&(this.headerBox.destroy(),this.headerBox=void 0),this.footerBox&&(this.footerBox.destroy(),this.footerBox=void 0),this.widthBox&&(this.widthBox.destroy(),this.widthBox=void 0),this.heightBox&&(this.heightBox.destroy(),this.heightBox=void 0),this.paperSize&&(this.paperSize.destroy(),this.paperSize=void 0),this.checkBox1&&(this.checkBox1.destroy(),this.checkBox1=void 0),this.checkBox2&&(this.checkBox2.destroy(),this.checkBox2=void 0),this.portrait&&(this.portrait.destroy(),this.portrait=void 0),this.landscape&&(this.landscape.destroy(),this.landscape=void 0),this.documentHelper=void 0,!i.i(r.isNullOrUndefined)(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[parseInt(e.toString(),10)]),e--;this.target=void 0}},e}())},function(e,t,i){"use strict";i.d(t,"a",function(){return d});var n=i(5),r=(i.n(n),i(0)),o=(i.n(r),i(10)),s=(i.n(o),i(7)),a=i(3),l=(i.n(a),i(15)),d=(i.n(l),function(){function e(e){var t=this;this.leftIndent=void 0,this.rightIndent=void 0,this.beforeSpacing=void 0,this.afterSpacing=void 0,this.spaceBeforeAuto=!1,this.spaceAfterAuto=!1,this.textAlignment=void 0,this.firstLineIndent=void 0,this.lineSpacingIn=void 0,this.lineSpacingType=void 0,this.paragraphFormat=void 0,this.bidi=void 0,this.contextualSpacing=void 0,this.isStyleDialog=!1,this.directionDiv=void 0,this.keepWithNextValue=void 0,this.keepLineTogetherValue=void 0,this.widowControlValue=void 0,this.tabObj=void 0,this.keyUpParagraphSettings=function(e){13===e.keyCode&&t.applyParagraphFormat()},this.changeBeforeSpacing=function(e){var i=new r.L10n("documenteditor",t.documentHelper.owner.defaultLocale);i.setLocale(t.documentHelper.owner.locale),-1===e.value?(t.beforeSpacingIn.element.value=i.getConstant("Auto"),t.beforeSpacingIn.step=1,t.spaceBeforeAuto=!0,t.beforeSpacing=5):(t.beforeSpacing=e.value,t.beforeSpacingIn.step=6,t.spaceBeforeAuto=!1)},this.focusBeforeSpacing=function(e){var i=new r.L10n("documenteditor",t.documentHelper.owner.defaultLocale);i.setLocale(t.documentHelper.owner.locale),-1===e.value&&(t.beforeSpacingIn.element.value=i.getConstant("Auto"))},this.blurBeforeSpacing=function(e){var i=new r.L10n("documenteditor",t.documentHelper.owner.defaultLocale);if(i.setLocale(t.documentHelper.owner.locale),-1===e.value){var n=t.beforeSpacingIn;setTimeout(function(){n.element.value=i.getConstant("Auto")},0)}},this.clickBeforeSpacing=function(){var e=new r.L10n("documenteditor",t.documentHelper.owner.defaultLocale);e.setLocale(t.documentHelper.owner.locale),"-1.0"===t.beforeSpacingIn.element.value&&(t.beforeSpacingIn.element.value=e.getConstant("Auto"))},this.changeAfterSpacing=function(e){var i=new r.L10n("documenteditor",t.documentHelper.owner.defaultLocale);i.setLocale(t.documentHelper.owner.locale),-1===e.value?(t.afterSpacingIn.element.value=i.getConstant("Auto"),t.afterSpacingIn.step=1,t.spaceAfterAuto=!0,t.afterSpacing=5):(t.afterSpacing=e.value,t.afterSpacingIn.step=6,t.spaceAfterAuto=!1)},this.focusAfterSpacing=function(e){var i=new r.L10n("documenteditor",t.documentHelper.owner.defaultLocale);i.setLocale(t.documentHelper.owner.locale),-1===e.value&&(t.afterSpacingIn.element.value=i.getConstant("Auto"))},this.blurAfterSpacing=function(e){var i=new r.L10n("documenteditor",t.documentHelper.owner.defaultLocale);if(i.setLocale(t.documentHelper.owner.locale),-1===e.value){var n=t.afterSpacingIn;setTimeout(function(){n.element.value=i.getConstant("Auto")},0)}},this.clickAfterSpacing=function(){var e=new r.L10n("documenteditor",t.documentHelper.owner.defaultLocale);e.setLocale(t.documentHelper.owner.locale),"-1.0"===t.afterSpacingIn.element.value&&(t.afterSpacingIn.element.value=e.getConstant("Auto"))},this.changeLeftIndent=function(e){t.leftIndent=e.value},this.changeRightIndent=function(e){t.rightIndent=e.value},this.changeLineSpacingValue=function(e){t.lineSpacingIn=e.value},this.changeFirstLineIndent=function(e){t.firstLineIndent=e.value,2===t.special.index&&(t.firstLineIndent=-t.firstLineIndent,t.leftIndent=t.leftIndentIn.value+e.value)},this.changeByTextAlignment=function(e){t.textAlignment=e.value},this.changeBidirectional=function(e){"ltr"===e.value?(t.rtlButton.checked=!t.ltrButton.checked,t.bidi=!1):(t.ltrButton.checked=!t.rtlButton.checked,t.bidi=!0),t.changeAlignmentByBidi()},this.changeContextualSpacing=function(e){t.contextualSpacing=e.checked},this.changeKeepWithNext=function(e){t.keepWithNextValue=e.checked},this.changeKeepLinesTogether=function(e){t.keepLineTogetherValue=e.checked},this.changeWidowControl=function(e){t.widowControlValue=e.checked},this.changeByValue=function(){var e=t.documentHelper.selection.paragraphFormat;switch(t.special.index){case 0:0!==e.firstLineIndent&&(t.byIn.value=0,t.leftIndent=t.leftIndentIn.value);break;case 1:0===e.firstLineIndent||i.i(r.isNullOrUndefined)(e.firstLineIndent)?t.byIn.value=.1:e.firstLineIndent<0&&(t.byIn.value=-e.firstLineIndent,Math.abs(e.firstLineIndent)<=t.leftIndent&&(t.leftIndent=e.firstLineIndent+t.leftIndent));break;case 2:0===e.firstLineIndent||i.i(r.isNullOrUndefined)(e.firstLineIndent)?e.firstLineIndent=-.1:e.firstLineIndent>0&&(t.byIn.value=e.firstLineIndent,i.i(r.isNullOrUndefined)(t.leftIndent)?t.leftIndent=e.firstLineIndent:t.leftIndent=t.leftIndent+e.firstLineIndent)}},this.changeBySpacing=function(){if(!i.i(r.isNullOrUndefined)(t.lineSpacing))switch(t.lineSpacing.index){case 0:t.lineSpacingType="AtLeast",t.atIn.value=12;break;case 1:t.lineSpacingType="Exactly",t.atIn.value=12;break;case 2:t.lineSpacingType="Multiple",t.atIn.value=1}},this.loadParagraphDialog=function(){t.isStyleDialog?t.directionDiv.classList.add("e-de-disabledbutton"):t.directionDiv.classList.remove("e-de-disabledbutton");var e;e=t.paragraphFormat?t.paragraphFormat:t.documentHelper.selection.paragraphFormat;var n=t.getAlignmentValue(e.textAlignment);t.alignment.index=n,e.spaceBeforeAuto?t.beforeSpacingIn.value=-1:-1===e.beforeSpacing?t.beforeSpacingIn.value=void 0:t.beforeSpacingIn.value=e.beforeSpacing,e.spaceAfterAuto?t.afterSpacingIn.value=-1:-1===e.afterSpacing?t.afterSpacingIn.value=void 0:t.afterSpacingIn.value=e.afterSpacing,t.leftIndentIn.value=e.leftIndent,t.rightIndentIn.value=e.rightIndent,t.byIn.value=Math.abs(e.firstLineIndent);var o=t.lineSpacing.index;t.keepWithNextValue=void 0,t.keepLineTogetherValue=void 0,t.widowControlValue=void 0,e.firstLineIndent>0?t.special.index=1:e.firstLineIndent<0&&(t.special.index=2,t.leftIndentIn.value=e.leftIndent-t.byIn.value),o="AtLeast"===e.lineSpacingType?0:"Exactly"===e.lineSpacingType?1:2,t.lineSpacing.index=o,t.atIn.value=e.lineSpacing,"none"!==t.documentHelper.selection.caret.style.display&&(t.documentHelper.selection.caret.style.display="none"),e.bidi?(t.rtlButton.checked=!0,t.ltrButton.checked=!1):(t.ltrButton.checked=!0,t.rtlButton.checked=!1),i.i(r.isNullOrUndefined)(e.keepWithNext)?t.keepWithNext.indeterminate=!0:t.keepWithNext.checked=e.keepWithNext,i.i(r.isNullOrUndefined)(e.keepLinesTogether)?t.keepLinesTogether.indeterminate=!0:t.keepLinesTogether.checked=e.keepLinesTogether,i.i(r.isNullOrUndefined)(e.widowControl)?t.widowControlIn.indeterminate=!0:t.widowControlIn.checked=e.widowControl,t.contextSpacing.checked=e.contextualSpacing},this.applyParagraphFormat=function(){var e,n;if(t.paragraphFormat?(e=t.paragraphFormat,n=!1):(e=new s.F,e.borders=void 0,n=!0),i.i(r.isNullOrUndefined)(t.beforeSpacing)||(e.beforeSpacing=t.beforeSpacing),i.i(r.isNullOrUndefined)(t.afterSpacing)||(e.afterSpacing=t.afterSpacing),i.i(r.isNullOrUndefined)(t.spaceBeforeAuto)||(e.spaceBeforeAuto=t.spaceBeforeAuto),i.i(r.isNullOrUndefined)(t.spaceAfterAuto)||(e.spaceAfterAuto=t.spaceAfterAuto),i.i(r.isNullOrUndefined)(t.lineSpacingType)||(e.lineSpacingType=t.lineSpacingType),i.i(r.isNullOrUndefined)(t.leftIndent)||(e.leftIndent=t.leftIndent),i.i(r.isNullOrUndefined)(t.rightIndent)||(e.rightIndent=t.rightIndent),i.i(r.isNullOrUndefined)(t.lineSpacingIn)||(e.lineSpacing=t.lineSpacingIn),i.i(r.isNullOrUndefined)(t.firstLineIndent)||(e.firstLineIndent=Math.abs(t.firstLineIndent),2===t.special.index&&(e.firstLineIndent=-e.firstLineIndent,e.leftIndent=t.leftIndentIn.value+t.byIn.value)),i.i(r.isNullOrUndefined)(t.bidi)||(e.bidi=t.bidi),!i.i(r.isNullOrUndefined)(t.textAlignment)){var o=t.textAlignment;e.bidi&&("Right"===o?o="Left":"Left"===o&&(o="Right")),e.textAlignment=o}i.i(r.isNullOrUndefined)(t.contextualSpacing)||(e.contextualSpacing=t.contextualSpacing),i.i(r.isNullOrUndefined)(t.keepWithNextValue)?t.documentHelper.selection.paragraphFormat.keepWithNext&&(e.keepWithNext=t.documentHelper.selection.paragraphFormat.keepWithNext):e.keepWithNext=t.keepWithNextValue,i.i(r.isNullOrUndefined)(t.keepLineTogetherValue)?t.documentHelper.selection.paragraphFormat.keepLinesTogether&&(e.keepLinesTogether=t.documentHelper.selection.paragraphFormat.keepLinesTogether):e.keepLinesTogether=t.keepLineTogetherValue,i.i(r.isNullOrUndefined)(t.widowControlValue)?t.documentHelper.selection.paragraphFormat.widowControl&&(e.widowControl=t.documentHelper.selection.paragraphFormat.widowControl):e.widowControl=t.widowControlValue,n?t.onParagraphFormat(e):t.documentHelper.owner.styleDialogModule.updateParagraphFormat(),t.documentHelper.hideDialog()},this.openTabDialog=function(){t.documentHelper.hideDialog(),t.documentHelper.owner.tabDialogModule.show()},this.closeParagraphDialog=function(){t.leftIndent=void 0,t.afterSpacing=void 0,t.beforeSpacing=void 0,t.firstLineIndent=void 0,t.textAlignment=void 0,t.rightIndent=void 0,t.lineSpacingIn=void 0,t.lineSpacingType=void 0,t.paragraphFormat=void 0,t.documentHelper.hideDialog()},this.documentHelper=e}return Object.defineProperty(e.prototype,"owner",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"ParagraphDialog"},e.prototype.initParagraphDialog=function(e){var t=i.i(r.createElement)("div"),s=i.i(r.createElement)("div"),d=this,h=this.documentHelper.owner.containerId,c=i.i(r.createElement)("div",{className:"e-de-dlg-tab-first-child e-de-para-dlg-container"});this.target=t,t.appendChild(s);var p=i.i(r.createElement)("div",{styles:"width:400px;"}),u=i.i(r.createElement)("div"),g=i.i(r.createElement)("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("General")});u.appendChild(g);var f=i.i(r.createElement)("div",{className:"e-de-container-row"});u.appendChild(f);var m=i.i(r.createElement)("div",{className:"e-de-subcontainer-left"});f.appendChild(m);var v=i.i(r.createElement)("select",{id:h+"_Alignment",innerHTML:'<option value="Center">'+e.getConstant("Center")+'</option><option value="Left">'+e.getConstant("Left")+'</option><option value="Right">'+e.getConstant("Right")+'</option><option value="Justify">'+e.getConstant("Justify")+"</option>"});m.appendChild(v),m.setAttribute("aria-labelledby",v.innerText);var y=i.i(r.createElement)("div",{className:"e-de-dlg-sub-header",innerHTML:e.getConstant("Direction")});this.directionDiv=i.i(r.createElement)("div",{className:"e-de-container-row"});var w=i.i(r.createElement)("div",{className:"e-de-rtl-btn-div"}),b=i.i(r.createElement)("input",{id:h+"_rtlEle"});w.appendChild(b),this.directionDiv.appendChild(w);var x=this.documentHelper.owner.enableRtl;x&&w.classList.add("e-de-rtl");var C=i.i(r.createElement)("div",{className:"e-de-ltr-btn-div"}),I=i.i(r.createElement)("input",{id:h+"_ltrEle"});C.appendChild(I),this.directionDiv.appendChild(C),u.appendChild(y),u.appendChild(this.directionDiv),this.rtlButton=new a.RadioButton({label:e.getConstant("Right-to-left"),enableRtl:x,value:"rtl",cssClass:"e-small",change:this.changeBidirectional}),this.rtlButton.appendTo(b),b.setAttribute("aria-label",e.getConstant("Right-to-left")),this.ltrButton=new a.RadioButton({label:e.getConstant("Left-to-right"),enableRtl:x,value:"ltr",cssClass:"e-small",change:this.changeBidirectional}),this.ltrButton.appendTo(I),I.setAttribute("aria-label",e.getConstant("Left-to-right"));var F=i.i(r.createElement)("div"),k=i.i(r.createElement)("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Indentation")});F.appendChild(k);var P=i.i(r.createElement)("div",{className:"e-de-container-row"});F.appendChild(P);var T=i.i(r.createElement)("div",{className:"e-de-container-row"});F.appendChild(T);var S=i.i(r.createElement)("div",{className:"e-de-subcontainer-left"});P.appendChild(S);var W=i.i(r.createElement)("div",{className:"e-de-subcontainer-right"});P.appendChild(W);var N=i.i(r.createElement)("div",{className:"e-de-subcontainer-left"});T.appendChild(N);var H=i.i(r.createElement)("div",{className:"e-de-subcontainer-right"});T.appendChild(H);var E=i.i(r.createElement)("div"),O=i.i(r.createElement)("div");E.appendChild(O);var _=i.i(r.createElement)("div",{className:"e-de-container-row"});E.appendChild(_);var B=i.i(r.createElement)("div",{className:"e-de-container-row"});E.appendChild(B);var L=i.i(r.createElement)("input",{attrs:{type:"checkbox"},id:h+"_contextSpacing"});_.appendChild(L);var R=i.i(r.createElement)("input",{id:h+"_leftIndent",attrs:{type:"text"}}),A=i.i(r.createElement)("input",{id:h+"_rightIndent",attrs:{type:"text"}});S.appendChild(R),S.setAttribute("aria-labelledby",e.getConstant("Indent from left")),W.appendChild(A),W.setAttribute("aria-labelledby",e.getConstant("Indent from right"));var D=i.i(r.createElement)("select",{id:h+"_special",innerHTML:'<option value="None">'+e.getConstant("None")+'</option><option value="First Line">'+e.getConstant("First line")+'</option><option value="Hanging">'+e.getConstant("Hanging")+"</option> "}),U=i.i(r.createElement)("input",{id:h+"_By",attrs:{type:"text"}});N.setAttribute("aria-labelledby","Special"),N.appendChild(D),H.appendChild(U),H.setAttribute("aria-labelledby","By");var M=i.i(r.createElement)("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Spacing")}),V=i.i(r.createElement)("div",{className:"e-de-container-row"}),z=i.i(r.createElement)("div",{className:"e-de-subcontainer-left"}),j=i.i(r.createElement)("input",{id:h+"_beforeSpacing",attrs:{type:"text"}}),q=i.i(r.createElement)("div",{className:"e-de-subcontainer-right"}),G=i.i(r.createElement)("input",{id:h+"_afterSpacing",attrs:{type:"text"}});O.appendChild(M),O.appendChild(V),z.appendChild(j),V.appendChild(z),q.appendChild(G),V.appendChild(q);var K=i.i(r.createElement)("div",{className:"e-de-subcontainer-left"}),Z=i.i(r.createElement)("select",{id:h+"_lineSpacing",innerHTML:'<option value="At least">'+e.getConstant("At least")+'</option><option value="Exactly">'+e.getConstant("Exactly")+'</option><option value="Multiple">'+e.getConstant("Multiple")+"</option>"}),X=i.i(r.createElement)("div",{className:"e-de-subcontainer-right"}),J=i.i(r.createElement)("input",{id:h+"_lineSpacingAt",attrs:{type:"text"}});K.appendChild(Z),B.appendChild(K),X.appendChild(J),B.appendChild(X),p.appendChild(u),p.appendChild(F),p.appendChild(E),c.appendChild(p),this.leftIndentIn=new n.NumericTextBox({format:"n1",value:0,min:-1584,max:1584,enablePersistence:!1,floatLabelType:"Always",placeholder:e.getConstant("Before text"),change:this.changeLeftIndent}),this.leftIndentIn.appendTo(R),this.rightIndentIn=new n.NumericTextBox({format:"n1",value:0,min:-1584,max:1584,enablePersistence:!1,floatLabelType:"Always",placeholder:e.getConstant("After text"),change:this.changeRightIndent}),this.rightIndentIn.appendTo(A),this.byIn=new n.NumericTextBox({format:"n1",value:0,min:0,max:1584,enablePersistence:!1,floatLabelType:"Always",placeholder:e.getConstant("By"),change:this.changeFirstLineIndent}),this.byIn.appendTo(U),this.beforeSpacingIn=new n.NumericTextBox({format:"n1",value:0,min:-1,max:1584,step:6,enablePersistence:!1,floatLabelType:"Always",placeholder:e.getConstant("Before"),change:this.changeBeforeSpacing,focus:this.focusBeforeSpacing,blur:this.blurBeforeSpacing}),this.beforeSpacingIn.appendTo(j),z.getElementsByClassName("e-input-group-icon e-spin-down")[0].addEventListener("click",this.clickBeforeSpacing),this.afterSpacingIn=new n.NumericTextBox({format:"n1",value:0,min:-1,max:1584,step:6,enablePersistence:!1,floatLabelType:"Always",placeholder:e.getConstant("After"),change:this.changeAfterSpacing,focus:this.focusAfterSpacing,blur:this.blurAfterSpacing}),this.afterSpacingIn.appendTo(G),q.getElementsByClassName("e-input-group-icon e-spin-down")[0].addEventListener("click",this.clickAfterSpacing),this.atIn=new n.NumericTextBox({format:"n1",value:0,min:1,max:1584,step:.5,enablePersistence:!1,floatLabelType:"Always",placeholder:e.getConstant("At"),change:this.changeLineSpacingValue}),this.special=new o.DropDownList({change:this.changeByValue,enableRtl:x,floatLabelType:"Always",placeholder:e.getConstant("Special")}),this.special.appendTo(D),this.lineSpacing=new o.DropDownList({change:this.changeBySpacing,enableRtl:x,floatLabelType:"Always",placeholder:e.getConstant("Line Spacing"),htmlAttributes:{"aria-labelledby":e.getConstant("Line Spacing")}}),this.lineSpacing.appendTo(Z),this.alignment=new o.DropDownList({change:this.changeByTextAlignment,enableRtl:x,floatLabelType:"Always",placeholder:e.getConstant("Alignment"),htmlAttributes:{"aria-labelledby":e.getConstant("Alignment")}}),this.alignment.appendTo(v),this.atIn.appendTo(J),this.contextSpacing=new a.CheckBox({change:this.changeContextualSpacing,label:e.getConstant("Contextual Spacing"),enableRtl:x}),this.contextSpacing.appendTo(L),L.setAttribute("aria-labelledby",e.getConstant("Contextual Spacing")),c.addEventListener("keyup",d.keyUpParagraphSettings),x&&(q.classList.add("e-de-rtl"),X.classList.add("e-de-rtl"));var Y=i.i(r.createElement)("div",{className:"e-de-dlg-tab-first-child"}),Q=i.i(r.createElement)("div",{className:"e-de-para-dlg-sub-container"});this.paginationDiv=Q;var $=i.i(r.createElement)("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Pagination")});Q.appendChild($);var ee=i.i(r.createElement)("div",{styles:"display:block"});Q.appendChild(ee);var te=i.i(r.createElement)("div",{styles:"display:block"});Q.appendChild(te);var ie=i.i(r.createElement)("div",{styles:"display:block"});Q.appendChild(ie);var ne=i.i(r.createElement)("input",{attrs:{type:"checkbox"}});te.appendChild(ne),this.keepWithNext=new a.CheckBox({change:this.changeKeepWithNext,label:e.getConstant("Keep With Next"),enableRtl:x,cssClass:"e-de-para-dlg-cs-check-box"}),this.keepWithNext.appendTo(ne),ne.setAttribute("aria-label",e.getConstant("Keep With Next"));var re=i.i(r.createElement)("input",{attrs:{type:"checkbox"}});ie.appendChild(re),this.keepLinesTogether=new a.CheckBox({change:this.changeKeepLinesTogether,label:e.getConstant("Keep Lines Together"),enableRtl:x,cssClass:"e-de-para-dlg-cs-check-box"}),this.keepLinesTogether.appendTo(re),re.setAttribute("aria-label",e.getConstant("Keep Lines Together"));var oe=i.i(r.createElement)("input",{attrs:{type:"checkbox"}});ee.appendChild(oe),this.widowControlIn=new a.CheckBox({change:this.changeWidowControl,label:e.getConstant("WidowControl"),enableRtl:x,cssClass:"e-de-para-dlg-cs-check-box"}),this.widowControlIn.appendTo(oe),oe.setAttribute("aria-label",e.getConstant("WidowControl")),Y.appendChild(Q);var se=[{header:{text:e.getConstant("Indents and Spacing")},content:c},{header:{text:e.getConstant("Line and Page Breaks")},content:Y}];this.tabObj=new l.Tab({items:se,enableRtl:x,animation:{previous:{effect:"None"},next:{effect:"None"}}},s),this.tabObj.isStringTemplate=!0},e.prototype.changeAlignmentByBidi=function(){"Left"===this.textAlignment?this.textAlignment="Right":"Right"===this.textAlignment&&(this.textAlignment="Left"),i.i(r.isNullOrUndefined)(this.textAlignment)?0===this.alignment.index?this.textAlignment="Center":this.textAlignment="Justify":this.alignment.index=this.getAlignmentValue(this.textAlignment)},e.prototype.getAlignmentValue=function(e){return"Center"===e?0:"Left"===e?1:"Right"===e?2:3},e.prototype.onParagraphFormat=function(e){var t=this.documentHelper.selection,i=e.bidi&&-1!==t.paragraphFormat.listId;i||(this.documentHelper.layout.isBidiReLayout=!0),this.documentHelper.owner.editor.setPreviousBlockToLayout(),this.documentHelper.owner.editorModule.initHistory("ParagraphFormat"),this.documentHelper.owner.isShiftingEnabled=!0,this.documentHelper.selection.isEmpty?(this.documentHelper.owner.editorModule.applyParaFormatProperty(t.start.paragraph,void 0,e,!1),this.documentHelper.owner.editor.layoutItemBlock(t.start.paragraph,!1)):this.documentHelper.owner.editorModule.updateSelectionParagraphFormatting("ParagraphFormat",e,!1),this.documentHelper.owner.editorModule.reLayout(t),i||(this.documentHelper.layout.isBidiReLayout=!1)},e.prototype.show=function(e){e?(this.isStyleDialog=!0,this.paragraphFormat=e):this.isStyleDialog=!1;var t=new r.L10n("documenteditor",this.documentHelper.owner.defaultLocale);t.setLocale(this.documentHelper.owner.locale),this.target||this.initParagraphDialog(t),this.loadParagraphDialog(),this.documentHelper.dialog.header=t.getConstant("Paragraph"),this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.buttons=[{click:this.openTabDialog,buttonModel:{content:t.getConstant("Tabs")+"....",cssClass:"e-flat e-de-para-tab",enableRtl:this.documentHelper.owner.enableRtl}},{click:this.applyParagraphFormat,buttonModel:{content:t.getConstant("Ok"),cssClass:"e-flat e-para-okay",isPrimary:!0}},{click:this.closeParagraphDialog,buttonModel:{content:t.getConstant("Cancel"),cssClass:"e-flat e-para-cancel"}}],this.documentHelper.dialog.beforeOpen=this.documentHelper.updateFocus,this.documentHelper.dialog.close=this.documentHelper.updateFocus,this.documentHelper.dialog.dataBind(),this.alignment.focusIn(),this.documentHelper.dialog.show();var i=this.documentHelper.dialog.element;if(i){var n=this.documentHelper.updateDialogTabHeight(i,this.target);this.paginationDiv.style.width=n.toString()+"px"}},e.prototype.destroy=function(){if(this.afterSpacingIn&&(this.afterSpacingIn.destroy(),this.afterSpacingIn=void 0),this.beforeSpacingIn&&(this.beforeSpacingIn.destroy(),this.beforeSpacingIn=void 0),this.leftIndentIn&&(this.leftIndentIn.destroy(),this.leftIndentIn=void 0),this.rightIndentIn&&(this.rightIndentIn.destroy(),this.rightIndentIn=void 0),this.byIn&&(this.byIn.destroy(),this.byIn=void 0),this.special&&(this.special.destroy(),this.special=void 0),this.atIn&&(this.atIn.destroy(),this.atIn=void 0),this.alignment&&(this.alignment.change=void 0,this.alignment.destroy()),this.alignment=void 0,this.lineSpacing&&(this.lineSpacing.change=void 0,this.lineSpacing.destroy()),this.lineSpacing=void 0,this.special&&(this.special.change=void 0,this.special.destroy()),this.special=void 0,!i.i(r.isNullOrUndefined)(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[parseInt(e.toString(),10)]),e--;this.target=void 0,this.paragraphFormat&&(this.paragraphFormat.destroy(),this.paragraphFormat=void 0),this.documentHelper=void 0}},e}())},function(e,t,i){"use strict";i.d(t,"a",function(){return u});var n=i(0),r=(i.n(n),i(10)),o=(i.n(r),i(3)),s=(i.n(o),i(22)),a=i(11),l=i(34),d=i(43),h=(i.n(d),i(14)),c=i(5),p=(i.n(c),i(19)),u=(i.n(p),function(){function e(e){var t=this;this.target=void 0,this.styleType=void 0,this.styleBasedOn=void 0,this.styleParagraph=void 0,this.onlyThisDocument=void 0,this.template=void 0,this.fontFamily=void 0,this.fontSize=void 0,this.characterFormat=void 0,this.paragraphFormat=void 0,this.openDialog=function(e){switch(e.item.id){case"style_font":t.showFontDialog();break;case"style_paragraph":t.showParagraphDialog();break;case"style_numbering":t.showNumberingBulletDialog()}},this.setBoldProperty=function(){t.characterFormat.bold=!t.characterFormat.bold,t.fontButtonClicked()},this.setItalicProperty=function(){t.characterFormat.italic=!t.characterFormat.italic,t.fontButtonClicked()},this.setUnderlineProperty=function(){t.characterFormat.underline="None"===t.characterFormat.underline?"Single":"None",t.fontButtonClicked()},this.fontButtonClicked=function(){t.characterFormat.bold?t.bold.classList.contains("e-active")||t.bold.classList.add("e-active"):t.bold.classList.contains("e-active")&&t.bold.classList.remove("e-active"),t.characterFormat.italic?t.italic.classList.contains("e-active")||t.italic.classList.add("e-active"):t.italic.classList.contains("e-active")&&t.italic.classList.remove("e-active"),void 0!==t.characterFormat.underline&&"None"!==t.characterFormat.underline?t.underline.classList.contains("e-active")||(t.underline.classList.add("e-active"),t.characterFormat.underline="Single"):t.underline.classList.contains("e-active")&&(t.underline.classList.remove("e-active"),t.characterFormat.underline="None")},this.fontSizeUpdate=function(e){t.characterFormat.fontSize=e.value},this.fontFamilyChanged=function(e){t.characterFormat.fontFamily=e.value.toString()},this.fontColorUpdate=function(e){t.characterFormat.fontColor=e.currentValue.hex},this.setLeftAlignment=function(){"Left"===t.paragraphFormat.textAlignment?t.paragraphFormat.textAlignment="Justify":t.paragraphFormat.textAlignment="Left",t.updateParagraphFormat()},this.setRightAlignment=function(){"Right"===t.paragraphFormat.textAlignment?t.paragraphFormat.textAlignment="Left":t.paragraphFormat.textAlignment="Right",t.updateParagraphFormat()},this.setCenterAlignment=function(){"Center"===t.paragraphFormat.textAlignment?t.paragraphFormat.textAlignment="Left":t.paragraphFormat.textAlignment="Center",t.updateParagraphFormat()},this.setJustifyAlignment=function(){"Justify"===t.paragraphFormat.textAlignment?t.paragraphFormat.textAlignment="Left":t.paragraphFormat.textAlignment="Justify",t.updateParagraphFormat()},this.increaseBeforeAfterSpacing=function(){t.paragraphFormat.beforeSpacing+=6,t.paragraphFormat.afterSpacing+=6},this.decreaseBeforeAfterSpacing=function(){t.paragraphFormat.beforeSpacing>=6?t.paragraphFormat.beforeSpacing-=6:t.paragraphFormat.beforeSpacing=0,t.paragraphFormat.afterSpacing>=6?t.paragraphFormat.afterSpacing-=6:t.paragraphFormat.afterSpacing=0},this.updateNextStyle=function(e){var r=e.srcElement.value;if(t.getTypeValue()===t.localObj.getConstant("Paragraph")&&!i.i(n.isNullOrUndefined)(r)&&""!==r&&!t.isUserNextParaUpdated){var o=t.documentHelper.styles.getStyleNames(t.getTypeValue());t.isEdit&&(o=o.filter(function(e){return e!==t.editStyleName})),o.push(r),t.styleParagraph.dataSource=o,t.styleParagraph.index=null,t.styleParagraph.index=o.indexOf(r)}},this.updateOkButton=function(){t.target.getElementsByClassName("e-input e-de-style-dlg-name-input").item(0).value;t.enableOrDisableOkButton()},this.styleTypeChange=function(e){if(e.isInteracted){var i=void 0;"Character"===e.value&&(t.style=new s.b,i="Character"),"Paragraph"!==e.value&&"Linked Style"!==e.value||(t.style=new s.a,i="Paragraph"),t.toggleDisable(),t.updateStyleNames(i)}},this.styleBasedOnChange=function(){},this.styleParagraphChange=function(e){e.isInteracted&&(t.isUserNextParaUpdated=!0)},this.showFontDialog=function(){i.i(n.isNullOrUndefined)(t.documentHelper.owner.fontDialogModule)||t.documentHelper.owner.showFontDialog(t.characterFormat),t.updateCharacterFormat()},this.showParagraphDialog=function(){i.i(n.isNullOrUndefined)(t.documentHelper.owner.paragraphDialogModule)||t.documentHelper.owner.showParagraphDialog(t.paragraphFormat)},this.showNumberingBulletDialog=function(){t.numberingBulletDialog=new l.c(t.documentHelper),t.style instanceof s.a&&!i.i(n.isNullOrUndefined)(t.style.paragraphFormat)&&t.numberingBulletDialog.showNumberBulletDialog(t.style.paragraphFormat.listFormat,t.abstractList)},this.onOkButtonClick=function(){var e=n.SanitizeHtmlHelper.sanitize(t.styleNameElement.value);if(!(e.length>0))throw new Error("Enter valid Style name");var r,o=t.documentHelper.styles.findByName(e);if(i.i(n.isNullOrUndefined)(o)){var l="Paragraph"===t.getTypeValue()?new s.a:new s.b;l.copyStyle(t.style),"Character"===t.getTypeValue()&&l.characterFormat.copyFormat(t.characterFormat);var d=t.documentHelper.styles.findByName(t.documentHelper.owner.stylesDialogModule.getStyleName(t.styleBasedOn.value));"Paragraph"!==t.styleType.value&&"Linked Style"!==t.styleType.value||(e===t.documentHelper.owner.stylesDialogModule.getStyleName(t.styleParagraph.value)?l.next=l:l.next=t.documentHelper.styles.findByName(t.documentHelper.owner.stylesDialogModule.getStyleName(t.styleParagraph.value)),t.updateList()),l.link="Linked Style"===t.styleType.value?t.createLinkStyle(e):void 0,l.type=t.getTypeValue(),l.name=e,l.basedOn=d,t.documentHelper.styles.push(l),t.documentHelper.addToStylesMap(l),r=e;var h=t.style instanceof s.a?t.style.paragraphFormat.listFormat.listId:-1;t.documentHelper.owner.getStyleData(r,h),t.documentHelper.owner.editor.isSkipOperationsBuild="Character"===t.styleType.value,t.documentHelper.owner.editorModule.applyStyle(r,!0),t.documentHelper.owner.editor.isSkipOperationsBuild=!1,t.documentHelper.owner.notify(a.v,{})}else{t.style.type=t.getTypeValue(),t.style.basedOn=t.documentHelper.styles.findByName(t.documentHelper.owner.stylesDialogModule.getStyleName(t.styleBasedOn.value)),"Paragraph"!==t.styleType.value&&"Linked Style"!==t.styleType.value||(t.style.next=t.documentHelper.styles.findByName(t.documentHelper.owner.stylesDialogModule.getStyleName(t.styleParagraph.value)),t.style.characterFormat.mergeFormat(o.characterFormat),t.style.paragraphFormat.mergeFormat(o.paragraphFormat,!0),t.updateList(),t.style.link="Linked Style"===t.styleType.value?t.createLinkStyle(e,t.isEdit):void 0),t.style.name=o.name,r=o.name,o=t.style,t.documentHelper.owner.isShiftingEnabled=!0,t.documentHelper.owner.editor.isSkipOperationsBuild=!0,t.documentHelper.owner.editorModule.layoutWholeDocument(),t.documentHelper.owner.editor.isSkipOperationsBuild=!1,t.documentHelper.owner.isShiftingEnabled=!1;var h=t.style instanceof s.a?t.style.paragraphFormat.listFormat.listId:-1;t.documentHelper.owner.getStyleData(r,h)}t.documentHelper.dialog2.hide(),t.documentHelper.updateFocus(),t.style,t.documentHelper.updateFocus()},this.loadStyleDialog=function(){t.documentHelper.updateFocus(),t.isUserNextParaUpdated=!1,t.styleNameElement=t.target.getElementsByClassName("e-input e-de-style-dlg-name-input").item(0),t.styleNameElement.value=null,t.isEdit||(t.styleType.index=0);var e;if(t.isEdit){var i=new n.L10n("documenteditor",t.documentHelper.owner.defaultLocale);i.setLocale(t.documentHelper.owner.locale);var r=i.getConstant(t.editStyleName);""===r&&(r=t.editStyleName),t.styleNameElement.value=r,e=t.editStyleName}t.okButton=t.documentHelper.dialog2.element.getElementsByClassName("e-flat e-style-okay").item(0),t.enableOrDisableOkButton(),t.updateStyleNames(t.getTypeValue(),e),t.updateCharacterFormat(t.style.characterFormat),t.updateParagraphFormat(t.style.paragraphFormat)},this.onCancelButtonClick=function(){!t.isEdit&&t.style&&t.style.destroy(),t.documentHelper.dialog2.hide(),t.documentHelper.updateFocus()},this.closeStyleDialog=function(){t.documentHelper.updateFocus()},this.documentHelper=e}return e.prototype.getModuleName=function(){return"StyleDialog"},e.prototype.initStyleDialog=function(e,t){this.localObj=e,this.target=i.i(n.createElement)("div",{className:"e-de-style-dialog"});var o=i.i(n.createElement)("div"),s=i.i(n.createElement)("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Properties")});o.appendChild(s);var a=i.i(n.createElement)("div",{className:"e-de-container-row"});o.appendChild(a);var l=i.i(n.createElement)("div",{className:"e-de-subcontainer-left"});a.appendChild(l);var d=i.i(n.createElement)("input",{className:"e-input e-de-style-dlg-name-input"});d.addEventListener("keyup",this.updateOkButton),d.addEventListener("input",this.updateOkButton),d.addEventListener("blur",this.updateNextStyle),l.appendChild(d),new c.TextBox({placeholder:e.getConstant("Name")+":",floatLabelType:"Always"},d);var h=i.i(n.createElement)("div",{className:"e-de-subcontainer-right"});a.appendChild(h);var p=i.i(n.createElement)("div"),u=i.i(n.createElement)("select");u.innerHTML='<option value="Paragraph">'+e.getConstant("Paragraph")+'</option><option value="Character">'+e.getConstant("Character")+'</option><option value="Linked Style">'+e.getConstant("Linked Style")+"</option>",p.appendChild(u),this.styleType=new r.DropDownList({change:this.styleTypeChange,popupHeight:"253px",enableRtl:t,placeholder:e.getConstant("Style type")+":",floatLabelType:"Always"}),this.styleType.appendTo(u),h.appendChild(p);var g=i.i(n.createElement)("div",{className:"e-de-container-row"});o.appendChild(g);var f=i.i(n.createElement)("div",{className:"e-de-subcontainer-left"});g.appendChild(f);var m=i.i(n.createElement)("div",{className:"e-de-style-style-based-on-div"}),v=i.i(n.createElement)("input");m.appendChild(v),this.styleBasedOn=new r.DropDownList({dataSource:[],select:this.styleBasedOnChange,popupHeight:"253px",enableRtl:t,placeholder:e.getConstant("Style based on")+":",floatLabelType:"Always"}),this.styleBasedOn.appendTo(v),f.appendChild(m);var y=i.i(n.createElement)("div",{className:"e-de-subcontainer-right"});g.appendChild(y),t&&(l.classList.add("e-de-rtl"),f.classList.add("e-de-rtl"),y.classList.add("e-de-rtl"));var w=i.i(n.createElement)("div"),b=i.i(n.createElement)("input");w.appendChild(b),this.styleParagraph=new r.DropDownList({dataSource:[],select:this.styleParagraphChange,popupHeight:"253px",enableRtl:t,placeholder:e.getConstant("Style for following paragraph")+":",floatLabelType:"Always"}),this.styleParagraph.appendTo(b),y.appendChild(w);var x=i.i(n.createElement)("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Formatting")});o.appendChild(x);var C=i.i(n.createElement)("div",{className:"e-de-style-options-div"});o.appendChild(C);var I=i.i(n.createElement)("div",{styles:"display:flex;margin-bottom: 14px;"});C.appendChild(I),this.createFontOptions(I,t);var F=i.i(n.createElement)("div",{styles:"display:flex",className:"e-style-paragraph"});C.appendChild(F),this.createParagraphOptions(F),this.createFormatDropdown(o,e,t),this.target.appendChild(o)},e.prototype.createFormatDropdown=function(e,t,r){var o=this,s=i.i(n.createElement)("button",{id:"style_format_dropdown",innerHTML:t.getConstant("Format"),attrs:{type:"button"}});s.style.height="31px",e.appendChild(s);var a=[{text:t.getConstant("Font")+"...",id:"style_font"},{text:t.getConstant("Paragraph")+"...",id:"style_paragraph"},{text:t.getConstant("Numbering")+"...",id:"style_numbering"}];this.styleDropdwn=new p.DropDownButton({items:a,cssClass:"e-de-style-format-dropdwn",enableRtl:r,beforeItemRender:function(e){o.styleType.value===t.getConstant("Character")?("style_paragraph"===e.item.id&&e.element.classList.add("e-disabled"),"style_numbering"===e.item.id&&e.element.classList.add("e-disabled")):("style_paragraph"===e.item.id&&e.element.classList.remove("e-disabled"),"style_numbering"===e.item.id&&e.element.classList.remove("e-disabled"))}}),this.styleDropdwn.appendTo(s),this.styleDropdwn.addEventListener("select",this.openDialog)},e.prototype.createFontOptions=function(e,t){var o=this,s=i.i(n.createElement)("input",{id:this.target.id+"_fontName"}),a=i.i(n.initializeCSPTemplate)(function(e){return'<span style="font-family: '+e.FontName+';">'+e.FontName+"</span>"});e.appendChild(s),this.fontFamily=new r.ComboBox({dataSource:void 0,query:(new d.Query).select(["FontName"]),fields:{text:"FontName",value:"value"},allowCustom:!0,width:"123px",popupWidth:"123px",cssClass:"e-style-font-fmaily-right",enableRtl:t,change:this.fontFamilyChanged,showClearButton:!1,itemTemplate:a}),this.fontFamily.appendTo(s),this.fontFamily.isStringTemplate=!0;for(var l=this.documentHelper.owner.documentEditorSettings.fontFamilies,h=0;h<l.length;h++){var p=l[h],u={FontName:p,value:p};this.fontFamily.addItem(u,h)}this.fontFamily.focus=function(){o.fontFamily.element.select()},this.fontFamily.element.parentElement.setAttribute("title",this.localObj.getConstant("Font"));var g=i.i(n.createElement)("input");e.appendChild(g);var f=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72];this.fontSize=new r.ComboBox({dataSource:f,width:"73px",cssClass:"e-style-font-fmaily-right",enableRtl:t,change:this.fontSizeUpdate}),this.fontSize.showClearButton=!1,this.fontSize.appendTo(g);var m=i.i(n.createElement)("div",{className:"e-de-style-font-group-button"});e.appendChild(m),this.bold=this.createButtonElement(m,"e-de-bold","e-de-style-bold-button-size",this.documentHelper.owner.containerId+"_style_bold"),this.bold.setAttribute("aria-label","bold"),this.bold.addEventListener("click",this.setBoldProperty),this.italic=this.createButtonElement(m,"e-de-italic","e-de-style-icon-button-size",this.documentHelper.owner.containerId+"_style_italic"),this.italic.setAttribute("aria-label","italic"),this.italic.addEventListener("click",this.setItalicProperty),this.underline=this.createButtonElement(m,"e-de-underline","e-de-style-icon-button-size",this.documentHelper.owner.containerId+"_style_underline"),this.underline.setAttribute("aria-label","underline"),this.underline.addEventListener("click",this.setUnderlineProperty);var v=i.i(n.createElement)("input",{attrs:{type:"color"},className:"e-de-style-icon-button-size"});e.appendChild(v),this.fontColor=new c.ColorPicker({cssClass:"e-de-style-font-color-picker",enableRtl:t,change:this.fontColorUpdate,locale:this.documentHelper.owner.locale,enableOpacity:!1}),this.fontColor.appendTo(v)},e.prototype.createParagraphOptions=function(e){var t=this,r=i.i(n.createElement)("div",{className:"e-de-style-paragraph-group-button"});e.appendChild(r),this.leftAlign=this.createButtonElement(r,"e-de-align-left","e-de-style-icon-button-size"),this.leftAlign.setAttribute("aria-label","leftAlign"),this.leftAlign.addEventListener("click",this.setLeftAlignment),this.centerAlign=this.createButtonElement(r,"e-de-align-center","e-de-style-icon-button-size"),this.centerAlign.setAttribute("aria-label","centerAlign"),this.centerAlign.addEventListener("click",this.setCenterAlignment),this.rightAlign=this.createButtonElement(r,"e-de-align-right","e-de-style-icon-button-size"),this.rightAlign.setAttribute("aria-label","rightAlign"),this.rightAlign.addEventListener("click",this.setRightAlignment),this.justify=this.createButtonElement(r,"e-de-justify","e-de-style-icon-button-last-size"),this.justify.setAttribute("aria-label","justify"),this.justify.addEventListener("click",this.setJustifyAlignment);var o=i.i(n.createElement)("div",{className:"e-de-style-paragraph-group-button"});e.appendChild(o),this.singleLineSpacing=this.createButtonElement(o,"e-de-single-spacing","e-de-style-icon-button-first-size"),this.singleLineSpacing.setAttribute("aria-label","singleLineSpacing"),this.singleLineSpacing.addEventListener("click",function(){t.paragraphFormat.lineSpacing=1,t.updateParagraphFormat()}),this.onePointFiveLineSpacing=this.createButtonElement(o,"e-de-one-point-five-spacing","e-de-style-icon-button-size"),this.onePointFiveLineSpacing.setAttribute("aria-label","onePointFiveLineSpacing"),this.onePointFiveLineSpacing.addEventListener("click",function(){t.paragraphFormat.lineSpacing=1.5,t.updateParagraphFormat()}),this.doubleLineSpacing=this.createButtonElement(o,"e-de-double-spacing","e-de-style-icon-button-last-size"),this.doubleLineSpacing.setAttribute("aria-label","doubleLineSpacing"),this.doubleLineSpacing.addEventListener("click",function(){t.paragraphFormat.lineSpacing=2,t.updateParagraphFormat()});var s=i.i(n.createElement)("div",{className:"e-de-style-paragraph-group-button"});e.appendChild(s);var a=this.createButtonElement(s,"e-de-before-spacing","e-de-style-icon-button-first-size");a.setAttribute("aria-label","beforeSpacing");var l=this.createButtonElement(s,"e-de-after-spacing","e-de-style-icon-button-last-size");l.setAttribute("aria-label","afterSpacing"),a.addEventListener("click",this.increaseBeforeAfterSpacing),l.addEventListener("click",this.decreaseBeforeAfterSpacing);var d=i.i(n.createElement)("div",{className:"e-de-style-paragraph-indent-group-button"});e.appendChild(d);var h=this.createButtonElement(d,"e-de-indent","e-de-style-icon-button-first-size");h.setAttribute("aria-label","decreaseIndent"),h.addEventListener("click",function(){t.paragraphFormat.leftIndent>=36?t.paragraphFormat.leftIndent-=36:t.paragraphFormat.leftIndent=0});var c=this.createButtonElement(d,"e-de-outdent","e-de-style-icon-button-size");c.setAttribute("aria-label","increaseindent"),c.addEventListener("click",function(){t.paragraphFormat.leftIndent+=36})},e.prototype.createButtonElement=function(e,t,r,s){var a=i.i(n.createElement)("button",{attrs:{type:"button"}});return i.i(n.isNullOrUndefined)(s)||(a.id=s),e.appendChild(a),new o.Button({iconCss:t,cssClass:r}).appendTo(a),a},e.prototype.toggleDisable=function(){this.styleType.value===this.localObj.getConstant("Character")?(this.styleParagraph.enabled=!1,this.target.getElementsByClassName("e-style-paragraph").item(0).setAttribute("style","display:flex;pointer-events:none;opacity:0.5")):(this.styleParagraph.enabled=!0,this.target.getElementsByClassName("e-style-paragraph").item(0).removeAttribute("style"),this.target.getElementsByClassName("e-style-paragraph").item(0).setAttribute("style","display:flex")),this.styleBasedOn.enabled=!0},e.prototype.show=function(e,t){var r=new n.L10n("documenteditor",this.documentHelper.owner.defaultLocale);this.isEdit=!i.i(n.isNullOrUndefined)(e)&&e.length>0,this.editStyleName=e,this.abstractList=new h.a;var o=this.documentHelper.styles.findByName(e);this.style=this.isEdit?o||this.getStyle(e):new s.a,r.setLocale(this.documentHelper.owner.locale),this.target||this.initStyleDialog(r,this.documentHelper.owner.enableRtl),this.isEdit?this.styleType.value=this.style instanceof s.b?"Character":"Paragraph":this.styleType.value="Paragraph",i.i(n.isNullOrUndefined)(t)&&(t=r.getConstant("Create New Style")),this.documentHelper.dialog2.header=t,this.documentHelper.dialog2.height="auto",this.documentHelper.dialog2.width="auto",this.documentHelper.dialog2.content=this.target,this.documentHelper.dialog2.buttons=[{click:this.onOkButtonClick,buttonModel:{content:r.getConstant("Ok"),cssClass:"e-flat e-style-okay",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:r.getConstant("Cancel"),cssClass:"e-flat e-style-cancel"}}],this.toggleDisable(),this.documentHelper.dialog2.dataBind(),this.documentHelper.dialog2.beforeOpen=this.loadStyleDialog,this.documentHelper.dialog2.close=this.closeStyleDialog,this.documentHelper.dialog2.position={X:"center",Y:"center"},this.documentHelper.dialog2.show()},e.prototype.updateList=function(){var e=this.style.paragraphFormat.listFormat.listId;e>-1&&(0===this.documentHelper.lists.filter(function(t){return t.listId===e}).length?this.documentHelper.lists.push(this.style.paragraphFormat.listFormat.list):(this.documentHelper.lists=this.documentHelper.lists.filter(function(t){return t.listId!==e}),this.documentHelper.lists.push(this.style.paragraphFormat.listFormat.list))),-1!==this.abstractList.abstractListId&&this.documentHelper.abstractLists.push(this.abstractList)},e.prototype.createLinkStyle=function(e,t){var i;return i=t?this.documentHelper.styles.findByName(e+" Char","Character"):new s.b,i.type="Character",i.name=e+" Char",i.characterFormat=this.style.characterFormat.cloneFormat(),i.basedOn=this.style.basedOn,t||this.documentHelper.styles.push(i),this.documentHelper.styles.findByName(i.name,"Character")},e.prototype.updateCharacterFormat=function(e){i.i(n.isNullOrUndefined)(e)||(this.characterFormat=e),this.fontFamily.value=this.characterFormat.fontFamily,this.fontSize.value=this.characterFormat.fontSize;var t=this.characterFormat.fontColor;this.fontColor.value="empty"===t||"#00000000"===t?"#000000":t,this.fontButtonClicked()},e.prototype.updateParagraphFormat=function(e){i.i(n.isNullOrUndefined)(e)||(this.paragraphFormat=e),i.i(n.isNullOrUndefined)(this.paragraphFormat)||("Left"===this.paragraphFormat.textAlignment?(this.leftAlign.classList.contains("e-active")||this.leftAlign.classList.add("e-active"),this.rightAlign.classList.contains("e-active")&&this.rightAlign.classList.remove("e-active"),this.centerAlign.classList.contains("e-active")&&this.centerAlign.classList.remove("e-active"),this.justify.classList.contains("e-active")&&this.justify.classList.remove("e-active")):"Right"===this.paragraphFormat.textAlignment?(this.leftAlign.classList.contains("e-active")&&this.leftAlign.classList.remove("e-active"),this.rightAlign.classList.contains("e-active")||this.rightAlign.classList.add("e-active"),this.centerAlign.classList.contains("e-active")&&this.centerAlign.classList.remove("e-active"),this.justify.classList.contains("e-active")&&this.justify.classList.remove("e-active")):"Center"===this.paragraphFormat.textAlignment?(this.leftAlign.classList.contains("e-active")&&this.leftAlign.classList.remove("e-active"),this.rightAlign.classList.contains("e-active")&&this.rightAlign.classList.remove("e-active"),this.centerAlign.classList.contains("e-active")||this.centerAlign.classList.add("e-active"),this.justify.classList.contains("e-active")&&this.justify.classList.remove("e-active")):"Justify"===this.paragraphFormat.textAlignment&&(this.leftAlign.classList.contains("e-active")&&this.leftAlign.classList.remove("e-active"),this.rightAlign.classList.contains("e-active")&&this.rightAlign.classList.remove("e-active"),this.centerAlign.classList.contains("e-active")&&this.centerAlign.classList.remove("e-active"),this.justify.classList.contains("e-active")||this.justify.classList.add("e-active")),1===this.paragraphFormat.lineSpacing?(this.singleLineSpacing.classList.add("e-active"),this.onePointFiveLineSpacing.classList.remove("e-active"),this.doubleLineSpacing.classList.remove("e-active")):1.5===this.paragraphFormat.lineSpacing?(this.singleLineSpacing.classList.remove("e-active"),this.onePointFiveLineSpacing.classList.add("e-active"),this.doubleLineSpacing.classList.remove("e-active")):2===this.paragraphFormat.lineSpacing?(this.singleLineSpacing.classList.remove("e-active"),this.onePointFiveLineSpacing.classList.remove("e-active"),this.doubleLineSpacing.classList.add("e-active")):(this.singleLineSpacing.classList.remove("e-active"),this.onePointFiveLineSpacing.classList.remove("e-active"),this.doubleLineSpacing.classList.remove("e-active")))},e.prototype.enableOrDisableOkButton=function(){i.i(n.isNullOrUndefined)(this.okButton)||(this.okButton.disabled=""===this.styleNameElement.value)},e.prototype.getTypeValue=function(e){var t=i.i(n.isNullOrUndefined)(e)?this.styleType.value:e;return"Linked Style"===t||"Paragraph"===t?"Paragraph":"Character"},e.prototype.updateStyleNames=function(e,t){var r=new n.L10n("documenteditor",this.documentHelper.owner.defaultLocale);r.setLocale(this.documentHelper.owner.locale);for(var o=this.documentHelper.styles.getStyleNames(e),s=[],a=0;a<o.length;a++){var l=r.getConstant(o[parseInt(a.toString(),10)]);""===l&&(l=o[parseInt(a.toString(),10)]),s.push(l)}if(this.styleParagraph.dataSource=s,this.styleParagraph.index=null,t){this.styleBasedOn.dataSource=s.filter(function(e){return e!==t}),this.styleBasedOn.index=null;var d=this.getStyle(t);if(d.basedOn instanceof String||i.i(n.isNullOrUndefined)(d.basedOn)?this.styleBasedOn.enabled=!1:this.styleBasedOn.index=o.indexOf(d.basedOn.name)>-1?o.indexOf(d.basedOn.name):0,"Paragraph"===d.type?i.i(n.isNullOrUndefined)(d.link)?this.styleType.index=0:this.styleType.index=2:this.styleType.index=1,!i.i(n.isNullOrUndefined)(d.next)){var h=d.next.name,c=0;o.indexOf(h)>-1&&(c=o.indexOf(h)),this.styleParagraph.index=c,this.isUserNextParaUpdated=h!==t}}else{this.styleBasedOn.dataSource=s,this.styleBasedOn.index=null;var p=0;if(this.documentHelper.owner.selectionModule){var l=void 0;l="Character"===e?this.documentHelper.owner.selection.characterFormat.styleName:this.documentHelper.owner.selection.paragraphFormat.styleName,p=o.indexOf(l)}this.styleBasedOn.index=p,this.styleParagraph.index=0}this.isEdit?this.styleType.enabled=!1:this.styleType.enabled=!0},e.prototype.getStyle=function(e){return i.i(n.isNullOrUndefined)(this.documentHelper.styles.findByName(e))&&this.documentHelper.owner.editor.createStyle(this.documentHelper.preDefinedStyles.get(e)),this.documentHelper.styles.findByName(e)},e.prototype.destroy=function(){if(!i.i(n.isNullOrUndefined)(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[e]),e--;this.target=void 0}this.characterFormat&&(this.characterFormat.destroy(),this.characterFormat=void 0),this.paragraphFormat&&(this.paragraphFormat.destroy(),this.paragraphFormat=void 0),this.fontColor&&(this.fontColor.destroy(),this.fontColor=void 0),this.fontSize&&(this.fontSize.destroy(),this.fontSize=void 0),this.fontFamily&&(this.fontFamily.destroy(),this.fontFamily=void 0),this.styleType&&(this.styleType.destroy(),this.styleType=void 0),this.styleBasedOn&&(this.styleBasedOn.destroy(),this.styleBasedOn=void 0),this.styleParagraph&&(this.styleParagraph.destroy(),this.styleParagraph=void 0),this.onlyThisDocument&&this.onlyThisDocument.destroy(),this.onlyThisDocument=void 0,this.template&&(this.template.destroy(),this.template=void 0),this.style&&(this.style.destroy(),this.style=void 0),this.abstractList&&(this.abstractList.destroy(),this.abstractList=void 0),this.numberingBulletDialog&&(this.numberingBulletDialog.destroy(),this.numberingBulletDialog=void 0),this.styleDropdwn&&(this.styleDropdwn.destroy(),this.styleDropdwn=void 0),this.documentHelper=void 0},e}())},function(e,t,i){"use strict";i.d(t,"a",function(){return s});var n=i(18),r=(i.n(n),i(3)),o=(i.n(r),i(0)),s=(i.n(o),function(){function e(e){var t=this;this.modifyStyles=function(){t.documentHelper.dialog.hide(),t.documentHelper.owner.styleDialogModule.show(t.styleName,t.localValue.getConstant("Modify Style"))},this.selectHandler=function(e){t.styleName=t.getStyleName(e.text)},this.addNewStyles=function(){t.documentHelper.dialog.hide(),t.documentHelper.owner.styleDialogModule.show()},this.documentHelper=e}return e.prototype.getModuleName=function(){return"StylesDialog"},e.prototype.initStylesDialog=function(e,t,s){var a=this.documentHelper.owner.containerId+"_insert_styles";this.target=i.i(o.createElement)("div",{id:a,className:"e-de-styles"});var l=e.getConstant("Styles"),d=i.i(o.createElement)("div",{innerHTML:l,className:"e-de-para-dlg-heading"});this.target.appendChild(d);var h=i.i(o.createElement)("div",{className:"e-styles-common"});this.target.appendChild(h);var c=i.i(o.createElement)("div",{className:"e-styles-list"});h.appendChild(c),s&&c.classList.add("e-de-rtl");var p=i.i(o.createElement)("div",{className:"e-styles-listViewDiv",id:"styles_listview"});c.appendChild(p),this.listviewInstance=new n.ListView({dataSource:t,cssClass:"e-styles-listview",fields:{text:"StyleName",iconCss:"IconClass"},showIcon:!0}),this.listviewInstance.appendTo(p),this.listviewInstance.addEventListener("select",this.selectHandler);var u=i.i(o.createElement)("div",{className:"e-styles-button"});h.appendChild(u);var g=i.i(o.createElement)("div",{className:"e-styles-addbutton"});u.appendChild(g);var f=i.i(o.createElement)("button",{innerHTML:e.getConstant("New")+"...",id:"new",attrs:{type:"button"}});g.appendChild(f),new r.Button({cssClass:"e-button-custom"}).appendTo(f),f.addEventListener("click",this.addNewStyles);var m=i.i(o.createElement)("div",{className:"e-styles-addbutton"});u.appendChild(m);var v=i.i(o.createElement)("button",{innerHTML:e.getConstant("Modify")+"...",id:"modify",attrs:{type:"button"}});m.appendChild(v),new r.Button({cssClass:"e-button-custom"}).appendTo(v),v.addEventListener("click",this.modifyStyles)},e.prototype.show=function(){var e=new o.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale);for(var t=this.updateStyleNames("Paragraph").filter(function(e){return"Paragraph"==e.Type}),i=this.updateStyleNames("Paragraph").filter(function(e){return"Linked"==e.Type}),n=this.updateStyleNames("Character").filter(function(e){return"Character"==e.Type}),r=0,s=i;r<s.length;r++)for(var a=s[r],l=0,d=n;l<d.length;l++){var h=d[l];if(a.StyleName+" Char"===h.StyleName){n.splice(n.indexOf(h),1);break}}var c=t.concat(i,n);this.localValue=e,this.initStylesDialog(e,c,this.documentHelper.owner.enableRtl),this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=this.documentHelper.updateFocus,this.documentHelper.dialog.close=this.documentHelper.updateFocus,this.documentHelper.dialog.header=e.getConstant("Styles"),this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.buttons=[{click:this.hideObjects.bind(this),buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-hyper-insert",isPrimary:!0}}],this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show()},e.prototype.updateStyleNames=function(e){var t=new o.L10n("documenteditor",this.documentHelper.owner.defaultLocale);t.setLocale(this.documentHelper.owner.locale);for(var i=this.documentHelper.owner.documentHelper.styles.getStyles(e),n=[],r=0;r<i.length;r++){var s=t.getConstant(i[parseInt(r.toString(),10)].name);""===s&&(s=i[parseInt(r.toString(),10)].name),"Paragraph"==i[parseInt(r.toString(),10)].type?n.push({StyleName:s,IconClass:"e-de-listview-icon e-de-e-paragraph-style-mark e-icons",Type:i[parseInt(r.toString(),10)].type}):"Character"==i[parseInt(r.toString(),10)].type?n.push({StyleName:s,IconClass:"e-de-listview-icon e-de-e-character-style-mark e-icons",Type:i[parseInt(r.toString(),10)].type}):n.push({StyleName:s,IconClass:"e-de-listview-icon e-de-e-linked-style-mark e-icons",Type:i[parseInt(r.toString(),10)].type})}return n},e.prototype.defaultStyleName=function(e){for(var t=[],i=0;i<e.length;i++)t.push(e[parseInt(i.toString(),10)]);return t},e.prototype.getStyleName=function(e){var t=new o.L10n("documenteditor",this.documentHelper.owner.defaultLocale);return t.setLocale(this.documentHelper.owner.locale),t.getConstant("Heading 1")===e?e="Heading 1":t.getConstant("Heading 2")===e?e="Heading 2":t.getConstant("Heading 3")===e?e="Heading 3":t.getConstant("Heading 4")===e?e="Heading 4":t.getConstant("Heading 5")===e?e="Heading 5":t.getConstant("Heading 6")===e?e="Heading 6":t.getConstant("Normal")===e?e="Normal":t.getConstant("Header")===e?e="Header":t.getConstant("Footer")===e&&(e="Footer"),e},e.prototype.hideObjects=function(){this.documentHelper.dialog.hide(),this.documentHelper.updateFocus()},e.prototype.destroy=function(){this.listviewInstance&&(this.listviewInstance.destroy(),this.listviewInstance=void 0),this.documentHelper=void 0,this.styleName=void 0,this.localValue=void 0,this.target=void 0},e}())},function(e,t,i){"use strict";i.d(t,"a",function(){return s});var n=i(5),r=(i.n(n),i(0)),o=(i.n(r),i(8)),s=(i.n(o),function(){function e(e){var t=this;this.onCancelButtonClick=function(){t.documentHelper.dialog.hide(),t.documentHelper.updateFocus()},this.onInsertTableClick=function(){if(t.columnValueTexBox.value<1||t.columnValueTexBox.value>t.documentHelper.owner.documentEditorSettings.maximumColumns){var e=t.localeValue.getConstant("Number of columns must be between")+" 1 "+t.localeValue.getConstant("and")+" "+t.documentHelper.owner.documentEditorSettings.maximumColumns.toString();return void(o.DialogUtility.alert(e).enableRtl=t.documentHelper.owner.enableRtl)}if(t.rowValueTextBox.value<1||t.rowValueTextBox.value>t.documentHelper.owner.documentEditorSettings.maximumRows){var n=t.localeValue.getConstant("Number of rows must be between")+" 1 "+t.localeValue.getConstant("and")+" "+t.documentHelper.owner.documentEditorSettings.maximumColumns.toString();return void(o.DialogUtility.alert(n).enableRtl=t.documentHelper.owner.enableRtl)}if(t.rowValueTextBox.value<=t.documentHelper.owner.documentEditorSettings.maximumRows&&t.columnValueTexBox.value<=t.documentHelper.owner.documentEditorSettings.maximumColumns){var s=t.rowValueTextBox.value,a=t.columnValueTexBox.value;i.i(r.isNullOrUndefined)(s)&&i.i(r.isNullOrUndefined)(a)||t.documentHelper.owner.editor.insertTable(s,a),t.documentHelper.hideDialog()}},this.documentHelper=e}return e.prototype.getModuleName=function(){return"TableDialog"},e.prototype.initTableDialog=function(e){this.target=i.i(r.createElement)("div",{className:"e-de-insert-table"});var t=i.i(r.createElement)("div"),o=i.i(r.createElement)("div",{className:"e-de-container-row"});this.columnsCountBox=i.i(r.createElement)("input",{attrs:{type:"text"}}),o.appendChild(this.columnsCountBox),this.columnsCountBox.setAttribute("aria-labelledby",e.getConstant("Insert Table"));var s=i.i(r.createElement)("div");this.rowsCountBox=i.i(r.createElement)("input",{attrs:{type:"text"}}),s.appendChild(this.rowsCountBox),t.appendChild(o),t.appendChild(s),this.target.appendChild(t),this.rowValueTextBox=new n.NumericTextBox({format:"#",value:2,min:1,strictMode:!0,enablePersistence:!1,placeholder:e.getConstant("Number of rows"),floatLabelType:"Always"}),this.rowValueTextBox.appendTo(this.rowsCountBox),this.rowsCountBox.setAttribute("aria-labelledby",e.getConstant("Number of rows")),this.columnValueTexBox=new n.NumericTextBox({format:"#",value:2,min:1,strictMode:!0,enablePersistence:!1,placeholder:e.getConstant("Number of columns"),floatLabelType:"Always"}),this.columnsCountBox.setAttribute("aria-labelledby",e.getConstant("Number of columns")),t.setAttribute("aria-labelledby",e.getConstant("Insert Table")),t.setAttribute("aria-describedby",e.getConstant("Insert Table")),this.columnValueTexBox.appendTo(this.columnsCountBox)},e.prototype.show=function(){var e=new r.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),this.localeValue=e,this.target||this.initTableDialog(e),"none"!==this.documentHelper.selection.caret.style.display&&(this.documentHelper.selection.caret.style.display="none"),this.documentHelper.dialog.header=e.getConstant("Insert Table"),this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=this.documentHelper.updateFocus,this.documentHelper.dialog.buttons=[{click:this.onInsertTableClick,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-table-ok",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-table-cancel"}}],this.rowValueTextBox.value=2,this.columnValueTexBox.value=2,this.documentHelper.dialog.close=this.documentHelper.updateFocus,this.documentHelper.dialog.dataBind(),this.columnValueTexBox.focusIn(),this.documentHelper.dialog.show()},e.prototype.destroy=function(){if(this.columnsCountBox&&(this.columnsCountBox.parentElement&&this.columnsCountBox.parentElement.removeChild(this.columnsCountBox),this.columnsCountBox=void 0),this.rowsCountBox&&(this.rowsCountBox.parentElement&&this.rowsCountBox.parentElement.removeChild(this.rowsCountBox),this.rowsCountBox=void 0),this.columnValueTexBox&&(this.columnValueTexBox.destroy(),this.columnValueTexBox=void 0),this.rowValueTextBox&&(this.rowValueTextBox.destroy(),this.rowValueTextBox=void 0),this.columnsCountBox=void 0,this.rowsCountBox=void 0,this.documentHelper=void 0,!i.i(r.isNullOrUndefined)(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[parseInt(e.toString(),10)]),e--;this.target=void 0}},e}())},function(e,t,i){"use strict";i.d(t,"a",function(){return l});var n=i(0),r=(i.n(n),i(3)),o=(i.n(r),i(10)),s=(i.n(o),i(5)),a=(i.n(s),i(18)),l=(i.n(a),function(){function e(e){var t=this;this.loadTableofContentDialog=function(){t.documentHelper.updateFocus(),t.pageNumber.checked=!0,t.rightAlign.disabled=!1,t.rightAlign.checked=!0,t.tabLeader.enabled=!0,t.hyperlink.checked=!0,t.style.checked=!0,t.outline.checked=!0,t.outline.disabled=!1,t.showLevel.enabled=!0},this.closeTableOfContentDialog=function(){t.unWireEventsAndBindings(),t.documentHelper.updateFocus()},this.onCancelButtonClick=function(){t.documentHelper.dialog3.hide(),t.unWireEventsAndBindings(),t.documentHelper.updateFocus()},this.selectHandler=function(e){t.textBoxInput.value=e.text;var i=t.textBoxInput;i.setSelectionRange(0,e.text.length),i.focus()},this.showStyleDialog=function(){i.i(n.isNullOrUndefined)(t.documentHelper.owner.styleDialogModule)||t.documentHelper.owner.styleDialogModule.show(t.textBoxInput.value)},this.reset=function(){t.showLevel.enabled=!0,t.showLevel.value=3,t.outline.disabled=!1,t.outline.checked=!0;var e=["1","2","3",null,null,null,null,null,null];t.changeByValue(e),t.normal.value=null},this.changeStyle=function(e){var i=e.srcElement.value;i!==t.getElementValue(e.srcElement)&&""!==i?t.showLevel.enabled=!1:(t.showLevel.enabled=!0,t.checkLevel())},this.changeHeadingStyle=function(e){var i=e.srcElement.value;t.showLevel.enabled=""===i,t.normal===e.srcElement&&(t.outline.checked=!1,t.outline.disabled=!0)},this.changePageNumberValue=function(e){e.checked?(t.rightAlign.checked=!0,t.rightAlign.disabled=!1,t.tabLeader.enabled=!0):(t.rightAlign.disabled=!0,t.tabLeader.enabled=!1)},this.changeRightAlignValue=function(e){e.checked?t.tabLeader.enabled=!0:t.tabLeader.enabled=!1},this.changeStyleValue=function(e){e.checked?(t.heading1.disabled=!1,t.heading2.disabled=!1,t.heading3.disabled=!1,t.heading4.disabled=!1,t.heading5.disabled=!1,t.heading6.disabled=!1,t.heading7.disabled=!1,t.heading8.disabled=!1,t.heading9.disabled=!1,t.normal.disabled=!1):(t.heading1.disabled=!0,t.heading2.disabled=!0,t.heading3.disabled=!0,t.heading4.disabled=!0,t.heading5.disabled=!0,t.heading6.disabled=!0,t.heading7.disabled=!0,t.heading8.disabled=!0,t.heading9.disabled=!0,t.normal.disabled=!0)},this.applyTableOfContentProperties=function(){var e={startLevel:1,endLevel:t.showLevel.value,includeHyperlink:t.hyperlink.checked,includePageNumber:t.pageNumber.checked,rightAlign:t.rightAlign.checked,tabLeader:t.tabLeader.value,includeOutlineLevels:t.outline.checked};t.applyLevelSetting(e),t.documentHelper.owner.editorModule.insertTableOfContents(e),t.documentHelper.dialog3.hide(),t.documentHelper.updateFocus()},this.unWireEventsAndBindings=function(){t.pageNumber.checked=!1,t.rightAlign.checked=!1,t.tabLeader.value="",t.hyperlink.checked=!1,t.style.checked=!1,t.outline.checked=!1,t.normal.value=""},this.documentHelper=e}return e.prototype.getModuleName=function(){return"TableOfContentsDialog"},e.prototype.initTableOfContentDialog=function(e,t){var l=this.documentHelper.owner.containerId,d=l+"_toc_dialog";this.target=i.i(n.createElement)("div",{id:d,className:"e-de-toc-dlg-container"});var h=i.i(n.createElement)("div",{id:"general_div",className:"e-de-toc-dlg-sub-container"});this.target.appendChild(h);var c=i.i(n.createElement)("div",{id:l+"_genLabel",className:"e-de-toc-dlg-main-heading",styles:"margin-bottom: 13px;",innerHTML:e.getConstant("General")});h.appendChild(c);t?"float:right;":"float:left;";var p=i.i(n.createElement)("div",{className:"e-de-container-row"}),u=i.i(n.createElement)("div",{className:"e-de-subcontainer-left"});p.appendChild(u);var g=i.i(n.createElement)("div",{className:"e-de-subcontainer-right"});p.appendChild(g),h.appendChild(p);var f=i.i(n.createElement)("div",{className:"e-de-dlg-row"}),m=i.i(n.createElement)("div",{className:"e-de-subcontainer-left"});f.appendChild(m);var v=i.i(n.createElement)("div",{className:"e-de-subcontainer-right"});f.appendChild(v);var y=i.i(n.createElement)("div",{className:"e-de-toc-dlg-sub-container"}),w=i.i(n.createElement)("input",{attrs:{type:"checkbox"},id:this.target.id+"_pageNumber"});y.appendChild(w);var b=i.i(n.createElement)("div",{className:"e-de-toc-dlg-sub-container"}),x=i.i(n.createElement)("input",{attrs:{type:"checkbox"},id:this.target.id+"_rightAlign"});b.appendChild(x),this.pageNumber=new r.CheckBox({label:e.getConstant("Show page numbers"),enableRtl:t,checked:!0,change:this.changePageNumberValue}),this.rightAlign=new r.CheckBox({label:e.getConstant("Right align page numbers"),enableRtl:t,checked:!0,change:this.changeRightAlignValue}),this.pageNumber.appendTo(w),this.rightAlign.appendTo(x);var C=i.i(n.createElement)("div",{className:"e-de-container-row"}),I=i.i(n.createElement)("div",{className:"e-de-subcontainer-left"}),F=i.i(n.createElement)("div"),k=i.i(n.createElement)("label",{className:"e-de-toc-dlg-heading",innerHTML:e.getConstant("Tab leader")+":"});F.appendChild(k);var P=i.i(n.createElement)("div",{id:"tabLeader_div"}),T=i.i(n.createElement)("select",{id:l+"_tabLeader",innerHTML:'<option value="None">('+e.getConstant("None").toLocaleLowerCase()+')</option><option value="Dot" selected>....................</option><option value="Hyphen">-------------------</option><option value="Underscore">____________</option>'});P.appendChild(T),I.appendChild(F),I.appendChild(P),u.appendChild(y),u.appendChild(b),C.appendChild(I),this.tabLeader=new o.DropDownList({enableRtl:t}),this.tabLeader.appendTo(T);var S=i.i(n.createElement)("input",{attrs:{type:"checkbox"},id:this.target.id+"_hyperlink"});g.appendChild(S),this.hyperlink=new r.CheckBox({label:e.getConstant("Use hyperlinks instead of page numbers"),cssClass:"e-de-toc-label",enableRtl:t,checked:!0}),this.hyperlink.appendTo(S);var W=i.i(n.createElement)("div",{className:"e-de-subcontainer-right"}),N=i.i(n.createElement)("div",{className:"e-de-toc-dlg-show-level-div"}),H=i.i(n.createElement)("label",{className:"e-de-toc-dlg-heading",innerHTML:e.getConstant("Show levels")+":"});N.appendChild(H);var E=i.i(n.createElement)("div",{className:"e-de-toc-dlg-showlevel-div"}),O=i.i(n.createElement)("input",{id:l+"_showLevel",attrs:{type:"text","aria-label":"showLevel"}});E.appendChild(O),W.appendChild(N),W.appendChild(E),C.appendChild(W),h.appendChild(C),this.showLevel=new s.NumericTextBox({format:"#",value:3,min:1,max:9,change:this.changeShowLevelValue.bind(this)}),this.showLevel.appendTo(O),t&&(this.hyperlink.cssClass="e-de-toc-label-rtl",N.classList.add("e-de-rtl"),E.classList.add("e-de-rtl"),v.classList.add("e-de-rtl"));var _=i.i(n.createElement)("div",{className:"e-de-toc-dlg-main-heading e-de-toc-dlg-build-table",innerHTML:e.getConstant("Build table of contents from")+":"});h.appendChild(f);var B=i.i(n.createElement)("input",{attrs:{type:"checkbox"},id:this.target.id+"_style"});m.appendChild(_),m.appendChild(B),this.style=new r.CheckBox({label:e.getConstant("Styles"),enableRtl:t,checked:!0,change:this.changeStyleValue}),this.style.appendTo(B);var L=i.i(n.createElement)("TABLE",{styles:"margin-top:3px;"}),R=i.i(n.createElement)("tr"),A=i.i(n.createElement)("td",{styles:"width:120px;padding-left:10px;"}),D=i.i(n.createElement)("label",{innerHTML:e.getConstant("Available styles"),className:"e-de-toc-dlg-main-heading e-de-toc-dlg-sub-level-heading",id:this.target.id+"_availableLabel"});A.appendChild(D);var U=i.i(n.createElement)("td"),M=i.i(n.createElement)("label",{innerHTML:e.getConstant("TOC level")+":",className:"e-de-toc-dlg-main-heading e-de-toc-dlg-sub-level-heading",id:this.target.id+"_tocLabel"});U.appendChild(M),R.appendChild(A),R.appendChild(U),L.appendChild(R);var V=i.i(n.createElement)("div",{id:"table_div",className:"e-de-toc-table-div"}),z=i.i(n.createElement)("TABLE"),j=i.i(n.createElement)("tr"),q=i.i(n.createElement)("td"),G=i.i(n.createElement)("label",{innerHTML:e.getConstant("Heading")+" 1",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading1Label"});q.appendChild(G);var K=i.i(n.createElement)("td");this.heading1=i.i(n.createElement)("input",{id:"_heading1",className:"e-input e-de-toc-dlg-toc-level",attrs:{"aria-label":e.getConstant("Heading")+" 1"}}),this.heading1.value="1",this.heading1.addEventListener("keyup",this.changeStyle),K.appendChild(this.heading1),j.appendChild(q),j.appendChild(K);var Z=i.i(n.createElement)("tr"),X=i.i(n.createElement)("td"),J=i.i(n.createElement)("label",{innerHTML:e.getConstant("Heading")+" 2",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading2Label"});X.appendChild(J);var Y=i.i(n.createElement)("td");this.heading2=i.i(n.createElement)("input",{id:"_heading2",className:"e-input e-de-toc-dlg-toc-level",attrs:{"aria-label":e.getConstant("Heading")+" 2"}}),this.heading2.value="2",this.heading2.addEventListener("keyup",this.changeStyle),Y.appendChild(this.heading2),Z.appendChild(X),Z.appendChild(Y);var Q=i.i(n.createElement)("tr"),$=i.i(n.createElement)("td"),ee=i.i(n.createElement)("label",{innerHTML:e.getConstant("Heading")+" 3",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading3Label"});$.appendChild(ee);var te=i.i(n.createElement)("td");this.heading3=i.i(n.createElement)("input",{id:"_heading3",className:"e-input e-de-toc-dlg-toc-level",attrs:{"aria-label":e.getConstant("Heading")+" 3"}}),this.heading3.value="3",this.heading3.addEventListener("keyup",this.changeStyle),te.appendChild(this.heading3),Q.appendChild($),Q.appendChild(te);var ie=i.i(n.createElement)("tr"),ne=i.i(n.createElement)("td"),re=i.i(n.createElement)("label",{innerHTML:e.getConstant("Heading")+" 4",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading4Label"});ne.appendChild(re);var oe=i.i(n.createElement)("td");this.heading4=i.i(n.createElement)("input",{id:"_heading4",className:"e-input e-de-toc-dlg-toc-level",attrs:{"aria-label":e.getConstant("Heading")+" 4"}}),this.heading4.addEventListener("keyup",this.changeStyle),oe.appendChild(this.heading4),ie.appendChild(ne),ie.appendChild(oe);var se=i.i(n.createElement)("tr"),ae=i.i(n.createElement)("td"),le=i.i(n.createElement)("label",{innerHTML:e.getConstant("Heading")+" 5",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading5Label"});ae.appendChild(le);var de=i.i(n.createElement)("td");this.heading5=i.i(n.createElement)("input",{id:"_heading5",className:"e-input e-de-toc-dlg-toc-level",attrs:{"aria-label":e.getConstant("Heading")+" 5"}}),this.heading5.addEventListener("keyup",this.changeStyle),de.appendChild(this.heading5),se.appendChild(ae),se.appendChild(de);var he=i.i(n.createElement)("tr"),ce=i.i(n.createElement)("td"),pe=i.i(n.createElement)("label",{innerHTML:e.getConstant("Heading")+" 6",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading6Label"});ce.appendChild(pe);var ue=i.i(n.createElement)("td");this.heading6=i.i(n.createElement)("input",{id:"_heading6",className:"e-input e-de-toc-dlg-toc-level",attrs:{"aria-label":e.getConstant("Heading")+" 6"}}),this.heading6.addEventListener("keyup",this.changeStyle),ue.appendChild(this.heading6),he.appendChild(ce),he.appendChild(ue);var ge=i.i(n.createElement)("tr"),fe=i.i(n.createElement)("td"),me=i.i(n.createElement)("label",{innerHTML:e.getConstant("Heading")+" 7",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading7Label"});fe.appendChild(me);var ve=i.i(n.createElement)("td");this.heading7=i.i(n.createElement)("input",{id:"_heading7",className:"e-input e-de-toc-dlg-toc-level",attrs:{"aria-label":e.getConstant("Heading")+" 7"}}),this.heading7.addEventListener("keyup",this.changeStyle),ve.appendChild(this.heading7),ge.appendChild(fe),ge.appendChild(ve);var ye=i.i(n.createElement)("tr"),we=i.i(n.createElement)("td"),be=i.i(n.createElement)("label",{innerHTML:e.getConstant("Heading")+" 8",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading8Label"});we.appendChild(be);var xe=i.i(n.createElement)("td");this.heading8=i.i(n.createElement)("input",{id:"_heading8",className:"e-input e-de-toc-dlg-toc-level",attrs:{"aria-label":e.getConstant("Heading")+" 8"}}),this.heading8.addEventListener("keyup",this.changeStyle),xe.appendChild(this.heading8),ye.appendChild(we),ye.appendChild(xe);var Ce=i.i(n.createElement)("tr"),Ie=i.i(n.createElement)("td"),Fe=i.i(n.createElement)("label",{innerHTML:e.getConstant("Heading")+" 9",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading9Label"});Ie.appendChild(Fe);var ke=i.i(n.createElement)("td");this.heading9=i.i(n.createElement)("input",{id:"_heading9",className:"e-input e-de-toc-dlg-toc-level",attrs:{"aria-label":e.getConstant("Heading")+" 9"}}),this.heading9.addEventListener("keyup",this.changeStyle),ke.appendChild(this.heading9),Ce.appendChild(Ie),Ce.appendChild(ke);var Pe=i.i(n.createElement)("tr"),Te=i.i(n.createElement)("td"),Se=i.i(n.createElement)("label",{innerHTML:e.getConstant("Normal"),className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_normalLabel"});Te.appendChild(Se);var We=i.i(n.createElement)("td");this.normal=i.i(n.createElement)("input",{id:"_normal",className:"e-input e-de-toc-dlg-toc-level",attrs:{"aria-label":e.getConstant("Normal")}}),this.normal.addEventListener("keyup",this.changeHeadingStyle),We.appendChild(this.normal),Pe.appendChild(Te),Pe.appendChild(We),t&&(this.normal.classList.add("e-de-rtl"),this.heading1.classList.add("e-de-rtl"),this.heading2.classList.add("e-de-rtl"),this.heading3.classList.add("e-de-rtl"),this.heading4.classList.add("e-de-rtl"),this.heading5.classList.add("e-de-rtl"),this.heading6.classList.add("e-de-rtl"),this.heading7.classList.add("e-de-rtl"),this.heading8.classList.add("e-de-rtl"),this.heading9.classList.add("e-de-rtl")),z.appendChild(j),z.appendChild(Z),z.appendChild(Q),z.appendChild(ie),z.appendChild(se),z.appendChild(he),z.appendChild(ge),z.appendChild(ye),z.appendChild(Ce),z.appendChild(Pe),V.appendChild(z);var Ne=i.i(n.createElement)("div",{className:"e-de-toc-styles-table-div"});Ne.appendChild(L),Ne.appendChild(V),m.appendChild(Ne);var He=i.i(n.createElement)("div",{id:"fields_div",styles:"display: flex;"});m.appendChild(He);var Ee=i.i(n.createElement)("div",{id:"out_div"}),Oe=i.i(n.createElement)("div",{id:"outline_div",className:"e-de-toc-dlg-sub-container e-de-toc-dlg-outline-levels"}),_e=i.i(n.createElement)("input",{attrs:{type:"checkbox"},id:"_outline"});Oe.appendChild(_e),Ee.appendChild(Oe),He.appendChild(Ee),this.outline=new r.CheckBox({label:e.getConstant("Outline levels"),enableRtl:t,checked:!0,cssClass:"e-de-outline-rtl"}),this.outline.appendTo(_e);var Be=i.i(n.createElement)("div",{className:"e-de-toc-reset-button"});He.appendChild(Be);var Le=i.i(n.createElement)("button",{innerHTML:e.getConstant("Reset"),id:"reset",attrs:{type:"button"}});Be.appendChild(Le),new r.Button({cssClass:"e-btn e-flat"}).appendTo(Le),Le.addEventListener("click",this.reset);var Re=i.i(n.createElement)("div",{id:l+"_tocStylesLabel",className:"e-de-toc-dlg-main-heading",innerHTML:e.getConstant("Styles")+":"});v.appendChild(Re);var Ae=i.i(n.createElement)("div");v.appendChild(Ae),this.textBoxInput=i.i(n.createElement)("input",{className:"e-input",attrs:{"aria-label":"Type of TOC"}}),this.textBoxInput.setAttribute("type","text"),Ae.appendChild(this.textBoxInput);var De=i.i(n.createElement)("div",{className:"e-de-toc-list-view"}),Ue=["TOC 1","TOC 2","TOC 3","TOC 4","TOC 5","TOC 6","TOC 7","TOC 8","TOC 9"],Me=this.styleLocaleValue(Ue,e);this.listViewInstance=new a.ListView({dataSource:Me,cssClass:"e-toc-list-view"}),this.listViewInstance.appendTo(De),this.listViewInstance.addEventListener("select",this.selectHandler),v.appendChild(De);var Ve=i.i(n.createElement)("div",{className:"e-de-toc-modify-button"});v.appendChild(Ve);var ze=i.i(n.createElement)("button",{innerHTML:e.getConstant("Modify")+"...",id:"modify",attrs:{type:"button"}});Ve.appendChild(ze),new r.Button({cssClass:"e-btn e-flat"}).appendTo(ze),ze.addEventListener("click",this.showStyleDialog),t&&(Be.classList.add("e-de-rtl"),Re.classList.add("e-de-rtl"),Ae.classList.add("e-de-rtl"),De.classList.add("e-de-rtl"),Ve.classList.add("e-de-rtl"))},e.prototype.styleLocaleValue=function(e,t){for(var i=[],n=0;n<e.length;n++)i.push(t.getConstant(e[n]));return i},e.prototype.show=function(){var e=new n.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),this.target||this.initTableOfContentDialog(e,this.documentHelper.owner.enableRtl),this.documentHelper.dialog3.header=e.getConstant("Table of Contents"),this.documentHelper.dialog3.position={X:"center",Y:"center"},this.documentHelper.dialog3.width="auto",this.documentHelper.dialog3.height="auto",this.documentHelper.dialog3.content=this.target,this.documentHelper.dialog3.beforeOpen=this.loadTableofContentDialog,this.documentHelper.dialog3.close=this.closeTableOfContentDialog,this.documentHelper.dialog3.buttons=[{click:this.applyTableOfContentProperties,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-toc-okay",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-toc-cancel"}}],this.documentHelper.dialog3.dataBind(),this.documentHelper.dialog3.show()},e.prototype.changeShowLevelValue=function(e){var t=e.value,i=[];switch(t){case 1:i=["1",null,null,null,null,null,null,null,null],this.changeByValue(i);break;case 2:i=["1","2",null,null,null,null,null,null,null],this.changeByValue(i);break;case 3:i=["1","2","3",null,null,null,null,null,null],this.changeByValue(i);break;case 4:i=["1","2","3","4",null,null,null,null,null],this.changeByValue(i);break;case 5:i=["1","2","3","4","5",null,null,null,null],this.changeByValue(i);break;case 6:i=["1","2","3","4","5","6",null,null,null],this.changeByValue(i);break;case 7:i=["1","2","3","4","5","6","7",null,null],this.changeByValue(i);break;case 8:i=["1","2","3","4","5","6","7","8",null],this.changeByValue(i);break;case 9:i=["1","2","3","4","5","6","7","8","9"],this.changeByValue(i)}},e.prototype.changeByValue=function(e){this.heading1.value=e[0],this.heading2.value=e[1],this.heading3.value=e[2],this.heading4.value=e[3],this.heading5.value=e[4],this.heading6.value=e[5],this.heading7.value=e[6],this.heading8.value=e[7],this.heading9.value=e[8]},e.prototype.checkLevel=function(){""!==this.heading1.value&&(this.showLevel.value=1),""!==this.heading2.value&&(this.showLevel.value=2),""!==this.heading3.value&&(this.showLevel.value=3),""!==this.heading4.value&&(this.showLevel.value=4),""!==this.heading5.value&&(this.showLevel.value=5),""!==this.heading6.value&&(this.showLevel.value=6),""!==this.heading7.value&&(this.showLevel.value=7),""!==this.heading8.value&&(this.showLevel.value=8),""!==this.heading9.value&&(this.showLevel.value=9)},e.prototype.getElementValue=function(e){switch(e){case this.heading1:return"1";case this.heading2:return"2";case this.heading3:return"3";case this.heading4:return"4";case this.heading5:return"5";case this.heading6:return"6";case this.heading7:return"7";case this.heading8:return"8";case this.heading9:return"9";default:return"1"}},e.prototype.getHeadingLevel=function(e){switch(e){case 1:return parseInt(this.heading1.value);case 2:return parseInt(this.heading2.value);case 3:return parseInt(this.heading3.value);case 4:return parseInt(this.heading4.value);case 5:return parseInt(this.heading5.value);case 6:return parseInt(this.heading6.value);case 7:return parseInt(this.heading7.value);case 8:return parseInt(this.heading8.value);case 9:return parseInt(this.heading9.value);default:return 0}},e.prototype.applyLevelSetting=function(e){e.levelSettings={};for(var t=0,i=0,n=!1,r=1;r<=e.endLevel;r++){var o=this.getHeadingLevel(r);if(r===o)0===t&&(t=r,n=!1),n||(i=r);else if(n=!0,0!==o){var s="Heading "+r.toString();e.levelSettings[s]=o}}e.startLevel=t,e.endLevel=i,""!==this.normal.value&&(e.levelSettings.Normal=+this.normal.value)},e.prototype.destroy=function(){if(this.pageNumber&&(this.pageNumber.destroy(),this.pageNumber=void 0),this.rightAlign&&(this.rightAlign.destroy(),this.rightAlign=void 0),this.tabLeader&&(this.tabLeader.destroy(),this.tabLeader=void 0),this.showLevel&&(this.showLevel.destroy(),this.showLevel=void 0),this.hyperlink&&(this.hyperlink.destroy(),this.hyperlink=void 0),this.style&&(this.style.destroy(),this.style=void 0),this.outline&&(this.outline.destroy(),this.outline=void 0),this.listViewInstance&&(this.listViewInstance.destroy(),this.listViewInstance=void 0),this.heading1=void 0,this.heading2=void 0,this.heading3=void 0,this.heading4=void 0,this.heading5=void 0,this.heading6=void 0,this.heading7=void 0,this.heading8=void 0,this.heading9=void 0,this.normal=void 0,this.textBoxInput=void 0,this.documentHelper=void 0,!i.i(n.isNullOrUndefined)(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[e]),e--;this.target=void 0}},e}())},function(e,t,i){"use strict";i.d(t,"a",function(){return l});var n=i(3),r=(i.n(n),i(5)),o=(i.n(r),i(7)),s=i(0),a=(i.n(s),i(34)),l=function(){function e(e){var t=this;this.applyTableCellProperties=function(){var e=t.documentHelper.selection.tableFormat;i.i(s.isNullOrUndefined)(t.bottomMarginBox.value||t.leftMarginBox.value||t.rightMarginBox.value||t.topMarginBox.value||t.cellSpaceTextBox.value)||e.bottomMargin===t.bottomMarginBox.value&&e.leftMargin===t.leftMarginBox.value&&e.rightMargin===t.rightMarginBox.value&&e.topMargin===t.topMarginBox.value&&e.cellSpacing===t.cellSpaceTextBox.value||(t.documentHelper.owner.tablePropertiesDialogModule.isTableOptionsUpdated=!0,t.applyTableOptions(t.tableFormat),t.documentHelper.owner.tablePropertiesDialogModule.applyTableSubProperties()),t.closeCellMarginsDialog()},this.closeCellMarginsDialog=function(){t.documentHelper.dialog.hide(),t.documentHelper.dialog.element.style.pointerEvents="",t.documentHelper.updateFocus()},this.changeAllowSpaceCheckBox=function(){t.allowSpaceCheckBox.checked?t.cellSpaceTextBox.enabled=!0:(t.cellSpaceTextBox.enabled=!1,t.cellSpaceTextBox.value=0)},this.removeEvents=function(){t.documentHelper.dialog2.element.style.pointerEvents="",t.documentHelper.updateFocus()},this.documentHelper=e}return Object.defineProperty(e.prototype,"tableFormat",{get:function(){return i.i(s.isNullOrUndefined)(this.tableFormatIn)?this.tableFormatIn=new o.M:this.tableFormatIn},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"TableOptionsDialog"},e.prototype.initTableOptionsDialog=function(e,t){this.target=i.i(s.createElement)("div",{id:this.documentHelper.owner.containerId+"_insertCellMarginsDialog",className:"e-de-table-options-dlg"});var o=i.i(s.createElement)("div"),l=i.i(s.createElement)("Label",{id:this.target.id+"_innerDivLabel",className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Default cell margins")});o.appendChild(l),a.b.getCellMarginDialogElements(this,o,e,!1);var d=i.i(s.createElement)("div"),h=i.i(s.createElement)("Label",{className:"e-de-para-dlg-heading",id:this.target.id+"_cellSpaceLabel"});h.innerHTML=e.getConstant("Default cell spacing"),d.appendChild(h);var c,p=i.i(s.createElement)("TABLE",{styles:"height: 30px;"}),u=i.i(s.createElement)("tr"),g=i.i(s.createElement)("td"),f=i.i(s.createElement)("input",{attrs:{type:"checkbox"},id:this.target.id+"_cellcheck"});c=t?"padding-right:25px;":"padding-left:25px;";var m=i.i(s.createElement)("td",{styles:c});this.cellspacingTextBox=i.i(s.createElement)("input",{attrs:{type:"text"},id:this.target.id+"_cellspacing"}),g.appendChild(f),m.appendChild(this.cellspacingTextBox),u.appendChild(g),u.appendChild(m),p.appendChild(u),d.appendChild(p);var v=document.createElement("div");this.target.appendChild(d),this.target.appendChild(v),this.cellSpaceTextBox=new r.NumericTextBox({value:0,min:0,max:264.5,width:174,decimals:2,enablePersistence:!1}),this.cellSpaceTextBox.appendTo(this.cellspacingTextBox),this.allowSpaceCheckBox=new n.CheckBox({label:e.getConstant("Allow spacing between cells"),change:this.changeAllowSpaceCheckBox,enableRtl:t,cssClass:"e-de-tbl-margin-sub-header"}),this.allowSpaceCheckBox.appendTo(f),f.setAttribute("aria-label",e.getConstant("Allow spacing between cells")),this.cellspacingTextBox.setAttribute("aria-label","cell spacing")},e.prototype.loadCellMarginsDialog=function(){var e=this.documentHelper.selection.tableFormat;this.cellSpaceTextBox.value=e.cellSpacing,this.bottomMarginBox.value=e.bottomMargin,this.topMarginBox.value=e.topMargin,this.rightMarginBox.value=e.rightMargin,this.leftMarginBox.value=e.leftMargin,e.cellSpacing>0?(this.allowSpaceCheckBox.checked=!0,this.cellSpaceTextBox.enabled=!0):(this.allowSpaceCheckBox.checked=!1,this.cellSpaceTextBox.enabled=!1)},e.prototype.applySubTableOptions=function(e,t){this.documentHelper.owner.editorHistory.initComplexHistory(this.documentHelper.selection,"TableMarginsSelection"),this.applyTableOptionsHistory(e,t),i.i(s.isNullOrUndefined)(this.documentHelper.owner.editorHistory.currentHistoryInfo)||this.documentHelper.owner.editorHistory.updateComplexHistory()},e.prototype.applyTableOptionsHelper=function(e){this.applySubTableOptionsHelper(e,void 0)},e.prototype.applyTableOptionsHistory=function(e,t){this.documentHelper.owner.editorModule.initHistory("TableOptions"),this.applySubTableOptionsHelper(e,t)},e.prototype.applySubTableOptionsHelper=function(e,t){i.i(s.isNullOrUndefined)(t)&&(t=this.documentHelper.selection.start.currentWidget.paragraph.associatedCell.ownerTable,t=t.combineWidget(this.documentHelper.owner.viewer));var n=t.tableFormat;i.i(s.isNullOrUndefined)(this.documentHelper.owner.editorHistory.currentBaseHistoryInfo)||this.documentHelper.owner.editorHistory.currentBaseHistoryInfo.addModifiedTableOptions(n),n.cellSpacing=e.cellSpacing,n.leftMargin=e.leftMargin,n.topMargin=e.topMargin,n.rightMargin=e.rightMargin,n.bottomMargin=e.bottomMargin,this.documentHelper.owner.tablePropertiesDialogModule.calculateGridValue(t)},e.prototype.applyTableOptions=function(e){e.leftMargin=this.leftMarginBox.value,e.topMargin=this.topMarginBox.value,e.bottomMargin=this.bottomMarginBox.value,e.rightMargin=this.rightMarginBox.value,e.cellSpacing=this.cellSpaceTextBox.value},e.prototype.show=function(){var e=new s.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),this.target||this.initTableOptionsDialog(e,this.documentHelper.owner.enableRtl),this.loadCellMarginsDialog(),this.documentHelper.dialog.header=e.getConstant("Table Options"),this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=void 0,this.documentHelper.dialog.position={X:"center",Y:"center"},this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.open=void 0,this.documentHelper.dialog.beforeOpen=this.documentHelper.updateFocus,this.documentHelper.dialog.close=this.removeEvents,this.documentHelper.dialog.buttons=[{click:this.applyTableCellProperties,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-table-cell-okay",isPrimary:!0}},{click:this.closeCellMarginsDialog,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-table-cell-cancel"}}],this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show()},e.prototype.destroy=function(){if(!i.i(s.isNullOrUndefined)(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[e]),e--;this.target=void 0}this.tableFormatIn&&(this.tableFormatIn.destroy(),this.tableFormatIn=void 0),this.dialog=void 0,this.target=void 0,this.documentHelper=void 0,this.cellspacingTextBox=void 0,this.allowSpaceCheckBox=void 0},e}()},function(e,t,i){"use strict";i.d(t,"a",function(){return h});var n=i(0),r=(i.n(n),i(5)),o=(i.n(r),i(9)),s=i(3),a=(i.n(s),i(10)),l=(i.n(a),i(15)),d=(i.n(l),i(4)),h=function(){function e(e){var t=this;this.hasTableWidth=!1,this.hasCellWidth=!1,this.bidi=!1,this.isTableBordersAndShadingUpdated=!1,this.isCellBordersAndShadingUpdated=!1,this.tabObj=void 0,this.localValue=void 0,this.isCellOptionsUpdated=!1,this.isTableOptionsUpdated=!1,this.onBeforeOpen=function(){t.documentHelper.updateFocus(),t.loadTableProperties()},this.onCloseTablePropertyDialog=function(){t.unWireEvent.bind(t),t.documentHelper.updateFocus()},this.applyTableProperties=function(){var e=t.documentHelper.selection;if(e.tableFormat.title!=t.titleTextBox.value&&(i.i(n.isNullOrUndefined)(t.titleTextBox.value)||(t.tableFormat.title=n.SanitizeHtmlHelper.sanitize(t.titleTextBox.value))),e.tableFormat.description!=t.descriptionTextBox.value&&(i.i(n.isNullOrUndefined)(t.descriptionTextBox.value)||(t.tableFormat.description=n.SanitizeHtmlHelper.sanitize(t.descriptionTextBox.value))),t.preferCheckBox.checked||t.preferCheckBox.indeterminate||(i.i(n.isNullOrUndefined)(e.tableFormat.preferredWidth)||0!==e.tableFormat.preferredWidth)&&(t.tableFormat.preferredWidth=0,t.tableFormat.preferredWidthType="Point"),t.tableFormat.hasValue("tableAlignment")&&"Left"!==t.tableFormat.tableAlignment&&(i.i(n.isNullOrUndefined)(e.tableFormat.leftIndent)||0!==e.tableFormat.leftIndent)&&(t.tableFormat.leftIndent=0),t.rowHeightCheckBox.checked||t.rowHeightCheckBox.indeterminate||(i.i(n.isNullOrUndefined)(e.rowFormat.height)||0!==e.rowFormat.height)&&(t.rowFormat.heightType="AtLeast",t.rowFormat.height=0),t.preferredCellWidthCheckBox.checked||t.preferredCellWidthCheckBox.indeterminate){for(var r=t.documentHelper.selection.start.paragraph.associatedCell.ownerTable,o=r.getOwnerWidth(!0),s=r.getTableClientWidth(o),a=0;a<r.childWidgets.length;a++)for(var l=r.childWidgets[parseInt(a.toString(),10)],h=0;h<l.childWidgets.length;h++){var c=l.childWidgets[parseInt(h.toString(),10)];"Percent"===t.cellFormat.preferredWidthType&&"Point"===c.cellFormat.preferredWidthType?(c.cellFormat.preferredWidthType="Percent",c.cellFormat.preferredWidth=c.cellFormat.preferredWidth/s*100):"Point"===t.cellFormat.preferredWidthType&&"Percent"===c.cellFormat.preferredWidthType&&(c.cellFormat.preferredWidthType="Point",c.cellFormat.preferredWidth=c.cellFormat.cellWidth)}if("Percent"===t.cellFormat.preferredWidthType&&!t.tableFormat.hasValue("preferredWidth")&&!t.tableFormat.hasValue("preferredWidthType")&&0===t.documentHelper.selection.start.paragraph.associatedCell.ownerTable.tableFormat.preferredWidth){var p=t.documentHelper.selection.start.paragraph.associatedCell.ownerTable.getOwnerWidth(!0),u=t.documentHelper.selection.start.paragraph.associatedCell.ownerTable.getTableClientWidth(p);t.tableFormat.preferredWidthType="Percent",t.tableFormat.preferredWidth=u/d.a.convertPixelToPoint(t.documentHelper.owner.viewer.clientArea.width)*100}}else(i.i(n.isNullOrUndefined)(e.cellFormat.preferredWidth)||0!==e.cellFormat.preferredWidth)&&(t.cellFormat.preferredWidthType="Point",t.cellFormat.preferredWidth=0);t.rowHeightValue&&(t.rowFormat.hasValue("heightType")||e.rowFormat.heightType===t.rowFormat.heightType||(t.rowFormat.heightType=e.rowFormat.heightType),t.rowFormat.height=t.rowHeightValue),t.documentHelper.owner.editorModule.initComplexHistory("TableProperties"),t.documentHelper.owner.editorModule.onTableFormat(t.tableFormat),t.documentHelper.owner.editorModule.onRowFormat(t.rowFormat),t.documentHelper.owner.editorModule.onCellFormat(t.cellFormat),t.documentHelper.owner.editorHistory.updateComplexHistory(),t.closeTablePropertiesDialog(),t.documentHelper.updateFocus()},this.applyTableSubProperties=function(){if(t.isCellOptionsUpdated){var e=t.documentHelper.owner.cellOptionsDialogModule.cellFormat;t.documentHelper.owner.cellOptionsDialogModule.applySubCellOptions(e)}if(t.isTableOptionsUpdated){var i=t.documentHelper.owner.tableOptionsDialogModule.tableFormat;t.documentHelper.owner.tableOptionsDialogModule.applySubTableOptions(i)}t.isCellOptionsUpdated=!1,t.isTableOptionsUpdated=!1},this.unWireEvent=function(){t.preferCheckBox.change=void 0,t.tableWidthBox.change=void 0,t.tableWidthType.change=void 0,t.leftIndentBox.change=void 0,t.rowHeightCheckBox.change=void 0,t.rowHeightBox.change=void 0,t.rowHeightType.change=void 0,t.repeatHeader.change=void 0,t.allowRowBreak.change=void 0,t.preferredCellWidthCheckBox.change=void 0,t.cellWidthBox.change=void 0,t.cellWidthType.change=void 0,t.cellFormat.destroy(),t.rowFormat.destroy(),t.tableFormat.destroy(),t.rowHeightValue=void 0,t.documentHelper.dialog2.open=t.documentHelper.selection.hideCaret.bind(t.documentHelper.owner.viewer)},this.closeTablePropertiesDialog=function(){t.documentHelper.dialog2.hide(),t.documentHelper.updateFocus()},this.changeBidirectional=function(e){"ltr"===e.value?(t.rtlButton.checked=!t.ltrButton.checked,t.tableFormat.bidi=!1):(t.ltrButton.checked=!t.rtlButton.checked,t.tableFormat.bidi=!0),t.tableFormat.bidi&&"Left"===t.tableFormat.tableAlignment?t.tableFormat.tableAlignment="Right":t.tableFormat.bidi||"Right"!==t.tableFormat.tableAlignment||(t.tableFormat.tableAlignment="Left"),t.activeTableAlignment(t.tableFormat,!0)},this.changeTableCheckBox=function(){var e=t.preferCheckBox.checked||t.preferCheckBox.indeterminate;t.tableWidthBox.enabled=e,t.tableWidthType.enabled=e,t.tableFormat.preferredWidthType=e?"Points"===t.tableWidthType.value?"Point":t.tableWidthType.value:t.documentHelper.selection.tableFormat.preferredWidthType},this.changeTableAlignment=function(e){t.updateClassForAlignmentProperties(t.tableTab);var r=e.target;i.i(n.classList)(r,["e-de-table-alignment-active"],["e-de-table-properties-alignment"]);var o=t.tableFormat.bidi||t.rtlButton.checked;r.classList.contains("e-de-table-left-alignment")&&!o||r.classList.contains("e-de-table-right-alignment")&&o?t.leftIndentBox.enabled=!0:t.leftIndentBox.enabled=!1,t.tableFormat.tableAlignment=t.getTableAlignment()},this.changeTableRowCheckBox=function(){t.rowHeightType.enabled=t.rowHeightCheckBox.checked,t.rowHeightBox.enabled=t.rowHeightCheckBox.checked,t.rowHeightType.enabled?t.rowFormat.heightType=t.rowHeightType.value:t.rowFormat.heightType=t.documentHelper.selection.rowFormat.heightType},this.changeTableCellCheckBox=function(){t.cellWidthType.enabled=t.preferredCellWidthCheckBox.checked,t.cellWidthBox.enabled=t.preferredCellWidthCheckBox.checked},this.changeCellAlignment=function(e){t.updateClassForCellAlignment(t.cellTab);var r=e.target;i.i(n.classList)(r,["e-de-table-alignment-active"],["e-de-tablecell-alignment"]),t.cellFormat.verticalAlignment=t.getCellAlignment()},this.showTableOptionsDialog=function(){t.documentHelper.owner.tableOptionsDialogModule.show(),t.documentHelper.dialog2.element.style.pointerEvents="none"},this.showBordersShadingsPropertiesDialog=function(){t.documentHelper.owner.bordersAndShadingDialogModule.show(),t.documentHelper.dialog2.element.style.pointerEvents="none"},this.showCellOptionsDialog=function(){t.documentHelper.owner.cellOptionsDialogModule.show(),t.documentHelper.dialog2.element.style.pointerEvents="none"},this.documentHelper=e}return Object.defineProperty(e.prototype,"cellFormat",{get:function(){return i.i(n.isNullOrUndefined)(this.cellFormatIn)?this.cellFormatIn=new o.f:this.cellFormatIn},set:function(e){this.cellFormatIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tableFormat",{get:function(){return i.i(n.isNullOrUndefined)(this.tableFormatIn)?(this.tableFormatIn=new o.b,this.tableFormatIn):this.tableFormatIn},set:function(e){this.tableFormatIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paraFormat",{get:function(){return i.i(n.isNullOrUndefined)(this.tableFormatIn)?(this.paraFormatIn=new o.a,this.paraFormatIn):this.paraFormatIn},set:function(e){this.paraFormatIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rowFormat",{get:function(){return i.i(n.isNullOrUndefined)(this.rowFormatInternal)?(this.rowFormatInternal=new o.e,this.rowFormatInternal):this.rowFormatInternal},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"TablePropertiesDialog"},e.prototype.initTablePropertyDialog=function(e,t){this.localValue=e;var r=this.documentHelper.owner.containerId+"_TablePropertiesDialog";this.target=i.i(n.createElement)("div",{id:r,className:"e-de-table-properties-dlg"});var o=i.i(n.createElement)("div",{id:this.target.id+"_TabContainer"});this.target.appendChild(o),this.tableTab=i.i(n.createElement)("div",{id:this.target.id+"_TablePropertiesContentDialogTab",className:"e-de-table-ppty-dlg-tabs"}),this.rowTab=i.i(n.createElement)("div",{id:this.target.id+"_RowPropertiesDialogTab",className:"e-de-table-ppty-dlg-tabs"}),this.cellTab=i.i(n.createElement)("div",{id:this.target.id+"_CellPropertiesDialogTab",className:"e-de-table-ppty-dlg-tabs"}),this.altTab=i.i(n.createElement)("div",{id:this.target.id+"_AltPropertiesDialogTab",className:"e-de-table-ppty-dlg-tabs"});var s=i.i(n.createElement)("div",{className:"e-de-table-dialog-separator-line"}),a=i.i(n.createElement)("div",{id:this.target.id+"_TablePropertiesDialogTab",className:"e-de-table-ppty-tab"}),d=i.i(n.createElement)("div",{className:"e-tab-header"}),h=i.i(n.createElement)("div",{id:this.target.id+"_tableHeader",innerHTML:e.getConstant("Table")}),c=i.i(n.createElement)("div",{id:this.target.id+"_rowHeader",innerHTML:e.getConstant("Row")}),p=i.i(n.createElement)("div",{id:this.target.id+"_cellHeader",innerHTML:e.getConstant("Cell")}),u=i.i(n.createElement)("div",{id:this.target.id+"_altHeader",innerHTML:e.getConstant("Alt Text")});d.appendChild(h),d.appendChild(c),d.appendChild(p),d.appendChild(u);var g=i.i(n.createElement)("div",{id:this.target.id+"_tableContent"}),f=i.i(n.createElement)("div",{id:this.target.id+"_rowContent"}),m=i.i(n.createElement)("div",{id:this.target.id+"_cellContent"}),v=i.i(n.createElement)("div",{id:this.target.id+"_altContent"}),y=[{header:{text:h},content:g},{header:{text:c},content:f},{header:{text:p},content:m},{header:{text:u},content:v}];g.appendChild(this.tableTab),f.appendChild(this.rowTab),m.appendChild(this.cellTab),v.appendChild(this.altTab),o.appendChild(a),this.initTableProperties(this.tableTab,e,this.documentHelper.owner.enableRtl),this.initTableRowProperties(this.rowTab,e,this.documentHelper.owner.enableRtl),this.initTableCellProperties(this.cellTab,e,this.documentHelper.owner.enableRtl),this.initTableAltProperties(this.altTab,e,this.documentHelper.owner.enableRtl),this.tabObj=new l.Tab({items:y,enableRtl:t},a),this.tabObj.isStringTemplate=!0,this.target.appendChild(s);for(var w=this.tableTab.getElementsByClassName(this.tableTab.id+"e-de-table-alignment"),b=0;b<w.length;b++)w[parseInt(b.toString(),10)].addEventListener("click",this.changeTableAlignment);for(var x=this.cellTab.getElementsByClassName(this.cellTab.id+"e-de-table-cell-alignment"),b=0;b<x.length;b++)x[parseInt(b.toString(),10)].addEventListener("click",this.changeCellAlignment)},e.prototype.show=function(){var e=new n.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),this.target||this.initTablePropertyDialog(e,this.documentHelper.owner.enableRtl),"none"!==this.documentHelper.selection.caret.style.display&&(this.documentHelper.selection.caret.style.display="none"),this.documentHelper.dialog2.header=e.getConstant("Table Properties"),this.documentHelper.dialog2.position={X:"center",Y:"center"},this.documentHelper.dialog2.animationSettings={effect:"None",duration:400,delay:0},this.documentHelper.dialog2.width="auto",this.documentHelper.dialog2.height="auto",this.documentHelper.dialog2.content=this.target,this.documentHelper.dialog2.beforeOpen=this.onBeforeOpen,this.documentHelper.dialog2.close=this.onCloseTablePropertyDialog,this.documentHelper.dialog2.open=this.wireEvent.bind(this),this.documentHelper.dialog2.buttons=[{click:this.applyTableProperties,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-table-ppty-okay",isPrimary:!0}},{click:this.closeTablePropertiesDialog,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-table-ppty-cancel"}}],this.documentHelper.dialog2.dataBind(),this.documentHelper.dialog2.show();var t=this.documentHelper.dialog2.element;t&&this.documentHelper.updateDialogTabHeight(t,this.target)},e.prototype.calculateGridValue=function(e){e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0,this.documentHelper.selection.owner.isLayoutEnabled=!0,this.documentHelper.layout.reLayoutTable(e),this.documentHelper.owner.editorModule.reLayout(this.documentHelper.selection),this.documentHelper.owner.editorModule.updateSelectionTextPosition(!0);var t=this.documentHelper.owner.editorHistory;t&&t.currentBaseHistoryInfo&&(t.currentBaseHistoryInfo.modifiedProperties.length>0&&t.currentBaseHistoryInfo.updateSelection(),t.updateHistory()),this.documentHelper.owner.editorModule.fireContentChange()},e.prototype.loadTableProperties=function(){this.setTableProperties(),this.setTableRowProperties(),this.setTableCellProperties(),this.setTableAltProperties(),this.documentHelper.owner.bordersAndShadingDialogModule?this.bordersAndShadingButton.disabled=!1:this.bordersAndShadingButton.disabled=!0,this.tableOptionButton.disabled=!1,this.cellOptionButton.disabled=!1},e.prototype.wireEvent=function(){this.documentHelper.selection.hideCaret(),this.preferCheckBox.change=this.changeTableCheckBox.bind(this),this.tableWidthBox.change=this.onTableWidthChange.bind(this),this.tableWidthType.change=this.onTableWidthTypeChange.bind(this),this.leftIndentBox.change=this.onLeftIndentChange.bind(this),this.rowHeightCheckBox.change=this.changeTableRowCheckBox.bind(this),this.rowHeightBox.change=this.onRowHeightChange.bind(this),this.rowHeightType.change=this.onRowHeightTypeChange.bind(this),this.allowRowBreak.change=this.onAllowBreakAcrossPage.bind(this),this.repeatHeader.change=this.onRepeatHeader.bind(this),this.preferredCellWidthCheckBox.change=this.changeTableCellCheckBox.bind(this),this.cellWidthBox.change=this.onCellWidthChange.bind(this),this.cellWidthType.change=this.onCellWidthTypeChange.bind(this)},e.prototype.initTableProperties=function(e,t,o){var l=i.i(n.createElement)("div",{className:"e-de-table-dialog-size-label"}),d=i.i(n.createElement)("div",{innerHTML:t.getConstant("Size"),className:"e-de-para-dlg-heading"}),h=i.i(n.createElement)("div",{className:"e-de-table-ppty-options-break"}),c=i.i(n.createElement)("input",{attrs:{type:"checkbox"}}),p=i.i(n.createElement)("div",{className:"e-de-container-row"}),u=i.i(n.createElement)("div",{className:"e-de-subcontainer-left e-de-table-dialog-row-height"});this.preferredWidth=i.i(n.createElement)("input");var g=i.i(n.createElement)("div",{className:"e-de-subcontainer-right"}),f=i.i(n.createElement)("select",{innerHTML:'<option value="Points">'+t.getConstant("Points")+'</option><option value="Percent">'+t.getConstant("Percent")+"</option>"}),m=i.i(n.createElement)("div",{className:"e-de-dlg-row"}),v=i.i(n.createElement)("div",{className:"e-de-subcontainer-left"}),y=i.i(n.createElement)("div",{innerHTML:t.getConstant("Alignment"),className:"e-de-table-dlg-alignment-heading"}),w=i.i(n.createElement)("div",{className:"e-de-container-row"}),b=e.id+"e-de-table-alignment e-de-table-dialog-alignment-icon",x=i.i(n.createElement)("div"),C=i.i(n.createElement)("div",{className:"e-de-table-dia-align-div"});this.left=i.i(n.createElement)("div",{className:"e-icons e-de-table-properties-alignment e-de-table-left-alignment "+b,id:e.id+"_left_alignment"}),C.appendChild(this.left),C.setAttribute("aria-label",t.getConstant("Left"));var I=i.i(n.createElement)("div",{className:"e-de-table-dia-align-div"});this.center=i.i(n.createElement)("div",{className:"e-icons e-de-table-properties-alignment  e-de-table-center-alignment "+b,id:e.id+"_center_alignment"}),I.appendChild(this.center),I.setAttribute("aria-label",t.getConstant("Center")),this.right=i.i(n.createElement)("div",{className:"e-icons e-de-table-properties-alignment  e-de-table-right-alignment "+b,id:e.id+"_right_alignment"});var F=i.i(n.createElement)("div",{className:"e-de-table-dia-align-div"});F.appendChild(this.right),F.setAttribute("aria-label",t.getConstant("Right"));var k=i.i(n.createElement)("label",{innerHTML:t.getConstant("Left"),className:"e-de-table-dia-align-label"}),P=i.i(n.createElement)("label",{innerHTML:t.getConstant("Center"),className:"e-de-table-dia-align-label"}),T=i.i(n.createElement)("label",{innerHTML:t.getConstant("Right"),className:"e-de-table-dia-align-label"}),S=i.i(n.createElement)("div",{className:"e-de-subcontainer-right"});this.leftIndent=i.i(n.createElement)("input");var W=i.i(n.createElement)("div",{innerHTML:t.getConstant("Table direction"),className:"e-de-para-dlg-heading"}),N=i.i(n.createElement)("div",{className:"e-de-dlg-row"}),H=i.i(n.createElement)("div",{className:"e-de-tbl-rtl-btn-div"}),E=i.i(n.createElement)("input");H.appendChild(E),N.appendChild(H);var O=i.i(n.createElement)("div",{className:"e-de-tbl-ltr-btn-div"}),_=i.i(n.createElement)("input");O.appendChild(_),N.appendChild(O),this.rtlButton=new s.RadioButton({label:t.getConstant("Right-to-left"),value:"rtl",cssClass:"e-small",change:this.changeBidirectional,enableRtl:o}),this.rtlButton.appendTo(E),E.setAttribute("aria-label",t.getConstant("Right-to-left")),this.ltrButton=new s.RadioButton({label:t.getConstant("Left-to-right"),value:"ltr",cssClass:"e-small",change:this.changeBidirectional,enableRtl:o}),this.ltrButton.appendTo(_),_.setAttribute("aria-label",t.getConstant("Left-to-right"));var B=i.i(n.createElement)("div",{className:"e-de-tbl-dlg-border-btn"});this.bordersAndShadingButton=i.i(n.createElement)("button",{innerHTML:t.getConstant("Borders and Shading")+"...",className:"e-control e-btn e-de-ok-button",attrs:{type:"button"}}),this.tableOptionButton=i.i(n.createElement)("button",{className:"e-control e-btn",innerHTML:t.getConstant("Options")+"...",attrs:{type:"button"}}),this.tableOptionButton.addEventListener("click",this.showTableOptionsDialog),this.bordersAndShadingButton.addEventListener("click",this.showBordersShadingsPropertiesDialog),B.appendChild(this.bordersAndShadingButton),B.appendChild(this.tableOptionButton),S.appendChild(this.leftIndent),w.appendChild(x),v.appendChild(y),x.appendChild(C),v.appendChild(w),w.appendChild(I),w.appendChild(F),C.appendChild(k),I.appendChild(P),F.appendChild(T),m.appendChild(v),l.appendChild(d),e.appendChild(l),h.appendChild(c),l.appendChild(h),u.appendChild(this.preferredWidth),l.appendChild(p),g.appendChild(f),m.appendChild(S),p.appendChild(u),p.appendChild(g),e.appendChild(m),e.appendChild(W),e.appendChild(N),e.appendChild(B),this.tableWidthBox=new r.NumericTextBox({value:0,decimals:2,min:0,max:1584,enablePersistence:!1}),this.tableWidthBox.appendTo(this.preferredWidth),this.leftIndentBox=new r.NumericTextBox({value:0,decimals:2,min:-1584,max:1584,enablePersistence:!1,floatLabelType:"Always",placeholder:t.getConstant("Indent from left")}),this.leftIndentBox.appendTo(this.leftIndent),this.preferCheckBox=new s.CheckBox({label:t.getConstant("Preferred Width"),enableRtl:o}),this.preferCheckBox.appendTo(c),c.setAttribute("aria-label",t.getConstant("Preferred Width")),this.leftIndent.setAttribute("aria-labelledby",t.getConstant("Indent from left")),this.tableWidthType=new a.DropDownList({enableRtl:o,floatLabelType:"Always",placeholder:t.getConstant("Measure in"),htmlAttributes:{"aria-labelledby":t.getConstant("Measure in")}}),this.tableWidthType.appendTo(f),o&&(H.classList.add("e-de-rtl"),S.classList.add("e-de-rtl"),B.classList.add("e-de-rtl"),C.classList.add("e-de-rtl"),I.classList.add("e-de-rtl"),F.classList.add("e-de-rtl"))},e.prototype.onTableWidthChange=function(){this.tableFormat.preferredWidth=this.tableWidthBox.value},e.prototype.onTableWidthTypeChange=function(){var e,t=d.a.convertPixelToPoint(this.documentHelper.owner.viewer.clientArea.width);"Percent"===this.tableWidthType.text&&"Percent"!==this.documentHelper.selection.tableFormat.preferredWidthType?(e=this.tableWidthBox.value/t*100,this.formatNumericTextBox(this.tableWidthBox,"Percent",e)):"Points"===this.tableWidthType.text&&"Point"!==this.documentHelper.selection.tableFormat.preferredWidthType?(e=t/100*this.tableWidthBox.value,this.formatNumericTextBox(this.tableWidthBox,"Point",e)):(e="#'%'"===this.tableWidthBox.format?"Points"===this.tableWidthType.text?t/100*this.tableWidthBox.value:this.tableWidthBox.value:"Percent"===this.tableWidthType.text?this.tableWidthBox.value/t*100:this.tableWidthBox.value,this.formatNumericTextBox(this.tableWidthBox,"Points"===this.tableWidthType.text?"Point":this.tableWidthType.text,e)),this.tableFormat.preferredWidthType="Points"===this.tableWidthType.text?"Point":this.tableWidthType.text},e.prototype.onLeftIndentChange=function(){this.tableFormat.leftIndent=this.leftIndentBox.value},e.prototype.setTableAltProperties=function(){var e=this.documentHelper.selection.tableFormat;i.i(n.isNullOrUndefined)(e.title)?this.titleTextBox.value="":this.titleTextBox.value=e.title,i.i(n.isNullOrUndefined)(e.description)?this.descriptionTextBox.value="":this.descriptionTextBox.value=e.description},e.prototype.setTableProperties=function(){var e=this.documentHelper.selection.tableFormat,t=e.preferredWidth>0,r=e.preferredWidth;if(i.i(n.isNullOrUndefined)(e.preferredWidth)){this.preferCheckBox.indeterminate=!0;r=this.documentHelper.selection.start.paragraph.associatedCell.ownerTable.combineWidget(this.documentHelper.owner.viewer).tableFormat.preferredWidth}else this.preferCheckBox.checked=t;this.tableWidthBox.enabled=t,this.tableWidthType.enabled=t,this.formatNumericTextBox(this.tableWidthBox,e.preferredWidthType,r),"Auto"===e.preferredWidthType||"Point"===e.preferredWidthType?this.tableWidthType.index=0:this.tableWidthType.index=1,this.activeTableAlignment(e,!1),e.bidi?(this.rtlButton.checked=!0,this.ltrButton.checked=!1):(this.ltrButton.checked=!0,this.rtlButton.checked=!1)},e.prototype.activeTableAlignment=function(e,t){var r=t?this.tableFormat.tableAlignment:void 0;i.i(n.isNullOrUndefined)(r)&&(e.bidi?"Left"===e.tableAlignment?r="Right":"Right"===e.tableAlignment&&(r="Left"):r=e.tableAlignment),e.bidi?(this.leftIndentBox.enabled="Right"===r,this.leftIndentBox.placeholder=this.localValue.getConstant("Indent from right")):(this.leftIndentBox.enabled="Left"===r,this.leftIndentBox.placeholder=this.localValue.getConstant("Indent from left")),this.leftIndentBox.value=e.leftIndent,i.i(n.classList)(this.left,[],["e-de-table-alignment-active"]),i.i(n.classList)(this.right,[],["e-de-table-alignment-active"]),i.i(n.classList)(this.center,[],["e-de-table-alignment-active"]),"Left"===r?i.i(n.classList)(this.left,["e-de-table-alignment-active"],["e-de-table-properties-alignment"]):"Center"===r?i.i(n.classList)(this.center,["e-de-table-alignment-active"],["e-de-table-properties-alignment"]):"Right"===r&&i.i(n.classList)(this.right,["e-de-table-alignment-active"],["e-de-table-properties-alignment"])},e.prototype.getTableAlignment=function(){for(var e=this.tableTab.id,t=this.tableTab.getElementsByClassName(e+"e-de-table-alignment"),i=0;i<t.length;i++){if(t[parseInt(i.toString(),10)].classList.contains("e-de-table-alignment-active"))return 0===i?this.ltrButton.checked?"Left":"Right":1===i?"Center":this.ltrButton.checked?"Right":"Left"}},e.prototype.updateClassForAlignmentProperties=function(e){for(var t=e.id,r=e.getElementsByClassName(t+"e-de-table-alignment"),o=0;o<r.length;o++){var s=r[parseInt(o.toString(),10)];s.classList.contains("e-de-table-alignment-active")&&i.i(n.classList)(s,["e-de-table-properties-alignment"],["e-de-table-alignment-active"])}},e.prototype.initTableRowProperties=function(e,t,o){var l=i.i(n.createElement)("div",{className:"e-de-table-dialog-size-label"}),d=i.i(n.createElement)("div",{innerHTML:t.getConstant("Size"),className:"e-de-para-dlg-heading"}),h=i.i(n.createElement)("div",{className:"e-de-table-ppty-options-break"}),c=i.i(n.createElement)("input",{attrs:{type:"checkbox"}}),p=i.i(n.createElement)("div",{className:"e-de-container-row"}),u=i.i(n.createElement)("div",{className:"e-de-subcontainer-left e-de-table-dialog-row-height"});this.rowHeight=i.i(n.createElement)("input",{attrs:{type:"text"}});var g=i.i(n.createElement)("div",{className:"e-de-subcontainer-right"}),f=i.i(n.createElement)("select",{innerHTML:'<option value="AtLeast">'+t.getConstant("At least")+'</option><option value="Exactly">'+t.getConstant("Exactly")+"</option>"});l.appendChild(d),e.appendChild(l),h.appendChild(c),l.appendChild(h),p.appendChild(u),l.appendChild(p),u.appendChild(this.rowHeight),g.appendChild(f),p.appendChild(g);var m=i.i(n.createElement)("div",{innerHTML:t.getConstant("Options")+"...",className:"e-de-para-dlg-heading"}),v=i.i(n.createElement)("div",{className:"e-de-table-ppty-options-break"}),y=i.i(n.createElement)("div",{className:"e-de-table-ppty-options-header-row"}),w=i.i(n.createElement)("input",{attrs:{type:"checkbox"}}),b=i.i(n.createElement)("input",{attrs:{type:"checkbox"}});v.appendChild(w),y.appendChild(b),e.appendChild(m),e.appendChild(v),e.appendChild(y),this.rowHeightBox=new r.NumericTextBox({value:0,decimals:2,min:0,max:1584,enablePersistence:!1}),this.rowHeightBox.appendTo(this.rowHeight),this.rowHeightCheckBox=new s.CheckBox({label:t.getConstant("Specify height"),enableRtl:o}),this.rowHeightCheckBox.appendTo(c),c.setAttribute("aria-label",t.getConstant("Specify height")),this.rowHeightType=new a.DropDownList({enableRtl:o,floatLabelType:"Always",placeholder:t.getConstant("Row height is"),htmlAttributes:{"aria-labelledby":t.getConstant("Row height is")}}),this.rowHeightType.appendTo(f),this.allowRowBreak=new s.CheckBox({label:t.getConstant("Allow row to break across pages"),enableRtl:o}),this.allowRowBreak.appendTo(w),w.setAttribute("aria-label",t.getConstant("Allow row to break across pages")),this.repeatHeader=new s.CheckBox({label:t.getConstant("Repeat as header row at the top of each page"),enableRtl:o}),this.repeatHeader.appendTo(b),b.setAttribute("aria-label",t.getConstant("Repeat as header row at the top of each page"))},e.prototype.setTableRowProperties=function(){var e=this.documentHelper.selection.rowFormat,t=e.height>0||"Exactly"===e.heightType;t?this.rowHeightCheckBox.checked=!0:void 0===e.heightType?(this.rowHeightCheckBox.indeterminate=!0,t=!0):this.rowHeightCheckBox.checked=!1,this.rowHeightBox.enabled=t,this.rowHeightType.enabled=t;var r=!this.enableRepeatHeader();i.i(n.isNullOrUndefined)(this.documentHelper.selection.rowFormat.isHeader)?(this.repeatHeader.indeterminate=!0,this.repeatHeader.disabled=!0):this.documentHelper.selection.rowFormat.isHeader?(this.repeatHeader.checked=!r,this.repeatHeader.indeterminate=r,this.repeatHeader.disabled=r):(this.repeatHeader.checked=!1,this.repeatHeader.indeterminate=!1,this.repeatHeader.disabled=r),i.i(n.isNullOrUndefined)(e.allowBreakAcrossPages)?this.allowRowBreak.indeterminate=!0:this.allowRowBreak.checked=e.allowBreakAcrossPages,this.rowHeightBox.value=e.height,"Auto"===e.heightType||"AtLeast"===e.heightType?this.rowHeightType.index=0:this.rowHeightType.index=1},e.prototype.onRowHeightChange=function(){this.rowHeightValue=this.rowHeightBox.value},e.prototype.onRowHeightTypeChange=function(){this.rowFormat.heightType=this.rowHeightType.text},e.prototype.onAllowBreakAcrossPage=function(){this.rowFormat.allowBreakAcrossPages=this.allowRowBreak.checked},e.prototype.onRepeatHeader=function(){this.rowFormat.isHeader=this.repeatHeader.checked},e.prototype.enableRepeatHeader=function(){var e=this.documentHelper.selection,t=e.start,i=e.end;e.isForward||(t=e.end,i=e.start);var n=t.paragraph.associatedCell,r=i.paragraph.associatedCell;return 0===n.ownerRow.index&&r.ownerTable.equals(n.ownerTable)},e.prototype.initTableAltProperties=function(e,t,o){var s=i.i(n.createElement)("div",{className:"e-de-table-dialog-size-label"});e.appendChild(s);var a=i.i(n.createElement)("div",{innerHTML:t.getConstant("Title"),className:"e-de-para-dlg-heading"});s.appendChild(a);var l=i.i(n.createElement)("div",{className:"e-de-table-ppty-options-break"}),d=i.i(n.createElement)("input",{});this.titleTextBox=new r.TextBox({floatLabelType:"Never"}),s.appendChild(l),l.appendChild(d),this.titleTextBox.appendTo(d);var h=i.i(n.createElement)("div",{innerHTML:t.getConstant("Description"),className:"e-de-para-dlg-heading"});s.appendChild(h);var c=i.i(n.createElement)("div",{className:"e-de-table-ppty-options-break"}),p=i.i(n.createElement)("textarea",{});this.descriptionTextBox=new r.TextBox({floatLabelType:"Never"}),c.appendChild(p),this.descriptionTextBox.appendTo(p),s.appendChild(c)},e.prototype.initTableCellProperties=function(e,t,o){var l=i.i(n.createElement)("div",{className:"e-de-table-dialog-size-label"}),d=i.i(n.createElement)("div",{innerHTML:t.getConstant("Size"),className:"e-de-para-dlg-heading"}),h=i.i(n.createElement)("div",{className:"e-de-table-ppty-options-break"}),c=i.i(n.createElement)("input",{attrs:{type:"checkbox"}}),p=i.i(n.createElement)("div",{className:"e-de-container-row"}),u=i.i(n.createElement)("div",{className:"e-de-subcontainer-left e-de-table-dialog-row-height"});this.preferredCellWidth=i.i(n.createElement)("input",{attrs:{type:"text"}});var g=i.i(n.createElement)("div",{className:"e-de-subcontainer-right"}),f=i.i(n.createElement)("select",{innerHTML:'<option value="Points">'+t.getConstant("Points")+'</option><option value="Percent">'+t.getConstant("Percent")+"</option>"});l.appendChild(d),e.appendChild(l),h.appendChild(c),c.setAttribute("aria-label",t.getConstant("Preferred Width")),l.appendChild(h),u.appendChild(this.preferredCellWidth),l.appendChild(p),p.appendChild(u),p.appendChild(g),g.appendChild(f);var m=i.i(n.createElement)("div",{innerHTML:t.getConstant("Vertical alignment"),className:"e-de-para-dlg-heading"}),v=e.id+"e-de-table-cell-alignment e-de-tablecell-dialog-alignment-icon",y=i.i(n.createElement)("div",{className:"e-de-container-row"}),w=i.i(n.createElement)("div"),b=i.i(n.createElement)("div",{className:"e-de-tablecell-dia-align-div"});this.cellTopAlign=i.i(n.createElement)("div",{id:e.id+"_cell_top-alignment",className:"e-icons e-de-tablecell-alignment  e-de-tablecell-top-alignment "+v}),b.appendChild(this.cellTopAlign),b.setAttribute("aria-label",t.getConstant("Top"));var x=i.i(n.createElement)("div",{className:"e-de-tablecell-dia-align-div"});this.cellCenterAlign=i.i(n.createElement)("div",{id:e.id+"_cell_center-alignment",className:"e-icons e-de-tablecell-alignment  e-de-tablecell-center-alignment "+v}),x.appendChild(this.cellCenterAlign),x.setAttribute("aria-label",t.getConstant("Center"));var C=i.i(n.createElement)("div",{className:"e-de-tablecell-dia-align-div"});this.cellBottomAlign=i.i(n.createElement)("div",{id:e.id+"_cell_bottom-alignment",className:"e-icons e-de-tablecell-alignment e-de-tablecell-bottom-alignment  "+v}),C.appendChild(this.cellBottomAlign),C.setAttribute("aria-label",t.getConstant("Bottom"));var I=i.i(n.createElement)("label",{innerHTML:t.getConstant("Top"),className:"e-de-table-dia-align-label"}),F=i.i(n.createElement)("label",{innerHTML:t.getConstant("Center"),className:"e-de-table-dia-align-label"}),k=i.i(n.createElement)("label",{innerHTML:t.getConstant("Bottom"),className:"e-de-table-dia-align-label"});this.cellOptionButton=i.i(n.createElement)("button",{innerHTML:t.getConstant("Options")+"...",className:"e-control e-btn",attrs:{type:"button"}}),this.cellOptionButton.style.cssFloat=o?"left":"right",y.appendChild(w),w.appendChild(b),y.appendChild(x),y.appendChild(C),b.appendChild(I),x.appendChild(F),C.appendChild(k),e.appendChild(m),e.appendChild(y),e.appendChild(this.cellOptionButton),this.cellOptionButton.addEventListener("click",this.showCellOptionsDialog),this.cellWidthBox=new r.NumericTextBox({value:0,decimals:2,min:0,max:1584,enablePersistence:!1}),this.cellWidthBox.appendTo(this.preferredCellWidth),this.preferredCellWidthCheckBox=new s.CheckBox({label:t.getConstant("Preferred Width"),enableRtl:o}),this.preferredCellWidthCheckBox.appendTo(c),c.setAttribute("aria-label",t.getConstant("Preferred Width")),this.cellWidthType=new a.DropDownList({enableRtl:o,floatLabelType:"Always",placeholder:t.getConstant("Measure in"),htmlAttributes:{"aria-labelledby":t.getConstant("Measure in")}}),this.cellWidthType.appendTo(f)},e.prototype.setTableCellProperties=function(){var e=this.documentHelper.selection.cellFormat;this.hasCellWidth=e.preferredWidth>0;var t=e.preferredWidth;i.i(n.isNullOrUndefined)(e.preferredWidth)?(this.preferredCellWidthCheckBox.indeterminate=!0,t=this.documentHelper.selection.start.paragraph.associatedCell.cellFormat.preferredWidth):this.preferredCellWidthCheckBox.checked=this.hasCellWidth,this.cellWidthBox.enabled=this.hasCellWidth,this.cellWidthType.enabled=this.hasCellWidth,"Auto"===e.preferredWidthType||"Point"===e.preferredWidthType?this.cellWidthType.index=0:this.cellWidthType.index=1,this.formatNumericTextBox(this.cellWidthBox,e.preferredWidthType,t),i.i(n.classList)(this.cellTopAlign,["e-de-tablecell-alignment"],["e-de-table-alignment-active"]),i.i(n.classList)(this.cellCenterAlign,["e-de-tablecell-alignment"],["e-de-table-alignment-active"]),i.i(n.classList)(this.cellBottomAlign,["e-de-tablecell-alignment"],["e-de-table-alignment-active"]),"Top"===e.verticalAlignment?i.i(n.classList)(this.cellTopAlign,["e-de-table-alignment-active"],["e-de-tablecell-alignment"]):"Center"===e.verticalAlignment?i.i(n.classList)(this.cellCenterAlign,["e-de-table-alignment-active"],["e-de-tablecell-alignment"]):"Bottom"===e.verticalAlignment&&i.i(n.classList)(this.cellBottomAlign,["e-de-table-alignment-active"],["e-de-tablecell-alignment"])},e.prototype.updateClassForCellAlignment=function(e){for(var t=e.getElementsByClassName(e.id+"e-de-table-cell-alignment"),r=0;r<t.length;r++){var o=t[parseInt(r.toString(),10)];o.classList.contains("e-de-table-alignment-active")&&i.i(n.classList)(o,["e-de-tablecell-alignment"],["e-de-table-alignment-active"])}},e.prototype.formatNumericTextBox=function(e,t,i){e.format="Auto"===t||"Point"===t?"n2":"#'%'",e.step=1,e.decimals=2,e.value=i,e.htmlAttributes={"aria-label":"cellWidth"}},e.prototype.getCellAlignment=function(){for(var e=this.cellTab.id,t=this.cellTab.getElementsByClassName(e+"e-de-table-cell-alignment"),i=0;i<t.length;i++){if(t[parseInt(i.toString(),10)].classList.contains("e-de-table-alignment-active"))return 0===i?"Top":1===i?"Center":"Bottom"}return this.documentHelper.selection.cellFormat.verticalAlignment},e.prototype.onCellWidthChange=function(){this.cellFormat.preferredWidth=this.cellWidthBox.value},e.prototype.onCellWidthTypeChange=function(){var e,t=this.documentHelper.selection.start.paragraph.associatedCell.ownerTable,i=t.getOwnerWidth(!0),n=t.getTableClientWidth(i);"Percent"===this.cellWidthType.text&&"Percent"!==this.documentHelper.selection.cellFormat.preferredWidthType?(e=this.cellWidthBox.value/n*100,this.formatNumericTextBox(this.cellWidthBox,"Percent",e)):"Points"===this.cellWidthType.text&&"Point"!==this.documentHelper.selection.cellFormat.preferredWidthType?(e=n/100*this.cellWidthBox.value,this.formatNumericTextBox(this.cellWidthBox,"Point",e)):(e="#'%'"===this.cellWidthBox.format?"Points"===this.cellWidthType.text?n/100*this.cellWidthBox.value:this.cellWidthBox.value:"Percent"===this.cellWidthType.text?this.cellWidthBox.value/n*100:this.cellWidthBox.value,this.formatNumericTextBox(this.cellWidthBox,"Points"===this.cellWidthType.text?"Point":this.cellWidthType.text,e)),this.cellFormat.preferredWidthType="Points"===this.cellWidthType.text?"Point":this.cellWidthType.text},e.prototype.destroy=function(){if(!i.i(n.isNullOrUndefined)(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[parseInt(e.toString(),10)]),e--;this.target=void 0}this.dialog=void 0,this.target=void 0,this.cellAlignment=void 0,this.tableAlignment=void 0,this.documentHelper=void 0,this.preferCheckBox=void 0,this.tableWidthType=void 0,this.preferredWidth=void 0,this.rowHeightType=void 0,this.rowHeightCheckBox=void 0,this.rowHeight=void 0,this.cellWidthType=void 0,this.preferredCellWidthCheckBox=void 0,this.preferredCellWidth=void 0,this.tableTab=void 0,this.rowTab=void 0,this.cellTab=void 0,this.left=void 0,this.center=void 0,this.right=void 0,this.leftIndent=void 0,this.allowRowBreak=void 0,this.repeatHeader=void 0,this.cellTopAlign=void 0,this.cellCenterAlign=void 0,this.cellBottomAlign=void 0,this.titleTextBox=void 0,this.descriptionTextBox=void 0,this.altTab=void 0,this.paraFormatIn&&(this.paraFormatIn.destroy(),this.paraFormatIn=void 0),this.tableFormatIn&&this.tableFormatIn.destroy(),this.cellFormatIn&&this.cellFormatIn.destroy(),this.tableFormatIn=void 0,this.cellFormatIn=void 0},e}()},function(e,t,i){"use strict";i.d(t,"a",function(){return p});var n=i(6),r=i(20),o=i(1),s=i(0),a=(i.n(s),i(29)),l=i(35),d=i(53),h=i(17),c=i(4),p=function(){function e(e){this.undoStackIn=[],this.redoStackIn=[],this.historyInfoStack=[],this.isUndoGroupingEnded=!0,this.isUndoing=!1,this.isRedoing=!1,this.owner=e,this.documentHelper=e.documentHelper,this.modifiedParaFormats=new n.a,this.undoLimitIn=500,this.redoLimitIn=500}return Object.defineProperty(e.prototype,"currentHistoryInfo",{get:function(){return this.historyInfoStack&&this.historyInfoStack.length>0?this.historyInfoStack[this.historyInfoStack.length-1]:void 0},set:function(e){e instanceof d.a?this.historyInfoStack.push(e):this.historyInfoStack.pop()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"undoStack",{get:function(){return this.undoStackIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redoStack",{get:function(){return this.redoStackIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"undoLimit",{get:function(){return i.i(s.isNullOrUndefined)(this.undoLimitIn)?0:this.undoLimitIn},set:function(e){if(e<0)throw new Error("The limit should be greater than or equal to zero.");this.undoLimitIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redoLimit",{get:function(){return i.i(s.isNullOrUndefined)(this.redoLimitIn)?0:this.redoLimitIn},set:function(e){if(e<0)throw new Error("The limit should be greater than or equal to zero.");this.redoLimitIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"EditorHistory"},e.prototype.canUndo=function(){return!i.i(s.isNullOrUndefined)(this.undoStack)&&this.undoStack.length>0},e.prototype.canRedo=function(){return!i.i(s.isNullOrUndefined)(this.redoStack)&&this.redoStack.length>0},e.prototype.initializeHistory=function(e){i.i(s.isNullOrUndefined)(this.currentBaseHistoryInfo)||this.currentBaseHistoryInfo.destroy(),this.currentBaseHistoryInfo=new a.a(this.owner),this.currentBaseHistoryInfo.action=e,this.currentBaseHistoryInfo.updateSelection()},e.prototype.initComplexHistory=function(e,t){switch(this.currentHistoryInfo=new d.a(e.owner,!i.i(s.isNullOrUndefined)(this.currentHistoryInfo)),this.currentHistoryInfo.action=t,t){case"PageBreak":this.currentHistoryInfo.insertedText=o.n.PageBreak,this.currentHistoryInfo.insertPosition=e.startOffset;break;case"ColumnBreak":this.currentHistoryInfo.insertedText=o.n.ColumnBreak,this.currentHistoryInfo.insertPosition=e.startOffset}this.currentHistoryInfo.updateSelection()},e.prototype.initResizingHistory=function(e,t){if(1===t.resizeNode)this.initializeHistory("RowResizing"),i.i(s.isNullOrUndefined)(this.currentBaseHistoryInfo)||(t.currentResizingTable=t.currentResizingTable.combineWidget(this.viewer),this.currentBaseHistoryInfo.modifiedProperties.push(new l.a(t.currentResizingTable,e,t.currentResizingTable.childWidgets[t.resizerPosition].rowFormat,this.owner)),this.documentHelper.layout.reLayoutTable(t.currentResizingTable));else if(this.initializeHistory("CellResizing"),this.currentBaseHistoryInfo){t.currentResizingTable=t.currentResizingTable.combineWidget(this.viewer);var n=new l.b(t.currentResizingTable,this.owner);n.startingPoint=e,this.currentBaseHistoryInfo.modifiedProperties.push(n),this.documentHelper.layout.reLayoutTable(t.currentResizingTable)}},e.prototype.beginUndoAction=function(){this.isUndoGroupingEnded&&(this.owner.editorModule.initComplexHistory("Grouping"),this.isUndoGroupingEnded=!1,this.clearRedoStack())},e.prototype.endUndoAction=function(){this.isUndoGroupingEnded||(this.updateComplexHistory(),this.isUndoGroupingEnded=!0)},e.prototype.updateResizingHistory=function(e,t){if(1===t.resizeNode){if(!i.i(s.isNullOrUndefined)(this.currentBaseHistoryInfo)){var n=this.currentBaseHistoryInfo.modifiedProperties[0];n.startingPoint.y===e.y?this.currentBaseHistoryInfo.modifiedProperties.length=0:(n.displacement=c.a.convertPixelToPoint(e.y-n.startingPoint.y),this.recordChanges(this.currentBaseHistoryInfo),this.owner.fireContentChange(),this.currentBaseHistoryInfo=void 0)}}else if(!i.i(s.isNullOrUndefined)(this.currentBaseHistoryInfo)){var r=this.currentBaseHistoryInfo.modifiedProperties[0];r.startingPoint.x===e.x?this.currentBaseHistoryInfo.modifiedProperties.length=0:(r.displacement=c.a.convertPixelToPoint(e.x-r.startingPoint.x),r.endIndex=t.getCellReSizerPosition(e),this.owner.editorHistory.recordChanges(this.currentBaseHistoryInfo),this.owner.fireContentChange(),this.currentBaseHistoryInfo=void 0)}},e.prototype.recordChanges=function(e){if(this.owner.enableHistoryMode){if(this.isUndoing){if(i.i(s.isNullOrUndefined)(this.redoStack)&&(this.redoStackIn=[]),this.redoStack.length===this.redoLimit&&this.redoLimit>0){var t=this.undoLimit>20?10:1;this.redoStackIn.splice(0,t)}this.redoStack.length<this.redoLimit&&this.redoStack.push(e)}else{if(this.isRedoing||this.clearRedoStack(),i.i(s.isNullOrUndefined)(this.undoStack)&&(this.undoStackIn=[]),this.undoStack.length===this.undoLimit&&this.undoLimit>0){var t=this.undoLimit>20?10:1;this.undoStackIn.splice(0,t)}this.undoStack.length<this.undoLimit&&this.undoStackIn.push(e)}this.lastOperation=e}},e.prototype.updateHistory=function(){this.documentHelper.owner.enableHistoryMode&&!i.i(s.isNullOrUndefined)(this.currentBaseHistoryInfo)&&(!i.i(s.isNullOrUndefined)(this.currentBaseHistoryInfo)&&i.i(s.isNullOrUndefined)(this.currentBaseHistoryInfo.endPosition)&&(this.currentBaseHistoryInfo.endPosition=this.currentBaseHistoryInfo.insertPosition),i.i(s.isNullOrUndefined)(this.currentHistoryInfo)?this.recordChanges(this.currentBaseHistoryInfo):this.currentHistoryInfo.addModifiedAction(this.currentBaseHistoryInfo),this.currentBaseHistoryInfo=void 0)},e.prototype.isHandledComplexHistory=function(){var e=!1;return this.isUndoing||this.isRedoing||(this.owner.editorModule.removedBookmarkElements.length>0&&this.owner.editorModule.insertRemoveBookMarkElements(e)&&(e=!0),this.owner.editorModule.removedEditRangeEndElements.length>0&&this.owner.editorModule.insertRemovedEditRangeEndElements(e)&&(e=!0),this.owner.editorModule.removedEditRangeStartElements.length>0&&this.owner.editorModule.insertRemovedEditRangeStartElements(e)&&(e=!0)),this.documentHelper.owner.enableHistoryMode&&!i.i(s.isNullOrUndefined)(this.currentHistoryInfo)?"Grouping"!=this.currentHistoryInfo.action&&(this.updateHistory(),e=!0):this.owner.editorModule.isHandledComplex&&(e=!0),e},e.prototype.updateComplexHistory=function(){var e=this.documentHelper.selection;if(!i.i(s.isNullOrUndefined)(this.currentHistoryInfo)&&this.currentHistoryInfo.hasAction){if("AutoFormatHyperlink"!==this.currentHistoryInfo.action&&"SkipCommentInline"!==this.currentHistoryInfo.action&&"DeleteCommentInline"!==this.currentHistoryInfo.action&&"RemoveComment"!==this.currentHistoryInfo.action||(e.owner.editorHistory.isUndoing?(this.owner.editorModule.setPositionForCurrentIndex(e.start,this.currentHistoryInfo.selectionStart),this.owner.editorModule.setPositionForCurrentIndex(e.end,this.currentHistoryInfo.selectionEnd)):(this.owner.editorModule.setPositionForCurrentIndex(e.start,this.currentHistoryInfo.endPosition),this.owner.editorModule.setPositionForCurrentIndex(e.end,this.currentHistoryInfo.endPosition))),"InsertHyperlink"===this.currentHistoryInfo.action){var t=new r.a(e.owner);this.owner.editorModule.setPositionForCurrentIndex(t,this.currentHistoryInfo.insertPosition);var n=new r.a(e.owner);this.owner.editorModule.setPositionForCurrentIndex(n,this.currentHistoryInfo.endPosition),this.documentHelper.layout.reLayoutParagraph(t.paragraph,0,0),n.paragraph!==t.paragraph&&this.documentHelper.layout.reLayoutParagraph(n.paragraph,0,0)}"ReplaceAll"===this.currentHistoryInfo.action?(this.documentHelper.contentControlCollection=[],this.owner.editorModule.layoutWholeDocument()):e.owner.isShiftingEnabled&&(this.documentHelper.layout.shiftLayoutedItems(!1),this.owner.enableHeaderAndFooter&&this.owner.editorModule.updateHeaderFooterWidget(),this.documentHelper.removeEmptyPages())}this.owner.showRevisions&&this.owner.trackChangesPane.updateTrackChanges(),e.owner.isShiftingEnabled=!1,e.owner.isLayoutEnabled=!0,i.i(s.isNullOrUndefined)(this.currentHistoryInfo)||"ApplyStyle"!==this.currentHistoryInfo.action?(e.start.updatePhysicalPosition(!0),e.isEmpty?e.end.setPositionInternal(e.start):e.end.updatePhysicalPosition(!0)):this.owner.editor.getOffsetValue(e),e.upDownSelectionLength=e.end.location.x,this.documentHelper.isScrollHandler=!0,this.viewer.updateScrollBars(),e.fireSelectionChanged(!0),this.documentHelper.isScrollHandler=!1,this.owner.enableAutoFocus&&this.documentHelper.updateFocus(),this.updateComplexHistoryInternal(),this.owner.editorModule.isInsertingTOC||this.owner.editorModule.fireContentChange()},e.prototype.updateComplexHistoryInternal=function(){if(!i.i(s.isNullOrUndefined)(this.currentHistoryInfo)){if(i.i(s.isNullOrUndefined)(this.currentHistoryInfo.endPosition)&&(this.currentHistoryInfo.endPosition=this.currentHistoryInfo.insertPosition),this.historyInfoStack.length>1){this.historyInfoStack[this.historyInfoStack.length-2].addModifiedAction(this.currentHistoryInfo)}else this.recordChanges(this.currentHistoryInfo);this.currentHistoryInfo=void 0}},e.prototype.updateListChangesInHistory=function(e,t){this.currentBaseHistoryInfo=new a.a(this.documentHelper.owner),this.currentBaseHistoryInfo.action="List",this.currentBaseHistoryInfo.updateSelection();for(var r=new n.a,o=0;o<e.levels.length;o++){var d=this.documentHelper.getAbstractListById(t.abstractListId).levels[parseInt(o.toString(),10)];this.currentBaseHistoryInfo.addModifiedPropertiesForList(d);var h=new l.c(d,e.levels[parseInt(o.toString(),10)]);i.i(s.isNullOrUndefined)(d)||this.documentHelper.owner.editorModule.copyListLevel(d,e.levels[parseInt(o.toString(),10)]),r.add(o,h)}return r},e.prototype.applyListChanges=function(e,t){i.i(s.isNullOrUndefined)(this.modifiedParaFormats)&&(this.modifiedParaFormats=new n.a);for(var r=[],o=0;o<this.documentHelper.listParagraphs.length;o++){var a=this.documentHelper.listParagraphs[parseInt(o.toString(),10)],d=a.paragraphFormat,c=this.documentHelper.getListById(d.listFormat.listId),p=this.documentHelper.layout.getListLevel(c,d.listFormat.listLevelNumber);if(t.containsKey(d.listFormat.listLevelNumber)&&t.get(d.listFormat.listLevelNumber).ownerListLevel===p){var u=new h.a(null);u.leftIndent=d.leftIndent,u.firstLineIndent=d.firstLineIndent;var g=new l.d(d,u);r.push(g),this.owner.editorModule.copyFromListLevelParagraphFormat(d,p.paragraphFormat)}}this.modifiedParaFormats.add(this.currentBaseHistoryInfo,r)},e.prototype.updateListChanges=function(e){this.documentHelper.owner.isLayoutEnabled=!1,this.owner.editorModule.updateListParagraphs();for(var t=0;t<e.keys.length;t++){var n=e.keys[parseInt(t.toString(),10)],r=e.get(n);i.i(s.isNullOrUndefined)(this.currentBaseHistoryInfo)||(r=this.currentBaseHistoryInfo.addModifiedPropertiesForList(r.ownerListLevel)),this.owner.editorModule.copyListLevel(r.ownerListLevel,r.modifiedListLevel)}this.documentHelper.owner.isLayoutEnabled=!0,this.documentHelper.renderedLists.clear(),this.documentHelper.renderedLevelOverrides=[],this.owner.editorModule.layoutWholeDocument();var o=this.documentHelper.selection;o.start.updatePhysicalPosition(!0),o.isEmpty?o.end.setPositionInternal(o.start):o.end.updatePhysicalPosition(!0),o.upDownSelectionLength=o.end.location.x,o.fireSelectionChanged(!1),this.updateHistory()},e.prototype.undo=function(){if((!this.owner.isReadOnlyMode||this.owner.documentHelper.isCommentOnlyMode||"FormFieldsOnly"===this.owner.documentHelper.protectionType)&&this.canUndo()&&this.owner.enableHistoryMode){var e=this.undoStack.pop();this.isUndoing=!0,e.revert(),this.isUndoing=!1,this.owner.selection.checkForCursorVisibility(),this.owner.editorModule.isBordersAndShadingDialog=!1}},e.prototype.redo=function(){if((!this.owner.isReadOnlyMode||this.owner.documentHelper.isCommentOnlyMode||"FormFieldsOnly"===this.owner.documentHelper.protectionType)&&this.canRedo()&&this.owner.enableHistoryMode){var e=this.redoStack.pop();"BordersAndShading"===e.action&&(this.owner.editorModule.isBordersAndShadingDialog=!0),this.isRedoing=!0,e.revert(),this.isRedoing=!1,this.owner.selection.checkForCursorVisibility(),this.owner.editorModule.isBordersAndShadingDialog=!1}},e.prototype.destroy=function(){this.clearHistory(),this.undoStackIn=void 0,this.redoStackIn=void 0},e.prototype.clearHistory=function(){this.clearUndoStack(),this.clearRedoStack()},e.prototype.clearUndoStack=function(){if(this.canUndo())for(;this.undoStack.length>0;){var e=this.undoStack.pop();e.destroy(),e=void 0}},e.prototype.clearRedoStack=function(){if(this.canRedo())for(;this.redoStack.length>0;){var e=this.redoStack.pop();e.destroy(),e=void 0}},e}()},function(e,t,i){"use strict";i.d(t,"a",function(){return c});var n=i(2),r=i(20),o=i(0),s=(i.n(o),i(31)),a=i(11),l=i(36),d=i(8),h=(i.n(d),i(9)),c=function(){function e(e){this.version=0,this.owner=e}return Object.defineProperty(e.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selection",{get:function(){return this.owner.selection},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"collaborativeEditingSettings",{get:function(){return this.owner.documentEditorSettings.collaborativeEditingSettings},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"CollaborativeEditing"},e.prototype.updateAction=function(e){Array.isArray(e)||(e=[e]);for(var t=0;t<e.length;t++){var i=e[parseInt(t.toString(),10)];switch(i.action){case"LockContent":this.transFormLockRegion(i),this.lockRegion(i.selectionInfo.start,i.selectionInfo.end,i.author);break;case"SaveContent":this.version=i.version,this.updateRegion(i.author,i.data);break;case"UnlockContent":this.version=i.version,this.updateRegion(i.author,i.data),this.removeEditRange(i.author)}}},e.prototype.transFormLockRegion=function(e){var t=e.selectionInfo.previousLockInfo;if(!i.i(o.isNullOrUndefined)(t)){var n=t.author,r=0,s=0;if(this.documentHelper.editRanges.containsKey(n)){var a=this.documentHelper.editRanges.get(n);if(a.length>0){var l=this.selection.getPosition(a[0]),d=this.selection.getHierarchicalIndexByPosition(l.endPosition).split(";"),h=t.end.split(";");r=parseInt(d[0],10)-parseInt(h[0],10),s=parseInt(d[1],10)-parseInt(h[1],10),e.selectionInfo.start.split(";")[0]===t.end.split(";")[0]?(e.selectionInfo.start=this.tranformPosition(e.selectionInfo.start,r,s),e.selectionInfo.end=this.tranformPosition(e.selectionInfo.end,r,s)):(e.selectionInfo.start=this.tranformPosition(e.selectionInfo.start,r,0),e.selectionInfo.end=this.tranformPosition(e.selectionInfo.end,r,0))}}}},e.prototype.lockContent=function(e){var t=this;if(this.canLock()){var n=this.owner.selection.start,r=this.owner.selection.end;if(this.owner.selection.isForward||(n=this.owner.selection.end,r=this.owner.selection.start),n.paragraph.isInsideTable){var s=this.owner.documentHelper.layout.getParentTable(n.paragraph),l=this.owner.documentHelper.getFirstParagraphBlock(s);n.setPosition(l.childWidgets[0],!0)}else n.paragraphStartInternal(this.owner.selection,!1);if(r.paragraph.isInsideTable){var s=this.owner.documentHelper.layout.getParentTable(r.paragraph),d=this.owner.documentHelper.getLastParagraphBlock(s),h=d.lastChild.getEndOffset();r.setPositionParagraph(d.lastChild,h)}else r.moveToParagraphEndInternal(this.owner.selection,!1);var c=this.owner.selection.getHierarchicalIndexByPosition(n),p=this.owner.selection.getHierarchicalIndexByPosition(r),u={start:c,end:p,roomName:this.owner.documentEditorSettings.collaborativeEditingSettings.roomName,author:i.i(o.isNullOrUndefined)(e)?this.owner.currentUser:e,version:this.version},g=this.selection.getParagraphInfo(n),f=this.selection.getParagraphInfo(r);this.owner.selection.select(c,p);var m=new a.l;m.url=this.owner.serviceUrl+this.owner.serverActionSettings.canLock,m.contentType="application/json;charset=UTF-8",m.onSuccess=function(e){t.successHandler(e,u,g,f)},m.onFailure=this.failureHandler.bind(this),m.onError=this.failureHandler.bind(this),m.customHeaders=this.owner.headers,m.send(u)}},e.prototype.canLock=function(){var e=this.documentHelper.editRanges;if(e.containsKey(this.owner.currentUser))return!1;for(var t=e.keys,n=0;n<t.length;n++){var r=e.get(t[parseInt(n.toString(),10)]);if(!i.i(o.isNullOrUndefined)(r)&&r.length>0&&this.isSelectionInEditableRange(r[0]))return!1}return!0},e.prototype.getPreviousLockedRegion=function(){var e=this.documentHelper.editRanges;if(!e.containsKey(this.owner.currentUser)){for(var t,n=e.keys,r=0;r<n.length;r++){var s=e.get(n[parseInt(r.toString(),10)])[0],a=this.selection.getPosition(s).startPosition;a.isExistBefore(this.selection.start)&&(i.i(o.isNullOrUndefined)(t)?t=s:a.isExistAfter(this.selection.getPosition(t).startPosition)&&(t=s))}return t}},e.prototype.unlockContent=function(e){if(this.documentHelper.editRanges.containsKey(e)){this.saveTimer&&clearTimeout(this.saveTimer);var t=JSON.stringify(this.serializeEditableRegion(e)),i={action:"UnlockContent",author:e,version:this.version,data:t,selectionInfo:{start:"",end:"",roomName:this.collaborativeEditingSettings.roomName,author:this.owner.currentUser,version:this.version},roomName:this.collaborativeEditingSettings.roomName};this.removeEditRange(e),this.owner.editorHistory.clearHistory(),this.owner.fireContentChange(),this.owner.trigger(a.m,i)}},e.prototype.removeEditRange=function(e){this.documentHelper.editRanges.containsKey(e)&&(this.updateLockRegion(e,!1),this.owner.editor.removeUserRestrictionsInternal(this.documentHelper.editRanges.get(e)[0]),this.documentHelper.clearContent(),this.selection.updateEditRangeCollection(),this.documentHelper.owner.viewer.updateScrollBars())},e.prototype.saveContent=function(){var e=this;this.saveTimer&&clearTimeout(this.saveTimer);var t=this.collaborativeEditingSettings.saveTimeout;i.i(o.isNullOrUndefined)(t)&&(t=3e3),this.saveTimer=setTimeout(function(){e.saveContentInternal()},t)},e.prototype.saveContentInternal=function(){if(this.documentHelper.editRanges.containsKey(this.owner.currentUser)){var e=this.documentHelper.editRanges.get(this.owner.currentUser)[0],t=this.selection.getPosition(e),i={action:"SaveContent",author:this.owner.currentUser,version:this.version,data:JSON.stringify(this.serializeEditableRegion(this.owner.currentUser)),selectionInfo:{start:this.selection.getHierarchicalIndexByPosition(t.startPosition),end:this.selection.getHierarchicalIndexByPosition(t.endPosition),roomName:this.collaborativeEditingSettings.roomName,author:this.owner.currentUser,version:this.version},roomName:this.collaborativeEditingSettings.roomName};this.owner.trigger(a.m,i)}},e.prototype.serializeEditableRegion=function(e){var t=this.documentHelper.editRanges.get(e)[0],i=t.editRangeEnd,n=new r.a(this.owner);n.setPosition(t.line,!0);var o=new r.a(this.owner);o.setPosition(i.line,!1),this.owner.sfdtExportModule.isPartialExport=!0;var s=this.owner.sfdtExportModule.write(0,n.currentWidget,n.offset,o.currentWidget,o.offset,!1);return this.owner.sfdtExportModule.isPartialExport=!1,s},e.prototype.successHandler=function(e,t,i,n){if(JSON.parse(e.data).canLock){t.start=this.selection.getHierarchicalIndex(i.paragraph,i.offset.toString()),t.end=this.selection.getHierarchicalIndex(n.paragraph,n.offset.toString());var r=this.getPreviousLockedRegion();if(r){var s=this.selection.getPosition(r);t.previousLockInfo={start:this.selection.getHierarchicalIndexByPosition(s.startPosition),end:this.selection.getHierarchicalIndexByPosition(s.endPosition),author:r.user,roomName:"",version:0}}var l={action:"LockContent",selectionInfo:t,author:this.owner.currentUser,version:this.version,data:"",roomName:this.collaborativeEditingSettings.roomName};this.owner.trigger(a.m,l)}else{var h=new o.L10n("documenteditor",this.owner.defaultLocale);h.setLocale(this.owner.locale),d.DialogUtility.alert({content:h.getConstant("Already locked"),closeOnEscape:!0,showCloseIcon:!0,position:{X:"Center",Y:"Center"}}).enableRtl=this.owner.enableRtl}},e.prototype.failureHandler=function(){var e=new o.L10n("documenteditor",this.owner.defaultLocale);e.setLocale(this.owner.locale),d.DialogUtility.alert({content:e.getConstant("Error in establishing connection with web server"),closeOnEscape:!0,showCloseIcon:!0,position:{X:"Center",Y:"Center"}}).enableRtl=this.owner.enableRtl},e.prototype.lockRegion=function(e,t,i){var n=this.selection.getTextPosBasedOnLogicalIndex(e),r=this.selection.getTextPosBasedOnLogicalIndex(t);this.lockRegionInternal(n,r,i)},e.prototype.lockRegionInternal=function(e,t,i){var n=this.owner.editor.addEditElement(i),r=n.editRangeEnd;this.insertElements(e,t,[r],[n]),this.updateLockInfo(n.paragraph,r.paragraph,i,!0),this.owner.viewer.updateScrollBars()},e.prototype.insertElements=function(e,t,n,r){var s=e.paragraph.equals(t.paragraph);i.i(o.isNullOrUndefined)(r)||this.insertElementsInternal(e,r),i.i(o.isNullOrUndefined)(n)||this.insertElementsInternal(t,n),this.documentHelper.layout.reLayoutParagraph(r[0].paragraph,0,0),s||this.documentHelper.layout.reLayoutParagraph(n[0].paragraph,0,0)},e.prototype.insertElementsInternal=function(e,t){var i=0;if(e.paragraph.isEmpty()){var n=e.paragraph;n.childWidgets[0].children.push(t[0]),t[0].line=n.childWidgets[0]}else{var r=e.currentWidget.getInline(e.offset,i),o=r.element;i=r.index;var s=t[0];this.insertElementInternal(o,s,i);for(var a=s.indexInOwner,l=s,d=1;d<t.length;d++)l=t[parseInt(d.toString(),10)],s.line.children.splice(a+d,0,l)}},e.prototype.insertElementInternal=function(e,t,n){var r=e.line,s=r.paragraph,a=e.indexInOwner,l=s.paragraphFormat.bidi&&e.isRightToLeft;n===e.length?(l||a++,r.children.splice(a,0,t)):0===n&&(i.i(o.isNullOrUndefined)(e.previousNode)?(r.children.splice(0,0,t),a=0):r.children.splice(a,0,t)),t.line=e.line},e.prototype.setEditableRegion=function(){if(this.documentHelper.editRanges.containsKey(this.owner.currentUser)){var e=this.documentHelper.editRanges.get(this.owner.currentUser),t=e[0],i=this.getParentBlock(t.paragraph);this.lockStart=this.owner.selection.getHierarchicalIndex(i,"0").split(";")}},e.prototype.isSelectionInEditableRange=function(e){var t;if(!i.i(o.isNullOrUndefined)(this.owner.selection)){var n=this.owner.selection.start,r=this.owner.selection.end;this.owner.selection.isForward||(t=[r,n],n=t[0],r=t[1]);var s=this.owner.selection.getPosition(e);if((n.isExistAfter(s.startPosition)||n.isAtSamePosition(s.startPosition))&&(r.isExistBefore(s.endPosition)||r.isAtSamePosition(s.endPosition))||(s.startPosition.isExistAfter(n)||s.startPosition.isAtSamePosition(n))&&(s.endPosition.isExistBefore(r)||s.endPosition.isAtSamePosition(r))||s.startPosition.isExistAfter(n)&&s.startPosition.isExistBefore(r)&&(r.isExistAfter(s.endPosition)||r.isExistBefore(s.endPosition))||s.endPosition.isExistBefore(r)&&s.endPosition.isExistAfter(n)&&(n.isExistBefore(s.startPosition)||n.isExistAfter(s.startPosition)))return!0}return!1},e.prototype.updateRegion=function(e,t){if(this.documentHelper.editRanges.containsKey(e)){var r=this.documentHelper.editRanges.get(e);1===r.length&&(this.documentHelper.editRanges.remove(e),r[0].removeEditRangeMark()),this.setEditableRegion();var a=r[0],l=a.editRangeEnd,d=this.getParentBlock(a.paragraph),h=this.getParentBlock(l.paragraph),c=this.isSelectionInEditableRange(a),p=void 0,u=void 0;this.owner.editor.isRemoveRevision=!0,c||(p=this.owner.selection.getParagraphInfo(this.owner.selection.start),u=this.owner.selection.getParagraphInfo(this.owner.selection.end));for(var g=[];h!==d;){var f=h.combineWidget(this.owner.viewer);h=f.previousRenderedWidget,h.bodyWidget.index!==f.bodyWidget.index&&g.push(f.bodyWidget);var m=f.containerWidget.childWidgets[f.indexInOwner];this.removeDuplicateCollection(m),f.containerWidget.removeChild(f.indexInOwner)}if(!i.i(o.isNullOrUndefined)(d)){var v=d.index,y=d.containerWidget;g.push(y);var w=d.containerWidget.childWidgets.indexOf(d),m=y.childWidgets[w];y.removeChild(w),this.removeDuplicateCollection(m);var b=[],x=[],C=[];if(this.owner.editor.isPasteListUpdated=!1,this.owner.editor.getBlocks(JSON.parse(t),!1,x,b,C),g.length!==x.length){if(1===g.length){var I=g[0];g.unshift(this.owner.editor.splitBodyWidget(I,x[x.length-2].sectionFormat,I.childWidgets[w-1]))}if(g.length<x.length)for(var F=1;F<x.length-1;F++){var k=new n.A(this.owner.documentHelper),I=new n.o;k.bodyWidgets.push(I),I.page=k,g.splice(F,0,I),I.index=g[F-1].index,I.sectionFormat=new s.a(I),I.sectionFormat.copyFormat(x[F].sectionFormat);var P=g[F-1].page.index;if(this.documentHelper.insertPage(P,k),this.owner.editor.updateSectionIndex(g[F-1].sectionFormat,g[F-1],!0),g.length===x.length)break}}for(var T=0;T<g.length;T++){var S=g[T],W=0,N=0;T===g.length-1&&(W=v,N=w);for(var H=x[T].childWidgets,E=0;E<H.length;E++)H[E].containerWidget=S,H[E].index=W,S.childWidgets.splice(N,0,H[E]),N++,W++;h=H[H.length-1],h.nextRenderedWidget&&h.nextRenderedWidget.index!==h.index&&this.updateNextBlocksIndex(h,!0),this.documentHelper.layout.layoutBodyWidgetCollection(H[0].index,S,void 0,!1)}for(var O=0;O<b.length;O++){var _=b[O];if(this.owner.editor.addCommentWidget(_,!1,this.owner.showComments,!1),_.replyComments.length>0)for(var T=0;T<_.replyComments.length;T++)this.owner.commentReviewPane.addReply(_.replyComments[T],!1,!1)}C.length>0&&this.updateRevisionCollection(C),this.owner.trackChangesPane.updateTrackChanges();var B=this.documentHelper.editRanges.get(e);if(c){if(B.length>0){var L=this.selection.getPosition(B[0]);this.selection.selectPosition(L.endPosition,L.endPosition)}}else this.tranformSelection(p,u);this.tranformHistoryPosition(),this.selection.updateEditRangeCollection(),this.updateLockRegion(e),this.documentHelper.removeEmptyPages(),this.owner.viewer.updateScrollBars(),this.owner.editor.isRemoveRevision=!1}}},e.prototype.updateRevisionCollection=function(e){var t=0,n=this.getRevisionTextPosition(e[0]),r=!1;if(this.owner.revisionsInternal.changes.length>0&&!i.i(o.isNullOrUndefined)(n))for(var s=0;s<this.owner.revisionsInternal.changes.length;s++){var a=this.getRevisionTextPosition(this.owner.revisionsInternal.changes[s]);if(a.isExistAfter(n)){t=s,r=!0;break}}for(var l=0;l<e.length;l++)r?(this.owner.revisionsInternal.changes.splice(t,0,e[l]),t++):this.owner.revisionsInternal.changes.push(e[l])},e.prototype.getRevisionTextPosition=function(e){if(e.range.length>0){var t=e.range[0];if(t instanceof n.c)return this.selection.getElementPosition(t).startPosition;if(t instanceof h.e){var i=t.ownerBase.firstChild.firstChild;if(i.bodyWidget)return this.selection.getTextPosBasedOnLogicalIndex(this.selection.getHierarchicalIndex(i,"0"))}else if(t instanceof h.c){var o=t.ownerBase;if(o.lastChild.paragraph.bodyWidget){var s=o.getLength(),a=new r.a(this.owner);return a.setPositionParagraph(o.lastChild,s),a}}}},e.prototype.tranformSelection=function(e,t){this.documentHelper.skipScrollToPosition=!0;var i=this.selection.getHierarchicalIndex(e.paragraph,e.offset.toString()),n=this.selection.getHierarchicalIndex(t.paragraph,t.offset.toString());this.selection.select(i,n)},e.prototype.tranformHistoryPosition=function(){if(this.documentHelper.editRanges.containsKey(this.owner.currentUser)){var e=this.documentHelper.editRanges.get(this.owner.currentUser),t=e[0],n=this.getParentBlock(t.paragraph),r=this.selection.getHierarchicalIndex(n,"0").split(";");if(!i.i(o.isNullOrUndefined)(this.lockStart)&&this.lockStart.length>1){var s=parseInt(r[0],10)-parseInt(this.lockStart[0],10),a=parseInt(r[1],10)-parseInt(this.lockStart[1],10);this.transformHistory(s,a)}}},e.prototype.transformHistory=function(e,t){if(this.owner.enableEditorHistory){var n=this.owner.editorHistory.undoStack;if(!i.i(o.isNullOrUndefined)(n))for(var r=0;r<n.length;r++)this.transformBaseHistoryInfo(n[r],e,t);var s=this.owner.editorHistory.redoStack;if(!i.i(o.isNullOrUndefined)(s))for(var r=0;r<s.length;r++)this.transformBaseHistoryInfo(s[r],e,t)}},e.prototype.transformBaseHistoryInfo=function(e,t,i){if(e.endPosition&&(e.endPosition=this.tranformPosition(e.endPosition,t,i)),e.insertPosition&&(e.insertPosition=this.tranformPosition(e.insertPosition,t,i)),e.selectionStart&&(e.selectionStart=this.tranformPosition(e.selectionStart,t,i)),e.selectionEnd&&(e.selectionEnd=this.tranformPosition(e.selectionEnd,t,i)),e instanceof l.a)for(var n=e.modifiedActions,r=0;r<n.length;r++)this.transformBaseHistoryInfo(n[r],t,i)},e.prototype.tranformPosition=function(e,t,i){var n=e.split(";");return n[0]=(parseInt(n[0],10)+t).toString(),n[1]=(parseInt(n[1],10)+i).toString(),n.join(";")},e.prototype.getParentBlock=function(e){return e.isInsideTable&&(e=this.owner.documentHelper.layout.getParentTable(e)),e.combineWidget(this.owner.viewer)},e.prototype.removeDuplicateCollection=function(e){if(this.removeFieldInBlock(e,!1,!1),this.removeFieldInBlock(e,!0,!1),this.removeFieldInBlock(e,!1,!0),e instanceof n.u){for(var t=0;t<e.childWidgets.length;t++)if(e.childWidgets[t]instanceof n.z){var i=e.childWidgets[t];this.owner.editor.removeDeletedCellRevision(i)}}else this.owner.editor.removeRevisionForBlock(e,void 0,!1,!1)},e.prototype.removeFieldInBlock=function(e,t,i){e instanceof n.u?this.removeFieldTable(e,t,i):(this.owner.editor.removeField(e,t,i),this.removeComment(e))},e.prototype.removeFieldTable=function(e,t,i){for(var n=0;n<e.childWidgets.length;n++)for(var r=e.childWidgets[n],o=0;o<r.childWidgets.length;o++)for(var s=r.childWidgets[o],a=0;a<s.childWidgets.length;a++)this.removeFieldInBlock(s.childWidgets[a],t,i)},e.prototype.removeComment=function(e){if(this.documentHelper.comments.length>0)for(var t=0;t<this.documentHelper.comments.length;t++){var i=this.documentHelper.comments[t];i.commentStart.line.paragraph===e&&(this.documentHelper.comments.splice(t,1),this.owner.commentReviewPane.deleteComment(i),t--)}},e.prototype.updateNextBlocksIndex=function(e,t){var i=e.getSplitWidgets().pop().nextRenderedWidget,r=1;i.bodyWidget.index===e.bodyWidget.index&&(r=e.index-i.index+1);var o=e.containerWidget.childWidgets.indexOf(e)+1;if(e.containerWidget instanceof n.o)for(var s=e.containerWidget.index,a=this.documentHelper.pages.indexOf(e.containerWidget.page),l=a;l<this.documentHelper.pages.length;l++){var d=this.documentHelper.pages[l];if(d.bodyWidgets[0].index!==s)return;for(var h=o;h<d.bodyWidgets[0].childWidgets.length;h++){var c=d.bodyWidgets[0].childWidgets[h];c.index+=r}o=0}},e.prototype.updateLockRegion=function(e,t){if(i.i(o.isNullOrUndefined)(e)&&(e=this.owner.currentUser),t=!!i.i(o.isNullOrUndefined)(t)||t,this.documentHelper.editRanges.containsKey(e)){var n=this.documentHelper.editRanges.get(e);if(1===n.length&&!i.i(o.isNullOrUndefined)(n[0].editRangeEnd)){var r=n[0];this.updateLockInfo(r.paragraph,r.editRangeEnd.paragraph,e,t)}}},e.prototype.updateLockInfo=function(e,t,n,r){e.isInsideTable&&(e=this.documentHelper.layout.getParentTable(e)),t.isInsideTable&&(t=this.documentHelper.layout.getParentTable(t));do{if(r?(e.lockedBy=n,e.locked=r):(e.lockedBy=void 0,e.locked=r),e===t)break;if(e=e.nextRenderedWidget,i.i(o.isNullOrUndefined)(e))break}while(e)},e.prototype.pullAction=function(){var e=this;if(this.owner){var t=new a.l;t.url=this.owner.serviceUrl+this.owner.serverActionSettings.getPendingActions,t.contentType="application/json;charset=UTF-8",t.onSuccess=function(t){"string"==typeof t&&(t=JSON.parse(t)),e.updateAction(JSON.parse(t.data)),i.i(d.hideSpinner)(e.owner.element)},t.onFailure=this.failureHandler.bind(this),t.onError=this.failureHandler.bind(this),t.customHeaders=this.owner.headers,i.i(d.showSpinner)(this.owner.element),t.send({roomName:this.collaborativeEditingSettings.roomName,version:this.version})}},e.prototype.destroy=function(){this.owner=void 0},e}()},function(e,t,i){"use strict";i.d(t,"a",function(){return P});var n=i(20),r=i(2),o=i(21),s=i(4),a=i(0),l=(i.n(a),i(7)),d=i(24),h=i(14),c=i(23),p=i(26),u=i(11),g=i(22),f=i(36),m=i(54),v=i(6),y=i(16),w=i(8),b=(i.n(w),i(25)),x=i(45),C=i(1),I=i(39),F=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){e.done?r(e.value):new i(function(t){t(e.value)}).then(s,a)}l((n=n.apply(e,t||[])).next())})},k=this&&this.__generator||function(e,t){function i(e){return function(t){return n([e,t])}}function n(i){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,o&&(s=2&i[0]?o.return:i[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,i[1])).done)return s;switch(o=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,o=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(s=l.trys,!(s=s.length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){l.label=i[1];break}if(6===i[0]&&l.label<s[1]){l.label=s[1],s=i;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(i);break}s[2]&&l.ops.pop(),l.trys.pop();continue}i=t.call(e,l)}catch(e){i=[6,e],o=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,o,s,a,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},P=function(){function e(e){var t=this;this.nodes=[],this.editHyperlinkInternal=!1,this.startParagraph=void 0,this.endParagraph=void 0,this.formFieldCounter=1,this.skipFieldDeleteTracking=!1,this.skipFootNoteDeleteTracking=!1,this.isForHyperlinkFormat=!1,this.isTrackingFormField=!1,this.isInsertText=!1,this.keywordIndex=0,this.isFootnoteElementRemoved=!1,this.isEndnoteElementRemoved=!1,this.handledEnter=!1,this.removeEditRange=!1,this.isRemoveRevision=!1,this.isFootNoteInsert=!1,this.isCopying=!1,this.isTableInsert=!1,this.isFootNote=!1,this.isHandledComplex=!1,this.isUserInsert=!1,this.tableResize=void 0,this.tocStyles={},this.triggerPageSpellCheck=!0,this.chartType=!1,this.removedBookmarkElements=[],this.removedEditRangeStartElements=[],this.isCellFormatApplied=!1,this.removedEditRangeEndElements=[],this.tocBookmarkId=0,this.copiedData=void 0,this.isPasteContentCheck=!1,this.pageRefFields={},this.delBlockContinue=!1,this.delBlock=void 0,this.delSection=void 0,this.isInsertingTOC=!1,this.editStartRangeCollection=[],this.skipReplace=!1,this.skipTableElements=!1,this.editRangeID=[],this.isImageInsert=!1,this.isSkipOperationsBuild=!1,this.revisionData=[],this.splittedRevisions=[],this.isSkipComments=!1,this.isRemoteAction=!1,this.isIncrementalSave=!1,this.listNumberFormat="",this.listLevelNumber=0,this.isXmlMapped=!1,this.isAutoList=!1,this.combineLastBlock=!1,this.copiedContent="",this.copiedTextContent="",this.previousParaFormat=void 0,this.previousCharFormat=void 0,this.previousSectionFormat=void 0,this.pasteTextPosition=void 0,this.isPaste=!1,this.isPasteListUpdated=!1,this.isHtmlPaste=!1,this.isInsertField=!1,this.isBordersAndShadingDialog=!1,this.pasteImageIndex=void 0,this.onTextInputInternal=function(){if(a.Browser.isDevice){var e=t.documentHelper,i=new RegExp(String.fromCharCode(160),"g"),n=new RegExp(String.fromCharCode(10),"g");e.prefix=e.prefix.replace(i," ").replace(n," ");var r=e.editableDiv.textContent.replace(i," ").replace(n," "),o=r.substring(2);if(e.isCompositionStart&&e.isCompositionUpdated)return e.isCompositionUpdated=!1,void(!e.owner.isReadOnlyMode&&e.owner.isDocumentLoaded&&t.canEditContentControl&&e.prefix.substring(2)!==o&&(t.selection.isEmpty?(t.selection.start.setPositionForLineWidget(e.selection.start.currentWidget,t.selection.start.offset-(e.prefix.length-2)),t.handleTextInput(o),e.prefix="@"+String.fromCharCode(160)+o):(t.handleTextInput(o),e.prefix="@"+String.fromCharCode(160)+o)));if(e.isCompositionStart&&e.isCompositionEnd&&""===e.suffix)return e.prefix.substring(2)!==o?t.selection.isEmpty&&e.isCompositionStart?(e.isCompositionStart=!1,t.selection.start.setPositionForLineWidget(e.selection.start.currentWidget,t.selection.start.offset-e.prefix.substring(2).length),t.selection.retrieveCurrentFormatProperties(),""!==e.suffix&&""!==o||t.handleTextInput(o)):t.selection.isEmpty||(e.isCompositionStart=!1,t.handleTextInput(o)):""===o?(e.isCompositionStart=!1,t.handleBackKey()):e.prefix.substring(2)===o&&""===e.suffix&&(e.isCompositionStart=!1,t.handleTextInput(" ")),void(e.isCompositionEnd=!1);if(e.isCompositionEnd||e.isCompositionStart&&!e.isCompositionUpdated){if(o.length<e.prefix.length&&o===e.prefix.substring(2,e.prefix.length-1)||e.editableDiv.innerText.length<2)return void t.handleBackKey();if(""!==e.suffix&&e.editableDiv.innerText[e.editableDiv.innerText.length-1]!==String.fromCharCode(160))return e.isCompositionStart=!1,t.selection.start.setPositionForLineWidget(e.selection.start.currentWidget,t.selection.start.offset-(e.prefix.length-2)),t.selection.end.setPositionForLineWidget(e.selection.end.currentWidget,t.selection.end.offset+e.suffix.length),t.selection.retrieveCurrentFormatProperties(),void t.handleTextInput(o)}"\r"!==r&&"\b"!==r&&r!==String.fromCharCode(27)&&!e.owner.isReadOnlyMode&&!1===e.isControlPressed&&t.canEditContentControl&&("@"===r||"@"!==r[0]||""===r||r.length<e.prefix.length&&o===e.prefix.substring(2,e.prefix.length-1)?(t.handleBackKey(),e.editableDiv.innerText.length<2&&t.predictText()):0===r.indexOf(e.prefix)&&r.length>e.prefix.length?t.handleTextInput(r.substring(e.prefix.length)):-1===r.indexOf(e.prefix)&&r[r.length-1]!==String.fromCharCode(160)&&" "!==r[r.length-1]?(o.charAt(0).toLowerCase()+o.slice(1)===e.prefix.substring(2)&&t.selection.start.setPositionParagraph(e.selection.start.currentWidget,t.selection.start.offset-(e.prefix.length-2)),t.handleTextInput(o)):2!==r.length&&t.handleTextInput(" "))}else{var r=t.documentHelper.editableDiv.innerText;r!==String.fromCharCode(160)?"\r"!==r&&"\b"!==r&&r!==String.fromCharCode(27)&&!t.owner.isReadOnlyMode&&!1===t.documentHelper.isControlPressed&&t.canEditContentControl&&t.handleTextInput(r):t.handleTextInput(" "),t.documentHelper.editableDiv.innerText=""}},this.onPaste=function(e){!t.owner.isReadOnlyMode&&t.canEditContentControl&&t.pasteInternal(e),e.preventDefault()},this.documentHelper=e,i.i(a.isNullOrUndefined)(this.documentHelper)||(this.tableResize=new m.a(this.documentHelper.owner)),this.base64=new s.c}return Object.defineProperty(e.prototype,"restrictFormatting",{get:function(){return this.documentHelper.isDocumentProtected&&(this.documentHelper.restrictFormatting||!this.documentHelper.restrictFormatting&&!this.selection.isSelectionInEditRegion())&&"RevisionsOnly"!==this.documentHelper.protectionType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"restrictEditing",{get:function(){return this.documentHelper.isDocumentProtected&&(("ReadOnly"===this.documentHelper.protectionType||this.documentHelper.isCommentOnlyMode)&&!this.selection.isSelectionInEditRegion()||"FormFieldsOnly"===this.documentHelper.protectionType)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canEditContentControl",{get:function(){return!this.owner.isReadOnlyMode&&!this.selection.checkContentControlLocked()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewer",{get:function(){if(!i.i(a.isNullOrUndefined)(this.owner))return this.owner.viewer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"editorHistory",{get:function(){return this.documentHelper.owner.editorHistory},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selection",{get:function(){if(this.documentHelper)return this.documentHelper.selection},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"owner",{get:function(){return this.documentHelper.owner},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"Editor"},e.prototype.setFieldInfo=function(e){var t=this.selection.getHyperlinkField(!0);i.i(a.isNullOrUndefined)(t)||(this.selection.selectField(),this.insertField(e.code,e.result))},e.prototype.insertField=function(e,t){e=s.a.sanitizeString(e),i.i(a.isNullOrUndefined)(t)||(t=s.a.sanitizeString(t)),this.isInsertField=!0;var n=e;if(n=s.a.trimStart(n),"NUMPAGES"===n.substring(0,8))this.insertPageCount(t);else if("PAGE"===n.substring(0,4))this.insertPageNumber(t);else{if(i.i(a.isNullOrUndefined)(t)&&"MERGEFIELD"===n.substring(0,10)){n=n.substring(10).trim();var d=n.indexOf("\\*");t=""+n.substring(0,d).trim()+""}var h=new r.g,c=new o.a,p=this.copyInsertFormat(c,!1),u=new r.p(h),g=new r.b(0);g.characterFormat.mergeFormat(p),u.children.push(g);var f=new r.d;f.characterFormat.mergeFormat(p),f.text=e,u.children.push(f);var m=new r.b(2);m.characterFormat.mergeFormat(p),m.fieldBegin=g,g.fieldSeparator=m,u.children.push(m);var v=new r.d;v.text=t,v.characterFormat.mergeFormat(p),u.children.push(v);var y=new r.b(1);y.characterFormat.mergeFormat(p),y.fieldSeparator=m,y.fieldBegin=g,g.fieldEnd=y,m.fieldEnd=y,u.children.push(y),g.line=u,h.childWidgets.push(u),this.documentHelper.fields.push(g);var w=new r.o;w.sectionFormat=new l.G(w),w.childWidgets.push(h),h.isCreatedUsingHtmlSpanTag=!0,this.pasteContentsInternal([w],!1)}this.isInsertField=!1},e.prototype.isLinkedStyle=function(e){var t=this.documentHelper.styles.findByName(e);return!i.i(a.isNullOrUndefined)(t.link)},e.prototype.applyStyle=function(e,t){t=!i.i(a.isNullOrUndefined)(t)&&t;var n=void 0,r=void 0;if(t){this.initComplexHistory("ApplyStyle"),this.setOffsetValue(this.selection),n=this.startOffset,r=this.endOffset;var o=this.selection.isEmpty;this.isSkipOperationsBuild=!0,this.clearFormattingInternal(!this.isLinkedStyle(e)),this.isSkipOperationsBuild=!1,o&&!this.selection.isEmpty&&this.selection.end.setPositionInternal(this.selection.start)}var s=this.documentHelper.styles.findByName(e);if(void 0!==s)if(s instanceof g.b&&"Character"===s.type)if(this.selection.isEmpty){var l=this.selection.start.offset,d=this.selection.start.clone(),h=this.selection.end.clone();this.selection.selectCurrentWord(),l===this.selection.start.offset||l===this.selection.end.offset-1?(this.selection.start=d,this.selection.end=h,this.selection.characterFormat.copyFormat(s.characterFormat)):this.onApplyCharacterFormat("styleName",s,!1,!0)}else this.onApplyCharacterFormat("styleName",s,!1,!0);else this.onApplyParagraphFormat("styleName",s,!1,!0);else this.documentHelper.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()),JSON.parse(this.documentHelper.preDefinedStyles.get(e)),this.documentHelper.styles),this.applyStyle(e);this.editorHistory&&this.editorHistory.currentHistoryInfo&&"ApplyStyle"===this.editorHistory.currentHistoryInfo.action&&(this.startOffset=n,this.endOffset=r,this.editorHistory.updateComplexHistory()),this.startParagraph=void 0,this.endParagraph=void 0},e.prototype.cut=function(){this.owner.isReadOnlyMode||this.selection.isEmpty||!this.canEditContentControl||(this.selection.copySelectedContent(!0),this.documentHelper.owner.parser.isCutPerformed=!0)},e.prototype.insertEditingRegion=function(e){this.insertEditRangeElement(e&&""!==e?e:"Everyone")},e.prototype.enforceProtection=function(e,t,n){var r,o;"boolean"==typeof t?(r=n?"ReadOnly":this.documentHelper.protectionType,o=t):r=t,i.i(a.isNullOrUndefined)(o)||(this.documentHelper.restrictFormatting=o),this.documentHelper.protectionType=r,this.selection.isHighlightEditRegion=!0,this.addProtection(e,this.documentHelper.protectionType,!1)},e.prototype.enforceProtectionAsync=function(e,t,i){return F(this,void 0,void 0,function(){var n,r;return k(this,function(o){switch(o.label){case 0:return"boolean"==typeof t?(n=i?"ReadOnly":this.documentHelper.protectionType,r=t):(r=!0,n=t),this.documentHelper.restrictFormatting=r,this.documentHelper.protectionType=n,this.selection.isHighlightEditRegion=!0,[4,this.addProtection(e,this.documentHelper.protectionType,!0)];case 1:return o.sent(),[2]}})})},e.prototype.getCommentHierarchicalIndex=function(e){for(var t="";e.ownerComment;)i.i(a.isNullOrUndefined)(e.ownerComment)?(t=e.replyComments.indexOf(e)+";"+t,e=e):(t=e.ownerComment.replyComments.indexOf(e)+";"+t,e=e.ownerComment);return t="C;"+this.documentHelper.comments.indexOf(e)+";"+t},e.prototype.alertBox=function(){var e=new a.L10n("documenteditor",this.owner.defaultLocale);e.setLocale(this.owner.locale),w.DialogUtility.alert({title:e.getConstant("Information"),content:e.getConstant("Multiple Comment")})},e.prototype.insertComment=function(e){if(!(i.i(a.isNullOrUndefined)(this.selection.start)||this.owner.isReadOnlyMode&&!this.documentHelper.isCommentOnlyMode||this.viewer.owner.enableHeaderAndFooter)&&this.viewer.owner.enableComment){if(this.viewer.owner.commentReviewPane.commentPane.isEditMode)return this.alertBox();i.i(a.isNullOrUndefined)(e)&&(e=""),this.insertCommentInternal(e)}},e.prototype.insertCommentInternal=function(e){if(this.documentHelper.layout.allowLayout=!1,this.selection.isEmpty){if(this.selection.start.isAtSamePosition(this.selection.end)&&this.selection.start.isAtParagraphEnd){var t=this.selection.start.offset;this.selection.start.offset=t-1!=-1?t-1:t}this.selection.selectCurrentWord()}this.selection.isParagraphLastLine(this.selection.end.currentWidget)&&this.selection.end.offset===this.selection.getLineLength(this.selection.end.currentWidget)+1&&(this.selection.end.offset-=1);var o=this.selection.getParagraphInfo(this.selection.start),l=(this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString()),this.selection.getParagraphInfo(this.selection.end)),d=this.selection.getHierarchicalIndex(l.paragraph,l.offset.toString());this.initComplexHistory("InsertComment");var h=this.selection.start,c=this.selection.end,p=new n.a(this.owner);this.selection.isForward||(h=this.selection.end,c=this.selection.start),p.setPositionInternal(c);var u=new r.B(0),g=new r.B(1),f=h.currentWidget===c.currentWidget;c.setPositionInternal(h);var m=p.currentWidget.indexInOwner,v=p.currentWidget.paragraph;if(this.initInsertInline(u),-1===p.currentWidget.indexInOwner&&(p.currentWidget=v.childWidgets[m]),i.i(a.isNullOrUndefined)(p.paragraph)||p.currentWidget&&0===p.currentWidget.children.length&&-1===p.currentWidget.indexInOwner){var w=this.selection.getTextPosBasedOnLogicalIndex(d);p.setPositionInternal(w)}f&&p.setPositionParagraph(p.currentWidget,p.offset+u.length),h.setPositionInternal(p),c.setPositionInternal(p),this.initInsertInline(g);var b=new r.M(s.a.getUtcDate());this.owner.editorHistory&&(this.initHistory("InsertCommentWidget"),this.owner.editorHistory.currentBaseHistoryInfo.insertedText=y.c.Marker_Start+y.c.Marker_End,this.owner.editorHistory.currentBaseHistoryInfo.removedNodes.push(b));var x={author:this.owner.currentUser?this.owner.currentUser:"Guest user",initial:this.constructCommentInitial(b.author),text:a.SanitizeHtmlHelper.sanitize(e),commentId:Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)};if(this.updateCommentElement(b,u,g,x),this.addCommentWidget(b,!0,!0,!0),this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=this.getCommentHierarchicalIndex(b),this.editorHistory.updateHistory()),this.editorHistory&&this.editorHistory.updateComplexHistory(),this.reLayout(this.selection,!1),this.documentHelper.layout.allowLayout=!0,!this.isUserInsert){this.owner.commentReviewPane.commentPane.comments.get(b).postComment()}},e.prototype.updateCommentElement=function(e,t,n,r){return e.author=r.author,e.initial=r.initial,e.text=r.text,e.commentId=r.commentId,i.i(a.isNullOrUndefined)(r.done)||(e.isResolved=r.done),i.i(a.isNullOrUndefined)(r.isReply)||(e.isReply=r.isReply),i.i(a.isNullOrUndefined)(t)||i.i(a.isNullOrUndefined)(n)||(t.comment=e,t.commentId=e.commentId,n.comment=e,n.commentId=e.commentId,e.commentStart=t,e.commentEnd=n),e},e.prototype.deleteAllComments=function(){if(0!==this.documentHelper.comments.length){this.initComplexHistory("DeleteAllComments"),this.owner.isLayoutEnabled=!1;var e;for(this.editorHistory&&this.editorHistory.currentHistoryInfo&&(e=this.editorHistory.currentHistoryInfo);this.documentHelper.comments.length>0;){var t=this.documentHelper.comments[0];this.initComplexHistory("DeleteComment"),this.deleteCommentInternal(t),this.editorHistory&&this.editorHistory.currentHistoryInfo&&e.addModifiedAction(this.editorHistory.currentHistoryInfo)}this.selection.selectContent(this.owner.documentStart,!0),this.editorHistory&&(this.editorHistory.currentHistoryInfo=e,this.editorHistory.updateComplexHistory())}},e.prototype.deleteComment=function(){this.owner.isReadOnlyMode&&!this.documentHelper.isCommentOnlyMode||i.i(a.isNullOrUndefined)(this.owner)||i.i(a.isNullOrUndefined)(this.owner.viewer)||i.i(a.isNullOrUndefined)(this.owner.documentHelper.currentSelectedComment)||this.owner.enableHeaderAndFooter||!this.viewer.owner.enableComment||this.deleteCommentInternal(this.owner.documentHelper.currentSelectedComment)},e.prototype.deleteCommentInternal=function(e){if(this.initComplexHistory("DeleteComment"),e){if(e.replyComments.length>0)for(var t=e.replyComments.length-1;t>=0;t--)this.deleteCommentInternal(e.replyComments[t]);this.deleteCommentWidgetInternal(e);var i=e.commentStart,n=e.commentEnd;-1!==n.indexInOwner&&this.removeInline(n),-1!==i.indexInOwner&&this.removeInline(i),i.removeCommentMark()}this.editorHistory&&this.editorHistory.updateComplexHistory()},e.prototype.deleteCommentWidgetInternal=function(e){this.owner.editorHistory&&(this.initHistory("DeleteCommentWidget"),this.owner.editorHistory.currentBaseHistoryInfo.insertPosition=this.getCommentHierarchicalIndex(e),this.owner.editorHistory.currentBaseHistoryInfo.removedNodes.push(e)),this.deleteCommentWidget(e),this.editorHistory&&this.editorHistory.updateHistory()},e.prototype.deleteCommentWidget=function(e){var t=this.documentHelper.comments.indexOf(e);-1!==t?this.documentHelper.comments.splice(t,1):e.isReply&&e.ownerComment&&(t=e.ownerComment.replyComments.indexOf(e),e.ownerComment.replyComments.splice(t,1)),this.owner.commentReviewPane&&(this.owner.commentReviewPane.deleteComment(e),this.documentHelper.currentSelectedComment===e&&(this.documentHelper.currentSelectedComment=void 0))},e.prototype.resolveComment=function(e){if(!this.owner.isReadOnlyMode||this.documentHelper.isCommentOnlyMode){var t={author:e.author,cancel:!1,type:"Resolve"};this.owner.trigger(u.k,t),t.cancel&&"Resolve"===t.type||(this.initHistory("ResolveComment"),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.editorHistory.currentBaseHistoryInfo.removedNodes.push(e),this.resolveOrReopenComment(e,!0))}},e.prototype.reopenComment=function(e){if(!this.owner.isReadOnlyMode||this.documentHelper.isCommentOnlyMode){var t={author:e.author,cancel:!1,type:"Reopen"};this.owner.trigger(u.k,t),t.cancel&&"Reopen"===t.type||(this.initHistory("ResolveComment"),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.editorHistory.currentBaseHistoryInfo.removedNodes.push(e),this.resolveOrReopenComment(e,!1))}},e.prototype.resolveOrReopenComment=function(e,t){e.isResolved=t;for(var i=0;i<e.replyComments.length;i++)e.replyComments[i].isResolved=t;this.owner.commentReviewPane&&(t?this.owner.commentReviewPane.resolveComment(e):this.owner.commentReviewPane.reopenComment(e)),this.reLayout(this.selection,!1,!1)},e.prototype.replyComment=function(e,t){if(!this.owner.isReadOnlyMode||this.documentHelper.isCommentOnlyMode){var i=e;if(e){this.initComplexHistory("InsertComment");var o=i.commentStart,a=i.commentEnd,l=i.replyComments.length,d=o.line.getOffset(o,l+1),h=new n.a(this.documentHelper.owner);h.setPositionParagraph(o.line,d);var c=a.line.getOffset(a,l+1),p=new n.a(this.documentHelper.owner);p.setPositionParagraph(a.line,c),this.selection.start.setPositionInternal(h),this.selection.end.setPositionInternal(p),h=this.selection.start,p=this.selection.end;var u=new n.a(this.owner);u.setPositionInternal(p);var g=new r.B(0),f=new r.B(1),m=h.currentWidget===p.currentWidget;p.setPositionInternal(h);var v=u.currentWidget.indexInOwner;this.initInsertInline(g),-1===u.currentWidget.indexInOwner&&(u.currentWidget=u.currentWidget.paragraph.childWidgets[v]),m&&u.setPositionParagraph(u.currentWidget,u.offset+g.length),h.setPositionInternal(u),p.setPositionInternal(u),this.initInsertInline(f);var w=new r.M(s.a.getUtcDate());w.author=this.owner.currentUser?this.owner.currentUser:"Guest user",w.text=t||"",w.commentId=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),w.isReply=!0,i.replyComments.push(w),w.ownerComment=i,this.owner.editorHistory&&(this.initHistory("InsertCommentWidget"),this.owner.editorHistory.currentBaseHistoryInfo.removedNodes.push(w),this.owner.editorHistory.currentBaseHistoryInfo.insertedText=y.c.Marker_Start+y.c.Marker_End),g.comment=w,g.commentId=w.commentId,f.comment=w,f.commentId=w.commentId,w.commentStart=g,w.commentEnd=f,this.owner.commentReviewPane&&this.owner.commentReviewPane.addReply(w,!1,!0),this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=this.getCommentHierarchicalIndex(w),this.editorHistory.updateHistory()),this.editorHistory&&this.editorHistory.updateComplexHistory(),this.isSkipOperationsBuild=!0,this.reLayout(this.selection)}}},e.prototype.removeInline=function(e){this.selection.start.setPositionParagraph(e.line,e.line.getOffset(e,0)),this.selection.end.setPositionParagraph(this.selection.start.currentWidget,this.selection.start.offset+e.length),this.initHistory("RemoveInline"),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.updateHistoryPosition(this.selection.start,!0),this.removeSelectedContents(this.documentHelper.selection),this.editorHistory&&this.editorHistory.updateHistory(),this.fireContentChange()},e.prototype.addCommentWidget=function(e,t,i,n){if(-1===this.documentHelper.comments.indexOf(e)){var r=!1;if(this.documentHelper.comments.length>0)for(var o=this.selection.getElementPosition(e.commentStart).startPosition,s=0;s<this.documentHelper.comments.length;s++){var a=this.selection.getElementPosition(this.documentHelper.comments[s].commentStart).startPosition;if(o.isExistBefore(a)){r=!0,this.documentHelper.comments.splice(s,0,e);break}}r||this.documentHelper.comments.push(e),this.owner.commentReviewPane&&(this.owner.showComments=i,this.owner.commentReviewPane.selectedTab=0,this.owner.commentReviewPane.addComment(e,t,n),n&&this.owner.selection.selectComment(e))}},e.prototype.addReplyComment=function(e,t){var i=t.split(";"),n=this.documentHelper.comments[parseInt(i[1],10)];""!==i[2]&&(n.replyComments.splice(parseInt(i[2],10),0,e),e.ownerComment=n),this.owner.commentReviewPane&&(this.owner.showComments=!0,this.owner.commentReviewPane.addReply(e,!1,!0),this.owner.selection.selectComment(e))},e.prototype.addProtection=function(e,t,n){return F(this,void 0,void 0,function(){var r=this;return k(this,function(o){return[2,new Promise(function(o,s){if(n=!!i.i(a.isNullOrUndefined)(n)||n,""===e)r.protectDocument(t),o();else{r.currentProtectionType=t;var l=new x.a,d=r.base64.encodeString(e),h={passwordBase64:d,saltBase64:"",spinCount:1e5},c=r.owner.serviceUrl+r.owner.serverActionSettings.restrictEditing;l.url=c,l.contentType="application/json;charset=UTF-8",l.onSuccess=function(e){r.enforceProtectionInternal(e),o()},l.onFailure=function(e){r.protectionFailureHandler(e),s()},l.onError=function(e){r.protectionFailureHandler(e),s()},l.customHeaders=r.owner.headers;var p={serverActionType:"RestrictEditing",headers:r.owner.headers,timeout:0,cancel:!1,withCredentials:!1};r.owner.trigger(u.q,p),p.cancel?r.documentHelper.dialog.visible&&r.documentHelper.dialog.hide():l.send(h,p,n)}})]})})},e.prototype.protectionFailureHandler=function(e){var t=new a.L10n("documenteditor",this.owner.defaultLocale);t.setLocale(this.documentHelper.owner.locale),"onError"===e.name?w.DialogUtility.alert(t.getConstant("Error in establishing connection with web server")):(this.owner.fireServiceFailure(e),console.error(e.statusText))},e.prototype.enforceProtectionInternal=function(e){var t=JSON.parse(e.data);this.enforceProtectionAssign(t[0],t[1],this.currentProtectionType)},e.prototype.enforceProtectionAssign=function(e,t,i){this.documentHelper.saltValue=e,this.documentHelper.hashValue=t,this.protectDocument(i)},e.prototype.toggleTrackChangesProtection=function(e){this.viewer.owner.enableTrackChanges=e;var t={isTrackChangesEnabled:e};this.owner.trigger(u.r,t)},e.prototype.protectDocument=function(e){this.documentHelper.owner.getSettingData("protection",null,this.documentHelper.hashValue,this.documentHelper.saltValue,e),this.protect(e);var t=this.documentHelper.restrictEditingPane.restrictPane;t&&"block"===t.style.display&&(this.documentHelper.restrictEditingPane.showStopProtectionPane(!0),this.documentHelper.restrictEditingPane.loadPaneValue(),this.documentHelper.dialog.hide()),this.owner.notify(u.s,{}),"RevisionsOnly"===e&&this.toggleTrackChangesProtection(!0),this.owner.trackChangesPane.enableDisableButton(!1)},e.prototype.stopProtection=function(e){if(this.documentHelper.isDocumentProtected){if(!i.i(a.isNullOrUndefined)(this.documentHelper.saltValue)&&""===this.documentHelper.saltValue&&!i.i(a.isNullOrUndefined)(this.documentHelper.hashValue)&&""===this.documentHelper.hashValue&&!i.i(a.isNullOrUndefined)(e)&&""===e)return void this.unProtectDocument();var t=new x.a,n=this.base64.encodeString(e),r={passwordBase64:n,saltBase64:this.documentHelper.saltValue,spinCount:1e5};t.url=this.owner.serviceUrl+this.owner.serverActionSettings.restrictEditing,t.contentType="application/json;charset=UTF-8",t.customHeaders=this.owner.headers,t.onSuccess=this.onUnProtectionSuccess.bind(this),t.onFailure=this.protectionFailureHandler.bind(this),t.onError=this.protectionFailureHandler.bind(this);var o={serverActionType:"RestrictEditing",headers:this.owner.headers,timeout:0,cancel:!1,withCredentials:!1};this.owner.trigger(u.q,o),o.cancel?this.documentHelper.dialog.visible&&this.documentHelper.dialog.hide():t.send(r,o,!1),this.toggleTrackChangesProtection(!1)}},e.prototype.stopProtectionAsync=function(e){return F(this,void 0,void 0,function(){var t=this;return k(this,function(n){return[2,new Promise(function(n,r){if(t.documentHelper.isDocumentProtected){if(!i.i(a.isNullOrUndefined)(t.documentHelper.saltValue)&&""===t.documentHelper.saltValue&&!i.i(a.isNullOrUndefined)(t.documentHelper.hashValue)&&""===t.documentHelper.hashValue&&!i.i(a.isNullOrUndefined)(e)&&""===e)return t.unProtectDocument(),void n();var o=new x.a,s=t.base64.encodeString(e),l={passwordBase64:s,saltBase64:t.documentHelper.saltValue,spinCount:1e5};o.url=t.owner.serviceUrl+t.owner.serverActionSettings.restrictEditing,o.contentType="application/json;charset=UTF-8",o.customHeaders=t.owner.headers,o.onSuccess=function(e){t.onUnProtectionSuccess(e),n()},o.onFailure=function(e){t.protectionFailureHandler(e),r()},o.onError=function(e){t.protectionFailureHandler(e),r()};var d={serverActionType:"RestrictEditing",headers:t.owner.headers,timeout:0,cancel:!1,withCredentials:!1};t.owner.trigger(u.q,d),d.cancel?t.documentHelper.dialog.visible&&t.documentHelper.dialog.hide():o.send(l,d),t.toggleTrackChangesProtection(!1)}})]})})},e.prototype.onUnProtectionSuccess=function(e){var t=JSON.parse(e.data);this.validateHashValue(t[1])},e.prototype.validateHashValue=function(e){this.currentHashValue=e;var t=new a.L10n("documenteditor",this.owner.defaultLocale);t.setLocale(this.documentHelper.owner.locale);var i=this.base64.decodeString(e),n=this.documentHelper.hashValue,r=this.base64.decodeString(n),o=!0;if(i.length===r.length){for(var s=0;s<i.length;s++)if(i[s]!==r[s]){o=!1;break}}else o=!1;o?this.unProtectDocument():w.DialogUtility.alert(t.getConstant("The password is incorrect"))},e.prototype.unProtectDocument=function(){this.documentHelper.owner.getSettingData("protection",!1,this.currentHashValue),this.currentHashValue=null;var e=this.documentHelper.protectionType;this.documentHelper.isDocumentProtected=!1,this.documentHelper.restrictFormatting=!1,this.documentHelper.protectionType="NoProtection",this.documentHelper.saltValue="",this.documentHelper.hashValue="",this.documentHelper.selection.highlightEditRegion();var t=this.documentHelper.restrictEditingPane.restrictPane;t&&"block"===t.style.display&&this.documentHelper.restrictEditingPane.showStopProtectionPane(!1),"RevisionsOnly"===e&&this.toggleTrackChangesProtection(!1),this.owner.trackChangesPane.enableDisableButton(!0),i.i(a.isNullOrUndefined)(this.editorHistory)||this.owner.editorHistory.clearHistory(),this.owner.notify(u.s,{}),this.documentHelper.dialog.hide()},e.prototype.fireContentChange=function(){this.owner.documentHelper.render.commentMarkDictionary.clear(),this.selection.isHighlightEditRegion&&(this.owner.enableLockAndEdit?this.owner.collaborativeEditingModule.updateLockRegion():this.selection.onHighlight()),this.selection.highlightFormFields(),this.isPaste||(this.copiedContent=void 0,this.copiedTextContent="",this.previousSectionFormat=void 0,this.previousParaFormat=void 0,this.previousCharFormat=void 0,this.selection.isViewPasteOptions=!1,this.isPasteListUpdated&&(this.isPasteListUpdated=!1),this.selection.showHidePasteOptions(void 0,void 0)),!this.documentHelper.owner.isLayoutEnabled||this.documentHelper.owner.editor.isUserInsert||this.documentHelper.owner.isShiftingEnabled||this.isSkipOperationsBuild||this.isRemoteAction||this.documentHelper.owner.fireContentChange(),this.owner.isSpellCheck&&!i.i(a.isNullOrUndefined)(this.selection.editPosition)&&(this.triggerPageSpellCheck=!1)},e.prototype.updateSelectionTextPosition=function(e){this.getOffsetValue(this.selection),this.selection.start.updatePhysicalPosition(!0),this.selection.isEmpty?this.selection.end.setPositionInternal(this.selection.start):this.selection.end.updatePhysicalPosition(!0),this.selection.upDownSelectionLength=this.selection.end.location.x,this.selection.fireSelectionChanged(e)},e.prototype.predictText=function(){this.documentHelper.suffix="",this.selection.start.paragraph.isEmpty()||0===this.selection.start.offset&&this.selection.start.currentWidget.isFirstLine()||0===this.selection.end.offset&&this.selection.end.currentWidget.isFirstLine()?this.documentHelper.prefix="":this.getPrefixAndSuffix(),this.documentHelper.prefix="@"+String.fromCharCode(160)+this.documentHelper.prefix,this.documentHelper.editableDiv.innerText=this.documentHelper.prefix,this.documentHelper.selection.setEditableDivCaretPosition(this.documentHelper.prefix.length)},e.prototype.getPrefixAndSuffix=function(){var e=this.owner,t=e.documentHelper;if(""!==this.selection.text)return void(t.prefix="");var n=0,o=this.selection.start.currentWidget.getInline(this.selection.start.offset,n),s=o.element;if(n=o.index,void 0!==s){var l=this.selection.getElementBoxInternal(s,n),d=l.element;n=l.index;var h=0;if(!i.i(a.isNullOrUndefined)(d)){var c=!1;for(d instanceof r.d&&n>0&&d.line.isFirstLine()&&(t.prefix=""),s instanceof r.d||(s=this.selection.getPreviousTextElement(s));(h=t.prefix.lastIndexOf(" "))<0&&s instanceof r.d;)if(s.previousNode instanceof r.d&&-1===t.prefix.indexOf(" ")){if(c?t.prefix=s.text+t.prefix:(t.prefix=s.text.substring(0,n),c=!0),(s=s.previousNode)instanceof r.q)break;s instanceof r.d||(s=this.selection.getPreviousTextElement(s))}else if(!(s.previousNode instanceof r.d)){c?t.prefix=s.text+t.prefix:(t.prefix=s.text.substring(0,n),c=!0);break}t.prefix.length>1&&" "===t.prefix[t.prefix.length-1]&&"."===t.prefix[t.prefix.length-2]?(h=-1,t.prefix=""):h=t.prefix.lastIndexOf(" "),t.prefix=h<0?t.prefix:t.prefix.substring(h),0===t.prefix.indexOf(" ")&&t.prefix.length>=1&&(t.prefix=t.prefix.substring(1));var p=0,u=this.selection.end.currentWidget.getInline(this.selection.end.offset,p),g=u.element;if(p=u.index,l=this.selection.getElementBoxInternal(g,p),d=l.element,p=l.index,d){var f=!1;for(d instanceof r.d&&p<d.length&&(t.suffix="");(h=t.suffix.indexOf(" "))<0&&g instanceof r.d;)if(g.nextNode instanceof r.d&&-1===t.suffix.indexOf(" "))f?t.suffix=t.suffix+g.text:(t.suffix=d.text.substring(p),f=!0),g=g.nextNode;else if(!(g.nextNode instanceof r.d)){f?t.suffix=t.suffix+g.text:(t.suffix=d.text.substring(p),f=!0);break}h=t.suffix.indexOf(" "),t.suffix=h<0?t.suffix:t.suffix.substring(0,h)}}}},e.prototype.onKeyDownInternal=function(e,t,i,n){var r=e.which||e.keyCode;if(this.owner.focusIn(),!t||i||n)if(!i||t||n)if(i&&t&&!n)switch(r){case 13:this.owner.isReadOnlyMode||(e.preventDefault(),this.insertColumnBreak());break;case 68:this.owner.isReadOnlyMode||this.owner.selection.toggleUnderline("Double");break;case 77:this.owner.isReadOnlyMode||this.owner.selection.decreaseIndent(),e.preventDefault();break;case 188:e.preventDefault(),this.owner.isReadOnlyMode||this.onApplyCharacterFormat("fontSize","decrement",!0);break;case 190:e.preventDefault(),this.owner.isReadOnlyMode||this.onApplyCharacterFormat("fontSize","increment",!0);break;case 187:e.preventDefault(),this.owner.isReadOnlyMode||this.toggleBaselineAlignment("Superscript");break;case 69:if(e.preventDefault(),!this.owner.isReadOnlyMode){var o={isTrackChangesEnabled:!this.owner.enableTrackChanges};this.owner.trigger(u.r,o)}}else if(!i&&t&&n)switch(r){case 72:e.preventDefault(),!this.owner.isReadOnlyMode&&this.owner.isDocumentLoaded&&this.toggleHighlightColor();break;case 70:e.preventDefault(),!this.owner.isReadOnlyMode&&this.owner.isDocumentLoaded&&this.insertFootnote();break;case 68:e.preventDefault(),!this.owner.isReadOnlyMode&&this.owner.isDocumentLoaded&&this.insertEndnote()}else switch(r){case 8:e.preventDefault(),this.handleBackKey();break;case 9:this.owner.acceptTab?(e.preventDefault(),this.selection.handleTabKey(!0,!1)):this.documentHelper.editableDiv.blur();break;case 13:e.preventDefault(),this.owner.isSpellCheck&&(this.documentHelper.triggerSpellCheck=!0),this.handleEnterKey(),this.owner.isSpellCheck&&(this.documentHelper.triggerSpellCheck=!1);break;case 27:e.preventDefault(),this.isPaste||(this.copiedContent=void 0,this.copiedTextContent="",this.previousParaFormat=void 0,this.previousCharFormat=void 0,this.previousSectionFormat=void 0,this.selection.isViewPasteOptions=!1,this.isPasteListUpdated&&(this.isPasteListUpdated=!1),this.selection.showHidePasteOptions(void 0,void 0));break;case 46:this.handleDelete(),e.preventDefault();break;case 32:this.selection.handleSpaceBarKey();break;case 120:var s=this.selection.getDocumentEnd();s.offset=this.selection.getDocumentEnd().offset+1,this.selection.start.isAtSamePosition(this.selection.getDocumentStart())&&this.selection.end.isAtSamePosition(s)?this.owner.updateFields():this.selection.updateRefField()}else switch(r){case 9:this.owner.acceptTab?(e.preventDefault(),this.selection.handleTabKey(!1,!0)):this.documentHelper.editableDiv.blur();break;case 13:this.handleShiftEnter(),e.preventDefault()}else switch(this.documentHelper.isControlPressed=!0,r){case 8:e.preventDefault(),this.handleCtrlBackKey();break;case 46:e.preventDefault(),this.handleCtrlDelete();break;case 9:e.preventDefault(),this.owner.acceptTab&&this.selection.handleTabKey(!1,!1);break;case 13:e.preventDefault(),this.insertPageBreak();break;case 48:e.preventDefault();var a=0,l=this.documentHelper.selection.start.paragraph.paragraphFormat.beforeSpacing;l>12?a=12:l>0&&l<=12?a=0:0===l&&(a=12),this.onApplyParagraphFormat("beforeSpacing",a,!0,!1);break;case 49:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyParagraphFormat("lineSpacing",1,!1,!1);break;case 50:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyParagraphFormat("lineSpacing",2,!1,!1);break;case 53:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyParagraphFormat("lineSpacing",1.5,!1,!1);break;case 66:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleBold();break;case 68:e.preventDefault(),!this.owner.isReadOnlyMode&&this.owner.fontDialogModule&&this.owner.fontDialogModule.showFontDialog();break;case 69:this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleTextAlignment("Center"),e.preventDefault();break;case 72:e.preventDefault(),!this.owner.isReadOnly&&this.owner.optionsPaneModule&&(this.owner.optionsPaneModule.isReplace=!0,this.owner.optionsPaneModule.showHideOptionsPane(!0));break;case 73:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleItalic();break;case 74:this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleTextAlignment("Justify"),e.preventDefault();break;case 75:e.preventDefault(),this.owner.hyperlinkDialogModule&&!this.owner.isReadOnlyMode&&this.owner.hyperlinkDialogModule.show();break;case 76:this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleTextAlignment("Left"),e.preventDefault();break;case 77:this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.owner.selection.increaseIndent(),e.preventDefault();break;case 78:e.preventDefault(),this.owner.isReadOnlyMode||this.owner.openBlank();break;case 82:this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleTextAlignment("Right"),e.preventDefault();break;case 85:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.owner.selection.toggleUnderline("Single");break;case 88:e.preventDefault(),this.owner.isReadOnlyMode||this.owner.editor.cut();break;case 89:this.owner.enableEditorHistory&&(this.editorHistory.redo(),e.preventDefault());break;case 90:this.owner.enableEditorHistory&&(this.editorHistory.undo(),e.preventDefault());break;case 219:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyCharacterFormat("fontSize","decrement",!0);break;case 221:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyCharacterFormat("fontSize","increment",!0);break;case 187:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleBaselineAlignment("Subscript")}},e.prototype.handleShiftEnter=function(){this.owner.isReadOnlyMode||this.handleTextInput("\v"),this.selection.checkForCursorVisibility()},e.prototype.handleBackKey=function(){(!this.owner.isReadOnlyMode&&this.canEditContentControl||this.selection.isInlineFormFillMode())&&this.owner.editorModule.onBackSpace(),this.selection.checkForCursorVisibility()},e.prototype.handleDelete=function(){(!this.owner.isReadOnlyMode&&this.canEditContentControl||this.selection.isInlineFormFillMode())&&this.owner.editorModule.delete(),this.selection.checkForCursorVisibility()},e.prototype.handleEnterKey=function(){(!this.owner.isReadOnlyMode&&this.canEditContentControl||this.selection.isInlineFormFillMode())&&(a.Browser.isDevice&&(this.documentHelper.isCompositionStart=!1),this.owner.editorModule.onEnter()),this.selection.checkForCursorVisibility()},e.prototype.handleCtrlBackKey=function(){var e=this.selection.start,t=this.selection.end;if(!this.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())if(this.selection.isForward||(e=t),this.selection.isEmpty)this.selection.handleControlShiftLeftKey(),this.owner.editorModule.onBackSpace();else{if((i.i(a.isNullOrUndefined)(e.paragraph.previousRenderedWidget)||e.paragraph.previousRenderedWidget instanceof r.u)&&0===e.offset)return;this.selection.handleLeftKey(),this.selection.handleControlShiftLeftKey(),this.owner.editorModule.onBackSpace()}},e.prototype.handleCtrlDelete=function(){if(!this.owner.isReadOnlyMode&&this.canEditContentControl||this.selection.isInlineFormFillMode())if(this.selection.isEmpty)this.selection.handleControlShiftRightKey(),this.owner.editorModule.delete();else{this.selection.handleLeftKey(),this.selection.handleControlShiftRightKey();var e=this.selection.text,t=s.a.endsWith(e);t&&this.selection.handleShiftLeftKey(),this.owner.editorModule.delete()}},e.prototype.handleTextInput=function(e){var t=this;(!this.owner.isReadOnlyMode&&this.canEditContentControl||this.selection.isInlineFormFillMode())&&(this.animationTimer&&clearTimeout(this.animationTimer),i.i(a.classList)(this.selection.caret,[],["e-de-cursor-animation"]),this.owner.editorModule.insertText(e),this.animationTimer=setTimeout(function(){t.animationTimer&&clearTimeout(t.animationTimer),t.selection&&t.selection.caret&&i.i(a.classList)(t.selection.caret,["e-de-cursor-animation"],[])},600)),this.selection.checkForCursorVisibility()},e.prototype.copyInsertFormat=function(e,t){var n=new o.a,r=this.selection.characterFormat;return t&&n.copyFormat(e),i.i(a.isNullOrUndefined)(r.bidi)||e.bidi===r.bidi||(n.bidi=r.bidi),i.i(a.isNullOrUndefined)(r.bold)||e.bold===r.bold||(n.bold=r.bold),i.i(a.isNullOrUndefined)(r.italic)||e.italic===r.italic||(n.italic=r.italic),r.fontSize>0&&e.fontSize!==r.fontSize&&(n.fontSize=r.fontSize),i.i(a.isNullOrUndefined)(r.fontFamily)||e.fontFamily===r.fontFamily||(n.fontFamily=r.fontFamily),i.i(a.isNullOrUndefined)(r.highlightColor)||e.highlightColor===r.highlightColor||(n.highlightColor=r.highlightColor),i.i(a.isNullOrUndefined)(r.baselineAlignment)||e.baselineAlignment===r.baselineAlignment||(n.baselineAlignment=r.baselineAlignment),i.i(a.isNullOrUndefined)(r.fontColor)||e.fontColor===r.fontColor||(n.fontColor=r.fontColor),i.i(a.isNullOrUndefined)(r.underline)||e.underline===r.underline||(n.underline=r.underline),i.i(a.isNullOrUndefined)(r.strikethrough)||e.strikethrough===r.strikethrough||(n.strikethrough=r.strikethrough),n},e.prototype.getResultContentControlText=function(e){for(var t=e.nextNode,n="";!(t instanceof r.H||(t instanceof r.d&&(n+=t.text),i.i(a.isNullOrUndefined)(t)));)if(i.i(a.isNullOrUndefined)(t.nextNode)){if(!t.paragraph.nextRenderedWidget)break;t=t.paragraph.nextRenderedWidget.firstChild.children[0]}else t=t.nextNode;return n},e.prototype.updateXmlMappedContentControl=function(){if(this.isXmlMapped){var e=this.getContentControl();e&&e.contentControlProperties&&this.updateCustomXml(e.contentControlProperties.xmlMapping.storeItemId,e.contentControlProperties.xmlMapping.xPath,this.getResultContentControlText(e))}},e.prototype.updateCustomXml=function(e,t,i){if(this.documentHelper.customXmlData.containsKey(e)){var n=this.documentHelper.customXmlData.get(e),r=new DOMParser,o=r.parseFromString(n,"text/xml"),s=t.substring(t.lastIndexOf("/")+1);s=s.split("[")[0],s=s.substring(s.lastIndexOf(":")+1),s=s.substring(s.lastIndexOf("@")+1);var a=o.getElementsByTagName(s);if(a.length>0)a[0].childNodes[0].nodeValue=i;else{if(!(o.documentElement.attributes.length>0&&null!==o.documentElement.attributes.getNamedItem(s)))return;o.documentElement.attributes.getNamedItem(s).value=i}var l=new XMLSerializer,d=l.serializeToString(o);this.documentHelper.customXmlData.set(e,d)}},e.prototype.insertText=function(e){i.i(a.isNullOrUndefined)(e)||""===e||this.owner.isReadOnly||"ReadOnly"===this.documentHelper.protectionType&&!this.selection.isSelectionInEditRegion()||"CommentsOnly"===this.documentHelper.protectionType&&this.owner.isReadOnly||this.insertTextInternal(e,!1)},e.prototype.insertTextInternal=function(e,t,n,o){if(e.indexOf("\r")>=0||e.indexOf("\n")>=0)return void("\r"===e||"\n"===e||"\r\n"===e?this.onEnter():(this.isInsertText=!0,this.pasteContents(e),this.isInsertText=!1));if("FormFieldsOnly"===this.documentHelper.protectionType&&this.selection.isInlineFormFillMode()){var l=this.selection.currentFormField;if(!l.formFieldData.enabled)return;var d=this.getFieldResultText(l),h=new RegExp(this.owner.documentHelper.textHelper.getEnSpaceCharacter(),"gi");d.length>0&&""===d.replace(h,"")&&(d="",this.documentHelper.isTextFormEmpty=!0,this.selection.selectFieldInternal(l));var c=l.formFieldData.maxLength;if(0!==c&&d.length>=c)return void(this.documentHelper.isTextFormEmpty=!1)}t&&(this.documentHelper.layout.isReplaceAll=!i.i(a.isNullOrUndefined)(o)&&!o);var p,u=this.documentHelper.selection,g=!0;n=this.owner.enableTrackChanges&&i.i(a.isNullOrUndefined)(n)?"Insertion":n;var f=this.checkAndRemoveComments();if(this.isListTextSelected(),this.documentHelper.isBookmarkInserted&&u.bookmarks.length>0&&this.extendSelectionToBookmarkStart(),(i.i(a.isNullOrUndefined)(n)||"Insertion"===n)&&(this.initHistory("Insert"),!i.i(a.isNullOrUndefined)(this.editorHistory)&&!i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&(this.editorHistory.currentBaseHistoryInfo.insertedText=e,"FormFieldsOnly"===this.documentHelper.protectionType))){var m=this.documentHelper.selection.getCurrentFormField();m&&m instanceof r.b&&m.formFieldData&&m.formFieldData instanceof r.n&&(this.editorHistory.currentBaseHistoryInfo.fieldBegin=m,this.editorHistory.currentBaseHistoryInfo.dropDownIndex=m.formFieldData.selectedIndex)}var v=this.selection.getParagraphInfo(u.start),y=v.paragraph.paragraphFormat;u.editPosition=u.getHierarchicalIndex(v.paragraph,v.offset.toString());var w=u.start.paragraph.paragraphFormat.bidi;if(!u.isEmpty&&!u.isImageSelected||this.documentHelper.isListTextSelected&&"List"===u.contextType){u.isSkipLayouting=!0,u.skipFormatRetrieval=!0;var b=void 0,x=void 0,C=0,I=0;if(this.owner.enableTrackChanges&&(this.selection.start.isExistBefore(this.selection.end)?(x=this.selection.getParagraphInfo(u.end),b=this.selection.end.clone()):(x=this.selection.getParagraphInfo(u.start),b=this.selection.start.clone()),I=x.paragraph.getLength(),C=x.offset,this.skipReplace=!0),g=this.removeSelectedContents(u),this.skipReplace=!1,!i.i(a.isNullOrUndefined)(b)&&this.owner.search&&this.owner.search.isRepalceTracking)this.owner.search.isRepalceTracking=!1,this.selection.start.setPositionInternal(this.selection.start),this.selection.end.setPositionInternal(b);else if(C>0&&C<=I){var F=x.paragraph.getLength();I!==F&&(C-=I-F),this.setPositionParagraph(x.paragraph,C,!0)}u.skipFormatRetrieval=!1,u.isSkipLayouting=!1}else!u.isEmpty||this.documentHelper.isListTextSelected||t||(this.documentHelper.isTextInput=!0);v=this.selection.getParagraphInfo(u.start),v.paragraph.paragraphFormat.copyFormat(y);var k=this.documentHelper.textHelper.containsSpecialCharAlone(e);if(g){if(u.owner.isShiftingEnabled=!0,this.updateInsertPosition(),p=u.start,p.paragraph.isEmpty()){var P=new r.d,T=this.copyInsertFormat(p.paragraph.characterFormat,!0);P.characterFormat.copyFormat(T),P.text=e;var S=this.documentHelper.textHelper.getRtlLanguage(e).isRtl||this.selection.characterFormat.bidi;if(P.characterFormat.bidi=S,T.bidi=S,P.isRightToLeft=S,P.line=p.paragraph.childWidgets[0],P.margin=new r.E(0,0,0,0),P.line.children.push(P),this.setCharFormatForCollaborativeEditing(T),this.owner.enableTrackChanges)if(P.paragraph.characterFormat.revisions.length>0){var W=this.getMatchedRevisionsToCombine(P.paragraph.characterFormat.revisions,n);W.length>0&&this.mapMatchedRevisions(W,P.paragraph.characterFormat,P,!0)}else this.checkToCombineRevisionWithPrevPara(P,n)||this.insertRevision(P,n);("Center"===p.paragraph.paragraphFormat.textAlignment||"Right"===p.paragraph.paragraphFormat.textAlignment||"Justify"===p.paragraph.paragraphFormat.textAlignment&&p.paragraph.paragraphFormat.bidi)&&-1===p.paragraph.paragraphFormat.listFormat.listId&&(p.paragraph.x=p.paragraph.clientX,p.paragraph.clientX=void 0,p.paragraph.hasOwnProperty("absoluteXPosition")&&delete p.paragraph.absoluteXPosition),P instanceof r.d&&P.text.length>90&&s.a.splitWordByMaxLength(P,P.line),this.documentHelper.layout.reLayoutParagraph(p.paragraph,0,0)}else{var N=0,H=p.currentWidget.getInline(p.offset,N,w,!t,this.documentHelper.owner.isSpellCheck),l=H.element;N=H.index,l.ischangeDetected=!0,l instanceof r.d&&" "!==e&&this.documentHelper.owner.isSpellCheck&&(this.owner.spellChecker.removeErrorsFromCollection({element:l,text:l.text}),t||(l.ignoreOnceItems=[])),l.canTrigger&&l.text.length<=1&&(l.canTrigger=!1);var T=this.copyInsertFormat(l.characterFormat,!0),S=this.documentHelper.textHelper.getRtlLanguage(e).isRtl||this.selection.characterFormat.bidi,E=(this.documentHelper.textHelper.getRtlLanguage(e).id,0),O=!1,_=!1;if(l instanceof r.d&&(E=this.documentHelper.textHelper.getRtlLanguage(l.text).id,O=this.documentHelper.textHelper.getRtlLanguage(l.text).isRtl,_=this.documentHelper.textHelper.containsSpecialCharAlone(e)),(!S&&l.characterFormat.bidi&&(0!==E||_&&O)||" "===e&&this.selection.characterFormat.bidi)&&(S=!0),!S&&this.documentHelper.owner.isSpellCheck||(T.bidi=S),this.setCharFormatForCollaborativeEditing(T),(!this.documentHelper.owner.isSpellCheck||" "!==e&&" "!==l.text)&&T.isSameFormat(l.characterFormat)&&this.canInsertRevision(l,n)||""===e.trim()&&!S&&l.characterFormat.bidi||O&&T.isSameFormat(l.characterFormat)&&k)this.insertTextInline(l,u,e,N),this.setCharFormatForCollaborativeEditing(l.characterFormat);else{var B=new r.d;B.text=e,B.line=l.line,B.isRightToLeft=O,B.characterFormat.copyFormat(T),this.setCharFormatForCollaborativeEditing(B.characterFormat),l instanceof r.f&&(B.characterFormat.baselineAlignment="Normal");var L=!1,R=l.indexInOwner,A=B.revisions.length;if(N===l.length){var D=-1;D=R+1,!this.owner.enableTrackChanges||l instanceof r.e||(L=this.checkToMapRevisionWithInlineText(l,N,B,S,n))||B.revisions.length!==A||(L=void 0!=l.nextNode&&1==l.nextNode.revisions.length?this.checkToMapRevisionWithNextNode(l.nextNode,B,S,n):1==l.paragraph.characterFormat.revisions.length&&"Deletion"==l.paragraph.characterFormat.revisions[0].revisionType?this.checkToMapRevisionWithNextNode(l.nextNode,B,S,n,l.paragraph):this.checkToMapRevisionWithNextNode(l.nextNode,B,S,n)),L||(l.line.children.splice(D,0,B),this.checkToCombineRevisionsinBlocks(B,A===B.revisions.length,!0,n))}else if(0===N)this.owner.enableTrackChanges&&((L=this.checkToMapRevisionWithInlineText(l,N,B,S,n))||0!==B.revisions.length||this.checkToMapRevisionWithPreviousNode(l.previousNode,B,S,n)),L||(l.line.children.splice(R,0,B),this.checkToCombineRevisionsinBlocks(B,A===B.revisions.length,!0,n));else{if(l instanceof r.d){var U=new r.d;U.line=l.line,U.characterFormat.copyFormat(l.characterFormat),this.setCharFormatForCollaborativeEditing(U.characterFormat),U.text=l.text.substring(N),this.owner.enableTrackChanges||this.selection.isInField||this.updateRevisionForSpittedTextElement(l,U),l.text=l.text.slice(0,N),this.owner.enableTrackChanges?(L=this.checkToMapRevisionWithInlineText(l,N,B,S,n),L||B.revisions.length>A?this.copyElementRevision(l,U,!0):B.revisions.length===A&&(this.updateRevisionForSpittedTextElement(l,U),this.insertRevision(B,n))):this.selection.isInField&&(this.copyElementRevision(l,U,!1),this.updateElementInFieldRevision(l,B,l.revisions,!0)),this.owner.isSpellCheck&&this.owner.spellChecker.updateSplittedElementError(l,U),l.line.children.splice(R+1,0,U)}L||l.line.children.splice(R+1,0,B)}B instanceof r.d&&B.text.length>90&&s.a.splitWordByMaxLength(B,B.line),(i.i(a.isNullOrUndefined)(n)||"Deletion"!==n||p.paragraph.isLayouted)&&this.documentHelper.layout.reLayoutParagraph(p.paragraph,l.line.indexInOwner,0)}}this.documentHelper.layout.allowLayout=!0,this.setPositionParagraph(v.paragraph,v.offset+e.length,!0),this.updateEndPosition(),i.i(a.isNullOrUndefined)(this.editorHistory)||i.i(a.isNullOrUndefined)(this.editorHistory.currentHistoryInfo)||"ListSelect"!==this.editorHistory.currentHistoryInfo.action||!this.documentHelper.isListTextSelected||(this.editorHistory.updateHistory(),this.editorHistory.updateComplexHistory()),(i.i(a.isNullOrUndefined)(n)||"Insertion"===n)&&this.reLayout(u),this.documentHelper.isTextInput=!1,this.documentHelper.isTextFormEmpty=!1}if(this.updateXmlMappedContentControl(),!t&&g&&(" "===e||"\t"===e||"\v"===e)){var M=!1;if("\v"===e||this.isRemoteAction||(M=this.checkAndConvertList(u,"\t"===e)),!M){if(!i.i(a.isNullOrUndefined)(u.getHyperlinkField()))return;this.checkAndConvertToHyperlink(u,!1)}}this.updateHistoryForComments(f)},e.prototype.extendSelectionToBookmarkStart=function(){if(this.documentHelper.bookmarks.length>0){var e=this.selection.start;this.selection.end;this.selection.isForward||(e=this.selection.end,this.selection.start);for(var t=void 0,i=this.selection.bookmarks,n=0;n<i.length;n++)if(t=this.documentHelper.bookmarks.get(i[n]),this.selection.isElementInSelection(t.reference,!1)&&!this.selection.isElementInSelection(t,!0)){var r=t.line.paragraph,o=this.selection.getParagraphInfo(e);if(r.equals(o.paragraph)){var s=t.line.getOffset(t,t.bookmarkType);t.line===e.currentWidget&&o.offset===s+1&&e.offset--}}}},e.prototype.updateElementInFieldRevision=function(e,t,i,n){for(var r=0;r<i.length;r++){var o=i[r],s=o.range.indexOf(e);o.range.splice(n?s+1:s,0,t),this.owner.trackChangesPane.updateCurrentTrackChanges(o)}},e.prototype.retrieveFieldResultantText=function(e){var t="";if(1===e.fieldType)for(var n=e.previousElement;!i.i(a.isNullOrUndefined)(n)&&n instanceof r.d;)t=n.text+t,n=i.i(a.isNullOrUndefined)(n.previousNode)?void 0:n.previousNode.previousValidNodeForTracking;return t},e.prototype.checkToCombineRevisionsinBlocks=function(e,t,i,n){if(t&&this.owner.enableTrackChanges&&!(e instanceof r.e||e instanceof r.B||e instanceof r.G||e instanceof r.F)){var o=!1;o=i?this.combineRevisionWithNextPara(e,n):this.combineRevisionWithPrevPara(e,n),o||this.insertRevision(e,n)}},e.prototype.checkToMapRevisionWithNextNode=function(e,t,n,r,o){if(!i.i(a.isNullOrUndefined)(o)&&1==o.characterFormat.revisions.length){var s=o.characterFormat;return!i.i(a.isNullOrUndefined)(s)&&this.checkToMapRevisionWithInlineText(void 0,0,t,n,r,s)}if(i.i(a.isNullOrUndefined)(e))return!1;var l=e.nextValidNodeForTracking;return!i.i(a.isNullOrUndefined)(l)&&this.checkToMapRevisionWithInlineText(l,0,t,n,r)},e.prototype.checkToMapRevisionWithPreviousNode=function(e,t,n,r){if(i.i(a.isNullOrUndefined)(e))return!1;var o=e.previousValidNodeForTracking;return!i.i(a.isNullOrUndefined)(o)&&this.checkToMapRevisionWithInlineText(o,o.length,t,n,r)},e.prototype.checkToMapRevisionWithInlineText=function(e,t,n,r,o,s){if(i.i(a.isNullOrUndefined)(s)){if(!i.i(a.isNullOrUndefined)(e))if("Deletion"===o&&this.updateLastElementRevision(n),e.length===t&&void 0!=e.previousValidNodeForTracking){if(e=e.previousValidNodeForTracking,t=e.length,e.revisions.length>0)return this.applyMatchedRevisionInorder(e,n,t,!1,r,o)}else if(0===t&&(e=e.nextValidNodeForTracking,!i.i(a.isNullOrUndefined)(e)&&e.revisions.length>0))return this.applyMatchedRevisionInorder(e,n,t,!0,r,o)}else if("Deletion"===o&&this.updateLastElementRevision(n),!i.i(a.isNullOrUndefined)(s)&&s.revisions.length>0)return this.applyMatchedRevisionInorder(void 0,n,t,!0,r,o,s);return!1},e.prototype.combineElementRevisions=function(e,t){if(0!==e.revisions.length&&0!==t.revisions.length)for(var i=0;i<e.revisions.length;i++)for(var n=e.revisions[i],r=0;r<t.revisions.length;r++){var o=t.revisions[i];-1===n.range.indexOf(t)&&o.revisionType===n.revisionType&&o.author===n.author&&(t.revisions.splice(r,1),n.range.push(t),t.revisions.splice(r,0,n),this.owner.trackChangesPane.updateCurrentTrackChanges(n))}},e.prototype.applyMatchedRevisionInorder=function(e,t,n,r,o,s,l){var d;return!i.i(a.isNullOrUndefined)(l)&&i.i(a.isNullOrUndefined)(e)?(d=this.getMatchedRevisionsToCombine(l.revisions,s),d.length>0&&this.mapMatchedRevisions(d,l,t,r),!1):(d=this.getMatchedRevisionsToCombine(e.revisions,s),d.length>0&&this.mapMatchedRevisions(d,e,t,r),!1)},e.prototype.copyElementRevision=function(e,t,i){if(!this.isTrackingFormField)for(var n=0;n<e.revisions.length;n++){var r=e.revisions[n],o=r.range.indexOf(e);t.revisions.splice(0,0,r),r.range.splice(o+(i?2:1),0,t),this.owner.trackChangesPane.updateCurrentTrackChanges(r)}},e.prototype.mapMatchedRevisions=function(e,t,n,s){for(var l=0;l<e.length;l++){var d=e[l];if(!this.isRevisionAlreadyIn(n,d)||n instanceof o.a){n.revisions.splice(0,0,d),this.editorHistory&&!i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&this.editorHistory.currentBaseHistoryInfo.markerData.push(this.getMarkerData(void 0,void 0,d)),n instanceof r.f&&this.insertRevisionForFootnoteWidget(n,d);var h=d.range.indexOf(t);d.range.splice(s?h:h+1,0,n),this.owner.trackChangesPane.updateCurrentTrackChanges(d)}}},e.prototype.isRevisionAlreadyIn=function(e,t){if(e.revisions.length>0)for(var i=0;i<e.revisions.length;i++){var n=e.revisions[i];if(n.revisionID===t.revisionID)return!0}return!1},e.prototype.getMatchedRevisionsToCombine=function(e,t){for(var i=[],n=0;n<e.length;n++)this.isRevisionMatched(e[n],t)&&i.push(e[n]);return i},e.prototype.decideInlineForTrackChanges=function(e,t){var n=!1;if(this.owner.enableTrackChanges&&!this.canInsertRevision(e,t)){var r=e.nextValidNodeForTracking;!i.i(a.isNullOrUndefined)(r)&&this.canInsertRevision(r,t)&&(e=r,n=!0)}return{element:e,isMatched:n}},e.prototype.insertIMEText=function(e,t){if(this.documentHelper.lastComposedText!==e||!t){var i=this.selection.getParagraphInfo(this.selection.start),r=this.selection.getHierarchicalIndex(i.paragraph,i.offset.toString());this.insertText(e),this.documentHelper.lastComposedText=e;var o=this.selection.start;this.setPositionForCurrentIndex(o,r);var s=new n.a(this.owner);s.setPositionForLineWidget(o.currentWidget,o.offset+e.length),this.owner.enableTrackChanges?(t||this.selection.start.setPositionInternal(this.selection.end),this.selection.end.updatePhysicalPosition(!0)):this.selection.selectPosition(t?o:s,s)}},e.prototype.insertSectionBreak=function(e){i.i(a.isNullOrUndefined)(e)&&(e=y.d.NewPage);var t=this.documentHelper.selection;i.i(a.isNullOrUndefined)(t)||this.owner.isReadOnlyMode||t.start.paragraph.isInHeaderFooter||(e===y.d.Continuous?this.initHistory("SectionBreakContinuous"):this.initHistory("SectionBreak"),t.isEmpty||t.selectContent(t.isForward?t.start:t.end,!0),this.documentHelper.owner.isShiftingEnabled=!0,this.updateInsertPosition(),e===y.d.Continuous?(this.documentHelper.layout.isSectionBreakCont=!0,this.insertSection(t,!0,void 0,!0)):this.insertSection(t,!0,void 0,void 0,!0),this.updateEndPosition(),this.reLayout(t,!0),this.layoutWholeDocument(!0),this.documentHelper.layout.isSectionBreakCont=!1)},e.prototype.combineRevisionWithBlocks=function(e,t){if(this.owner.enableTrackChanges&&!i.i(a.isNullOrUndefined)(e)){for(;e instanceof r.e||e instanceof r.B||e instanceof r.q;)e=e.nextElement;if(!i.i(a.isNullOrUndefined)(e)){var n=e instanceof r.g?e.previousRenderedWidget:e.paragraph.previousRenderedWidget;if(!(n instanceof r.u)){var o;if(o=e instanceof r.g?e.characterFormat:e,!i.i(a.isNullOrUndefined)(n)&&n.characterFormat.revisions.length>0){var s=n.lastChild;if(i.i(a.isNullOrUndefined)(s)||0===s.children.length)return;for(var l=s.children[s.children.length-1];l instanceof r.e||l instanceof r.B||l instanceof r.q;)l=l.previousElement;if(n.isEmpty()&&(l=n.characterFormat),l.revisions.length>0&&this.compareElementRevision(n.characterFormat,o)){var d=o.revisions[o.revisions.length-1];if(this.compareElementRevision(l,o)){var h=l.revisions[l.revisions.length-1];!1,d!==h&&(this.clearAndUpdateRevisons(d.range,h,h.range.indexOf(l)+1),this.owner.revisions.remove(d))}}}var c;if(e instanceof r.g)c=e.characterFormat;else{for(var s=e.paragraph.lastChild;0==s.children.length&&!i.i(a.isNullOrUndefined)(s.previousLine);)s=s.previousLine;c=s.children[s.children.length-1],e=void 0==c?e:c}var p=e instanceof r.g?e.nextRenderedWidget:e.paragraph.nextRenderedWidget;if(!(p instanceof r.u)){if(!i.i(a.isNullOrUndefined)(p)){for(var u=p.firstChild,g=u.children[0];g instanceof r.e||g instanceof r.B||g instanceof r.q;)g=g.nextElement;if(p.isEmpty()&&(g=p.characterFormat),i.i(a.isNullOrUndefined)(g))return;if(g.revisions.length>0){var f=g.revisions[g.revisions.length-1];if(this.compareElementRevision(o,g)&&this.compareElementRevision(o,g)){var h=o.revisions[o.revisions.length-1];!1,f!==h&&(this.clearAndUpdateRevisons(f.range,h,h.range.indexOf(e)+1),this.owner.revisions.remove(f))}}}e instanceof r.c&&0===e.revisions.length&&this.insertRevision(e,t)}}}}},e.prototype.checkToCombineRevisionWithNextPara=function(e,t){var n=e.paragraph.nextRenderedWidget;if(n instanceof r.u)return!1;if(!i.i(a.isNullOrUndefined)(n)&&!n.isEmpty()){for(var o=n.firstChild,s=o.children[0];s instanceof r.e||s instanceof r.B;)s=s.previousElement;if(i.i(a.isNullOrUndefined)(s))return!1;if(s.revisions.length>0){var l=this.getMatchedRevisionsToCombine(s.revisions,t);if(l.length>0)return this.mapMatchedRevisions(l,s,e,!0),!0}}return!1},e.prototype.checkToCombineRevisionWithPrevPara=function(e,t){var n=e.paragraph.previousRenderedWidget;if(n instanceof r.u)return!1;if(!i.i(a.isNullOrUndefined)(n)&&n.characterFormat.revisions.length>0){if(!this.isRevisionMatched(n.characterFormat,t))return!1;var o=this.getMatchedRevisionsToCombine(n.characterFormat.revisions,t);if(o.length>0)return this.mapMatchedRevisions(o,n.characterFormat,e,!1),!0}return!1},e.prototype.combineRevisionWithNextPara=function(e,t){var n=e.line.isLastLine(),r=e.nextNode;return!(!n||!i.i(a.isNullOrUndefined)(r))&&this.checkToCombineRevisionWithNextPara(e,t)},e.prototype.combineRevisionWithPrevPara=function(e,t){var n=e.line.isFirstLine(),r=e.previousNode;return!(!n||!i.i(a.isNullOrUndefined)(r))&&this.checkToCombineRevisionWithPrevPara(e,t)},e.prototype.removeRevision=function(e){var t=this.selection.start.currentWidget.getInline(this.selection.start.offset+1,0),i=t.element;if(t.element.revisions.length>0)for(var n=0;n<i.revisions.length;n++)if(i.revisions[n].revisionType===e.revisionType)for(var r=i.revisions[n],o=r.range.indexOf(i),s=o;o<r.range.length;o++)r.range[s].revisions.splice(n,1),r.range.splice(s,1),this.owner.trackChangesPane.updateCurrentTrackChanges(r)},e.prototype.clearElementRevision=function(e){if(!i.i(a.isNullOrUndefined)(e))for(var t=0;t<e.range.length;t++)if(e.range[t]instanceof r.c){var n=e.range[t];n.revisions.splice(n.revisions.length-1,1),e.range.splice(t,1),this.owner.trackChangesPane.updateCurrentTrackChanges(e)}},e.prototype.insertRevision=function(e,t,n,l,d,h){var c;if(this.revisionData.length>0){var p=this.revisionData.pop();n=p.author,l=p.date,c=p.revisionId}n=i.i(a.isNullOrUndefined)(n)?this.owner.currentUser?this.owner.currentUser:"Guest user":n;var u=i.i(a.isNullOrUndefined)(l)?s.a.getUtcDate():l;if(e instanceof r.c&&!i.i(a.isNullOrUndefined)(e.line)&&e.line.paragraph.associatedCell||e instanceof o.a&&e.ownerBase instanceof r.g&&e.ownerBase.associatedCell){var g=void 0;if(e instanceof r.c?g=e.line.paragraph.associatedCell:e instanceof o.a&&(g=e.ownerBase.associatedCell),g.ownerRow.rowFormat.revisions.length>0){var f=g.ownerRow.rowFormat,m=this.getMatchedRevisionsToCombine(f.revisions,t);if(m.length>0){for(var v=0;v<m.length;v++)e.revisions.splice(0,0,m[v]),m[v].range.push(e);return}}}var y=new b.b(this.owner,n,u);return y.revisionType=t,this.owner.enableCollaborativeEditing&&this.isRemoteAction&&!i.i(a.isNullOrUndefined)(c)&&""!=c?y.revisionID=c:y.revisionID=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),this.owner.enableCollaborativeEditing&&!i.i(a.isNullOrUndefined)(this.getRevision(y.revisionID))&&(y=this.getRevision(y.revisionID)),!i.i(a.isNullOrUndefined)(d)&&d.length>0&&this.clearAndUpdateRevisons(d,y,d.indexOf(e)),i.i(a.isNullOrUndefined)(e)||(e instanceof r.f&&this.insertRevisionForFootnoteWidget(e,y),this.owner.enableCollaborativeEditing&&!i.i(a.isNullOrUndefined)(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&!h&&this.editorHistory.currentBaseHistoryInfo.markerData.splice(0,0,this.getMarkerData(e,void 0,y)),e.revisions.push(y),y.range.push(e)),this.updateRevisionCollection(y),y},e.prototype.insertRevisionForFootnoteWidget=function(e,t){var i=e.bodyWidget.childWidgets;this.skipFootNoteDeleteTracking=!0;for(var n=0;n<i.length;n++)this.insertRevisionForBlock(i[n],t.revisionType,!1,t);this.skipFootNoteDeleteTracking=!1},e.prototype.clearAndUpdateRevisons=function(e,t,i){t.range.filter(function(e){return e instanceof o.a})&&(i+=1);for(var n=0;n<e.length;n++)if(e[n]instanceof r.c||e[n]instanceof o.a){var s=e[n];s.revisions.splice(s.revisions.length-1,1),s.revisions.push(t),t.range.splice(i+n,0,s),this.owner.trackChangesPane.updateCurrentTrackChanges(t)}},e.prototype.splitRevisionByElement=function(e,t){if(e.revisions.length>0){var i=t.range,n=i.indexOf(e);return t.range=i.splice(0,n+1),this.owner.trackChangesPane.updateCurrentTrackChanges(t),i}},e.prototype.updateRevisionForSpittedTextElement=function(e,t){!i.i(a.isNullOrUndefined)(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.splittedRevisions=[]);for(var n=0;n<e.revisions.length;n++){var r=e.revisions[n],o=this.splitRevisionByElement(e,r),s=this.insertRevision(t,r.revisionType,r.author,r.date,o,!0);this.isRemoteAction||this.editorHistory.currentBaseHistoryInfo.splittedRevisions.push(this.getMarkerData(void 0,void 0,this.getRevision(s.revisionID)))}},e.prototype.getRevision=function(e){for(var t=0;t<this.owner.documentHelper.revisionsInternal.length;t++){var i=this.owner.documentHelper.revisionsInternal.keys[t];if(i===e)return this.owner.documentHelper.revisionsInternal.get(i)}},e.prototype.isRevisionMatched=function(e,t){var n=this.owner.currentUser?this.owner.currentUser:"Guest user";if(e instanceof b.b){if((i.i(a.isNullOrUndefined)(t)||t===e.revisionType)&&e.author===n)return!0}else if(e.revisions.length>0)for(var r=0;r<e.revisions.length;r++){var o=e.revisions[r];if((i.i(a.isNullOrUndefined)(t)||t===o.revisionType)&&o.author===n)return!0}return!1},e.prototype.compareElementRevision=function(e,t){if(0===e.revisions.length||0===t.revisions.length)return!1;for(var i=0;i<e.revisions.length;i++)for(var n=e.revisions[i],r=0;r<t.revisions.length;r++)if(n.author===t.revisions[r].author&&n.revisionType===t.revisions[r].revisionType)return!0;return!1},e.prototype.canInsertRevision=function(e,t){var n=i.i(a.isNullOrUndefined)(t)?"Insertion":t;return"Deletion"!==n&&(this.owner.enableTrackChanges?this.isRevisionMatched(e,n):!(e.revisions.length>0))},e.prototype.insertRevisionAtEnd=function(e,t,n){return!(t instanceof r.e||t instanceof r.B||t instanceof r.G||t instanceof r.F)&&(e=e.previousValidNodeForTracking,!i.i(a.isNullOrUndefined)(e)&&this.insertRevisionAtPosition(e,t,!0,n))},e.prototype.insertRevisionAtPosition=function(e,t,i,n){var r=t.revisions.length,o=this.checkToMapRevisionWithInlineText(e,i?e.length:0,t,!1,n);return i?o||t.revisions.length!==r||(o=this.checkToMapRevisionWithNextNode(e.nextNode,t,!1,n)):o||t.revisions.length!==r||(o=this.checkToMapRevisionWithPreviousNode(e.previousNode,t,!1,n)),o},e.prototype.insertRevisionAtBegining=function(e,t,n){return!(t instanceof r.e||t instanceof r.B||t instanceof r.G||t instanceof r.F)&&(e=e.nextValidNodeForTracking,!i.i(a.isNullOrUndefined)(e)&&this.insertRevisionAtPosition(e,t,!1,n))},e.prototype.splitRevisionForSpittedElement=function(e,t){for(var i=e.revisions.length-1;i>=0;i--){var n=e.revisions[i],r=this.splitRevisionByElement(e,n);this.insertRevision(t,n.revisionType,n.author,n.date,r)}},e.prototype.combineElementRevision=function(e,t){for(var i=0;i<e.length;i++)for(var n=0;n<t.length;n++){var r=e[i],o=t[n];if(r.author===o.author&&r.revisionType===o.revisionType){for(var s=o.range.length,a=0;a<s;a++){var l=o.range[0];l.revisions.splice(l.revisions.indexOf(o),1),o.range.splice(0,1),this.owner.trackChangesPane.updateCurrentTrackChanges(o),r.range.push(l),this.owner.trackChangesPane.updateCurrentTrackChanges(r),l.revisions.push(r)}0===o.range.length&&this.owner.revisions.remove(o)}}},e.prototype.combineRevisions=function(e,t,n){if(this.owner.enableTrackChanges){var r=this.selection.getLineInfo(e,t.offset),o=r.line.getInline(t.offset,0),s=o.element;if(s.revisions.length>0&&this.isRevisionMatched(s,"Insertion")){var l=s.nextElement;if(!i.i(a.isNullOrUndefined)(l)&&l.revisions.length>0){var d=s.revisions[s.revisions.length-1],h=l.revisions[l.revisions.length-1].range;d!==l.revisions[l.revisions.length-1]&&this.clearAndUpdateRevisons(h,d,d.range.indexOf(s)+1)}}}},e.prototype.insertRevisionForBlock=function(e,t,n,o,l){if(0!==e.childWidgets.length&&this.owner.enableTrackChanges)if("Deletion"===t){var d=this.selection.editPosition,h=this.selection.start.clone(),c=this.selection.end.clone();this.documentHelper.layout.clearListElementBox(e);var p=e==this.getLastParaForBodywidgetCollection(e),u=this.selection.getNextParagraphBlock(e);p||e.isInsideTable||i.i(a.isNullOrUndefined)(u)&&e.isEmpty()?!p&&e.isInsideTable&&h.paragraph.isInsideTable&&c.paragraph.isInsideTable&&c.offset<=c.paragraph.getLength()&&c.paragraph.associatedCell.index===h.paragraph.associatedCell.index&&(this.addRemovedNodes(e.clone()),this.insertRevision(e.characterFormat,t)):(this.addRemovedNodes(e.clone()),this.insertRevision(e.characterFormat,t));for(var g=e.childWidgets.length-1;g>-1;g--){var f=e.childWidgets[g];this.removeContent(f,0,this.documentHelper.selection.getLineLength(f),void 0,!p)}for(var m=e.lastChild;0==m.children.length&&!i.i(a.isNullOrUndefined)(m.previousLine);)m=m.previousLine;if(m.children.length>0){var v=m.children[m.children.length-1];this.combineElementRevision(v.revisions,e.characterFormat.revisions)}this.selection.editPosition=d,this.selection.start.setPositionInternal(h),this.selection.end.setPositionInternal(c),this.removeEmptyLine(e),l||this.documentHelper.layout.reLayoutParagraph(e,0,0)}else{var y=!1;if(i.i(a.isNullOrUndefined)(o)){var w=this.owner.currentUser?this.owner.currentUser:"Guest user";o=new b.b(this.owner,w,s.a.getUtcDate()),o.revisionID=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),o.revisionType=t}for(var g=0;g<e.childWidgets.length;g++){var x=e.childWidgets[g].children;if(0===x.length){var C=e.containerWidget.childWidgets.indexOf(e),I=void 0;if(C>0&&(I=e.containerWidget.childWidgets[C-1]),!i.i(a.isNullOrUndefined)(I)&&I instanceof r.g&&I.characterFormat.revisions.length>0&&this.isRevisionMatched(I.characterFormat,t)){var F=this.getMatchedRevisionsToCombine(I.characterFormat.revisions,t);F.length>0&&(this.mapMatchedRevisions(F,I.characterFormat,e.characterFormat,!1),y=!0,o=void 0)}}for(var k=0;k<x.length;k++)if(0!==k||n)x[k].revisions.push(o),o.range.push(x[k]);else{var P=x[g].revisions.length;this.checkToCombineRevisionsinBlocks(x[g],!0,!1,"Insertion"),x[g].revisions.length>P?o=x[g].revisions[x[g].revisions.length-1]:(x[k].revisions.push(o),o.range.push(x[k]))}}n||y||(e.characterFormat.revisions.push(o),o.range.push(e.characterFormat)),i.i(a.isNullOrUndefined)(o)||(this.owner.trackChangesPane.updateCurrentTrackChanges(o),this.updateRevisionCollection(o))}},e.prototype.getLastParaForBodywidgetCollection=function(e){var t=e.containerWidget;if(t.containerWidget instanceof r.a)return t.childWidgets[t.childWidgets.length-1];var i=this.documentHelper.pages[this.documentHelper.pages.length-1],n=i.bodyWidgets[i.bodyWidgets.length-1];return n.childWidgets[n.childWidgets.length-1]},e.prototype.updateRevisionCollection=function(e){var t=!1,s=void 0;if(this.owner.revisions.changes.indexOf(e)<0){if(this.documentHelper.revisionsInternal.containsKey(e.revisionID)||this.documentHelper.revisionsInternal.add(e.revisionID,e),this.owner.revisions.changes.length>0)for(var d=this.owner.selection.start,h=0;h<this.owner.revisions.changes.length;h++){var c=this.owner.revisions.changes[h].range[0];if(c instanceof r.c&&!i.i(a.isNullOrUndefined)(c.line)&&c.line.paragraph.bodyWidget)s=this.selection.getElementPosition(this.owner.revisions.changes[h].range[0]).startPosition;else if(c instanceof l.f){var p=c.ownerBase,u=p.childWidgets[0],g=this.selection.getFirstParagraph(u);if(g.bodyWidget&&this.selection.start.paragraph.isInsideTable){var f=this.documentHelper.selection;this.updateEditPosition(u,f),s=this.selection.getTextPosBasedOnLogicalIndex(f.editPosition)}}else if(c instanceof o.a){var m=c.ownerBase;if(m.lastChild&&m.lastChild.paragraph.bodyWidget){var v=m.getLength(),y=new n.a(this.owner);y.setPositionParagraph(m.lastChild,v),s=y}}if(!i.i(a.isNullOrUndefined)(s)&&!i.i(a.isNullOrUndefined)(d)&&d.isExistBefore(s)&&!(e.range[0]instanceof l.f)){t=!0,this.owner.revisions.changes.splice(h,0,e);var w=new I.b(this.owner,this.owner.trackChangesPane);this.owner.trackChangesPane.changesInfoDiv.insertBefore(w.createSingleChangesDiv(e),this.owner.trackChangesPane.changesInfoDiv.children[h+1]),this.owner.trackChangesPane.revisions.splice(h,0,e),this.owner.trackChangesPane.changes.add(e,w),this.owner.trackChangesPane.renderedChanges.add(e,w);break}}if(!(t||(this.owner.revisions.changes.push(e),e.range[0]instanceof l.f))){var w=new I.b(this.owner,this.owner.trackChangesPane);this.owner.trackChangesPane.changesInfoDiv.appendChild(w.createSingleChangesDiv(e)),this.owner.trackChangesPane.revisions.push(e),this.owner.trackChangesPane.changes.add(e,w),this.owner.trackChangesPane.renderedChanges.add(e,w)}this.documentHelper.updateAuthorIdentity()}},e.prototype.insertSection=function(e,t,n,o,s,l){var d,h=this.selection.start.paragraph;if(o&&!n&&!h.isInsideTable&&0===e.start.offset&&e.start.currentWidget===h.firstChild&&!i.i(a.isNullOrUndefined)(h.previousRenderedWidget)&&h.previousRenderedWidget instanceof r.g&&h.previousRenderedWidget.isEndsWithPageBreak)return this.selection.start.paragraph.bodyWidget.sectionFormat.breakCode="NoBreak",this.selection.start.paragraph.index=0,this.updateNextBlocksIndex(this.selection.start.paragraph,!0),this.updateSectionIndex(this.selection.start.paragraph.bodyWidget.sectionFormat,this.selection.start.paragraph.bodyWidget,!0),this.selection.moveToNextParagraph(),this.editorHistory.currentBaseHistoryInfo.insertPosition=void 0,void this.updateInsertPosition();d=i.i(a.isNullOrUndefined)(l)?this.selection.start.paragraph.bodyWidget.sectionFormat.cloneFormat():l;var c,p;if(e.start.paragraph.isInsideTable){var u=this.documentHelper.layout.getParentTable(e.start.paragraph);u=u.combineWidget(this.owner.viewer);var g=!1;0===e.start.paragraph.associatedCell.rowIndex&&(g=!0);var f=new r.g,m=u.previousRenderedWidget;g?c=u:(c=this.splitTable(u,e.start.paragraph.associatedCell.ownerRow),this.documentHelper.layout.layoutBodyWidgetCollection(c.index,c.containerWidget,c,!1),c=c.getSplitWidgets().pop());var v=0;!i.i(a.isNullOrUndefined)(m)&&m.bodyWidget.equals(c.bodyWidget)||!g?(v=c.indexInOwner+1,f.index=c.index+1):(v=0,f.index=0),c.containerWidget.childWidgets.splice(v,0,f),f.containerWidget=c.containerWidget,this.updateNextBlocksIndex(f,!0),this.documentHelper.layout.layoutBodyWidgetCollection(f.index,f.containerWidget,f,!1),c=f}else{var y=this.selection.getParagraphInfo(e.start),w=this.selection.getHierarchicalIndex(y.paragraph,y.offset.toString());n||this.splitParagraphInternal(e,e.start.paragraph,e.start.currentWidget,e.start.offset),this.setPositionForCurrentIndex(e.start,w),c=e.start.paragraph.getSplitWidgets().pop(),n&&void 0!==c.previousRenderedWidget&&(c=c.previousRenderedWidget)}return p=this.splitBodyWidget(c.bodyWidget,d,c,o,s).firstChild,n&&this.layoutWholeDocument(!0),p instanceof r.u&&p.updateRowIndex(0),this.documentHelper.layout.layoutBodyWidgetCollection(p.index,p.containerWidget,p,!1),p instanceof r.u&&(p=this.documentHelper.getFirstParagraphInFirstCell(p)),t&&e.selectParagraphInternal(p,!0),p},e.prototype.splitBodyWidget=function(e,t,n,r,o){var s=this.documentHelper.layout.moveBlocksToNextPage(n,!0,void 0,r);if(this.editorHistory.isUndoing&&(n.bodyWidget.sectionFormat=t),void 0===s.page)s.page=e.page,e.page.bodyWidgets.splice(e.page.bodyWidgets.indexOf(e)+1,0,s);else if(e.page.bodyWidgets.length>1&&void 0!==s.page&&!this.editorHistory.isUndoing){for(var d=s;!i.i(a.isNullOrUndefined)(e.nextRenderedWidget)&&s!==e.nextRenderedWidget;){var h=e.nextRenderedWidget.page.bodyWidgets.indexOf(e.nextRenderedWidget);s.page.bodyWidgets.push(e.nextRenderedWidget),e.nextRenderedWidget.page.bodyWidgets.splice(h,1)}for(;!i.i(a.isNullOrUndefined)(s.nextRenderedWidget);)s.nextRenderedWidget.page=s.page,s=s.nextRenderedWidget;s=d,s.sectionFormat=new l.G(s),this.viewer.owner.parser.parseSectionFormat(0,e.sectionFormat,s.sectionFormat),s.sectionFormat.breakCode="NewPage"}return r&&(s.sectionFormat=new l.G(s),this.viewer.owner.parser.parseSectionFormat(0,e.sectionFormat,s.sectionFormat),s.sectionFormat.breakCode="NoBreak"),o&&(s.sectionFormat=new l.G(s),this.viewer.owner.parser.parseSectionFormat(0,e.sectionFormat,s.sectionFormat),s.sectionFormat.breakCode="NewPage"),this.updateSectionIndex(s.sectionFormat,s,!0),s.sectionFormat.numberOfColumns>1&&this.updateColumnIndex(s,!1),this.editorHistory&&!this.editorHistory.isUndoing&&this.insertRemoveHeaderFooter(s.sectionIndex,!0),this.updateBlockIndex(0,s.firstChild),this.owner.viewer.updateClientArea(s,s.page),s},e.prototype.insertRemoveHeaderFooter=function(e,t){this.documentHelper.headersFooters[e]?this.documentHelper.headersFooters.splice(e,0,{}):this.documentHelper.headersFooters[e]={}},e.prototype.updateBlockIndex=function(e,t){var n,r=t.bodyWidget.sectionIndex;do{n=t.getSplitWidgets();for(var o=0;o<n.length;o++)n[o].index=e;e++,t=n.pop().nextRenderedWidget}while(!i.i(a.isNullOrUndefined)(t)&&t.bodyWidget.sectionIndex===r)},e.prototype.updateSectionIndex=function(e,t,i){var n=t.sectionIndex,r=t;do{r.index===n&&e&&(r.sectionFormat=e),i?r.index++:r.index--,r=r.nextRenderedWidget}while(r)},e.prototype.updateColumnIndex=function(e,t){var n=e;do{if(!t&&0===n.columnIndex)break;if(t?n.columnIndex++:n.columnIndex--,!i.i(a.isNullOrUndefined)(n.nextRenderedWidget)&&n.sectionIndex!==n.nextRenderedWidget.sectionIndex)break;n=n.nextRenderedWidget}while(n)},e.prototype.checkAndConvertList=function(e,t){var n=e.paragraphFormat.getList();if(!i.i(a.isNullOrUndefined)(n)||e.start.paragraph.containerWidget instanceof r.a)return!1;var o=!1,l=!1,d=0,h=e.start.currentWidget.getInline(e.start.offset-1,d),p=h.element;if(d=h.index,!(p instanceof r.d))return!1;for(var u=p,g=u.text.substring(0,d),f=0,m=0;!i.i(a.isNullOrUndefined)(u.previousNode);){if(!(u.previousNode instanceof r.d)||"\t"!==u.previousNode.text&&0!==u.previousNode.text.trim().length)return!1;"\t"===u.previousNode.text?f+=36:m=2.5*u.previousNode.text.length,u=u.previousNode}u=p;var v=0,y=g.lastIndexOf("\t");for(v=y>=0?y+1:g.lastIndexOf(" ")+1;u.previousNode instanceof r.d&&0===v;){u=u.previousNode;var w=u.text;y=w.lastIndexOf("\t"),v=y>=0?y+1:w.lastIndexOf(" ")+1,g=u.text+g,g=g.substring(v)}g=s.a.trimStart(g);var b=g.substring(1,2),x=void 0,C=this.getListLevelPattern(g.substring(0,1));if("None"!==C&&this.checkNumberFormat(b,"Bullet"===C,g)?o=!0:this.checkLeadingZero(g)?(l=!0,o=!0):(x=this.checkNextLevelAutoList(g),i.i(a.isNullOrUndefined)(x)||(o=!0)),!o||"Bullet"!==C||"- "!==p.text||i.i(a.isNullOrUndefined)(p.paragraph.previousWidget)||p.paragraph.previousWidget.firstChild.children[0]instanceof r.q||(o=!1),o){this.initComplexHistory("AutoList");var I=p.paragraph;e.start.setPositionParagraph(I.childWidgets[0],I.childWidgets[0].getOffset(p,d+1)),e.end.setPositionParagraph(I.childWidgets[0],0),this.initHistory("Delete"),this.deleteSelectedContents(e,!1),this.reLayout(e,!1);var F=t?"Tab":"Space";b=l?"%1"+g.substring(g.length-1,g.length):"%1"+b;var k=g.substring(g.length-3,g.length-1);C=l?this.getListLevelPattern(k):C;var P=new c.a(void 0);P.listLevelPattern=C,"Bullet"===C?"*"===g?(P.numberFormat=String.fromCharCode(61623),P.characterFormat.fontFamily="Symbol"):"-"===g&&(P.numberFormat="-"):P.numberFormat=b,P.followCharacter=F;var T=e.paragraphFormat.leftIndent;P.paragraphFormat.leftIndent=0!==f||0!==m?T+18+f+m:d>2?T+2.5*(d-2)+18:T>0?T+18:36,P.paragraphFormat.firstLineIndent=-18,!l&&"0"===g.substring(0,1)||"00"===k?P.startAt=0:P.startAt=1,i.i(a.isNullOrUndefined)(x)?this.autoConvertList(e,P):e.paragraphFormat.setList(x),this.editorHistory&&!i.i(a.isNullOrUndefined)(this.editorHistory.currentHistoryInfo)?this.editorHistory.updateComplexHistory():this.reLayout(e)}return o},e.prototype.checkNextLevelAutoList=function(e){for(var t=this.documentHelper.selection,n=void 0,o=!1,s=t.start.paragraph,l=t.getPreviousParagraphBlock(s);!i.i(a.isNullOrUndefined)(l)&&l instanceof r.g;){if(l.paragraphFormat.listFormat&&-1!==l.paragraphFormat.listFormat.listId){var d=l.paragraphFormat.listFormat.listLevelNumber;if(o=this.isConvertList(e,l)){this.listLevelNumber=d,this.isAutoList=!0;break}}l=t.getPreviousParagraphBlock(l,!0)}return o&&(n=this.documentHelper.getListById(l.paragraphFormat.listFormat.listId)),n},e.prototype.isConvertList=function(e,t){var i,n=!1,r=this.documentHelper.layout.getListNumber(t.paragraphFormat.listFormat,!0),o=r.substring(0,r.length-1),s=e.substring(0,e.length-1);if(r.substring(r.length-1)!==e.substring(e.length-1))n=!1;else if(s.match(/^[0-9]+$/)&&o.match(/^[0-9]+$/))i=parseInt(s,10),parseInt(o,10)!==i&&parseInt(o,10)+1!==i&&parseInt(o,10)+2!==i||(n=!0);else if(s.match(/^[a-zA-Z]+$/)&&o.match(/^[a-zA-Z]+$/))if(o.charCodeAt(0)===e.charCodeAt(0)||o.charCodeAt(0)+1===e.charCodeAt(0)||o.charCodeAt(0)+2===e.charCodeAt(0))n=!0;else if(s.match(/^[MDCLXVImdclxvi]+$/)&&o.match(/^[MDCLXVImdclxvi]+$/)){var a=this.getNumber(o.toUpperCase()),l=this.getNumber(s.toUpperCase());a!==l&&a+1!==l&&a+2!==l||(n=!0)}return n},e.prototype.getNumber=function(e){for(var t={M:1e3,D:500,C:100,L:50,X:10,V:5,I:1},i=e.split(""),n=0,r=0;r<i.length;r++){var o=t[i[r]];o<t[i[r+1]]?n-=o:n+=o}return n},e.prototype.getListLevelPattern=function(e){switch(e){case"0":case"1":return"Arabic";case"I":return"UpRoman";case"i":return"LowRoman";case"A":return"UpLetter";case"a":return"LowLetter";case"*":case"-":return"Bullet";case"00":case"01":return"LeadingZero";default:return"None"}},e.prototype.autoConvertList=function(e,t){e.start;e.isForward||e.end;var i=new d.a;this.documentHelper.lists.length>0?i.listId=this.documentHelper.lists[this.documentHelper.lists.length-1].listId+1:i.listId=0;var n=new h.a,r=this.documentHelper;r.abstractLists.length>0?n.abstractListId=r.abstractLists[r.abstractLists.length-1].abstractListId+1:n.abstractListId=0,i.abstractListId=n.abstractListId,i.abstractList=n,i.nsid=n.nsid=s.a.generateUniqueId(r.lists),r.abstractLists.push(n),n.levels.push(t),t.ownerBase=n,e.paragraphFormat.setList(i),e.paragraphFormat.listLevelNumber=0},e.prototype.checkNumberFormat=function(e,t,i){if(t)return""===e;var n=i.indexOf(e);return("."===e||")"===e||">"===e||"-"===e)&&""===i.substring(n,i.length-1)},e.prototype.checkLeadingZero=function(e){for(var t,i=!1,n=0;n<=e.length-1;n++){if("0"!==e.charAt(n)){t=n;break}i=!0}var r=void 0;return r="1"===e.charAt(t)?e.charAt(t+1):e.charAt(t),i&&this.checkNumberFormat(r,!1,e)},e.prototype.getPageFromBlockWidget=function(e){var t=void 0;return e.containerWidget instanceof r.o?t=e.containerWidget.page:e.containerWidget instanceof r.x?t=e.containerWidget.page:e.containerWidget instanceof r.j&&(t=e.containerWidget.bodyWidget.page),t},e.prototype.insertTextInline=function(e,t,n,o,l){if(e instanceof r.d){if(e.text=s.a.insert(e.text,o,n),this.owner.enableTrackChanges){var d=e.revisions[0];i.i(a.isNullOrUndefined)(this.editorHistory)||i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)||this.editorHistory.currentBaseHistoryInfo.markerData.push(this.getMarkerData(void 0,void 0,d)),this.owner.trackChangesPane.updateCurrentTrackChanges(d)}var h=e.line.paragraph,c=h.childWidgets.indexOf(e.line),p=e.line.children.indexOf(e);e instanceof r.d&&e.text.length>90&&s.a.splitWordByMaxLength(e,e.line),!i.i(a.isNullOrUndefined)(l)&&l||this.documentHelper.layout.reLayoutParagraph(h,c,p,e.line.paragraph.bidi)}else e instanceof r.r?this.insertImageText(e,t,n,o):e instanceof r.b?0===e.fieldType?this.insertFieldBeginText(e,t,n,o):2===e.fieldType?this.insertFieldSeparatorText(e,t,n,o):this.insertFieldEndText(e,t,n,o):(e instanceof r.e||e instanceof r.G||e instanceof r.F)&&this.insertBookMarkText(e,n)},e.prototype.insertFieldBeginText=function(e,t,i,n){var o=new r.d;o.text=i;var s=e.line.paragraph.childWidgets.indexOf(e.line),a=e.line.children.indexOf(e);this.owner.enableCollaborativeEditing&&this.isRemoteAction&&a++,o.characterFormat.copyFormat(e.characterFormat),e.line.children.splice(a,0,o),o.line=e.line,this.documentHelper.layout.reLayoutParagraph(e.line.paragraph,s,a)},e.prototype.insertBookMarkText=function(e,t){var i=new r.d;i.text=t;var n=e.line.paragraph.childWidgets.indexOf(e.line),o=e.line.children.indexOf(e);i.characterFormat.copyFormat(e.characterFormat),e instanceof r.F||e instanceof r.e?e.line.children.splice(o,0,i):e.line.children.splice(o+1,0,i),i.line=e.line,this.documentHelper.layout.reLayoutParagraph(e.line.paragraph,n,o)},e.prototype.insertFieldSeparatorText=function(e,t,n,o){var s=t.getPreviousTextInline(e),l=t.getNextTextInline(e),d=new r.d;d.text=n;var h=e.line.children.indexOf(e);if(o===e.length&&h++,i.i(a.isNullOrUndefined)(s)&&i.i(a.isNullOrUndefined)(l))d.characterFormat.copyFormat(e.line.paragraph.characterFormat);else if(i.i(a.isNullOrUndefined)(s))d.characterFormat.copyFormat(l.characterFormat);else if(this.owner.enableCollaborativeEditing&&this.isRemoteAction){var c=this.getCharacterFormat(this.selection);d.characterFormat.copyFormat(c)}else d.characterFormat.copyFormat(s.characterFormat);e.line.children.splice(h,0,d),d.line=e.line;var p=e.line.paragraph.childWidgets.indexOf(e.line);this.documentHelper.layout.reLayoutParagraph(e.line.paragraph,p,h)},e.prototype.insertFieldEndText=function(e,t,i,n){var o=new r.d;o.text=i;var s=e.line.children.indexOf(e);o.characterFormat.copyFormat(e.characterFormat),t.isInlineFormFillMode()&&0==n?e.line.children.splice(s,0,o):e.line.children.splice(s+1,0,o),o.line=e.line;var a=e.line.paragraph.childWidgets.indexOf(e.line);if(this.owner.enableTrackChanges){var l=this.documentHelper.textHelper.getRtlLanguage(i).isRtl,d=this.checkToMapRevisionWithInlineText(e,n,o,l,"Insertion");d||0!==o.revisions.length||(d=this.checkToMapRevisionWithNextNode(e.nextNode,o,l,"Insertion"))}this.documentHelper.layout.reLayoutParagraph(e.line.paragraph,a,s)},e.prototype.insertImageText=function(e,t,n,o){var s=t.getPreviousTextInline(e),l=t.getNextTextInline(e),d=e.line,h=new r.d,c=d.paragraph,p=c.childWidgets.indexOf(d);h.text=n;var u=d.children.indexOf(e);o===e.length&&u++,i.i(a.isNullOrUndefined)(s)&&i.i(a.isNullOrUndefined)(l)?h.characterFormat.copyFormat(c.characterFormat):i.i(a.isNullOrUndefined)(s)?h.characterFormat.copyFormat(l.characterFormat):h.characterFormat.copyFormat(s.characterFormat),d.children.splice(u,0,h),h.line=d,this.documentHelper.layout.reLayoutParagraph(c,p,u)},e.prototype.isListTextSelected=function(){this.documentHelper.isListTextSelected&&(this.initComplexHistory("ListSelect"),this.documentHelper.selection.start.paragraph.paragraphFormat.listFormat&&-1!==this.documentHelper.selection.start.paragraph.paragraphFormat.listFormat.listId&&this.onApplyList(void 0))},e.prototype.checkAndConvertToHyperlink=function(e,t,i){var o,s;if(t)s=i.lastChild.children[i.lastChild.children.length-1],o=s.text;else{var a=0,l=e.start.currentWidget.getInline(e.start.offset-1,a),d=l.element;if(a=l.index,!(d instanceof r.d))return;s=d,o=s.text.substring(0,a)}var h=0,c=o.lastIndexOf("\t");for(h=c>=0?c+1:o.lastIndexOf(" ")+1;s.previousElement instanceof r.d&&0===h;){s=s.previousNode;var p=s.text;c=p.lastIndexOf("\t"),h=c>=0?c+1:p.lastIndexOf(" ")+1,o=s.text+o}o=o.substring(h);var u=o.toLowerCase(),g=!1;if("file:///"===u.substring(0,8)||"http://"===u.substring(0,7)&&u.length>7||"https://"===u.substring(0,8)&&u.length>8||"www."===u.substring(0,4)&&u.length>4||"\\"===u.substring(0,3)&&u.length>3||"mailto:"===u.substring(0,7)&&u.length>7)g=!0,"www."===u.substring(0,4)&&u.length>4&&(o="http://"+o);else{var f=o.indexOf("@"),m=o.indexOf(".");f>0&&f<m&&m<o.length-1&&(g=!0,o="mailto:"+o)}if(g){var v=new n.a(this.documentHelper.owner);v.setPositionParagraph(s.line,s.line.getOffset(s,h));var y=new n.a(this.documentHelper.owner);if(t)y.setPositionParagraph(s.line,s.line.getEndOffset());else if(0===e.end.currentWidget.children.length&&0===e.end.offset){var w=e.end.currentWidget.previousLine;y.setPositionParagraph(w,w.getEndOffset())}else y.setPositionParagraph(e.end.currentWidget,e.end.offset-1);this.autoFormatHyperlink(e,o,v,y)}},e.prototype.autoFormatHyperlink=function(e,t,i,n){if(!this.owner.enableCollaborativeEditing||!this.isRemoteAction){this.initComplexHistory("AutoFormatHyperlink");var r=this.selection.getParagraphInfo(i),s=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString());this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.insertPosition=s),e.start.setPositionInternal(i),e.end.setPositionInternal(n);var a=this.getCharacterFormat(e),l=new o.a;l.copyFormat(a);var d=this.createHyperlinkElement(t,i,n,l);e.start.setPositionParagraph(d.line,d.line.getOffset(d,1)),e.start.moveNextPosition(),e.end.setPositionInternal(e.start),r=this.selection.getParagraphInfo(e.end);var h=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString());this.editorHistory&&this.editorHistory.currentHistoryInfo?(this.editorHistory.currentHistoryInfo.endPosition=h,this.isSkipOperationsBuild=!0,this.editorHistory.updateComplexHistory(),this.isSkipOperationsBuild=!1,this.reLayout(e)):this.updateComplexWithoutHistory(0,s,h)}},e.prototype.appylingHyperlinkFormat=function(e){this.initHistory("Underline"),this.updateCharacterFormatWithUpdate(e,"underline","Single",!1),this.editorHistory&&this.editorHistory.updateHistory(),this.reLayout(e,!1),this.initHistory("FontColor"),this.isForHyperlinkFormat=!0,this.updateCharacterFormatWithUpdate(e,"fontColor","#0563c1",!1),this.isForHyperlinkFormat=!1,this.editorHistory&&this.editorHistory.updateHistory(),this.reLayout(e,!1)},e.prototype.createHyperlinkElement=function(e,t,i,n){var o=this.selection;this.documentHelper.layout.allowLayout=!1,this.documentHelper.layout.isReplaceAll=!0,this.appylingHyperlinkFormat(o);var s=new r.b(1);s.characterFormat.copyFormat(n),s.line=o.end.currentWidget,o.start.setPositionInternal(o.end),this.initInsertInline(s),o.start.setPositionInternal(t),o.end.setPositionInternal(o.start);var a=this.insertHyperlinkfield(o,n,e),l=o.start.paragraph.childWidgets.indexOf(a.line),d=a.line.children.indexOf(a);return s.linkFieldCharacter(this.documentHelper),this.documentHelper.layout.isReplaceAll=!1,this.documentHelper.layout.allowLayout=!0,this.documentHelper.layout.reLayoutParagraph(o.start.paragraph,l,d),s},e.prototype.insertHyperlinkfield=function(e,t,i,n){var o=new r.b(0);o.characterFormat.copyFormat(t),o.line=e.start.currentWidget,this.initInsertInline(o);var s=new r.d;s.characterFormat.copyFormat(t),s.text=n?' HYPERLINK \\l "'+i+'" ':' HYPERLINK "'+i+'" ',s.line=e.start.currentWidget,this.initInsertInline(s);var a=new r.b(2);return a.characterFormat.copyFormat(t),a.line=e.start.currentWidget,this.initInsertInline(a),o},e.prototype.unlinkRangeFromRevision=function(e,t){for(var i=0;i<e.revisions.length;i++){var n=e.revisions[i],r=n.range.indexOf(e);r>=0&&(n.range.splice(r,1),this.owner.trackChangesPane.updateCurrentTrackChanges(n)),0===n.range.length&&t&&(this.owner.revisions.remove(n),this.isRemoveRevision&&this.documentHelper.revisionsInternal.containsKey(n.revisionID)&&(this.documentHelper.revisionsInternal.remove(n.revisionID),this.owner.trackChangesPane.updateTrackChanges()))}},e.prototype.unlinkWholeRangeInRevision=function(e,t){var i=t;e.revisions.splice(e.revisions.indexOf(e),1);for(var n=i.range.length,r=0;r<n;r++)i.range.splice(0,1),this.owner.trackChangesPane.updateCurrentTrackChanges(i);0===i.range.length&&(this.owner.revisions.remove(i),this.isRemoveRevision&&this.documentHelper.revisionsInternal.containsKey(i.revisionID)&&(this.documentHelper.revisionsInternal.remove(i.revisionID),this.owner.trackChangesPane.updateTrackChanges()))},e.prototype.unLinkFieldCharacter=function(e){if(e instanceof r.b&&0===e.fieldType&&e.fieldEnd&&(this.documentHelper&&(this.documentHelper.fieldToLayout=e,this.documentHelper.fieldEndParagraph=e.line.paragraph),e.fieldEnd&&(e.fieldEnd.fieldBegin=void 0),e.fieldEnd=void 0),e instanceof r.b&&2===e.fieldType)i.i(a.isNullOrUndefined)(e.fieldEnd)||(this.documentHelper&&(this.documentHelper.fieldToLayout=e.fieldBegin,this.documentHelper.fieldEndParagraph=e.line.paragraph),e.fieldBegin.fieldSeparator=void 0,e.fieldEnd.fieldSeparator=void 0);else if(e instanceof r.b&&1===e.fieldType&&e.fieldBegin){i.i(a.isNullOrUndefined)(this.documentHelper)||(this.documentHelper.fieldToLayout=e.fieldBegin,this.documentHelper.fieldEndParagraph=e.line.paragraph);var t=this.documentHelper.fields.indexOf(e.fieldBegin);-1!==t&&this.documentHelper.fields.splice(t,1);var n=this.documentHelper.formFields.indexOf(e.fieldBegin);-1!==n&&this.documentHelper.formFields.splice(n,1),e.fieldBegin.fieldEnd=void 0,e.fieldBegin=void 0}},e.prototype.getCharacterFormat=function(e){return e.start.paragraph.isEmpty()?e.start.paragraph.characterFormat:e.start.currentWidget.getInline(e.start.offset,0).element.characterFormat},e.prototype.insertHyperlink=function(e,t,n){(s.a.startsWith(e,"http://")||s.a.startsWith(e,"https://"))&&(e=e.replace(/\s/g,"")),i.i(a.isNullOrUndefined)(t)&&(t=e),i.i(a.isNullOrUndefined)(n)||(e=e+'" \\o "'+n),this.insertHyperlinkInternal(e,t,this.owner.selection.text!==t,!1)},e.prototype.insertHyperlinkInternal=function(e,t,i,s){var a=this.documentHelper.selection;if(a.start.paragraph.associatedCell===a.end.paragraph.associatedCell){var l=a.start,d=a.end;if(a.isForward||(l=a.end,d=a.start),d.offset==d.paragraph.getLength()+1&&d.movePreviousPosition(),i)this.insertHyperlinkInternalInternal(a,e,t,s);else{this.documentHelper.layout.allowLayout=!1;var h=new n.a(this.documentHelper.owner);h.setPositionInternal(l);var c=this.getCharacterFormat(a),p=new o.a(void 0);p.copyFormat(c),this.initComplexHistory("InsertHyperlink");var u=this.selection.getParagraphInfo(l),g=this.selection.getHierarchicalIndex(u.paragraph,u.offset.toString());this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.insertPosition=this.selection.getHierarchicalIndex(u.paragraph,u.offset.toString())),this.appylingHyperlinkFormat(a),l.setPositionInternal(d);var f=new r.b(1);f.characterFormat.copyFormat(p),f.line=a.end.currentWidget,l.setPositionInternal(d),this.initInsertInline(f),l.setPositionInternal(h),d.setPositionInternal(l);var m=this.insertHyperlinkfield(a,p,e,s);f.linkFieldCharacter(this.documentHelper);var v=a.start.paragraph.childWidgets.indexOf(m.line),y=m.line.children.indexOf(m);this.documentHelper.layout.allowLayout=!0,this.documentHelper.layout.reLayoutParagraph(a.start.paragraph,v,y);var w=f.line;a.selects(w,w.getOffset(f,f.length),!0),u=this.selection.getParagraphInfo(d);var b=this.selection.getHierarchicalIndex(u.paragraph,u.offset.toString());this.editorHistory&&this.editorHistory.currentHistoryInfo?(this.editorHistory.currentHistoryInfo.endPosition=this.selection.getHierarchicalIndex(u.paragraph,u.offset.toString()),this.editorHistory.updateComplexHistory()):this.updateComplexWithoutHistory(1,g,b)}}},e.prototype.insertHyperlinkInternalInternal=function(e,t,n,r){if(!i.i(a.isNullOrUndefined)(e.start)&&!this.editHyperlink(e,t,n)){var s=this.checkAndRemoveComments(),l=this.getCharacterFormat(e);this.initHistory("InsertHyperlink");var d=!0;if(!e.isEmpty){var h=this.owner.enableTrackChanges;this.owner.enableTrackChanges=!1,d=this.removeSelectedContents(e),this.owner.enableTrackChanges=h}if(d){var c=new o.a;c.copyFormat(l),this.insertHyperlinkByFormat(e,t,n,c,r)}this.updateHistoryForComments(s)}},e.prototype.insertHyperlinkByFormat=function(e,t,n,o,s){this.updateInsertPosition(),e.owner.isShiftingEnabled=!0;var l=[],d=new r.b(0);!i.i(a.isNullOrUndefined)(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.fieldBegin=d),l.push(d);var h=new r.d;h.text=s?' HYPERLINK \\l "'+t+'" ':' HYPERLINK "'+t+'" ',l.push(h);var c=new r.b(2);l.push(c),i.i(a.isNullOrUndefined)(n)||""===n||(h=new r.d,h.characterFormat.copyFormat(o),h.characterFormat.underline="Single",h.characterFormat.fontColor="#0563c1",h.text=n,l.push(h));var p=new r.b(1);l.push(p),this.insertElement(l),p.linkFieldCharacter(this.documentHelper),-1===this.documentHelper.fields.indexOf(d)&&this.documentHelper.fields.push(d),e.selects(p.line,p.line.getOffset(p,p.length),!0),this.updateEndPosition(),this.reLayout(e,!0)},e.prototype.initInsertInline=function(e,t,i){var n=this.selection;this.initHistory("InsertInline"),this.insertInlineInSelection(n,e),this.editorHistory&&this.editorHistory.updateHistory()},e.prototype.insertElementInCurrentLine=function(e,t){this.checkIsNotRedoing()&&(e.owner.isShiftingEnabled=!0),e.isEmpty||this.removeSelectedContents(e),this.updateInsertPosition(),this.insertElement([t]),this.checkEndPosition(e)&&this.updateHistoryPosition(e.start,!1),this.fireContentChange()},e.prototype.editHyperlink=function(e,t,n,s){var l=e.getHyperlinkField();if(i.i(a.isNullOrUndefined)(l))return!1;this.initHistory("InsertHyperlink"),this.editHyperlinkInternal=i.i(a.isNullOrUndefined)(this.editorHistory)||this.editorHistory&&i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo);var d="",h=!1,c=this.getCharacterFormat(e),p=new o.a;p.copyFormat(c);var u=void 0;if(!i.i(a.isNullOrUndefined)(l.fieldSeparator)){u=l.fieldSeparator;var g=e.getHyperlinkDisplayText(l.fieldSeparator.line.paragraph,l.fieldSeparator,l.fieldEnd,h,p);d=g.displayText,h=g.isNestedField,p=g.format}var f=l.line.getOffset(l,0);if(e.start.setPositionParagraph(l.line,f),f=l.fieldEnd.line.getOffset(l.fieldEnd,1),e.end.setPositionParagraph(l.fieldEnd.line,f),this.skipFieldDeleteTracking=!0,this.deleteSelectedContents(e,!1),!h&&d!==n||i.i(a.isNullOrUndefined)(u))this.insertHyperlinkByFormat(e,t,n,p,s),this.skipFieldDeleteTracking=!1;else{this.updateInsertPosition();var m=new r.b(0);this.editorHistory&&!i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&(this.editorHistory.currentBaseHistoryInfo.fieldBegin=m,this.editorHistory.currentBaseHistoryInfo.isEditHyperlink=!0),m.characterFormat.copyFormat(l.characterFormat),m.line=e.start.currentWidget,this.insertInlineInternal(m);var v=new r.d;v.characterFormat.copyFormat(l.characterFormat),v.text=s?' HYPERLINK \\l "'+t+'" ':' HYPERLINK "'+t+'" ',v.line=e.start.currentWidget,this.insertInlineInternal(v);var y=this.editorHistory&&this.editorHistory.currentBaseHistoryInfo?this.editorHistory.currentBaseHistoryInfo.removedNodes:this.nodes;this.insertClonedFieldResult(e,y,u);e.end.currentWidget.getInline(e.end.offset,0).element.linkFieldCharacter(this.documentHelper),this.skipFieldDeleteTracking=!1;var w=m.line.paragraph,b=m.line.paragraph.childWidgets.indexOf(m.line),x=m.line.children.indexOf(m);this.documentHelper.layout.reLayoutParagraph(w,b,x),f=m.fieldEnd.line.getOffset(m.fieldEnd,1),e.selects(m.fieldEnd.line,f,!0),this.updateEndPosition(),this.reLayout(e,!0)}return this.editHyperlinkInternal=!1,this.nodes=[],!0},e.prototype.insertClonedFieldResult=function(e,t,i){for(var n=!1,o=t.length-1;o>-1;o--){var s=t[o];if(!n){if(i!==s){if(s instanceof r.g&&s===i.line.paragraph){n=!0;var a=void 0;if(o===t.length-1){a=e.start.paragraph;var l=i.line.paragraph;this.getClonedFieldResultWithSel(l,e,i)}else a=this.getClonedFieldResult(i.line.paragraph,i),this.insertParagraph(a,!0);e.selectParagraphInternal(e.getNextParagraphBlock(a),!0)}continue}n=!0}s instanceof r.c?this.insertInlineInternal(s.clone()):s instanceof r.C&&this.insertBlock(s.clone())}},e.prototype.getClonedFieldResultWithSel=function(e,t,i){for(var n=e.childWidgets.indexOf(i.line),r=e.childWidgets[n].children.indexOf(i),o=n;o<e.childWidgets.length;o++){var s=e.childWidgets[o];o!==n&&(r=0);for(var a=r;a<s.children.length;a++)this.insertInlineInternal(s.children[a].clone())}},e.prototype.getClonedFieldResult=function(e,t){var i=new r.g;i.characterFormat.copyFormat(e.characterFormat),i.paragraphFormat.copyFormat(e.paragraphFormat);for(var n=e.childWidgets.indexOf(t.line),o=e.childWidgets[n].children.indexOf(t),s=n;s<e.childWidgets.length;s++){var a=e.childWidgets[s];s!==n&&(o=0);for(var l=o;l<a.children.length;l++)i.childWidgets[0].children.push(a.children[l])}return i},e.prototype.removeHyperlink=function(){if(!this.owner.isReadOnlyMode){var e=this.selection,t=e.getHyperlinkField();if(!i.i(a.isNullOrUndefined)(t)){var r=t.fieldEnd,o=t.fieldSeparator,s=new n.a(e.owner);s.setPositionParagraph(t.line,t.line.getOffset(t,0));var l=this.selection.getParagraphInfo(s),d=this.selection.getHierarchicalIndex(l.paragraph,l.offset.toString()),h=new n.a(e.owner);h.setPositionParagraph(o.line,o.line.getOffset(o,o.length)),l=this.selection.getParagraphInfo(h);var c=this.selection.getHierarchicalIndex(l.paragraph,l.offset.toString());this.initComplexHistory("RemoveHyperlink"),e.start.setPositionParagraph(r.line,r.line.getOffset(r,0)),l=this.selection.getParagraphInfo(e.start);var p=this.selection.getHierarchicalIndex(l.paragraph,l.offset.toString());e.end.setPositionInternal(e.start),this.delete(),e.start.setPositionInternal(this.selection.getTextPosBasedOnLogicalIndex(c)),this.initHistory("Underline"),this.updateCharacterFormatWithUpdate(e,"underline","None",!1),this.editorHistory&&this.editorHistory.updateHistory(),e.end.setPositionInternal(this.selection.getTextPosBasedOnLogicalIndex(p)),this.initHistory("FontColor"),this.updateCharacterFormatWithUpdate(e,"fontColor",void 0,!1),this.editorHistory&&this.editorHistory.updateHistory(),this.reLayout(e,!1),e.end.setPositionInternal(e.start),e.start.setPositionInternal(this.selection.getTextPosBasedOnLogicalIndex(d)),this.initHistory("Delete"),this.deleteSelectedContents(e,!1),this.reLayout(e,!0),this.editorHistory&&!i.i(a.isNullOrUndefined)(this.editorHistory.currentHistoryInfo)&&this.editorHistory.updateComplexHistory()}}},e.prototype.pasteInternal=function(e,t){if(this.currentPasteOptions=this.owner.defaultPasteOption,this.isHtmlPaste=!1,this.documentHelper.owner.enableLocalPaste)this.paste();else{this.selection.isViewPasteOptions=!0,this.selection.pasteElement&&(this.selection.pasteElement.style.display="none"),i.i(a.isNullOrUndefined)(t)&&(t=window);var n="",r="",d="",h=t.clipboardData?t.clipboardData:e.clipboardData;if("msie"!==a.Browser.info.name&&(d=h.getData("Text/Rtf"),r=h.getData("Text/Html")),this.copiedTextContent=n=s.a.sanitizeString(h.getData("Text")),this.previousCharFormat=new o.a,this.previousCharFormat.copyFormat(this.selection.start.paragraph.characterFormat),this.previousParaFormat=new l.F,this.previousParaFormat.copyFormat(this.selection.start.paragraph.paragraphFormat),"FormFieldsOnly"===this.documentHelper.protectionType&&this.documentHelper.selection.isInlineFormFillMode()&&(r="",d=""),""!==d)this.pasteAjax(d,".rtf");else if(""!==r){this.isHtmlPaste=!0;var c=(new DOMParser).parseFromString(r,"text/html"),p=(new XMLSerializer).serializeToString(c);p=p.replace(/<!--StartFragment-->/gi,""),p=p.replace(/<!--EndFragment-->/gi,""),p=p.replace('xmlns="http://www.w3.org/1999/xhtml"',"");if(-1!==p.indexOf("<span>iscreatedusinghtmlspantag</span>")){var u=new DOMParser,g=u.parseFromString(p,"text/html"),f=g.querySelectorAll(".iscreatedusinghtmlspantag"),m=g.querySelector("body > p:last-child");f.length>0&&m&&m===f[f.length-1]&&(f[f.length-1].remove(),p=g.documentElement.outerHTML)}this.pasteAjax(p,".html")}else if(null!==n&&""!==n)this.selection.currentPasteAction="TextOnly",this.pasteContents(n),this.applyPasteOptions(this.currentPasteOptions,!0),this.copiedContent=void 0,this.documentHelper.editableDiv.innerHTML="";else if("msie"!==a.Browser.info.name&&void 0!==h.items&&0!==h.items.length)for(var v=0;v<h.items.length;v++){var y=h.items[v];("image/png"===y.type||"image/svg+xml"===y.type&&"string"!==y.kind)&&this.pasteImage(y.getAsFile())}else"msie"===a.Browser.info.name&&void 0!==h.files&&0!==h.files.length&&"image/png"===h.files[0].type&&this.pasteImage(h.files[0])}},e.prototype.pasteImage=function(e){var t=this,i=new FileReader;i.onload=function(){t.onPasteImage(i.result)},i.readAsDataURL(e)},e.prototype.onPasteImage=function(e){var t=document.createElement("img"),i=this;t.addEventListener("load",function(){i.insertImageInternal(e,!0,this.width,this.height,this.alt)}),t.src=e},e.prototype.pasteAjax=function(e,t){var n=this,r={content:e,type:t};this.pasteRequestHandler=new x.a,this.owner.documentHelper.viewerContainer.focus(),i.i(w.showSpinner)(this.owner.element),this.pasteRequestHandler.url=n.owner.serviceUrl+this.owner.serverActionSettings.systemClipboard,this.pasteRequestHandler.responseType="json",this.pasteRequestHandler.contentType="application/json;charset=UTF-8",this.pasteRequestHandler.customHeaders=n.owner.headers,this.pasteRequestHandler.onSuccess=this.pasteFormattedContent.bind(this),this.pasteRequestHandler.onFailure=this.onPasteFailure.bind(this),this.pasteRequestHandler.onError=this.onPasteFailure.bind(this);var o={serverActionType:"SystemClipboard",headers:this.owner.headers,timeout:0,cancel:!1,withCredentials:!1,clipboardData:r};this.owner.trigger(u.q,o),o.cancel?i.i(w.hideSpinner)(this.owner.element):this.pasteRequestHandler.send(r,o)},e.prototype.pasteFormattedContent=function(e){var t=this;this.isPasteListUpdated&&(this.isPasteListUpdated=!1),this.pasteContents(i.i(a.isNullOrUndefined)(e.data)?this.copiedTextContent:s.a.getSfdtDocument(e.data)),"KeepSourceFormatting"!==this.currentPasteOptions&&this.applyPasteOptions(this.currentPasteOptions),i.i(w.hideSpinner)(this.owner.element),setTimeout(function(){i.i(a.isNullOrUndefined)(t.viewer)||(t.documentHelper.isScrollHandler=!0,t.isPasteContentCheck=!0,t.viewer.updateScrollBars(),t.documentHelper.isScrollHandler=!1,t.isPasteContentCheck=!1)},0)},e.prototype.onPasteFailure=function(e){this.owner.fireServiceFailure(e),console.error(e.status,e.statusText),i.i(w.hideSpinner)(this.owner.element),this.documentHelper.updateFocus()},e.prototype.paste=function(e,t){var n=this;if(i.i(a.isNullOrUndefined)(e)&&(e=this.owner.enableLocalPaste?s.a.sanitizeString(this.copiedData):void 0),i.i(a.isNullOrUndefined)(t)||(this.currentPasteOptions=t),e){var r=s.a.getSfdtDocument(e);this.pasteContents(r),this.applyPasteOptions(this.currentPasteOptions),this.chartType&&(setTimeout(function(){i.i(a.isNullOrUndefined)(n.viewer)||n.viewer.updateScrollBars()},30),this.chartType=!1)}},e.prototype.getUniqueListOrAbstractListId=function(e){if(e&&this.documentHelper.lists.length){var t=this.documentHelper.lists.slice().sort(function(e,t){return e.listId-t.listId});return t[t.length-1].listId+1}if(this.documentHelper.abstractLists.length){var i=this.documentHelper.abstractLists.slice().sort(function(e,t){return e.abstractListId-t.abstractListId});return i[i.length-1].abstractListId+1}return 0},e.prototype.checkSameLevelFormat=function(e,t,i){return t[C._331[this.keywordIndex]][e][C._323[this.keywordIndex]]===i.abstractList.levels[e].listLevelPattern&&t[C._331[this.keywordIndex]][e][C._328[this.keywordIndex]]===i.abstractList.levels[e].numberFormat&&(t[C._331[this.keywordIndex]][e][C._323[this.keywordIndex]]===(1==this.keywordIndex?10:"Bullet")||t[C._331[this.keywordIndex]][e][C._325[this.keywordIndex]]===i.abstractList.levels[e].startAt)},e.prototype.listLevelPatternInCollection=function(e,t){var i=this;return this.documentHelper.lists.filter(function(n){return n.abstractList.levels[e].listLevelPattern===t[C._323[i.keywordIndex]]&&n.abstractList.levels[e].numberFormat===t[C._328[i.keywordIndex]]&&(t[C._323[i.keywordIndex]]===(1==i.keywordIndex?10:"Bullet")||n.abstractList.levels[e].startAt===t[C._325[i.keywordIndex]])&&i.isEqualParagraphFormat(n.abstractList.levels[e].paragraphFormat,t[C._5[i.keywordIndex]])})[0]},e.prototype.isEqualParagraphFormat=function(e,t){return!(i.i(a.isNullOrUndefined)(t[C._69[this.keywordIndex]])&&0!==e.leftIndent||!i.i(a.isNullOrUndefined)(t[C._69[this.keywordIndex]])&&Math.round(e.leftIndent)!==Math.round(t[C._69[this.keywordIndex]]))&&(!(i.i(a.isNullOrUndefined)(t[C._70[this.keywordIndex]])&&0!==e.rightIndent||!i.i(a.isNullOrUndefined)(t[C._70[this.keywordIndex]])&&Math.round(e.rightIndent)!==Math.round(t[C._70[this.keywordIndex]]))&&(!(i.i(a.isNullOrUndefined)(t[C._71[this.keywordIndex]])&&0!==e.firstLineIndent||!i.i(a.isNullOrUndefined)(t[C._71[this.keywordIndex]])&&Math.round(e.firstLineIndent)!==Math.round(t[C._71[this.keywordIndex]]))&&(!(i.i(a.isNullOrUndefined)(t[C._74[this.keywordIndex]])&&0!==e.beforeSpacing||!i.i(a.isNullOrUndefined)(t[C._74[this.keywordIndex]])&&Math.round(e.beforeSpacing)!==Math.round(t[C._74[this.keywordIndex]]))&&(!(i.i(a.isNullOrUndefined)(t[C._73[this.keywordIndex]])&&0!==e.afterSpacing||!i.i(a.isNullOrUndefined)(t.afterSpacing)&&Math.round(e.afterSpacing)!==Math.round(t[C._73[this.keywordIndex]]))&&(!(i.i(a.isNullOrUndefined)(t[C._72[this.keywordIndex]])&&"Left"!==e.textAlignment||!i.i(a.isNullOrUndefined)(t[C._72[this.keywordIndex]])&&e.textAlignment!==t[C._72[this.keywordIndex]])&&(!(i.i(a.isNullOrUndefined)(t[C._52[this.keywordIndex]])&&!1!==e.bidi||!i.i(a.isNullOrUndefined)(t[C._52[this.keywordIndex]])&&e.bidi!==t[C._52[this.keywordIndex]])&&(!(i.i(a.isNullOrUndefined)(t[C._84[this.keywordIndex]])&&!1!==e.contextualSpacing||!i.i(a.isNullOrUndefined)(t.contextualSpacing)&&e.contextualSpacing!==t[C._84[this.keywordIndex]])&&(!(i.i(a.isNullOrUndefined)(t[C._80[this.keywordIndex]])&&!1!==e.keepWithNext||!i.i(a.isNullOrUndefined)(t[C._80[this.keywordIndex]])&&e.keepWithNext!==t[C._80[this.keywordIndex]])&&(!(i.i(a.isNullOrUndefined)(t[C._82[this.keywordIndex]])&&!1!==e.keepLinesTogether||!i.i(a.isNullOrUndefined)(t[C._82[this.keywordIndex]])&&e.keepLinesTogether!==t[C._82[this.keywordIndex]])&&(!(i.i(a.isNullOrUndefined)(t[C._81[this.keywordIndex]])&&!1!==e.widowControl||!i.i(a.isNullOrUndefined)(t[C._81[this.keywordIndex]])&&e.widowControl!==t[C._81[this.keywordIndex]])&&(!(i.i(a.isNullOrUndefined)(t[C._83[this.keywordIndex]])&&"BodyText"!==e.outlineLevel||!i.i(a.isNullOrUndefined)(t[C._83[this.keywordIndex]])&&e.outlineLevel!==t[C._83[this.keywordIndex]])&&(!(i.i(a.isNullOrUndefined)(t[C._77[this.keywordIndex]])&&1!==e.lineSpacing||!i.i(a.isNullOrUndefined)(t[C._77[this.keywordIndex]])&&Math.round(e.lineSpacing)!==Math.round(t[C._77[this.keywordIndex]]))&&!(i.i(a.isNullOrUndefined)(t[C._78[this.keywordIndex]])&&"Multiple"!==e.lineSpacingType||!i.i(a.isNullOrUndefined)(t[C._78[this.keywordIndex]])&&e.lineSpacingType!==t[C._78[this.keywordIndex]])))))))))))))},e.prototype.getBlocksToUpdate=function(e){for(var t=[],i=0;i<e.length;i++){var n=e[i];if(n[C._5[this.keywordIndex]]&&n[C._5[this.keywordIndex]][C._79[this.keywordIndex]]&&Object.keys(n[C._5[this.keywordIndex]][C._79[this.keywordIndex]]).length>0)t.push(n);else if(n[C._298[this.keywordIndex]])for(var r=0;r<n[C._298[this.keywordIndex]].length;r++)for(var o=n[C._298[this.keywordIndex]][r],s=0;s<o[C._297[this.keywordIndex]].length;s++){var a=o[C._297[this.keywordIndex]][s];t=t.concat(this.getBlocksToUpdate(a[C._314[this.keywordIndex]]))}}return t},e.prototype.updateListIdForBlocks=function(e,t,n,r,o){for(var s=!1,l=0;l<e.length;l++){var d=e[l];if(d[C._5[this.keywordIndex]]&&d[C._5[this.keywordIndex]][C._79[this.keywordIndex]]&&Object.keys(d[C._5[this.keywordIndex]][C._79[this.keywordIndex]]).length>0){var h=d[C._5[this.keywordIndex]][C._79[this.keywordIndex]],c=this.listLevelPatternInCollection(h[C._68[this.keywordIndex]],t[C._331[this.keywordIndex]][h[C._68[this.keywordIndex]]]);h[C._65[this.keywordIndex]]===r&&(i.i(a.isNullOrUndefined)(c)&&(!n||n&&!this.checkSameLevelFormat(h[C._68[this.keywordIndex]],t,n))?(s=!0,h[C._65[this.keywordIndex]]=o):!i.i(a.isNullOrUndefined)(c)&&this.checkSameLevelFormat(h[C._68[this.keywordIndex]],t,c)&&(h.isUpdated||(h[C._65[this.keywordIndex]]=c[C._65[this.keywordIndex]],h.isUpdated=!0),s=!1))}else if(d[C._298[this.keywordIndex]])for(var p=0;p<d[C._298[this.keywordIndex]].length;p++)for(var u=d[C._298[this.keywordIndex]][p],g=0;g<u[C._297[this.keywordIndex]].length;g++){var f=u[C._297[this.keywordIndex]][g],m=this.updateListIdForBlocks(f[C._314[this.keywordIndex]],t,n,r,o);s||(s=m)}}return s},e.prototype.updatePasteContent=function(e,t){var n=this,r=this.getUniqueListOrAbstractListId(!0);if(e[C._6[this.keywordIndex]].filter(function(e){return e[C._65[n.keywordIndex]]===r}).length>0){var o=e[C._6[this.keywordIndex]].slice().sort(function(e,t){return e[C._65[n.keywordIndex]]-t[C._65[n.keywordIndex]]});r=o[o.length-1][C._65[this.keywordIndex]]+1}var s=this.getUniqueListOrAbstractListId(!1);if(e[C._7[this.keywordIndex]].filter(function(e){return e[u.t[n.keywordIndex]]===s}).length>0){var l=e[C._7[this.keywordIndex]].slice().sort(function(e,t){return e[u.t[n.keywordIndex]]-t[u.t[n.keywordIndex]]});s=l[l.length-1][u.t[this.keywordIndex]]+1}for(var d,h=this,c=0;c<e[C._6[this.keywordIndex]].length;c++)!function(o){var l=e[C._6[h.keywordIndex]][o],c=e[C._7[h.keywordIndex]].filter(function(e){return e[u.t[n.keywordIndex]]===l[u.t[n.keywordIndex]]})[0],p=h.documentHelper.lists.filter(function(e){return e.listId===l[C._65[n.keywordIndex]]});if(!i.i(a.isNullOrUndefined)(c)){if(h.updateListIdForBlocks(e[C._2[h.keywordIndex]][t][C._314[h.keywordIndex]],c,p[0],l[C._65[h.keywordIndex]],r)){for(var g=c[u.t[h.keywordIndex]],f=0;f<e[C._6[h.keywordIndex]].length;f++){var m=e[C._6[h.keywordIndex]][f];m[u.t[h.keywordIndex]]===g&&(m[u.t[h.keywordIndex]]=s)}c[u.t[h.keywordIndex]]=s,l[C._65[h.keywordIndex]]=r,r++,s++}else e[C._6[h.keywordIndex]].splice(o,1),e[C._7[h.keywordIndex]].splice(e[C._7[h.keywordIndex]].indexOf(c),1),o--}d=o}(c),c=d;for(var p=this.getBlocksToUpdate(e[C._2[this.keywordIndex]][t][C._314[this.keywordIndex]]),g=0;g<p.length;g++){delete p[g][C._5[this.keywordIndex]][C._79[this.keywordIndex]].isUpdated}},e.prototype.getBlocks=function(e,t,n,o,s){var d=[];if("string"==typeof e){var h=this.selection.start.paragraph;this.selection.isForward||(h=this.selection.end.paragraph);var c=[],p=e;p=p.replace(/\r?\n/g,"\r"),c=p.split("\r");var u=[],g=new r.o;g.sectionFormat=new l.G(g),g.childWidgets=u;for(var f=0;f<c.length;f++)if(f!==c.length-1||0!==c[f].length||this.isInsertText){var m=this.selection.start.currentWidget.getInline(this.selection.start.offset,0),y=this.selection.getPreviousValidElement(m.element);y!==m.element&&(y=this.selection.getNextValidElement(m.element));var w=void 0;h.isEmpty()?w=h.characterFormat:i.i(a.isNullOrUndefined)(y)||this.isInsertText?this.copyInsertFormat(h.characterFormat,!1):w=y.characterFormat;var b=this.documentHelper.selection.copySelectionParagraphFormat();i.i(a.isNullOrUndefined)(this.previousParaFormat)||(b=this.previousParaFormat);var x=new r.g;x.paragraphFormat.copyFormat(b);var I=new r.p(x);if(c[f].length>0)for(var F=c[f].split(/(\s+)/),k=0;k<F.length;k++){var P=new r.d;P.characterFormat.copyFormat(w),P.text=F[k],I.children.push(P),P.line=I}x.childWidgets.push(I),x.containerWidget=g,u.push(x)}d.push(g)}else{var T=this.documentHelper.owner.parser;T.keywordIndex=this.keywordIndex,T.isPaste=t,T.isHtmlPaste=this.isHtmlPaste,T.addCustomStyles(e),e[C._10[this.keywordIndex]]&&e[C._10[this.keywordIndex]].length>0&&(T.commentsCollection=new v.a,T.commentStarts=new v.a,T.commentEnds=new v.a,T.parseComments(e,o||this.documentHelper.comments));var g=void 0;this.selection.currentPasteAction="DefaultPaste";for(var f=0;f<e[C._2[this.keywordIndex]].length;f++){if(this.isPasteListUpdated||i.i(a.isNullOrUndefined)(e[C._6[this.keywordIndex]])||(this.documentHelper.lists.length>0&&this.updatePasteContent(e,f),this.isPasteListUpdated=!0,i.i(a.isNullOrUndefined)(e[C._7[this.keywordIndex]])||T.parseAbstractList(e,this.documentHelper.abstractLists),i.i(a.isNullOrUndefined)(e[C._6[this.keywordIndex]])||T.parseList(e,this.documentHelper.lists)),!i.i(a.isNullOrUndefined)(e[C._11[this.keywordIndex]]))if(t){var S=this.viewer.owner.revisionsInternal.changes;i.i(a.isNullOrUndefined)(T.revisionCollection)||(T.revisionCollection=void 0),T.revisionCollection=new v.a;var W=T.revisionCollection;if((!this.documentHelper.owner.sfdtExportModule.copyWithTrackChange||!T.isCutPerformed)&&e[C._11[this.keywordIndex]].length>=1)for(var N=0;N<e[C._11[this.keywordIndex]].length;N++){var H=!0;if(W.containsKey(e[C._11[this.keywordIndex]][N][C._260[this.keywordIndex]])){if(S.length>0)for(var E=0;E<S.length;E++)S[E].revisionID===e[C._11[this.keywordIndex]][N][C._260[this.keywordIndex]]&&(H=!1);if(H){var O=W.get(e[C._11[this.keywordIndex]][N][C._260[this.keywordIndex]]);S.push(O)}}else T.parseRevisions(e,S)}this.documentHelper.owner.sfdtExportModule.copyWithTrackChange=!1}else T.revisionCollection=this.documentHelper.revisionsInternal,T.parseRevisions(e,s);if(g=new r.o,g.sectionFormat=new l.G(g),t?d.push(g):n.unshift(g),t&&!i.i(a.isNullOrUndefined)(e[C._9[this.keywordIndex]]))for(var k=0;k<e[C._9[this.keywordIndex]].length;k++){var _=e[C._9[this.keywordIndex]][k][C._35[this.keywordIndex]],B=this.documentHelper.styles.findByName(_);i.i(a.isNullOrUndefined)(B)&&T.parseStyle(e,e[C._9[this.keywordIndex]][k],this.documentHelper.styles)}T.parseBody(e[C._2[this.keywordIndex]][f][C._314[this.keywordIndex]],g.childWidgets,void 0,void 0,void 0,e[C._9[this.keywordIndex]]),e[C._29[this.keywordIndex]]&&this.selection.start.paragraph.isEmpty()&&1==this.documentHelper.pages.length&&1==this.documentHelper.pages[0].bodyWidgets[0].childWidgets.length&&T.parseSectionFormat(this.keywordIndex,e[C._2[this.keywordIndex]][f][C._322[this.keywordIndex]],g.sectionFormat),T.isPaste=!1,T.isHtmlPaste=!1}if(e[C._29[this.keywordIndex]]){var L=new r.g;g.childWidgets.push(L)}}return"MergeWithExistingFormatting"===this.currentPasteOptions&&this.applyMergeFormat(d),d},e.prototype.applyMergeFormat=function(e){for(var t=this.selection.start.paragraph,i=this.selection.start.currentWidget.getInline(this.selection.start.offset,0),n=this.selection.getPreviousValidElement(i.element),o=n?n.characterFormat:this.copyInsertFormat(t.characterFormat,!1),s=this.documentHelper.selection.paragraphFormat,a=0;a<e.length;a++)for(var l=e[a].childWidgets,d=0;d<l.length;d++){var h=l[d];if(h instanceof r.g)this.applyParaFormatInternal(h.paragraphFormat,s),this.applyFormatInternal(h,o);else for(var c=0;c<h.childWidgets.length;c++)for(var p=h.childWidgets[c],u=0;u<p.childWidgets.length;u++)for(var g=p.childWidgets[u],f=0;f<g.childWidgets.length;f++)this.applyFormatInternal(g.childWidgets[f],o)}},e.prototype.applyParaFormatInternal=function(e,t){i.i(a.isNullOrUndefined)(t.leftIndent)||(e.leftIndent=t.leftIndent),i.i(a.isNullOrUndefined)(t.rightIndent)||(e.rightIndent=t.rightIndent),i.i(a.isNullOrUndefined)(t.firstLineIndent)||(e.firstLineIndent=t.firstLineIndent),i.i(a.isNullOrUndefined)(t.textAlignment)?e.textAlignment="Left":e.textAlignment=t.textAlignment,i.i(a.isNullOrUndefined)(t.outlineLevel)?e.outlineLevel="BodyText":e.outlineLevel=t.outlineLevel,-1===t.beforeSpacing?e.beforeSpacing=0:e.beforeSpacing=t.beforeSpacing,-1===t.afterSpacing?e.afterSpacing=0:e.afterSpacing=t.afterSpacing,0===t.lineSpacing?e.lineSpacing=1:e.lineSpacing=t.lineSpacing,i.i(a.isNullOrUndefined)(t.lineSpacingType)||(e.lineSpacingType=t.lineSpacingType),i.i(a.isNullOrUndefined)(t.bidi)||(e.bidi=t.bidi),i.i(a.isNullOrUndefined)(t.spaceAfterAuto)||(e.spaceAfterAuto=t.spaceAfterAuto),i.i(a.isNullOrUndefined)(t.spaceBeforeAuto)||(e.spaceBeforeAuto=t.spaceBeforeAuto),i.i(a.isNullOrUndefined)(t.keepWithNext)||(e.keepWithNext=t.keepWithNext),i.i(a.isNullOrUndefined)(t.keepLinesTogether)||(e.keepLinesTogether=t.keepLinesTogether),i.i(a.isNullOrUndefined)(t.widowControl)||(e.widowControl=t.widowControl),i.i(a.isNullOrUndefined)(t.contextualSpacing)||(e.contextualSpacing=t.contextualSpacing),e.tabs&&(e.tabs=[])},e.prototype.applyFormatInternal=function(e,t){if(e instanceof r.g)for(var n=0;n<e.childWidgets.length;n++)for(var o=e.childWidgets[n],s=0;s<o.children.length;s++){var l=o.children[s].characterFormat,d=l.cloneFormat();d.bold&&(o.children[s].characterFormat.bold=d.bold),d.italic&&(o.children[s].characterFormat.italic=d.italic),"None"!==d.underline&&(o.children[s].characterFormat.underline=d.underline),"MergeWithExistingFormatting"!==this.currentPasteOptions||i.i(a.isNullOrUndefined)(t)||(t.bold&&(o.children[s].characterFormat.bold=t.bold),t.italic&&(o.children[s].characterFormat.italic=t.italic),"None"!==t.underline&&(o.children[s].characterFormat.underline=t.underline),o.children[s].characterFormat.fontColor!==t.fontColor&&(o.children[s].characterFormat.fontColor=t.fontColor),o.children[s].characterFormat.fontSize!==t.fontSize&&(o.children[s].characterFormat.fontSize=t.fontSize,o.children[s].characterFormat.fontSizeBidi=t.fontSizeBidi),o.children[s].characterFormat.fontFamily!==t.fontFamily&&(o.children[s].characterFormat.fontFamily=t.fontFamily,o.children[s].characterFormat.fontFamilyBidi=t.fontFamilyBidi),o.children[s].characterFormat.fontFamilyAscii!==t.fontFamilyAscii&&(o.children[s].characterFormat.fontFamilyAscii=t.fontFamilyAscii),o.children[s].characterFormat.fontFamilyFarEast!==t.fontFamilyFarEast&&(o.children[s].characterFormat.fontFamilyFarEast=t.fontFamilyFarEast),o.children[s].characterFormat.fontFamilyAscii!==t.fontFamilyAscii&&(o.children[s].characterFormat.fontFamilyAscii=t.fontFamilyAscii))}else for(var n=0;n<e.childWidgets.length;n++)for(var h=e.childWidgets[n],s=0;s<h.childWidgets.length;s++)for(var c=h.childWidgets[s],p=0;p<c.childWidgets.length;p++)this.applyFormatInternal(c.childWidgets[p],t)},e.prototype.applyPasteOptions=function(e,t){if(!i.i(a.isNullOrUndefined)(this.copiedContent)&&""!==this.copiedTextContent&&!t){this.currentPasteOptions=e;var n=this.selection.isForward?this.selection.start:this.selection.end,r=n.paragraph.paragraphFormat,o=this.copiedContent,s=this.copiedTextContent;switch(this.editorHistory&&this.editorHistory.canUndo()&&(this.editorHistory.undo(),this.editorHistory.redoStack.pop()),this.copiedContent=o,this.copiedTextContent=s,this.selection.isViewPasteOptions=!0,e){case"KeepSourceFormatting":this.pasteContents(""!==this.copiedContent?this.copiedContent:this.copiedTextContent);break;case"MergeWithExistingFormatting":this.pasteContents(""!==this.copiedContent?this.copiedContent:this.copiedTextContent,r);break;case"KeepTextOnly":this.pasteContents(this.copiedTextContent)}}},e.prototype.applyTablePasteOptions=function(e){if(!i.i(a.isNullOrUndefined)(this.copiedContent)&&""!==this.copiedTextContent){this.isPaste=!0;var t=""!==this.copiedContent?this.copiedContent:this.copiedTextContent;this.editorHistory&&this.editorHistory.canUndo()&&(this.editorHistory.undo(),this.editorHistory.redoStack.pop());var n=this.getBlocks(t,!0),r=this.selection.start.paragraph.paragraphFormat;switch(e){case"NestTable":this.pasteAsNestedTable(n,r);break;case"InsertAsRows":this.pasteAsNewRow(n[0].childWidgets[0]);break;case"InsertAsColumns":this.pasteAsNewColumn(n[0].childWidgets[0]);break;case"OverwriteCells":this.pasteOverwriteCell(n[0].childWidgets[0])}this.isPaste=!1}},e.prototype.pasteContents=function(e,t){if(!i.i(a.isNullOrUndefined)(e.optimizeSfdt)&&e.optimizeSfdt?this.keywordIndex=1:this.keywordIndex=0,"string"!=typeof e&&(this.copiedContent=e),"FormFieldsOnly"===this.documentHelper.protectionType&&this.documentHelper.selection.isInlineFormFillMode()){var n=this.selection.getCurrentFormField(),r=this.getFieldResultText(),o=n.formFieldData.maxLength,s=this.documentHelper.selection.text.length;if(o>0)if(0===s){var l=o-r.length;e=e.substring(0,l)}else s>0&&(e=e.substring(0,s))}if(!i.i(a.isNullOrUndefined)(e[u.u[this.keywordIndex]])){var d=e[u.u[this.keywordIndex]];if(this.documentHelper.images.length>0){this.pasteImageIndex=new v.a;var h={};for(var c in d){var p=this.documentHelper.images.length+parseInt(c);h[p]=d[c],this.pasteImageIndex.add(c,p.toString())}d=h}this.documentHelper.owner.parser.parseImages(d)}this.pasteContentsInternal(this.getBlocks(e,!0),!0,t),e[C._10[this.keywordIndex]]&&e[C._10[this.keywordIndex]].length>0&&this.documentHelper.layout.layoutComments(this.documentHelper.comments),i.i(a.isNullOrUndefined)(this.pasteImageIndex)||this.pasteImageIndex.destroy(),this.pasteImageIndex=void 0,this.isInsertField=!1,this.isPasteListUpdated=!1},e.prototype.pasteContentsInternal=function(e,t,i){this.isPaste=t;var n=this.documentHelper.selection;if(n.start.paragraph.isInsideTable&&n.end.paragraph.isInsideTable){var o=!1;if(1===e.length){var s=e[0].childWidgets;s.length<3&&(1===s.length&&s[0]instanceof r.u||2===s.length&&s[0]instanceof r.u&&s[1].isEmpty())&&(o=!0)}if(o){var a=n.start.paragraph.associatedCell,l=n.end.paragraph.associatedCell,d=e[0].childWidgets[0];if(a.ownerTable.equals(l.ownerTable))return 0===n.start.paragraph.associatedCell.rowIndex&&0===n.end.paragraph.associatedCell.rowIndex&&a.equals(l)&&!this.selection.isCellSelected(a,n.start,n.end)?(this.selection.currentPasteAction="InsertAsColumns",this.pasteAsNewColumn(d)):(this.selection.currentPasteAction="OverwriteCells",this.pasteOverwriteCell(d)),void(this.isPaste=!1)}}var h;h=this.checkAndRemoveComments(),this.defaultPaste(e,i),this.updateHistoryForComments(h)},e.prototype.defaultPaste=function(e,t){var n=this.documentHelper.selection,r=!0,o=!1;if(this.initComplexHistory("Paste"),this.documentHelper.isListTextSelected){var s=n.start.paragraph;s.paragraphFormat.listFormat&&-1!==s.paragraphFormat.listFormat.listId&&this.onApplyList(void 0)}if(this.initHistory("Paste"),n.isEmpty&&!this.documentHelper.isListTextSelected||(r=this.removeSelectedContentInternal(n,n.start,n.end)),r?o=this.pasteContent(e,t):this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo=void 0),this.editorHistory&&this.editorHistory.currentHistoryInfo){if(this.editorHistory.currentBaseHistoryInfo&&"Paste"===this.editorHistory.currentBaseHistoryInfo.action){var l=this.selection.getTextPosBasedOnLogicalIndex(this.editorHistory.currentBaseHistoryInfo.insertPosition),d=this.selection.getTextPosBasedOnLogicalIndex(this.editorHistory.currentBaseHistoryInfo.endPosition),h=i.i(a.isNullOrUndefined)(this.owner.sfdtExportModule)?{}:this.owner.sfdtExportModule.write(this.owner.documentEditorSettings.optimizeSfdt?1:0,l.currentWidget,l.offset,d.currentWidget,d.offset,!1,!0);this.editorHistory.currentBaseHistoryInfo.pasteContent=h}this.editorHistory.updateHistory(),this.editorHistory.updateComplexHistory()}else this.reLayout(n,n.isEmpty);o&&(this.selection.pasteElement&&(this.selection.pasteElement.style.display="none"),this.layoutWholeDocument(!0)),this.isPaste=!1},e.prototype.pasteAsNewColumn=function(e){if(!this.owner.isReadOnlyMode&&this.canEditContentControl&&this.selection.start.paragraph.isInsideTable){this.checkIsNotRedoing()&&this.initHistory("PasteColumn");var t=this.getOwnerCell(this.selection.isForward),n=t.ownerRow.ownerTable.combineWidget(this.owner.viewer);if(this.editorHistory){this.cloneTableToHistoryInfo(n)}this.selection.owner.isLayoutEnabled=!1;var r=e.clone(),o=r.childWidgets[0],s=r.childWidgets.length,l=o.childWidgets.length,d=t.columnIndex,h=void 0,c=void 0,p=l,u=[];s>n.childWidgets.length?(this.addRows(s-n.childWidgets.length,n),this.tableUpdate(n)):n.childWidgets.length>s&&(this.addRows(n.childWidgets.length-s,r,n),this.tableUpdate(n));for(var g=0;g<p;g++)for(var f=0;f<n.childWidgets.length;f++){var m=n.childWidgets[f],v=r.childWidgets[f],y=v.childWidgets[g],w=m.childWidgets[t.columnIndex];c=this.createColumn(this.selection.getLastParagraph(t)),c.index=f,c.rowIndex=m.index,c.containerWidget=m;var b=m.previousWidget,x=this.rowspannedCollection(m,u);if(null!=w)c.cellFormat.copyFormat(w.cellFormat),c.cellFormat.rowSpan=1;else if(x.length>0)for(var C=0;C<x.length;C++)b.rowIndex+(x[C].cellFormat.rowSpan-1)>=m.rowIndex&&(c.cellFormat.copyFormat(x[C].cellFormat),c.cellFormat.rowSpan=1);y.containerWidget=c.containerWidget,c.childWidgets=y.childWidgets,i.i(a.isNullOrUndefined)(h)&&(h=this.selection.getFirstParagraph(c)),0===d?m.childWidgets.splice(g,0,c):this.insertSpannedCells(m,u,c,d)}this.tableReLayout(n,h,c)}},e.prototype.pasteAsNestedTable=function(e,t){var n=e[0].childWidgets[0];if(this.selection.start.paragraph.isInsideTable){this.checkIsNotRedoing()&&this.initHistory("PasteNested");var o=this.getOwnerCell(this.selection.isForward),s=o.ownerRow.ownerTable.combineWidget(this.owner.viewer);this.editorHistory&&this.cloneTableToHistoryInfo(s);var l=void 0,d=n.clone(),h=this.selection.end.paragraph.containerWidget,c=void 0;if(o!=h){for(var p=o.ownerRow;p!=h.ownerRow.nextRow;){for(var u=o.columnIndex;u<=h.columnIndex;u++){c=p.childWidgets[u];var g=d.clone(),f=new r.g;c.childWidgets=[],c.childWidgets[0]=g,c.childWidgets[1]=f,f.containerWidget=c,g.containerWidget=c,g.index=0,f.index=1,p.childWidgets[u]=c,i.i(a.isNullOrUndefined)(l)&&(l=this.selection.getFirstParagraph(c))}p=p.nextRow}this.tableReLayout(s,l,c)}else this.defaultPaste(e,t)}},e.prototype.pasteOverwriteCell=function(e){if(this.selection.start.paragraph.isInsideTable){this.checkIsNotRedoing()&&this.initHistory("PasteOverwrite");var t=this.getOwnerCell(this.selection.isForward),n=t.ownerRow.ownerTable.combineWidget(this.owner.viewer);this.editorHistory&&this.cloneTableToHistoryInfo(n);var r=e.clone(),o=r.childWidgets.length,s=this.getOwnerCell(!this.selection.isForward),l=(t.columnIndex,t.rowIndex),d=void 0,h=this.selection.start.paragraph.associatedCell.ownerRow,c=r.childWidgets[0],p=void 0,u=(c.childWidgets.length,t.ownerRow);if(t!=s){for(var g=0,f=void 0,m=void 0,v=void 0,y=void 0;u!=s.ownerRow.nextRow;){c=r.childWidgets[g]||r.childWidgets[g=0];for(var w=c.childWidgets.length,b=0,x=t.columnIndex;x<=s.columnIndex;x++){c=r.childWidgets[g],f>1&&m===x&&(x++,f--,m=null),v>1&&b>=w-(v-1)&&(v=1,x+=v-1,b=0),p=c.childWidgets[b]||c.childWidgets[b=0],y=p.clone();for(var C=u.childWidgets[x],I=0;I<y.childWidgets.length;I++){var F=y.childWidgets[I];F.containerWidget=C,y.childWidgets[I]=F}C.childWidgets=y.childWidgets,p.cellFormat.rowSpan>1&&(f=p.cellFormat.rowSpan,m=x),p.cellFormat.columnSpan>1&&(v=p.cellFormat.columnSpan),u.childWidgets[x]=C,i.i(a.isNullOrUndefined)(d)&&(d=this.selection.getFirstParagraph(y)),b++}u=u.nextRow,g++}this.tableReLayout(n,d,y)}else{var k=void 0,f=void 0,m=void 0,C=void 0;o>n.childWidgets.length-l&&(k=o-n.childWidgets.length+l,this.addRows(k,n));for(var P=0;P<o;P++){var x=t.columnIndex;c=r.childWidgets[P];for(var T=c.childWidgets.length,S=0;S<T;S++){p=c.childWidgets[S];var y=p.clone();f>1&&m===x&&(x++,f--,m=null),C=h.childWidgets[x],C||(C=y,C.containerWidget=h,C.index=x);for(var W=0;W<y.childWidgets.length;W++){var F=y.childWidgets[W];F.containerWidget=C,y.childWidgets[W]=F}C.childWidgets=y.childWidgets,p.cellFormat.rowSpan>1&&(f=p.cellFormat.rowSpan,m=x),h.childWidgets.splice(x++,1,C),i.i(a.isNullOrUndefined)(d)&&(d=this.selection.getFirstParagraph(C))}h=h.nextRow}this.tableReLayout(n,d,C)}}},e.prototype.pasteAsNewRow=function(e){if(!this.owner.isReadOnlyMode&&this.canEditContentControl){this.checkIsNotRedoing()&&this.initHistory("PasteRow"),this.documentHelper.owner.isShiftingEnabled=!0;var t=this.getOwnerCell(this.selection.isForward).getSplitWidgets()[0],i=this.getOwnerCell(!this.selection.isForward).getSplitWidgets()[0],n=t.ownerTable.combineWidget(this.owner.viewer),o=i.ownerRow;this.editorHistory&&this.cloneTableToHistoryInfo(n);var s=(this.getRowCountToInsert(),this.getColumnCountToInsert(),[]),a=o.rowIndex;a++;for(var l=e.childWidgets.length,d=0;d<l;d++){var h=e.childWidgets[d].clone();this.owner.enableTrackChanges&&this.insertRevision(h.rowFormat,"Insertion"),s.push(h)}n.insertTableRowsInternal(s,a,!1);var c=void 0,p=void 0;if(n.childWidgets[a]instanceof r.z)c=n.childWidgets[a].firstChild,p=this.selection.getFirstParagraph(c);else{for(var u=void 0;!(u instanceof r.u);)u=n.nextRenderedWidget;p=this.documentHelper.getFirstParagraphInFirstCell(u)}this.documentHelper.layout.reLayoutTable(n),this.selection.selectParagraphInternal(p,!0),this.reLayout(this.selection,!0)}},e.prototype.tableUpdate=function(e){e.isGridUpdated=!1,e.calculateGrid(),e.buildTableColumns(),e.isGridUpdated=!0},e.prototype.rowspannedCollection=function(e,t){for(var i=0;i<e.childWidgets.length;i++){var n=e.childWidgets[i];n.cellFormat.rowSpan>1&&t.push(n)}return t},e.prototype.insertSpannedCells=function(e,t,i,n){for(var r=!1,o=0;o<e.childWidgets.length;o++){var s=e.childWidgets[o];if(s.cellFormat.rowSpan>1&&t.push(s),s.columnIndex+s.cellFormat.columnSpan===n?(e.childWidgets.splice(s.cellIndex+1,0,i),r=!0):n>s.columnIndex&&s.columnIndex+s.cellFormat.columnSpan>n&&n<s.columnIndex+s.cellFormat.columnSpan&&(e.childWidgets.splice(s.cellIndex+1,0,i),r=!0),r)break}if(!r&&t.length>0)for(var a=0;a<t.length;a++){var l=t[a];if(l.ownerRow!==e&&e.rowIndex<=l.ownerRow.rowIndex+l.cellFormat.rowSpan-1&&(l.columnIndex+l.cellFormat.columnSpan===n?(l.cellIndex>e.childWidgets.length?e.childWidgets.push(i):e.childWidgets.splice(l.cellIndex+1,0,i),r=!0):n>l.columnIndex&&l.columnIndex+l.cellFormat.columnSpan>n&&n<l.columnIndex+l.cellFormat.columnSpan&&(e.childWidgets.splice(l.columnIndex,0,i),r=!0)),r)break}},e.prototype.addRows=function(e,t,i){if(!this.owner.isReadOnlyMode&&this.canEditContentControl){var n=this.selection.isForward?this.selection.start:this.selection.end,r=(this.selection.isForward?this.selection.end:this.selection.start,t.childWidgets.length),o=t.childWidgets[r-1],s=o.childWidgets.length;if(n.paragraph.isInsideTable){var a=this.getOwnerCell(this.selection.isForward).getSplitWidgets()[0],l=o.childWidgets[s-1],d=l.ownerRow;this.rowInsertion(e,"Below",a,l,d,t,!1)}}},e.prototype.pasteContent=function(e,t){this.documentHelper.owner.isShiftingEnabled=!0;var i="";if(this.updateInsertPosition(),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo)i=this.editorHistory.currentBaseHistoryInfo.insertPosition;else{var r=this.selection.start;this.selection.isForward||(r=this.selection.end);var o=this.selection.getParagraphInfo(r);i=this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString())}this.documentHelper.owner.isLayoutEnabled=!0,this.documentHelper.owner.isPastingContent=!0;var s=this.pasteCopiedData(e,t),a="";if(this.updateEndPosition(),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo)a=this.editorHistory.currentBaseHistoryInfo.endPosition;else{var o=this.selection.getParagraphInfo(this.selection.start);a=this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString())}this.selection.start.paragraph.isEmpty()&&this.selection.start.paragraph.paragraphFormat.bidi&&this.documentHelper.layout.reLayoutParagraph(this.selection.start.paragraph,0,0);var l=new n.a(this.documentHelper.owner);this.setPositionForCurrentIndex(l,i);var d=new n.a(this.documentHelper.owner);return this.setPositionForCurrentIndex(d,a),this.pasteTextPosition={startPosition:l,endPosition:d},this.documentHelper.owner.isPastingContent=!1,this.documentHelper.selection.fireSelectionChanged(!0),s},e.prototype.pasteCopiedData=function(e,t){var n=!1;if(this.documentHelper.layout.isBidiReLayout&&(this.documentHelper.layout.isBidiReLayout=!1),this.isPaste&&this.isSectionEmpty(this.selection)&&!this.selection.start.paragraph.isInHeaderFooter){if(this.previousSectionFormat=new l.G,this.previousSectionFormat.copyFormat(this.selection.start.paragraph.bodyWidget.sectionFormat),this.selection.start.paragraph.bodyWidget.sectionFormat.copyFormat(e[0].sectionFormat),this.selection.start.paragraph.bodyWidget.sectionFormat.footerDistance=this.previousSectionFormat.footerDistance,this.selection.start.paragraph.bodyWidget.sectionFormat.headerDistance=this.previousSectionFormat.headerDistance,this.owner.viewer instanceof l.D){var o=this.selection.start.paragraph.bodyWidget.page;this.owner.viewer.updatePageBoundingRectangle(this.selection.start.paragraph.bodyWidget,o,o.boundingRectangle.y),this.owner.viewer.updateClientArea(this.selection.start.paragraph.bodyWidget,o)}n=!0}for(var s=0;s<e.length;s++){0!==s&&this.insertSectionBreak(e[s].sectionFormat.breakCode);for(var d=e[s].childWidgets,h=0;h<d.length;h++){var c=d[h];if(c instanceof r.g&&0===c.childWidgets.length&&(c.childWidgets[0]=new r.p(c)),c instanceof r.g&&!i.i(a.isNullOrUndefined)(t)){c.paragraphFormat.copyFormat(t);var p=this.copyInsertFormat(this.selection.start.paragraph.characterFormat,!1);c.characterFormat.mergeFormat(p)}var u=c instanceof r.g&&(this.owner.enableLocalPaste?!i.i(a.isNullOrUndefined)(c.isCreatedUsingHtmlSpanTag)&&!c.isCreatedUsingHtmlSpanTag:c.isCreatedUsingHtmlSpanTag);if(c instanceof r.g&&u&&!i.i(a.isNullOrUndefined)(c.paragraphFormat.listFormat)&&i.i(a.isNullOrUndefined)(c.paragraphFormat.listFormat.list)&&-1===c.paragraphFormat.listFormat.listId){var g=c;if(g.childWidgets.length>0&&g.childWidgets[0].children.length>0){var f=this.selection.start;if("Center"!==f.paragraph.paragraphFormat.textAlignment&&"Right"!==f.paragraph.paragraphFormat.textAlignment||-1!==f.paragraph.paragraphFormat.listFormat.listId||(f.paragraph.x=this.owner.viewer.clientActiveArea.x),"KeepTextOnly"===this.currentPasteOptions){var m=new l.F(this.selection.start.paragraph);this.selection.start.paragraph.paragraphFormat=m}!i.i(a.isNullOrUndefined)(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&this.editorHistory.currentBaseHistoryInfo.insertedNodes.push(g.clone()),this.insertElement(g.childWidgets[0].children,g.paragraphFormat)}}else if(c instanceof r.C){var v=c,y=this.selection.start.paragraph,w=v instanceof r.u;if(w){var b=v;if(this.generateTableRevision(b),y.isInsideTable){var x=y.getContainerWidth();b.fitCellsToClientArea(x)}if(y.isEmpty()&&y.previousWidget instanceof r.u&&!this.isPaste)return this.insertTableRows(b,y.previousWidget),n}this.insertBlockInternal(v)}}}return n},e.prototype.generateTableRevision=function(e){if(this.owner.enableTrackChanges&&!i.i(a.isNullOrUndefined)(e))for(var t=0;t<e.childWidgets.length;t++){var n=e.childWidgets[t];this.insertRevision(n.rowFormat,"Insertion");for(var r=0;r<n.childWidgets.length;r++)for(var o=n.childWidgets[r],s=0;s<o.childWidgets.length;s++){var l=o.childWidgets[s];i.i(a.isNullOrUndefined)(l)||this.insertRevisionForBlock(l,"Insertion")}}},e.prototype.isSectionEmpty=function(e){var t=e.start.paragraph;if(t){if(t.isInsideTable||t.isInHeaderFooter||t!==e.end.paragraph)return!1;var n=t.bodyWidget;if(n){var o=n.page;if(o&&(i.i(a.isNullOrUndefined)(o.previousPage)||o.previousPage.sectionIndex!==o.sectionIndex)&&i.i(a.isNullOrUndefined)(o.nextPage)&&t.isEmpty()&&1===n.childWidgets.length){var s=!0,l=e.start.paragraph.bodyWidget.sectionIndex,d=this.documentHelper.headersFooters[l];if(d){for(var h in d){var c=d[h];if(i.i(a.isNullOrUndefined)(c))s=!1;else{var p=c.childWidgets[0];p instanceof r.u?s=!1:p instanceof r.g&&!p.isEmpty()&&(s=!1)}if(!s)break}return s}}}}return!1},e.prototype.insertTableInternal=function(e,t,n,r){var o=0;if(o=this.owner.editorHistory&&(this.owner.editorHistory.isUndoing||this.owner.editorHistory.isRedoing)?e.index:e.getIndex(),n)for(var s=0,l=0;s<e.childWidgets.length;s++,l++){var d=e.childWidgets[s];t.childWidgets.splice(l,0,d),d.containerWidget=t,e.childWidgets.splice(s,1),s--}var h=this.selection.start.paragraph;i.i(a.isNullOrUndefined)(e.containerWidget)&&(e.containerWidget=h.containerWidget);var c=e.containerWidget;this.constructRevisionsForTable(e,!1),r||this.removeBlock(e,!0),this.removeRevisionFromTable(e);var p=c.childWidgets,u=this.documentHelper.layout.checkAndGetBlock(c,o);o=c.childWidgets.indexOf(u),p.splice(o,0,t),t.index=e.index,e.containerWidget=void 0,t.containerWidget=c,this.documentHelper.layout.clearTableWidget(t,!0,!0,!0),t.buildTableColumns(),this.constructRevisionsForTable(t,!0),t.isGridUpdated=!0,this.updateNextBlocksIndex(t,!0),this.documentHelper.layout.linkFieldInTable(t),this.documentHelper.layout.layoutBodyWidgetCollection(t.index,c,t,!1)},e.prototype.removeRevisionFromTable=function(e){for(var t=0;t<e.childWidgets.length;t++){var i=e.childWidgets[t];if(i.rowFormat.revisions.length>0)for(var n=0;n<i.rowFormat.revisions.length;n++)if(0===i.rowFormat.revisions[n].range.length){var r=i.rowFormat.revisions.indexOf(i.rowFormat.revisions[n]);i.rowFormat.revisions.splice(r,1),n--}}},e.prototype.canConstructRevision=function(e){return e.revisions.length>0&&0===e.revisions[0].range.length||e.removedIds.length>0},e.prototype.constructRevisionsForTable=function(e,t){for(var n=0;n<e.childWidgets.length;n++){var o=e.childWidgets[n];if(t){this.canConstructRevision(o.rowFormat)&&this.constructRevisionFromID(o.rowFormat,!0);for(var s=0;s<o.childWidgets.length;s++)for(var l=o.childWidgets[s],d=0;d<l.childWidgets.length;d++)l.childWidgets[d]instanceof r.g&&this.constructRevisionsForBlock(l.childWidgets[d],t)}else i.i(a.isNullOrUndefined)(this.owner.editorHistory)||!this.owner.editorHistory.isUndoing&&!this.owner.editorHistory.isRedoing?this.removeDeletedCellRevision(o):this.deleteRevision(o)}},e.prototype.deleteRevision=function(e){if(e.rowFormat.revisions.length>0)for(var t=0;t<e.rowFormat.revisions.length;t++){for(var i=e.rowFormat.revisions[t],n=0;n<i.range.length;n++)i.range.splice(n,1),n--,this.owner.trackChangesPane.updateCurrentTrackChanges(i);0===i.range.length&&this.owner.revisions.remove(i)}},e.prototype.constructRevisionsForBlock=function(e,t){for(var i=0;i<e.childWidgets.length;i++)for(var n=e.childWidgets[i],o=0;o<n.children.length;o++)t&&n.children[o]instanceof r.c&&this.canConstructRevision(n.children[o])&&this.constructRevisionFromID(n.children[o],!0);this.canConstructRevision(e.characterFormat)&&this.constructRevisionFromID(e.characterFormat,!0)},e.prototype.applyRevisionForCurrentPara=function(e,t,n,o,s){var l=e.getInline(t+1,0),d=l.element,h=!1;t===e.getLength()&&(h=!0),t===n&&e.nextSplitWidget&&(n+=d.length);var c=e.getInline(n,0).element;i.i(a.isNullOrUndefined)(e.nextSplitWidget)||(s=!1);for(var p=0;e;)i.i(a.isNullOrUndefined)(e)||(p+=e.getLength()),e=e.previousSplitWidget;if(n>p&&(s=!0),i.i(a.isNullOrUndefined)(d)||i.i(a.isNullOrUndefined)(c))i.i(a.isNullOrUndefined)(d)||h?i.i(a.isNullOrUndefined)(c)||(c.removedIds.push(o),this.constructRevisionFromID(c,!0)):(d.removedIds.push(o),this.constructRevisionFromID(d,!0));else if(h||d!==c){for(;!i.i(a.isNullOrUndefined)(d)&&d!==c;)h||(d.removedIds.push(o),this.constructRevisionFromID(d,!0)),i.i(a.isNullOrUndefined)(d.nextNode)||(d=d.nextNode instanceof r.e?d.nextNode:d.nextNode.nextValidNodeForTracking),h=!1;i.i(a.isNullOrUndefined)(d)||h||(d.removedIds.push(o),this.constructRevisionFromID(d,!0))}else d.removedIds.push(o),this.constructRevisionFromID(d,!0);s&&(e.characterFormat.removedIds.push(o),this.constructRevisionFromID(e.characterFormat,!0))},e.prototype.insertBlockTable=function(e,t,i){var n=e.start.offset;e.start.paragraph.childWidgets.indexOf(e.start.currentWidget);t instanceof r.g&&n>0&&(this.moveInlines(e.start.paragraph,t,0,0,e.start.paragraph.firstChild,n,e.start.currentWidget),e.selectParagraphInternal(e.start.paragraph,!0),this.checkInsertPosition(e)&&this.updateHistoryPosition(this.selection.getHierarchicalIndex(t,n.toString()),!0)),n>0&&this.checkInsertPosition(e)&&this.updateHistoryPosition(e.start,!0);var o=i.indexInOwner;if(i.containerWidget.childWidgets.splice(o,0,t),t.containerWidget=i.containerWidget,t.index=i.index,this.updateNextBlocksIndex(t,!0),t instanceof r.g&&this.constructRevisionsForBlock(t,!0),this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1),this.checkInsertPosition(e)){var s=void 0;t instanceof r.g&&(s=t),t instanceof r.u&&(s=this.documentHelper.getFirstParagraphInFirstCell(t)),this.updateHistoryPosition(this.selection.getHierarchicalIndex(s,"0"),!0)}},e.prototype.handleCut=function(e){var t=e.start,i=e.end;e.isForward||(t=e.end,i=e.start);if(t.paragraph===i.paragraph&&t.offset+1===i.offset){t.paragraph.getInline(i.offset,0).element}var r=this.checkAndRemoveComments(),o=this.selection.getParagraphInfo(t);e.editPosition=this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString()),this.initHistory("Cut"),e.owner.isShiftingEnabled=!0,this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.checkInsertPosition(e)&&this.updateHistoryPosition(e.editPosition,!0),this.deleteSelectedContent(i.paragraph,e,t,i,3);var s=new n.a(e.owner);this.setPositionForCurrentIndex(s,e.editPosition),e.selectContent(s,!0),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.checkEndPosition(e)&&this.updateHistoryPosition(e.end,!1),this.reLayout(e),this.updateHistoryForComments(r)},e.prototype.insertInlineInternal=function(e,t){var n=this.selection,o=e.length,s=this.selection.getParagraphInfo(n.start);if(t=i.i(a.isNullOrUndefined)(t)?"Insertion":t,n.start.paragraph.isEmpty()){var l=n.start.paragraph;"Center"!==l.paragraphFormat.textAlignment&&"Right"!==l.paragraphFormat.textAlignment||-1!==l.paragraphFormat.listFormat.listId||(l.x=this.owner.viewer.clientActiveArea.x);var d=!i.i(a.isNullOrUndefined)(this.editorHistory)&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing);l.childWidgets[0].children.push(e),e.line=l.childWidgets[0],this.owner.enableTrackChanges&&e.isValidNodeForTracking&&!d&&this.insertRevision(e,t),(e.removedIds.length>0||d)&&this.constructRevisionFromID(e,!0),e.linkFieldCharacter(this.documentHelper),e instanceof r.f&&("Footnote"===e.footnoteType&&this.updateFootnoteCollection(e),"Endnote"===e.footnoteType&&this.updateEndnoteCollection(e)),this.documentHelper.layout.reLayoutParagraph(l,0,0,void 0,void 0)}else{var h=0,c=n.start.currentWidget.getInline(n.start.offset,h),p=c.element;h=c.index,this.insertElementInternal(p,e,h,t,!0)}var u=e.revisions[0];i.i(a.isNullOrUndefined)(u)||this.owner.trackChangesPane.updateCurrentTrackChanges(u),this.setPositionParagraph(s.paragraph,s.offset+o,!0)},e.prototype.insertElement=function(e,t){var n=this.selection,o=0,s=void 0,l=-1,d=void 0,h=0,c=void 0,p=this.selection.getParagraphInfo(n.start),u=this.owner.enableTrackChanges,g=void 0,f=void 0,m=0;if(n.start.paragraph.isEmpty())s=n.start.paragraph,d=s.childWidgets[0],l=0;else{var v=n.start.currentWidget.getInline(n.start.offset,m);g=v.element,m=v.index,s=g.line.paragraph,l=s.childWidgets.indexOf(g.line),h=g.indexInOwner,d=g.line,m===g.length?(h++,c=!1):0===m?(i.i(a.isNullOrUndefined)(g.previousNode)&&(h=0),c=!0):(h++,f=new r.d,f.characterFormat.copyFormat(g.characterFormat),f.text=g.text.substring(m),g.text=g.text.slice(0,m),g.revisions.length>0&&!this.owner.enableTrackChanges&&this.splitRevisionForSpittedElement(g,f),d.children.splice(h,0,f),f.line=g.line)}for(var y=0;y<e.length;y++){o+=e[y].length,e[y]instanceof r.d&&e[y].text.indexOf(" ")>=0&&(this.documentHelper.triggerSpellCheck=!0);var w=e[y].revisions.length;e[y].ischangeDetected=!0,d.children.splice(h,0,e[y]),e[y].line=d,e[y].linkFieldCharacter(this.documentHelper);var b=this.updateRevisionForElement(g,e[y],m,0===y,f,c);u&&!b&&e[y].revisions.length===w&&this.checkToCombineRevisionsinBlocks(e[y],w===e[y].revisions.length,y>0&&y===e.length-1,"Insertion"),g=e[y],h++}!this.isPaste&&t&&(i.i(a.isNullOrUndefined)(s.paragraphFormat.listFormat.list)||!i.i(a.isNullOrUndefined)(s.paragraphFormat.listFormat)&&-1===s.paragraphFormat.listFormat.listId)&&s.paragraphFormat.copyFormat(t),this.isPaste&&(this.viewer.updateClientAreaForBlock(s,!0),s.x=this.viewer.clientActiveArea.x),this.documentHelper.layout.reLayoutParagraph(s,l,0,this.isInsertField?void 0:s.paragraphFormat.bidi),this.setPositionParagraph(p.paragraph,p.offset+o,!0)},e.prototype.updateRevisionForElement=function(e,t,n,r,o,s){if(!this.owner.enableTrackChanges)return!1;if(i.i(a.isNullOrUndefined)(e)&&i.i(a.isNullOrUndefined)(o))return!1;var l=!!i.i(a.isNullOrUndefined)(s),d=t.revisions.length;return r?l?(this.checkToMapRevisionWithInlineText(e,n,t,!1,"Insertion")||t.revisions.length>d?this.copyElementRevision(e,o,!0):0===t.revisions.length&&(this.splitRevisionForSpittedElement(e,o),this.insertRevision(t,"Insertion")),!1):s?this.insertRevisionAtBegining(e,t,"Insertion"):this.insertRevisionAtEnd(e,t,"Insertion"):this.insertRevisionAtEnd(e,t,"Insertion")},e.prototype.insertElementInternal=function(e,t,n,o,s){var l=e.line,d=l.paragraph,h=l.indexInOwner,c=e.indexInOwner,p=d.paragraphFormat.bidi&&e.isRightToLeft,u=!1;o=i.i(a.isNullOrUndefined)(o)?"Insertion":o;var g=this.skipTracking(),f=this.owner.enableTrackChanges,m=!1,v=t.revisions.length;if(this.owner.editorHistory&&(this.owner.editorHistory.isUndoing||this.owner.editorHistory.isRedoing)&&t instanceof r.d&&(u=e.characterFormat.isEqualFormat(t.characterFormat)&&this.documentHelper.textHelper.isRTLText(t.text)),u)e.text=e.text.substring(0,n)+t.text+e.text.substring(n);else if(n===e.length)c=this.incrementCommentIndex(p,e,c),t.removedIds.length>0||g?this.constructRevisionFromID(t,!0,e):!f||g||this.skipFieldDeleteTracking||(m=this.insertRevisionAtEnd(e,t,o)),l.children.splice(c,0,t);else if(0===n)t.removedIds.length>0?this.constructRevisionFromID(t,!1):!f||g||this.skipFieldDeleteTracking||(m=this.insertRevisionAtBegining(e,t,o)),i.i(a.isNullOrUndefined)(e.previousNode)?(e.line.children.splice(0,0,t),c=0):e.line.children.splice(c,0,t);else{c=this.incrementCommentIndex(p,e,c);var y=new r.d;if(y.characterFormat.copyFormat(e.characterFormat),y.text=e.text.substring(n),e.revisions.length>0&&!f&&!g&&0===t.removedIds.length&&this.splitRevisionForSpittedElement(e,y),e.text=e.text.substr(0,n),l.children.splice(c,0,y),y.line=e.line,m=!0,this.isTrackingFormField=e.previousElement instanceof r.b,t.removedIds.length>0&&!this.isTrackingFormField)this.constructRevisionFromID(t,!1),this.copyElementRevision(e,y,!0);else if(this.owner.enableTrackChanges)if(t instanceof r.e||t instanceof r.B||t instanceof r.G||t instanceof r.F)this.copyElementRevision(e,y,!1);else{var w=this.checkToMapRevisionWithInlineText(e,n,t,p,o);w||t.revisions.length>v?this.copyElementRevision(e,y,!0):t.revisions.length===v&&(this.splitRevisionForSpittedElement(e,y),this.insertRevision(t,o))}l.children.splice(c,0,t),c-=1}if(t.line=e.line,t instanceof r.e){var b=this.documentHelper.bookmarks;t.reference&&(t.reference.reference=t),b.containsKey(t.name)||b.add(t.name,t)}!i.i(a.isNullOrUndefined)(t.line.paragraph.containerWidget)&&!i.i(a.isNullOrUndefined)(t.line.paragraph.containerWidget.containerWidget)&&t.line.paragraph.containerWidget.containerWidget instanceof r.a&&(t.line.paragraph.containerWidget.containerWidget.height+=t.height),t.linkFieldCharacter(this.documentHelper),t instanceof r.H&&0===t.type&&this.documentHelper.contentControlCollection.push(t),(t instanceof r.r&&"Inline"!==t.textWrappingStyle||t instanceof r.s)&&(-1===d.floatingElements.indexOf(t)&&d.floatingElements.push(t),-1===d.bodyWidget.floatingElements.indexOf(t)&&"Inline"!==t.textWrappingStyle&&d.bodyWidget.floatingElements.push(t)),!f||m||g||this.skipFieldDeleteTracking||this.checkToCombineRevisionsinBlocks(t,v===t.revisions.length,n===e.length,o),t instanceof r.f&&(g&&(t.isLayout=!1),"Footnote"===t.footnoteType&&this.updateFootnoteCollection(t),"Endnote"===t.footnoteType&&this.updateEndnoteCollection(t)),s&&this.documentHelper.layout.reLayoutParagraph(d,h,c,void 0,void 0)},e.prototype.incrementCommentIndex=function(e,t,i){return this.owner.editorHistory&&this.owner.editorHistory&&this.owner.editorHistory.currentHistoryInfo&&(!this.owner.editorHistory||!this.owner.editorHistory.currentHistoryInfo||"SkipCommentInline"===this.owner.editorHistory.currentHistoryInfo.action&&("SkipCommentInline"!==this.owner.editorHistory.currentHistoryInfo.action||this.owner.editorHistory.currentHistoryInfo.modifiedActions[0]!==this.editorHistory.currentBaseHistoryInfo&&(this.owner.editorHistory.currentHistoryInfo.modifiedActions[0]===this.editorHistory.currentBaseHistoryInfo||t instanceof r.B)))||i++,i},e.prototype.constructRevisionFromID=function(e,t,n){if(e.removedIds.length>0){for(var r=0;r<e.removedIds.length;r++){var o=void 0;if(this.documentHelper.revisionsInternal.containsKey(e.removedIds[r])){if(o=this.documentHelper.revisionsInternal.get(e.removedIds[r]),e.revisions.push(o),t=!!t||this.skipTracking(),t&&this.editorHistory.isRedoing&&this.owner.editorHistory.currentBaseHistoryInfo&&"BackSpace"===this.owner.editorHistory.currentBaseHistoryInfo.action&&this.selection.isTOC()&&(t=!1),i.i(a.isNullOrUndefined)(n))o.range.splice(t?o.range.length:0,0,e);else{var s=o.range.indexOf(n);s>=0?o.range.splice(s+(t?1:0),0,e):o.range.splice(0,0,e)}this.owner.trackChangesPane.updateCurrentTrackChanges(o),this.updateRevisionCollection(o)}}e.removedIds=[]}else for(var r=0;r<e.revisions.length;r++){var l=e.revisions[r];this.documentHelper.revisionsInternal.containsKey(l.revisionID)&&(l=this.documentHelper.revisionsInternal.get(l.revisionID),l.range.splice(t?l.range.length:0,0,e),this.updateRevisionCollection(l))}},e.prototype.insertBlock=function(e){var t=!0,i=!1,n=this.selection;if(n.isEmpty||(t=this.removeSelectedContents(n),i=!0),t||n.selectContent(n.start,!1),this.insertBlockInternal(e,i),this.checkInsertPosition(n)){var o=void 0;o=e instanceof r.g?e:this.documentHelper.getFirstParagraphInFirstCell(e),this.updateHistoryPosition(this.selection.getHierarchicalIndex(o,"0"),!0)}this.fireContentChange()},e.prototype.insertBlockInternal=function(e,t){var n=this.selection,o=this.selection.start.paragraph,s=this.selection.start.isAtParagraphStart;if(!n.start.isAtParagraphStart){if(e instanceof r.g){this.isInsertingTOC||!this.owner.enableTrackChanges||this.skipTracking()||this.insertRevisionForBlock(e,"Insertion");var l=n.start.clone();return this.isInsertingTOC||!this.owner.enableTrackChanges||this.skipTracking()||this.insertRevisionForBlock(e,"Insertion"),!i.i(a.isNullOrUndefined)(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing||this.editorHistory.currentBaseHistoryInfo.insertedNodes.push(e.clone())),this.insertNewParagraphWidget(e,!1),void(this.isInsertingTOC||this.combineRevisions(e,l,this.selection.end))}this.updateInsertPosition(),o=o.combineWidget(this.owner.viewer),!i.i(a.isNullOrUndefined)(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing||this.editorHistory.currentBaseHistoryInfo.insertedNodes.push(o)),this.splitParagraph(o,o.firstChild,0,n.start.currentWidget,n.start.offset,!1),n.selectParagraphInternal(this.selection.start.paragraph,!0)}var d=n.start.paragraph.containerWidget,h=n.start.paragraph.index;if(!i.i(a.isNullOrUndefined)(d)){if(!i.i(a.isNullOrUndefined)(this.editorHistory)&&(i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)||this.editorHistory.isUndoing||this.editorHistory.isRedoing||this.editorHistory.currentBaseHistoryInfo.insertedNodes.push(e.clone()),this.editorHistory.isRedoing&&t&&d.firstChild instanceof r.g&&d.firstChild.isEmpty()&&d.firstChild===d.lastChild&&e instanceof r.g&&e.isEmpty()))return;var c=d.childWidgets.indexOf(n.start.paragraph);d.childWidgets.splice(c,0,e),e.containerWidget=d,e.index=h,e.height=0,e instanceof r.u&&(e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0),this.updateNextBlocksIndex(e,!0),!this.isInsertingTOC&&this.owner.enableTrackChanges&&!this.skipTracking()&&e instanceof r.g?this.insertRevisionForBlock(e,"Insertion"):e instanceof r.g?this.constructRevisionsForBlock(e,!0):e instanceof r.u&&this.constructRevisionsForTable(e,!0),this.documentHelper.owner.editor.isRemoteAction&&!s&&e instanceof r.u&&d.childWidgets.splice(e.indexInOwner+1,1),this.documentHelper.layout.layoutBodyWidgetCollection(h,d,e,!1)}},e.prototype.insertImage=function(e,t,i,n){this.insertImageInternal(e,!1,t,i,n)},e.prototype.insertImageAsync=function(e,t,i,n){return F(this,void 0,void 0,function(){return k(this,function(r){switch(r.label){case 0:return[4,this.insertImageInternal(e,!1,t,i,n)];case 1:return r.sent(),[2]}})})},e.prototype.insertImageInternal=function(e,t,n,o,s){return F(this,void 0,void 0,function(){var l=this;return k(this,function(d){return[2,new Promise(function(d,h){var c=l.selection.getCurrentFormField(),p="FormFieldsOnly"===l.documentHelper.protectionType&&!i.i(a.isNullOrUndefined)(c)&&c.formFieldData instanceof r.l;if((l.owner.isReadOnlyMode||!l.canEditContentControl)&&!p)return void d();if(i.i(a.isNullOrUndefined)(n)&&i.i(a.isNullOrUndefined)(o)){var u=document.createElement("img"),g=l;u.addEventListener("load",function(){g.insertPicture(e,this.width,this.height,this.alt,!0),d()}),u.src=e}else l.insertPicture(e,n,o,s,t),d();setTimeout(function(){i.i(a.isNullOrUndefined)(l.documentHelper)||l.viewer.updateScrollBars()},30)})]})})},e.prototype.insertTable=function(e,t){var n=this.selection.start;if(!this.owner.isReadOnlyMode&&this.canEditContentControl){e=e||1,t=t||1;var o=new a.L10n("documenteditor",this.owner.defaultLocale);if(o.setLocale(this.documentHelper.owner.locale),t<1||t>this.documentHelper.owner.documentEditorSettings.maximumColumns){var s=o.getConstant("Number of columns must be between")+" 1 "+o.getConstant("and")+" "+this.documentHelper.owner.documentEditorSettings.maximumColumns.toString();return void(w.DialogUtility.alert(s).enableRtl=this.documentHelper.owner.enableRtl)}if(e<1||e>this.documentHelper.owner.documentEditorSettings.maximumRows){var l=o.getConstant("Number of rows must be between")+" 1 "+o.getConstant("and")+" "+this.documentHelper.owner.documentEditorSettings.maximumColumns.toString();return o.getConstant("Number of rows must be between 1 and 32767.").replace("32767",this.documentHelper.owner.documentEditorSettings.maximumRows.toString()),void(w.DialogUtility.alert(l).enableRtl=this.documentHelper.owner.enableRtl)}var d=this.createTable(e,t),h=n.paragraph.getContainerWidth()-d.tableFormat.leftIndent;d.splitWidthToTableCells(h);var c,p=n.paragraph.previousWidget;if(n.currentWidget.isFirstLine()&&0===n.offset&&p instanceof r.u)return this.insertTableRows(d,p),void d.destroy();c=this.checkAndRemoveComments(),this.initHistory("InsertTable"),this.documentHelper.owner.isShiftingEnabled=!0,this.insertBlock(d),!i.i(a.isNullOrUndefined)(d.containerWidget)&&!i.i(a.isNullOrUndefined)(d.containerWidget.containerWidget)&&d.containerWidget.containerWidget instanceof r.a&&(d.containerWidget.containerWidget.height+=d.height,this.isTableInsert=!0);var u=this.documentHelper.getFirstParagraphInFirstCell(d).childWidgets[0];n.setPosition(u,!0),this.selection.end.setPositionInternal(n);var g=this.documentHelper.getLastParagraphInLastCell(d.getSplitWidgets().pop()),f=g.getLength()+1;this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.endPosition=this.selection.getHierarchicalIndex(g,f.toString())),this.reLayout(this.selection),this.isTableInsert=!1,this.updateHistoryForComments(c)}},e.prototype.insertRow=function(e,t){var i=e?"Above":"Below";if(!this.owner.isReadOnlyMode&&this.canEditContentControl){var n=this.selection.isForward?this.selection.start:this.selection.end;this.selection.isForward?this.selection.end:this.selection.start;if(n.paragraph.isInsideTable){this.checkIsNotRedoing()&&this.initHistory("Above"===i?"InsertRowAbove":"InsertRowBelow"),this.documentHelper.owner.isShiftingEnabled=!0;var r=this.getOwnerCell(this.selection.isForward).getSplitWidgets()[0],o=this.getOwnerCell(!this.selection.isForward).getSplitWidgets()[0],s=r.ownerTable.combineWidget(this.owner.viewer),a="Below"===i?o.ownerRow:r.ownerRow;if(this.editorHistory){this.cloneTableToHistoryInfo(s)}this.rowInsertion(t,i,r,o,a,s,!0)}this.reLayout(this.selection,!0)}},e.prototype.rowInsertion=function(e,t,n,o,s,l,d){var h=e||this.getRowCountToInsert(),c=[],p=s.rowIndex;if("Below"===t){p++;var u=i.i(a.isNullOrUndefined)(o.previousWidget)||o.columnIndex===o.previousWidget.columnIndex+1;o.cellIndex!==o.columnIndex&&u&&s.rowIndex+n.cellFormat.rowSpan-1===o.ownerRow.rowIndex||o.cellFormat.rowSpan>1&&!i.i(a.isNullOrUndefined)(s.nextWidget)&&s.nextWidget instanceof r.z&&(o.cellFormat.rowSpan+=h,s=s.nextWidget),s.bottomBorderWidth=0}for(var g=0;g<h;g++){var f=this.updateRowspan(s,"Below"===t?o:n,t),m=this.createRowAndColumn(f.count,g,p,l);m.rowFormat.copyFormat(s.rowFormat),this.owner.enableTrackChanges&&this.insertRevision(m.rowFormat,"Insertion"),this.updateCellFormatForInsertedRow(m,f.cellFormats),!i.i(a.isNullOrUndefined)(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&this.editorHistory.currentBaseHistoryInfo.insertedNodes.push(m),c.push(m)}l.insertTableRowsInternal(c,p,d);var v=void 0,y=void 0;if(l.childWidgets[p]instanceof r.z)v=l.childWidgets[p].firstChild,y=this.selection.getFirstParagraph(v);else{for(var w=void 0;!(w instanceof r.u);)w=l.nextRenderedWidget;y=this.documentHelper.getFirstParagraphInFirstCell(w)}d&&this.documentHelper.layout.reLayoutTable(l),this.selection.selectParagraphInternal(y,!0)},e.prototype.autoFitTable=function(e){!this.documentHelper.owner.isReadOnlyMode&&this.canEditContentControl&&this.insertAutoFitTable(e)},e.prototype.insertAutoFitTable=function(e,t){if(i.i(a.isNullOrUndefined)(t)){var n=this.selection.start,r=this.selection.end;this.selection.isForward||(n=this.selection.end,r=this.selection.start),t=this.selection.getTable(n,r),t=t.getSplitWidgets()[0]}var o=this.documentHelper.layout.getParentTable(t);i.i(a.isNullOrUndefined)(o)||(this.setOffsetValue(this.selection),o=o.combineWidget(this.owner.viewer),this.initHistory("FitToContents"===e?"TableAutoFitToContents":"FitToWindow"===e?"TableAutoFitToWindow":"TableFixedColumnWidth"),this.documentHelper.owner.editorHistoryModule&&this.cloneTableToHistoryInfo(o),o.updateProperties(!0,t,e),this.documentHelper.owner.isShiftingEnabled=!0,this.documentHelper.layout.reLayoutTable(t),this.reLayout(this.selection,!0))},e.prototype.rowInsertionForCE=function(e,t,i,n,o,s,a,l){for(var d=[],h=0;h<i;h++){var c=this.createRowAndColumn(t,h,e,n);this.documentHelper.owner.parser.parseRowFormat(o,c.rowFormat,0);for(var p=0;p<t;p++){var u=c.childWidgets[p];this.documentHelper.owner.parser.parseCellFormat(s[p],u.cellFormat,0),this.documentHelper.owner.parser.parseParagraphFormat(0,a[p],u.childWidgets[0].paragraphFormat),this.documentHelper.owner.parser.parseCharacterFormat(0,l[p],u.childWidgets[0].characterFormat)}this.owner.enableTrackChanges&&this.insertRevision(c.rowFormat,"Insertion"),d.push(c)}n.insertTableRowsInternal(d,e,!0);var g=void 0,f=void 0;if(n.childWidgets[e]instanceof r.z)g=n.childWidgets[e].firstChild,f=this.selection.getFirstParagraph(g);else{for(var m=void 0;!(m instanceof r.u);)m=n.nextRenderedWidget;f=this.documentHelper.getFirstParagraphInFirstCell(m)}this.documentHelper.layout.reLayoutTable(n),this.selection.selectParagraphInternal(f,!0),this.reLayout(this.selection,!0)},e.prototype.updateCellFormatForInsertedRow=function(e,t){for(var i=0;i<e.childWidgets.length;i++)e.childWidgets[i].cellFormat.copyFormat(t[i]),e.childWidgets[i].cellFormat.rowSpan=1},e.prototype.updateRowspan=function(e,t,n){for(var r=e.getPreviousRowSpannedCells(!0),o=0,s=[],l=0;l<e.childWidgets.length;l++){for(var d=e.childWidgets[l],h=!1,c=i.i(a.isNullOrUndefined)(d.previousWidget)||d.columnIndex!==d.previousWidget.columnIndex+1,p=0;p<r.length;p++)if(c){var u=r[p],g=u.ownerRow.rowIndex+u.cellFormat.rowSpan-1;if(d.columnIndex<u.columnIndex&&d.cellIndex!==d.columnIndex&&(h=!0,o++,s.push(d.cellFormat)),1===t.cellFormat.rowSpan)if(g>d.ownerRow.rowIndex){if("Above"===n&&u.ownerRow===t.ownerRow)continue;u.cellFormat.rowSpan+=1,r.splice(p,1),p--}else d.cellIndex!==d.columnIndex&&c&&g===d.ownerRow.rowIndex&&("Above"===n?(u.cellFormat.rowSpan+=1,r.splice(p,1),p--):(o++,s.push(u.cellFormat),r.splice(p,1),p--));else if(u!==t){if("Above"===n&&(u.ownerRow===t.ownerRow||u.columnIndex===t.columnIndex))continue;u.columnIndex!==t.columnIndex&&u.ownerRow.rowIndex!==d.ownerRow.rowIndex&&(g>t.ownerRow.rowIndex||"Above"===n&&g===t.ownerRow.rowIndex)&&(u.cellFormat.rowSpan+=1,r.splice(p,1),p--)}}-1===r.indexOf(d)&&d.cellFormat.rowSpan>1&&(h=!0),h||(o++,s.push(d.cellFormat))}return{count:o,cellFormats:s}},e.prototype.getInsertedTable=function(e,t){e.childWidgets&&e.childWidgets.length>0&&(e.childWidgets.splice(0,t),this.editorHistory.currentBaseHistoryInfo.insertedNodes.push(e))},e.prototype.insertTableRows=function(e,t){this.initHistory("InsertTableBelow"),e.containerWidget=t.containerWidget,t=t.combineWidget(this.owner.viewer);var i=t.childWidgets[t.childWidgets.length-1],n=t.childWidgets.length;t.insertTableRowsInternal(e.childWidgets,n,!0);var r=t.clone();this.getInsertedTable(r,n);var o=this.selection.getFirstParagraph(i.nextWidget.childWidgets[0]);t.isDefaultFormatUpdated=!1,this.documentHelper.layout.reLayoutTable(t),this.checkInsertPosition(this.selection)&&this.updateHistoryPosition(this.selection.getHierarchicalIndex(o,"0"),!0),this.selection.start.setPosition(o.firstChild,!0),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.updateHistoryPosition(this.selection.end,!1),this.selection.end.setPosition(o.firstChild,!0),this.reLayout(this.selection)},e.prototype.insertColumn=function(e,t){if(!this.owner.isReadOnlyMode&&this.canEditContentControl){var n=e?"Left":"Right";if(this.selection.start.paragraph.isInsideTable){this.checkIsNotRedoing()&&this.initHistory("Left"===n?"InsertColumnLeft":"InsertColumnRight"),this.selection.owner.isShiftingEnabled=!0;var r=this.getOwnerCell(this.selection.isForward),o=this.getOwnerCell(!this.selection.isForward),s=r.ownerRow.ownerTable.combineWidget(this.owner.viewer);this.editorHistory&&this.cloneTableToHistoryInfo(s),this.selection.owner.isLayoutEnabled=!1;var l=r.columnIndex;"Right"===n&&(l=o.columnIndex+o.cellFormat.columnSpan);for(var d=void 0,h=void 0,c=t||this.getColumnCountToInsert(),p=[],u=0;u<c;u++)for(var g=0;g<s.childWidgets.length;g++){var f=s.childWidgets[g];h=this.createColumn(this.selection.getLastParagraph(r)),h.index=g,h.rowIndex=f.rowIndex,h.containerWidget=f,h.cellFormat.copyFormat(r.cellFormat),h.cellFormat.rowSpan=1,i.i(a.isNullOrUndefined)(d)&&(d=this.selection.getFirstParagraph(h)),0===l?f.childWidgets.splice(l,0,h):this.insertSpannedCells(f,p,h,l),this.copyCellFormats(f,l),this.editorHistory.currentBaseHistoryInfo.insertedNodes.push(h)}this.tableReLayout(s,d,h)}}},e.prototype.cellInsertionForCE=function(e,t,i,n,o){var s=void 0;s=this.createColumn(void 0);var a=new r.p(s.childWidgets[0]);s.childWidgets[0].childWidgets.push(a),s.index=t.index,s.rowIndex=t.rowIndex,s.containerWidget=t,this.documentHelper.owner.parser.parseCellFormat(i,s.cellFormat,0),this.documentHelper.owner.parser.parseParagraphFormat(0,n,s.childWidgets[0].paragraphFormat),this.documentHelper.owner.parser.parseCharacterFormat(0,o,s.childWidgets[0].characterFormat),s.cellFormat.rowSpan=1,t.childWidgets.splice(e,0,s)},e.prototype.copyCellFormats=function(e,t){var n=e.childWidgets[t];if(!i.i(a.isNullOrUndefined)(n)){var o=n.childWidgets[0];t==e.childWidgets.length-1?--t:++t;for(var s=e.childWidgets[t],l=s.childWidgets[0];l instanceof r.u;)l=l.childWidgets[0].childWidgets[0].childWidgets[0];var d=s.childWidgets[0],h=void 0,c=void 0;d.childWidgets.length>0&&(h=d.childWidgets[0],h.children.length>0&&(c=h.children[0])),o.paragraphFormat.copyFormat(d.paragraphFormat),i.i(a.isNullOrUndefined)(c)?o.characterFormat.copyFormat(d.characterFormat):o.characterFormat.copyFormat(c.characterFormat)}},e.prototype.tableReLayout=function(e,t,n){e.updateRowIndex(0);var r=this.documentHelper.layout.getParentTable(e);r?r.fitChildToClientArea():e.fitChildToClientArea(),this.selection.owner.isLayoutEnabled=!0,e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0,this.documentHelper.skipScrollToPosition=!0,this.documentHelper.layout.reLayoutTable(e),this.selection.start.setPosition(t.firstChild,!0),this.selection.end.setPosition(this.selection.getLastParagraph(n).firstChild,!1),(this.checkIsNotRedoing()||i.i(a.isNullOrUndefined)(this.editorHistory))&&this.reLayout(this.selection)},e.prototype.createTable=function(e,t){var i=(this.selection.start.paragraph,new r.u);i.tableFormat.preferredWidthType="Auto",i.tableFormat.leftIndent=this.selection.start.paragraph.leftIndent,i.tableFormat.initializeTableBorders();for(var n=0;n<e;){var o=this.createRowAndColumn(t,n);o.rowFormat.heightType="Auto",this.owner.enableTrackChanges&&this.insertRevision(o.rowFormat,"Insertion"),o.containerWidget=i,i.childWidgets.push(o),n++}return i},e.prototype.createRowAndColumn=function(e,t,n,o){var s=o,d=this.selection.start.paragraph,h=new r.z;h.rowFormat=new l.f(h),h.index=t;for(var c=0;c<e;c++){if(!i.i(a.isNullOrUndefined)(n)&&!i.i(a.isNullOrUndefined)(s))if(n&&n>0&&s.childWidgets[n-1]&&s.childWidgets[n-1].childWidgets[c]){for(var p=s.childWidgets[n-1].childWidgets[c].childWidgets[0];p instanceof r.u;)p=p.childWidgets[0].childWidgets[0].childWidgets[0];d=p}else if(0==n){for(var p=s.childWidgets[n].childWidgets[c].childWidgets[0];p instanceof r.u;)p=p.childWidgets[0].childWidgets[0].childWidgets[0];d=p}var u=this.createColumn(d,!0);u.index=c,u.rowIndex=t,u.containerWidget=h,h.childWidgets.push(u)}return h},e.prototype.createColumn=function(e,t){var n=new r.j,o=new r.g;if(t){o.paragraphFormat.copyFormat(e.paragraphFormat),o.paragraphFormat.leftIndent=0,o.paragraphFormat.firstLineIndent=0;var s=void 0;i.i(a.isNullOrUndefined)(e.childWidgets[0])||(s=e.childWidgets[0].children[0]),i.i(a.isNullOrUndefined)(s)?o.characterFormat.copyFormat(e.characterFormat):o.characterFormat.copyFormat(s.characterFormat)}return o.containerWidget=n,n.childWidgets.push(o),n.cellFormat=new l.H(n),n},e.prototype.getColumnCountToInsert=function(){var e=1,t=this.selection.start,i=this.selection.end;if(this.selection.isForward||(t=this.selection.end,i=this.selection.start),t&&i&&this.selection.getTable(t,i)){if(t.paragraph.associatedCell===i.paragraph.associatedCell)return e=1;if(t.paragraph.associatedCell.ownerRow===i.paragraph.associatedCell.ownerRow)return e=e+i.paragraph.associatedCell.cellIndex-t.paragraph.associatedCell.cellIndex;e=0;for(var n=t.paragraph.associatedCell.ownerTable.getColumnCellsForSelection(t.paragraph.associatedCell,i.paragraph.associatedCell),r=0;r<n.length;r++)t.paragraph.associatedCell.ownerRow===n[r].ownerRow&&e++}return 0===e?1:e},e.prototype.getRowCountToInsert=function(){var e=1,t=this.selection.start,n=this.selection.end;return this.selection.isForward||(t=this.selection.end,n=this.selection.start),i.i(a.isNullOrUndefined)(t)||i.i(a.isNullOrUndefined)(n)||i.i(a.isNullOrUndefined)(this.selection.getTable(t,n))?0===e?1:e:e=t.paragraph.associatedCell===n.paragraph.associatedCell||t.paragraph.associatedCell.ownerRow===n.paragraph.associatedCell.ownerRow?1:e+this.getOwnerRow(!this.selection.isForward).rowIndex-this.getOwnerRow(this.selection.isForward).rowIndex},e.prototype.getOwnerCell=function(e){var t=void 0,n=e?this.selection.start.paragraph.associatedCell:this.selection.end.paragraph.associatedCell,o=e?this.selection.end.paragraph.associatedCell:this.selection.start.paragraph.associatedCell;t=n;for(var s=t.ownerTable;!i.i(a.isNullOrUndefined)(s)&&s.containerWidget instanceof r.j&&s!==o.ownerTable;)t=s.containerWidget,s=t.ownerTable;return t},e.prototype.getOwnerRow=function(e){var t,n=e?this.selection.start.paragraph.associatedCell.ownerRow:this.selection.end.paragraph.associatedCell.ownerRow,o=e?this.selection.end.paragraph.associatedCell.ownerRow:this.selection.start.paragraph.associatedCell.ownerRow;t=n;for(var s=t.ownerTable;!i.i(a.isNullOrUndefined)(s)&&s.containerWidget instanceof r.j&&s!==o.ownerTable;)t=s.containerWidget.ownerRow,s=t.ownerTable;return t},e.prototype.getOwnerTable=function(e){var t=void 0,i=this.selection.start.paragraph.associatedCell.ownerTable,n=this.selection.end.paragraph.associatedCell.ownerTable;for(t=e?i:n;t.containerWidget instanceof r.j&&t!==(e?n:i);)t=t.containerWidget.ownerTable;return t},e.prototype.mergeSelectedCellsInTable=function(){if(this.canMergeCells())if(this.owner.enableTrackChanges){var e=new a.L10n("documenteditor",this.owner.defaultLocale);e.setLocale(this.owner.locale),this.alertDialog=w.DialogUtility.alert({title:e.getConstant("UnTrack"),content:e.getConstant("Merge Track"),showCloseIcon:!0,okButton:{text:"Ok",click:this.confirmCellMerge.bind(this)},closeOnEscape:!0,position:{X:"center",Y:"center"},animationSettings:{effect:"Zoom"}}),this.alertDialog.enableRtl=this.owner.enableRtl}else this.confirmCellMerge()},e.prototype.confirmCellMerge=function(){this.checkIsNotRedoing()&&this.initHistory("MergeCells"),this.selection.owner.isShiftingEnabled=!0;var e=this.selection.start,t=this.selection.end;this.selection.isForward||(e=this.selection.end,t=this.selection.start);var n=this.getOwnerCell(this.selection.isForward),r=this.getOwnerCell(!this.selection.isForward),o=this.selection.getContainerCellOf(n,r);if(o.ownerTable.contains(r)&&!this.selection.containsCell(o,r)){var s=n.ownerTable.combineWidget(this.owner.viewer);n=this.selection.getSelectedCell(n,o),r=this.selection.getSelectedCell(r,o);var l=this.mergeSelectedCells(s,n,r),d=this.selection.getFirstParagraph(l);e.setPosition(d.firstChild,!0);var h=this.selection.getLastParagraph(l);t.setPosition(h.lastChild,!1),this.selection.fireSelectionChanged(!1)}(this.checkIsNotRedoing()||i.i(a.isNullOrUndefined)(this.editorHistory))&&this.reLayout(this.selection,!1),i.i(a.isNullOrUndefined)(this.alertDialog)||(this.alertDialog.close(),this.alertDialog=void 0)},e.prototype.mergeSelectedCells=function(e,t,n){this.cloneTableToHistoryInfo(e);this.selection.owner.isLayoutEnabled=!1;var o=this.selection.getCellLeft(t.ownerRow,t),l=o+t.cellFormat.cellWidth,d=this.selection.getCellLeft(n.ownerRow,n),h=d+n.cellFormat.cellWidth,c=this.updateSelectedCellsInTable(o,l,d,h);o=c.start,l=c.end;for(var p,u=e.childWidgets.indexOf(n.ownerRow),g=e.childWidgets.indexOf(t.ownerRow),f=void 0,m=g;m<=u;m++){for(var v=e.childWidgets[m],y=0;y<v.childWidgets.length;y++){var w=v.childWidgets[y],b=this.selection.getCellLeft(v,w);if(s.a.round(o,2)<=s.a.round(b,2)&&s.a.round(b,2)<s.a.round(l,2)){var x=w.lastChild;if(x instanceof r.g&&x.isEmpty()&&w.childWidgets.pop(),i.i(a.isNullOrUndefined)(f))f=w,p=x;else{m===g&&(f.cellFormat.preferredWidth+=w.cellFormat.preferredWidth,f.cellFormat.columnSpan+=w.cellFormat.columnSpan,this.mergeBorders(f,w));for(var C=0;C<w.childWidgets.length;C++){var I=w.childWidgets[C],F=I.clone();F.containerWidget=f,f.childWidgets.push(F)}v.childWidgets.splice(y,1),w.destroy(),y--;for(var k=this.documentHelper.contentControlCollection.length-1;k>-1;k--){var P=this.documentHelper.contentControlCollection[k];i.i(a.isNullOrUndefined)(P.contentControlProperties)&&this.documentHelper.contentControlCollection.splice(k)}}}}if((0===f.childWidgets.length||1===f.childWidgets.length&&f.childWidgets[0]instanceof r.u)&&p){var F=p.clone();f.childWidgets.push(F),F.containerWidget=f}if(0===v.childWidgets.length){var T=e.childWidgets.indexOf(v);v.updateRowBySpannedCells(),e.childWidgets.splice(T,1),v.destroy(),u--,m--}}return!i.i(a.isNullOrUndefined)(f)&&g<u&&(f.cellFormat.rowSpan=u-g+1),this.updateBlockIndexAfterMerge(f),e.updateRowIndex(0),e.calculateGrid(),e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0,this.documentHelper.layout.reLayoutTable(e),this.selection.owner.isLayoutEnabled=!0,f},e.prototype.mergeBorders=function(e,t){var n=void 0,r=null;if(i.i(a.isNullOrUndefined)(e.cellFormat.borders)||(n=e.cellFormat.borders),i.i(a.isNullOrUndefined)(t.cellFormat.borders)||(r=t.cellFormat.borders),!i.i(a.isNullOrUndefined)(n)||!i.i(a.isNullOrUndefined)(r))if(i.i(a.isNullOrUndefined)(n))n=new l.I(e.cellFormat),n.copyFormat(r);else{if(i.i(a.isNullOrUndefined)(r))return;e.ownerRow.rowIndex===t.ownerRow.rowIndex&&(n.top=e.getBorderBasedOnPriority(n.top,r.bottom),n.bottom=e.getBorderBasedOnPriority(n.bottom,r.bottom))}},e.prototype.updateBlockIndexAfterMerge=function(e){for(var t=0;t<e.childWidgets.length;t++)e.childWidgets[t].index=t},e.prototype.canMergeCells=function(){if(this.selection.isEmpty||!this.selection.start.paragraph.isInsideTable||!this.selection.end.paragraph.isInsideTable)return!1;this.selection.start,this.selection.end;this.selection.isForward||(this.selection.end,this.selection.start);var e=this.getOwnerCell(this.selection.isForward),t=this.getOwnerCell(!this.selection.isForward),n=this.selection.getContainerCellOf(e,t);if(n.ownerTable.contains(t)&&!this.selection.containsCell(n,t)){e=this.selection.getSelectedCell(e,n),t=this.selection.getSelectedCell(t,n);var r=1;if(e.ownerRow===t.ownerRow){for(var o=e.ownerRow.childWidgets.indexOf(e),s=o;s<=e.ownerRow.childWidgets.indexOf(t);s++){var l=e.ownerRow.childWidgets[s],d=l.previousWidget;if(s!==o){if(l.cellFormat.rowSpan!==r)return!1;if(!i.i(a.isNullOrUndefined)(d)&&l.columnIndex!==d.cellFormat.columnSpan+d.columnIndex)return!1}r=l.cellFormat.rowSpan}return!0}return this.canMergeSelectedCellsInTable(e.ownerTable,e,t)}return!1},e.prototype.canMergeSelectedCellsInTable=function(e,t,n){var r=e.childWidgets.indexOf(n.ownerRow),o=e.childWidgets.indexOf(t.ownerRow),l=this.selection.getCellLeft(t.ownerRow,t),d=l+t.cellFormat.cellWidth,h=this.selection.getCellLeft(n.ownerRow,n),c=h+n.cellFormat.cellWidth,p=this.updateSelectedCellsInTable(l,d,h,c);l=p.start,d=p.end;for(var u=0,g=0,f=!1,m=!1,v=[],y=o;y<=r;y++){for(var w=e.childWidgets[y],b=0,x=0,C=!1,I=0;I<w.childWidgets.length;I++){var F=w.childWidgets[I],k=this.selection.getCellLeft(w,F);if(this.checkCellWithInSelection(l,d,k)){f=!1,m=!1,F.cellFormat.rowSpan>1&&v.push(F),C||(b=k,x=k,C=!0);var P=F.previousWidget;0!==x&&s.a.round(x,0)!==s.a.round(k,0)&&(x=k),x+=s.a.convertPointToPixel(F.cellFormat.cellWidth);var T=this.checkPrevOrNextCellIsWithinSel(l,d,F,!0),S=this.checkPrevOrNextCellIsWithinSel(l,d,F,!1),W=0===v.length||1===v.length&&v[0]===F,N=this.checkCurrentCell(v,F,T,S);if(y===r&&!i.i(a.isNullOrUndefined)(P)&&F.cellFormat.rowSpan>P.cellFormat.rowSpan&&!N)return!1;if(y!==o)for(var H=0;H<v.length;H++){var E=v[H].ownerRow.rowIndex+v[H].cellFormat.rowSpan-1;if(E>=w.rowIndex){if(v[H].columnIndex>F.columnIndex?m=!0:f=!0,y===r&&v[H]!==F&&E>F.ownerRow.rowIndex+F.cellFormat.rowSpan-1)return!1;E!==w.rowIndex||this.checkPrevOrNextCellIsWithinSel(l,d,F,!1)||v.splice(v.indexOf(v[H]),1)}}if(T&&!i.i(a.isNullOrUndefined)(P)&&W&&F.columnIndex!==P.columnIndex+1&&this.checkCellWidth(F))return!1}}if(y===o)u=b,g=x;else{if(x>0&&b>0&&(!f&&Math.round(u)!==Math.round(b)||!m&&Math.round(g)!==Math.round(x)))return!1;if(y===r)return!0}}return!1},e.prototype.checkCellWidth=function(e){var t=e.previousWidget,i=this.documentHelper.selection.getCellLeft(e.ownerRow,e),n=this.documentHelper.selection.getCellLeft(e.ownerRow,t),r=n+s.a.convertPointToPixel(t.cellFormat.cellWidth);return s.a.round(r,2)!==s.a.round(i,2)},e.prototype.checkCellWithInSelection=function(e,t,i){return s.a.round(e,2)<=s.a.round(i,2)&&s.a.round(i,2)<s.a.round(t,2)},e.prototype.checkPrevOrNextCellIsWithinSel=function(e,t,n,r){var o=r?n.previousWidget:n.nextWidget,s=0;return!i.i(a.isNullOrUndefined)(o)&&(s=this.documentHelper.selection.getCellLeft(o.ownerRow,o),this.checkCellWithInSelection(e,t,s))},e.prototype.checkCurrentCell=function(e,t,i,n){var r=t.ownerRow;if(e.length>0)for(var o=0;o<e.length;o++){var s=e[o].ownerRow,a=s.rowIndex+e[o].cellFormat.rowSpan-1;if(e[o]===t&&(1===e.length||this.checkRowSpannedCells(e,t))&&!n&&!i)return!0;if(e[o]!==t&&s.rowIndex<r.rowIndex&&a===r.rowIndex+t.cellFormat.rowSpan-1)return!0}return!1},e.prototype.checkRowSpannedCells=function(e,t){for(var i=0;i<e.length;i++)if(e[i]!==t&&e[i].columnIndex===t.columnIndex)return!0;return!1},e.prototype.insertNewParagraphWidget=function(e,t){if(this.updateInsertPosition(),this.insertParagraph(e,t),!t){var n=void 0,r=e;do{n=this.selection.getNextParagraphBlock(r),r=n}while(n&&n.equals(e));i.i(a.isNullOrUndefined)(n)?this.selection.selectParagraphInternal(e,!0):this.selection.selectParagraphInternal(n,!0)}this.fireContentChange()},e.prototype.insertParagraph=function(e,t){var i=this.selection.start.currentWidget,n=this.selection.start.offset;this.editorHistory&&this.editorHistory.isUndoing&&"InsertTextParaReplace"===this.editorHistory.currentBaseHistoryInfo.action&&(n=0);var r=this.selection.start.paragraph;if(r=r.combineWidget(this.owner.viewer),t){var o=this.selection.getLineLength(r.lastChild),s=e.firstChild?e.firstChild.children.length:0;this.moveInlines(r,e,s,n,i,o,r.lastChild)}else n>0&&this.moveInlines(r,e,0,0,r.firstChild,n,i);var a=r.getSplitWidgets();r=t?a[a.length-1]:a[0];var l=r.containerWidget.childWidgets.indexOf(r);t&&l++;var d=r.containerWidget;e.index=r.index,e.containerWidget=d,d.childWidgets.splice(l,0,e),this.constructRevisionsForBlock(e,!0),this.updateNextBlocksIndex(t?r:e,!0),e.height=0,this.documentHelper.layout.layoutBodyWidgetCollection(e.index,d,e,!1)},e.prototype.moveInlines=function(e,t,i,n,o,s,a,l){if(0===t.childWidgets.length){var d=new r.p(t);t.childWidgets.push(d)}var h=!1;this.documentHelper.layout.clearListElementBox(e),this.documentHelper.layout.clearListElementBox(t);for(var c=0;c<e.childWidgets.length;c++){var p=e.childWidgets[c];if(o===p&&a===p){i=this.moveContent(p,n,s,i,t);break}if(a===p){i=this.moveContent(p,0,s,i,t);break}o===p?(h=!0,i=this.moveContent(p,n,this.documentHelper.selection.getLineLength(p),i,t)):h&&(i=this.moveContent(p,0,this.documentHelper.selection.getLineLength(p),i,t))}this.removeEmptyLine(e),e.isInsideTable||l||(this.viewer.updateClientArea(e.bodyWidget,e.bodyWidget.page),this.documentHelper.layout.reLayoutParagraph(e,0,0))},e.prototype.moveContent=function(e,t,i,n,o){for(var s=0,a=0;a<e.children.length;a++){var l=e.children[a];if(t>=s+l.length||l instanceof r.q)l instanceof r.q||(s+=l.length);else{var d=0;t>s&&(d=t-s);var h=i-s;if(h>l.length&&(h=l.length),d>0&&(s+=d),0===d&&h===l.length){if(l instanceof r.v){var c=e.paragraph.floatingElements.indexOf(l);-1!==c&&e.paragraph.floatingElements.splice(c,1)}o.firstChild.children.splice(n,0,l),l.line=o.firstChild,n++,e.children.splice(a,1),a--}else if(l instanceof r.d){var p=new r.d;p.characterFormat.copyFormat(l.characterFormat),p.text=l.text.substr(d,h-d),l.ischangeDetected=!0,p.ischangeDetected=!0,o.firstChild.children.splice(n,0,p),p.line=o.firstChild,n++,this.updateRevisionForMovedContent(l,p),l.text=l.text.slice(0,d)+l.text.slice(h),l.ischangeDetected=!0}if(i<=s+h-d)break;s+=h-d}}return n},e.prototype.updateRevisionForMovedContent=function(e,t){for(var i=0;i<e.revisions.length;i++){var n=e.revisions[i],r=n.range.indexOf(e);t.revisions.splice(0,0,n),n.range.splice(r,0,t),this.owner.trackChangesPane.updateCurrentTrackChanges(n)}},e.prototype.updateComplexWithoutHistory=function(e,t,i){var r=this.documentHelper.selection;if(0===e){var o=new n.a(r.owner);this.setPositionForCurrentIndex(o,t),this.documentHelper.layout.reLayoutParagraph(o.paragraph,0,0),this.setPositionForCurrentIndex(r.start,i),this.setPositionForCurrentIndex(r.end,i)}if(1===e){var o=new n.a(r.owner);this.setPositionForCurrentIndex(o,t);var s=new n.a(r.owner);this.setPositionForCurrentIndex(s,i),this.documentHelper.layout.reLayoutParagraph(o.paragraph,0,0),s.paragraph!==o.paragraph&&this.documentHelper.layout.reLayoutParagraph(s.paragraph,0,0)}r.owner.isShiftingEnabled&&(this.documentHelper.layout.shiftLayoutedItems(!1),this.documentHelper.owner.enableHeaderAndFooter&&this.updateHeaderFooterWidget()),r.owner.isShiftingEnabled=!1,r.start.updatePhysicalPosition(!0),r.isEmpty?r.end.setPositionInternal(r.start):r.end.updatePhysicalPosition(!0),r.upDownSelectionLength=r.end.location.x,r.fireSelectionChanged(!0),this.documentHelper.updateFocus(),this.owner.viewer.updateScrollBars(),this.fireContentChange(),this.isHandledComplex=!0},e.prototype.reLayout=function(e,t,n){if(!i.i(a.isNullOrUndefined)(this.previousBlockToLayout)){var o=this.previousBlockToLayout;this.documentHelper.layout.layoutBodyWidgetCollection(o.index,o.bodyWidget,o,!1,!1),this.previousBlockToLayout=void 0}if(this.documentHelper.isComposingIME||!this.editorHistory||!this.editorHistory.isHandledComplexHistory()||(this.editorHistory.currentHistoryInfo&&"ClearFormat"!==this.editorHistory.currentHistoryInfo.action&&"ApplyStyle"!==this.editorHistory.currentHistoryInfo.action&&("DragAndDropContent"===this.editorHistory.currentHistoryInfo.action&&this.documentHelper.layout.shiftLayoutedItems(!0),this.startParagraph=void 0,this.endParagraph=void 0),this.isHandledComplex=!1,this.editorHistory.currentHistoryInfo&&("ColumnBreak"===this.editorHistory.currentHistoryInfo.action||"PageBreak"===this.editorHistory.currentHistoryInfo.action))){if(i.i(a.isNullOrUndefined)(e.editRegionHighlighters)||e.editRegionHighlighters.clear(),i.i(a.isNullOrUndefined)(this.documentHelper.blockToShift)&&(this.documentHelper.removeEmptyPages(),this.documentHelper.layout.updateFieldElements(),this.owner.viewer.updateScrollBars(),e.owner.isShiftingEnabled&&!this.documentHelper.isRowOrCellResizing||(e.fireSelectionChanged(!0),this.startParagraph=void 0,this.endParagraph=void 0)),i.i(a.isNullOrUndefined)(t)&&(t=e.isEmpty),this.owner.showRevisions&&this.owner.trackChangesPane.isUpdateTrackChanges(this.owner.revisions.length)&&this.owner.trackChangesPane.updateTrackChanges(),e.owner.isShiftingEnabled){e.owner.isShiftingEnabled=!1,e.owner.isLayoutEnabled=!0;var s=e.start.paragraph.bodyWidget,l=s.getSplitWidgets();s=l[l.length-1];var d=!!(this.editorHistory&&this.editorHistory.currentHistoryInfo&&"ColumnBreak"===this.editorHistory.currentHistoryInfo.action&&this.documentHelper.layout.isMultiColumnDoc);if(!(!i.i(a.isNullOrUndefined)(s.nextRenderedWidget)&&"NoBreak"===s.nextRenderedWidget.sectionFormat.breakCode&&this.documentHelper.layout.isMultiColumnDoc||"NoBreak"===s.sectionFormat.breakCode&&s.sectionIndex===s.page.bodyWidgets[0].sectionIndex&&s.sectionFormat.numberOfColumns>1||d)||s instanceof r.x||!i.i(a.isNullOrUndefined)(s.containerWidget)&&s.containerWidget instanceof r.a)this.documentHelper.layout.shiftLayoutedItems(!0);else{var h=this.documentHelper.selection.start,c=this.documentHelper.selection.end,p=this.selection.getParagraphInfo(h),u=this.selection.getParagraphInfo(c),g=this.selection.getHierarchicalIndex(p.paragraph,p.offset.toString()),m=this.selection.getHierarchicalIndex(u.paragraph,u.offset.toString());this.documentHelper.layout.shiftLayoutedItems(!0),this.setPositionForCurrentIndex(h,g),this.setPositionForCurrentIndex(c,m),this.documentHelper.selection.selectPosition(h,c),this.owner.viewer.updateScrollBars()}this.documentHelper.owner.enableHeaderAndFooter&&this.updateHeaderFooterWidget(),this.documentHelper.isRowOrCellResizing||(i.i(a.isNullOrUndefined)(e.start.paragraph)||!i.i(a.isNullOrUndefined)(e.start.paragraph.bodyWidget.containerWidget)&&e.start.paragraph.bodyWidget.containerWidget instanceof r.a&&("Footnote"===e.start.paragraph.bodyWidget.containerWidget.footNoteType?(this.documentHelper.layout.isRelayoutFootnote=!0,this.shiftFootnotePageContent(e.start.paragraph.bodyWidget.containerWidget)):(this.documentHelper.layout.isRelayoutFootnote=!1,this.shiftFootnotePageContent())),this.getOffsetValue(e),e.upDownSelectionLength=e.end.location.x,e.fireSelectionChanged(!0),this.owner.enableAutoFocus&&this.documentHelper.updateFocus(),this.startParagraph=void 0,this.endParagraph=void 0)}else this.documentHelper.owner.enableHeaderAndFooter&&this.updateHeaderFooterWidget();this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&("RowResizing"!==this.editorHistory.currentBaseHistoryInfo.action&&"CellResizing"!==this.editorHistory.currentBaseHistoryInfo.action||this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&(this.editorHistory.currentBaseHistoryInfo.modifiedProperties.length>0&&this.editorHistory.currentBaseHistoryInfo.updateSelection(),this.editorHistory.undoStack&&this.editorHistory.undoStack.length>0&&this.editorHistory.undoStack[this.editorHistory.undoStack.length-1]instanceof f.a&&this.editorHistory.undoStack[this.editorHistory.undoStack.length-1].modifiedActions&&this.editorHistory.undoStack[this.editorHistory.undoStack.length-1].modifiedActions[this.editorHistory.undoStack[this.editorHistory.undoStack.length-1].modifiedActions.length-1]===this.editorHistory.currentBaseHistoryInfo?this.editorHistory.currentBaseHistoryInfo=void 0:this.editorHistory.updateHistory()),n||(this.fireContentChange(),this.owner.enableLockAndEdit&&this.owner.viewer.updateScrollBars(),this.owner.documentHelper.layout.isRelayout=!1,this.isFootnoteElementRemoved=!1,this.isEndnoteElementRemoved=!1)}},e.prototype.updateHeaderFooterWidget=function(e){i.i(a.isNullOrUndefined)(e)&&(e=this.selection.start.paragraph.bodyWidget),this.updateHeaderFooterWidgetToPage(e),this.shiftPageContent(e.headerFooterType,e.sectionFormat)},e.prototype.updateHeaderFooterWidgetToPage=function(e){for(var t=(e.page,"EvenHeader"===e.headerFooterType||"EvenFooter"===e.headerFooterType),i="FirstPageHeader"===e.headerFooterType||"FirstPageFooter"===e.headerFooterType,n=0;n<this.documentHelper.pages.length;n++){var r=this.documentHelper.pages[n];!r.bodyWidgets[0].sectionFormat.differentFirstPage||!i||r.headerWidgetIn.headerFooterType!=e.headerFooterType&&r.footerWidgetIn.headerFooterType!=e.headerFooterType?r.bodyWidgets[0].sectionFormat.differentFirstPage&&(i||!i&&0==r.index||r.sectionIndex!=r.previousPage.sectionIndex)||(r.bodyWidgets[0].sectionFormat.differentOddAndEvenPages?t&&(n+1)%2==0?this.updateHeaderFooterWidgetToPageInternal(r,e,-1!==e.headerFooterType.indexOf("Header")):t||(n+1)%2==0||(n>0||!r.bodyWidgets[0].sectionFormat.differentFirstPage)&&this.updateHeaderFooterWidgetToPageInternal(r,e,-1!==e.headerFooterType.indexOf("Header")):this.updateHeaderFooterWidgetToPageInternal(r,e,-1!==e.headerFooterType.indexOf("Header"))):this.updateHeaderFooterWidgetToPageInternal(r,e,-1!==e.headerFooterType.indexOf("Header"))}},e.prototype.updateHeaderFooterWidgetToPageInternal=function(e,t,i){if(i?t!=e.headerWidgetIn&&t.page.headerWidget==e.headerWidget:t!=e.footerWidgetIn&&t.page.footerWidget==e.footerWidget){var n=t.clone();this.documentHelper.layout.clearBlockWidget(n.childWidgets,!0,!0,!0),n.page=e,n.parentHeaderFooter=t,this.owner.viewer.updateHFClientArea(n.sectionFormat,i),n=this.documentHelper.layout.layoutHeaderFooterItems(this.owner.viewer,n);var r=void 0;i?(r=e.headerWidgetIn,e.headerWidget=n):(r=e.footerWidgetIn,e.footerWidget=n),this.removeFieldInWidget(r),this.removeFieldInWidget(r,void 0,!0),r.destroy()}},e.prototype.removeFieldInWidget=function(e,t,n){i.i(a.isNullOrUndefined)(t)&&(t=!1);for(var r=0;r<e.childWidgets.length;r++)this.removeFieldInBlock(e.childWidgets[r],t,n)},e.prototype.removeFieldInBlock=function(e,t,n){if(e instanceof r.u){if(e.wrapTextAround&&!i.i(a.isNullOrUndefined)(e.bodyWidget)){var o=e.bodyWidget.floatingElements.indexOf(e);-1!==o&&e.bodyWidget.floatingElements.splice(o,1)}this.removeFieldTable(e,t,n)}else if(e instanceof r.z)for(var s=0;s<e.childWidgets.length;s++)this.removeFieldInWidget(e.childWidgets[s],t,n);else this.removeField(e,t,n)},e.prototype.removeFieldTable=function(e,t,i){for(var n=0;n<e.childWidgets.length;n++)for(var r=e.childWidgets[n],o=0;o<r.childWidgets.length;o++)this.removeFieldInWidget(r.childWidgets[o],t,i)},e.prototype.shiftFootnotePageContent=function(e){var t=this.documentHelper.pages[0].bodyWidgets[0];if(!i.i(a.isNullOrUndefined)(e)){var n=this.documentHelper.pages.indexOf(e.page);t=this.documentHelper.pages[n].bodyWidgets[0]}i.i(a.isNullOrUndefined)(t.page.footnoteWidget)||this.checkAndShiftFromBottom(t.page,t.page.footnoteWidget),i.i(a.isNullOrUndefined)(t.page.endnoteWidget),this.documentHelper.blockToShift&&(this.documentHelper.renderedLists.clear(),this.documentHelper.renderedLevelOverrides=[],this.documentHelper.layout.shiftLayoutedItems(!1))},e.prototype.shiftPageContent=function(e,t){var n;if(-1!==e.indexOf("First"))n=0;else if(t.differentOddAndEvenPages){var o=-1!==e.indexOf("Even");n=t.differentFirstPage?o?1:2:o?1:0}else 1===(n=t.differentFirstPage?1:0)&&1===this.documentHelper.pages.length&&(n=0);var l=this.documentHelper.pages[n].bodyWidgets[0];do{if(-1!==e.indexOf("Header")){var d=l.page.headerWidget,h=!d.isEmpty||d.isEmpty&&this.owner.enableHeaderAndFooter,c=l.firstChild,p=s.a.convertPointToPixel(t.topMargin),u=s.a.convertPointToPixel(t.headerDistance);if(h&&(p=Math.max(u+l.page.headerWidget.height,p)),c.y!==p&&"NoBreak"!==l.sectionFormat.breakCode){this.owner.viewer.updateClientArea(l,l.page),c=c.combineWidget(this.owner.viewer);var g=c.previousRenderedWidget;g&&(!c.containerWidget.equals(g.containerWidget)||g.containerWidget.lastChild instanceof r.g&&(g.containerWidget.lastChild.isEndsWithPageBreak||g.containerWidget.lastChild.isEndsWithColumnBreak)||(this.owner.viewer.cutFromTop(g.y+g.height),this.documentHelper.layout.updateContainerWidget(c,g.containerWidget,g.indexInOwner+1,!1))),this.documentHelper.blockToShift=c}}else this.checkAndShiftFromBottom(l.page,l.page.footerWidget);for(this.documentHelper.blockToShift&&(this.documentHelper.renderedLists.clear(),this.documentHelper.renderedLevelOverrides=[],this.documentHelper.layout.shiftLayoutedItems(!1));l;){var f=l;do{var m=l.getSplitWidgets();l=m[m.length-1].nextRenderedWidget}while(l&&f.page===l.page);if(l){if(0===n)break;if(l.page.index+1===0&&1===n||l.page.index+1!==0&&2===n)break;var v=l.page.nextPage;if(!i.i(a.isNullOrUndefined)(v)&&v.bodyWidgets[0].equals(l)){l=v.bodyWidgets[0];break}}}}while(l)},e.prototype.checkAndShiftFromBottom=function(e,t){var n,o=e.bodyWidgets[0];if(o.childWidgets.length>1){for(var s=0;s<o.childWidgets.length;s++){var l=o.childWidgets[s];if(l.y+l.height>t.y){n=l;break}if(!(t instanceof r.a)&&o.childWidgets.length-1===s&&l.y+l.height<t.y){n=l;break}}i.i(a.isNullOrUndefined)(n)||(this.owner.viewer.updateClientArea(o,e,!0),this.owner.viewer.cutFromTop(n.y),this.documentHelper.blockToShift=n)}},e.prototype.allowFormattingInFormFields=function(e){if("FormFieldsOnly"===this.documentHelper.protectionType&&this.selection.isInlineFormFillMode()&&!i.i(a.isNullOrUndefined)(this.owner.documentEditorSettings.formFieldSettings.formattingExceptions))for(var t=0;t<this.owner.documentEditorSettings.formFieldSettings.formattingExceptions.length;t++)if(e.toLowerCase()===this.owner.documentEditorSettings.formFieldSettings.formattingExceptions[t].toLowerCase())return!0;return!1},e.prototype.getContentControl=function(){for(var e=0;e<this.documentHelper.contentControlCollection.length;e++){var t=this.documentHelper.contentControlCollection[e],i=this.selection.getPosition(t),n=i.startPosition,r=i.endPosition,o=this.selection.start,s=this.selection.end;if(this.selection.isForward||(o=this.selection.end,s=this.selection.start),(o.isExistAfter(n)||o.isAtSamePosition(n))&&(s.isExistBefore(r)||s.isAtSamePosition(r)))return t}},e.prototype.checkPlainTextContentControl=function(){var e=this.selection.start,t=this.selection.end;this.selection.isForward||(t=this.selection.start,e=this.selection.end);var r=0,o=0,s=e.currentWidget.getInline(e.offset,r),l=t.currentWidget.getInline(t.offset,o);r=s.index,o=l.index;var d,h,c=s.element,p=l.element;if(c&&c.contentControlProperties&&"Text"===c.contentControlProperties.type||p&&p.contentControlProperties&&"Text"===p.contentControlProperties.type){if(c=this.getContentControl(),c.contentControlProperties&&!i.i(a.isNullOrUndefined)(c)){var u=c.line.getOffset(c,1);d=new n.a(this.owner),d.setPositionParagraph(c.line,u)}else d=e;if(p.contentControlProperties&&c.reference){p=c.reference;var g=p.line.getOffset(p,p.length);h=new n.a(this.owner),h.setPositionParagraph(p.line,g)}else h=t;this.selection.selectRange(d,h)}else e.paragraph.contentControlProperties&&"Text"===e.paragraph.contentControlProperties.type&&this.selection.selectParagraph()},e.prototype.onApplyCharacterFormat=function(e,t,n,r){var o=this.documentHelper.isFormFillProtectedMode&&this.documentHelper.selection.isInlineFormFillMode()&&this.allowFormattingInFormFields(e);if(!(this.restrictFormatting&&!o||this.selection.checkContentControlLocked(!0))){this.documentHelper.layout.isBidiReLayout=!0;var s=this.documentHelper.selection;if((!s.owner.isReadOnlyMode||o)&&s.owner.isDocumentLoaded){n=!i.i(a.isNullOrUndefined)(n)&&n,r=!i.i(a.isNullOrUndefined)(r)&&r;var l=e[0].toUpperCase()+e.slice(1),d=s.start.paragraph;d.childWidgets[d.childWidgets.length-1];if(this.checkPlainTextContentControl(),s.isEmpty&&"List"!==s.contextType&&!r)return s.skipFormatRetrieval=!0,s.end.isAtParagraphEnd?(this.initHistory(l),this.documentHelper.owner.isShiftingEnabled=!0,this.applyCharFormatValue(d.characterFormat,e,t,n),this.reLayout(this.documentHelper.selection),this.documentHelper.updateFocus()):s.fireSelectionChanged(!0),void(s.skipFormatRetrieval=!1);if("highlightColor"===e&&s.start.isInSameParagraph(s.end)){var h=s.start,c=s.end;if(this.selection.isForward||(c=s.start,h=s.end),c.offset===s.getLineLength(c.currentWidget)+1&&c.offset-1===h.offset)return}this.setOffsetValue(s),this.initHistory(l),"List"===s.contextType?this.applyCharacterFormatForListText(s,e,t,n):this.updateSelectionCharacterFormatting(e,t,n),this.documentHelper.layout.isBidiReLayout=!1}}},e.prototype.applyCharacterFormatForListText=function(e,t,n,r){var o=e.getListLevel(e.start.paragraph);if(!i.i(a.isNullOrUndefined)(o)){var s=o.characterFormat;switch(t){case"bold":this.applyListCharacterFormatByValue(e,s,"bold",!s.bold);break;case"italic":this.applyListCharacterFormatByValue(e,s,"italic",!s.italic);break;case"fontColor":this.applyListCharacterFormatByValue(e,s,"fontColor",n);break;case"fontFamily":this.applyListCharacterFormatByValue(e,s,"fontFamily",n);break;case"fontSize":this.applyListCharacterFormatByValue(e,s,"fontSize",n);break;case"highlightColor":this.applyListCharacterFormatByValue(e,s,"highlightColor",n);break;case"baselineAlignment":s.baselineAlignment===n&&(n="Normal"),this.applyListCharacterFormatByValue(e,s,"baselineAlignment",n);break;case"strikethrough":s.strikethrough===n&&(n="None"),this.applyListCharacterFormatByValue(e,s,"strikethrough",n);break;case"underline":s.underline===n&&(n="None"),this.applyListCharacterFormatByValue(e,s,"underline",n);break;case"characterFormat":this.applyListCharacterFormatByValue(e,s,void 0,n)}}},e.prototype.applyListCharacterFormatByValue=function(e,t,i,n){this.initHistory("ListCharacterFormat"),this.applyCharFormatValue(t,i,n,!1),this.editorHistory.updateHistory(),this.reLayout(e),this.fireContentChange()},e.prototype.updateListCharacterFormat=function(e,t,i){this.updateListTextSelRange(e,t,i,!1)},e.prototype.updateListTextSelRange=function(e,t,i,n){this.documentHelper.owner.isShiftingEnabled=!0;var r=e.start,o=e.end;e.isForward||(r=e.end,o=e.start),this.initHistoryPosition(e,r);var s=e.getListLevel(e.start.paragraph);this.applyCharFormatValue(s.characterFormat,t,i,n),this.startSelectionReLayouting(r.paragraph,e,r,o)},e.prototype.updateInsertPosition=function(){var e=this.documentHelper.selection,t=e.start;e.isForward||(t=e.end),!this.editorHistory||i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)||i.i(a.isNullOrUndefined)(t)||i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo.insertPosition)&&this.updateHistoryPosition(t,!0)},e.prototype.setOffsetValue=function(e){var t=this.selection.getParagraphInfo(e.start);this.startParagraph=t.paragraph,this.startOffset=t.offset,t=this.selection.getParagraphInfo(e.end),this.endParagraph=t.paragraph,this.endOffset=t.offset},e.prototype.toggleHighlightColor=function(e){var t=this.documentHelper.selection;(i.i(a.isNullOrUndefined)(e)||"NoColor"===e)&&(e="Yellow"),t.characterFormat.highlightColor===e&&(e="NoColor"),this.selection.characterFormat.highlightColor=e},e.prototype.toggleSubscript=function(){if(!this.owner.isReadOnlyMode&&!this.restrictFormatting){var e="Subscript"===this.selection.characterFormat.baselineAlignment?"Normal":"Subscript";this.selection.characterFormat.baselineAlignment=e}},e.prototype.toggleSuperscript=function(){if(!this.owner.isReadOnlyMode&&!this.restrictFormatting){var e="Superscript"===this.selection.characterFormat.baselineAlignment?"Normal":"Superscript";this.selection.characterFormat.baselineAlignment=e}},e.prototype.increaseIndent=function(){this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyParagraphFormat("leftIndent",this.documentHelper.defaultTabWidth,!0,!1)},e.prototype.decreaseIndent=function(){this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyParagraphFormat("leftIndent",-this.documentHelper.defaultTabWidth,!0,!1)},e.prototype.clearList=function(){this.selection.owner.editorModule.onApplyList(void 0)},e.prototype.applyBullet=function(e,t){this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.applyBulletOrNumbering(e,"Bullet",t)},e.prototype.applyNumbering=function(e,t){this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.applyBulletOrNumbering(e,t,"Verdana")},e.prototype.toggleBaselineAlignment=function(e){this.updateProperty(2,e)},e.prototype.clearFormattingInternal=function(e){var t=this.documentHelper.selection;this.setPreviousBlockToLayout(),this.initComplexHistory("ClearFormat"),(t.isEmpty||!i.i(a.isNullOrUndefined)(e)&&e)&&(t.start.moveToParagraphStartInternal(t,!1),t.end.moveToParagraphEndInternal(t,!1)),this.setOffsetValue(t),this.editorHistory&&this.editorHistory.initializeHistory("ClearCharacterFormat"),this.updateSelectionCharacterFormatting("ClearCharacterFormat",void 0,!1),this.getOffsetValue(t),this.editorHistory&&this.editorHistory.updateHistory(),this.setOffsetValue(t),this.editorHistory&&this.editorHistory.initializeHistory("ClearParagraphFormat"),this.updateParagraphFormatInternal("ClearParagraphFormat",void 0,!1),this.editorHistory&&this.editorHistory.updateHistory(),this.getOffsetValue(t),this.editorHistory&&!i.i(a.isNullOrUndefined)(this.editorHistory.currentHistoryInfo)&&this.editorHistory.updateComplexHistory(),this.startParagraph=void 0,this.endParagraph=void 0},e.prototype.clearFormatting=function(){this.clearFormattingInternal()},e.prototype.updateProperty=function(e,t){var n=this.selection;if((!this.owner.isReadOnlyMode&&!this.restrictFormatting||this.selection.isInlineFormFillMode())&&n.owner.isDocumentLoaded){var r=n.start;n.end;n.isForward||(r=n.end,n.start);var o=0,s=r.currentWidget.getInline(r.offset,o),l=s.element;o=s.index;var d=r.paragraph;if(i.i(a.isNullOrUndefined)(l)||l.length!==o||this.selection.isEmpty||(l=l.nextNode),1===e){var h="None";i.i(a.isNullOrUndefined)(l)?i.i(a.isNullOrUndefined)(d)||(h=d.characterFormat.underline):h=l.characterFormat.underline,this.selection.characterFormat.underline=t===h?"None":t}else{var c="Normal";i.i(a.isNullOrUndefined)(l)?i.i(a.isNullOrUndefined)(d)||(c=d.characterFormat.baselineAlignment):c=l.characterFormat.baselineAlignment,c===t&&(t="Normal"),this.selection.characterFormat.baselineAlignment=t}}},e.prototype.getCompleteStyles=function(){for(var e='{"styles":[',t=0,i=this.documentHelper.preDefinedStyles.keys;t<i.length;t++){var n=i[t];e+=this.documentHelper.preDefinedStyles.get(n)+","}return e.slice(0,-1)+"]}"},e.prototype.intializeDefaultStyles=function(){for(var e=this.owner.getStyleNames("Paragraph"),t=["Normal","Heading 1","Heading 2","Heading 3","Heading 4","Heading 5","Heading 6","Header","Footer"],i=t.filter(function(t){return-1===e.indexOf(t)}),n=0,r=i;n<r.length;n++){var o=r[n];this.createStyle(this.documentHelper.preDefinedStyles.get(o))}},e.prototype.createStyle=function(e,t){return this.createStyleIn(e,t).name},e.prototype.createStyleIn=function(e,t){var n=JSON.parse(e),r=this.documentHelper.styles.findByName(n.name),o=n.type;return i.i(a.isNullOrUndefined)(r)||i.i(a.isNullOrUndefined)(t)||!t?(void 0!==r&&(n.name=this.getUniqueStyleName(n.name)),this.documentHelper.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()),n,this.documentHelper.styles,!0)):o===r.type?this.setStyle(r,n):(n.name=this.getUniqueStyleName(n.name),this.documentHelper.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()),n,this.documentHelper.styles,!0)),this.owner.notify(u.v,{}),this.documentHelper.styles.findByName(n.name)},e.prototype.setStyle=function(e,t){if(!i.i(a.isNullOrUndefined)(t.basedOn)){var n=this.documentHelper.styles.findByName(t.basedOn);if(i.i(a.isNullOrUndefined)(n)){var r=this.getStyle(t.basedOn,JSON.parse(this.getCompleteStyles())),o=void 0;o=i.i(a.isNullOrUndefined)(r)||r.type!==t.type?"Paragraph"===t.type?JSON.parse('{"type":"Paragraph","name":"Normal","next":"Normal"}'):JSON.parse('{"type": "Character","name": "Default Paragraph Font"}'):r,e.basedOn=this.documentHelper.styles.findByName(o.name)}else n.type===t.type&&(e.basedOn=n)}if(!i.i(a.isNullOrUndefined)(t.next)&&"Paragraph"===t.type)if(t.next===t.name)e.next=e;else{var s=this.documentHelper.styles.findByName(t.next);i.i(a.isNullOrUndefined)(s)||s.type!==e.type?e.next=e:e.next=s}if(!i.i(a.isNullOrUndefined)(t.link)){var l=this.documentHelper.styles.findByName(t.link),d=void 0;if(i.i(a.isNullOrUndefined)(l)||"Character"!==l.type){var h={};h.characterFormat=t.characterFormat;void 0!==this.documentHelper.styles.findByName(t.name+" Char").name?h.name=this.getUniqueStyleName(t.name)+" Char":h.name=t.name+" Char",h.type="Character",h.basedOn="Default Paragraph Font",d=h,this.documentHelper.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()),d,this.documentHelper.styles),e.link=this.documentHelper.styles.findByName(d.name)}else this.documentHelper.owner.parser.parseCharacterFormat(0,t.characterFormat,l.characterFormat),e.link=l;if("Character"==t.type)for(var c=0;c<this.documentHelper.styles.length;c++){var p=this.documentHelper.styles.getItem(c),u=p.link,g=void 0===u?"":u.name;"Paragraph"===p.type&&g===t.link&&(i.i(a.isNullOrUndefined)(p.characterFormat)||this.documentHelper.owner.parser.parseCharacterFormat(0,t.characterFormat,p.characterFormat))}}i.i(a.isNullOrUndefined)(t.paragraphFormat)||this.documentHelper.owner.parser.parseParagraphFormat(0,t.paragraphFormat,e.paragraphFormat),i.i(a.isNullOrUndefined)(t.characterFormat)||this.documentHelper.owner.parser.parseCharacterFormat(0,t.characterFormat,e.characterFormat)},e.prototype.getStyle=function(e,t){for(var i=0;i<t.styles.length;i++)if(t.styles[i].name===e)return t.styles[i]},e.prototype.getUniqueStyleName=function(e){for(var t=this.getUniqueName(e),n=this.documentHelper.styles.findByName(t);!i.i(a.isNullOrUndefined)(n);)t=this.getUniqueStyleName(n.name),n=this.documentHelper.styles.findByName(t);return t},e.prototype.getUniqueName=function(e){var t=e.match(/\d+$/);return!i.i(a.isNullOrUndefined)(t)&&t.length>0?e.replace(t[0],(parseInt(t[0],10)+1).toString()):e+"_1"},e.prototype.updateSelectionCharacterFormatting=function(e,t,n){switch(i.i(a.isNullOrUndefined)(e)&&(e="CharacterFormat"),!i.i(a.isNullOrUndefined)(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.insertedFormat=t),e){case"bold":this.updateCharacterFormat("bold",t);break;case"italic":this.updateCharacterFormat("italic",t);break;case"fontColor":this.updateCharacterFormat("fontColor",t);break;case"fontFamily":this.updateCharacterFormat("fontFamily",t);break;case"fontSize":this.documentHelper.layout.isBidiReLayout=!1,this.updateCharacterFormatWithUpdate(this.documentHelper.selection,"fontSize",t,n);break;case"highlightColor":this.updateCharacterFormat("highlightColor",t);break;case"baselineAlignment":this.updateCharacterFormat("baselineAlignment",t);break;case"strikethrough":this.updateCharacterFormat("strikethrough",t);break;case"underline":this.updateCharacterFormat("underline",t);break;case"styleName":this.updateCharacterFormatWithUpdate(this.documentHelper.selection,"styleName",t,!0,!0);break;case"CharacterFormat":case"ClearCharacterFormat":this.updateCharacterFormat(void 0,t);break;case"allCaps":this.updateCharacterFormat("allCaps",t)}this.reLayout(this.documentHelper.selection)},e.prototype.updateCharacterFormat=function(e,t){this.updateCharacterFormatWithUpdate(this.documentHelper.selection,e,t,!1)},e.prototype.updateCharacterFormatWithUpdate=function(e,t,n,r,o){o=!i.i(a.isNullOrUndefined)(o)&&o,this.documentHelper.owner.isShiftingEnabled=!0;var s=e.start,l=e.end;if(e.isEmpty||e.isForward||(s=e.end,l=e.start),e.isEmpty&&o){var d=s.offset,h=s.clone(),c=l.clone();this.selection.selectCurrentWord(),d!==this.selection.start.offset&&d!==this.selection.end.offset-1||(this.selection.start=h,this.selection.end=c)}this.applyCharFormatSelectedContent(s.paragraph,e,s,l,t,n,r)},e.prototype.applyCharFormatSelectedContent=function(e,t,i,n,r,o,s){if(!i.paragraph.isInsideTable||n.paragraph.isInsideTable&&i.paragraph.associatedCell===n.paragraph.associatedCell&&!t.isCellSelected(i.paragraph.associatedCell,i,n))this.applyCharFormat(e,t,i,n,r,o,s);else{var a=void 0;i.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer),this.checkInsertPosition(t)&&this.updateHistoryPosition(i,!0),a=i.paragraph.associatedCell,this.applyCharFormatCell(a,t,i,n,r,o,s);var l=a.ownerTable;this.documentHelper.layout.layoutBodyWidgetCollection(l.index,l.containerWidget,l,!1)}},e.prototype.applyCharFormatForSelectedPara=function(e,t,i,n,r){for(var o=0;o<e.childWidgets.length;o++)for(var s=e.childWidgets[o],a=0;a<s.children.length;a++){var l=s.children[a];this.applyCharFormatValue(l.characterFormat,i,n,r)}this.applyCharFormatValue(e.characterFormat,i,n,r)},e.prototype.splittedLastParagraph=function(e){var t=e.getSplitWidgets();return t[t.length-1]},e.prototype.getNextParagraphForCharacterFormatting=function(e,t,n,o,s,l){var d=e.getSplitWidgets();e=d[d.length-1],e=this.documentHelper.selection.getNextRenderedBlock(e),i.i(a.isNullOrUndefined)(e)||(e instanceof r.g?this.applyCharFormat(e,this.documentHelper.selection,t,n,o,s,l):this.applyCharFormatForTable(0,e,this.documentHelper.selection,t,n,o,s,l))},e.prototype.applyCharFormat=function(e,t,n,o,s,l,d){e=e.combineWidget(this.owner.viewer);var h=0,c=t.getParagraphLength(e),p=-1!==e.childWidgets.indexOf(n.currentWidget)?e.childWidgets.indexOf(n.currentWidget):0,u=o.offset,g=-1!==e.childWidgets.indexOf(o.currentWidget)?e.childWidgets.indexOf(o.currentWidget):e.childWidgets.length-1;if(i.i(a.isNullOrUndefined)(t)||e===n.paragraph&&(h=n.offset),e.equals(o.paragraph)){var f=e.childWidgets[e.childWidgets.length-1];t.isParagraphLastLine(f)&&o.currentWidget===f&&(u===t.getLineLength(f)+1||t.isEmpty&&t.end.isAtParagraphEnd)&&this.applyCharFormatValue(e.characterFormat,s,l,d)}else{var f=e.childWidgets[e.childWidgets.length-1];"highlightColor"===s&&t.isParagraphLastLine(f)&&n.currentWidget===f&&n.offset===t.getLineLength(f)||this.applyCharFormatValue(e.characterFormat,s,l,d),u=c}for(var m=p;m<=g;m++){var v=e.childWidgets[m];m!==p&&(h=t.getStartLineOffset(v)),u=v===o.currentWidget?o.offset:t.getLineLength(v);for(var y=0,w=void 0,b=-1,x=!0,C=0;C<v.children.length;x?C++:C--){var I=v.children[C];if(!1,!(I instanceof r.q))if(w===I&&(w=void 0,C=b,b=-1,x=!0),h>=y+I.length)y+=I.length;else{var F=0;h>y&&(F=h-y);var k=u-y,P=I.length;k>P&&(k=P);var T=this.applyCharFormatInline(I,t,F,k,s,l,d);if(C+=T,u<=y+P)break;y+=P}}}var S=o.paragraph;this.documentHelper.layout.reLayoutParagraph(e,p,0),e.equals(S)||this.getNextParagraphForCharacterFormatting(e,n,o,s,l,d)},e.prototype.toggleBold=function(){if(!this.owner.isReadOnlyMode&&!this.restrictFormatting||this.selection.isInlineFormFillMode()){var e=this.getCurrentSelectionValue("bold");this.selection.characterFormat.bold=e}},e.prototype.toggleItalic=function(){if(!this.owner.isReadOnlyMode&&!this.restrictFormatting||this.selection.isInlineFormFillMode()){var e=this.getCurrentSelectionValue("italic");this.selection.characterFormat.italic=e}},e.prototype.changeCase=function(e){if(this.selection.characterFormat.allCaps="Uppercase"===e,!this.selection.isEmpty&&(!this.owner.isReadOnlyMode&&!this.restrictFormatting||this.selection.isInlineFormFillMode())){this.initHistory("Uppercase"),this.documentHelper.owner.isShiftingEnabled=!0;var t=this.selection,i=t.start,n=t.end;t.isForward||(i=t.end,n=t.start),this.changeSelectedTextCase(t,i,n,e),this.reLayout(t)}},e.prototype.changeSelectedTextCase=function(e,t,n,r,o){var s=this.selection.getParagraphInfo(t);e.editPosition=this.selection.getHierarchicalIndex(s.paragraph,s.offset.toString()),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.checkInsertPosition(e)&&this.updateHistoryPosition(t,!0);var l=this.editorHistory.isUndoing;l&&!i.i(a.isNullOrUndefined)(o)&&o.length>0&&(this.removedTextNodes=o);var d=n.selection.endOffset;this.changeTextCase(t.paragraph,e,t,n,r,l),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(n.selection.endOffset!==d&&(n=e.getTextPosBasedOnLogicalIndex(d)),this.checkEndPosition(e)&&this.updateHistoryPosition(n,!1),e.selectPosition(t,n))},e.prototype.changeTextCase=function(e,t,i,n,r,o){if(!i.paragraph.isInsideTable||n.paragraph.isInsideTable&&i.paragraph.associatedCell===n.paragraph.associatedCell&&!t.isCellSelected(i.paragraph.associatedCell,i,n))this.changeCaseParagraph(e,t,i,n,r,o);else{var s=void 0;i.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer),this.checkInsertPosition(t)&&this.updateHistoryPosition(i,!0),s=i.paragraph.associatedCell,this.changeCaseParaFormatInCell(s,i,n,r,o);var a=s.ownerTable;this.documentHelper.layout.layoutBodyWidgetCollection(a.index,a.containerWidget,a,!1)}},e.prototype.changeCaseParagraph=function(e,t,n,o,s,l){e=e.combineWidget(this.owner.viewer);var d=0,h=t.getParagraphLength(e),c=-1!==e.childWidgets.indexOf(n.currentWidget)?e.childWidgets.indexOf(n.currentWidget):0,p=o.offset,u=-1!==e.childWidgets.indexOf(o.currentWidget)?e.childWidgets.indexOf(o.currentWidget):e.childWidgets.length-1;i.i(a.isNullOrUndefined)(t)||e===n.paragraph&&(d=n.offset),e.equals(o.paragraph)||(p=h);for(var g=c;g<=u;g++){var f=e.childWidgets[g];g!==c&&(d=t.getStartLineOffset(f)),p=f===o.currentWidget?o.offset:t.getLineLength(f);for(var m=0,v=void 0,y=-1,w=!0,b=0;b<f.children.length;w?b++:b--){var x=f.children[b];if(!1,!(x instanceof r.q))if(v===x&&(v=void 0,b=y,y=-1,w=!0),d>=m+x.length)m+=x.length;else{var C=0;d>m&&(C=d-m);var I=p-m,F=x.length;I>F&&(I=F);var k=this.changeCaseInline(x,t,C,I,s,l);if(b+=k,p<=m+F)break;m+=F}}}var P=o.paragraph;this.documentHelper.layout.reLayoutParagraph(e,c,0),e.equals(P)||this.changeCaseNextBlock(e,n,o,s,l)},e.prototype.changeCaseInline=function(e,t,i,n,o,s){if(e instanceof r.d){if(0!==i||n!==e.length)return this.changeCaseInlineInternal(e,t,i,n,o,s);this.changeCaseInlineInternal(e,t,i,n,o,s)}return 0},e.prototype.addRemovedTextNodes=function(e,t){if(e instanceof r.d&&!i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)){var n=this.editorHistory.currentBaseHistoryInfo.removedNodes[0];i.i(a.isNullOrUndefined)(n)&&(n=new r.d,n.text="",this.editorHistory.currentBaseHistoryInfo.removedNodes.push(n)),n.text+=t}},e.prototype.changeCaseInlineInternal=function(e,t,i,n,o,s){var a,l=0,d=e.line.children.indexOf(e),h=e.paragraph;h.childWidgets.indexOf(e.line);if(i>0){var c=e.text.substr(i,n-i);this.addRemovedTextNodes(e,c),a=new r.d,a.characterFormat.copyFormat(e.characterFormat),a.line=e.line,a.text=this.getChangeCaseText(c,o,s),a.isRightToLeft=e.isRightToLeft,d++,e.line.children.splice(d,0,a),l++}n<e.length&&(a=new r.d,a.characterFormat.copyFormat(e.characterFormat),a.text=e.text.substring(n),a.line=e.line,a.isRightToLeft=e.isRightToLeft,d++,e.line.children.splice(d,0,a),l++);var p=e;if(0===i){var u=p.text.substr(0,n);this.addRemovedTextNodes(e,u),p.text=this.getChangeCaseText(u,o,s)}else{var g=p.text.substr(0,i);p.text=g}return l},e.prototype.changeCaseNextBlock=function(e,t,n,o,s){e=this.getNextBlockForChangeCase(e,t,n,o,s),i.i(a.isNullOrUndefined)(e)||(e instanceof r.g?this.changeCaseParagraph(e,this.documentHelper.selection,t,n,o,s):this.changeCaseForTable(0,e,this.documentHelper.selection,t,n,o,s))},e.prototype.getNextBlockForChangeCase=function(e,t,i,n,r){var o=e.getSplitWidgets();return e=o[o.length-1],e=this.documentHelper.selection.getNextRenderedBlock(e)},e.prototype.getChangeCaseText=function(e,t,n){if(n){if(!i.i(a.isNullOrUndefined)(this.removedTextNodes)&&this.removedTextNodes.length>0){var r=this.removedTextNodes[0],o=r.text.substr(0,e.length);r.text=r.text.substr(o.length,r.length-o.length),e=o,""===r.text&&this.removedTextNodes.splice(0,1)}}else switch(t){case"Uppercase":e=e.toUpperCase()}return e},e.prototype.changeCaseForTable=function(e,t,i,n,r,o,s){t=t.combineWidget(this.owner.viewer);for(var a=e;a<t.childWidgets.length;a++){for(var l=t.childWidgets[a],d=0;d<l.childWidgets.length;d++)this.changeCaseForSelectedCell(l.childWidgets[d],i,o,s);if(r.paragraph.isInsideTable&&i.containsRow(l,r.paragraph.associatedCell))return void this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1)}this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1),this.changeCaseNextBlock(t,n,r,o,s)},e.prototype.changeCaseForSelectedCell=function(e,t,i,n){for(var o=0;o<e.childWidgets.length;o++){var s=e.childWidgets[o];s instanceof r.g?this.changeCaseForSelectedPara(s,t,i,n):this.changeCaseForSelTable(s,t,i,n)}},e.prototype.changeCaseForSelectedPara=function(e,t,n,o){for(var s=0;s<e.childWidgets.length;s++)for(var l=e.childWidgets[s],d=0;d<l.children.length;d++){var h=l.children[d];!i.i(a.isNullOrUndefined)(h)&&h instanceof r.d&&(this.addRemovedTextNodes(h,h.text),h.text=this.getChangeCaseText(h.text,n,o))}},e.prototype.changeCaseForSelTable=function(e,t,i,n){for(var r=0;r<e.childWidgets.length;r++)for(var o=e.childWidgets[r],s=0;s<o.childWidgets.length;s++)this.changeCaseForSelectedCell(o.childWidgets[s],t,i,n)},e.prototype.changeCaseParaFormatInCell=function(e,t,i,n,r){var o=this.documentHelper.selection;if(i.paragraph.isInsideTable){var s=o.getContainerCellOf(e,i.paragraph.associatedCell);if(s.ownerTable.contains(i.paragraph.associatedCell)){var a=o.getSelectedCell(e,s),l=o.getSelectedCell(i.paragraph.associatedCell,s);o.containsCell(s,i.paragraph.associatedCell)?o.isCellSelected(s,t,i)?this.changeCaseParaForCellInternal(s,o,n,r):a===s?this.changeCaseParagraph(t.paragraph,o,t,i,n,r):this.changeCaseParaForRow(a.ownerRow,o,t,i,n,r):this.changeCaseParaForTableCell(s.ownerTable,s,l,n,r)}else this.changeCaseParaForRow(s.ownerRow,o,t,i,n,r)}else{var d=o.getContainerCell(e);this.changeCaseParaForRow(d.ownerRow,o,t,i,n,r)}},e.prototype.changeCaseParaForTableCell=function(e,t,i,n,r){var o=this.documentHelper.selection,s=o.getCellLeft(t.ownerRow,t),a=s+t.cellFormat.cellWidth,l=o.getCellLeft(i.ownerRow,i),d=l+i.cellFormat.cellWidth,h=this.updateSelectedCellsInTable(s,a,l,d);s=h.start,a=h.end;for(var c=e.childWidgets.indexOf(i.ownerRow),p=e.childWidgets.indexOf(t.ownerRow);p<=c;p++)for(var u=e.childWidgets[p],g=0;g<u.childWidgets.length;g++){var f=o.getCellLeft(u,u.childWidgets[g]);Math.round(s)<=Math.round(f)&&Math.round(f)<Math.round(a)&&this.changeCaseParaForCellInternal(u.childWidgets[g],o,n,r)}},e.prototype.changeCaseParaForCellInternal=function(e,t,i,n){for(var o=0;o<e.childWidgets.length;o++){var s=e.childWidgets[o];s instanceof r.g?this.changeCaseForSelectedPara(s,t,i,n):this.changeCaseParaFormatTableInternal(s,t,i,n)}},e.prototype.changeCaseParaFormatTableInternal=function(e,t,i,n){for(var r=0;r<e.childWidgets.length;r++)for(var o=e.childWidgets[r],s=0;s<o.childWidgets.length;s++)this.changeCaseParaForCellInternal(o.childWidgets[s],t,i,n)},e.prototype.changeCaseParaForRow=function(e,t,i,n,r,o){for(var s=e.rowIndex;s<e.ownerTable.childWidgets.length;s++){for(var a=e.ownerTable.childWidgets[s],l=0;l<a.childWidgets.length;l++)this.changeCaseParaForCellInternal(a.childWidgets[l],t,r,o);if(n.paragraph.isInsideTable&&this.documentHelper.selection.containsRow(a,n.paragraph.associatedCell))return}this.changeCaseNextBlock(e.ownerTable,i,n,r,o)},e.prototype.toggleAllCaps=function(){if(!this.documentHelper.owner.isReadOnlyMode||this.selection.isInlineFormFillMode()){var e=this.getCurrentSelectionValue("allCaps");this.selection.characterFormat.allCaps=e}},e.prototype.getCurrentSelectionValue=function(e){var t=!1;if("bold"===e||"italic"===e){var i=this.getSelectedCharacterFormat();"bold"===e&&(t=!i.bold),"italic"===e&&(t=!i.italic)}return t},e.prototype.getSelectedCharacterFormat=function(){var e=0,t=this.selection.start;this.selection.isForward||(t=this.selection.end);var n=t.currentWidget,r=n.getInline(t.offset,e),o=r.element;e=r.index;var s=n.paragraph.characterFormat;if(!i.i(a.isNullOrUndefined)(o))if(this.selection.isEmpty&&"List"===this.selection.contextType){var l=this.selection.getListLevel(this.selection.start.paragraph);l.characterFormat.uniqueCharacterFormat&&(s=l.characterFormat)}else s=this.selection.isEmpty||e!==o.length?o.characterFormat:i.i(a.isNullOrUndefined)(o.nextNode)?n.paragraph.characterFormat:o.nextNode.characterFormat;return s},e.prototype.toggleUnderline=function(e){(!this.owner.isReadOnlyMode&&!this.restrictFormatting||this.selection.isInlineFormFillMode())&&this.updateProperty(1,e)},e.prototype.toggleStrikethrough=function(e){if(!this.owner.isReadOnlyMode||this.selection.isInlineFormFillMode()){var t=void 0;t=i.i(a.isNullOrUndefined)(e)?"SingleStrike"===this.selection.characterFormat.strikethrough?"None":"SingleStrike":e,this.selection.characterFormat.strikethrough=t}},e.prototype.updateFontSize=function(e,t){if("number"==typeof t&&!(t<0&&1===e.fontSize))return e.fontSize+t;var i=[8,9,10,11,12,14,16,18,20,24,26,28,36,48,72];if("string"==typeof t&&"increment"===t){if(e.fontSize<8)return e.fontSize+1;if(e.fontSize>=72&&e.fontSize<80)return 80;if(e.fontSize>=80)return e.fontSize+10;for(var n=0;n<i.length;n++)if(e.fontSize<i[n])return i[n]}else if("string"==typeof t&&"decrement"===t&&e.fontSize>1){if(e.fontSize<=8)return e.fontSize-1;if(e.fontSize>72&&e.fontSize<=80)return 72;if(e.fontSize>80)return e.fontSize-10;for(var n=0;n<i.length;n++)if(e.fontSize<=i[n])return i[n-1]}return e.fontSize},e.prototype.applyCharFormatInline=function(e,t,i,n,o,s,a){return 0===i&&n===e.length?(this.applyCharFormatValue(e.characterFormat,o,s,a),0):e instanceof r.d?this.formatInline(e,t,i,n,o,s,a):0},e.prototype.formatInline=function(e,t,i,n,o,s,a){var l,d=0,h=e,c=e.line.children.indexOf(h),p=(e.paragraph,0);return i>0&&(p+=1,l=new r.d,l.characterFormat.copyFormat(e.characterFormat),l.line=e.line,l.text=e.text.substr(i,n-i),l.isRightToLeft=e.isRightToLeft,this.applyCharFormatValue(l.characterFormat,o,s,a),c++,h.line.children.splice(c,0,l),d++,this.updateRevisionForFormattedContent(e,l,p)),n<h.length&&(p+=1,l=new r.d,l.characterFormat.copyFormat(e.characterFormat),l.text=h.text.substring(n),l.line=e.line,l.isRightToLeft=e.isRightToLeft,c++,h.line.children.splice(c,0,l),d++,this.updateRevisionForFormattedContent(e,l,p)),0===i?(e.text=e.text.substr(0,n),this.applyCharFormatValue(e.characterFormat,o,s,a)):e.text=e.text.substr(0,i),d},e.prototype.updateRevisionForFormattedContent=function(e,t,i){for(var n=0;n<e.revisions.length;n++){var r=e.revisions[n],o=r.range.indexOf(e)+i;t.revisions.splice(0,0,r),r.range.splice(o,0,t),this.owner.trackChangesPane.updateCurrentTrackChanges(r)}},e.prototype.applyCharFormatCell=function(e,t,i,n,r,o,s){if(n.paragraph.isInsideTable){var a=t.getContainerCellOf(e,n.paragraph.associatedCell);if(a.ownerTable.contains(n.paragraph.associatedCell)){var l=t.getSelectedCell(e,a),d=t.getSelectedCell(n.paragraph.associatedCell,a);t.containsCell(a,n.paragraph.associatedCell)?t.isCellSelected(a,i,n)?(o=this.getCharacterFormatValueOfCell(e,t,o,r),this.applyCharFormatForSelectedCell(a,t,r,o,s)):l===a?this.applyCharFormat(i.paragraph,t,i,n,r,o,s):this.applyCharFormatRow(l.ownerRow,t,i,n,r,o,s):this.applyCharFormatForTableCell(a.ownerTable,t,a,d,r,o,s)}else this.applyCharFormatRow(a.ownerRow,t,i,n,r,o,s)}else{var h=t.getContainerCell(e);this.applyCharFormatRow(h.ownerRow,t,i,n,r,o,s)}},e.prototype.applyCharFormatForSelectedCell=function(e,t,i,n,o){for(var s=0;s<e.childWidgets.length;s++){var a=e.childWidgets[s];a instanceof r.g?this.applyCharFormatForSelectedPara(a,t,i,n,o):this.applyCharFormatForSelTable(a,t,i,n,o)}},e.prototype.applyCharFormatRow=function(e,t,i,n,r,o,s){o=this.getCharacterFormatValueOfCell(e.childWidgets[0],t,o,r),this.applyCharFormatForTable(e.rowIndex,e.ownerTable,t,i,n,r,o,s)},e.prototype.applyCharFormatForTable=function(e,t,i,n,r,o,s,a){t=t.combineWidget(this.owner.viewer);for(var l=e;l<t.childWidgets.length;l++){for(var d=t.childWidgets[l],h=0;h<d.childWidgets.length;h++)this.applyCharFormatForSelectedCell(d.childWidgets[h],i,o,s,a);if(r.paragraph.isInsideTable&&i.containsRow(d,r.paragraph.associatedCell))return void this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1)}this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1),this.getNextParagraphForCharacterFormatting(t,n,r,o,s,a)},e.prototype.applyCharFormatForSelTable=function(e,t,i,n,r){for(var o=0;o<e.childWidgets.length;o++)for(var s=e.childWidgets[o],a=0;a<s.childWidgets.length;a++)this.applyCharFormatForSelectedCell(s.childWidgets[a],t,i,n,r)},e.prototype.applyCharFormatForTableCell=function(e,t,i,n,r,o,a){var l=t.getCellLeft(i.ownerRow,i),d=l+i.cellFormat.cellWidth,h=t.getCellLeft(n.ownerRow,n),c=h+n.cellFormat.cellWidth,p=this.updateSelectedCellsInTable(l,d,h,c);l=p.start,d=p.end;for(var u=e.childWidgets.indexOf(n.ownerRow),g=!1,f=e.childWidgets.indexOf(i.ownerRow);f<=u;f++)for(var m=e.childWidgets[f],v=0;v<m.childWidgets.length;v++){var y=t.getCellLeft(m,m.childWidgets[v]);s.a.round(l,2)<=s.a.round(y,2)&&s.a.round(y,2)<s.a.round(d,2)&&(g||(o=this.getCharacterFormatValueOfCell(m.childWidgets[v],t,o,r),g=!0),this.applyCharFormatForSelectedCell(m.childWidgets[v],t,r,o,a))}},e.prototype.updateSelectedCellsInTable=function(e,t,i,n){var r=this.documentHelper.selection;return e>i&&(e=i),t<n&&(t=n),e>r.upDownSelectionLength&&(e=r.upDownSelectionLength),t<r.upDownSelectionLength&&(t=r.upDownSelectionLength),{start:e,end:t}},e.prototype.getCharacterFormatValueOfCell=function(e,t,i,n){if("boolean"==typeof i||void 0===i&&("bold"===n||"italic"===n)){var r=t.getFirstParagraph(e),o=r.characterFormat;r.childWidgets.length>0&&r.childWidgets[0].children.length>0&&(o=r.childWidgets[0].children[0].characterFormat),i=!o.getPropertyValue(n)}return i},e.prototype.applyCharFormatValueInternal=function(e,t,i,n){this.applyCharFormatValue(t,i,n,!1)},e.prototype.copyInlineCharacterFormat=function(e,t){t.uniqueCharacterFormat=e.uniqueCharacterFormat,t.baseCharStyle=e.baseCharStyle},e.prototype.applyCharFormatValue=function(e,t,n,s){if(s&&"fontSize"===t&&(n=this.updateFontSize(e,n)),this.editorHistory&&!i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&(n=this.editorHistory.currentBaseHistoryInfo.addModifiedProperties(e,t,n),this.editorHistory.currentBaseHistoryInfo.insertedFormat=n),n instanceof o.a)return void(this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)?this.copyInlineCharacterFormat(n,e):e.copyFormat(n));if(this.isForHyperlinkFormat&&this.owner.enableTrackChanges&&e.ownerBase instanceof r.c){var l=e.ownerBase,d=l.previousNode;if(i.i(a.isNullOrUndefined)(d)){var h=l.paragraph.previousWidget;if(!i.i(a.isNullOrUndefined)(h)&&!h.isEmpty()){var c=h.lastChild;d=c.children[c.children.length-1]}}for(;!(i.i(a.isNullOrUndefined)(d)||d instanceof r.d);)d=d.previousNode;if(!i.i(a.isNullOrUndefined)(d)&&d.revisions.length>0){var p=d.revisions[d.revisions.length-1];this.isRevisionAlreadyIn(l,p)||(l.revisions.push(p),p.range.push(l),this.owner.trackChangesPane.updateCurrentTrackChanges(p))}else this.insertRevision(l,"Insertion")}if(i.i(a.isNullOrUndefined)(n))return e.clearFormat(),void(i.i(a.isNullOrUndefined)(this.editorHistory)||i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)||(this.editorHistory.currentBaseHistoryInfo.insertedFormat=e[t]));"bold"===t?e.bold=n:"italic"===t?e.italic=n:"fontColor"===t?e.fontColor=n:"fontFamily"===t?(e.fontFamily=n,e.fontFamilyAscii=n,e.fontFamilyFarEast=n,e.fontFamilyNonFarEast=n,e.fontFamilyBidi=n):"fontSize"===t?e.fontSize=n:"highlightColor"===t?e.highlightColor=n:"baselineAlignment"===t?e.baselineAlignment=n:"strikethrough"===t?e.strikethrough=n:"underline"===t?e.underline=n:"styleName"===t?e.baseCharStyle=n:"allCaps"===t&&(e.allCaps=n)},e.prototype.onImageFormat=function(e,t,i,r){var o=new n.b(e);this.editorHistory&&(this.editorHistory.initializeHistory("ImageResizing"),this.editorHistory.currentBaseHistoryInfo.modifiedProperties.push(o),this.editorHistory.currentBaseHistoryInfo.insertedText=y.c.Image,this.editorHistory.currentBaseHistoryInfo.insertedData={width:s.a.convertPixelToPoint(t),height:s.a.convertPixelToPoint(i)}),this.setOffsetValue(this.selection),e.width=t,e.height=i,e.alternateText=r,this.documentHelper.layout.reLayoutParagraph(e.line.paragraph,e.line.indexInOwner,0),this.reLayout(this.selection,!1),this.documentHelper.owner.imageResizerModule&&this.documentHelper.owner.imageResizerModule.positionImageResizer(e)},e.prototype.toggleTextAlignment=function(e){this.documentHelper.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||!this.documentHelper.owner.isDocumentLoaded||(i.i(a.isNullOrUndefined)(this.documentHelper.selection.paragraphFormat.textAlignment)||this.documentHelper.selection.paragraphFormat.textAlignment!==e?this.onApplyParagraphFormat("textAlignment",e,!1,!0):"Left"===e?this.onApplyParagraphFormat("textAlignment","Justify",!1,!0):this.onApplyParagraphFormat("textAlignment","Left",!1,!0))},e.prototype.setPreviousBlockToLayout=function(){var e=this.documentHelper.selection.start;this.documentHelper.selection.isForward||(e=this.documentHelper.selection.end);var t=e.paragraph;if(t.paragraphFormat.keepWithNext){var n=t.bodyWidget;if(!i.i(a.isNullOrUndefined)(n)&&n instanceof r.o&&n.page){var o=n.page.previousPage;o&&(this.previousBlockToLayout=o.bodyWidgets[0].lastChild)}}},e.prototype.applyParagraphBorders=function(e,t,i){var n=new l.J;switch(e){case"color":n.color=i;break;case"lineWidth":n.lineWidth=i;break;case"lineStyle":n.lineStyle=i;break;case"shadow":n.shadow=i;break;case"space":n.space=i}this.onApplyParagraphFormat(t,n,!1,!1)},e.prototype.applyRulerMarkerValues=function(e,t,i){var n=s.a.convertPixelToPoint(i-t)/this.owner.zoomFactor;if("firstLineIndent"===e){var r=this.owner.selection.start.paragraph.paragraphFormat.firstLineIndent;this.onApplyParagraphFormat(e,r+n,!1,!1)}else if("hangingIndent"===e){var r=this.owner.selection.start.paragraph.paragraphFormat.firstLineIndent;this.onApplyParagraphFormat("firstLineIndent",r-n,!1,!1);var o=this.owner.selection.start.paragraph.paragraphFormat.leftIndent+r;r-=n,this.onApplyParagraphFormat("leftIndent",o-r,!1,!1,!0)}else if("leftIndent"===e){var r=this.owner.selection.start.paragraph.paragraphFormat.leftIndent;this.onApplyParagraphFormat(e,r+n,!1,!1)}else if("rightIndent"===e){var r=this.owner.selection.start.paragraph.paragraphFormat.rightIndent;this.onApplyParagraphFormat(e,r+n,!1,!1)}},e.prototype.onApplyParagraphFormat=function(e,t,n,r,o){var l=this.documentHelper.isFormFillProtectedMode&&this.documentHelper.selection.isInlineFormFillMode()&&this.allowFormattingInFormFields(e);if(!this.restrictFormatting||l){this.setPreviousBlockToLayout();var d="bidi"===e?"ParagraphBidi":e[0].toUpperCase()+e.slice(1);this.documentHelper.owner.isShiftingEnabled=!0;var h=this.documentHelper.selection,c=h.start.paragraph,p=!1;if(h.isForward||(c=h.end.paragraph),"leftIndent"==e&&(p=this.isFirstParaForList(h,c)),t<=0&&"leftIndent"==e&&!o){var u=s.a.convertPointToPixel(t);if(c.x+u<this.viewer.clientArea.x&&!c.paragraphFormat.bidi)return void(this.documentHelper.owner.isShiftingEnabled=!1)}if(this.initHistory(d),(!this.owner.isReadOnlyMode||l)&&this.owner.isDocumentLoaded){if("leftIndent"===e&&!i.i(a.isNullOrUndefined)(h.paragraphFormat.listId)&&-1!==h.paragraphFormat.listId&&n)return void(p?this.updateListLevelIndent(t,c):this.updateListLevel(t>0));if(!(t instanceof g.b&&"styleName"==e&&h.isEmpty)&&h.isEmpty){this.setOffsetValue(h);h.paragraphFormat.bidi&&("listFormat"===e||-1!==h.paragraphFormat.listId)||(this.documentHelper.layout.isBidiReLayout=!0),n&&"leftIndent"===e&&(t=this.getIndentIncrementValue(h.start.paragraph,t));var f=h.start.paragraph;this.documentHelper.layout;f=f.combineWidget(this.owner.viewer),this.applyParaFormatProperty(f,e,t,n),this.layoutItemBlock(f,!1)}else"ParagraphBidi"!==d&&this.setOffsetValue(h),this.updateSelectionParagraphFormatting(e,t,n);this.reLayout(h)}}},e.prototype.updateListLevelIndent=function(e,t){var n,r,o=this.documentHelper.getListById(t.paragraphFormat.listFormat.listId),s=this.documentHelper.getAbstractListById(o.abstractListId),l=void 0;if(i.i(a.isNullOrUndefined)(this.editorHistory)||i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)||(l=this.editorHistory.currentBaseHistoryInfo.action),this.initHistory("List"),e<0&&s.levels[0].paragraphFormat.leftIndent+e<=0&&(e=18-s.levels[0].paragraphFormat.leftIndent),0!=e){for(var d=0;d<s.levels.length;d++)this.editorHistory&&!i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&this.editorHistory.currentBaseHistoryInfo.addModifiedPropertiesForList(s.levels[d]),r=s.levels[d],r.paragraphFormat.leftIndent+=e;i.i(a.isNullOrUndefined)(this.editorHistory)||i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)||i.i(a.isNullOrUndefined)(l)||(this.editorHistory.currentBaseHistoryInfo.insertedFormat=(n={},n[l.toString().charAt(0).toLowerCase()+l.toString().slice(1)]=e,n.isFirstParaForList=!0,n)),this.documentHelper.owner.isShiftingEnabled=!0,this.layoutWholeDocument(),this.documentHelper.owner.isShiftingEnabled=!1}},e.prototype.isFirstParaForList=function(e,t){var n=!1;if(!i.i(a.isNullOrUndefined)(e.paragraphFormat.listId)&&-1!==e.paragraphFormat.listId&&0===t.paragraphFormat.listFormat.listLevelNumber){var r=this.updateWholeListItems(t,!0,e.paragraphFormat.listId);i.i(a.isNullOrUndefined)(r)&&(n=!0)}return n},e.prototype.updateListLevel=function(e){var t,n=this.documentHelper,r=(this.documentHelper.selection.start.paragraph.paragraphFormat.listFormat,this.documentHelper.selection.start.paragraph.paragraphFormat),o=n.getListById(r.listFormat.listId);n.layout.getListLevel(o,r.listFormat.listLevelNumber);t=e?r.listFormat.listLevelNumber+1:r.listFormat.listLevelNumber-1;var s=n.layout.getListLevel(o,t);i.i(a.isNullOrUndefined)(s)||(this.onApplyListInternal(o,t),n.selection.start.updatePhysicalPosition(!0),n.selection.end.updatePhysicalPosition(!0),n.selection.updateCaretPosition())},e.prototype.onApplyListInternal=function(e,t){var n=new l.K;!i.i(a.isNullOrUndefined)(e)&&t>=0&&t<9&&(n.listId=e.listId,n.listLevelNumber=t),this.onApplyParagraphFormat("listFormat",n,!1,!1)},e.prototype.updateSelectionParagraphFormatting=function(e,t,n){var r=this.documentHelper.selection;"leftIndent"===e&&n&&(t=!i.i(a.isNullOrUndefined)(r.start)&&r.start.isExistBefore(r.end)?this.getIndentIncrementValue(r.start.paragraph,t):this.getIndentIncrementValue(r.end.paragraph,t)),this.updateParagraphFormatInternal(e,t,n)},e.prototype.getIndentIncrementValue=function(e,t){var i=e.paragraphFormat.leftIndent;if(i<0){if(t<0||i+t>=0)return-i;var n=-this.getIndentIncrementValueInternal(-i,-t);return n%t==0?n:n+t}return this.getIndentIncrementValueInternal(i,t)},e.prototype.getIndentIncrementValueInternal=function(e,t){var i=Math.abs(t);if(0===e||0===i)return t>0?i:0;var n=100*Math.round(e)%(100*Math.round(i))/100,r=(Math.round(e)-n)/Math.round(i),o=r*i;return t>0&&(o+=i),o-e==0?t:o-e},e.prototype.updateParagraphFormatInternal=function(e,t,n){switch(i.i(a.isNullOrUndefined)(e)&&(e="ParagraphFormat"),e){case"afterSpacing":this.updateParagraphFormat("afterSpacing",t,!1);break;case"beforeSpacing":this.updateParagraphFormat("beforeSpacing",t,!1);break;case"spaceAfterAuto":this.updateParagraphFormat("spaceAfterAuto",t,!1);break;case"spaceBeforeAuto":this.updateParagraphFormat("spaceBeforeAuto",t,!1);break;case"rightIndent":this.updateParagraphFormat("rightIndent",t,!1);break;case"leftIndent":this.updateParagraphFormat("leftIndent",t,n);break;case"firstLineIndent":this.updateParagraphFormat("firstLineIndent",t,!1);break;case"lineSpacing":this.updateParagraphFormat("lineSpacing",t,!1);break;case"lineSpacingType":this.updateParagraphFormat("lineSpacingType",t,!1);break;case"textAlignment":this.updateParagraphFormat("textAlignment",t,!1);break;case"borders":case"topBorder":case"bottomBorder":case"leftBorder":case"rightBorder":case"horizontalBorder":case"verticalBorder":this.updateParagraphFormat(e,t,!1);break;case"listFormat":this.updateParagraphFormat("listFormat",t,!1);break;case"ParagraphFormat":this.updateParagraphFormat(void 0,t,!1);break;case"styleName":this.updateParagraphFormat("styleName",t,!1);break;case"ClearParagraphFormat":this.updateParagraphFormat(void 0,t,!1);break;case"bidi":var r=-1!==this.selection.paragraphFormat.listId;r||(this.documentHelper.layout.isBidiReLayout=!0),this.updateParagraphFormat("bidi",t,!1),r||(this.documentHelper.layout.isBidiReLayout=!1);break;case"contextualSpacing":this.updateParagraphFormat("contextualSpacing",t,!1);break;case"tabStop":this.updateParagraphFormat("tabStop",t,!1)}},e.prototype.updateParagraphFormat=function(e,t,i){var n=this.documentHelper.selection,r=n.start,o=n.end;n.isForward||(r=n.end,o=n.start),this.applyParaFormatSelectedContent(r,o,e,t,i)},e.prototype.applyParaFormatSelectedContent=function(e,t,n,r,o){var s=this.documentHelper.selection;if(!e.paragraph.isInsideTable||t.paragraph.isInsideTable&&e.paragraph.associatedCell===t.paragraph.associatedCell&&!s.isCellSelected(e.paragraph.associatedCell,e,t)){if(!i.i(a.isNullOrUndefined)(r)&&!this.selection.isEmpty&&"styleName"===n&&this.applyCharacterStyle(e.paragraph,e,t,n,r,o))return;this.applyParaFormat(e.paragraph,e,t,n,r,o)}else{var l=void 0;e.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer),this.checkInsertPosition(s)&&this.updateHistoryPosition(e,!0),l=e.paragraph.associatedCell,this.applyParaFormatInCell(l,e,t,n,r,o);var d=l.ownerTable;this.documentHelper.layout.layoutBodyWidgetCollection(d.index,d.containerWidget,d,!1)}},e.prototype.applyParaFormatProperty=function(e,t,n,r){var o=e.paragraphFormat;if(r&&"leftIndent"===t&&(n=o.leftIndent+n),"listFormat"===t&&n instanceof l.K){var s=n;s.hasValue("listLevelNumber")||(this.isAutoList?(s.listLevelNumber=this.listLevelNumber,this.listLevelNumber=0,this.isAutoList=!1):s.listLevelNumber=o.listFormat.listLevelNumber)}if(this.editorHistory&&!i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&(n=this.editorHistory.currentBaseHistoryInfo.addModifiedPropertiesForParagraphFormat(o,t,n),this.editorHistory.currentBaseHistoryInfo.insertedFormat=n),n instanceof l.F&&(i.i(a.isNullOrUndefined)(t)?this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)?this.copyParagraphFormat(n,o):o.copyFormat(n):"listFormat"===t&&(o.listFormat=n.listFormat,o.listFormat.ownerBase=o)),i.i(a.isNullOrUndefined)(n))return o.clearFormat(),void this.documentHelper.layout.reLayoutParagraph(o.ownerBase,0,0);if("afterSpacing"===t)o.afterSpacing=n;else if("beforeSpacing"===t)o.beforeSpacing=n;else if("leftIndent"===t)o.leftIndent=n;else if("lineSpacingType"===t)o.lineSpacingType=n;else if("lineSpacing"===t)o.lineSpacing=n;else if("rightIndent"===t)o.rightIndent=n;else if("firstLineIndent"===t)o.firstLineIndent=n;else if("textAlignment"===t){var d=n;!o.bidi||this.editorHistory.isUndoing||this.editorHistory.isRedoing||("Left"===d?d="Right":"Right"===d&&(d="Left")),o.textAlignment=d}else if("outlineLevel"===t)o.outlineLevel=n;else if("topBorder"===t)this.applyBorder(o.borders.top,n);else if("bottomBorder"===t)this.applyBorder(o.borders.bottom,n);else if("leftBorder"===t)this.applyBorder(o.borders.left,n);else if("rightBorder"===t)this.applyBorder(o.borders.right,n);else if("horizontalBorder"===t)this.applyBorder(o.borders.horizontal,n);else if("verticalBorder"===t)this.applyBorder(o.borders.vertical,n);else if("borders"===t)o.borders.copyFormat(n);else if("styleName"===t)"string"==typeof n&&(n=this.documentHelper.styles.findByName(n)),o.applyStyle(n);else{if("listFormat"===t)return n instanceof l.F&&(n=n.listFormat),o.listFormat.copyFormat(n),this.documentHelper.layout.clearListElementBox(o.ownerBase),o.listFormat.listId>=0&&o.clearIndent(),void this.layoutItemBlock(o.ownerBase,!1);if("bidi"===t)o.bidi=n;else if("keepWithNext"===t)o.keepWithNext=n;else if("keepLinesTogether"===t)o.keepLinesTogether=n;else if("widowControl"===t)o.widowControl=n;else if("contextualSpacing"===t)o.contextualSpacing=n;else if("spaceAfterAuto"===t)o.spaceAfterAuto=n;else if("spaceBeforeAuto"===t)o.spaceBeforeAuto=n;else if("tabStop"===t){var h=this.editorHistory.isUndoing||this.editorHistory.isRedoing;this.updateTabStopCollection(e,n,h)}}},e.prototype.copyParagraphFormat=function(e,t){t.uniqueParagraphFormat=e.uniqueParagraphFormat,t.listFormat=e.listFormat,t.listFormat.ownerBase=t,t.baseStyle=e.baseStyle},e.prototype.copyFromListLevelParagraphFormat=function(e,t){i.i(a.isNullOrUndefined)(t.leftIndent)||(e.leftIndent=t.leftIndent),i.i(a.isNullOrUndefined)(t.firstLineIndent)||(e.firstLineIndent=t.firstLineIndent)},e.prototype.applyContinueNumbering=function(){var e=this.selection;this.editorHistory&&this.editorHistory.initializeHistory("ContinueNumbering"),this.applyContinueNumberingInternal(e)},e.prototype.applyContinueNumberingInternal=function(e,t){var n=e.start.paragraph,r=this.getContinueNumberingInfo(n);i.i(a.isNullOrUndefined)(t)&&(t=this.getParagraphFormat(n,r.listLevelNumber,r.listPattern)),t=i.i(a.isNullOrUndefined)(t)?n.paragraphFormat:t,this.changeListId(r.currentList,n,t,r.listLevelNumber,r.listPattern),this.reLayout(e,!1),this.owner.enableAutoFocus&&this.documentHelper.updateFocus()},e.prototype.getContinueNumberingInfo=function(e){var t=void 0,n=0,r="None";i.i(a.isNullOrUndefined)(e.paragraphFormat)||i.i(a.isNullOrUndefined)(e.paragraphFormat.listFormat)||(t=this.documentHelper.getListById(e.paragraphFormat.listFormat.listId),n=e.paragraphFormat.listFormat.listLevelNumber);var o=this.documentHelper;if(0!==n&&!i.i(a.isNullOrUndefined)(t)&&!i.i(a.isNullOrUndefined)(o.getAbstractListById(t.abstractListId))&&!i.i(a.isNullOrUndefined)(o.getAbstractListById(t.abstractListId).levels[n])){var s=this.documentHelper.layout.getListLevel(t,n);i.i(a.isNullOrUndefined)(s)||(r=s.listLevelPattern)}return{currentList:t,listLevelNumber:n,listPattern:r}},e.prototype.revertContinueNumbering=function(e,t){var n=e.start.paragraph,r=this.getContinueNumberingInfo(n);this.changeListId(r.currentList,n,t,r.listLevelNumber,r.listPattern),this.reLayout(e,!1),this.editorHistory&&!i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&this.editorHistory.updateHistory()},e.prototype.changeListId=function(e,t,n,o,s){if(!i.i(a.isNullOrUndefined)(t)){if(t instanceof r.g&&e.listId===t.paragraphFormat.listFormat.listId){if(this.editorHistory){var l=this.editorHistory.currentBaseHistoryInfo;i.i(a.isNullOrUndefined)(l)||(n=l.addModifiedPropertiesForContinueNumbering(t.paragraphFormat,n),l.insertedFormat=n)}o===t.paragraphFormat.listFormat.listLevelNumber?t.paragraphFormat.copyFormat(n):t.paragraphFormat.listFormat.listId=n.listFormat.listId,this.documentHelper.layout.reLayoutParagraph(t,0,0)}return this.changeListId(e,t.nextRenderedWidget,n,o,s)}},e.prototype.getParagraphFormat=function(e,t,n){if(!i.i(a.isNullOrUndefined)(e.previousRenderedWidget)&&e.previousRenderedWidget instanceof r.g)return i.i(a.isNullOrUndefined)(e.previousRenderedWidget.paragraphFormat.listFormat)||-1===e.previousRenderedWidget.paragraphFormat.listFormat.listId?this.getParagraphFormat(e.previousRenderedWidget,t,n):t===e.previousRenderedWidget.paragraphFormat.listFormat.listLevelNumber?e.previousRenderedWidget.paragraphFormat:this.getParagraphFormat(e.previousRenderedWidget,t,n)},e.prototype.checkNumberArabic=function(e,t){return"Number"===e&&"Arabic"===t||"Number"===t&&"Arabic"===e},e.prototype.applyRestartNumbering=function(e){this.editorHistory&&this.editorHistory.initializeHistory("RestartNumbering"),this.restartListAt(e)},e.prototype.restartListAt=function(e){var t=e.paragraphFormat.getList(),i=t.clone();i.listId=this.documentHelper.lists[this.documentHelper.lists.length-1].listId+1;var n=s.a.generateUniqueId(this.documentHelper.lists);this.documentHelper.lists.push(i);var r=t.abstractList.clone();r.abstractListId=this.documentHelper.abstractLists[this.documentHelper.abstractLists.length-1].abstractListId+1,i.abstractListId=r.abstractListId,i.nsid=r.nsid=n,i.abstractList=r,this.documentHelper.abstractLists.push(r),this.restartListAtInternal(e,i.listId,i.nsid)},e.prototype.restartListAtInternal=function(e,t,i){var n=this.getContinueNumberingInfo(e.start.paragraph);this.changeRestartNumbering(n.currentList,e.start.paragraph,t,i),this.reLayout(e,!1),this.documentHelper.updateFocus()},e.prototype.changeRestartNumbering=function(e,t,n,o){if(!i.i(a.isNullOrUndefined)(t)){if(t instanceof r.g&&e.listId===t.paragraphFormat.listFormat.listId){if(this.editorHistory){var s=this.editorHistory.currentBaseHistoryInfo;i.i(a.isNullOrUndefined)(s)||(n=s.addModifiedPropertiesForRestartNumbering(t.paragraphFormat.listFormat,n),s.insertedFormat={listId:n,nsid:o})}t.paragraphFormat.listFormat.listId=n,this.documentHelper.layout.reLayoutParagraph(t,0,0)}return this.changeRestartNumbering(e,t.nextRenderedWidget,n,o)}},e.prototype.applyParaFormat=function(e,t,i,n,r,o){this.setOffsetValue(this.selection),e=e.combineWidget(this.owner.viewer),this.applyParaFormatProperty(e,n,r,o),this.layoutItemBlock(e,!1),this.getOffsetValue(this.selection),e.equals(i.paragraph)||this.getNextParagraphForFormatting(e,t,i,n,r,o)},e.prototype.applyCharacterStyle=function(e,t,i,n,r,o){var s=e.getSplitWidgets(),a=i.owner.selection,l=i.currentWidget;if(!(0===t.offset&&(a.isParagraphLastLine(l)&&i.currentWidget===l&&i.offset===a.getLineLength(l)+1||i.isAtParagraphEnd)||i.paragraph!==e&&-1===s.indexOf(i.paragraph)||!("Paragraph"===r.type&&r.link instanceof g.b||"Character"===r.type))){var d="Character"===r.type?r:r.link;return this.updateSelectionCharacterFormatting(n,d,o),!0}return!1},e.prototype.applyParaFormatInCell=function(e,t,i,n,r,o){var s=this.documentHelper.selection;if(i.paragraph.isInsideTable){var a=s.getContainerCellOf(e,i.paragraph.associatedCell);if(a.ownerTable.contains(i.paragraph.associatedCell)){var l=s.getSelectedCell(e,a),d=s.getSelectedCell(i.paragraph.associatedCell,a);s.containsCell(a,i.paragraph.associatedCell)?s.isCellSelected(a,t,i)?(r=this.getParaFormatValueInCell(a,n,r),this.applyParaFormatCellInternal(a,n,r,o)):l===a?this.applyParaFormat(t.paragraph,t,i,n,r,o):this.applyParagraphFormatRow(l.ownerRow,t,i,n,r,o):this.applyParaFormatTableCell(a.ownerTable,a,d,n,r,o)}else this.applyParagraphFormatRow(a.ownerRow,t,i,n,r,o)}else{var h=s.getContainerCell(e);this.applyParagraphFormatRow(h.ownerRow,t,i,n,r,o)}},e.prototype.applyParaFormatCellInternal=function(e,t,i,n){for(var o=0;o<e.childWidgets.length;o++){var s=e.childWidgets[o];s instanceof r.g?this.applyParaFormatProperty(s,t,i,n):this.applyParagraphFormatTableInternal(s,t,i,n)}},e.prototype.getParaFormatValueInCell=function(e,t,i){if("boolean"==typeof i){i=!this.documentHelper.selection.getFirstParagraph(e).paragraphFormat.getPropertyValue(t)}return i},e.prototype.applyParagraphFormatRow=function(e,t,i,n,r,o){r=this.getParaFormatValueInCell(e.childWidgets[0],n,r);for(var s=e.rowIndex;s<e.ownerTable.childWidgets.length;s++){for(var a=e.ownerTable.childWidgets[s],l=0;l<a.childWidgets.length;l++)this.applyParaFormatCellInternal(a.childWidgets[l],n,r,o);if(i.paragraph.isInsideTable&&this.documentHelper.selection.containsRow(a,i.paragraph.associatedCell))return}this.getNextParagraphForFormatting(e.ownerTable,t,i,n,r,o)},e.prototype.applyParaFormatTableCell=function(e,t,i,n,r,o){var s=this.documentHelper.selection,a=s.getCellLeft(t.ownerRow,t),l=a+t.cellFormat.cellWidth,d=s.getCellLeft(i.ownerRow,i),h=d+i.cellFormat.cellWidth,c=this.updateSelectedCellsInTable(a,l,d,h);a=c.start,l=c.end;for(var p=e.childWidgets.indexOf(i.ownerRow),u=!1,g=e.childWidgets.indexOf(t.ownerRow);g<=p;g++)for(var f=e.childWidgets[g],m=0;m<f.childWidgets.length;m++){var v=s.getCellLeft(f,f.childWidgets[m]);Math.round(a)<=Math.round(v)&&Math.round(v)<Math.round(l)&&(u||(r=this.getParaFormatValueInCell(f.childWidgets[m],n,r),u=!0),this.applyParaFormatCellInternal(f.childWidgets[m],n,r,o))}},e.prototype.applyParaFormatTable=function(e,t,i,n,r,o){e=e.combineWidget(this.owner.viewer);for(var s=this.documentHelper.selection,a=0;a<e.childWidgets.length;a++){for(var l=e.childWidgets[a],d=0;d<l.childWidgets.length;d++)this.applyParaFormatCellInternal(l.childWidgets[d],n,r,o);if(i.paragraph.isInsideTable&&s.containsRow(l,i.paragraph.associatedCell))return void this.documentHelper.layout.layoutBodyWidgetCollection(e.index,e.containerWidget,e,!1)}this.documentHelper.layout.layoutBodyWidgetCollection(e.index,e.containerWidget,e,!1),this.getNextParagraphForFormatting(e,t,i,n,r,o)},e.prototype.getNextParagraphForFormatting=function(e,t,n,o,s,l){var d=e.getSplitWidgets();e=d[d.length-1],e=this.documentHelper.selection.getNextRenderedBlock(e),i.i(a.isNullOrUndefined)(e)||(e instanceof r.g?this.applyParaFormat(e,t,n,o,s,l):this.applyParaFormatTable(e,t,n,o,s,l))},e.prototype.applyParagraphFormatTableInternal=function(e,t,i,n){for(var r=0;r<e.childWidgets.length;r++)for(var o=e.childWidgets[r],s=0;s<o.childWidgets.length;s++)this.applyParaFormatCellInternal(o.childWidgets[s],t,i,n)},e.prototype.onApplyColumnFormat=function(e,t){if(!this.restrictFormatting){this.initHistory("SectionFormat");var i=this.documentHelper.selection;i.owner.isShiftingEnabled=!0;var n=i.start,r=i.end;i.isForward||(n=i.end,r=i.start);var o,s;this.documentHelper.clearContent();for(var a=n.paragraph.bodyWidget.sectionIndex,l=r.paragraph.bodyWidget.sectionIndex,d=!1,h=0;h<this.documentHelper.pages.length;h++)this.documentHelper.pages[h].bodyWidgets[0].index===a?o=h:d=!0;for(var h=o;h<this.documentHelper.pages.length;h++){var c=this.documentHelper.pages[h].bodyWidgets[0];if(s=h,c.index!==a&&!(c.index>=a&&c.index<=l)){s=h-1;break}}d&&"differentOddAndEvenPages"==e&&n.paragraph.isInHeaderFooter&&(o=0,s=this.documentHelper.pages.length-1);for(var p=!0,u=0,h=o;h<=s;h++)u===this.documentHelper.pages[h].bodyWidgets[0].index||p||(p=!0),this.applyPropertyValueForSection(this.documentHelper.pages[h].bodyWidgets[0].sectionFormat,e,t,p),u=this.documentHelper.pages[h].bodyWidgets[0].index,p=!1;this.layoutWholeDocument(),this.fireContentChange()}},e.prototype.onApplySectionFormat=function(e,t){if(!this.restrictFormatting){if(i.i(a.isNullOrUndefined)(e))this.initHistory("SectionFormat");else{var n=e[0].toUpperCase()+e.slice(1);this.initHistory(n)}this.updateSectionFormat(e,t)}},e.prototype.removeInlineHeaderFooterWidget=function(e,t,n,r){if(0!=e){var o=this.documentHelper.headersFooters[e],s=this.viewer.getHeaderFooter(t),l=this.selection.start.paragraph.containerWidget.sectionFormat.cloneFormat();if(!i.i(a.isNullOrUndefined)(r)){if(!i.i(a.isNullOrUndefined)(n)){var d=n[0].toUpperCase()+n.slice(1);this.initHistory(d),this.editorHistory&&!i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&(this.editorHistory.currentBaseHistoryInfo.insertedFormat=r);var h=this.selection.getParagraphInfo(this.selection.start);this.selection.editPosition=this.selection.getHierarchicalIndex(h.paragraph,h.offset.toString()),this.checkInsertPosition(this.selection)&&this.setPositionForHistory(this.selection.editPosition)}if(r)o&&!i.i(a.isNullOrUndefined)(o[s])&&(l.removedHeaderFooters.push(o[s]),this.editorHistory.currentBaseHistoryInfo.addModifiedPropertiesForSection(l,n,r),delete o[s]);else{var c=this.viewer.getCurrentHeaderFooter(t,e);if(!i.i(a.isNullOrUndefined)(c)&&i.i(a.isNullOrUndefined)(o[s])){var p=c.clone();o[s]=p,l.removedHeaderFooters.push(p),this.editorHistory.currentBaseHistoryInfo.addModifiedPropertiesForSection(l,n,r)}}this.selection.updateTextPositionForBlockContainer(this.selection.start.paragraph.containerWidget),this.isSkipOperationsBuild=!0,this.layoutWholeDocument(),this.isSkipOperationsBuild=!1,this.fireContentChange()}}},e.prototype.updateHeaderFooters=function(e,t,n,r){var o=this.documentHelper.headersFooters[n],s=this.viewer.getHeaderFooter(r.headerFooterType),l=o[s];(this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&(i.i(a.isNullOrUndefined)(l)?this.documentHelper.headersFooters[n][s]=r:i.i(a.isNullOrUndefined)(l)||delete o[s]),this.selection.updateTextPositionForBlockContainer(this.selection.start.paragraph.containerWidget),this.layoutWholeDocument()},e.prototype.updateSectionFormat=function(e,t){if(1===this.documentHelper.selection.startPage&&"differentFirstPage"===e){var n=void 0;n=this.documentHelper.selection.start.paragraph.containerWidget instanceof r.j?this.getFirstChildOfTable(this.documentHelper.selection.start.paragraph.containerWidget):this.documentHelper.selection.start.paragraph.containerWidget.childWidgets[0];var o=this.selection.getHierarchicalIndex(n,"0");this.documentHelper.selection.select(o,o)}var s=this.documentHelper.selection;s.owner.isShiftingEnabled=!0;var l=s.start,d=s.end;s.isForward||(l=s.end,d=s.start);var h,c;this.documentHelper.clearContent();for(var p=l.paragraph.bodyWidget.sectionIndex,u=d.paragraph.bodyWidget.sectionIndex,g=!1,f=!1,m=0;m<this.documentHelper.pages.length;m++){for(var v=0;v<this.documentHelper.pages[m].bodyWidgets.length;v++)if(this.documentHelper.pages[m].bodyWidgets[v].index===p){if(h=m,s.isForward){f=!0;break}}else g=!0;if(f)break}for(var m=h;m<this.documentHelper.pages.length;m++)for(var v=0;v<this.documentHelper.pages[m].bodyWidgets.length;v++){var y=this.documentHelper.pages[m].bodyWidgets[v];y.index!==p?y.index>=p&&y.index<=u&&(c=m):c=m}g&&"differentOddAndEvenPages"==e&&l.paragraph.isInHeaderFooter&&(h=0,c=this.documentHelper.pages.length-1);for(var w=!0,b=0,m=h;m<=c;m++)for(var v=0;v<this.documentHelper.pages[m].bodyWidgets.length;v++)if(this.documentHelper.pages[m].bodyWidgets[v].index>=p&&this.documentHelper.pages[m].bodyWidgets[v].index<=u||!s.isForward&&this.documentHelper.pages[m].bodyWidgets[v].index<=p&&this.documentHelper.pages[m].bodyWidgets[v].index>=u){b===this.documentHelper.pages[m].bodyWidgets[v].index||w||(w=!0),this.applyPropertyValueForSection(this.documentHelper.pages[m].bodyWidgets[v].sectionFormat,e,t,w),b=this.documentHelper.pages[m].bodyWidgets[v].index,w=!1;var x=this.documentHelper.pages[m].bodyWidgets[v];i.i(a.isNullOrUndefined)(x.nextWidget)||x.sectionFormat.pageHeight===x.nextWidget.sectionFormat.pageHeight&&x.sectionFormat.pageWidth===x.nextWidget.sectionFormat.pageWidth||"NoBreak"!==x.nextWidget.sectionFormat.breakCode||(x.nextWidget.sectionFormat.breakCode="NewPage",x=this.documentHelper.layout.getBodyWidget(x.nextWidget,!1),i.i(a.isNullOrUndefined)(x.nextWidget)||(x.nextWidget.sectionFormat.breakCode="NewPage"))}this.isSkipOperationsBuild=!0,this.layoutWholeDocument(),this.isSkipOperationsBuild=!1,this.fireContentChange()},e.prototype.getFirstChildOfTable=function(e){return e.ownerTable.childWidgets[0].childWidgets[0].childWidgets[0]},e.prototype.onApplyTableFormat=function(e,t,n){if(!this.restrictFormatting){var r=this.getTableFormatAction(e);this.viewer.owner.isShiftingEnabled=!0;var o=this.documentHelper.selection;i.i(a.isNullOrUndefined)(n)&&(n=o.start.paragraph.associatedCell.ownerTable),n=n.combineWidget(this.owner.viewer),o.isEmpty?(this.initHistory(r),this.applyTablePropertyValue(e,t,n)):this.updateSelectionTableFormat(this.selection,r,t),n.calculateGrid(),this.selection.owner.isLayoutEnabled=!0,this.documentHelper.layout.reLayoutTable(n),this.reLayout(o,!1)}},e.prototype.getTableFormatAction=function(e){switch(e){case"tableAlignment":return"TableAlignment";case"leftIndent":return"TableLeftIndent";case"leftMargin":return"DefaultCellLeftMargin";case"rightMargin":return"DefaultCellRightMargin";case"bottomMargin":return"DefaultCellBottomMargin";case"topMargin":return"DefaultCellTopMargin";case"preferredWidth":return"TablePreferredWidth";case"preferredWidthType":return"TablePreferredWidthType";case"shading":return"Shading";case"bidi":return"TableBidi";case"title":return"TableTitle";case"description":return"TableDescription";default:return"DefaultCellSpacing"}},e.prototype.onApplyTableRowFormat=function(e,t){if(!this.restrictFormatting){var i=this.getRowAction(e);this.documentHelper.owner.isShiftingEnabled=!0;var n=this.documentHelper.selection;if(n.isEmpty){this.initHistory(i);n.start.paragraph.associatedCell.ownerRow.ownerTable;this.applyRowPropertyValue(n,e,t,n.start.paragraph.associatedCell.ownerRow)}else this.updateSelectionTableFormat(this.selection,i,t);this.reLayout(n,!1)}},e.prototype.getRowAction=function(e){switch(e){case"height":return"RowHeight";case"heightType":return"RowHeightType";case"isHeader":return"RowHeader";default:return"AllowBreakAcrossPages"}},e.prototype.onApplyTableCellFormat=function(e,t){if(!this.restrictFormatting){var i=this.getTableCellAction(e);this.documentHelper.owner.isShiftingEnabled=!0;var n=this.documentHelper.selection,r=n.start.paragraph.associatedCell.ownerTable;r=r.combineWidget(this.owner.viewer),n.isEmpty?(this.initHistory(i),this.applyCellPropertyValue(n,e,t,n.start.paragraph.associatedCell.cellFormat),r.calculateGrid(),this.selection.owner.isLayoutEnabled=!0,this.documentHelper.layout.reLayoutTable(r)):this.updateSelectionTableFormat(this.selection,i,t),this.reLayout(n,!1)}},e.prototype.getTableCellAction=function(e){switch(e){case"verticalAlignment":return"CellContentVerticalAlignment";case"leftMargin":return"CellLeftMargin";case"rightMargin":return"CellRightMargin";case"bottomMargin":return"CellBottomMargin";case"topMargin":return"CellTopMargin";case"preferredWidth":return"CellPreferredWidth";case"shading":return"Shading";default:return"CellPreferredWidthType"}},e.prototype.applyPropertyValueForSection=function(e,t,n,r){if(r&&this.editorHistory&&!i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&("columns"===t&&(e.numberOfColumns=n.length),n=this.editorHistory.currentBaseHistoryInfo.addModifiedPropertiesForSection(e,t,n),this.editorHistory.currentBaseHistoryInfo.insertedFormat=n),!i.i(a.isNullOrUndefined)(n))return n instanceof l.G?void(i.i(a.isNullOrUndefined)(t)&&e.copyFormat(n,this.editorHistory)):void("pageHeight"===t?e.pageHeight=n:"pageWidth"===t?e.pageWidth=n:"leftMargin"===t?e.leftMargin=n:"rightMargin"===t?e.rightMargin=n:"topMargin"===t?e.topMargin=n:"bottomMargin"===t?e.bottomMargin=n:"differentFirstPage"===t?e.differentFirstPage=n:"differentOddAndEvenPages"===t?e.differentOddAndEvenPages=n:"headerDistance"===t?e.headerDistance=n:"footerDistance"===t?e.footerDistance=n:"pageStartingNumber"===t?e.pageStartingNumber=n:"restartPageNumbering"===t?e.restartPageNumbering=n:"endnoteNumberFormat"===t?e.endnoteNumberFormat=n:"footNoteNumberFormat"===t?e.footNoteNumberFormat=n:"restartIndexForEndnotes"===t?e.restartIndexForEndnotes=n:"restartIndexForFootnotes"===t?e.restartIndexForFootnotes=n:"initialFootNoteNumber"===t?e.initialFootNoteNumber=n:"initialEndNoteNumber"===t?e.initialEndNoteNumber=n:"numberOfColumns"==t?e.numberOfColumns=n:"equalWidth"==t?e.equalWidth=n:"lineBetweenColumns"==t?e.lineBetweenColumns=n:"columns"==t&&(e.columns=n))},e.prototype.layoutWholeDocument=function(e){this.documentHelper.layout.isInitialLoad=!0,this.documentHelper.layout.isLayoutWhole=!0;var t=this.documentHelper.selection.start,i=this.documentHelper.selection.end;t.isExistAfter(i)&&(t=this.documentHelper.selection.end,i=this.documentHelper.selection.start),"Continuous"==this.owner.layoutType&&(this.documentHelper.selection.isinEndnote||this.documentHelper.selection.isinFootnote)&&(this.documentHelper.selection.footnoteReferenceElement(t,i),t=i);var n=this.selection.getParagraphInfo(t),r=this.selection.getParagraphInfo(i),o=this.selection.getHierarchicalIndex(n.paragraph,n.offset.toString()),s=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString());this.documentHelper.renderedLists.clear(),this.documentHelper.renderedLevelOverrides=[];var a=this.combineSection();this.documentHelper.clearContent(),this.documentHelper.layout.layoutItems(a,!0),this.documentHelper.owner.isShiftingEnabled=!1,this.setPositionForCurrentIndex(t,o),this.setPositionForCurrentIndex(i,s),this.documentHelper.selection.selectPosition(t,i),this.reLayout(this.documentHelper.selection,void 0,e),this.documentHelper.layout.isLayoutWhole=!1,this.documentHelper.layout.isInitialLoad=!1},e.prototype.combineSection=function(){var e=[],t=this.documentHelper.pages[0].bodyWidgets[0];do{t=this.combineSectionChild(t,e,!1)}while(t);for(var i=0;i<this.documentHelper.pages.length;i++)this.documentHelper.pages[i].destroy(),i--;return e},e.prototype.combineFollowingSection=function(){var e=[],t=this.documentHelper.selection.start.paragraph.bodyWidget.getSplitWidgets()[0];if(t.childWidgets[0]instanceof r.g)this.updateWholeListItems(t.childWidgets[0]);else{var i=this.documentHelper.getFirstParagraphInFirstCell(t.childWidgets[0]);this.viewer.owner.editorModule.updateWholeListItems(i)}var n=this.documentHelper.pages.indexOf(t.page),o=0===t.indexInOwner?n:n+1;do{t=this.combineSectionChild(t,e,!1)}while(t);for(var s=o;s<this.documentHelper.pages.length;s++)this.documentHelper.pages[s].destroy(),s--;for(var a=n;a<this.documentHelper.pages.length;a++)for(var l=0;l<this.documentHelper.pages[a].bodyWidgets.length;l++)0===this.documentHelper.pages[a].bodyWidgets[l].childWidgets.length&&(this.documentHelper.pages[a].bodyWidgets.splice(l,1),l--);return e},e.prototype.combineSectionChild=function(e,t,i){var n=e,o=new r.o,s=!1;o.sectionFormat=e.sectionFormat,o.index=n.index;do{s=!1,n=e,e.lastChild&&e.lastChild.combineWidget(this.owner.viewer),e=e.nextRenderedWidget;for(var a=0;a<n.childWidgets.length;a++){var l=n.childWidgets[a];l instanceof r.u?this.documentHelper.layout.clearTableWidget(l,!0,!0,!0):(l.x=0,l.y=0,l.width=0,l.height=0),o.childWidgets.push(l),n.childWidgets.splice(a,1),a--,l.containerWidget=o}for(var d=0;d<n.page.bodyWidgets.length;d++){if(0!==n.page.bodyWidgets[d].childWidgets.length){s=!1;break}s=!0}s&&i&&n.page.destroy()}while(e&&n.index===e.index);return t.push(o),e},e.prototype.updateSelectionTableFormat=function(e,t,i){switch(t){case"TableAlignment":this.editorHistory.initializeHistory("TableAlignment"),this.updateTableFormat(e,"tableAlignment",i);break;case"TableLeftIndent":this.editorHistory.initializeHistory("TableLeftIndent"),this.updateTableFormat(e,"leftIndent",i);break;case"DefaultCellSpacing":this.editorHistory.initializeHistory("DefaultCellSpacing"),this.updateTableFormat(e,"cellSpacing",i);break;case"DefaultCellLeftMargin":this.editorHistory.initializeHistory("DefaultCellLeftMargin"),this.updateTableFormat(e,"leftMargin",i);break;case"DefaultCellRightMargin":this.editorHistory.initializeHistory("DefaultCellRightMargin"),this.updateTableFormat(e,"rightMargin",i);break;case"DefaultCellTopMargin":this.editorHistory.initializeHistory("DefaultCellTopMargin"),this.updateTableFormat(e,"topMargin",i);break;case"TablePreferredWidth":this.editorHistory.initializeHistory("TablePreferredWidth"),this.updateTableFormat(e,"preferredWidth",i);break;case"TablePreferredWidthType":this.editorHistory.initializeHistory("TablePreferredWidthType"),this.updateTableFormat(e,"preferredWidthType",i);break;case"DefaultCellBottomMargin":this.editorHistory.initializeHistory("DefaultCellBottomMargin"),this.updateTableFormat(e,"bottomMargin",i);break;case"CellContentVerticalAlignment":this.editorHistory.initializeHistory("CellContentVerticalAlignment"),this.updateCellFormat(e,"verticalAlignment",i);break;case"CellLeftMargin":this.editorHistory.initializeHistory("CellLeftMargin"),this.updateCellFormat(e,"leftMargin",i);break;case"CellRightMargin":this.editorHistory.initializeHistory("CellRightMargin"),this.updateCellFormat(e,"rightMargin",i);break;case"CellTopMargin":this.editorHistory.initializeHistory("CellTopMargin"),this.updateCellFormat(e,"topMargin",i);break;case"CellBottomMargin":this.editorHistory.initializeHistory("CellBottomMargin"),this.updateCellFormat(e,"bottomMargin",i);break;case"CellPreferredWidth":this.editorHistory.initializeHistory("CellPreferredWidth"),this.updateCellFormat(e,"preferredWidth",i);break;case"CellPreferredWidthType":this.editorHistory.initializeHistory("CellPreferredWidthType"),this.updateCellFormat(e,"preferredWidthType",i);break;case"Shading":this.editorHistory.initializeHistory("Shading"),this.updateCellFormat(e,"shading",i);break;case"RowHeight":this.editorHistory.initializeHistory("RowHeight"),this.updateRowFormat(e,"height",i);break;case"RowHeightType":this.editorHistory.initializeHistory("RowHeightType"),this.updateRowFormat(e,"heightType",i);break;case"RowHeader":this.editorHistory.initializeHistory("RowHeader"),this.updateRowFormat(e,"isHeader",i);break;case"AllowBreakAcrossPages":this.editorHistory.initializeHistory("AllowBreakAcrossPages"),this.updateRowFormat(e,"allowBreakAcrossPages",i);break;case"TableBidi":this.editorHistory.initializeHistory(t),this.updateTableFormat(e,"bidi",i);break;case"TableTitle":this.editorHistory.initializeHistory(t),this.updateTableFormat(e,"title",i);break;case"TableDescription":this.editorHistory.initializeHistory(t),this.updateTableFormat(e,"description",i)}},e.prototype.updateTableFormat=function(e,t,i){var n=e.start;e.end;e.isForward||(n=e.end,e.start),this.initHistoryPosition(e,n),this.applyTablePropertyValue(t,i,n.paragraph.associatedCell.ownerTable),this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&this.documentHelper.layout.reLayoutTable(n.paragraph.associatedCell.ownerTable)},e.prototype.updateCellFormat=function(e,t,i){e.owner.isShiftingEnabled=!0;var n=e.start;e.end;e.isForward||(n=e.end,e.start),this.initHistoryPosition(e,n),this.updateFormatForCell(e,t,i)},e.prototype.updateRowFormat=function(e,t,i){var n=e.start,r=e.end;e.isForward||(n=e.end,r=e.start),this.initHistoryPosition(e,n),this.applyRowFormat(n.paragraph.associatedCell.ownerRow,n,r,t,i)},e.prototype.initHistoryPosition=function(e,t){this.documentHelper.owner.editorHistoryModule&&!i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&(i.i(a.isNullOrUndefined)(t)?i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo.insertPosition)&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=e.start.getHierarchicalIndexInternal()):i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo.insertPosition)&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=t.getHierarchicalIndexInternal()))},e.prototype.startSelectionReLayouting=function(e,t,i,n){if(t.owner.isLayoutEnabled=!0,i.paragraph.isInsideTable){for(var r=i.paragraph.associatedCell.ownerTable;r.isInsideTable;)r=r.associatedCell.ownerTable;this.reLayoutSelectionOfTable(r,t,i,n)}else this.reLayoutSelection(e,t,i,n)},e.prototype.reLayoutSelectionOfTable=function(e,t,n,r){var o=!1;if(this.documentHelper.layout.layoutBodyWidgetCollection(e.index,e.containerWidget,e,!1),!i.i(a.isNullOrUndefined)(r.paragraph.associatedCell)&&e.contains(r.paragraph.associatedCell))return!0;var s=t.getNextRenderedBlock(e);return i.i(a.isNullOrUndefined)(s)||(o=this.reLayoutSelectionOfBlock(s,t,n,r)),o},e.prototype.reLayoutSelection=function(e,t,n,o){if(n.paragraph===e){var s=(n.offset,t.getParagraphLength(e),0),l=0,d=e.getInline(n.offset,s),h=d.element;s=d.index,i.i(a.isNullOrUndefined)(h)||(s!==h.length||i.i(a.isNullOrUndefined)(h.nextNode)||(h=h.nextNode),l=h.line.children.indexOf(h));var c=0;n.currentWidget.paragraph===e&&(c=e.childWidgets.indexOf(n.currentWidget),l=n.currentWidget.children.indexOf(h)),h instanceof r.d&&!h.line&&l>0?this.documentHelper.layout.reLayoutParagraph(e,c,l-1):this.documentHelper.layout.reLayoutParagraph(e,c,l)}else this.documentHelper.layout.reLayoutParagraph(e,0,0);if(o.paragraph===e)return!0;var p=t.getNextRenderedBlock(e);return!i.i(a.isNullOrUndefined)(p)&&this.reLayoutSelectionOfBlock(p,t,n,o)},e.prototype.reLayoutSelectionOfBlock=function(e,t,i,n){return e instanceof r.g?this.reLayoutSelection(e,t,i,n):void 0},e.prototype.layoutItemBlock=function(e,t){var n=void 0;if(e.containerWidget instanceof r.h||e.containerWidget instanceof r.i)!i.i(a.isNullOrUndefined)(this.documentHelper.owner)&&this.documentHelper.owner.isLayoutEnabled&&(e=e.combineWidget(this.viewer),n=e.containerWidget,this.documentHelper.layout.layoutBodyWidgetCollection(e.index,n,e,!1));else if(e.containerWidget instanceof r.j){var o=e.containerWidget;o=this.documentHelper.selection.getContainerCell(o),!i.i(a.isNullOrUndefined)(this.documentHelper.owner)&&this.documentHelper.owner.isLayoutEnabled&&this.documentHelper.layout.reLayoutTable(e)}},e.prototype.removeSelectedContents=function(e){return this.removeSelectedContentInternal(e,e.start,e.end)},e.prototype.removeSelectedContentInternal=function(e,t,i){var o=t,s=i;if(t.isExistBefore(i)||(o=i,s=t),o.paragraph===s.paragraph&&o.paragraph.childWidgets.indexOf(o.currentWidget)===o.paragraph.childWidgets.length-1&&o.offset===e.getParagraphLength(o.paragraph)&&o.offset+1===s.offset)return e.owner.isShiftingEnabled=!0,e.selectContent(o,!0),!0;var a=this.selection.getParagraphInfo(o);e.editPosition=this.selection.getHierarchicalIndex(a.paragraph,a.offset.toString());var l=o.clone(),d=l.paragraph.containerWidget,h=l.currentWidget.isFirstLine(),c=this.checkMultipleSectionSelected(l,s),p=this.removeSelectedContent(s.paragraph,e,o,s),u=new n.a(e.owner);if(c&&"DefaultPaste"==this.selection.currentPasteAction&&h&&l.offset<1){var g=l.paragraph,f=new r.g,m=new r.p(f);m.paragraph=f,f.containerWidget=d,f.childWidgets.push(m),d.childWidgets.push(f),f.index=g.index,f.x=l.location.x,f.y=l.location.y}return this.setPositionForCurrentIndex(u,e.editPosition),e.selectContent(u,!0),p},e.prototype.checkMultipleSectionSelected=function(e,t){return this.getBodyWidgetIndex(e)!=this.getBodyWidgetIndex(t)},e.prototype.getBodyWidgetIndex=function(e){var t=e.hierarchicalPosition,i=t.indexOf(";"),n=t.substring(0,i);return t=t.substring(i).replace(";",""),i=t.indexOf(";"),n=t.substring(0,i),parseInt(n,10)},e.prototype.removeSelectedContent=function(e,t,i,n){return!(n.paragraph.isInsideTable&&n.paragraph!==this.documentHelper.getLastParagraphInLastCell(n.paragraph.associatedCell.ownerTable)&&(!i.paragraph.isInsideTable||i.paragraph.associatedCell.ownerTable.index!==n.paragraph.associatedCell.ownerTable.index))&&(t.owner.isShiftingEnabled=!0,this.deleteSelectedContent(e,t,i,n,2),!0)},e.prototype.deleteSelectedContent=function(e,t,n,o,s,d){var h=0,c=n.currentWidget.getInline(n.offset,h);c.element;if(h=c.index,h=0,c=o.currentWidget.getInline(o.offset,h),c.element,h=c.index,o.paragraph!==e)return void this.deleteSelectedContent(o.paragraph,t,n,o,s);if(o.paragraph.isInsideTable&&(!n.paragraph.isInsideTable||n.paragraph.associatedCell!==o.paragraph.associatedCell||t.isCellSelected(o.paragraph.associatedCell,n,o)&&!d))o.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer),this.deleteTableCell(o.paragraph.associatedCell,t,n,o,s);else{var p=void 0;if(this.owner.viewer instanceof l.D&&e.bodyWidget.sectionFormat.numberOfColumns>1&&e===e.bodyWidget.lastChild&&!i.i(a.isNullOrUndefined)(e.bodyWidget.nextRenderedWidget)&&e.bodyWidget.index!==e.bodyWidget.nextRenderedWidget.index&&e.bodyWidget.page===e.bodyWidget.nextRenderedWidget.page&&(p=e.nextRenderedWidget),this.deletePara(e,n,o,s),this.delBlockContinue&&this.delBlock){if(this.delSection){var u=e.bodyWidget instanceof r.o?e.bodyWidget:void 0;this.deleteSection(t,this.delSection,u,s),this.delSection=void 0}this.deleteBlock(this.delBlock,t,n,o,s),this.delBlockContinue=!1,this.delBlock=void 0}this.owner.viewer instanceof l.D&&void 0!==p&&(this.documentHelper.blockToShift=p)}},e.prototype.mergeCells=function(){!this.owner.isReadOnlyMode&&this.canEditContentControl&&this.owner.isDocumentLoaded&&(i.i(a.isNullOrUndefined)(this.documentHelper)||this.selection.isEmpty||this.mergeSelectedCellsInTable())},e.prototype.deleteTable=function(){if(!this.owner.isReadOnlyMode&&this.canEditContentControl){var e=this.selection.isForward?this.selection.start:this.selection.end;if(e.paragraph.isInsideTable){var t=this.getOwnerTable(this.selection.isForward).combineWidget(this.owner.viewer);this.selection.selectTable();var n=[];this.selection.owner.isShiftingEnabled=!0,this.checkIsNotRedoing()&&(n=this.checkAndRemoveComments(),this.initHistory("DeleteTable"),this.updateHistoryPosition(e,!0));var r=!0;if(!this.skipTracking()){for(var o=0,s=0;s<t.childWidgets.length;s++){var l=t.childWidgets[s];1===l.rowFormat.revisions.length&&"Insertion"===l.rowFormat.revisions[0].revisionType&&l.rowFormat.revisions[0].author===(""===this.owner.currentUser?"Guest user":this.owner.currentUser)&&(this.isRemoveRevision=!0,this.unlinkRangeFromRevision(l.rowFormat,!0),this.isRemoveRevision=!1,0===l.rowFormat.revisions[0].range.length&&l.rowFormat.revisions.splice(0,1),o++)}o===t.childWidgets.length&&(r=!1)}var d=this.getParagraphForSelection(t);if(this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.insertedText=y.c.Table,this.editorHistory.currentBaseHistoryInfo.removedNodes.push(t.clone())),this.owner.enableTrackChanges&&r)for(var s=0;s<t.childWidgets.length;s++){if(0===s){var h=t.childWidgets[0];d=this.selection.getFirstParagraph(h)}this.trackRowDeletion(t.childWidgets[s])}else this.removeBlock(t);this.selection.selectParagraphInternal(d,!0),(this.checkIsNotRedoing()||i.i(a.isNullOrUndefined)(this.editorHistory))&&(this.reLayout(this.selection),this.updateHistoryForComments(n))}}},e.prototype.deleteColumn=function(){if(!this.owner.isReadOnlyMode&&this.canEditContentControl)if(this.owner.enableTrackChanges){var e=new a.L10n("documenteditor",this.owner.defaultLocale);e.setLocale(this.owner.locale),this.alertDialog=w.DialogUtility.alert({title:e.getConstant("UnTrack"),content:e.getConstant("Merge Track"),showCloseIcon:!0,okButton:{text:"Ok",click:this.onDeleteColumnConfirmed.bind(this)},closeOnEscape:!0,position:{X:"center",Y:"center"},animationSettings:{effect:"Zoom"}}),this.alertDialog.enableRtl=this.owner.enableRtl}else this.onDeleteColumnConfirmed()},e.prototype.onDeleteColumnConfirmed=function(){var e=this.selection.isForward?this.selection.start:this.selection.end;this.selection.isForward?this.selection.end:this.selection.start;if(e.paragraph.isInsideTable){this.selection.selectColumn();var t=[];this.selection.owner.isShiftingEnabled=!0,this.checkIsNotRedoing()&&(t=this.checkAndRemoveComments(),this.initHistory("DeleteColumn"));var n=this.getOwnerCell(this.selection.isForward),r=this.getOwnerCell(!this.selection.isForward),o=n.ownerTable.combineWidget(this.owner.viewer);this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.cloneTableToHistoryInfo(o);var s=void 0;if(r.nextWidget){var l=r.nextWidget;s=this.selection.getFirstParagraph(l)}else if(n.previousWidget){var d=n.previousWidget;s=this.selection.getFirstParagraph(d)}i.i(a.isNullOrUndefined)(s)&&(s=this.getParagraphForSelection(o));var h=o.getColumnCellsForSelection(n,r);this.onDeleteColumn(o,h),0===o.childWidgets.length?(s=this.getParagraphForSelection(o),this.removeBlock(o),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.action="DeleteTable"),o.destroy()):this.updateTable(o),this.selection.selectParagraphInternal(s,!0),(i.i(a.isNullOrUndefined)(this.editorHistory)||this.checkIsNotRedoing())&&(this.reLayout(this.selection,!0),this.updateHistoryForComments(t)),i.i(a.isNullOrUndefined)(this.alertDialog)||(this.alertDialog.close(),this.alertDialog=void 0)}},e.prototype.onDeleteColumn=function(e,t){for(var i=0,n=0;n<e.childWidgets.length;n++){var r=e.childWidgets[n];if(1===r.childWidgets.length)t.indexOf(r.childWidgets[0])>=0&&(this.removeFieldInWidget(r.childWidgets[0],!0),e.childWidgets.splice(e.childWidgets.indexOf(r),1),r.destroy(),i+=1,n--);else{for(var o=0;o<r.childWidgets.length;o++){var s=r.childWidgets[o];t.indexOf(s)>=0&&(this.removeFieldInWidget(s,!0),r.childWidgets.splice(o,1),s.destroy(),o--)}0===r.childWidgets.length&&(e.childWidgets.splice(e.childWidgets.indexOf(r),1),r.destroy(),i+=1,n--)}}return i},e.prototype.deleteRow=function(){if(!this.owner.isReadOnlyMode&&this.canEditContentControl){var e=this.selection.isForward?this.selection.start:this.selection.end,t=(this.selection.isForward?this.selection.end:this.selection.start,this.selection.getParagraphInfo(e)),n=this.selection.getHierarchicalIndex(t.paragraph,t.offset.toString());if(e.paragraph.isInsideTable){var r=this.getOwnerCell(this.selection.isForward),o=this.getOwnerCell(!this.selection.isForward);this.selection.selectRow();var s=[];this.checkIsNotRedoing()&&(s=this.checkAndRemoveComments(),this.initHistory("DeleteRow")),this.selection.owner.isShiftingEnabled=!0;var l=r.ownerTable.combineWidget(this.owner.viewer),d=this.getOwnerRow(!0);this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.cloneTableToHistoryInfo(l);var h=void 0;if(d.nextWidget){var c=d.nextWidget.childWidgets[0];h=this.selection.getFirstParagraph(c)}if(i.i(a.isNullOrUndefined)(h)&&(h=this.getParagraphForSelection(l)),e=e.clone(),this.selection.isEmpty)this.owner.enableTrackChanges?this.trackRowDeletion(d,!0,!1):this.removeRow(d);else{var p=this.selection.getContainerCellOf(r,o);if(p.ownerTable.contains(o))if(r=this.selection.getSelectedCell(r,p),o=this.selection.getSelectedCell(o,p),this.selection.containsCell(p,o))d=r.ownerRow,this.owner.enableTrackChanges?(i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)||(this.editorHistory.currentBaseHistoryInfo.action="RemoveRowTrack",this.editorHistory.currentBaseHistoryInfo.insertedText=y.c.Row),this.trackRowDeletion(d,!0,!1)):this.removeRow(d);else{d=r.ownerRow;var u=o.ownerRow;if(h=void 0,u.nextWidget){var c=u.nextWidget.childWidgets[0];h=this.selection.getFirstParagraph(c)}i.i(a.isNullOrUndefined)(h)&&(h=this.getParagraphForSelection(l));for(var g=0;g<l.childWidgets.length;g++){var f=l.childWidgets[g];f.rowIndex>=d.rowIndex&&f.rowIndex<=u.rowIndex&&(this.owner.enableTrackChanges&&this.checkIsNotRedoing()?this.trackRowDeletion(f,!0,!1):(this.removeFieldInBlock(f,!0),l.childWidgets.splice(g,1),f.destroy(),g--))}0===l.childWidgets.length?(this.removeBlock(l),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.action="DeleteTable"),l.destroy()):this.updateTable(l)}}if(!this.owner.enableTrackChanges||i.i(a.isNullOrUndefined)(l.childWidgets))this.selection.selectParagraphInternal(h,!0);else{var m=this.selection.getTextPosBasedOnLogicalIndex(n);this.selection.selectContent(m,!0)}(i.i(a.isNullOrUndefined)(this.editorHistory)||this.checkIsNotRedoing())&&(this.reLayout(this.selection,!0),this.updateHistoryForComments(s))}}},e.prototype.trackRowDeletion=function(e,t,n){var o=e.rowFormat;if(!i.i(a.isNullOrUndefined)(o)){if(o.revisions.length>0){var s=this.retrieveRevisionInOder(o);if("Insertion"===s.revisionType){if(this.isRevisionMatched(o,void 0))return i.i(a.isNullOrUndefined)(t)||t?this.removeRow(e):this.removeRevisionsInRow(e),!0}else"Deletion"===s.revisionType&&this.unlinkWholeRangeInRevision(o,s)}(i.i(a.isNullOrUndefined)(n)||n)&&this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.action="RemoveRowTrack"),this.insertRevision(o,"Deletion"),this.editorHistory.currentBaseHistoryInfo&&"RemoveRowTrack"===this.editorHistory.currentBaseHistoryInfo.action&&this.editorHistory.currentBaseHistoryInfo.buildRowOperationForTrackChanges(o.ownerBase,"RemoveRowTrack");for(var l=0;l<e.childWidgets.length;l++)for(var d=e.childWidgets[l],h=0;h<d.childWidgets.length;h++)if(d.childWidgets[h]instanceof r.u)this.trackInnerTable(d.childWidgets[l],t,n);else{var c=d.childWidgets[h];this.skipTableElements=!0,this.insertRevisionForBlock(c,"Deletion",void 0,void 0,!0),this.skipTableElements=!1}}return!1},e.prototype.trackInnerTable=function(e,t,i){for(var n=0;n<e.childWidgets.length;n++)this.trackRowDeletion(e.childWidgets[n],t,i)},e.prototype.returnDeleteRevision=function(e){for(var t=0;t<e.length;t++)if("Deletion"===e[t].revisionType)return e[t]},e.prototype.removeRow=function(e){var t=e.ownerTable;e.rowFormat.revisions.length>0&&this.removeRevisionsInRow(e),1===t.childWidgets.length?(this.removeBlock(t),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.action="Delete"),t.destroy()):(this.removeFieldInBlock(e,!0),t.childWidgets.splice(t.childWidgets.indexOf(e),1),e.destroy(),this.updateTable(t))},e.prototype.updateTable=function(e,t){t||(e=e.combineWidget(this.viewer)),e.updateRowIndex(0),e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0,this.documentHelper.layout.reLayoutTable(e)},e.prototype.getParagraphForSelection=function(e){var t=void 0,i=e.nextWidget?e.nextWidget:e.nextRenderedWidget,n=e.previousWidget?e.previousWidget:e.previousRenderedWidget;return i?t=i instanceof r.g?i:this.documentHelper.getFirstParagraphInFirstCell(i):n&&(t=n instanceof r.g?n:this.documentHelper.getLastParagraphInLastCell(n)),t},e.prototype.deletePara=function(e,t,n,o){e=e.combineWidget(this.owner.viewer);var s,l=this.documentHelper.selection,d=l.getStartOffset(e),h=l.getStartOffset(n.paragraph),c=d,p=0,u=!1,g=this.selection.getLineLength(e.lastChild),f=e,m=e.bodyWidget instanceof r.o?e.bodyWidget:void 0,v=void 0,y=void 0,w=this.combineLastBlock;e===t.paragraph?(c=t.offset,v=t.currentWidget,s=c,c+1===this.documentHelper.selection.getLineLength(e.lastChild)&&c++,!n.paragraph.isInsideTable||this.owner.enableTrackChanges&&!this.skipTracking()||(u=this.isEndInAdjacentTable(e,n.paragraph)),u||(u=this.combineLastBlock),this.combineLastBlock=!1):v=e.firstChild,e!==t.paragraph&&l.isSkipLayouting&&(l.isSkipLayouting=!1),e===n.paragraph?(y=n.currentWidget,p=n.offset):(y=e.lastChild,p=this.documentHelper.selection.getLineLength(e.lastChild));var b=i.i(a.isNullOrUndefined)(e.previousRenderedWidget)||t.paragraph===e?void 0:e.previousRenderedWidget.combineWidget(this.documentHelper.viewer);if(this.owner.enableTrackChanges&&!i.i(a.isNullOrUndefined)(b)&&b instanceof r.u&&e.isEmpty()&&i.i(a.isNullOrUndefined)(e.nextRenderedWidget))return this.delBlockContinue=!0,void(this.delBlock=b);(c>d&&t.currentWidget===e.lastChild&&c===g&&(e===n.paragraph&&n.offset===c+1||e.nextRenderedWidget===n.paragraph&&n.offset===h)||this.editorHistory&&this.editorHistory.isUndoing&&this.editorHistory.currentHistoryInfo&&"PageBreak"===this.editorHistory.currentHistoryInfo.action&&b&&b.isPageBreak()&&(0===c&&!t.currentWidget.isFirstLine||c>0)||t.paragraph!==n.paragraph&&2===o&&t.paragraph===e&&t.paragraph.nextWidget===n.paragraph||!i.i(a.isNullOrUndefined)(this.editorHistory)&&!i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&("Reject Change"===this.editorHistory.currentBaseHistoryInfo.action&&t.paragraph===e&&n.paragraph!=e&&c>=d||"Accept Change"===this.editorHistory.currentBaseHistoryInfo.action&&t.currentWidget.isLastLine()&&t.currentWidget==n.currentWidget&&t.offset+1==n.offset))&&(u=!0),s+1===this.documentHelper.selection.getLineLength(e.lastChild)&&c--;var x=n.clone();x.offset=x.offset-1;var C=t.paragraph===e&&t.isAtParagraphStart&&x.isAtParagraphEnd&&this.editorHistory&&!i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&"Insert"===this.editorHistory.currentBaseHistoryInfo.action;C&&(this.editorHistory.currentBaseHistoryInfo.action="InsertTextParaReplace");var I=t.paragraph===e;if(n.paragraph===e&&n.currentWidget!==e.lastChild||n.currentWidget===e.lastChild&&n.offset<=l.getLineLength(e.lastChild)||C)if((n.currentWidget.isFirstLine()&&n.offset>d||!n.currentWidget.isFirstLine()||C)&&this.removeInlines(e,v,c,y,p,o),i.i(a.isNullOrUndefined)(b)||I||C)this.delBlockContinue=!1,this.delBlock=void 0;else{this.delBlockContinue=!0,this.delBlock=b;var F=b.bodyWidget instanceof r.o?b.bodyWidget:void 0;F&&!m.equals(F)&&m.index!==F.index?this.delSection=F:this.delSection=void 0}else{if(t.paragraph===e&&(t.currentWidget!==e.firstChild||t.currentWidget===e.firstChild&&c>d))return this.delBlockContinue=!1,this.delBlock=void 0,4===o?void 0:void(this.skipTracking()&&"ParaMarkTrack"===this.editorHistory.currentBaseHistoryInfo.action?(this.addRemovedNodes(e.characterFormat.cloneFormat()),e.characterFormat.revisions.length>0&&this.unlinkRangeFromRevision(e.characterFormat,!0),e.characterFormat.revisions=[]):this.owner.enableTrackChanges&&!this.skipTracking()&&"TOC"!==this.editorHistory.currentBaseHistoryInfo.action&&"Reject Change"!==this.editorHistory.currentBaseHistoryInfo.action?u?(f=this.splitParagraph(e,e.firstChild,0,v,c,!0),this.deleteParagraphMark(f,l,o,!0),this.addRemovedNodes(e)):this.removeInlines(e,v,c,y,p,o):t.currentWidget.isFirstLine()||e.lastChild!==n.currentWidget||u?(!i.i(a.isNullOrUndefined)(this.editorHistory)&&!i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&"Reject Change"===this.editorHistory.currentBaseHistoryInfo.action&&t.paragraph===e&&n.paragraph!=e&&c>=d&&u&&(w=!0),f=this.splitParagraph(e,e.firstChild,0,v,c,!0),this.insertParagraphPaste(e,f,t,n,u,o,w),this.removeRevisionForBlock(e,void 0,!1,!0),this.addRemovedNodes(e),w=!1):this.removeInlines(e,v,c,y,p,o));n.paragraph===e&&n.paragraph.isInsideTable&&(t.currentWidget.isFirstLine()&&t.offset>l.getStartOffset(t.paragraph)||!t.currentWidget.isFirstLine())&&n.offset>=l.getLineLength(n.paragraph.lastChild)&&n.paragraph.nextRenderedWidget&&(this.combineLastBlock=!0);var k=void 0,P=e.previousWidget,T=P instanceof r.g?P:void 0,S=e.nextRenderedWidget;if(o<4){if(this.owner.enableTrackChanges&&!this.skipTracking()&&this.editorHistory.currentBaseHistoryInfo&&"TOC"!==this.editorHistory.currentBaseHistoryInfo.action){var W=-1;this.editorHistory.currentBaseHistoryInfo&&(W=this.editorHistory.currentBaseHistoryInfo.removedNodes.length),this.insertRevisionForBlock(e,"Deletion");var N=e.characterFormat.revisions;if(!(n.paragraph.previousRenderedWidget instanceof r.u)&&N.length>1&&"Insertion"==N[N.length-2].revisionType)if(e.isEmpty())k=this.checkAndInsertBlock(e,t,n,o,T),this.removeBlock(e),-1===W?this.addRemovedNodes(e):this.editorHistory.currentBaseHistoryInfo.removedNodes.splice(W,0,e),this.removeRevisionForBlock(e,void 0,!1,!0);else{for(;0!==e.characterFormat.revisions.length;)this.removePrevParaMarkRevision(e,!0);this.deleteParagraphMark(e,l,o,!1),S=e.nextRenderedWidget}else e.isEmpty()?this.combineRevisionWithBlocks(e):this.combineRevisionWithBlocks(e.firstChild.children[0]);if("Delete"===this.editorHistory.currentBaseHistoryInfo.action&&!this.isInsertingTOC&&(e===n.paragraph&&e.containerWidget&&!e.isEmpty()||i.i(a.isNullOrUndefined)(t.paragraph.containerWidget)&&!i.i(a.isNullOrUndefined)(n.paragraph.containerWidget)&&!n.paragraph.isEmpty())){var H=this.selection.getParagraphInfo(n);this.selection.editPosition=this.selection.getHierarchicalIndex(H.paragraph,H.offset.toString())}if(t.paragraph!==e&&!i.i(a.isNullOrUndefined)(b))return this.delBlockContinue=!0,void(this.delBlock=b)}else{k=this.checkAndInsertBlock(e,t,n,o,T),this.removeRevisionForBlock(e,void 0,!1,!0);var E=e==this.getLastParaForBodywidgetCollection(e);if(this.owner.enableTrackChanges&&E&&!e.isInsideTable&&!i.i(a.isNullOrUndefined)(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&0===this.editorHistory.currentBaseHistoryInfo.removedNodes.length)for(var O=e.childWidgets.length-1;O>-1;O--){var _=e.childWidgets[O];this.removeContent(_,0,this.documentHelper.selection.getLineLength(_),void 0)}else this.addRemovedNodes(e);if(!i.i(a.isNullOrUndefined)(b)&&!I&&!C){this.delBlock=b;var F=b.bodyWidget instanceof r.o?b.bodyWidget:void 0;if(F&&m.index!==F.index){var B=e.bodyWidget instanceof r.o?e.bodyWidget:void 0;this.deleteSection(l,F,B,o)}}this.removeBlock(e)}if(this.documentHelper.blockToShift===e&&(this.documentHelper.blockToShift=void 0),i.i(a.isNullOrUndefined)(k)){if(e===t.paragraph&&(i.i(a.isNullOrUndefined)(S)||!i.i(a.isNullOrUndefined)(S)&&!i.i(a.isNullOrUndefined)(m)&&m.index!==S.bodyWidget.index)&&!i.i(a.isNullOrUndefined)(T)){var L=this.selection.getParagraphLength(T);l.editPosition=this.selection.getHierarchicalIndex(T,L.toString()),this.editorHistory&&!i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&(this.updateHistoryPosition(l.editPosition,!0),this.editorHistory.currentBaseHistoryInfo.endPosition=l.editPosition)}}else{l.editPosition=this.selection.getHierarchicalIndex(k,"0");var L=l.getParagraphLength(k)+1;this.editorHistory&&!i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&(this.editorHistory.currentBaseHistoryInfo.endPosition=this.selection.getHierarchicalIndex(k,L.toString()))}}t.paragraph===e||i.i(a.isNullOrUndefined)(b)?(this.delBlockContinue=!1,this.delBlock=void 0):(this.delBlockContinue=!0,this.delBlock=b)}this.insertParagraphPaste(e,f,t,n,u,o,w)},e.prototype.deleteSection=function(e,t,n,r){if(r<4){if(this.owner.enableCollaborativeEditing){var o=void 0,s=void 0,l=this.owner.documentHelper.headersFooters[t.sectionIndex][0];i.i(a.isNullOrUndefined)(l)||(o={paragraph:l.firstChild,offset:0},s=this.owner.selection.getPositionInfoForHeaderFooter(o,{position:0,done:!1}),this.editorHistory.currentBaseHistoryInfo.headerFooterStart=s.position);var d=Object.keys(this.owner.documentHelper.headersFooters[t.sectionIndex]).length;if(d>0&&(l=this.owner.documentHelper.headersFooters[t.sectionIndex][(d-1).toString()],!i.i(a.isNullOrUndefined)(l))){var h=this.owner.selection.getParagraphLength(l.lastChild);o={paragraph:l.lastChild,offset:h+1},s=this.owner.selection.getPositionInfoForHeaderFooter(o,{position:0,done:!1}),this.editorHistory.currentBaseHistoryInfo.headerFooterEnd=s.position}}this.combineSectionInternal(e,t,n)}r>2&&t.sectionFormat.copyFormat(n.sectionFormat)},e.prototype.combineSectionInternal=function(e,t,i){var n=t.getSplitWidgets()[0],r=[],o=n.y;this.combineSectionChild(n,r,!0),n=r[0];var s=n.lastChild.index;this.updateBlockIndex(s+1,i.firstChild);var a=0,l=i;l.y=o;for(var d=0;d<n.childWidgets.length;d++){var h=n.childWidgets.splice(d,1)[0];l.childWidgets.splice(a,0,h),h.containerWidget=l,this.documentHelper.layout.layoutBodyWidgetCollection(h.index,h.bodyWidget,h,!1),h=h.getSplitWidgets().pop(),l=h.containerWidget,a=h.indexInOwner+1,d--}if(n.sectionIndex>0&&this.documentHelper.headersFooters[n.sectionIndex]){n.removedHeaderFooters=[];for(var c=this.documentHelper.headersFooters.splice(n.sectionIndex,1)[0],p=Object.keys(c),d=0;d<p.length;d++){var u=c[p[d]];this.removeFieldInWidget(u),this.removeFieldInWidget(u,!1,!0),u.page=void 0}n.removedHeaderFooters.push(c)}this.updateSectionIndex(void 0,i,!1),this.addRemovedNodes(n),this.documentHelper.removeEmptyPages(),this.editorHistory&&this.editorHistory.isUndoing&&(i.sectionFormat=t.sectionFormat);var g=i.page;do{this.documentHelper.layout.layoutHeaderFooter(g.bodyWidgets[0],this.viewer,g),g=g.nextPage}while(g)},e.prototype.checkAndInsertBlock=function(e,t,n,o,s){if(e instanceof r.g&&e===t.paragraph||e instanceof r.u){var l=void 0;if(i.i(a.isNullOrUndefined)(e.nextRenderedWidget)&&(i.i(a.isNullOrUndefined)(s)||s.nextRenderedWidget instanceof r.u)){if(l=new r.g,1===o&&e instanceof r.g&&!i.i(a.isNullOrUndefined)(e.paragraphFormat.baseStyle)&&"Normal"===e.paragraphFormat.baseStyle.name){if(l.characterFormat.copyFormat(e.characterFormat),i.i(a.isNullOrUndefined)(e.previousRenderedWidget)&&0!==l.characterFormat.removedIds.length)for(;l.characterFormat.removedIds.length>0;)l.characterFormat.removedIds.splice(0,1);l.paragraphFormat.copyFormat(e.paragraphFormat)}if(l.index=e.index+1,l.containerWidget=e.containerWidget,e instanceof r.g){l.paragraphFormat.lineSpacing=e.paragraphFormat.lineSpacing,l.paragraphFormat.lineSpacingType=e.paragraphFormat.lineSpacingType;var d=this.documentHelper.styles.findByName("Normal");i.i(a.isNullOrUndefined)(d)||(l.paragraphFormat.baseStyle=new g.a,l.paragraphFormat.baseStyle.copyStyle(d))}this.documentHelper.layout.layoutBodyWidgetCollection(l.index,l.bodyWidget,l,!1),e.containerWidget instanceof r.w&&e.containerWidget.childWidgets.push(l)}return l}},e.prototype.splitParagraph=function(e,t,i,n,s,a){var d=new r.g;d.paragraphFormat=new l.F(d),d.characterFormat=new o.a(d),d.paragraphFormat.copyFormat(e.paragraphFormat),d.characterFormat.copyFormat(e.characterFormat);var h=new r.p(d);d.childWidgets.push(h);var c=e.index,p=e.indexInOwner;if(this.moveInlines(e,d,0,i,t,s,n,a),e.containerWidget.childWidgets[p])for(var u=e.containerWidget.childWidgets[p],g=0;g<u.childWidgets.length;g++)for(var f=u.childWidgets[g],m=0;m<f.children.length;m++){var v=f.children[m];v instanceof r.f&&this.removeFootnote(v)}return e.containerWidget.childWidgets.splice(p,0,d),d.index=c,d.containerWidget=e.containerWidget,this.updateNextBlocksIndex(d,!0),a&&this.removeBlock(e),this.documentHelper.layout.layoutBodyWidgetCollection(c,d.containerWidget,d,!1),d},e.prototype.removeCommentsInBlock=function(e){if(e instanceof r.u)for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],n=0;n<i.childWidgets.length;n++)for(var o=i.childWidgets[n],s=0;s<o.childWidgets.length;s++){var a=o.childWidgets[s];this.removeCommentsInBlock(a)}else this.removeCommentInPara(e)},e.prototype.removeCommentInPara=function(e){for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],n=0;n<i.children.length;n++)this.removeCommentsInline(i.children[n])},e.prototype.removeCommentsInline=function(e){e instanceof r.B&&(1===e.commentType||e.removeCommentMark())},e.prototype.removeBlock=function(e,t,n){var o,s;if(n||(this.removeFieldInBlock(e),this.removeFieldInBlock(e,!0),this.removeFieldInBlock(e,void 0,!0),this.removeCommentsInBlock(e)),e.isInsideTable)s=e.associatedCell,o=e.associatedCell.childWidgets.indexOf(e),e.associatedCell.childWidgets,this.updateNextBlocksIndex(e,!1),e.associatedCell.childWidgets.splice(o,1),e.containerWidget=void 0,this.documentHelper.layout.layoutBodyWidgetCollection(e.index,s,e,!1);else{s=e.containerWidget;for(var l=0;l<e.childWidgets.length;l++){var d=void 0;if(this.isPasteRevertAction()||(d=this.skipTracking()),e.childWidgets[l]instanceof r.z&&!d){var h=e.childWidgets[l];this.removeDeletedCellRevision(h)}if(e.childWidgets[l]instanceof r.p)for(var c=e.childWidgets[l],p=0;p<c.children.length;p++){var u=c.children[p];u instanceof r.f&&!this.selection.isEmpty&&this.removeFootnote(u)}}o=s.childWidgets.indexOf(e),s.childWidgets,this.updateNextBlocksIndex(e,!1),s.childWidgets.splice(o,1),e.containerWidget=void 0,s.height-=e.height,!i.i(a.isNullOrUndefined)(s.containerWidget)&&s.containerWidget instanceof r.a&&(s.containerWidget.height-=e.height),this.documentHelper.layout.layoutBodyWidgetCollection(e.index,s,e,!1,t)}},e.prototype.removePrevParaMarkRevision=function(e,t){if(t=!i.i(a.isNullOrUndefined)(t)&&t,this.owner.enableTrackChanges||0!=e.characterFormat.revisions.length){var n=e,r=-1,s=void 0,l=n;if(t||i.i(a.isNullOrUndefined)(l.previousRenderedWidget)||(l=l.previousRenderedWidget),l.characterFormat.revisions.length>0&&(s=l.characterFormat.revisions[l.characterFormat.revisions.length-1],r=s.range.indexOf(l.characterFormat)),r>=0&&!i.i(a.isNullOrUndefined)(s)){s.range[r]instanceof o.a&&(s.range.splice(r,1),this.owner.trackChangesPane.updateCurrentTrackChanges(s),l.characterFormat&&l.characterFormat.revisions.indexOf(s)>-1&&l.characterFormat.revisions.splice(l.characterFormat.revisions.indexOf(s),1),0==s.range.length&&this.owner.revisionsInternal.remove(s))}}},e.prototype.isPasteRevertAction=function(){return!(i.i(a.isNullOrUndefined)(this.editorHistory)||!this.editorHistory.currentBaseHistoryInfo||"Paste"!==this.editorHistory.currentBaseHistoryInfo.action)},e.prototype.toCheckForTrack=function(e){if(this.owner.enableTrackChanges&&!this.skipTracking()&&e instanceof r.u&&e.childWidgets.length>0){var t=e.childWidgets[0].rowFormat;if(t.revisions.length>0&&"Insertion"!==t.revisions[0].revisionType&&t.revisions[0].author===(""===this.owner.currentUser?"Guest user":this.owner.currentUser)||0===t.revisions.length)return!0}return!1},e.prototype.removeFootnote=function(e,t){if(e.paragraph.bodyWidget.page.footnoteWidget){for(var i=e.paragraph.bodyWidget.page.footnoteWidget,n=0;n<i.bodyWidgets.length;n++)if(e===i.bodyWidgets[n].footNoteReference){if(i.height-=i.bodyWidgets[n].childWidgets[0].height,this.owner.enableTrackChanges)for(var r=0;r<i.bodyWidgets[n].childWidgets.length;r++)this.removeRevisionForBlock(i.bodyWidgets[n].childWidgets[r],void 0,!1,!0);i.bodyWidgets.splice(n,1),n--,this.isFootnoteElementRemoved=!0}0===i.bodyWidgets.length&&(e.paragraph.bodyWidget.page.footnoteWidget=void 0)}this.documentHelper.footnoteCollection.splice(this.documentHelper.footnoteCollection.indexOf(e),1),this.updateFootNoteIndex()},e.prototype.removeEndnote=function(e,t){var i=this.documentHelper.pages.length,n=this.documentHelper.pages[i-1].bodyWidgets[0];if(n.page.endnoteWidget){for(var r=n.page.endnoteWidget,o=0;o<r.bodyWidgets.length;o++)e===r.bodyWidgets[o].footNoteReference&&(r.height-=r.bodyWidgets[o].childWidgets[0].height,r.bodyWidgets.splice(o,1),this.isEndnoteElementRemoved=!0,o--);0===r.bodyWidgets.length&&(n.page.endnoteWidget=void 0)}this.documentHelper.endnoteCollection.splice(this.documentHelper.endnoteCollection.indexOf(e),1),this.updateEndNoteIndex()},e.prototype.removeAutoShape=function(e){var t=e.line.paragraph.floatingElements.indexOf(e),i=e.line.paragraph.bodyWidget.floatingElements.indexOf(e);i>-1&&e.line.paragraph.bodyWidget.floatingElements.splice(i,1),e.line.paragraph.floatingElements.splice(t,1)},e.prototype.removeField=function(e,t,n){var o=this.documentHelper.fields;if(t?o=this.documentHelper.bookmarks.keys:n&&(o=this.documentHelper.contentControlCollection),e.floatingElements.length>0)for(var s=0;s<e.floatingElements.length;s++){var l=e.floatingElements[s];this.removeAutoShape(l),s--}for(var d=0;d<o.length;d++){var h=t?this.documentHelper.bookmarks.get(o[d]):o[d];if(h.line.paragraph===e||h instanceof r.e&&!i.i(a.isNullOrUndefined)(h.reference)&&h.reference.line.paragraph===e){if(t){if(this.documentHelper.bookmarks.remove(o[d]),h.line.children.splice(h.indexInOwner,1),!i.i(a.isNullOrUndefined)(h.line.paragraph.associatedCell)){var c=h.line.paragraph.associatedCell;c.isRenderBookmarkStart?c.isRenderBookmarkStart=!1:c.isRenderBookmarkEnd=!1}var p=h.reference;if(p&&p.line.children.splice(p.indexInOwner,1),p&&!i.i(a.isNullOrUndefined)(p.line.paragraph.associatedCell)){var c=p.line.paragraph.associatedCell;c.isRenderBookmarkStart?c.isRenderBookmarkStart=!1:c.isRenderBookmarkEnd=!1}}else n?this.documentHelper.contentControlCollection.splice(d,1):(this.documentHelper.fields.splice(d,1),-1!==this.documentHelper.formFields.indexOf(h)&&this.documentHelper.formFields.splice(this.documentHelper.formFields.indexOf(h),1));d--}}if(this.documentHelper.footnoteCollection.length>0)for(var d=0;d<this.documentHelper.footnoteCollection.length;d++){var h=this.documentHelper.footnoteCollection[d];if(h.line.paragraph===e){if(h.paragraph.bodyWidget.page.footnoteWidget){for(var u=h.paragraph.bodyWidget.page.footnoteWidget,g=0;g<u.bodyWidgets.length;g++)h===u.bodyWidgets[g].footNoteReference&&(u.height-=u.bodyWidgets[g].height,u.bodyWidgets.splice(g,1),g--);0===u.bodyWidgets.length&&(h.paragraph.bodyWidget.page.footnoteWidget=void 0)}this.documentHelper.footnoteCollection.splice(d,1),d--}}if(this.documentHelper.endnoteCollection.length>0)for(var d=0;d<this.documentHelper.endnoteCollection.length;d++){var h=this.documentHelper.endnoteCollection[d];if(h.line.paragraph===e){if(h.paragraph.bodyWidget.page.endnoteWidget){for(var f=h.paragraph.bodyWidget.page.endnoteWidget,g=0;g<f.bodyWidgets.length;g++)h===f.bodyWidgets[g].footNoteReference&&(f.height-=f.bodyWidgets[g].height,f.bodyWidgets.splice(g,1),g--);0===f.bodyWidgets.length&&(h.paragraph.bodyWidget.page.endnoteWidget=void 0)}this.documentHelper.endnoteCollection.splice(d,1),d--}}},e.prototype.getTabsInSelection=function(){var e=[],t=this.owner.selection,n=t.selectedWidgets.keys,r=[];if(0===n.length)return t.start.paragraph.paragraphFormat.getUpdatedTabs();if(t.start.paragraph===t.end.paragraph)return t.start.paragraph.paragraphFormat.getUpdatedTabs();t.start.paragraph!==t.end.paragraph&&(r=this.owner.selection.getParagraphsInSelection());for(var o=r.length>0?r[0]:void 0,s=i.i(a.isNullOrUndefined)(o)?[]:o.paragraphFormat.getUpdatedTabs(),l=!0,d=0;d<s.length;d++)e.push(s[d]);for(var h=1;h<r.length;h++){var c=r[h],p=c.paragraphFormat.getUpdatedTabs(),u=[];l=!0;for(var g=0;g<e.length;g++){for(var d=0;d<p.length;d++)if(p[d].equals(e[g])){l=!1;break}l&&u.push(e[g])}for(var g=0;g<u.length;g++)e.splice(e.indexOf(u[g]),1)}return e},e.prototype.updateTabStopCollection=function(e,t,i){var n=e.paragraphFormat.tabs;if(i){e.paragraphFormat.tabs=[];for(var r=0;r<t.length;r++)e.paragraphFormat.tabs.push(t[r])}else for(var r=0;r<t.length;r++){for(var o=t[r],s=-1,a=0;a<n.length;a++){var l=n[a];if(o.position===l.position){s=a;break}if(o.position<l.position)break}s>=0?this.modifyTabStop(n[s],o):this.addTabStopToCollection(n,o)}},e.prototype.modifyTabStop=function(e,t){e.deletePosition=t.deletePosition,e.tabJustification=t.tabJustification,e.tabLeader=t.tabLeader},e.prototype.removeTabStops=function(e,t){for(var i=0;i<e.length;i++)for(var n=e[i].paragraphFormat.tabs,r=0;r<t.length;r++)for(var o=t[r],s=0;s<n.length;s++)if(n[s].equals(o)){n.splice(s,1);break}},e.prototype.addTabStopToCollection=function(e,t,i){for(var n=-1,r=0;r<e.length;r++){if(e[r].position>t.position){n=r;break}}return n=-1===n?e.length:n,i?n:(e.splice(n,0,t.clone()),n)},e.prototype.addRemovedNodes=function(e,t){e instanceof r.B&&0===e.commentType&&e.commentMark&&e.removeCommentMark(),e instanceof r.H&&0===e.type&&this.documentHelper.contentControlCollection.splice(this.documentHelper.contentControlCollection.indexOf(e),1),e instanceof r.b&&0===e.fieldType&&(-1!==this.documentHelper.fields.indexOf(e)&&this.documentHelper.fields.splice(this.documentHelper.fields.indexOf(e),1),-1!==this.documentHelper.formFields.indexOf(e)&&this.documentHelper.formFields.splice(this.documentHelper.formFields.indexOf(e),1)),this.editorHistory&&!i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)?t?this.editorHistory.currentBaseHistoryInfo.removedNodes.splice(0,0,e):this.editorHistory.currentBaseHistoryInfo.removedNodes.push(e):this.editHyperlinkInternal&&this.nodes.push(e)},e.prototype.deleteBlock=function(e,t,i,n,o){if(e instanceof r.g){if(this.deletePara(e,i,n,o),this.delBlockContinue&&this.delBlock){if(this.delSection){var s=e.bodyWidget instanceof r.o?e.bodyWidget:void 0;this.deleteSection(t,this.delSection,s,o),this.delSection=void 0}-1!==this.delBlock.indexInOwner&&this.deleteBlock(this.delBlock,t,i,n,o),this.delBlockContinue=!1,this.delBlock=void 0}}else this.deleteTableBlock(e,t,i,n,o),this.owner.enableTrackChanges&&!this.skipTracking()&&this.documentHelper.layout.reLayoutTable(e)},e.prototype.deleteTableCell=function(e,t,n,o,s){var l=!(n.paragraph.isInsideTable&&e.ownerTable.contains(n.paragraph.associatedCell)),d=e.ownerTable.previousRenderedWidget;if(n.paragraph.isInsideTable){var h=t.getContainerCellOf(e,n.paragraph.associatedCell);if(h.ownerTable.contains(n.paragraph.associatedCell)){var c=t.getSelectedCell(e,h);t.getSelectedCell(n.paragraph.associatedCell,h);if(t.containsCell(h,n.paragraph.associatedCell))if(t.isCellSelected(h,n,o))if(this.updateEditPosition(h,t),1===s)this.deleteCellsInTable(e.ownerRow.ownerTable,t,n,o,s);else{var p=this.deleteCell(h,t,s,!0);!p&&2!==s&&this.editorHistory?this.editorHistory.currentBaseHistoryInfo=void 0:p&&this.documentHelper.layout.reLayoutTable(h.ownerRow.ownerTable)}else if(c===h){if(this.deletePara(o.paragraph,n,o,s),this.delBlockContinue&&this.delBlock){if(this.delSection){var u=o.paragraph,g=u.bodyWidget instanceof r.o?u.bodyWidget:void 0;this.deleteSection(t,this.delSection,g,s),this.delSection=void 0}this.deleteBlock(this.delBlock,t,n,o,s),this.delBlockContinue=!1,this.delBlock=void 0}}else this.deleteContainer(c,t,n,o,s);else 2===s?this.deleteCell(e,t,2,!1):this.deleteCellsInTable(h.ownerTable,t,n,o,s)}else this.deleteContainer(h,t,n,o,s)}else{var f=t.getContainerCell(e);i.i(a.isNullOrUndefined)(this.editorHistory)||!this.editorHistory.isUndoing&&!this.editorHistory.isRedoing?this.deleteContainer(f,t,n,o,s):(this.deleteTableBlock(f.ownerTable,t,n,o,s),l=!1)}if(l){d.bodyWidget instanceof r.o&&d.bodyWidget;i.i(a.isNullOrUndefined)(d)||this.deleteBlock(d,t,n,o,s)}},e.prototype.deleteCellsInTable=function(e,t,n,r,o,s){var l="Delete",d=!1,h=n.paragraph.associatedCell,c=r.paragraph.associatedCell;if(i.i(a.isNullOrUndefined)(s)||(c=s),this.editorHistory&&!i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)){if(l=this.editorHistory.currentBaseHistoryInfo.action,d="BackSpace"===this.editorHistory.currentBaseHistoryInfo.action||"DeleteCells"===this.editorHistory.currentBaseHistoryInfo.action||"InsertTable"===this.editorHistory.currentBaseHistoryInfo.action||"RemoveRowTrack"===this.editorHistory.currentBaseHistoryInfo.action||i.i(a.isNullOrUndefined)(h.ownerRow.previousWidget)&&i.i(a.isNullOrUndefined)(c.ownerRow.nextWidget)&&"Cut"===this.editorHistory.currentBaseHistoryInfo.action,this.cloneTableToHistoryInfo(e),this.editorHistory.isRedoing&&"RemoveRowTrack"===this.editorHistory.currentBaseHistoryInfo.action)for(var p=0;p<e.childWidgets.length;p++)this.trackRowDeletion(e.childWidgets[p]);if("RemoveRowTrack"===this.editorHistory.currentBaseHistoryInfo.action)return;this.editorHistory.currentBaseHistoryInfo.action=d?"DeleteCells":"ClearCells",t.owner.isLayoutEnabled=!1}var u=h.columnIndex,g=c.columnIndex+c.cellFormat.columnSpan-1,f=h.rowIndex,m=c.rowIndex,v=this.isWholeRowSelected(h.ownerRow,u,g);if(this.owner.enableTrackChanges&&!this.skipTracking())if(v)this.onConfirmedTableCellsDeletion(e,t,f,m,u,g,d,o,v,l);else{var y=new a.L10n("documenteditor",this.owner.defaultLocale),b=y.getConstant("UnTrack"),x=y.getConstant("Merge Track");y.setLocale(this.owner.locale),this.alertDialog=w.DialogUtility.alert({title:b,content:x,showCloseIcon:!0,okButton:{text:"Ok",click:this.onConfirmedTableCellsDeletion.bind(this,e,t,f,m,u,g,d,o,v,l)},closeOnEscape:!0,position:{X:"center",Y:"center"},animationSettings:{effect:"Zoom"}}),this.alertDialog.enableRtl=this.owner.enableRtl}else this.onConfirmedTableCellsDeletion(e,t,f,m,u,g,d,o,v,l)},e.prototype.removeDeletedCellRevision=function(e){e.rowFormat.revisions.length>0&&this.unlinkRangeFromRevision(e.rowFormat,!0);for(var t=0;t<e.childWidgets.length;t++)for(var n=e.childWidgets[t],o=0;o<n.childWidgets.length;o++){var s=n.childWidgets[o];if(!i.i(a.isNullOrUndefined)(s)&&s instanceof r.g){for(var l=0;l<s.childWidgets.length;l++){var d=s.childWidgets[l];if(!i.i(a.isNullOrUndefined)(d.children))for(var h=0;h<d.children.length;h++){var c=d.children[h];c.revisions.length>0&&this.unlinkRangeFromRevision(c,!0)}}this.unlinkRangeFromRevision(s.characterFormat,!0)}}},e.prototype.onConfirmedTableCellsDeletion=function(e,t,n,r,o,s,l,d,h,c){for(var p=0;p<e.childWidgets.length;p++){var u=e.childWidgets[p],g=!1;if(u.index>=n&&u.index<=r&&(this.owner.enableTrackChanges&&!this.skipTracking()&&h?(g=this.trackRowDeletion(u,!1))&&this.onConfirmedCellDeletion(u,t,n,r,o,s,l,d):this.onConfirmedCellDeletion(u,t,n,r,o,s,l,d)),!g&&0===u.childWidgets.length){for(var f=e.childWidgets[p],m=f.previousRenderedWidget;!i.i(a.isNullOrUndefined)(m);){for(var v=0;v<m.childWidgets.length;v++){var y=m.childWidgets[v];f.rowIndex<y.ownerRow.rowIndex+y.cellFormat.rowSpan&&y.cellFormat.rowSpan--}m=m.previousRenderedWidget}this.updateNextBlocksIndex(f,!1),e.childWidgets.splice(p,1),p--,r--}}if(t.owner.isLayoutEnabled=!0,0===e.childWidgets.length?(t.editPosition=this.selection.getHierarchicalIndex(e,"0"),this.setActionInternal(t,c),this.removeBlock(e)):(e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0,this.documentHelper.layout.reLayoutTable(e)),!i.i(a.isNullOrUndefined)(this.alertDialog)){var w=t.getTextPosBasedOnLogicalIndex(t.editPosition);t.selectContent(w,!0),this.reLayout(t),this.alertDialog.close(),this.alertDialog=void 0}},e.prototype.onConfirmedCellDeletion=function(e,t,i,n,o,s,a,l){var d=!1;this.removeDeletedCellRevision(e);for(var h=0;h<e.childWidgets.length;h++){var c=e.childWidgets[h];if(c.columnIndex>=o&&c.columnIndex<=s)if(d||(this.updateEditPosition(c,t),d=!0),a){var p=e.childWidgets[h];this.updateNextBlocksIndex(p,!1);for(var u=0;u<p.childWidgets.length;u++)for(var g=p.childWidgets[u],f=0;f<g.childWidgets.length;f++){var m=g.childWidgets[f];if(m instanceof r.p)for(var v=m,y=0;y<v.children.length;y++){var w=v.children[y];w instanceof r.f&&this.removeFootnote(w)}}e.childWidgets.splice(h,1),h--}else l<4&&this.deleteCell(c,t,l,!1)}},e.prototype.removeRevisionForRow=function(e){e.rowFormat.revisions.length>0&&this.skipTracking()&&(this.unlinkRangeFromRevision(e.rowFormat,!0),this.addRemovedRevisionInfo(e.rowFormat,void 0))},e.prototype.removeRevisionsInRow=function(e){if(e.rowFormat.revisions.length>0)for(var t=0;t<e.rowFormat.revisions.length;t++){var i=e.rowFormat.revisions[t];this.unlinkWholeRangeInRevision(e.rowFormat,i)}},e.prototype.removeRevisionForCell=function(e,t){for(var n=0;n<e.childWidgets.length;n++)if(e.childWidgets[n]instanceof r.g)for(var o=e.childWidgets[n],s=0;s<o.childWidgets.length;s++)for(var l=o.childWidgets[s],d=0;d<l.children.length;d++){var h=l.children[d];!i.i(a.isNullOrUndefined)(h)&&h.revisions.length>0&&(this.unlinkRangeFromRevision(h,t),this.addRemovedRevisionInfo(h,void 0))}else e.childWidgets[n]instanceof r.u&&this.removeRevisionForInnerTable(e.childWidgets[n])},e.prototype.removeRevisionForInnerTable=function(e){if(e.childWidgets.length>0)for(var t=0;t<e.childWidgets.length;t++){var n=e.childWidgets[t];i.i(a.isNullOrUndefined)(n)||this.removeRevisionForRow(n)}},e.prototype.removeRevisionForBlock=function(e,t,n,r){if(e.characterFormat.revisions.length>0&&!n&&(r&&this.addRemovedRevisionInfo(e.characterFormat,void 0,!1),i.i(a.isNullOrUndefined)(t)?this.unlinkRangeFromRevision(e.characterFormat,!0):this.unlinkRangeByRevision(e.characterFormat,t),e.characterFormat.revisions=[]),!i.i(a.isNullOrUndefined)(e))for(var o=0;o<e.childWidgets.length;o++)for(var s=e.childWidgets[o],l=0;l<s.children.length;l++){var d=s.children[l];!i.i(a.isNullOrUndefined)(d)&&d.revisions.length>0&&(r&&this.addRemovedRevisionInfo(d,void 0,!1),i.i(a.isNullOrUndefined)(t)?this.unlinkRangeFromRevision(d,!0):this.unlinkRangeByRevision(d,t),d.revisions=[])}},e.prototype.unlinkRangeByRevision=function(e,t){for(var i=0;i<e.revisions.length;i++){var n=e.revisions[i];if(n.author===t.author&&n.revisionType===t.revisionType){e.revisions.splice(e.revisions.indexOf(t),1);var r=t.range.indexOf(e);t.range.splice(r,1),this.owner.trackChangesPane.updateCurrentTrackChanges(t)}}},e.prototype.isWholeRowSelected=function(e,t,i){var n=t+i;return 0===t&&e.childWidgets.length-1===n},e.prototype.deleteCell=function(e,t,i,n){var o=e.childWidgets[0];if(1===e.childWidgets.length&&o instanceof r.g&&o.isEmpty())return!1;for(var s=e.childWidgets.length-1,a=e.childWidgets.length-1;a>-1;a--)if(o=e.childWidgets[a],i<4){if(o instanceof r.g&&a===s){var l=o;if(this.checkClearCells(t))l.isEmpty()||this.removeInlines(l,l.firstChild,0,l.lastChild,l.lastChild.getEndOffset(),i);else for(var d=l.childWidgets.length-1;d>=0;d--){for(var h=l.childWidgets[d],c=h.children.length-1;c>=0;c--){var p=h.children[c];p instanceof r.f?this.removeFootnote(p):p instanceof r.e&&0===p.bookmarkType&&this.documentHelper.bookmarks.containsKey(p.name)&&this.documentHelper.bookmarks.remove(p.name),this.unLinkFieldCharacter(p),h.children.splice(c,1)}l.childWidgets.length>1&&l.childWidgets.splice(d,1)}continue}this.removeBlock(o),this.checkClearCells(t)&&(this.addRemovedNodes(o),1===e.childWidgets.length&&(t.editPosition=this.selection.getHierarchicalIndex(e.childWidgets[0],"0"),this.updateHistoryPosition(t.editPosition,!0)))}return!0},e.prototype.paragrapghBookmarkCollection=function(e,t){for(var i=this.documentHelper.bookmarks,n=0;n<i.length;n++){var r=this.documentHelper.bookmarks.get(i.keys[n]);r.paragraph===e&&t.push(r)}return t},e.prototype.deleteContainer=function(e,t,i,n,r){var o=e.ownerTable;if(t.containsRow(o.lastChild,n.paragraph.associatedCell)&&!this.owner.enableTrackChanges)this.deleteContent(o,t,r);else if(this.toCheckForTrack(o)){this.cloneTableToHistoryInfo(o);for(var s=0;s<o.childWidgets.length;s++){var a=o.childWidgets[s];if(this.trackRowDeletion(a),n.paragraph.isInsideTable&&t.containsRow(a,n.paragraph.associatedCell))return void this.documentHelper.layout.reLayoutTable(o)}}else for(var s=0;s<o.childWidgets.length;s++){var l=o.childWidgets[s];if(r<4&&(this.updateNextBlocksIndex(l,!1),o.childWidgets.splice(s,1),this.addRemovedNodes(l),s--),n.paragraph.isInsideTable&&t.containsRow(l,n.paragraph.associatedCell))return void this.documentHelper.layout.reLayoutTable(o)}},e.prototype.deleteTableBlock=function(e,t,n,o,s){if(e=e.combineWidget(this.owner.viewer),n.paragraph.isInsideTable&&e.contains(n.paragraph.associatedCell)){var l=e.previousRenderedWidget,d=this.checkAndInsertBlock(e,n,o,s,l instanceof r.g?l:void 0);if(t.containsRow(e.firstChild,n.paragraph.associatedCell))if(this.owner.enableTrackChanges){this.cloneTableToHistoryInfo(e);for(var h=0;h<e.childWidgets.length;h++)this.trackRowDeletion(e.childWidgets[h]);i.i(a.isNullOrUndefined)(this.editorHistory)||!this.editorHistory.isUndoing&&!this.editorHistory.isRedoing||this.removeBlock(e)}else this.deleteContent(e,t,s);else if(this.owner.enableTrackChanges){if(i.i(a.isNullOrUndefined)(o.paragraph.associatedCell)&&!o.paragraph.isInsideTable){var c=o.paragraph.previousRenderedWidget.lastChild,p=c.lastChild;this.deleteCellsInTable(e,t,n,o,s,p)}}else{var u=this.splitTable(e,n.paragraph.associatedCell.ownerRow);this.deleteContent(e,t,s),this.documentHelper.layout.layoutBodyWidgetCollection(u.index,u.containerWidget,u,!1)}i.i(a.isNullOrUndefined)(d)||(t.editPosition=this.selection.getHierarchicalIndex(d,"0"),this.editorHistory&&!i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&(this.editorHistory.currentBaseHistoryInfo.endPosition=t.editPosition))}else{var g=e.previousRenderedWidget;e.bodyWidget instanceof r.o&&e.bodyWidget;if(this.owner.enableTrackChanges){this.cloneTableToHistoryInfo(e);for(var h=0;h<e.childWidgets.length;h++)this.trackRowDeletion(e.childWidgets[h]);i.i(a.isNullOrUndefined)(this.editorHistory)||!this.editorHistory.isUndoing&&!this.editorHistory.isRedoing||this.removeBlock(e)}else this.deleteContent(e,t,s);i.i(a.isNullOrUndefined)(g)||this.deleteBlock(g,t,n,o,s)}},e.prototype.splitTable=function(e,t){var i=new r.u;i.tableFormat.copyFormat(e.tableFormat),i.index=e.index;for(var n=0;n<e.childWidgets.length;n++){var o=e.childWidgets[n];if(o===t)break;i.childWidgets.push(o),o.containerWidget=i,e.childWidgets.splice(n,1),n--}var s=e.getIndex();return e.containerWidget.childWidgets.splice(s,0,i),i.containerWidget=e.containerWidget,this.updateNextBlocksIndex(i,!0),i},e.prototype.updateEditPosition=function(e,t){var i=this.documentHelper.getFirstParagraphInCell(e);t.editPosition=this.selection.getHierarchicalIndex(i,"0")},e.prototype.deleteContent=function(e,t,i){i<4&&(this.removeBlock(e),this.addRemovedNodes(e))},e.prototype.setActionInternal=function(e,t){this.documentHelper.owner.enableHistoryMode&&!i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&(this.editorHistory.currentBaseHistoryInfo.action=t)},e.prototype.checkClearCells=function(e){return this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&"ClearCells"!==this.editorHistory.currentBaseHistoryInfo.action},e.prototype.isEndInAdjacentTable=function(e,t){var i=this.selection.getHierarchicalIndex(e,""),n=this.selection.getHierarchicalIndex(t,""),r=i.split(";"),o=n.split(";");return r.length<o.length},e.prototype.cloneTableToHistoryInfo=function(e){if(this.editorHistory&&!i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)){var t=e.clone();return t.index=e.index,this.editorHistory.currentBaseHistoryInfo.removedNodes.push(t),this.documentHelper.selection.start.paragraph.isInsideTable&&this.documentHelper.selection.start.paragraph.associatedCell.ownerTable===e&&this.updateHistoryPosition(this.selection.getHierarchicalIndex(e,"0"),!0),t}},e.prototype.insertParagraphPaste=function(e,t,n,r,o,s,l){if(this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&!i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&"Paste"===this.editorHistory.currentBaseHistoryInfo.action){var d=this.selection.getNextParagraphBlock(t);if(d&&n.offset>0&&d===r.paragraph&&e===n.paragraph&&"Paste"===this.editorHistory.currentBaseHistoryInfo.action){var h=0;this.removeBlock(t),this.documentHelper.layout.clearListElementBox(d),this.documentHelper.layout.clearListElementBox(t);for(var c=0;c<t.childWidgets.length;c++){var p=t.childWidgets[c];d.childWidgets.splice(h,0,p),t.childWidgets.splice(c,1),c--,h++,p.paragraph=d}this.documentHelper.layout.reLayoutParagraph(d,0,0),o=!1;var u=this.selection.editPosition.substring(this.selection.editPosition.lastIndexOf(";")+1);this.selection.editPosition=this.selection.getHierarchicalIndex(d,u)}}o&&this.deleteParagraphMark(t,this.selection,s,!1,l)},e.prototype.removeInlines=function(e,t,i,n,r,o){var s=!1;this.documentHelper.layout.clearListElementBox(e);for(var a=(e.childWidgets.indexOf(t),this.selection.start.clone()),l=this.selection.end.clone(),d=this.selection.editPosition,h=e.childWidgets.length-1;h>=0;h--){var c=e.childWidgets[h];if(t===c&&n===c){this.removeContent(c,i,r,o),s=!0;break}if(n===c)e.isLayouted=!1,s=!0,this.removeContent(c,0,r,o);else{if(t===c){this.removeContent(c,i,this.documentHelper.selection.getLineLength(c),o);break}s&&this.removeContent(c,0,this.documentHelper.selection.getLineLength(c),o)}}this.owner.enableTrackChanges&&!this.skipTracking()&&(this.selection.start.setPositionInternal(a),this.selection.end.setPositionInternal(l),this.skipReplace&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=void 0,this.updateInsertPosition()),this.selection.editPosition=d),s&&(e.isLayouted=!0,this.removeEmptyLine(e),this.documentHelper.layout.reLayoutParagraph(e,0,0))},e.prototype.skipTracking=function(){return!(i.i(a.isNullOrUndefined)(this.editorHistory)||!this.editorHistory.isUndoing&&!this.editorHistory.isRedoing)||!(i.i(a.isNullOrUndefined)(this.editorHistory)||!this.editorHistory.currentBaseHistoryInfo||"Reject Change"!==this.editorHistory.currentBaseHistoryInfo.action&&"Accept Change"!==this.editorHistory.currentBaseHistoryInfo.action)},e.prototype.canHandleDeletion=function(){return!(i.i(a.isNullOrUndefined)(this.editorHistory)||!this.editorHistory.currentBaseHistoryInfo||"DeleteRow"!==this.editorHistory.currentBaseHistoryInfo.action)},e.prototype.deleteCommentInSelection=function(e){var t=this.editorHistory.currentBaseHistoryInfo;!this.editorHistory||!this.editorHistory.currentBaseHistoryInfo||this.editorHistory.currentHistoryInfo||this.editorHistory.isUndoing||this.editorHistory.isRedoing||this.initComplexHistory("DeleteCommentInline"),this.deleteCommentInternal(e),this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing||this.editorHistory.currentHistoryInfo.addModifiedAction(t),this.selection.editPosition=t.insertPosition,this.editorHistory.currentHistoryInfo.insertPosition=this.selection.editPosition,this.editorHistory.currentBaseHistoryInfo=t)},e.prototype.removeContent=function(e,t,n,o,s){for(var l=this.selection.getLineLength(e),d=void 0,h=0,c=void 0,p=e.children.length-1;p>=0;p--){var u=e.children[p];if(i.i(a.isNullOrUndefined)(o)||2!==o&&1!==o)for(var g=0;g<e.children.length;g++){var f=e.children[g];if(f instanceof r.d){var m=f.text;m.length+h>t&&!(h>t)&&(d=m[t-h-1],i.i(a.isNullOrUndefined)(d)&&t-h==0&&(d=c)),m.length+h>n&&(" "===m[n-h]&&0===t||" "===d&&" "===m[n-h])&&(n+=1),c=m[m.length-1]}h+=f.length}if(n<=l-u.length)l-=u.length;else{var v=u.length;l>n&&l-v<n&&(v=n-(l-u.length));var y=0;if(l-u.length<t&&(y=t-(l-u.length)),l>n&&(l-=u.length-v),0===y&&v===u.length){if((!this.owner.enableTrackChanges||this.owner.enableTrackChanges&&this.skipTracking())&&(this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)||u instanceof r.e&&this.removedBookmarkElements.push(u),u instanceof r.e&&this.documentHelper.bookmarks.containsKey(u.name)&&(this.owner.enableCollaborativeEditing&&!i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&this.editorHistory.currentBaseHistoryInfo.markerData.push({bookmarkName:u.name}),this.documentHelper.bookmarks.remove(u.name))),(u instanceof r.r&&"Inline"!==u.textWrappingStyle||u instanceof r.s)&&this.removeAutoShape(u),this.skipFieldDeleteTracking&&u.revisions.length>0){var w=u;w instanceof r.b&&(1!==w.fieldType&&2!==w.fieldType||(w=w.fieldBegin),this.clearFieldElementRevisions(w,u.revisions))}this.canHandleDeletion()||this.owner.enableTrackChanges&&(!this.skipTracking()||u.paragraph.isInsideTable&&!i.i(a.isNullOrUndefined)(this.editorHistory)&&this.editorHistory.isRedoing&&this.editorHistory.currentBaseHistoryInfo&&"RemoveRowTrack"===this.editorHistory.currentBaseHistoryInfo.action)&&!this.skipFieldDeleteTracking&&!this.isInsertingTOC?(this.skipTableElements||this.skipFootNoteDeleteTracking||s||this.addRemovedNodes(u.clone()),this.handleDeleteTracking(u,t,n,p)):(u instanceof r.f&&(u.isLayout=!1),this.unLinkFieldCharacter(u),this.unlinkRangeFromRevision(u,!0),this.addRemovedRevisionInfo(u,void 0),!i.i(a.isNullOrUndefined)(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&"RemoveRowTrack"===this.editorHistory.currentBaseHistoryInfo.action&&u.paragraph.isInsideTable||this.addRemovedNodes(u),u instanceof r.G?(this.removedEditRangeStartElements.push(u),-1!=u.columnFirst&&-1!=u.columnLast&&this.removeEditRangeFromCollection(u)):u instanceof r.F&&this.removedEditRangeEndElements.push(u),e.children.splice(p,1),!i.i(a.isNullOrUndefined)(e.layoutedElements)&&e.layoutedElements.length>0&&e.layoutedElements.splice(p,1))}else if(u instanceof r.d){var b=this.handleDeleteTracking(u,y,v);i.i(a.isNullOrUndefined)(b)||this.skipTableElements||(u.revisions.length>0&&this.addRemovedRevisionInfo(u,b),this.addRemovedNodes(b))}if((!this.owner.enableTrackChanges||this.editorHistory.isUndoing)&&u instanceof r.f&&("Footnote"===u.footnoteType?this.removeFootnote(u):this.removeEndnote(u)),t>=l-(v-y))break;l-=v-y,this.documentHelper.layout.clearListElementBox(e.paragraph)}}},e.prototype.deleteCommentWidgetInline=function(e){},e.prototype.clearFieldElementRevisions=function(e,t){for(var i=t,n=0;n<i.length;n++)for(var o=i[n],s=0;s<o.range.length;s++)if(o.range[s]===e)for(var a=s;a<o.range.length;a){if(o.range[s]instanceof r.b&&1===o.range[s].fieldType&&o.range[s].fieldBegin===e){o.removeRangeRevisionForItem(o.range[s]),0===o.range.length&&this.owner.revisions.remove(o);break}o.removeRangeRevisionForItem(o.range[s])}},e.prototype.addRemovedRevisionInfo=function(e,t,n){for(var r=0;r<e.revisions.length;r++){var o=e.revisions[r].revisionID;i.i(a.isNullOrUndefined)(t)?e.removedIds.push(o):t.removedIds.push(o)}i.i(a.isNullOrUndefined)(t)&&(i.i(a.isNullOrUndefined)(n)||n)&&(e.revisions=[])},e.prototype.removeEmptyLine=function(e){if(e.childWidgets.length>1)for(var t=0;t<e.childWidgets.length;t++){var i=e.childWidgets[t];0===i.children.length&&e.childWidgets.length>1&&(e.childWidgets.splice(t,1),t--)}},e.prototype.cloneListLevel=function(e){var t=new c.a(void 0);return this.copyListLevel(t,e),t},e.prototype.copyListLevel=function(e,t){i.i(a.isNullOrUndefined)(t.paragraphFormat)||(e.paragraphFormat=new l.F(e),e.paragraphFormat.copyFormat(t.paragraphFormat)),i.i(a.isNullOrUndefined)(t.characterFormat)||(e.characterFormat=new o.a(e),e.characterFormat.copyFormat(t.characterFormat)),i.i(a.isNullOrUndefined)(t.followCharacter)||(e.followCharacter=t.followCharacter),i.i(a.isNullOrUndefined)(t.listLevelPattern)||(e.listLevelPattern=t.listLevelPattern),i.i(a.isNullOrUndefined)(t.numberFormat)||(e.numberFormat=t.numberFormat),i.i(a.isNullOrUndefined)(t.restartLevel)||(e.restartLevel=t.restartLevel),i.i(a.isNullOrUndefined)(t.startAt)||(e.startAt=t.startAt)},e.prototype.cloneLevelOverride=function(e){var t=new p.a;return i.i(a.isNullOrUndefined)(e.startAt)||(t.startAt=e.startAt),i.i(a.isNullOrUndefined)(e.overrideListLevel)||(t.overrideListLevel=e.overrideListLevel),i.i(a.isNullOrUndefined)(e.levelNumber)||(t.levelNumber=e.levelNumber),t},e.prototype.updateListParagraphs=function(){this.documentHelper.listParagraphs=[];for(var e=0;e<this.documentHelper.pages.length;e++)for(var t=this.documentHelper.pages[e].bodyWidgets[0],i=0;i<t.childWidgets.length;i++)this.updateListParagraphsInBlock(t.childWidgets[i])},e.prototype.updateListParagraphsInBlock=function(e){if(e instanceof r.g)i.i(a.isNullOrUndefined)(e.paragraphFormat)||i.i(a.isNullOrUndefined)(e.paragraphFormat.listFormat)||i.i(a.isNullOrUndefined)(e.paragraphFormat.listFormat.listId)||(e.paragraphFormat.listFormat.listId>=0&&e.paragraphFormat.clearIndent(),i.i(a.isNullOrUndefined)(this.documentHelper.listParagraphs)&&(this.documentHelper.listParagraphs=[]),this.documentHelper.listParagraphs.push(e));else if(e instanceof r.u)for(var t=0;t<e.childWidgets.length;t++)for(var n=0;n<e.childWidgets[t].childWidgets.length;n++)for(var o=e.childWidgets[t].childWidgets[n],s=0;s<o.childWidgets.length;s++)this.updateListParagraphsInBlock(o.childWidgets[s])},e.prototype.onApplyList=function(e){var t=this.documentHelper.selection;this.setOffsetValue(this.documentHelper.selection),this.initHistory("ListFormat");var n=new l.K;i.i(a.isNullOrUndefined)(e)||(n.listId=e.listId,n.nsid=e.nsid),this.documentHelper.owner.isShiftingEnabled=!0,t.isEmpty?(this.applyParaFormatProperty(t.start.paragraph,"listFormat",n,!1),this.layoutItemBlock(t.start.paragraph,!1)):this.updateSelectionParagraphFormatting("listFormat",n,!1),this.documentHelper.owner.isShiftingEnabled=!0,this.layoutWholeDocument(),this.documentHelper.owner.isShiftingEnabled=!1,this.startParagraph=void 0,this.endParagraph=void 0},e.prototype.applyBulletOrNumbering=function(e,t,n){var o=this.documentHelper.selection,l=o.paragraphFormat.getList(),p=!1,u=o.start;o.isForward||(u=o.end);var g=u.paragraph;if(i.i(a.isNullOrUndefined)(l)){for(;!i.i(a.isNullOrUndefined)(g.previousWidget)&&g.previousWidget instanceof r.g&&g.previousWidget.isEmpty()&&-1===g.previousWidget.paragraphFormat.listFormat.listId;)g=g.previousWidget;if(g.previousWidget&&g.previousWidget instanceof r.g&&-1!==g.previousWidget.paragraphFormat.listFormat.listId){for(var f=!1;!i.i(a.isNullOrUndefined)(g.previousWidget)&&g.previousWidget instanceof r.g&&-1!==g.previousWidget.paragraphFormat.listFormat.listId&&u.paragraph.paragraphFormat.firstLineIndent<Math.abs(g.previousWidget.paragraphFormat.firstLineIndent);)g=g.previousWidget,f=!0;f||(g=g.previousWidget),l=this.documentHelper.getListById(g.paragraphFormat.listFormat.listId),p=!0}if(!p){for(;!i.i(a.isNullOrUndefined)(g.nextWidget)&&g.nextWidget instanceof r.g&&g.nextWidget.isEmpty()&&-1===g.nextWidget.paragraphFormat.listFormat.listId;)g=g.nextWidget;g.nextWidget&&g.nextWidget instanceof r.g&&-1!==g.nextWidget.paragraphFormat.listFormat.listId&&(g=g.nextWidget,l=this.documentHelper.getListById(g.paragraphFormat.listFormat.listId),p=!0)}}var m=void 0,v=-1,y=void 0,w=!1;if(-1===g.paragraphFormat.listFormat.listId||i.i(a.isNullOrUndefined)(g.paragraphFormat.listFormat.listLevel)||(this.listNumberFormat=g.paragraphFormat.listFormat.listLevel.numberFormat,this.listLevelPattern=g.paragraphFormat.listFormat.listLevel.listLevelPattern,this.listLevelNumber=g.paragraphFormat.listFormat.listLevelNumber),!i.i(a.isNullOrUndefined)(l)){v=g.paragraphFormat.listFormat.listLevelNumber;var b=this.documentHelper.getListById(g.paragraphFormat.listFormat.listId);m=this.documentHelper.layout.getListLevel(b,v),v>0&&(y=this.documentHelper.layout.getListLevel(b,0),w=!i.i(a.isNullOrUndefined)(y)&&v>0&&o.start.isInSameParagraph(o.end));var x=b.abstractList;if(x||(x=this.documentHelper.getAbstractListById(l.abstractListId)),0===x.levels.length&&(m=this.documentHelper.layout.getListLevel(b,g.paragraphFormat.listFormat.listLevelNumber)),p){if("Bullet"!==t&&m.listLevelPattern===t&&(m.numberFormat===e||-1!==m.numberFormat.indexOf(e)))return o.paragraphFormat.listId=l.listId,o.paragraphFormat.listLevelNumber=v,void o.paragraphFormat.setList(l);m=x.levels[0]}}if(i.i(a.isNullOrUndefined)(l)||!i.i(a.isNullOrUndefined)(l)&&0===v&&(m.listLevelPattern!==t||m.numberFormat!==e||m.characterFormat.fontFamily!==n&&"Bullet"===m.listLevelPattern)){p=!1,l=new d.a,this.documentHelper.lists.length>0?l.listId=this.documentHelper.lists[this.documentHelper.lists.length-1].listId+1:l.listId=0;var x=new h.a;if(this.documentHelper.abstractLists.length>0?x.abstractListId=this.documentHelper.abstractLists[this.documentHelper.abstractLists.length-1].abstractListId+1:x.abstractListId=0,l.nsid=x.nsid=s.a.generateUniqueId(this.owner.documentHelper.lists),l.abstractListId=x.abstractListId,l.abstractList=x,this.documentHelper.abstractLists.push(x),"bullet"===e||"multiLevel"===e||"numbering"===e)this.addListLevels(x,e,o);else{var C=new c.a(x);C.listLevelPattern=t,C.numberFormat=e,"Bullet"!==t?C.startAt=1:C.characterFormat.fontFamily=n,C.paragraphFormat.leftIndent=36,C.paragraphFormat.firstLineIndent=-18,x.levels.push(C),o.paragraphFormat.listLevelNumber=0}o.paragraphFormat.setList(l)}else if(w&&!i.i(a.isNullOrUndefined)(l)){var b=this.documentHelper.getListById(g.paragraphFormat.listFormat.listId),C=this.documentHelper.layout.getListLevel(b,v);if("Bullet"===t)C.numberFormat=e,C.characterFormat.fontFamily=n,C.listLevelPattern=t;else{C.listLevelPattern=t,C.characterFormat.fontFamily=n;var I=C.numberFormat.substring(C.numberFormat.length-1);C.numberFormat.length!==e.length&&v>0?C.numberFormat=e:e.substring(e.length-1)!==C.numberFormat.substring(C.numberFormat.length-1)&&(C.numberFormat=C.numberFormat.replace(I,e.substring(e.length-1)))}o.paragraphFormat.setList(b)}else!i.i(a.isNullOrUndefined)(l)&&p?o.paragraphFormat.setList(l):o.paragraphFormat.setList(void 0)},e.prototype.addListLevels=function(e,t,i){for(var n=[String.fromCharCode(61558),String.fromCharCode(61656),String.fromCharCode(61607),String.fromCharCode(61623),String.fromCharCode(61608)],r=e.levels.length;r<9;r++){var o=new c.a(e);if(t.match("bullet"))o.listLevelPattern="Bullet",o.numberFormat=n[r<5?r%5:r%5+1],o.characterFormat.fontFamily=r<3||5===r?"Wingdings":"Symbol";else{if(t.match("multiLevel")){for(var s=0;s<r+1;s++)o.numberFormat+="%"+(s+1).toString()+".";o.listLevelPattern="Number"}else o.numberFormat="%"+(r+1).toString()+")",o.listLevelPattern=r%3==0?"Number":r%3==1?"LowLetter":"LowRoman";o.startAt=1,o.restartLevel=r}o.paragraphFormat.leftIndent=0===r?36:36*r,o.paragraphFormat.firstLineIndent=-18,e.levels.push(o),i.paragraphFormat.listLevelNumber=r}},e.prototype.insertPageBreak=function(){if(!this.owner.isReadOnlyMode){if(this.documentHelper.selection.start.paragraph.isInsideTable||this.documentHelper.selection.start.paragraph.isInHeaderFooter)return;this.initComplexHistory("PageBreak"),this.isSkipOperationsBuild=!0,this.onEnter("PageBreak"),this.isSkipOperationsBuild=!1,this.editorHistory&&!i.i(a.isNullOrUndefined)(this.editorHistory.currentHistoryInfo)&&this.editorHistory.updateComplexHistory(),this.owner.enableAutoFocus&&this.selection.checkForCursorVisibility()}},e.prototype.insertColumnBreak=function(){if(!this.owner.isReadOnlyMode){if(this.documentHelper.selection.start.paragraph.isInsideTable||this.documentHelper.selection.start.paragraph.isInHeaderFooter)return;this.initComplexHistory("ColumnBreak");var e=this.documentHelper.selection.start.paragraph;if(this.viewer instanceof l.D&&e.bodyWidget.sectionFormat.columns.length>1){var t=this.documentHelper.layout.getBodyWidget(e.bodyWidget,!1);i.i(a.isNullOrUndefined)(t.nextRenderedWidget)||t.page!==t.nextRenderedWidget.page||this.documentHelper.layout.combineMultiColumn(t)}this.onEnter("ColumnBreak"),this.editorHistory&&!i.i(a.isNullOrUndefined)(this.editorHistory.currentHistoryInfo)&&this.editorHistory.updateComplexHistory(),this.owner.enableAutoFocus&&this.selection.checkForCursorVisibility()}},e.prototype.onEnter=function(e){this.handledEnter=!0;var t,n=this.documentHelper.selection;if(i.i(a.isNullOrUndefined)(n.start.paragraph.paragraphFormat.baseStyle)||"Normal"===n.start.paragraph.paragraphFormat.baseStyle.name||"Normal (Web)"===n.start.paragraph.paragraphFormat.baseStyle.name){t=new l.L(void 0),t.cloneFormat(this.selection.characterFormat);n.start.paragraph.lastChild.children[n.start.paragraph.lastChild.children.length-1]instanceof r.f&&(t.baselineAlignment="Normal")}if(!this.isXmlMapped){if(n.isEmpty){var o=n.getHyperlinkField();if(!i.i(a.isNullOrUndefined)(o))return void n.fireRequestNavigate(o);var s=n.start.paragraph;if(s.isEmpty()&&-1!==s.paragraphFormat.listFormat.listId)return void this.onApplyListInternal(this.documentHelper.getListById(s.paragraphFormat.listFormat.listId),s.paragraphFormat.listFormat.listLevelNumber-1)}var d=this.checkAndRemoveComments();this.initHistory("Enter");var h=!0;if(n.isEmpty||(h=this.removeSelectedContents(n)),h){n.owner.isShiftingEnabled=!0,this.updateInsertPosition();var c=this.selection.getParagraphInfo(n.start),p=this.selection.getHierarchicalIndex(c.paragraph,c.offset.toString());if(this.splitParagraphInternal(n,n.start.paragraph,n.start.currentWidget,n.start.offset),this.setPositionForCurrentIndex(n.start,p),!i.i(a.isNullOrUndefined)(e)&&("PageBreak"===e||"ColumnBreak"===e)){var u=n.start.paragraph,g=new r.g;g.characterFormat.copyFormat(u.characterFormat),g.paragraphFormat.copyFormat(u.paragraphFormat);var f=new r.d;switch(e){case"PageBreak":f.text="\f";break;case"ColumnBreak":f.text=String.fromCharCode(14)}var m=new r.p(g);if(m.children.push(f),f.line=m,g.childWidgets.push(m),this.owner.enableTrackChanges&&u.characterFormat.revisions.length>0){var v=this.retrieveRevisionInOder(u.characterFormat);v.range.push(g.characterFormat),g.characterFormat.revisions.push(v),this.owner.trackChangesPane.updateCurrentTrackChanges(v),g.characterFormat.removedIds=[]}this.insertParagraph(g,!0),n.selectParagraphInternal(g,!0)}var y=n.start.paragraph.nextWidget;i.i(a.isNullOrUndefined)(y)&&(y=n.getNextRenderedBlock(n.start.paragraph)),n.selectParagraphInternal(y,!0),this.updateEndPosition(),!i.i(a.isNullOrUndefined)(e)&&this.editorHistory&&this.owner.editorHistory.updateHistory(),this.reLayout(n);var w=this.selection.start.paragraph.containerWidget.firstChild;if(!i.i(a.isNullOrUndefined)(w)){w.isChangeDetected=!1;for(var b=w.nextRenderedWidget;this.owner.isSpellCheck&&!i.i(a.isNullOrUndefined)(b);)w=b,w.isChangeDetected=!1,b=w.nextRenderedWidget}var s=n.start.paragraph.previousWidget;!i.i(a.isNullOrUndefined)(s)&&!s.isEmpty()&&s.lastChild.children[s.lastChild.children.length-1]instanceof r.d&&this.checkAndConvertToHyperlink(n,!0,s)}i.i(a.isNullOrUndefined)(t)||i.i(a.isNullOrUndefined)(n.start.paragraph)||!n.start.paragraph.isEmpty()||(this.selection.isRetrieveFormatting=!0,this.selection.characterFormat.cloneFormat(t),this.selection.isRetrieveFormatting=!1),this.documentHelper.layout.islayoutFootnote=!1,this.updateHistoryForComments(d),this.handledEnter=!1}},e.prototype.splitParagraphInternal=function(e,t,n,o){var s=0,l=t.index,d=t,h=!1;for(d.isChangeDetected=0===o;this.owner.isSpellCheck&&!i.i(a.isNullOrUndefined)(d.nextRenderedWidget);)d=d.nextRenderedWidget,d.isChangeDetected=!0;var c=new r.g,p=new r.p(c);if(c.childWidgets.push(p),c.paragraphFormat.ownerBase=c,n!==t.lastChild||o!==e.getLineLength(n)||t.isContainsShapeAlone()){if(c.paragraphFormat.copyFormat(t.paragraphFormat),c.characterFormat.copyFormat(t.characterFormat),!(o>0)&&n.isFirstLine()||t.isContainsShapeAlone()){var u=t.previousRenderedWidget,f=!1;if(!i.i(a.isNullOrUndefined)(u)&&u instanceof r.g&&(f=u.characterFormat.revisions.length>0),this.owner.enableTrackChanges)if(f)this.checkToMatchEmptyParaMark(t,c)||this.insertParaRevision(t);else{var m=t.firstChild,v=m.children[0].previousValidNodeForTracking;i.i(a.isNullOrUndefined)(v)||this.checkParaMarkMatchedWithElement(v,c.characterFormat,!0,"Insertion")?i.i(a.isNullOrUndefined)(v)&&(s++,l++):this.insertParaRevision(c)}}else t=t.combineWidget(this.owner.viewer),this.moveInlines(t,c,0,0,t.firstChild,o,n),this.owner.enableTrackChanges&&this.insertParaRevision(c,t.firstChild);t=t.getSplitWidgets()[0]}else{if(t.paragraphFormat.baseStyle&&"Normal"!==t.paragraphFormat.baseStyle.name&&t.paragraphFormat.baseStyle.next instanceof g.a?(t.paragraphFormat.baseStyle.name===t.paragraphFormat.baseStyle.next.name?(c.paragraphFormat.copyFormat(t.paragraphFormat),c.characterFormat.copyFormat(t.characterFormat)):c.paragraphFormat.baseStyle=t.paragraphFormat.baseStyle.next,this.selection.skipFormatRetrieval=!1):(c.paragraphFormat.copyFormat(t.paragraphFormat),c.characterFormat.copyFormat(t.characterFormat)),t.lastChild.children.length>0&&t.characterFormat.copyFormat(t.lastChild.children[t.lastChild.children.length-1].characterFormat),this.handledEnter&&this.selection.isEmpty&&this.selection.start.isAtParagraphEnd&&t.characterFormat.revisions.length>0&&(h=!0),this.owner.enableTrackChanges){var y=t.lastChild;if(!i.i(a.isNullOrUndefined)(y)&&y.children.length>0){var w=y.children[y.children.length-1].previousValidNodeForTracking;0!==w.revisions.length&&(h=!1),i.i(a.isNullOrUndefined)(w)||this.checkParaMarkMatchedWithElement(w,t.characterFormat,!1,"Insertion")||(h?this.insertParaRevision(c):this.insertParaRevision(t))}}s++,l++}s+=t.getIndex();var b=t.containerWidget;if(b.childWidgets.splice(s,0,c),c.containerWidget=b,c.index=l,this.updateNextBlocksIndex(c,!0),!i.i(a.isNullOrUndefined)(b.containerWidget)&&b.containerWidget instanceof r.a||b instanceof r.j&&!i.i(a.isNullOrUndefined)(b.bodyWidget)&&b.bodyWidget.containerWidget instanceof r.a){var x=this.documentHelper.textHelper.getParagraphMarkSize(c.characterFormat).Height;b instanceof r.j?(b.bodyWidget.height+=x,b.bodyWidget.containerWidget.height+=x):(b.containerWidget.height+=x,b.height+=x)}if(this.owner.enableTrackChanges&&0===c.characterFormat.revisions.length){var C=void 0;0===t.characterFormat.revisions.length?C=t:h&&(C=c),i.i(a.isNullOrUndefined)(C)||this.checkToMatchEmptyParaMark(C)||this.insertParaRevision(C)}this.documentHelper.layout.layoutBodyWidgetCollection(l,b,c,!1)},e.prototype.insertParaRevision=function(e,t){if(this.owner.enableTrackChanges&&i.i(a.isNullOrUndefined)(t)&&!this.isRevisionMatched(e.characterFormat,"Insertion")&&(e.characterFormat.revisions=[],this.insertRevision(e.characterFormat,"Insertion")),!i.i(a.isNullOrUndefined)(t)){if(t.paragraph.isInsideTable)return void this.insertRevision(e.characterFormat,"Insertion");this.applyRevisionForParaMark(e,t,"Insertion",!0)}},e.prototype.applyRevisionForParaMark=function(e,t,n,r){var o=t.children[0];if(!i.i(a.isNullOrUndefined)(o)){o=o.nextValidNodeForTracking;var s=e.lastChild,l=0===s.children.length?void 0:s.children[s.children.length-1].previousValidNodeForTracking,d=!1,h=e.characterFormat.revisions.length;if(i.i(a.isNullOrUndefined)(l)||(d=this.checkParaMarkMatchedWithElement(l,e.characterFormat,!1,n)),!i.i(a.isNullOrUndefined)(o))if(e.characterFormat.revisions.length>h){if(this.isRevisionMatched(o,n))for(var c=e.characterFormat.revisions[0],p=this.getMatchedRevisionsToCombine(o.revisions,n),u=0;u<p.length;u++)p[u]!==c&&(d=!0,this.clearAndUpdateRevisons(p[u].range,c,c.range.indexOf(e.characterFormat)+1))}else d=this.checkParaMarkMatchedWithElement(o,e.characterFormat,!0,n);!d&&(this.owner.enableTrackChanges||t.paragraph.characterFormat.revisions.length>0)&&(this.insertRevision(e.characterFormat,n),r&&l.revisions.length>0&&o.revisions.length>0&&this.updateRevisionForSpittedTextElement(l,o))}},e.prototype.checkParaMarkMatchedWithElement=function(e,t,i,n){var r=this.getMatchedRevisionsToCombine(e.revisions,n);return r.length>0&&(this.mapMatchedRevisions(r,e,t,i),!0)},e.prototype.checkToMatchEmptyParaMark=function(e,t){var n=e.previousRenderedWidget;if(!i.i(a.isNullOrUndefined)(n)&&n instanceof r.g&&n.characterFormat.revisions.length>0){var o=this.getMatchedRevisionsToCombine(n.characterFormat.revisions,"Insertion");if(o.length>0)return i.i(a.isNullOrUndefined)(t)?this.mapMatchedRevisions(o,n.characterFormat,e.characterFormat,!1):this.mapMatchedRevisions(o,n.characterFormat,t.characterFormat,!1),!0}return!1},e.prototype.checkToMatchEmptyParaMarkBack=function(e){var t=e.nextRenderedWidget,n=t.childWidgets[0],o=n.children[0];if(!i.i(a.isNullOrUndefined)(t)&&t instanceof r.g&&t.characterFormat.revisions.length>0){var s=this.getMatchedRevisionsToCombine(t.characterFormat.revisions,"Deletion");if(s.length>0)return void 0!=t&&void 0!=n&&void 0!=o&&1==o.revisions.length?(this.mapMatchedRevisions(s,o,e.characterFormat,!0),!0):(this.mapMatchedRevisions(s,t.characterFormat,e.characterFormat,!0),!0)}else if(void 0!=o&&1==o.revisions.length){var s=this.getMatchedRevisionsToCombine(o.revisions,"Deletion");if(s.length>0)return this.mapMatchedRevisions(s,o,e.characterFormat,!0),!0}return!1},e.prototype.updateNextBlocksIndex=function(e,t){if(!(i.i(a.isNullOrUndefined)(e.nextRenderedWidget)||e.nextRenderedWidget instanceof r.g&&e.bodyWidget.index!==e.nextRenderedWidget.bodyWidget.index)){var n=e.containerWidget.childWidgets.indexOf(e)+1;if(e.containerWidget instanceof r.o&&!(e.containerWidget.containerWidget instanceof r.a))if(e.containerWidget.page.bodyWidgets.length>1&&e.containerWidget.sectionFormat.numberOfColumns>1)for(var o=e.containerWidget.indexInOwner,s=this.documentHelper.pages.indexOf(e.containerWidget.page);s<this.documentHelper.pages.length;s++){for(var l=this.documentHelper.pages[s],d=0;d<l.bodyWidgets.length;d++)if(l.bodyWidgets[d].indexInOwner===o){for(var h=n;h<l.bodyWidgets[d].childWidgets.length;h++){var c=l.bodyWidgets[d].childWidgets[h];this.updateIndex(c,t)}n=0,i.i(a.isNullOrUndefined)(l.bodyWidgets[d].nextRenderedWidget)||l.bodyWidgets[d].nextRenderedWidget.sectionIndex!==l.bodyWidgets[d].sectionIndex||o++}o!==e.containerWidget.indexInOwner&&!i.i(a.isNullOrUndefined)(l.bodyWidgets[l.bodyWidgets.length-1].nextRenderedWidget)&&l.bodyWidgets[l.bodyWidgets.length-1].nextRenderedWidget.sectionFormat.columns.length>1&&(o=0)}else if(e.containerWidget.page.bodyWidgets.length>1){for(var p=e.containerWidget.index,s=this.documentHelper.pages.indexOf(e.containerWidget.page);s<this.documentHelper.pages.length;s++)for(var l=this.documentHelper.pages[s],d=0;d<l.bodyWidgets.length;d++)if(l.bodyWidgets[d].index===p){for(var h=n;h<l.bodyWidgets[d].childWidgets.length;h++){var c=l.bodyWidgets[d].childWidgets[h];this.updateIndex(c,t)}n=0}}else for(var p=e.containerWidget.index,d=this.documentHelper.pages.indexOf(e.containerWidget.page);d<this.documentHelper.pages.length;d++){var l=this.documentHelper.pages[d];if(l.bodyWidgets[0].index!==p)return;for(var h=n;h<l.bodyWidgets[0].childWidgets.length;h++){var c=l.bodyWidgets[0].childWidgets[h];this.updateIndex(c,t)}n=0}else if(e.containerWidget instanceof r.j)for(var u=e.containerWidget.getSplitWidgets(),g=u.indexOf(e.containerWidget),f=g;f<u.length;f++){for(var m=u[f].childWidgets,v=n;v<m.length;v++)this.updateIndex(m[v],t);g=0,n=0}else if(e.containerWidget instanceof r.z)for(var s=n;s<e.containerWidget.childWidgets.length;s++){var y=e.containerWidget.childWidgets[s];y.rowIndex===e.containerWidget.index&&this.updateIndex(y,t)}else if(e.containerWidget instanceof r.u)for(var s=n;s<e.containerWidget.childWidgets.length;s++){var w=e.containerWidget.childWidgets[s];this.updateIndex(w,t);for(var d=0;d<w.childWidgets.length;d++)w.childWidgets[d].rowIndex=w.index}else if(e.containerWidget instanceof r.x||e.containerWidget instanceof r.i||!i.i(a.isNullOrUndefined)(e.containerWidget)&&e.containerWidget.containerWidget instanceof r.a)for(var s=n;s<e.containerWidget.childWidgets.length;s++){var b=e.containerWidget.childWidgets[s];this.updateIndex(b,t)}}},e.prototype.updateIndex=function(e,t){t?e.index++:e.index--},e.prototype.updateEndPosition=function(){var e=this.documentHelper.selection;this.editorHistory&&!i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&this.updateHistoryPosition(e.start,!1)},e.prototype.checkAndRemoveComments=function(){var e=this.selection;if(e.isEmpty||this.owner.enableTrackChanges)return[];var t=!1,n=this.getSelectedComments();if(n.commentEndInfo.length>0||n.commentStartInfo.length>0){t||(t=!0,this.initComplexHistory("RemoveComment"));var r=this.selection.start,o=this.selection.end;this.selection.isForward||(r=this.selection.end,o=this.selection.start);for(var s=this.selection.getParagraphInfo(r),l=this.selection.getParagraphInfo(o),d=0;d<n.commentEndInfo.length;d++){var h=n.commentEndInfo[d].comment,c=h.commentStart,p=h.commentEnd,u=this.selection.getParagraphInfoInternal(c.line,c.line.getOffset(c,0)),g=this.selection.getParagraphInfoInternal(p.line,p.line.getOffset(p,0));if(l.paragraph===g.paragraph){if(h.replyComments.length>0)for(var f=0;f<h.replyComments.length;f++){var m=h.replyComments[f];i.i(a.isNullOrUndefined)(m.commentEnd)||l.offset--}l.offset--}if(s.paragraph===u.paragraph){var v=u.offset<s.offset;if(h.replyComments.length>0)for(var f=0;f<h.replyComments.length;f++){var m=h.replyComments[f];if(!i.i(a.isNullOrUndefined)(m.commentStart)){var y=this.selection.getParagraphInfoInternal(m.commentStart.line,m.commentStart.line.getOffset(m.commentStart,0));y.offset<s.offset&&s.offset--,l.paragraph===u.paragraph&&l.offset--}}v&&s.offset--,l.paragraph===u.paragraph&&l.offset--}this.deleteCommentInternal(h)}if(n.commentStartInfo.length>0)for(var w=0;w<n.commentStartInfo.length;w++)n.commentStartInfo[w].line.paragraph.equals(l.paragraph)&&l.offset--,this.removeInline(n.commentStartInfo[w]);var b=e.getLineInfoBasedOnParagraph(s.paragraph,s.offset);e.start.setPositionFromLine(b.line,b.offset);var x=e.getLineInfoBasedOnParagraph(l.paragraph,l.offset);e.end.setPositionFromLine(x.line,x.offset)}return n.commentStartInfo},e.prototype.updateHistoryForComments=function(e){if(this.editorHistory&&!i.i(a.isNullOrUndefined)(this.editorHistory.currentHistoryInfo)&&"RemoveComment"===this.editorHistory.currentHistoryInfo.action){if(!i.i(a.isNullOrUndefined)(e))for(var t=0;t<e.length;t++)this.initInsertInline(e[t],!1);this.editorHistory.currentHistoryInfo.endPosition=this.selection.startOffset,this.editorHistory.updateComplexHistory()}},e.prototype.onBackSpace=function(){this.removeEditRange=!0;var e=this.documentHelper.selection;if(this.documentHelper.triggerSpellCheck=!0,e.bookmarks.length>0&&this.extendSelectionToBookmarkStart(),e.isEmpty)this.singleBackspace(e,!1);else{var t=this.checkAndRemoveComments();this.initHistory("BackSpace");var n=this.deleteSelectedContents(e,!0);if(this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(n?this.editorHistory.currentBaseHistoryInfo=void 0:(this.checkEndPosition(e)&&this.updateHistoryPosition(e.end,!1),this.isSkipOperationsBuild=!i.i(a.isNullOrUndefined)(this.alertDialog),this.reLayout(e),this.isSkipOperationsBuild=!1,this.insertSpaceInFormField())),this.editorHistory&&!i.i(a.isNullOrUndefined)(this.editorHistory.currentHistoryInfo)){for(var r=0;r<t.length;r++)this.initInsertInline(t[r],!1);this.editorHistory.currentHistoryInfo.endPosition=this.selection.startOffset,this.editorHistory.updateComplexHistory()}this.owner.isSpellCheck&&(this.documentHelper.triggerSpellCheck=!1)}this.removeEditRange=!1,this.documentHelper.layout.islayoutFootnote=!1,this.updateXmlMappedContentControl()},e.prototype.insertRemoveBookMarkElements=function(e){for(var t=!1,i=0;i<this.removedBookmarkElements.length;i++){var n=this.removedBookmarkElements[i];if(0===n.bookmarkType){var r=n;if(r&&r.reference&&-1!==this.removedBookmarkElements.indexOf(r.reference)){var o=this.removedBookmarkElements.indexOf(r.reference),s=this.removedBookmarkElements.indexOf(r);this.removedBookmarkElements.splice(o,1),this.removedBookmarkElements.splice(s,1),i--}else this.editorHistory.currentBaseHistoryInfo&&!e&&(this.initComplexHistory(this.editorHistory.currentBaseHistoryInfo.action),this.editorHistory.updateHistory()),this.initInsertInline(r.clone(),void 0,!0),this.editorHistory.currentHistoryInfo&&i===this.removedBookmarkElements.length-1&&0===this.removedEditRangeStartElements.length&&0===this.removedEditRangeEndElements.length&&(this.editorHistory.updateComplexHistory(),t=!0)}else{var a=n;if(a&&a.reference&&-1!==this.removedBookmarkElements.indexOf(a.reference)){var o=this.removedBookmarkElements.indexOf(a.reference),s=this.removedBookmarkElements.indexOf(a);this.removedBookmarkElements.splice(o,1),this.removedBookmarkElements.splice(s,1),i--}else this.editorHistory.currentBaseHistoryInfo&&!e&&(this.initComplexHistory(this.editorHistory.currentBaseHistoryInfo.action),this.editorHistory.updateHistory()),this.initInsertInline(a.clone(),void 0,!0),this.editorHistory.currentHistoryInfo&&i===this.removedBookmarkElements.length-1&&0===this.removedEditRangeStartElements.length&&0===this.removedEditRangeEndElements.length&&(this.editorHistory.updateComplexHistory(),t=!0)}}return this.removedBookmarkElements=[],t},e.prototype.insertRemovedEditRangeEndElements=function(e){for(var t=!1,i=this.removedEditRangeEndElements.length-1;i>=0;i--){var n=this.removedEditRangeEndElements[i];if(n&&-1!==this.removedEditRangeStartElements.indexOf(n.editRangeStart)){var r=this.removedEditRangeEndElements.indexOf(n),o=this.removedEditRangeStartElements.indexOf(n.editRangeStart);this.removedEditRangeEndElements.splice(r,1),this.removedEditRangeStartElements.splice(o,1),i--}else{this.editorHistory.currentBaseHistoryInfo&&!e&&(this.initComplexHistory(this.editorHistory.currentBaseHistoryInfo.action),this.editorHistory.updateHistory()),this.initInsertInline(n.clone(),void 0,!0);var s=this.selection.start.paragraph.getInline(this.selection.start.offset,0);s.element.editRangeStart.editRangeEnd=s.element,this.editorHistory.currentHistoryInfo&&0===i&&0===this.removedEditRangeStartElements.length&&0===this.removedBookmarkElements.length&&(this.editorHistory.updateComplexHistory(),t=!0)}}return this.removedEditRangeEndElements=[],t},e.prototype.insertRemovedEditRangeStartElements=function(e){for(var t=!1,i=0;i<this.removedEditRangeStartElements.length;i++){var n=this.removedEditRangeStartElements[i];if(n&&-1!==this.removedEditRangeEndElements.indexOf(n.editRangeEnd)){var r=this.removedEditRangeEndElements.indexOf(n.editRangeEnd),o=this.removedEditRangeStartElements.indexOf(n);this.removedEditRangeEndElements.splice(r,1),this.removedEditRangeStartElements.splice(o,1),i--}else{this.editorHistory.currentBaseHistoryInfo&&!e&&(this.initComplexHistory(this.editorHistory.currentBaseHistoryInfo.action),this.editorHistory.updateHistory()),this.initInsertInline(n.clone(),void 0,!0);var s=this.selection.start.paragraph.getInline(this.selection.start.offset,0);s.element.editRangeEnd.editRangeStart=s.element,this.editorHistory.currentHistoryInfo&&i===this.removedEditRangeStartElements.length-1&&0===this.removedBookmarkElements.length&&0===this.removedEditRangeEndElements.length&&(this.editorHistory.updateComplexHistory(),t=!0)}}return this.removedEditRangeStartElements=[],t},e.prototype.deleteSelectedContents=function(e,t,i){var n=this.deleteSelectedContentInternal(e,t,e.start,e.end,i),r=e.getTextPosBasedOnLogicalIndex(e.editPosition);return e.selectContent(r,!0),n},e.prototype.removeWholeElement=function(e){this.initHistory("BackSpace"),this.deleteSelectedContents(e,!0),this.checkEndPosition(e)&&this.updateHistoryPosition(e.end,!1),this.reLayout(e)},e.prototype.getSelectedComments=function(){for(var e=this.documentHelper.comments,t=[],n=[],r=0;r<e.length;r++){var o=e[r],s=o.commentEnd,l=o.commentStart;if(!i.i(a.isNullOrUndefined)(s)&&this.selection.isElementInSelection(s,!0))t.push(s);else if(!i.i(a.isNullOrUndefined)(l)&&this.selection.isElementInSelection(l,!0)){n.push(l);for(var d=0;d<o.replyComments.length;d++)o.replyComments[d].commentStart&&n.push(o.replyComments[d].commentStart)}}return{commentStartInfo:n,commentEndInfo:t}},e.prototype.singleBackspace=function(e,t){var n=this.editorHistory;if(n&&!t&&!n.canRedo()&&n.canUndo()){var o=n.undoStack[n.undoStack.length-1],l=this.selection.getParagraphInfo(e.start),d=this.selection.getParagraphInfo(e.end);if("AutoFormatHyperlink"===o.action&&o.insertPosition===this.selection.getHierarchicalIndex(l.paragraph,l.offset.toString())&&o.endPosition===this.selection.getHierarchicalIndex(d.paragraph,d.offset.toString()))return void n.undo()}for(var h,c=!1,p=e.start.paragraph,u=e.start.currentWidget,g=e.start.offset,f=0,m=u.getInline(g,f),v=m.element,y=!1,w=g,b=!1;v instanceof r.B;){var x=v;if(v=v.previousNode,i.i(a.isNullOrUndefined)(v)&&(v=h),i.i(a.isNullOrUndefined)(v)||0!=v.commentType||(h=v.previousNode),v&&(w=v.length),!(0!==x.commentType||!i.i(a.isNullOrUndefined)(v)&&v instanceof r.B)){i.i(a.isNullOrUndefined)(v)?(v=x,w=0):w=v.length,b=!0;break}1===x.commentType&&(y||(this.initComplexHistory("RemoveComment"),y=!0),this.isSkipOperationsBuild=!0,this.deleteCommentInternal(x.comment),this.isSkipOperationsBuild=!1,b=!0)}if(b)if(i.i(a.isNullOrUndefined)(v)){var C=p.childWidgets[0];e.start.setPositionParagraph(C,0),e.end.setPositionParagraph(C,0)}else p=v.line.paragraph,g=v.line.getOffset(v,w),e.start.setPositionParagraph(v.line,g),e.end.setPositionParagraph(v.line,g);if(this.selection.isInlineFormFillMode()){if(v instanceof r.b&&2===v.fieldType)return;if(1===this.getFieldResultText().length)return this.selection.selectFieldInternal(this.selection.getCurrentFormField()),this.insertTextInternal(this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5),!0),void this.selection.selectTextElementStartOfField(this.selection.getCurrentFormField())}f=m.index,v instanceof r.d&&(v.ignoreOnceItems=[]),v instanceof r.d&&(v.ignoreOnceItems=[]);if(v instanceof r.b&&2===v.fieldType&&s.a.isLinkedFieldCharacter(v)){var I=v.fieldBegin,F=v.fieldEnd;return I.nextNode instanceof r.e&&I.nextNode.reference&&(F=I.nextNode.reference),e.start.setPositionParagraph(I.line,I.line.getOffset(I,0)),e.end.setPositionParagraph(F.line,F.line.getOffset(F,0)+1),void e.fireSelectionChanged(!0)}if(!this.owner.enableTrackChanges&&v instanceof r.f&&("Footnote"===v.footnoteType?this.removeFootnote(v):this.removeEndnote(v)),v&&(v instanceof r.H||v.previousNode instanceof r.H)&&(v instanceof r.H&&v.previousNode&&!(v.previousElement instanceof r.q)&&(v=v.previousNode,p=v.line.paragraph,g=v.line.getOffset(v,v.length)),v&&1===v.length&&v.nextNode instanceof r.H&&v.previousNode instanceof r.H)){var k=v.previousNode,F=v.nextNode;if(!k.contentControlProperties.lockContentControl)return e.start.setPositionParagraph(k.line,k.line.getOffset(k,0)),e.end.setPositionParagraph(F.line,F.line.getOffset(F,0)+1),void this.removeWholeElement(e)}if(v instanceof r.b&&1===v.fieldType&&!this.selection.isInlineFormFillMode()){var P=e.getPreviousValidElement(v);if(P instanceof r.b){if(v=P.fieldBegin,p=v.line.paragraph,g=v.line.getOffset(v,0),v.nextNode instanceof r.e&&v.nextNode.reference){var T=v.nextNode.reference;e.start.setPositionParagraph(T.line,T.line.getOffset(T,1))}return e.end.setPositionParagraph(v.line,g),void e.fireSelectionChanged(!0)}P!==v&&(v=P,p=v.line.paragraph,g=v.line.getOffset(v,v.length))}if(v instanceof r.G||v instanceof r.F){if(v.nextNode instanceof r.F&&v.editRangeEnd===v.nextNode||v.previousNode instanceof r.G&&v.editRangeStart===v.previousNode)return;if(v instanceof r.G&&!(v.previousNode instanceof r.F))return;if(this.documentHelper.isDocumentProtected&&"ReadOnly"===this.documentHelper.protectionType&&(v instanceof r.G||v instanceof r.F))return;if(v instanceof r.F)do{if(i.i(a.isNullOrUndefined)(v.previousNode))break;v=v.previousNode,p=v.line.paragraph,g=v.line.getOffset(v,v.length)}while(v instanceof r.F);if(1===v.length&&v.nextNode instanceof r.F&&v.previousNode instanceof r.G){var S=v.previousNode,F=v.nextNode;return e.start.setPositionParagraph(S.line,S.line.getOffset(S,0)),e.end.setPositionParagraph(F.line,F.line.getOffset(F,0)+1),void this.removeWholeElement(e)}}if(v&&(v instanceof r.e||v.previousNode instanceof r.e)){if(this.documentHelper.isDocumentProtected&&"ReadOnly"===this.documentHelper.protectionType&&(v.previousNode&&v.previousNode instanceof r.G||v.previousNode instanceof r.F))return;if(v instanceof r.e&&1===v.bookmarkType){if(v.previousNode){if((v=v.previousNode)instanceof r.b&&!this.selection.isInlineFormFillMode()){if(v=v.fieldBegin,p=v.line.paragraph,g=v.line.getOffset(v,0),v.nextNode instanceof r.e&&v.nextNode.reference){var W=v.nextNode.reference;e.start.setPositionParagraph(W.line,W.line.getOffset(W,1))}return e.end.setPositionParagraph(v.line,g),void e.fireSelectionChanged(!0)}p=v.line.paragraph,g=v.line.getOffset(v,v.length),e.start.setPositionFromLine(v.line,g),e.end.setPositionInternal(e.start)}else if(p.previousRenderedWidget instanceof r.g){var N=p.previousRenderedWidget,H=N.lastChild;return e.start.setPositionParagraph(v.line,v.line.getOffset(v,0)),e.end.setPositionParagraph(H,H.getEndOffset()),void this.removeWholeElement(e)}}else if(v.nextNode instanceof r.e&&v instanceof r.e&&0===v.bookmarkType&&v.reference===v.nextNode)return void this.deleteBookmark(v.name);if(1===v.length&&v.nextNode instanceof r.e&&v.previousNode instanceof r.e){var I=v.previousNode,F=v.nextNode;return e.start.setPositionParagraph(I.line,I.line.getOffset(I,0)),e.end.setPositionParagraph(F.line,F.line.getOffset(F,0)+1),void this.removeWholeElement(e)}}if(t||this.initHistory("BackSpace"),g===e.getStartOffset(p)&&e.start.currentWidget.isFirstLine()){if(p.paragraphFormat.listFormat&&-1!==p.paragraphFormat.listFormat.listId)return void(i.i(a.isNullOrUndefined)(this.editorHistory)||i.i(a.isNullOrUndefined)(this.editorHistory.undoStack)||"ListFormat"!==this.editorHistory.undoStack[this.editorHistory.undoStack.length-1].action?this.onApplyList(void 0):this.onApplyListInternal(this.documentHelper.getListById(p.paragraphFormat.listFormat.listId),p.paragraphFormat.listFormat.listLevelNumber-1));if(0!==p.paragraphFormat.firstLineIndent)return void this.onApplyParagraphFormat("firstLineIndent",0,!1,!1);if(0!==p.paragraphFormat.leftIndent)return void this.onApplyParagraphFormat("leftIndent",0,!1,!1);if(!p.paragraphFormat.bidi&&"Left"!==p.paragraphFormat.textAlignment)return void this.onApplyParagraphFormat("textAlignment","Left",!1,!0);if(p.previousRenderedWidget instanceof r.g){e.owner.isShiftingEnabled=!0;var E=p.previousRenderedWidget;if(this.owner.enableTrackChanges&&void 0!=p.previousRenderedWidget&&0==p.previousRenderedWidget.characterFormat.revisions.length)if(this.checkToMatchEmptyParaMarkBack(E)){var O=this.documentHelper.selection.getLineLength(E.lastChild),_=E.childWidgets.length-1;this.documentHelper.layout.reLayoutParagraph(E,_,0),e.selects(E.childWidgets[_],O,!0),this.addRemovedNodes(p)}else{this.insertRevision(E.characterFormat,"Deletion");var O=this.documentHelper.selection.getLineLength(E.lastChild),_=E.childWidgets.length-1;this.documentHelper.layout.reLayoutParagraph(E,_,0),e.selects(E.childWidgets[_],O,!0),this.addRemovedNodes(p)}else if(E.isEmpty()&&!this.owner.enableTrackChanges)if(this.removePrevParaMarkRevision(p),p!==p.bodyWidget.lastChild||E.bodyWidget.index===p.bodyWidget.index){this.removeBlock(E),this.addRemovedNodes(E);var N=p.previousRenderedWidget;!i.i(a.isNullOrUndefined)(N)&&N instanceof r.g&&N.isEmpty()&&N.bodyWidget.index!==p.bodyWidget.index&&e.moveToPreviousCharacter()}else{var O=this.documentHelper.selection.getLineLength(E.lastChild),_=E.childWidgets.length-1;e.selects(E.childWidgets[_],O,!0)}else if(this.owner.enableTrackChanges&&void 0!=E.characterFormat.revisions&&"Deletion"==E.characterFormat.revisions[0].revisionType){var O=this.documentHelper.selection.getLineLength(E.lastChild),_=E.childWidgets.length-1;this.documentHelper.layout.reLayoutParagraph(E,_,0),e.selects(E.childWidgets[_],O,!0),this.addRemovedNodes(p)}else{var B=!1;p===p.bodyWidget.lastChild&&E.bodyWidget.index!==p.bodyWidget.index||"NoBreak"===p.bodyWidget.sectionFormat.breakCode||(this.removePrevParaMarkRevision(p),this.removeBlock(p,!1,!0),B=!0);var O=this.documentHelper.selection.getLineLength(E.lastChild),_=E.childWidgets.length-1,C=void 0;if(!p.isEmpty()&&B)for(var L=0;L<p.childWidgets.length;L++){C=p.childWidgets[L],E.childWidgets.push(C);for(var R=0;R<C.children.length;R++)if(C.children[R]instanceof r.f){var A=this.documentHelper.footnoteCollection.indexOf(C.children[R]);if(-1===A){C.children[R].isLayout=!1;var D=parseInt(C.children[R].text);this.documentHelper.footnoteCollection.splice(D-1,0,C.children[R])}}p.childWidgets.splice(L,1),L--,C.paragraph=E}this.documentHelper.layout.reLayoutParagraph(E,_,0),e.selects(E.childWidgets[_],O,!0),B&&this.addRemovedNodes(p)}this.setPositionForHistory();if(this.documentHelper.layout.getFootNoteWidgetsOf(p).length>0){var U=this.documentHelper.layout,M=p.bodyWidget;U.layoutfootNote(M.page.footnoteWidget)}this.reLayout(e)}else this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo=void 0)}else{t||(e.owner.isShiftingEnabled=!0);var V=this.selection.getParagraphInfo(e.start),C=e.start.currentWidget,z=g-1;z<0&&(C=C.previousLine,z=this.documentHelper.selection.getLineLength(C)+z),this.removeAtOffset(C,e,z),this.setPositionParagraph(V.paragraph,V.offset-1,!1),this.setPositionForHistory(),t?this.fireContentChange():(this.reLayout(e),c&&(this.owner.editorHistory.undoStack[this.owner.editorHistory.undoStack.length-2].modifiedActions.push(this.owner.editorHistory.undoStack[this.owner.editorHistory.undoStack.length-1]),this.owner.editorHistory.undoStack.splice(this.owner.editorHistory.undoStack.length-1,1),c=!1))}y&&this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.endPosition=this.selection.startOffset,this.editorHistory.updateComplexHistory())},e.prototype.setPositionForHistory=function(e){var t=this.documentHelper.selection;this.editorHistory&&!i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&(i.i(a.isNullOrUndefined)(e)?(this.updateHistoryPosition(t.start,!0),this.editorHistory.currentBaseHistoryInfo.endPosition=this.editorHistory.currentBaseHistoryInfo.insertPosition):(this.editorHistory.currentBaseHistoryInfo.insertPosition=e,this.editorHistory.currentBaseHistoryInfo.endPosition=e))},e.prototype.removeAtOffset=function(e,t,i){for(var n=0,o=e.paragraph.childWidgets.indexOf(e),s=e.children.length,a=0;a<s;a++){var l=e.children[a];if(!(l instanceof r.q)){if(this.removeCharacter(l,i,n,e,o,a))break;n+=l.length}}},e.prototype.removeCharacter=function(e,t,n,o,s,l,d){var h=!1;if(e instanceof r.e&&e.reference&&e.line!==e.reference.line&&!(o.children[l]instanceof r.e))return i.i(a.isNullOrUndefined)(e.line.previousLine)?i.i(a.isNullOrUndefined)(e.line.paragraph.previousRenderedWidget)?i.i(a.isNullOrUndefined)(e.line.paragraph.nextRenderedWidget)||(e.line.paragraph.nextRenderedWidget.firstChild.children.splice(e.line.paragraph.nextRenderedWidget.firstChild.children.length,0,e),e.line=e.line.paragraph.nextRenderedWidget.firstChild):(e.line.paragraph.previousRenderedWidget.lastChild.children.splice(e.line.paragraph.previousRenderedWidget.lastChild.children.length,0,e),e.line=e.line.paragraph.previousRenderedWidget.lastChild):(e.line.previousLine.children.splice(e.line.previousLine.children.length,0,e),e.line=e.line.previousLine),o.children.splice(l,1),!i.i(a.isNullOrUndefined)(o.layoutedElements)&&o.layoutedElements.length>0&&o.layoutedElements.splice(l,1),!0;if(t<n+e.length){var c=t-n;if(e.ischangeDetected=!0,this.owner.isSpellCheck){var p=e.nextElement,u=e.previousElement;this.owner.spellChecker.removeErrorsFromCollection({element:e,text:e.text}),!i.i(a.isNullOrUndefined)(p)&&p instanceof r.d&&(p.ischangeDetected=!0,this.owner.spellChecker.removeErrorsFromCollection({element:p,text:p.text})),!i.i(a.isNullOrUndefined)(u)&&u instanceof r.d&&(u.ischangeDetected=!0,this.owner.spellChecker.removeErrorsFromCollection({element:u,text:u.text})),e.canTrigger||(this.documentHelper.triggerSpellCheck=!1)}if(t===n&&1===e.length)this.owner.enableTrackChanges&&!this.skipTracking()?(this.addRemovedNodes(e.clone()),this.handleDeleteTracking(e,c,1,l)):(this.unLinkFieldCharacter(e),this.unlinkRangeFromRevision(e,!0),this.addRemovedRevisionInfo(e,void 0),this.addRemovedNodes(e),this.owner.enableTrackChanges&&this.editorHistory.isRedoing&&e instanceof r.f&&("Footnote"===e.footnoteType?this.removeFootnote(e):this.removeEndnote(e)),o.children.splice(l,1),!i.i(a.isNullOrUndefined)(o.layoutedElements)&&o.layoutedElements.length>0&&o.layoutedElements.splice(l,1)),this.documentHelper.layout.reLayoutParagraph(o.paragraph,s,l,void 0,d);else{var g=this.handleDeleteTracking(e,c,1);this.documentHelper.layout.reLayoutParagraph(o.paragraph,s,l,void 0,d),i.i(a.isNullOrUndefined)(g)||(e.revisions.length>0&&this.addRemovedRevisionInfo(e,g),this.addRemovedNodes(g))}e instanceof r.G&&this.removeUserRestrictionsInternal(e,void 0,!0),e instanceof r.e&&0===e.bookmarkType&&this.documentHelper.bookmarks.containsKey(e.name)&&this.documentHelper.bookmarks.remove(e.name),h=!0}return h},e.prototype.removeCharacterInLine=function(e,t,i){var n=new r.d;if(e instanceof r.d){n.characterFormat.copyFormat(e.characterFormat);var o=1===i?1:i-t;n.text=e.text.substr(t,o);var s=e.text;e.text=s.substring(0,t)+s.substring(t+o,s.length),e.contentControlProperties&&(n.contentControlProperties=e.contentControlProperties.clone())}return n},e.prototype.removeRevisionsInformation=function(e,t,i,n){var r,o=e.previousElement;r=this.retrieveRevisionInOder(o),"Insertion"===r.revisionType&&this.isRevisionMatched(o,void 0)&&e.line.children.splice(n,1)},e.prototype.handleDeleteTracking=function(e,t,n,s,l,d){var h=this.owner.enableTrackChanges,c=(!i.i(a.isNullOrUndefined)(this.editorHistory)&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing),void 0);if(this.canHandleDeletion()||h&&(!this.skipTracking()||e.paragraph.isInsideTable&&!i.i(a.isNullOrUndefined)(this.editorHistory)&&this.editorHistory.isRedoing&&this.editorHistory.currentBaseHistoryInfo&&"RemoveRowTrack"===this.editorHistory.currentBaseHistoryInfo.action)){if(e instanceof r.e||e instanceof r.B||e instanceof r.G||e instanceof r.F)return void(e instanceof r.e&&e.previousElement instanceof r.b&&e.previousElement.formFieldData?e.previousElement.revisions.length>0&&this.removeRevisionsInformation(e,t,n,s):h&&e instanceof r.e?(this.checkToCombineRevisionsInSides(e,"Deletion")||this.insertRevision(e,"Deletion"),this.updateLastElementRevision(e)):e.line.children.splice(e.indexInOwner,1));var p=!1;if(this.owner.editorHistory&&(p=!i.i(a.isNullOrUndefined)(this.owner.editorHistory.currentBaseHistoryInfo)&&"Delete"===this.owner.editorHistory.currentBaseHistoryInfo.action),this.skipTableElements||this.updateEndRevisionIndex(),e.revisions.length>0){var u=this.retrieveRevisionInOder(e),g=this.owner.revisions.changes.indexOf(u);if("Insertion"===u.revisionType)if(this.isRevisionMatched(e,void 0)){if(i.i(a.isNullOrUndefined)(s)){c=this.removeCharacterInLine(e,t,n);var f=e.revisions[0];i.i(a.isNullOrUndefined)(f)||this.owner.trackChangesPane.updateCurrentTrackChanges(f)}else{var m=u.range.indexOf(e);u.range.splice(m,1),this.owner.trackChangesPane.updateCurrentTrackChanges(u),0===u.range.length&&this.owner.revisionsInternal.remove(u),this.unLinkFieldCharacter(e),e.line.children.splice(s,1)}e instanceof r.f&&("Footnote"===e.footnoteType?this.removeFootnote(e):this.removeEndnote(e))}else if(i.i(a.isNullOrUndefined)(s)){var v=this.removeCharacterInLine(e,t,n),y=e.revisions[0];if(i.i(a.isNullOrUndefined)(y)||this.owner.trackChangesPane.updateCurrentTrackChanges(y),0===t){var w=e.previousElement;this.handleDeletionForInsertRevision(w,e,v,n,t,!0)}else if(e.length!==t)for(var b=e.revisions.length-1;b>=0;b--){var x=e.revisions[b],C=x.range.indexOf(e),I=new r.d;I.characterFormat.copyFormat(e.characterFormat),I.line=e.line,I.text=e.text.substr(t),I.revisions.splice(0,0,x),x.range.splice(C+1,0,I),v.revisions.splice(0,0,x),v.line=e.line,x.range.splice(C+1,0,v),this.owner.trackChangesPane.updateCurrentTrackChanges(x),e.text=e.text.substr(0,t);var F=e.indexInOwner;e.line.children.splice(F+1,0,I),e.line.children.splice(F+1,0,v),this.addRemovedNodes(v.clone()),this.insertRevision(v,"Deletion"),this.updateLastElementRevision(v)}else if(e.length===t){var k=e.nextElement;this.handleDeletionForInsertRevision(k,e,v,n,t,!1)}else 1===n?p||(this.selection.start.movePreviousPosition(),this.selection.end.setPositionInternal(this.selection.start)):this.updateCursorForInsertRevision(e,t,n),this.addRemovedNodes(v.clone()),this.insertInlineInternal(v,"Deletion")}else this.checkToCombineRevisionsInSides(e,"Deletion")?this.updateLastElementRevision(e):(this.insertRevision(e,"Deletion"),this.updateLastElementRevision(e));else if("Deletion"===u.revisionType){if(-1!==g&&u.author!==this.owner.currentUser&&u.range.length>0){var P=u.range,T=P[0]instanceof o.a?0:P[0].line.getOffset(P[0],0),S=P[P.length-1]instanceof o.a?P[P.length-2]:P[P.length-1],W=S.line.getOffset(S,S.length),N=!1;T===t&&W===n&&(P.splice(P.indexOf(e),1),this.owner.trackChangesPane.updateCurrentTrackChanges(u),e.revisions.splice(e.revisions.indexOf(u),1),this.checkToCombineRevisionsInSides(e,"Deletion")?this.combineElementRevision(e.revisions,e.revisions):(this.insertRevision(e,"Deletion"),N=!0,this.updateLastElementRevision(e)),N&&e.line.getOffset(e,0)===T&&-1!==this.owner.revisions.changes.indexOf(u)&&this.owner.revisions.changes.splice(g,1))}if(1===n)p?(this.selection.start.moveNextPosition(),this.selection.end.setPositionInternal(this.selection.start)):(this.selection.start.movePreviousPosition(),this.selection.end.setPositionInternal(this.selection.start));else if(this.isRevisionMatched(e,"Deletion"))this.updateCursorForInsertRevision(e,t,n);else{var H=u.range.indexOf(e),W=e.line.getOffset(e,e.length);W>=n&&u.range.length>H+1?(this.updateRevisionForSpittedTextElement(e,u.range[H+1]),u.range.splice(u.range.indexOf(e),1),this.toCombineOrInsertRevision(e,"Deletion"),this.owner.trackChangesPane.updateCurrentTrackChanges(u)):1===u.range.length||0===t?(this.handleDeleteBySplitting(e,t,n),H>0&&1!==u.range.length&&(this.updateRevisionForSpittedTextElement(u.range[H-1],u.range[H]),u=this.retrieveRevisionInOder(e),u.range.splice(u.range.indexOf(e),1))):(u.range.splice(u.range.indexOf(e),1),this.toCombineOrInsertRevision(e,"Deletion"))}this.updateLastElementRevision(e)}}else i.i(a.isNullOrUndefined)(s)?this.handleDeleteBySplitting(e,t,n):(this.checkToCombineRevisionsInSides(e,"Deletion")||this.insertRevision(e,"Deletion"),this.skipFootNoteDeleteTracking||this.updateLastElementRevision(e))}else{c=this.removeCharacterInLine(e,t,n);var u=e.revisions[0];i.i(a.isNullOrUndefined)(u)||this.owner.trackChangesPane.updateCurrentTrackChanges(u)}return c},e.prototype.toCombineOrInsertRevision=function(e,t){this.checkToCombineRevisionsInSides(e,t)?this.combineElementRevision(e.revisions,e.revisions):(this.insertRevision(e,t),this.updateLastElementRevision(e))},e.prototype.updateLastElementRevision=function(e){this.skipTableElements||!this.editorHistory||!this.editorHistory.currentBaseHistoryInfo||this.skipReplace||!i.i(a.isNullOrUndefined)(this.owner.search)&&this.owner.search.isRepalceTracking||(i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo.lastElementRevision)&&(this.editorHistory.currentBaseHistoryInfo.lastElementRevision=e),e.isMarkedForRevision=!0)},e.prototype.updateEndRevisionIndex=function(){if(!i.i(a.isNullOrUndefined)(this.editorHistory.undoStack)&&this.editorHistory.undoStack.length>0){var e=this.editorHistory.undoStack[this.editorHistory.undoStack.length-1];e.lastElementRevision&&i.i(a.isNullOrUndefined)(e.endRevisionLogicalIndex)&&e.updateEndRevisionInfo()}},e.prototype.retrieveRevisionInOder=function(e){if(1===e.revisions.length)return e.revisions[0];for(var t=0;t<e.revisions.length;t++)if("Deletion"===e.revisions[t].revisionType)return e.revisions[t];return e.revisions[e.revisions.length-1]},e.prototype.handleDeletionForInsertRevision=function(e,t,n,r,o,s){if(!i.i(a.isNullOrUndefined)(e)&&0===t.revisions.length&&this.isRevisionMatched(e,"Deletion"))this.addRemovedNodes(n.clone()),this.insertTextInline(e,this.selection,n.text,0);else{var l=t.revisions[t.revisions.length-1],d=l.range.indexOf(t);l.range.splice(s?d:d+1,0,n),this.owner.trackChangesPane.updateCurrentTrackChanges(l),n.revisions.splice(0,0,l);var h=!1;this.owner.editorHistory&&(h=!i.i(a.isNullOrUndefined)(this.owner.editorHistory.currentBaseHistoryInfo)&&"Delete"===this.owner.editorHistory.currentBaseHistoryInfo.action),1!==r||h?this.updateCursorForInsertRevision(t,o,r):(this.selection.start.movePreviousPosition(),this.selection.end.setPositionInternal(this.selection.start)),this.addRemovedNodes(n.clone()),this.insertInlineInternal(n,"Deletion")}},e.prototype.handleDeleteBySplitting=function(e,t,r){var o=!1;if(this.owner.editorHistory&&(o=!i.i(a.isNullOrUndefined)(this.owner.editorHistory.currentBaseHistoryInfo)&&"Delete"===this.owner.editorHistory.currentBaseHistoryInfo.action),1===r){var s=e.line.getOffset(e,0);if(s>0){var l=new n.a(this.owner);l.setPositionForLineWidget(e.line,s+t),this.selection.start.setPositionInternal(l),this.selection.end.setPositionInternal(this.selection.start)}else o||(this.selection.start.movePreviousPosition(),this.selection.end.setPositionInternal(this.selection.start))}else this.updateCursorForInsertRevision(e,t,r);var d=this.removeCharacterInLine(e,t,r),h=e.revisions[0];i.i(a.isNullOrUndefined)(h)||this.owner.trackChangesPane.updateCurrentTrackChanges(h),this.addRemovedNodes(d.clone()),""===d.text?this.deleteParagraphMark(e.paragraph,this.selection,0,!0):this.insertTextInternal(d.text,!1,"Deletion")},e.prototype.updateCursorForInsertRevision=function(e,t,i){var r=e.line.getOffset(e,0);r>0&&(t=r+t,i=r+i);var o=new n.a(this.owner);o.setPositionFromLine(e.line,t);var s=new n.a(this.owner);s.setPositionFromLine(e.line,i),o.isExistBefore(s)?(this.selection.end.setPositionInternal(o),this.selection.start.setPositionInternal(o)):(this.selection.start.setPositionInternal(s),this.selection.end.setPositionInternal(s))},e.prototype.checkToCombineRevisionsInSides=function(e,t){var n=e.previousNode,o=e.nextNode,s=!1;if(!i.i(a.isNullOrUndefined)(n)&&(n instanceof r.e||(n=n.previousValidNodeForTracking),!i.i(a.isNullOrUndefined)(n))){var l=this.getMatchedRevisionsToCombine(n.revisions,t);l.length>0&&(this.mapMatchedRevisions(l,n,e,!1),s=!0)}if(!i.i(a.isNullOrUndefined)(o)&&(o instanceof r.e||(o=o.nextValidNodeForTracking),!i.i(a.isNullOrUndefined)(o))){var l=this.getMatchedRevisionsToCombine(o.revisions,t);l.length>0&&(s?this.combineElementRevision(e.revisions,o.revisions):this.mapMatchedRevisions(l,o,e,!0),s=!0)}return s},e.prototype.delete=function(){this.removeEditRange=!0;var e=this.documentHelper.selection;if(e.bookmarks.length>0&&this.extendSelectionToBookmarkStart(),e.isEmpty)this.singleDelete(e,!1);else{var t=this.checkAndRemoveComments();this.initHistory("Delete"),this.deleteSelectedContentInternal(e,!1,e.start,e.end);var r=new n.a(e.owner);if(this.setPositionForCurrentIndex(r,e.editPosition),e.selectContent(r,!0),this.reLayout(e),this.insertSpaceInFormField(),this.editorHistory&&!i.i(a.isNullOrUndefined)(this.editorHistory.currentHistoryInfo)){for(var o=0;o<t.length;o++)this.initInsertInline(t[o],!1);this.editorHistory.currentHistoryInfo.endPosition=this.selection.startOffset,this.editorHistory.updateComplexHistory()}}this.removeEditRange=!1,this.documentHelper.layout.islayoutFootnote=!1,this.updateXmlMappedContentControl()},e.prototype.deleteEditElement=function(e){this.initHistory("Delete"),this.deleteSelectedContentInternal(e,!1,e.start,e.end);var t=new n.a(e.owner);this.setPositionForCurrentIndex(t,e.editPosition),e.selectContent(t,!0),this.reLayout(e)},e.prototype.removeContentControlMark=function(e,t){return!e.contentControlProperties.lockContentControl&&(this.selection.start.setPositionParagraph(e.line,e.line.getOffset(e,0)),this.selection.end.setPositionParagraph(t.line,t.line.getOffset(t,0)+1),this.deleteEditElement(this.selection),!0)},e.prototype.singleDelete=function(e,t){var n=e.start.currentWidget,o=e.start.paragraph,s=e.start.offset,l=0,d=n.getInline(e.start.offset,l),h=d.element;if(this.selection.isInlineFormFillMode()){if(h instanceof r.b&&1===h.fieldType)return;var c=this.getFieldResultText();if(h instanceof r.d||(h=h.nextElement),1===c.length&&h instanceof r.d)return this.selection.selectFieldInternal(this.selection.getCurrentFormField()),this.insertTextInternal(this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5),!0),void this.selection.selectTextElementStartOfField(this.selection.getCurrentFormField());if(h instanceof r.b&&1===h.fieldType)return}if(l=d.index,o.paragraphFormat.listFormat&&-1!==o.paragraphFormat.listFormat.listId&&this.documentHelper.isListTextSelected&&"List"===e.contextType)return void this.onApplyList(void 0);if(!i.i(a.isNullOrUndefined)(h)&&l===h.length&&!i.i(a.isNullOrUndefined)(h.nextNode)){if((h=h.nextNode)instanceof r.b&&1===h.fieldType&&!i.i(a.isNullOrUndefined)(h.fieldBegin.formFieldData))return;if(h instanceof r.f)return;l=0}for(var p=h instanceof r.B;h instanceof r.B;){if(!h.nextNode){l=1;break}h=h.nextNode,l=0}if(p&&(o=h.line.paragraph,s=h.line.getOffset(h,l),e.start.setPositionParagraph(h.line,s),e.end.setPositionParagraph(h.line,s)),!this.owner.enableTrackChanges&&h instanceof r.f&&("Footnote"===h.footnoteType?this.removeFootnote(h):this.removeEndnote(h)),!i.i(a.isNullOrUndefined)(h)){var u=void 0,g=e.getNextValidElement(h);if(g instanceof r.c&&(u=g),!i.i(a.isNullOrUndefined)(u)&&u instanceof r.b&&0===u.fieldType){if(h=u.fieldEnd,o=h.line.paragraph,s=h.line.getOffset(h,1),e.end.setPositionParagraph(h.line,s),h.nextNode instanceof r.e){var f=h.nextNode;e.end.setPositionParagraph(f.line,f.line.getOffset(f,1))}return void e.fireSelectionChanged(!0)}h!==u&&(h=u,o=h.line.paragraph,s=h.line.getOffset(h,0),h instanceof r.b&&1===h.fieldType&&s++)}if(h instanceof r.G||h instanceof r.F){if(h.nextNode instanceof r.F&&h.editRangeEnd===h.nextNode||h.previousNode instanceof r.G&&h.editRangeStart===h.previousNode)return;if(this.documentHelper.isDocumentProtected&&"ReadOnly"===this.documentHelper.protectionType){if(h instanceof r.G||h instanceof r.F)return}else h instanceof r.G?(h=h.nextNode,s=h.line.getOffset(h,0),o=h.line.paragraph):h instanceof r.F&&s++;if(1===h.length&&h.nextNode instanceof r.F&&h.previousNode instanceof r.G){var m=h.previousNode,v=h.nextNode;return e.start.setPositionParagraph(m.line,m.line.getOffset(m,0)),e.end.setPositionParagraph(v.line,v.line.getOffset(v,0)+1),void this.deleteEditElement(e)}}if(h&&(h instanceof r.H||h.nextNode instanceof r.H)){if(h instanceof r.H&&h.nextNode)return h=h.nextNode,o=h.line.paragraph,s=h.line.getOffset(h,0),e.start.setPositionParagraph(h.line,s),void e.end.setPositionParagraph(h.line,s);if(h&&1===h.length&&h.nextNode instanceof r.H&&h.previousNode instanceof r.H&&this.removeContentControlMark(h.previousNode,h.nextNode))return;if(h instanceof r.H&&h.previousNode instanceof r.H&&h.previousNode.reference===h&&this.removeContentControlMark(h.previousNode,h))return}if(h&&(h instanceof r.e&&0===h.bookmarkType||h.nextNode instanceof r.e)){if(h.nextNode&&h instanceof r.e&&(h=h.nextNode,o=h.line.paragraph,s=h.line.getOffset(h,0),e.start.setPositionParagraph(h.line,s),e.end.setPositionParagraph(h.line,s)),1===h.length&&h.nextNode instanceof r.e&&h.previousNode instanceof r.e){var y=h.previousNode,w=h.nextNode;return e.start.setPositionParagraph(y.line,y.line.getOffset(y,0)),e.end.setPositionParagraph(w.line,w.line.getOffset(w,0)+1),void this.deleteEditElement(e)}h instanceof r.e&&(s=h.line.getOffset(h,1))}if(e.start.currentWidget.isLastLine()&&s===this.documentHelper.selection.getLineLength(e.start.currentWidget)){if(o.isInsideTable&&i.i(a.isNullOrUndefined)(o.nextWidget))return;var b=void 0,x=e.getNextParagraphBlock(o);if(i.i(a.isNullOrUndefined)(x)){if(s>0)return;if(o.previousWidget instanceof r.g&&(b=o.previousWidget),o.previousWidget instanceof r.a)return;if(o.previousWidget instanceof r.u)return;if(i.i(a.isNullOrUndefined)(b)||o.isEmpty()&&b.characterFormat.revisions.length>0)return}if(t||this.initHistory("Delete"),o.isEndsWithPageBreak||o.isEndsWithColumnBreak){var C=o.lastChild,I=C.children[C.children.length-1];this.selection.start.setPositionForSelection(C,I,0,this.selection.start.location)}var F=this.selection.getParagraphInfo(e.start);if(e.editPosition=this.selection.getHierarchicalIndex(F.paragraph,F.offset.toString()),this.checkInsertPosition(e)&&this.setPositionForHistory(e.editPosition),e.owner.isShiftingEnabled=!0,o.isEmpty()){this.removePrevParaMarkRevision(o,!0);var k=e.getNextParagraphBlock(o);if(!i.i(a.isNullOrUndefined)(k)&&k instanceof r.g&&k.bodyWidget.index!==o.bodyWidget.index&&(this.deleteSection(e,o.bodyWidget,k.bodyWidget,0),this.editorHistory.currentBaseHistoryInfo.type="SectionBreak"),this.removeBlock(o,!1,!0),this.addRemovedNodes(o),i.i(a.isNullOrUndefined)(x))if(i.i(a.isNullOrUndefined)(b)){var P=e.getParagraphLength(void 0)+1;this.editorHistory&&!i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&(this.updateHistoryPosition(e.start,!0),this.editorHistory.currentBaseHistoryInfo.endPosition=this.selection.getHierarchicalIndex(void 0,P.toString()))}else e.selectParagraphInternal(b,!1),this.setPositionForHistory();else e.selectParagraphInternal(x,!0)}else if(this.owner.enableTrackChanges&&o.nextRenderedWidget instanceof r.g){var T=o.nextRenderedWidget,S=T.childWidgets.length-1;o=o.combineWidget(this.owner.viewer);var W=this.splitParagraph(o,o.firstChild,0,e.start.currentWidget,e.start.offset,!0);void 0!=o&&0!=o.characterFormat.revisions.length&&"Insertion"==o.characterFormat.revisions[0].revisionType?(this.removePrevParaMarkRevision(o,!0),this.deleteParagraphMark(W,e,0),this.addRemovedNodes(o),this.setPositionForCurrentIndex(e.start,e.editPosition),e.selectContent(e.start,!0)):(this.removePrevParaMarkRevision(o,!0),this.deleteParagraphMark(W,e,0,!0),this.addRemovedNodes(o),this.setPositionForCurrentIndex(e.start,e.editPosition),e.selects(T.childWidgets[S],0,!0))}else{o=o.combineWidget(this.owner.viewer);var W=this.splitParagraph(o,o.firstChild,0,e.start.currentWidget,e.start.offset,!0);this.removePrevParaMarkRevision(o,!0),this.deleteParagraphMark(W,e,0),this.addRemovedNodes(o),this.setPositionForCurrentIndex(e.start,e.editPosition),e.selectContent(e.start,!0)}this.reLayout(e)}else this.singleDeleteInternal(e,t,o);e.start.currentWidget.getInline(e.start.offset+1,0).element instanceof r.e&&(e.start.offset++,e.end.offset++)},e.prototype.singleDeleteInternal=function(e,t,n){t||(e.owner.isShiftingEnabled=!0,this.initHistory("Delete")),this.checkInsertPosition(e)&&(this.updateHistoryPosition(e.start,!0),this.editorHistory.currentBaseHistoryInfo.endPosition=this.editorHistory.currentBaseHistoryInfo.insertPosition);var r=this.selection.getParagraphInfo(e.start),o=e.start.currentWidget,s=e.start.offset,l=e.getLineLength(e.start.currentWidget);s>=l&&(o=o.nextLine,s-=l),this.removeAtOffset(o,e,s),this.owner.enableTrackChanges&&!i.i(a.isNullOrUndefined)(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&"Delete"===this.editorHistory.currentBaseHistoryInfo.action&&l!==e.getLineLength(e.start.currentWidget)?this.setPositionParagraph(r.paragraph,r.offset,!1):this.owner.enableTrackChanges&&!this.skipTracking()?this.setPositionParagraph(r.paragraph,r.offset+1,!1):this.setPositionParagraph(r.paragraph,r.offset,!1),t?this.fireContentChange():this.reLayout(e)},e.prototype.deleteParagraphMark=function(e,t,n,o,s){if(!i.i(a.isNullOrUndefined)(e.containerWidget)){e=e.combineWidget(this.owner.viewer);var l=t.getNextParagraphBlock(e);if(!(e.isInsideTable&&i.i(a.isNullOrUndefined)(e.nextWidget)||i.i(a.isNullOrUndefined)(l))){var d=(e.containerWidget instanceof r.o&&e.containerWidget,void 0);if(d=t.getNextRenderedBlock(e)instanceof r.u?t.getNextRenderedBlock(e):void 0,l.isInsideTable&&!i.i(a.isNullOrUndefined)(d)&&d.contains(l.associatedCell)){if(n<4){var h=0;this.removeBlock(e),this.documentHelper.layout.clearListElementBox(l),this.documentHelper.layout.clearListElementBox(e);for(var c=e.childWidgets.length-1;c>=0;c--)for(var p=e.childWidgets[c],u=p.children.length-1;u>=0;u--){var g=p.children[u];h+=g.length,l.firstChild.children.unshift(g),g.line=l.firstChild}this.documentHelper.layout.reLayoutParagraph(l,0,0),h>0&&(t.editPosition=this.selection.getHierarchicalIndex(l,h.toString()))}}else if(n<4){var f=(e.childWidgets.length,l.getSplitWidgets());l=l.combineWidget(this.owner.viewer),this.documentHelper.layout.clearListElementBox(l),this.documentHelper.layout.clearListElementBox(e),this.updateEditPositionOnMerge(e,l);var m=!(!i.i(a.isNullOrUndefined)(o)&&o)||this.handleDeleteParaMark(e,f[0]);if(m){for(var v=e.childWidgets.length-1,c=(e.childWidgets[v].children.length,0);c<l.childWidgets.length;c++){var y=l.childWidgets[c];if(l.characterFormat.revisions.length>0)for(var w=0;w<l.characterFormat.revisions.length;w++){for(var u=0;u<l.characterFormat.revisions[w].range.length;u++)l.characterFormat.revisions[w].range[u].ownerBase=e;e.characterFormat.revisions.push(l.characterFormat.revisions[w])}l.childWidgets.splice(c,1),e.childWidgets.push(y),y.paragraph=e,c--}for(var c=0;c<l.floatingElements.length;c++){var b=l.floatingElements[c];l.floatingElements.splice(c,1),e.floatingElements.push(b),c--}l.bodyWidget.index!==e.bodyWidget.index&&(this.deleteSection(t,e.bodyWidget,l.bodyWidget,n),this.editorHistory.currentBaseHistoryInfo.type="SectionBreak"),0===l.childWidgets.length&&l.childWidgets.push(new r.p(l)),this.documentHelper.layout.reLayoutParagraph(e,0,0),this.removeBlock(l),"Insert"!==this.editorHistory.currentBaseHistoryInfo.action&&(i.i(a.isNullOrUndefined)(this.editorHistory)||i.i(a.isNullOrUndefined)(this.editorHistory.currentHistoryInfo)||"Accept All"!=this.editorHistory.currentHistoryInfo.action||this.removeRevisionForBlock(l,void 0,!1,!0),this.addRemovedNodes(l,s))}}}}},e.prototype.handleDeleteParaMark=function(e,t){if(!this.owner.enableTrackChanges&&e.characterFormat.revisions.length>0)for(var n=0;n<e.characterFormat.revisions.length;n++){var r=e.characterFormat.revisions[n],o=r.range.indexOf(e.characterFormat);return r.range.splice(o,1),this.owner.trackChangesPane.updateCurrentTrackChanges(r),0===r.range.length&&this.owner.revisions.remove(r),!0}if(this.owner.enableTrackChanges){var s=!1;if(e.characterFormat.revisions.length>0){var l=this.retrieveRevisionByType(e.characterFormat,"Deletion");if(!i.i(a.isNullOrUndefined)(l)&&this.isRevisionMatched(l,"Deletion")){var d=e.characterFormat.revisions.indexOf(l);e.characterFormat.revisions.splice(d,1),l.range.splice(l.range.indexOf(e.characterFormat),1),this.owner.trackChangesPane.updateCurrentTrackChanges(l),0===l.range.length&&this.owner.revisions.remove(l),s=!0}var h=this.retrieveRevisionByType(e.characterFormat,"Insertion");if(!i.i(a.isNullOrUndefined)(h)&&this.isRevisionMatched(e.characterFormat,"Insertion")){var o=h.range.indexOf(e.characterFormat);h.range.splice(o,1),this.owner.trackChangesPane.updateCurrentTrackChanges(h),0===h.range.length&&this.owner.revisions.remove(h),s=!0}return!!s||(this.applyRevisionForParaMark(e,t.firstChild,"Deletion",!1),!1)}return this.applyRevisionForParaMark(e,t.firstChild,"Deletion",!1),!1}return!0},e.prototype.insertDeleteParaMarkRevision=function(e,t){var n=e.lastChild,r=n.children.length>0?n.children[n.children.length-1].previousValidNodeForTracking:void 0;if(!i.i(a.isNullOrUndefined)(r)){var o=this.getMatchedRevisionsToCombine(r.revisions,"Deletion");o.length>0&&this.mapMatchedRevisions(o,r,e.characterFormat,!1)}var s=t.firstChild;s.children[0].nextValidNodeForTracking},e.prototype.retrieveRevisionByType=function(e,t){for(var i=0;i<e.revisions.length;i++)if(e.revisions[i].revisionType===t)return e.revisions[i]},e.prototype.combineRevisionOnDeleteParaMark=function(e,t,i){var n=e.childWidgets[t],r=n.children[i],o=r.nextNode;o=o.nextValidNodeForTracking,r=r.nextValidNodeForTracking,o.revisions.length>0&&r.revisions.length>0&&this.combineElementRevisions(r,o)},e.prototype.updateEditPositionOnMerge=function(e,t){this.documentHelper.selection.editPosition===this.selection.getHierarchicalIndex(t,"0")&&void 0===t.nextRenderedWidget&&(this.documentHelper.selection.editPosition=this.selection.getHierarchicalIndex(e,this.documentHelper.selection.getLineLength(e.lastChild).toString()))},e.prototype.checkEndPosition=function(e){return this.editorHistory&&!i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo.endPosition)},e.prototype.checkInsertPosition=function(e){return this.editorHistory&&!i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo.insertPosition)},e.prototype.checkIsNotRedoing=function(){return this.documentHelper.owner.enableHistoryMode&&!this.editorHistory.isRedoing},e.prototype.deleteSelectedContentInternal=function(e,t,n,o,s){var l=n,d=o;n.isExistBefore(o)||(l=o,d=n);var h=this.selection.getParagraphInfo(l);e.editPosition=this.selection.getHierarchicalIndex(h.paragraph,h.offset.toString());var c=!1;if(t&&l.isInSameParagraph(d)){if(l.offset<d.offset&&l.offset===e.getParagraphLength(d.paragraph)){c=e.getNextRenderedBlock(l.paragraph)instanceof r.u}!(1===d.offset&&d.offset>e.getParagraphLength(d.paragraph))||d.paragraph.isInsideTable&&i.i(a.isNullOrUndefined)(d.paragraph.nextWidget)||(t=!1)}if(!c){e.owner.isShiftingEnabled=!0,this.checkInsertPosition(e)&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=e.editPosition);var p=t?1:0;this.deleteSelectedContent(d.paragraph,e,l,d,p,s)}return c},e.prototype.initHistory=function(e){this.documentHelper.owner.enableHistoryMode&&this.editorHistory.initializeHistory(e)},e.prototype.initComplexHistory=function(e){this.documentHelper.owner.enableHistoryMode&&this.editorHistory.initComplexHistory(this.documentHelper.selection,e)},e.prototype.insertPicture=function(e,t,n,o,l){var d=this,h=new r.r(!0);if(h.width=t,h.height=n,i.i(a.isNullOrUndefined)(o)&&""==o||(h.alternateText=o),h.textWrappingStyle="Inline",".svg"===s.a.formatClippedString(e).extension)h.metaFileImageString=e,h.isMetaFile=!0,this.generateFallBackImage(e,t,n,h,l),this.owner.enableCollaborativeEditing||(this.documentHelper.addBase64StringInCollection(h),h.element.src=this.documentHelper.getImageString(h),this.insertPictureInternal(h,l));else if(!i.i(a.isNullOrUndefined)(this.documentHelper)){h.imageString=e,h.element.crossOrigin="Anonymous",this.documentHelper.addBase64StringInCollection(h);var c=this.documentHelper.getImageString(h);i.i(a.isNullOrUndefined)(c)||!s.a.startsWith(c,"http://")&&!s.a.startsWith(c,"https://")||(c+="?t="+(new Date).getTime(),this.viewer.documentHelper.getBase64(e,t,n).then(function(e){d.viewer.documentHelper.images.get(parseInt(h.imageString))[1]=e})),h.element.src=c,this.insertPictureInternal(h,l)}},e.prototype.generateFallBackImage=function(e,t,i,n,r){var o=this,s=new Image;s.onload=function(){o.isImageInsert&&o.owner.enableCollaborativeEditing&&(o.isRemoteAction=!0);var e=Math.max(1,window.devicePixelRatio||1),a=document.createElement("canvas");a.width=t*e,a.height=i*e;var l=a.getContext("2d");l.scale(e,e),l.drawImage(s,0,0,t,i),n.imageString=a.toDataURL("image/png",1),o.owner.enableCollaborativeEditing&&(o.documentHelper.addBase64StringInCollection(n),n.element.src=o.documentHelper.getImageString(n),o.insertPictureInternal(n,r),o.isImageInsert=!1,o.isRemoteAction=!1)},s.src=e},e.prototype.insertPictureInternal=function(e,t){var i=this.documentHelper.selection,n=this.checkAndRemoveComments();if(this.initHistory("InsertInline"),t&&this.fitImageToPage(i,e),this.owner.enableCollaborativeEditing){var r=void 0,o=void 0;e.isMetaFile?(r=this.documentHelper.images.get(parseInt(e.imageString))[1].toString(),o=this.documentHelper.images.get(parseInt(e.metaFileImageString))[0].toString()):r=this.documentHelper.images.get(parseInt(e.imageString)).toString();var a={imageString:r,height:s.a.convertPixelToPoint(e.height),width:s.a.convertPixelToPoint(e.width),metaString:o};this.editorHistory.currentBaseHistoryInfo.insertedData=a,this.editorHistory.currentBaseHistoryInfo.insertedText=y.c.Image}this.insertInlineInSelection(i,e),this.reLayout(i),this.updateHistoryForComments(n)},e.prototype.fitImageToPage=function(e,t){var i=e.start.paragraph.bodyWidget,n=i.sectionFormat.pageHeight-i.sectionFormat.topMargin-i.sectionFormat.topMargin,o=0;if(i instanceof r.o&&i.sectionFormat.columns.length>1){var a=i.columnIndex;o=i.sectionFormat.columns[a].width}else o=s.a.convertPointToPixel(i.sectionFormat.pageWidth-i.sectionFormat.leftMargin-i.sectionFormat.rightMargin);t.width>o&&(t.height=t.height*o/t.width,t.width=o),t.height>n&&(t.width=t.width*n/t.height,t.height=n)},e.prototype.insertInlineInSelection=function(e,t){this.checkIsNotRedoing()&&(e.owner.isShiftingEnabled=!0),e.isEmpty||this.removeSelectedContents(e),!i.i(a.isNullOrUndefined)(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&this.owner.enableCollaborativeEditing&&(this.editorHistory.currentBaseHistoryInfo.insertedElement=t,t instanceof r.B?this.editorHistory.currentBaseHistoryInfo.insertedText=0==t.commentType?y.c.Marker_Start:y.c.Marker_End:t instanceof r.f?(this.editorHistory.currentBaseHistoryInfo.insertedText=y.c.Marker_Start,this.editorHistory.currentBaseHistoryInfo.markerData.push(this.getMarkerData(t))):(t instanceof r.e||t instanceof r.G||t instanceof r.F||t instanceof r.b||t instanceof r.d)&&(this.editorHistory.isRedoing?this.editorHistory.currentBaseHistoryInfo.markerData.push(this.getMarkerData(t)):this.editorHistory.currentBaseHistoryInfo.markerData.push(this.getMarkerData(t,!0)))),this.updateInsertPosition(),this.insertInlineInternal(t),this.checkEndPosition(e)&&this.updateHistoryPosition(e.start,!1),this.fireContentChange()},e.prototype.onPortrait=function(){var e=new l.G,t=this.documentHelper.selection.sectionFormat.pageWidth,i=this.documentHelper.selection.sectionFormat.pageHeight;t>i&&(e.pageWidth=i,e.pageHeight=t),this.onApplySectionFormat(void 0,e)},e.prototype.onLandscape=function(){var e=new l.G,t=this.documentHelper.selection.sectionFormat.pageWidth,i=this.documentHelper.selection.sectionFormat.pageHeight;t<i&&(e.pageWidth=i,e.pageHeight=t),this.onApplySectionFormat(void 0,e)},e.prototype.copyValues=function(){var e=new l.G;return e.bottomMargin=this.documentHelper.selection.sectionFormat.bottomMargin,e.topMargin=this.documentHelper.selection.sectionFormat.topMargin,e.leftMargin=this.documentHelper.selection.sectionFormat.leftMargin,e.rightMargin=this.documentHelper.selection.sectionFormat.rightMargin,e.pageHeight=this.documentHelper.selection.sectionFormat.pageHeight,e.pageWidth=this.documentHelper.selection.sectionFormat.pageWidth,e.footerDistance=this.documentHelper.selection.sectionFormat.footerDistance,e.headerDistance=this.documentHelper.selection.sectionFormat.headerDistance,e},e.prototype.changeMarginValue=function(e){var t=this.copyValues();"lastCustomSetting"===e||"normal"===e?(t.topMargin=72,t.bottomMargin=72,t.leftMargin=72,t.rightMargin=72):"narrow"===e?(t.topMargin=36,t.bottomMargin=36,t.leftMargin=36,t.rightMargin=36):"moderate"===e?(t.topMargin=72,t.bottomMargin=72,t.leftMargin=54,t.rightMargin=54):"wide"===e?(t.topMargin=72,t.bottomMargin=72,t.leftMargin=144,t.rightMargin=144):"mirrored"===e?(t.topMargin=72,t.bottomMargin=72,t.leftMargin=90,t.rightMargin=72):"office2003Default"===e&&(t.topMargin=72,t.bottomMargin=72,t.leftMargin=90,t.rightMargin=90),this.onApplySectionFormat(void 0,t)},e.prototype.onPaperSize=function(e){var t=this.copyValues(),i=this.documentHelper.selection.sectionFormat.pageWidth,n=this.documentHelper.selection.sectionFormat.pageHeight;"letter"===e?i<n?(t.pageWidth=612,t.pageHeight=792):(t.pageWidth=792,t.pageHeight=612):"tabloid"===e?i<n?(t.pageWidth=792,t.pageHeight=1224):(t.pageWidth=1224,t.pageHeight=792):"legal"===e?i<n?(t.pageWidth=612,t.pageHeight=1008):(t.pageWidth=1008,t.pageHeight=612):"statement"===e?i<n?(t.pageWidth=396,t.pageHeight=612):(t.pageWidth=612,t.pageHeight=396):"executive"===e?i<n?(t.pageWidth=522,t.pageHeight=756):(t.pageWidth=756,t.pageHeight=522):"a3"===e?i<n?(t.pageWidth=841.9,t.pageHeight=1190.55):(t.pageWidth=1190.55,t.pageHeight=841.9):"a4"===e?i<n?(t.pageWidth=595.3,t.pageHeight=841.9):(t.pageWidth=841.9,t.pageHeight=595.3):"a5"===e?i<n?(t.pageWidth=419.55,t.pageHeight=595.3):(t.pageWidth=595.3,t.pageHeight=419.55):"b4"===e?i<n?(t.pageWidth=728.5,t.pageHeight=1031.8):(t.pageWidth=1031.8,t.pageHeight=728.5):"b5"===e&&(i<n?(t.pageWidth=515.9,t.pageHeight=728.5):(t.pageWidth=728.5,t.pageHeight=515.9)),this.onApplySectionFormat(void 0,t)},e.prototype.updateListItemsTillEnd=function(e,t){for(var n=t?this.documentHelper.selection.getNextRenderedBlock(e):e;!i.i(a.isNullOrUndefined)(n)&&!this.documentHelper.isTextInput;)this.updateRenderedListItems(n),n=n.getSplitWidgets().pop().nextRenderedWidget},e.prototype.updateWholeListItems=function(e,t,n){this.documentHelper.renderedLists.clear(),this.documentHelper.renderedLevelOverrides=[];for(var r,o=(e.bodyWidget.index,0);o<this.documentHelper.pages.length;o++){for(var s=this.documentHelper.pages[o],l=0;l<s.bodyWidgets.length&&(r=this.getNextBlockForList(s.bodyWidgets[l].firstChild),i.i(a.isNullOrUndefined)(r));l++);if(!i.i(a.isNullOrUndefined)(r))break}do{if(!r)break;var d=null;if(t&&(d={paragraph:null,listId:n}),this.updateListItems(r,e,d)){if(!i.i(a.isNullOrUndefined)(d))return d.paragraph==e?null:d.paragraph;break}r=r.getSplitWidgets().pop().nextRenderedWidget,i.i(a.isNullOrUndefined)(r)||(r=this.getNextBlockForList(r))}while(r);return null},e.prototype.getNextBlockForList=function(e){if(e instanceof r.g&&this.documentHelper.layout.isFirstElementWithPageBreak(e)){var t=e.nextRenderedWidget;if(!i.i(a.isNullOrUndefined)(t)&&t.equals(e))return t}return e},e.prototype.updateListItems=function(e,t,i){return e instanceof r.g?this.updateListItemsForPara(e,t,i):this.updateListItemsForTable(e,t,i)},e.prototype.updateListItemsForTable=function(e,t,n){if(i.i(a.isNullOrUndefined)(n)&&t instanceof r.u&&e.equals(t))return!0;var o=e.firstChild;do{if(this.updateListItemsForRow(o,t,n))return!0;o=o.getSplitWidgets().pop().nextRenderedWidget}while(o);return!1},e.prototype.updateListItemsForRow=function(e,t,n){if(i.i(a.isNullOrUndefined)(n)&&t.isInsideTable&&-1!==e.childWidgets.indexOf(this.documentHelper.selection.getContainerCell(t.associatedCell)))return!0;var r=e.firstChild;do{if(this.updateListItemsForCell(r,t,n),!i.i(a.isNullOrUndefined)(n)&&!i.i(a.isNullOrUndefined)(n.paragraph))return!0;r=r.nextRenderedWidget}while(r);return!1},e.prototype.updateListItemsForCell=function(e,t,n){if(0!==e.childWidgets.length){var r=e.firstChild;do{if(this.updateListItems(r,t,n),!i.i(a.isNullOrUndefined)(n)&&!i.i(a.isNullOrUndefined)(n.paragraph))break;r=r.getSplitWidgets().pop().nextRenderedWidget}while(r)}},e.prototype.updateRenderedListItems=function(e){e instanceof r.g?(e.isEndsWithColumnBreak&&(e=e.nextRenderedWidget),this.updateRenderedListItemsForPara(e)):this.updateRenderedListItemsForTable(e)},e.prototype.updateRenderedListItemsForTable=function(e){var t=e.firstChild;do{this.updateRenderedListItemsForRow(t),t=t.getSplitWidgets().pop().nextRenderedWidget}while(t)},e.prototype.updateRenderedListItemsForRow=function(e){var t=e.firstChild;do{this.updateRenderedListItemsForCell(t),t=t.nextRenderedWidget}while(t)},e.prototype.updateRenderedListItemsForCell=function(e){if(0!==e.childWidgets.length){var t=e.firstChild;do{this.updateRenderedListItems(t),t=t.getSplitWidgets().pop().nextRenderedWidget}while(t)}},e.prototype.updateListItemsForPara=function(e,t,n){if(e.equals(t))return i.i(a.isNullOrUndefined)(n)||(n.paragraph=e),!0;var r=void 0,o=0;if(!i.i(a.isNullOrUndefined)(e.paragraphFormat)&&!i.i(a.isNullOrUndefined)(e.paragraphFormat.listFormat)){if(!i.i(a.isNullOrUndefined)(n)&&e.paragraphFormat.listFormat.listId===n.listId)return n.paragraph=e,!0;r=this.documentHelper.getListById(e.paragraphFormat.listFormat.listId),o=e.paragraphFormat.listFormat.listLevelNumber}if(!i.i(a.isNullOrUndefined)(r)&&!i.i(a.isNullOrUndefined)(this.documentHelper.getAbstractListById(r.abstractListId))&&!i.i(a.isNullOrUndefined)(this.documentHelper.getAbstractListById(r.abstractListId).levels[o])){var s=this.documentHelper.layout.getListLevel(r,o);this.updateListNumber(s,e,!1)}return!1},e.prototype.updateRenderedListItemsForPara=function(e){if(!i.i(a.isNullOrUndefined)(this.documentHelper.getListById(e.paragraphFormat.listFormat.listId))){var t=this.documentHelper.getListById(e.paragraphFormat.listFormat.listId),n=e.paragraphFormat.listFormat.listLevelNumber;if(!i.i(a.isNullOrUndefined)(t)&&!i.i(a.isNullOrUndefined)(this.documentHelper.getAbstractListById(t.abstractListId))&&!i.i(a.isNullOrUndefined)(this.documentHelper.getAbstractListById(t.abstractListId).levels[e.paragraphFormat.listFormat.listLevelNumber])){var r=this.documentHelper.layout.getListLevel(t,n);this.updateListNumber(r,e,!0)}}},e.prototype.updateListNumber=function(e,t,n){var o=void 0;if(t.childWidgets.length>0){var s=t.childWidgets[0];s.children.length>0&&(o=s.children[0])}var l;if(!i.i(a.isNullOrUndefined)(o)&&o.nextElement instanceof r.q&&(l=o.width+o.nextElement.width),!i.i(a.isNullOrUndefined)(o)&&o instanceof r.q){var d=this.documentHelper.layout.getListNumber(t.paragraphFormat.listFormat);if(n){var h=o.width;o.text=d;var c=this.documentHelper.textHelper.getTextSize(o,o.characterFormat);c>h&&(o.width=c),this.documentHelper.textHelper.updateTextSize(o,t),!i.i(a.isNullOrUndefined)(l)&&o.width<l&&(o.nextElement.width=l-o.width)}}},e.prototype.getOffsetValue=function(e){if(this.startParagraph){var t=e.getLineInfoBasedOnParagraph(this.startParagraph,this.startOffset);e.start.setPositionFromLine(t.line,t.offset)}if(e.start.updatePhysicalPosition(!0),e.isEmpty)e.end.setPositionInternal(e.start);else{if(this.endParagraph){var t=e.getLineInfoBasedOnParagraph(this.endParagraph,this.endOffset);e.end.setPositionFromLine(t.line,t.offset)}e.end.updatePhysicalPosition(!0)}},e.prototype.setPositionParagraph=function(e,t,i){var n=this.documentHelper.selection,r=n.getLineInfoBasedOnParagraph(e,t);n.start.setPositionFromLine(r.line,r.offset),n.end.setPositionInternal(n.start),i||n.fireSelectionChanged(!0)},e.prototype.setPositionForCurrentIndex=function(e,t){var i=this.selection.getParagraph({index:t}),n=this.selection.getLineInfoBasedOnParagraph(i.paragraph,i.offset);e.setPositionForLineWidget(n.line,n.offset)},e.prototype.insertPageNumber=function(e){e=i.i(a.isNullOrUndefined)(e)?"":" \\*"+e;var t="PAGE "+e+" \\* MERGEFORMAT";this.createFields(t)},e.prototype.insertPageCount=function(e){e=i.i(a.isNullOrUndefined)(e)?"":" *"+e;var t="NUMPAGES "+e+" * MERGEFORMAT";this.createFields(t)},e.prototype.createFields=function(e){var t=new r.g,i=new r.p(t),n=new r.b(0);i.children.push(n);var o=new r.D;o.fieldBegin=n,o.text="1";var s=new r.d;s.text=e,i.children.push(s);var a=new r.b(2);a.fieldBegin=n,n.fieldSeparator=a,i.children.push(a),i.children.push(o);var d=new r.b(1);d.fieldBegin=n,d.fieldSeparator=a,a.fieldEnd=d,n.fieldEnd=d,i.children.push(d),n.line=i,t.childWidgets.push(i),this.documentHelper.fields.push(n);var h=new r.o;h.sectionFormat=new l.G(h),h.childWidgets.push(t),t.isCreatedUsingHtmlSpanTag=!0,this.pasteContentsInternal([h],!1)},e.prototype.insertBookmark=function(e){var t=!1;if(this.documentHelper.bookmarks.containsKey(e)){var n=this.documentHelper.bookmarks.get(e);if(t=!0,this.initComplexHistory("InsertBookmark"),this.documentHelper.owner.editor.isRemoteAction=!0,this.deleteBookmark(e),this.documentHelper.owner.editor.isRemoteAction=!1,i.i(a.isNullOrUndefined)(n.reference)||i.i(a.isNullOrUndefined)(n.reference.paragraph.associatedCell)){if(!i.i(a.isNullOrUndefined)(n.properties)){var r=parseInt(n.properties.columnFirst),o=n.paragraph.associatedCell.ownerRow,s=o.getCellUsingColumnIndex(o.rowIndex,r);!i.i(a.isNullOrUndefined)(s)&&s.isRenderBookmarkStart&&(s.isRenderBookmarkStart=!1)}}else{var o=n.reference.paragraph.associatedCell.ownerRow;if(o.isRenderBookmarkEnd&&(o.isRenderBookmarkEnd=!1),!i.i(a.isNullOrUndefined)(n.properties)){var r=parseInt(n.properties.columnFirst),d=n.paragraph.associatedCell.ownerRow,s=d.getCellUsingColumnIndex(d.rowIndex,r);i.i(a.isNullOrUndefined)(s)||(s.isRenderBookmarkStart=!1);for(var h=parseInt(n.properties.columnLast),c=n.reference.paragraph.associatedCell.ownerRow,p=void 0,u=h;i.i(a.isNullOrUndefined)(p)&&u>-1;)p=c.getCell(c.rowIndex,u),i.i(a.isNullOrUndefined)(p)&&u--;p.isRenderBookmarkEnd&&(p.isRenderBookmarkEnd=!1)}}}var g=this.createBookmarkElements(e),f=g[0],m=g[1];if(f.properties=this.selection.getBookmarkProperties(f),m.properties=this.selection.getBookmarkProperties(m),this.owner.isShiftingEnabled=!0,t||this.initComplexHistory("InsertBookmark"),this.insertElements([m],[f],!0),this.editorHistory&&this.editorHistory.updateComplexHistoryInternal(),this.documentHelper.owner.enableHeaderAndFooter&&this.updateHeaderFooterWidget(),this.documentHelper.bookmarks.add(e,f),i.i(a.isNullOrUndefined)(f.properties)){this.selection.start.setPositionForSelection(f.line,f,1,this.selection.start.location);var v=0;i.i(a.isNullOrUndefined)(m.properties)||m.properties.isAfterParagraphMark&&(v=2),this.selection.end.setPositionForSelection(m.line,m,v,this.selection.end.location);var y=this.documentHelper.blockToShift;if(!i.i(a.isNullOrUndefined)(y)&&this.viewer instanceof l.D&&y.bodyWidget.sectionFormat.columns.length>1){var w=this.documentHelper.layout.getBodyWidget(y.bodyWidget,!1);i.i(a.isNullOrUndefined)(w.nextRenderedWidget)||"NoBreak"!==w.nextRenderedWidget.sectionFormat.breakCode||w.page!==w.nextRenderedWidget.page||this.reLayout(this.selection)}this.owner.isShiftingEnabled=!1,this.selection.fireSelectionChanged(!0)}else this.selection.selectBookmarkInTable(f),this.documentHelper.owner.isShiftingEnabled=!1;1==this.owner.documentEditorSettings.showBookmarks&&this.viewer.updateScrollBars(),this.fireContentChange()},e.prototype.createBookmarkElements=function(e){var t=new r.e(0);t.name=e;var i=new r.e(1);return i.name=e,t.reference=i,i.reference=t,[t,i]},e.prototype.deleteBookmark=function(e){var t=this.documentHelper.bookmarks,i=t.get(e);if(i instanceof r.e){var n=i.reference,o=this.selection.start.clone(),s=this.selection.end.clone();this.selection.start.setPositionParagraph(i.line,i.line.getOffset(i,i.length)),this.selection.end.setPositionParagraph(n.line,n.line.getOffset(n,n.length)-1),this.initHistory("DeleteBookmark"),this.selection.selectPosition(o,s),this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo.insertedText=y.c.Marker_Start,this.editorHistory.currentBaseHistoryInfo.markerData.push({bookmarkName:e}),this.editorHistory.currentBaseHistoryInfo.setBookmarkInfo(i),this.editorHistory.updateHistory()),this.deleteBookmarkInternal(i)}this.fireContentChange(),1==this.owner.documentEditorSettings.showBookmarks&&this.viewer.updateScrollBars()},e.prototype.deleteBookmarkInternal=function(e){var t=e.previousNode;if(t instanceof r.b&&0===t.fieldType&&!i.i(a.isNullOrUndefined)(t.formFieldData)&&(t.formFieldData.name=""),i.i(a.isNullOrUndefined)(e.properties)){if(this.documentHelper.selection.isRenderBookmarkAtEnd(e)&&!i.i(a.isNullOrUndefined)(e.reference)&&!i.i(a.isNullOrUndefined)(e.reference.paragraph.associatedCell)){var n=e.reference.paragraph.associatedCell.ownerRow;n.isRenderBookmarkEnd&&(n.isRenderBookmarkEnd=!1)}}else{var o=parseInt(e.properties.columnFirst),n=e.paragraph.associatedCell.ownerRow,s=n.getCellUsingColumnIndex(n.rowIndex,o);i.i(a.isNullOrUndefined)(s)||(s.isRenderBookmarkStart=!1);var l=parseInt(e.properties.columnLast);if(!i.i(a.isNullOrUndefined)(e.reference)&&!i.i(a.isNullOrUndefined)(e.reference.paragraph.associatedCell)){for(var d=e.reference.paragraph.associatedCell.ownerRow,h=void 0,c=l;i.i(a.isNullOrUndefined)(h)&&c>-1;)h=d.getCell(d.rowIndex,c),i.i(a.isNullOrUndefined)(h)&&c--;h.isRenderBookmarkEnd&&(h.isRenderBookmarkEnd=!1)}}this.documentHelper.bookmarks.remove(e.name),e.line.children.splice(e.indexInOwner,1),i.i(a.isNullOrUndefined)(e.reference)||e.reference.line.children.splice(e.reference.indexInOwner,1);var p=e.line.paragraph;if(e.line.paragraph.isInHeaderFooter){var u=void 0;p.containerWidget instanceof r.j?u=p.containerWidget.getContainerTable().containerWidget:p.containerWidget instanceof r.x&&(u=p.containerWidget),this.updateHeaderFooterWidget(u)}},e.prototype.getSelectionInfo=function(e){var t=this.selection.start,n=this.selection.end;this.selection.isForward||(t=this.selection.end,n=this.selection.start),n.offset===this.selection.getLineLength(n.currentWidget)+1&&this.selection.isParagraphLastLine(n.currentWidget)||(n.offset+=1);var o=this.selection.getParagraphInfo(t),s=this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString());o=this.selection.getParagraphInfo(n);var l=this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString()),d=this.selection.selectedWidgets.keys;if(i.i(a.isNullOrUndefined)(e)||1!=e||this.selection.hasMergedCells()){if(d[0]instanceof r.j&&t.paragraph.isInsideTable){var h=this.selection.getCellFromSelectionInTable(0);!i.i(a.isNullOrUndefined)(h)&&h instanceof r.j&&(s=this.selection.getActualOffset(h,0))}if(d[d.length-1]instanceof r.j&&n.paragraph.isInsideTable){var c=this.selection.getCellFromSelectionInTable(1);!i.i(a.isNullOrUndefined)(c)&&c instanceof r.j&&(l=this.selection.getActualOffset(c,1))}}else{if(t.paragraph.isInsideTable){var p=this.selection.getCellFromSelection(0);!i.i(a.isNullOrUndefined)(p)&&p instanceof r.j&&(s=this.selection.getActualOffset(p,0))}if(n.paragraph.isInsideTable){var u=this.selection.getCellFromSelection(1);!i.i(a.isNullOrUndefined)(u)&&u instanceof r.j&&(l=this.selection.getActualOffset(u,1))}}return{start:s,end:l}},e.prototype.insertElements=function(e,t,n){var o=this.getSelectionInfo(n);if(n&&!i.i(a.isNullOrUndefined)(t[0].properties)&&0==t[0].bookmarkType){var s=this.selection.selectedWidgets.keys;if(s[0]instanceof r.j&&s[s.length-1]instanceof r.j&&s.length>0){var l=s[0],d=s[s.length-1],h=l.ownerRow,c=d.ownerRow,p=h.getCell(h.rowIndex,0),u=this.documentHelper.getFirstParagraphInCell(p);o.start=this.documentHelper.selection.getHierarchicalIndex(u,"0");var g=c.getCell(c.rowIndex,c.childWidgets.length-1),f=this.selection.getLastParagraph(g),m=this.selection.getParagraphLength(f);o.end=this.documentHelper.selection.getHierarchicalIndex(f,m.toString())}}i.i(a.isNullOrUndefined)(t)||this.insertElementsInternal(this.selection.getTextPosBasedOnLogicalIndex(o.start),t),i.i(a.isNullOrUndefined)(e)||this.insertElementsInternal(this.selection.getTextPosBasedOnLogicalIndex(o.end),e)},e.prototype.insertElementsInternal=function(e,t,n){this.selection.selectPosition(e,e),this.initHistory("InsertElements"),!i.i(a.isNullOrUndefined)(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&(t[0]instanceof r.e&&this.editorHistory||t[0]instanceof r.G||t[0]instanceof r.F)&&this.editorHistory.currentBaseHistoryInfo.markerData.push(this.getMarkerData(t[0])),this.updateInsertPosition();var o=0,s=this.selection.getParagraphInfo(this.selection.start);if(this.selection.start.paragraph.isEmpty()){var l=this.selection.start.paragraph;l.childWidgets[0].children.push(t[0]),t[0].line=l.childWidgets[0],t[0].linkFieldCharacter(this.documentHelper),this.documentHelper.layout.reLayoutParagraph(l,0,0),this.setPositionParagraph(s.paragraph,s.offset+length,!0),e.setPositionForSelection(t[0].line,t[0],t[0].length,this.selection.start.location),this.selection.selectPosition(e,e)}else{var d=this.selection.start.currentWidget.getInline(this.documentHelper.selection.start.offset,o),h=d.element;o=d.index;var c=t[0];this.insertElementInternal(h,c,o,void 0,!0);for(var p=c.indexInOwner,u=c,g=1;g<t.length;g++)u=t[g],c.line.children.splice(p+g,0,u);e.setPositionForSelection(u.line,u,u.length,this.selection.start.location),this.selection.selectPosition(e,e)}this.editorHistory&&(this.checkEndPosition()&&this.updateHistoryPosition(this.selection.start,!1),this.editorHistory.updateHistory())},e.prototype.getMarkerData=function(e,t,n,o){var s={};if(this.editorHistory.currentBaseHistoryInfo||this.editorHistory.isUndoing||this.editorHistory.isRedoing)if(e instanceof r.e){var l="",d="",h=void 0,c=void 0,p=void 0,u=void 0;0==e.bookmarkType?(this.editorHistory.isUndoing||this.editorHistory.isRedoing||(this.editorHistory.currentBaseHistoryInfo.insertedText=y.c.Marker_Start),i.i(a.isNullOrUndefined)(e.properties)||(l=e.properties.columnFirst,d=e.properties.columnLast)):(this.editorHistory.isUndoing||this.editorHistory.isRedoing||(this.editorHistory.currentBaseHistoryInfo.insertedText=y.c.Marker_End),i.i(a.isNullOrUndefined)(e.properties)||(h=e.properties.isAfterParagraphMark,c=e.properties.isAfterTableMark,p=e.properties.isAfterRowMark,u=e.properties.isAfterCellMark)),s={bookmarkName:e.name,type:"Bookmark",skipOperation:t,columnFirst:l,columnLast:d,isAfterParagraphMark:h,isAfterTableMark:c,isAfterRowMark:p,isAfterCellMark:u}}else if(e instanceof r.G||e instanceof r.F){var g=void 0;e instanceof r.G?(g=e,this.editorHistory.isUndoing||this.editorHistory.isRedoing||(this.editorHistory.currentBaseHistoryInfo.insertedText=y.c.Marker_Start)):(g=e.editRangeStart,this.editorHistory.isUndoing||this.editorHistory.isRedoing||(this.editorHistory.currentBaseHistoryInfo.insertedText=y.c.Marker_End));var f=""===g.user?g.group:g.user;s={user:f,type:"EditRange",editRangeId:g.editRangeId,skipOperation:t,columnFirst:i.i(a.isNullOrUndefined)(g.columnFirst)?void 0:g.columnFirst.toString(),columnLast:i.i(a.isNullOrUndefined)(g.columnLast)?void 0:g.columnLast.toString()}}else e instanceof r.b?(0==e.fieldType?this.editorHistory.currentBaseHistoryInfo.insertedText=y.c.Marker_Start:2==e.fieldType?this.editorHistory.currentBaseHistoryInfo.insertedText=y.c.Field_Separator:this.editorHistory.currentBaseHistoryInfo.insertedText=y.c.Marker_End,s={type:"Field"}):e instanceof r.f?s={type:e.footnoteType}:e instanceof r.d&&(this.editorHistory.currentBaseHistoryInfo.insertedText=e.text);return this.owner.enableTrackChanges&&!i.i(a.isNullOrUndefined)(n)&&(i.i(a.isNullOrUndefined)(s)&&(s={}),s.revisionId=n.revisionID,s.revisionType=n.revisionType,s.author=n.author,s.date=n.date,s.skipOperation=t,s.isAcceptOrReject=o),s},e.prototype.getCommentElementBox=function(e){var t=e.split(";"),i=this.documentHelper.comments[parseInt(t[1],10)];return t.length>2&&""!==t[2]?i.replyComments[parseInt(t[2],10)]:i},e.prototype.getBlock=function(e){var t=this.selection.getBodyWidget(e);return this.getBlockInternal(t,e)},e.prototype.getBlockInternal=function(e,t){if(""!==t.index&&!i.i(a.isNullOrUndefined)(t)){var n=t.index.indexOf(";"),o=t.index.substring(0,n);t.index=t.index.substring(n).replace(";","");var s=e;n=parseInt(o,10);var l=this.selection.getBlockByIndex(e,n);if(!l)return{node:s,position:t};var d=l;if(!(t.index.indexOf(";")>=0))return{node:d,position:t};if(d instanceof r.g)return t.index.indexOf(";")>=0&&(t.index="0"),{node:d,position:t};if(d instanceof r.w){var h=this.getBlockInternal(d,t);return{node:i.i(a.isNullOrUndefined)(h)?void 0:h.node,position:i.i(a.isNullOrUndefined)(h)?void 0:h.position}}return{node:s,position:t}}},e.prototype.updateHistoryPosition=function(e,t){if(this.editorHistory&&!i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)){var r=void 0;if(e instanceof n.a){var o=this.selection.getParagraphInfo(e);r=this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString())}else r=e;t?this.editorHistory.currentBaseHistoryInfo.insertPosition=r:this.editorHistory.currentBaseHistoryInfo.endPosition=r}},e.prototype.applyBorders=function(e){this.initHistory("Borders");var t=this.selection.isForward?this.selection.start:this.selection.end,n=this.selection.isForward?this.selection.end:this.selection.start,r=t.paragraph.associatedCell.ownerTable;if(r=r.combineWidget(this.owner.viewer),this.editorHistory){this.cloneTableToHistoryInfo(r)}var o,s=(t.paragraph.associatedCell,n.paragraph.associatedCell),l=this.getBorder(e.borderColor,e.lineWidth,e.borderStyle);if(i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)||(this.editorHistory.currentBaseHistoryInfo.insertedFormat=t.paragraph.associatedCell.cellFormat.borders),this.selection.isEmpty)"OutsideBorders"!==e.type&&"AllBorders"!==e.type&&"LeftBorder"!==e.type||s.cellFormat.borders.left.copyFormat(l),"OutsideBorders"!==e.type&&"AllBorders"!==e.type&&"TopBorder"!==e.type||s.cellFormat.borders.top.copyFormat(l),"OutsideBorders"!==e.type&&"AllBorders"!==e.type&&"RightBorder"!==e.type||s.cellFormat.borders.right.copyFormat(l),"OutsideBorders"!==e.type&&"AllBorders"!==e.type&&"BottomBorder"!==e.type||s.cellFormat.borders.bottom.copyFormat(l),"AllBorders"!==e.type&&"InsideBorders"!==e.type&&"InsideVerticalBorder"!==e.type||s.cellFormat.borders.vertical.copyFormat(l),"AllBorders"!==e.type&&"InsideBorders"!==e.type&&"InsideHorizontalBorder"!==e.type||s.cellFormat.borders.horizontal.copyFormat(l),"NoBorder"===e.type&&this.clearAllBorderValues(s.cellFormat.borders);else{if("OutsideBorders"===e.type||"TopBorder"===e.type)for(var d=this.getTopBorderCellsOnSelection(),h=0;h<d.length;h++)d[h].cellFormat.borders.top.copyFormat(l);if("OutsideBorders"===e.type||"LeftBorder"===e.type)for(var d=this.getLeftBorderCellsOnSelection(),h=0;h<d.length;h++)d[h].cellFormat.borders.left.copyFormat(l);if("OutsideBorders"===e.type||"RightBorder"===e.type)for(var d=this.getRightBorderCellsOnSelection(),h=0;h<d.length;h++)d[h].cellFormat.borders.right.copyFormat(l);if("OutsideBorders"===e.type||"BottomBorder"===e.type)for(var d=this.getBottomBorderCellsOnSelection(),h=0;h<d.length;h++)d[h].cellFormat.borders.bottom.copyFormat(l)}if("BottomBorder"===e.type||"AllBorders"===e.type||"OutsideBorders"===e.type||"NoBorder"===e.type){o=this.getAdjacentCellToApplyBottomBorder();for(var h=0;h<o.length;h++){var c=o[h];"NoBorder"===e.type?c.cellFormat.borders.top.copyFormat(this.clearBorder()):c.cellFormat.borders.top.copyFormat(l)}}if("AllBorders"===e.type||"OutsideBorders"===e.type||"RightBorder"===e.type||"NoBorder"===e.type){o=this.getAdjacentCellToApplyRightBorder();for(var h=0;h<o.length;h++){var c=o[h];"NoBorder"===e.type?c.cellFormat.borders.left.copyFormat(this.clearBorder()):c.cellFormat.borders.left.copyFormat(l)}}"AllBorders"!==e.type&&"NoBorder"!==e.type||this.applyAllBorders(l,e.type),"InsideBorders"!==e.type&&"InsideVerticalBorder"!==e.type&&"InsideHorizontalBorder"!==e.type&&"NoBorder"!==e.type||this.applyInsideBorders(l,e.type,r),this.updateGridForTableDialog(r,!1),this.reLayout(this.selection,!1),this.editorHistory.updateHistory()},e.prototype.applyAllBorders=function(e,t){for(var i=this.selection.getSelectedCells(),n=0;n<i.length;n++)"NoBorder"===t?(i[n].cellFormat.borders.left.copyFormat(this.clearBorder()),i[n].cellFormat.borders.right.copyFormat(this.clearBorder()),i[n].cellFormat.borders.top.copyFormat(this.clearBorder()),i[n].cellFormat.borders.bottom.copyFormat(this.clearBorder())):(i[n].cellFormat.borders.left.copyFormat(e),i[n].cellFormat.borders.right.copyFormat(e),i[n].cellFormat.borders.top.copyFormat(e),i[n].cellFormat.borders.bottom.copyFormat(e))},e.prototype.applyInsideBorders=function(e,t,i){for(var n=this.selection.getSelectedCells(),r=0;r<n.length;r++){var o=n[r],s=o.ownerRow===n[n.length-1].ownerRow,a=o.columnIndex+o.cellFormat.columnSpan-1===n[n.length-1].columnIndex;if("NoBorder"===t?(o.cellFormat.borders.right.copyFormat(this.clearBorder()),o.cellFormat.borders.bottom.copyFormat(this.clearBorder())):(a||"InsideHorizontalBorder"===t||o.cellFormat.borders.right.copyFormat(e),s||"InsideVerticalBorder"===t||o.cellFormat.borders.bottom.copyFormat(e)),!s&&"InsideVerticalBorder"!==t){var l=o.ownerRow.rowIndex+o.cellFormat.rowSpan,d=i.childWidgets[l];if(d)for(var h=this.getAdjacentBottomBorderOnEmptyCells(d,o,!0),c=0;c<h.length;c++)"NoBorder"===t?h[c].cellFormat.borders.top.copyFormat(this.clearBorder()):h[c].cellFormat.borders.top.copyFormat(e)}if(!a&&"InsideHorizontalBorder"!==t)for(var p=this.getSelectedCellsNextWidgets(o,i),u=0;u<p.length;u++)"NoBorder"===t?p[u].cellFormat.borders.left.copyFormat(this.clearBorder()):p[u].cellFormat.borders.left.copyFormat(e)}},e.prototype.getTopBorderCellsOnSelection=function(){for(var e=this.selection.isForward?this.selection.start:this.selection.end,t=e.paragraph.associatedCell,i=[],n=this.selection.getSelectedCells(),r=0;r<n.length;r++)n[r].ownerRow===t.ownerRow&&i.push(n[r]);return i},e.prototype.getLeftBorderCellsOnSelection=function(){for(var e=this.selection.isForward?this.selection.start:this.selection.end,t=e.paragraph.associatedCell,i=this.selection.getSelectedCells(),n=[],r=0;r<i.length;r++)i[r].columnIndex===t.columnIndex&&n.push(i[r]);return n},e.prototype.getRightBorderCellsOnSelection=function(){for(var e=this.selection.getSelectedCells(),t=[],i=0;i<e.length;i++)e[i].columnIndex+e[i].cellFormat.columnSpan-1===e[e.length-1].columnIndex&&t.push(e[i]);return t},e.prototype.getBottomBorderCellsOnSelection=function(){for(var e=this.selection.isForward?this.selection.end:this.selection.start,t=e.paragraph.associatedCell,i=this.selection.getSelectedCells(),n=[],r=0;r<i.length;r++)i[r].ownerRow===t.ownerRow&&n.push(i[r]);return n},e.prototype.clearAllBorderValues=function(e){var t=this.clearBorder();e.bottom.copyFormat(t),e.left.copyFormat(t),e.right.copyFormat(t),e.top.copyFormat(t),e.vertical.copyFormat(t),e.horizontal.copyFormat(t)},e.prototype.clearBorder=function(){var e=new l.J;return e.lineStyle="Cleared",e},e.prototype.getAdjacentCellToApplyBottomBorder=function(){var e=[],t=this.selection.start,i=this.selection.end;this.selection.isForward||(t=this.selection.end,i=this.selection.start);var n=t.paragraph.associatedCell.ownerTable;n=n.combineWidget(this.owner.viewer);var r=t.paragraph.associatedCell,o=i.paragraph.associatedCell,s=o.ownerRow.rowIndex+o.cellFormat.rowSpan,a=n.childWidgets[s];if(a)if(o.cellFormat.columnSpan>1)for(var l=o.columnIndex;l<o.columnIndex+o.cellFormat.columnSpan;l++)e.push(a.childWidgets[l]);else if(e=this.getAdjacentBottomBorderOnEmptyCells(a,o),!this.selection.isEmpty)for(var l=0;l<a.childWidgets.length;l++){var d=a.childWidgets[l].columnIndex;d>=r.columnIndex&&d<=o.columnIndex&&e.push(a.childWidgets[l])}return e},e.prototype.getAdjacentBottomBorderOnEmptyCells=function(e,t,i){var n=[];if(t.cellFormat.columnSpan>1)for(var r=t.columnIndex;r<t.columnIndex;r++)n.push(e.childWidgets[r]);else if(this.selection.isEmpty||i)for(var r=0;r<e.childWidgets.length;r++)e.childWidgets[r].columnIndex===t.columnIndex&&n.push(e.childWidgets[r]);return n},e.prototype.getAdjacentCellToApplyRightBorder=function(){var e=[],t=this.selection.start,i=this.selection.end;this.selection.isForward||(t=this.selection.end,i=this.selection.start);var n=t.paragraph.associatedCell.ownerTable;n=n.combineWidget(this.owner.viewer);t.paragraph.associatedCell,i.paragraph.associatedCell;if(this.selection.isEmpty){var r=t.paragraph.associatedCell;e=this.getSelectedCellsNextWidgets(r,n)}else for(var o=this.getRightBorderCellsOnSelection(),s=0;s<o.length;s++){var a=o[s];e=e.concat(this.getSelectedCellsNextWidgets(a,n))}return e},e.prototype.getSelectedCellsNextWidgets=function(e,t){var n=[];if(!i.i(a.isNullOrUndefined)(e.nextWidget)&&(n.push(e.nextWidget),e.cellFormat.rowSpan>1))for(var r=e.ownerRow.rowIndex+e.cellFormat.rowSpan,o=e.ownerRow.rowIndex+1;o<r;o++){var s=t.childWidgets[o];if(s)for(var l=0;l<s.childWidgets.length;l++)s.childWidgets[l].columnIndex===e.nextWidget.columnIndex&&n.push(s.childWidgets[l])}return n},e.prototype.getBorder=function(e,t,i){var n=new l.J;return n.color=e||"#000000",n.lineWidth=t||1,n.lineStyle=i||"Single",n},e.prototype.applyBordersInternal=function(e,t){i.i(a.isNullOrUndefined)(e)||i.i(a.isNullOrUndefined)(e)||(i.i(a.isNullOrUndefined)(e.top)||this.applyBorder(e.top,t.top),i.i(a.isNullOrUndefined)(e.bottom)||this.applyBorder(e.bottom,t.bottom),i.i(a.isNullOrUndefined)(e.left)||this.applyBorder(e.left,t.left),i.i(a.isNullOrUndefined)(e.right)||this.applyBorder(e.right,t.right),i.i(a.isNullOrUndefined)(e.horizontal)||this.applyBorder(e.horizontal,t.horizontal),i.i(a.isNullOrUndefined)(e.vertical)||this.applyBorder(e.vertical,t.vertical),i.i(a.isNullOrUndefined)(e.diagonalUp)||this.applyBorder(e.diagonalUp,t.diagonalUp),i.i(a.isNullOrUndefined)(e.diagonalDown)||this.applyBorder(e.diagonalDown,t.diagonalDown))},e.prototype.applyShading=function(e,t){i.i(a.isNullOrUndefined)(t)||i.i(a.isNullOrUndefined)(e)||(i.i(a.isNullOrUndefined)(t.backgroundColor)||e.backgroundColor===t.backgroundColor||(e.backgroundColor=t.backgroundColor),i.i(a.isNullOrUndefined)(t.foregroundColor)||e.foregroundColor===t.foregroundColor||(e.foregroundColor=t.foregroundColor),i.i(a.isNullOrUndefined)(t.textureStyle)||e.textureStyle===t.textureStyle||(e.textureStyle=t.textureStyle))},e.prototype.applyBorder=function(e,t){i.i(a.isNullOrUndefined)(e)||i.i(a.isNullOrUndefined)(t)||(i.i(a.isNullOrUndefined)(t.color)||e.color===t.color||(e.color=t.color),i.i(a.isNullOrUndefined)(t.lineStyle)||e.lineStyle===t.lineStyle||(e.lineStyle=t.lineStyle),i.i(a.isNullOrUndefined)(t.lineWidth)||e.lineWidth===t.lineWidth||(e.lineWidth=t.lineWidth),i.i(a.isNullOrUndefined)(t.shadow)||e.shadow===t.shadow||(e.shadow=t.shadow),i.i(a.isNullOrUndefined)(t.space)||e.space===t.space||(e.space=t.space))},e.prototype.onTableFormat=function(e,t,n){if(!i.i(a.isNullOrUndefined)(this.selection.tableFormat)){if(i.i(a.isNullOrUndefined)(t)&&(t=!1),this.documentHelper.owner.isShiftingEnabled=!0,this.editorHistory.initializeHistory("TableFormat"),i.i(a.isNullOrUndefined)(n)&&(n=this.selection.start.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer)),t)for(var r=0;r<n.childWidgets.length;r++)for(var o=n.childWidgets[r],s=0;s<o.childWidgets.length;s++){var l=o.childWidgets[s];l.cellFormat.shading.copyFormat(e.shading)}if(!i.i(a.isNullOrUndefined)(t)&&!this.isCellFormatApplied&&!i.i(a.isNullOrUndefined)(e.borders))for(var r=0;r<n.childWidgets.length;r++){var o=n.childWidgets[r];o.rowFormat.borders.copyFormat(e.borders);for(var s=0;s<o.childWidgets.length;s++){var l=o.childWidgets[s];l.cellFormat.borders.copyFormat(e.borders)}}this.applyTableFormat(n,void 0,e),this.reLayout(this.selection,!1)}},e.prototype.applyTableFormat=function(e,t,i){this.applyTablePropertyValue(void 0,i,e)},e.prototype.applyTablePropertyValue=function(e,t,n){var r=n.tableFormat;if(!i.i(a.isNullOrUndefined)(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.insertedFormat=t,t=this.editorHistory.currentBaseHistoryInfo.addModifiedTableProperties(r,e,t)),t instanceof l.M)return void(i.i(a.isNullOrUndefined)(e)&&this.handleTableFormat(r,t));"preferredWidth"===e?r.preferredWidth=t:"leftIndent"===e?r.leftIndent=t:"tableAlignment"===e?r.tableAlignment=t:"cellSpacing"===e?r.cellSpacing=t:"leftMargin"===e?r.leftMargin=t:"rightMargin"===e?r.rightMargin=t:"topMargin"===e?r.topMargin=t:"bottomMargin"===e?r.bottomMargin=t:"preferredWidthType"===e?r.preferredWidthType=t:"bidi"===e?r.bidi=t:"title"===e?r.title=t:"description"===e&&(r.description=t),"shading"===e?r.shading=t:"borders"===e&&(r.borders=t)},e.prototype.handleTableFormat=function(e,t){(this.isBordersAndShadingDialog||this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&(i.i(a.isNullOrUndefined)(e.borders)||this.applyBordersInternal(e.borders,t.borders),i.i(a.isNullOrUndefined)(e.shading)||this.applyShading(e.shading,t.shading)),this.isBordersAndShadingDialog||(t.hasValue("bidi")&&t.bidi!==e.bidi&&(e.bidi=t.bidi),t.hasValue("preferredWidth")&&t.preferredWidth!==e.preferredWidth&&(e.preferredWidth=t.preferredWidth),t.hasValue("preferredWidthType")&&t.preferredWidthType!==e.preferredWidthType&&(e.preferredWidthType=t.preferredWidthType),t.hasValue("tableAlignment")&&t.tableAlignment!==e.tableAlignment&&(e.tableAlignment=t.tableAlignment),t.hasValue("leftIndent")&&t.leftIndent!==e.leftIndent&&(e.leftIndent=t.leftIndent)),this.updateGridForTableDialog(e.ownerBase,!1),t.title!==e.title&&(e.title=t.title),t.description!==e.description&&(e.description=t.description)},e.prototype.updateGridForTableDialog=function(e,t){e.tableHolder&&(e.updateRowIndex(0),e.isGridUpdated=!1),this.documentHelper.layout.reLayoutTable(e)},e.prototype.onRowFormat=function(e){if(!i.i(a.isNullOrUndefined)(this.selection)&&!i.i(a.isNullOrUndefined)(e)){this.editorHistory.initializeHistory("RowFormat"),this.documentHelper.owner.isShiftingEnabled=!0;var t=this.selection.isForward?this.selection.start:this.selection.end,n=this.selection.isForward?this.selection.end:this.selection.start;t.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer);this.applyRowFormat(t.paragraph.associatedCell.ownerRow,t,n,void 0,e),this.reLayout(this.selection,!1)}},e.prototype.applyRowFormat=function(e,t,n,r,o){if(this.applyRowPropertyValue(this.documentHelper.selection,r,o,e),n.paragraph.associatedCell.ownerRow!==e){var s=e.nextWidget;i.i(a.isNullOrUndefined)(s)||this.applyRowFormat(s,t,n,r,o)}},e.prototype.applyRowPropertyValue=function(e,t,n,r){var o=r.rowFormat;if(i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)||(this.editorHistory.currentBaseHistoryInfo.insertedFormat=n,n=this.editorHistory.currentBaseHistoryInfo.addModifiedRowProperties(o,t,n)),n instanceof l.f)return void(i.i(a.isNullOrUndefined)(t)&&this.handleRowFormat(n,o));"heightType"===t?o.heightType=n:"height"===t?o.height=n:"isHeader"===t?o.isHeader=n:"allowBreakAcrossPages"===t&&(o.allowBreakAcrossPages=n),i.i(a.isNullOrUndefined)(r.ownerTable)||this.layoutItemBlock(r.ownerTable,!0)},e.prototype.handleRowFormat=function(e,t){e.hasValue("allowBreakAcrossPages")&&e.allowBreakAcrossPages!==t.allowBreakAcrossPages&&(t.allowBreakAcrossPages=e.allowBreakAcrossPages),e.hasValue("isHeader")&&e.isHeader!==t.isHeader&&(t.isHeader=e.isHeader),e.hasValue("heightType")&&e.heightType!==t.heightType&&(t.heightType=e.heightType),e.hasValue("height")&&e.height!==t.height&&(t.height=e.height),this.updateGridForTableDialog(t.ownerBase.ownerTable,!0)},e.prototype.onCellFormat=function(e){i.i(a.isNullOrUndefined)(this.selection)||i.i(a.isNullOrUndefined)(e)||(this.editorHistory.initializeHistory("CellFormat"),this.updateFormatForCell(this.selection,void 0,e),this.reLayout(this.selection,!1))},e.prototype.onParaFormat=function(e){i.i(a.isNullOrUndefined)(this.selection)||i.i(a.isNullOrUndefined)(e)||(this.editorHistory.initializeHistory("ParagraphFormat"),this.updateParagraphFormat(void 0,e,!1),this.reLayout(this.selection,!1))},e.prototype.updateCellMargins=function(e,t){var i=e.start,n=e.end;e.isForward||(i=e.end,n=e.start),this.initHistoryPosition(e,i),this.documentHelper.owner.cellOptionsDialogModule.applyCellMarginValue(i.paragraph.associatedCell.ownerRow,i,n,t)},e.prototype.updateFormatForCell=function(e,t,i){var n=e.start,r=e.end;e.isForward||(n=e.end,r=e.start);for(var o,s=n.paragraph.associatedCell,a=r.paragraph.associatedCell,l=s.ownerTable.combineWidget(this.owner.viewer),d=s.columnIndex;d<=a.columnIndex;d++){o=this.getSelectedCellInColumn(s.ownerTable,s.ownerRow.rowIndex,d,a.ownerRow.rowIndex);for(var h=0;h<o.length;h++)this.applyCellPropertyValue(this.documentHelper.selection,t,i,o[h].cellFormat)}this.updateGridForTableDialog(l,!1)},e.prototype.getSelectedCellInColumn=function(e,t,i,n){for(var r=[],o=t;o<=n;o++)for(var s=e.childWidgets[o],a=0;a<s.childWidgets.length;a++)s.childWidgets[a].columnIndex===i&&r.push(s.childWidgets[a]);return r},e.prototype.getColumnCells=function(e,t,i){for(var n=[],r=0;r<e.childWidgets.length;r++)for(var o=e.childWidgets[r],s=0;s<o.childWidgets.length;s++){var a=o.childWidgets[s];i?a.columnIndex+a.cellFormat.columnSpan===t&&n.push(a):a.columnIndex===t&&n.push(a)}return n},e.prototype.getTableWidth=function(e){return 0!==e.tableFormat.preferredWidth||"Percent"===e.tableFormat.preferredWidthType?"Auto"===e.tableFormat.preferredWidthType||"Point"===e.tableFormat.preferredWidthType?e.tableFormat.preferredWidth:0===e.tableFormat.preferredWidth?0:s.a.convertPixelToPoint(this.owner.viewer.clientArea.width)/100*e.tableFormat.preferredWidth:s.a.convertPixelToPoint(this.documentHelper.layout.getTableWidth(e))},e.prototype.applyCellPropertyValue=function(e,t,n,r){if(i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)||(this.editorHistory.currentBaseHistoryInfo.insertedFormat=n,n=this.editorHistory.currentBaseHistoryInfo.addModifiedCellProperties(r,t,n),this.editorHistory.currentBaseHistoryInfo.insertedFormat=n),n instanceof l.H)return i.i(a.isNullOrUndefined)(t)&&this.handleCellFormat(n,r),n;"leftMargin"===t?r.leftMargin=n:"topMargin"===t?r.topMargin=n:"rightMargin"===t?r.rightMargin=n:"bottomMargin"===t?r.bottomMargin=n:"preferredWidth"===t?(r.preferredWidth=n,r.cellWidth=n):"cellWidth"===t?r.cellWidth=n:"columnSpan"===t?r.columnSpan=n:"rowSpan"===t?r.rowSpan=n:"preferredWidthType"===t?r.preferredWidthType=n:"verticalAlignment"===t&&(r.verticalAlignment=n),"shading"===t?r.shading=n:"borders"===t&&(r.borders=n)},e.prototype.handleCellFormat=function(e,t){i.i(a.isNullOrUndefined)(e)||i.i(a.isNullOrUndefined)(t)||(this.isBordersAndShadingDialog?(i.i(a.isNullOrUndefined)(e.borders)||this.applyBordersInternal(t.borders,e.borders),i.i(a.isNullOrUndefined)(e.shading)||this.applyShading(t.shading,e.shading)):(e.hasValue("preferredWidth")&&t.preferredWidth!==e.preferredWidth&&(t.preferredWidth=e.preferredWidth),e.hasValue("preferredWidthType")&&t.preferredWidthType!==e.preferredWidthType&&(t.preferredWidthType=e.preferredWidthType),e.hasValue("verticalAlignment")&&t.verticalAlignment!==e.verticalAlignment&&(t.verticalAlignment=e.verticalAlignment)))},e.prototype.destroy=function(){this.tableResize&&(this.tableResize.destroy(),this.tableResize=void 0),this.previousCharFormat&&(this.previousCharFormat.destroy(),this.previousCharFormat=void 0),this.previousParaFormat&&(this.previousParaFormat.destroy(),this.previousParaFormat=void 0),this.alertDialog&&this.alertDialog.destroy(),this.alertDialog=void 0,this.base64&&this.base64.destroy(),this.base64=void 0,this.endParagraph=void 0,this.copiedData=void 0,this.copiedTextContent=void 0,this.listNumberFormat=void 0,this.nodes=[],this.removedTextNodes=[],this.removedBookmarkElements=[],this.editStartRangeCollection=[],this.documentHelper=void 0,this.editRangeID=void 0,this.isCellFormatApplied=void 0,this.isCopying=void 0},e.prototype.updateToc=function(e){if(i.i(a.isNullOrUndefined)(e)&&(e=this.selection.getTocFieldInternal()),this.documentHelper.layout.isTocField(e)){var t=this.selection.getFieldCode(e);-1!==t.toLocaleLowerCase().indexOf("toc")&&this.insertTableOfContents(this.validateTocSettings(this.getTocSettings(t,e)))}},e.prototype.getTocSettings=function(e,t){var n={};if(n.includePageNumber=!0,n.rightAlign=!0,"toc \\mergeformat"===e.toLowerCase())n.startLevel=1,n.endLevel=3;else for(var r=e.split("\\"),o=0;o<r.length;o++){var s=r[o];if(0!==s.length)switch(s[0]){case"o":if(i.i(a.isNullOrUndefined)(s.match(/\d+/g)))n.startLevel=1,n.endLevel=9;else{var l=s.match(/\d+/g).map(Number);n.startLevel=l[0],n.endLevel=l[1]}break;case"h":n.includeHyperlink=!0;break;case"n":n.includePageNumber=!1;break;case"p":n.rightAlign=!1;break;case"u":n.includeOutlineLevels=!0;break;case"t":this.decodeTSwitch(n,s)}}var d=t.paragraph.paragraphFormat.getUpdatedTabs();return d.length>0&&(n.tabLeader=d[d.length-1].tabLeader),n.rightAlign&&i.i(a.isNullOrUndefined)(n.tabLeader)&&(n.tabLeader="Dot"),n},e.prototype.decodeTSwitch=function(e,t){e.levelSettings={},t=t.replace("t",""),t=t.replace('"',""),t=t.replace('"',""),t=t.trim();for(var i=t.split(","),n=0;n<i.length;n++)e.levelSettings[i[n]]=parseInt(i[n+1],10),n++},e.prototype.insertTableOfContents=function(e){this.isInsertingTOC=!0;var t=this.checkAndRemoveComments();this.initComplexHistory("TOC"),i.i(a.isNullOrUndefined)(e)&&(e={},e.startLevel=1,e.endLevel=3,e.includeHyperlink=!0,e.includeOutlineLevels=!0,e.includePageNumber=!0,e.rightAlign=!0,e.tabLeader="Dot");var n=void 0,o=void 0;if("TableOfContents"===this.selection.contextType&&(n=this.selection.getTocFieldInternal()),n instanceof r.b){this.selection.start.setPositionForSelection(n.line,n,0,this.selection.start.location);var s=2;n.fieldEnd.paragraph===n.fieldEnd.paragraph.bodyWidget.lastChild&&s--,this.selection.end.setPositionForSelection(n.fieldEnd.line,n.fieldEnd,s,this.selection.end.location),this.delete()}o=this.constructTocFieldCode(e);var d=this.selection.start.isAtParagraphStart,h=this.selection.getParagraphInfo(this.selection.start),c=this.selection.getHierarchicalIndex(h.paragraph,h.offset.toString()),p=this.buildToc(this.validateTocSettings(e),o,!0,d);if(p.length>0){var u=new r.g,g=new r.p(u);u.childWidgets.push(g);var f=0;d||(f=1);var m=p[f].childWidgets[0],v=m.children[0];this.appendEndField(v,g),p.push(u),this.appendEmptyPara(p)}else{var y=new a.L10n("documenteditor",this.owner.defaultLocale);y.setLocale(this.owner.locale),w.DialogUtility.alert({title:y.getConstant("No Headings"),content:y.getConstant("Add Headings"),showCloseIcon:!0,closeOnEscape:!0,position:{X:"center",Y:"center"},animationSettings:{effect:"Zoom"}}).enableRtl=this.owner.enableRtl}this.setPositionForCurrentIndex(this.selection.start,c),this.selection.end.setPositionInternal(this.selection.start);var b=new r.o;b.sectionFormat=new l.G(b),b.childWidgets=p,this.pasteContentsInternal([b],!1),this.isInsertingTOC=!1,this.updatePageRef(),this.editorHistory&&(this.editorHistory.updateComplexHistory(),this.updateHistoryForComments(t)),0===p.length&&(this.owner.editorHistory.undo(),this.owner.editorHistory.redoStack.pop())},e.prototype.appendEmptyPara=function(e){var t=new r.g,i=new r.p(t);t.childWidgets.push(i),e.push(t)},e.prototype.constructTocFieldCode=function(e){var t="TOC";i.i(a.isNullOrUndefined)(e.startLevel)||0===e.startLevel||i.i(a.isNullOrUndefined)(e.endLevel)||0===e.endLevel||(t=t+' \\o "'+e.startLevel+"-"+e.endLevel+'"'),e.includePageNumber&&!e.rightAlign&&(t+=' \\p " "'),e.includePageNumber||(t+=" \\n"),e.includeHyperlink&&(t+=" \\h \\z"),e.includeOutlineLevels&&(t+=" \\u");var n=this.constructTSwitch(e);return n.length>6&&(t+=n),t},e.prototype.constructTSwitch=function(e){var t="";if(!i.i(a.isNullOrUndefined)(e.levelSettings))for(var n=0,r=Object.keys(e.levelSettings);n<r.length;n++){var o=r[n];t=t+o+","+e.levelSettings[o].toString()+","}return t=t.slice(0,-1),t=' \\t "'+t+'"'},e.prototype.appendEndField=function(e,t){var i=new r.b(1);if(i.fieldSeparator=e.fieldSeparator,e.fieldSeparator.fieldEnd=i,i.fieldBegin=e,i.fieldBegin.fieldEnd=i,i.line=t,e.revisions.length>0){var n=e.revisions[e.revisions.length-1];n.range.push(i),this.owner.trackChangesPane.updateCurrentTrackChanges(n),i.revisions.push(n)}t.children.push(i)},e.prototype.validateTocSettings=function(e){return(i.i(a.isNullOrUndefined)(e.startLevel)||e.startLevel<1)&&(e.startLevel=1),(i.i(a.isNullOrUndefined)(e.endLevel)||e.endLevel<e.endLevel)&&(e.endLevel=e.startLevel>3?e.startLevel:3),i.i(a.isNullOrUndefined)(e.includeHyperlink)&&(e.includeHyperlink=!1),i.i(a.isNullOrUndefined)(e.includePageNumber)&&(e.includePageNumber=!1),i.i(a.isNullOrUndefined)(e.rightAlign)&&(e.rightAlign=!1),i.i(a.isNullOrUndefined)(e.levelSettings)&&(e.levelSettings={}),e},e.prototype.buildToc=function(e,t,i,n){var o=this.documentHelper.pages[0].bodyWidgets[0],s=[];this.createHeadingLevels(e),e.includeOutlineLevels&&this.createOutlineLevels(e);for(var a=this.selection.start.paragraph.bodyWidget.sectionFormat,l=o.childWidgets[0];void 0!==l;){if(l instanceof r.g&&(this.isHeadingStyle(l)||e.includeOutlineLevels&&this.isOutlineLevelStyle(l))){var d=this.insertTocBookmark(l);this.createTOCWidgets(l,s,t,d,e,i,n,a),i=!1}l=this.selection.getNextParagraphBlock(l.getSplitWidgets().pop())}return this.tocStyles={},s},e.prototype.createOutlineLevels=function(e){for(var t=e.startLevel;t<=e.endLevel;t++){var n="Level"+t.toString();i.i(a.isNullOrUndefined)(this.tocStyles[n])&&(this.tocStyles[n]=t)}},e.prototype.createHeadingLevels=function(e){for(var t=e.startLevel;t<=e.endLevel;t++){var n="Heading "+t.toString();i.i(a.isNullOrUndefined)(this.tocStyles[n])&&(this.tocStyles[n]=t)}if(!i.i(a.isNullOrUndefined)(e.levelSettings))for(var r=0,o=Object.keys(e.levelSettings);r<o.length;r++){var s=o[r];this.tocStyles[s]=e.levelSettings[s]}},e.prototype.isHeadingStyle=function(e){var t=e.paragraphFormat.baseStyle;return void 0!==t&&!i.i(a.isNullOrUndefined)(this.tocStyles[t.name])},e.prototype.isOutlineLevelStyle=function(e){var t=e.paragraphFormat.outlineLevel;return!i.i(a.isNullOrUndefined)(this.tocStyles[t])},e.prototype.createTocFieldElement=function(e,t,i){var n=new r.b(0);n.hasFieldEnd=!0,n.line=e,e.children.push(n);var o=new r.d;o.text=t,o.line=e,e.children.push(o);var s=new r.b(2);return s.fieldBegin=n,s.fieldBegin.fieldSeparator=s,s.line=e,e.children.push(s),n},e.prototype.createTOCWidgets=function(e,t,n,o,s,d,h,c){var p=void 0,u=void 0,g=void 0,f=!1;if(1!==t.length||3!==t[0].childWidgets[0].children.length||i.i(a.isNullOrUndefined)(d)||d){u=new r.g;var m=void 0,v=e.paragraphFormat.baseStyle.name;m=s.includeOutlineLevels&&i.i(a.isNullOrUndefined)(this.tocStyles[v])?e.paragraphFormat.outlineLevel:v;var y="TOC "+this.tocStyles[m],w=this.documentHelper.styles.findByName(y,"Paragraph");if(i.i(a.isNullOrUndefined)(w)&&(this.documentHelper.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()),JSON.parse(this.documentHelper.preDefinedStyles.get(y)),this.documentHelper.styles,!0),w=this.documentHelper.styles.findByName(y,"Paragraph")),u.paragraphFormat.applyStyle(w),s.rightAlign&&s.includePageNumber){var b=new l.N;b.position=c.pageWidth-(c.leftMargin+c.rightMargin),b.tabLeader=s.tabLeader,b.deletePosition=0,b.tabJustification="Right",u.paragraphFormat.tabs.push(b)}g=new r.p(u),u.childWidgets.push(g)}else g=t[0].childWidgets[0];void 0!==d&&d&&(i.i(a.isNullOrUndefined)(h)||h||(this.appendEmptyPara(t),f=!0),this.createTocFieldElement(g,n));for(var x="",C=!1,I=e;I instanceof r.g;){for(var F=0;F<I.childWidgets.length;F++)for(var k=I.childWidgets[F],P=0;P<k.children.length;P++){var T=k.children[P];if(!T.isPageBreak&&!T.isColumnBreak)if(T instanceof r.b||T instanceof r.e||C)T instanceof r.b&&(0===T.fieldType?C=!0:2===T.fieldType&&(C=!1));else if(T instanceof r.d||T instanceof r.q){var S=T.text;-1!==S.indexOf("\t")&&(S=S.replace(new RegExp("\t","g")," ")),x+=S}}I=I.nextSplitWidget}if(""!==x){if(s.includeHyperlink&&void 0!==o)p=this.insertTocHyperlink(g,o,x,e);else{var W=new r.d;W.text=x,W.line=g,g.children.push(W)}if(s.includePageNumber&&void 0!==o){if(s.rightAlign){var N=new r.I;N.text="\t",N.line=g,g.children.push(N)}var H=this.insertTocPageNumber(o,g,s.rightAlign,e);this.appendEndField(H,g)}s.includeHyperlink&&void 0!==p&&this.appendEndField(p,g)}if(i.i(a.isNullOrUndefined)(u)||""===x&&!d||t.push(u),this.owner.enableTrackChanges&&!i.i(a.isNullOrUndefined)(u))if(1===t.length||f)this.insertRevisionForBlock(u,"Insertion",!0);else{var E=this.owner.revisionsInternal.changes[0];this.insertRevisionForBlock(u,"Insertion",!0,E)}},e.prototype.insertTocHyperlink=function(e,t,i,n){var o=' HYPERLINK \\l "'+t+'" ',s=this.createTocFieldElement(e,o,!0),a=new r.d;a.text=i;var l=n.paragraphFormat.baseStyle.name;if(this.documentHelper.styles.findByName(l,"Paragraph").characterFormat.isEqualTocFormat(n.characterFormat)){var d=this.documentHelper.styles.findByName("Normal","Paragraph");a.characterFormat.copyTocFormat(d.characterFormat)}else a.characterFormat.copyTocFormat(n.characterFormat);return a.line=e,e.children.push(a),s},e.prototype.getPageNumber=function(e){return e.bodyWidget.sectionFormat.restartPageNumbering?e.bodyWidget.page.currentPageNum:this.documentHelper.pages.indexOf(e.bodyWidget.page)+1},e.prototype.insertTocPageNumber=function(e,t,i,n){var o=" PAGEREF"+e+" \\h ",s=this.createTocFieldElement(t,o,!0),a=this.getPageNumber(n).toString(),l=new r.D;return l.fieldBegin=s,i||(a=" "+a),l.text=a,l.line=t,t.children.push(l),this.pageRefFields[e]=l,s},e.prototype.updatePageRef=function(){for(var e=0,t=Object.keys(this.pageRefFields);e<t.length;e++){var n=t[e];if(this.documentHelper.bookmarks.containsKey(n)){var r=this.documentHelper.bookmarks.get(n),o=this.getPageNumber(r.paragraph).toString(),s=this.pageRefFields[n];if(o!==s.text){s.text=o;var l=s.paragraph,d=l.childWidgets.indexOf(s.line),h=s.line.children.indexOf(s);i.i(a.isNullOrUndefined)(l.containerWidget)||this.documentHelper.layout.reLayoutParagraph(l,d,h)}}}},e.prototype.insertTocBookmark=function(e){var t=void 0;if(e.childWidgets.length>0){var n=e.getSplitWidgets(),o=n[0],s=n.pop(),l=o.childWidgets[0],d=s.childWidgets[s.childWidgets.length-1];if(void 0!==l&&void 0!==d){var h=l.children[0];if(h instanceof r.q||h instanceof r.B)do{h=h.nextNode}while(h instanceof r.q||h instanceof r.B);if(!i.i(a.isNullOrUndefined)(h)&&h instanceof r.e&&0===h.bookmarkType&&h.name.toLowerCase().match("^_toc"))return h.name;var c=d.children[d.children.length-1];void 0!==h&&void 0!==c&&(this.selection.start.setPositionForSelection(l,h,0,this.selection.start.location),this.selection.end.setPositionForSelection(d,c,c.length,this.selection.end.location),t=this.generateBookmarkName(),this.insertBookmark(t))}}return t},e.prototype.generateBookmarkName=function(){this.tocBookmarkId++;for(var e=10-this.tocBookmarkId.toString().length,t="";e-1>0;)t="0"+t,e--;return"_Toc"+t+this.tocBookmarkId},e.prototype.onCellContentAlignment=function(e,t){this.owner.isShiftingEnabled=!0;var n=this.owner.selection;if(n.isEmpty&&n.start.paragraph.isInsideTable){this.owner.editorHistory&&this.owner.editorHistory.initComplexHistory(n,"MultiSelection"),n.selectTableCell(),this.initHistory("CellContentVerticalAlignment");var r=n.start.paragraph.associatedCell.cellFormat;this.applyCellPropertyValue(n,"verticalAlignment",e,r),this.reLayout(n,!1),this.initHistory("TextAlignment"),this.updateParagraphFormat("textAlignment",t,!1),this.reLayout(this.owner.selection,!1),this.owner.editorHistory&&this.owner.editorHistory.updateComplexHistory()}else this.owner.editorHistory&&this.owner.editorHistory.initComplexHistory(n,"MultiSelection"),i.i(a.isNullOrUndefined)(n.getTable(n.start,n.end))||(this.updateSelectionTableFormat(n,"CellContentVerticalAlignment",e),this.reLayout(this.owner.selection,!1),this.initHistory("TextAlignment"),this.updateSelectionParagraphFormatting("textAlignment",t,!1),this.reLayout(n,!1)),this.owner.editorHistory&&this.owner.editorHistory.updateComplexHistory()},e.prototype.insertEditRangeElement=function(e){if(!this.documentHelper.isDocumentProtected&&!this.documentHelper.selection.isEmpty){this.initComplexHistory("RestrictEditing"),this.selection.skipEditRangeRetrieval=!0;var t=this.documentHelper.selection;this.selection.start,this.selection.end;if(this.selection.isForward||(this.selection.end,this.selection.start),t.start.paragraph.isInsideTable&&t.end.paragraph.isInsideTable&&t.start.paragraph.associatedCell.ownerTable.contains(t.end.paragraph.associatedCell)){var i=this.getOwnerCell(this.selection.isForward),n=this.getOwnerCell(!this.selection.isForward);if(i.rowIndex===n.rowIndex){for(var r=i.ownerRow.childWidgets.indexOf(i),o=i.ownerRow.childWidgets.indexOf(n),s=[],a=[],l=r;l<=o;l++){var d=this.addEditElement(e);l==r&&this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.editRangeStart=d),d.columnFirst=l,d.columnLast=l,d.line=t.start.currentWidget;var h=d.editRangeEnd;h.line=t.end.currentWidget,s.push(d),a.push(h),this.insertElements(void 0,[d])}for(var c=this.selection.getLastParagraph(n).lastChild,p=0;p<a.length;p++)a[p].line=c,0==p&&(this.selection.start.setPositionParagraph(c,this.selection.getLineLength(c)),this.selection.end.setPositionParagraph(c,this.selection.getLineLength(c))),this.insertElements(void 0,[a[p]]);this.editorHistory&&this.editorHistory.updateComplexHistoryInternal();var u=s[0].line.getOffset(s[0],1);this.selection.start.setPositionParagraph(s[0].line,u),u=a[0].line.getOffset(a[0],1),this.selection.end.setPositionParagraph(a[0].line,u),this.selection.fireSelectionChanged(!0),this.fireContentChange()}else{this.insertEditRangeInsideTable(i,n,e),this.editorHistory&&this.editorHistory.updateComplexHistoryInternal();var g=this.documentHelper.getFirstParagraphInCell(i).childWidgets[0],f=this.selection.getLastParagraph(n).childWidgets[0],u=g.getOffset(g.children[0],1);this.selection.start.setPositionParagraph(g,u),u=f.getOffset(f.children[0],1),this.selection.end.setPositionParagraph(f,u),this.selection.fireSelectionChanged(!0),this.fireContentChange()}}else this.addRestrictEditingForSelectedArea(e);this.selection.skipEditRangeRetrieval=!1}},e.prototype.insertEditRangeInsideTable=function(e,t,i){var n=e.ownerTable.combineWidget(this.owner.viewer),r=n.childWidgets.indexOf(t.ownerRow),o=n.childWidgets.indexOf(e.ownerRow),s=this.selection.getCellLeft(e.ownerRow,e),a=s+e.cellFormat.cellWidth,l=this.selection.getCellLeft(t.ownerRow,t),d=l+t.cellFormat.cellWidth,h=this.updateSelectedCellsInTable(s,a,l,d);s=h.start,a=h.end;for(var c=[],p=o;p<=r;p++){n=e.ownerTable.combineWidget(this.owner.viewer);for(var u=n.childWidgets[p],g=-1,f=-1,m=0;m<u.childWidgets.length;m++){var v=u.childWidgets[m],y=this.selection.getCellLeft(u,v);this.checkCellWithInSelection(s,a,y)&&(-1===g&&(g=m),f=m)}for(var w=[],b=g;b<=f;b++){var x=void 0,C=void 0,I=void 0;b>=g&&b<=f&&(x=u.childWidgets[g],C=this.documentHelper.getFirstParagraphInCell(x),I=C.childWidgets[0]);var F=this.addEditElement(i);b===g&&(this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.editRangeStart=F),this.selection.start.setPositionParagraph(I,this.selection.getStartOffset(C)),this.selection.end.setPositionParagraph(I,this.selection.getStartOffset(C))),F.columnFirst=b,F.columnLast=b,F.line=I,this.insertElements(void 0,[F]);var k=F.editRangeEnd;if(w.push(k),c.length>0&&b===f){for(var P=0;P<c.length;P++)c[P].line=F.line,this.insertElements(void 0,[c[P]]);c=[]}}if(c=w,p===r&&c.length>0)for(var T=u.childWidgets[f],S=this.selection.getLastParagraph(T).lastChild,P=0;P<c.length;P++)c[P].line=S,0==P&&(this.selection.start.setPositionParagraph(S,this.selection.getLineLength(S)),this.selection.end.setPositionParagraph(S,this.selection.getLineLength(S))),this.insertElements(void 0,[c[P]])}},e.prototype.addRestrictEditingForSelectedArea=function(e){var t=this.addEditElement(e),n=t.editRangeEnd;this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.editRangeStart=t),this.owner.isShiftingEnabled=!0,this.insertElements([n],[t]),this.editorHistory&&this.editorHistory.updateComplexHistoryInternal();var r=t.line.getOffset(t,1);this.selection.start.setPositionParagraph(t.line,r),r=n.line.getOffset(n,1),this.selection.end.setPositionParagraph(n.line,r);var o=this.documentHelper.blockToShift;if(!i.i(a.isNullOrUndefined)(o)&&this.viewer instanceof l.D&&o.bodyWidget.sectionFormat.columns.length>1){var s=this.documentHelper.layout.getBodyWidget(o.bodyWidget,!1);i.i(a.isNullOrUndefined)(s.nextRenderedWidget)||"NoBreak"!==s.nextRenderedWidget.sectionFormat.breakCode||s.page!==s.nextRenderedWidget.page||this.reLayout(this.selection)}this.owner.isShiftingEnabled=!1,this.selection.fireSelectionChanged(!0),this.fireContentChange()},e.prototype.addEditElement=function(e,t){var i=new r.G;"everyone"===e.toLocaleLowerCase()?i.group=e:i.user=e;var n=new r.F;if(n.editRangeStart=i,i.editRangeEnd=n,t)i.editRangeId=t,n.editRangeId=t;else{var o=this.getEditRangeID(9);i.editRangeId=o,n.editRangeId=o}return this.editStartRangeCollection.push(i),this.addEditCollectionToDocument(),this.editStartRangeCollection=[],i},e.prototype.getEditRangeID=function(e){var t=Math.pow(10,e-1),i=Math.pow(10,e)-1,n=Math.floor(Math.random()*(i-t+1))+t;return this.editRangeID.includes(n)?this.getEditRangeID(e):(this.editRangeID.push(n),n)},e.prototype.protect=function(e){this.documentHelper.isDocumentProtected=!0,this.documentHelper.protectionType=e,this.selection.highlightEditRegion(),this.editorHistory&&this.editorHistory.destroy()},e.prototype.addEditCollectionToDocument=function(){for(var e=0;e<this.editStartRangeCollection.length;e++){var t=this.editStartRangeCollection[e],i=""===t.user?t.group:t.user;if(this.documentHelper.editRanges.length>0&&this.documentHelper.editRanges.containsKey(i))this.documentHelper.editRanges.get(i).push(t);else{var n=[];n.push(t),this.documentHelper.editRanges.add(i,n)}}this.selection.updateEditRangeCollection()},e.prototype.updateRangeCollection=function(e,t){if(this.documentHelper.editRanges.length>0&&this.documentHelper.editRanges.containsKey(t))this.documentHelper.editRanges.get(t).push(e);else{var i=[];i.push(e),this.documentHelper.editRanges.add(t,i)}},e.prototype.removeUserRestrictions=function(e){if(this.selection.checkSelectionIsAtEditRegion()||this.selection.isEditRangeCellSelected()){this.selection.skipEditRangeRetrieval=!0;var t=this.selection.getEditRangeStartElement();this.selection.skipEditRangeRetrieval=!0;var i=this.selection.start,n=this.selection.end;if(this.selection.isForward||(i=this.selection.end,n=this.selection.start),!this.selection.isEmpty&&i.paragraph.isInsideTable&&n.paragraph.isInsideTable&&this.selection.isCellSelected(i.paragraph.associatedCell,i,n)){var r=i.paragraph.associatedCell,o=r.ownerTable.combineWidget(this.owner.viewer),s=n.paragraph.associatedCell;o.contains(s)&&this.removeEditRangeElementsOnTable(e)}else this.removeEditRangeElements(t,e);this.fireContentChange(),this.selection.skipEditRangeRetrieval=!1}},e.prototype.removeEditRangeElements=function(e,t){this.initHistory("RemoveEditRange"),this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo.markerData.push(this.getMarkerData(e)),this.editorHistory.currentBaseHistoryInfo.setEditRangeInfo(e),this.editorHistory.updateHistory()),e.user!==t&&e.group!==t||this.removeUserRestrictionsInternal(e,t),this.selection.updateEditRangeCollection()},e.prototype.removeEditRangeElementsOnTable=function(e){var t=this.selection.selectedWidgets.keys;if(t){this.initComplexHistory("RemoveEditRange");for(var i=0;i<t.length;i++)if(t[i]instanceof r.j){var n=t[i],o=n.containerWidget,s=o.editRangeID.values;if(s.length>0){for(var a=void 0,l=0,d=s;l<d.length;l++){var h=d[l];h.columnFirst==n.index&&h.columnLast==n.index&&(a=h)}if(a){var c=a.editRangeEnd;this.selection.start.setPositionParagraph(a.line,a.line.getOffset(a,a.length)),this.selection.end.setPositionParagraph(c.line,c.line.getOffset(c,c.length)-1),a.user!==e&&a.group!==e||this.removeEditRangeElements(a,e)}}}this.editorHistory&&this.editorHistory.updateComplexHistoryInternal()}},e.prototype.removeUserRestrictionsInternal=function(e,t,n){var r=t;i.i(a.isNullOrUndefined)(t)&&(r=""===e.user?e.group:e.user);var o=this.documentHelper.editRanges.get(r).indexOf(e);this.documentHelper.editRanges.get(r).splice(o,1),0===this.documentHelper.editRanges.get(r).length&&this.documentHelper.editRanges.remove(r),-1!=e.columnFirst&&-1!=e.columnLast&&this.removeEditRangeFromCollection(e),e.removeEditRangeMark(),n||(e.editRangeEnd.line.children.splice(e.editRangeEnd.indexInOwner,1),e.line.children.splice(e.indexInOwner,1))},e.prototype.removeEditRangeFromCollection=function(e){var t=e.paragraph.associatedCell.ownerRow;if(t.editRangeID.containsKey(e.editRangeId)){var n=t.getCellUsingColumnIndex(t.rowIndex,e.columnFirst);i.i(a.isNullOrUndefined)(n)||n.isRenderEditRangeStart&&n.isRenderEditRangeEnd&&(n.isRenderEditRangeEnd=!1,n.isRenderEditRangeStart=!1,t.editRangeID.remove(e.editRangeId))}else for(var r=e.paragraph.associatedCell.ownerTable,o=t.rowIndex-1;o>=0;o--){var s=r.childWidgets[o];if(s.editRangeID.containsKey(e.editRangeId)){var l=s.getCellUsingColumnIndex(s.rowIndex,e.columnFirst);if(!i.i(a.isNullOrUndefined)(l)&&l.isRenderEditRangeStart&&l.isRenderEditRangeEnd){l.isRenderEditRangeEnd=!1,l.isRenderEditRangeStart=!1,s.editRangeID.remove(e.editRangeId);break}}}},e.prototype.removeAllEditRestrictions=function(){this.selection.skipEditRangeRetrieval=!0;for(var e=this.selection.start,t=this.selection.end,i=[],n=this.documentHelper.editRanges.keys,r=0;r<n.length;r++){i=this.documentHelper.editRanges.get(n[r]);for(var o=0;o<i.length;o++)i[o].editRangeEnd.line.children.splice(i[o].editRangeEnd.indexInOwner,1),i[o].line.children.splice(i[o].indexInOwner,1)}this.documentHelper.editRanges.clear(),this.selection.updateEditRangeCollection(),this.selection.start.setPositionInternal(e),this.selection.end.setPositionInternal(t),this.selection.editRegionHighlighters.clear(),this.owner.viewer.updateScrollBars(),this.selection.fireSelectionChanged(!1),this.selection.skipEditRangeRetrieval=!1},e.prototype.insertFormField=function(e){if(!i.i(a.isNullOrUndefined)(this.selection.start)&&!this.owner.enableHeaderAndFooter){this.initHistory("InsertHyperlink");var t=!0;this.selection.isEmpty||(t=this.removeSelectedContents(this.selection)),t&&this.insertFormFieldInternal(e)}},e.prototype.insertFormFieldInternal=function(e){this.updateInsertPosition();var t=[],i=this.getCharacterFormat(this.selection),n=new o.a(void 0);n.copyFormat(i);var s=new r.b(0);s.formFieldData=this.getFormFieldData(e),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.formFieldType=e,this.editorHistory.currentBaseHistoryInfo.fieldBegin=s),s.characterFormat.copyFormat(n),t.push(s);var a=new r.e(0);a.characterFormat.copyFormat(n),s.formFieldData.name=this.getBookmarkName(e,"Insert",this.formFieldCounter),a.name=s.formFieldData.name,t.push(a);var l=new r.d;l.text=this.getFormFieldCode(e),t.push(l);var d=new r.b(2);t.push(d);var h=new r.d;h.text="CheckBox"===e?String.fromCharCode(9744):this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5),h.characterFormat.copyFormat(n),t.push(h);var c=new r.b(1);c.characterFormat.copyFormat(n),t.push(c);var p=new r.e(1);p.characterFormat.copyFormat(n),p.name=s.formFieldData.name,p.reference=a,a.reference=p,t.push(p),this.documentHelper.layout.isInsertFormField=!0,this.insertElement(t),this.documentHelper.layout.isInsertFormField=!1;this.selection.start.paragraph;c.linkFieldCharacter(this.documentHelper),-1===this.documentHelper.fields.indexOf(s)&&this.documentHelper.fields.push(s),this.addFormFieldWidget(s);var u=p.line.getOffset(p,1);this.selection.selects(p.line,u,!0),this.updateEndPosition(),this.reLayout(this.selection,!0)},e.prototype.addFormFieldWidget=function(e){if(-1===this.documentHelper.formFields.indexOf(e)){var t=!1;if(this.documentHelper.formFields.length>0)for(var i=this.selection.getElementPosition(e).startPosition,n=0;n<this.documentHelper.formFields.length;n++){var r=this.selection.getElementPosition(this.documentHelper.formFields[n]).startPosition;if(i.isExistBefore(r)){t=!0,this.documentHelper.formFields.splice(n,0,e);break}}t||this.documentHelper.formFields.push(e)}},e.prototype.getFormFieldData=function(e){switch(e){case"Text":return new r.l;case"CheckBox":return new r.m;case"DropDown":return new r.n}},e.prototype.setFormField=function(e,t){var n,o;i.i(a.isNullOrUndefined)(t.format)?i.i(a.isNullOrUndefined)(t.sizeType)?i.i(a.isNullOrUndefined)(t.dropdownItems)||(n="DropDown",o=new r.n):(n="CheckBox",o=new r.m):(n="Text",o=new r.l),i.i(a.isNullOrUndefined)(n)||i.i(a.isNullOrUndefined)(o)||(o.name=i.i(a.isNullOrUndefined)(t.name)?e.formFieldData.name:t.name,o.copyFieldInfo(t),this.editFormField(n,o))},e.prototype.editFormField=function(e,t){var n=this.selection.getCurrentFormField();if(i.i(a.isNullOrUndefined)(n)||i.i(a.isNullOrUndefined)(n.formFieldData))return!1;this.initComplexHistory("FormField");var l,d;""!==t.name&&(n.formFieldData.name!==t.name&&this.documentHelper.bookmarks.containsKey(t.name)&&this.deleteBookmark(t.name),l=new r.e(0),l.name=t.name,d=new r.e(1),d.name=t.name,l.reference=d,d.reference=l),this.initHistory("InsertHyperlink"),this.editHyperlinkInternal=i.i(a.isNullOrUndefined)(this.editorHistory)||this.editorHistory&&i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo);var h=n.characterFormat.cloneFormat(),c=new o.a;c.copyFormat(h);var p=n.fieldSeparator.nextElement.characterFormat.cloneFormat(),u=n.line.getOffset(n,0);this.selection.start.setPositionParagraph(n.line,u);var g=n.fieldEnd;n.nextNode&&n.nextNode instanceof r.e&&(g=n.nextNode.reference),u=g.line.getOffset(g,1),this.selection.end.setPositionParagraph(g.line,u),this.skipFieldDeleteTracking=!0,this.deleteSelectedContents(this.selection,!1),this.skipFieldDeleteTracking=!1,this.updateInsertPosition();var f=[],m=new r.b(0);m.formFieldData=t,this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.formFieldType=e,this.editorHistory.currentBaseHistoryInfo.fieldBegin=m),f.push(m),m.characterFormat.copyFormat(c),i.i(a.isNullOrUndefined)(l)||f.push(l);var v=new r.d;v.text=this.getFormFieldCode(e),f.push(v);var y=new r.b(2);y.characterFormat.copyFormat(c),f.push(y),v=new r.d,v.characterFormat.copyFormat(p),v.text=this.getDefaultText(t),"CheckBox"===e?(v.characterFormat.copyFormat(m.characterFormat),"Exactly"===t.sizeType&&(v.characterFormat.fontSize=t.size)):t instanceof r.l&&""!==t.defaultValue&&("Text"===t.type?v.text=s.a.formatText(t.format,t.defaultValue):"Number"===t.type?v.text=s.a.formatNumber(t.format,t.defaultValue):v.text=s.a.formatDate(t.format,t.defaultValue)),f.push(v);var w=new r.b(1);w.characterFormat.copyFormat(c),f.push(w);var b=w;i.i(a.isNullOrUndefined)(d)||(b=d,f.push(d)),this.documentHelper.layout.isInsertFormField=!0,this.insertElement(f),this.documentHelper.layout.isInsertFormField=!1;this.selection.start.paragraph;w.linkFieldCharacter(this.documentHelper),-1===this.documentHelper.fields.indexOf(m)&&this.documentHelper.fields.push(m),this.addFormFieldWidget(m);var x=b.line.getOffset(b,1);return this.selection.selects(b.line,x,!0),this.updateEndPosition(),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.editorHistory.updateHistory(),this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.isSkipOperationsBuild=!0,this.editorHistory.updateComplexHistory(),this.isSkipOperationsBuild=!1),this.reLayout(this.selection,!0),this.editHyperlinkInternal=!1,this.nodes=[],!0},e.prototype.getDefaultText=function(e){var t="";return e instanceof r.m?t=e.defaultValue?String.fromCharCode(9745):String.fromCharCode(9744):e instanceof r.n?t=e.dropdownItems.length>0?e.dropdownItems[0]:this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5):e instanceof r.l&&(t=""!==e.defaultValue?e.defaultValue:this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5)),t},e.prototype.getFormFieldCode=function(e){switch(e){case"Text":return"FORMTEXT";case"CheckBox":return"FORMCHECKBOX";case"DropDown":return"FORMDROPDOWN"}},e.prototype.toggleCheckBoxFormField=function(e,t,i){var n=e.formFieldData;if(n instanceof r.m&&n.enabled){if(this.initHistory("UpdateFormField"),this.editorHistory){var o=void 0;n instanceof r.m&&(o=n.checked),this.editorHistory.currentBaseHistoryInfo.fieldBegin=e,this.editorHistory.currentBaseHistoryInfo.setFormFieldInfo(e,o),this.editorHistory.updateHistory()}n.checked=t?i:!n.checked;var s=e.fieldSeparator,a=s.nextNode;n.checked?a.text=String.fromCharCode(9745):a.text=String.fromCharCode(9744),this.owner.documentHelper.layout.reLayoutParagraph(e.line.paragraph,0,0),this.reLayout(this.selection,!1)}},e.prototype.updateFormField=function(e,t,i){var n=e.formFieldData;n&&this.updateFormFieldInternal(e,n,t,i)},e.prototype.updateFormFieldInternal=function(e,t,i,o){if(t instanceof r.l){""===i&&(i=o?this.getDefaultText(t):this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5));var a=i;"Text"===t.type&&""!==t.format&&(a=s.a.formatText(t.format,i)),this.updateFormFieldResult(e,a)}else if(t instanceof r.n){var l=t.dropdownItems[i];t.selectedIndex=i,this.updateFormFieldResult(e,l)}var d=e.fieldEnd.line.getOffset(e.fieldEnd,1),h=new n.a(this.owner);h.setPositionParagraph(e.fieldEnd.line,d),this.documentHelper.selection.selectRange(h,h),this.reLayout(this.selection,!1)},e.prototype.updateFormFieldResult=function(e,t){this.selection.selectFieldInternal(e,!1,!0),this.isSkipOperationsBuild=!0,this.insertText(t),this.isSkipOperationsBuild=!1},e.prototype.checkBookmarkAvailability=function(e,t){for(var i=this.documentHelper.bookmarks,n=0;n<i.length;n++)if(i.containsKey(e))return!1;return!0},e.prototype.getBookmarkName=function(e,t,i){for(var n,r=!1;!1===r;)n=e+i,r=this.checkBookmarkAvailability(n,t),i+=1;return n},e.prototype.applyFormTextFormat=function(e){if(!i.i(a.isNullOrUndefined)(e)){var t=this.getFieldResultText(e),n=t;t=s.a.formatText(e.formFieldData.format,t),void 0!=e.fieldSeparator&&this.applyTextFormatInternal(e,t),this.initHistory("FormTextFormat"),this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo.setFormFieldInfo(e,n),this.editorHistory.updateHistory())}},e.prototype.insertSpaceInFormField=function(){if(this.documentHelper.isInlineFormFillProtectedMode&&this.selection.isInlineFormFillMode()){var e=this.getFieldResultText();0!==e.length&&"\r"!==e||(this.insertTextInternal(this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5),!0),this.selection.selectTextElementStartOfField(this.selection.getCurrentFormField()))}},e.prototype.getFieldResultText=function(e){i.i(a.isNullOrUndefined)(e)&&(e=this.selection.getCurrentFormField());var t=this.selection.startOffset,n=this.selection.endOffset;this.selection.isModifyingSelectionInternally=!0,this.selection.selectFieldInternal(e,!1,!0);var r=this.selection.getText(!1);return this.selection.select(t,n),this.selection.isModifyingSelectionInternally=!1,r},e.prototype.applyTextFormatInternal=function(e,t){var n=e.fieldSeparator.nextElement,o=0;t=t.replace(/\r/g,"");do{if(!i.i(a.isNullOrUndefined)(n)&&n instanceof r.d&&(n.text=t.slice(o,o+n.text.length),o+=n.length),i.i(a.isNullOrUndefined)(n.nextElement))if(i.i(a.isNullOrUndefined)(n.line.nextLine)){this.documentHelper.layout.layoutBodyWidgetCollection(n.paragraph.index,n.paragraph.bodyWidget,n.paragraph,!0);var s=n.paragraph.nextRenderedWidget;if(i.i(a.isNullOrUndefined)(s))break;for(s instanceof r.u&&(s=this.documentHelper.getFirstParagraphBlock(s));s.isEmpty();)s=s.nextRenderedWidget;n=s.childWidgets[0].children[0]}else n=n.line.nextLine.children[0];else n=n.nextElement}while(!(n instanceof r.b&&1===n.fieldType&&n.fieldBegin.formFieldData instanceof r.l));this.documentHelper.layout.layoutBodyWidgetCollection(n.paragraph.index,n.paragraph.bodyWidget,n.paragraph,!0),this.selection.isFormatUpdated=!0,this.reLayout(this.selection,!1),this.selection.isFormatUpdated=!1},e.prototype.constructCommentInitial=function(e){for(var t=e.split(" "),i="",n=0;n<t.length;n++)t[n].length>0&&""!==t[n]&&(i+=t[n][0]);return i},e.prototype.insertFootnote=function(){if(!this.selection.isinFootnote&&!this.selection.isinEndnote){this.isFootNoteInsert=!0,this.isFootNote=!0;var e=new r.f;e.characterFormat.baselineAlignment="Superscript",e.footnoteType="Footnote",e.text="s";var t=new r.g,i=new r.p(t),n=new r.d;t.paragraphFormat.afterSpacing=0,n.characterFormat.baselineAlignment="Superscript",n.line=i,n.text="?",i.children.push(n);var o=new r.d;o.text=" ",o.line=i,i.children.push(o),t.childWidgets.push(i),e.bodyWidget.childWidgets.push(t),this.selection.isEmpty||this.selection.handleRightKey(),this.initInsertInline(e);var s;if(e.paragraph.bodyWidget.page.footnoteWidget)for(var a=0;a<e.paragraph.bodyWidget.page.footnoteWidget.bodyWidgets.length;a++)e.paragraph.bodyWidget.page.footnoteWidget.bodyWidgets[a].footNoteReference===e&&(s=e.paragraph.bodyWidget.page.footnoteWidget.bodyWidgets[a].childWidgets[0]);this.selection.start.setPositionForLineWidget(s.childWidgets[0],o.line.getOffset(o,e.text.length)),this.selection.end.setPositionInternal(this.selection.start),this.updateFootNoteIndex(),this.reLayout(this.selection,!1),this.separator("footnote"),this.continuationSeparator("footnote"),this.isFootNote=!1,this.isFootNoteInsert=!1}},e.prototype.updateFootnoteCollection=function(e){if(-1===this.documentHelper.footnoteCollection.indexOf(e)){var t=!1;if(this.documentHelper.footnoteCollection.length>0)for(var i=this.selection.getElementPosition(e).startPosition,n=0;n<this.documentHelper.footnoteCollection.length;n++){var r=this.selection.getElementPosition(this.documentHelper.footnoteCollection[n]).startPosition;if(i.isExistBefore(r)){t=!0,this.documentHelper.footnoteCollection.splice(n,0,e);break}}t||this.documentHelper.footnoteCollection.push(e)}},e.prototype.insertEndnote=function(){if(!this.selection.isinFootnote&&!this.selection.isinEndnote){this.documentHelper.layout.isEndnoteContentChanged=!0;var e=new r.f;e.characterFormat.baselineAlignment="Superscript",e.footnoteType="Endnote",e.text="s";var t=new r.g,i=new r.p(t),n=new r.d;t.paragraphFormat.afterSpacing=0,n.characterFormat.baselineAlignment="Superscript",n.line=i,n.text="?",i.children.push(n);var o=new r.d;o.text=" ",o.line=i,i.children.push(o),t.childWidgets.push(i),e.bodyWidget.childWidgets.push(t),this.selection.isEmpty||this.selection.handleRightKey(),this.initInsertInline(e);var s,a=this.documentHelper.pages.length,l=this.documentHelper.pages[a-1].bodyWidgets[0];if(l.page.endnoteWidget)for(var d=0;d<l.page.endnoteWidget.bodyWidgets.length;d++)l.page.endnoteWidget.bodyWidgets[d].footNoteReference===e&&(s=l.page.endnoteWidget.bodyWidgets[d].childWidgets[0]);this.selection.start.setPositionForLineWidget(s.childWidgets[0],n.line.getOffset(o,e.text.length)),this.selection.end.setPositionInternal(this.selection.start),this.updateEndNoteIndex(),this.documentHelper.layout.isLayoutWhole=!0,this.isSkipOperationsBuild=!0,this.layoutWholeDocument(),this.isSkipOperationsBuild=!1,this.documentHelper.layout.isLayoutWhole=!1,this.reLayout(this.selection,!1),this.owner.documentHelper.blockToShift=void 0,this.separator("endnote"),this.continuationSeparator("endnote"),this.documentHelper.layout.isEndnoteContentChanged=!1}},e.prototype.updateEndnoteCollection=function(e){if(-1===this.documentHelper.endnoteCollection.indexOf(e)){var t=!1;if(this.documentHelper.endnoteCollection.length>0)for(var i=this.selection.getElementPosition(e).startPosition,n=0;n<this.documentHelper.endnoteCollection.length;n++){var s=this.selection.getElementPosition(this.documentHelper.endnoteCollection[n]).startPosition;if(i.isExistBefore(s)){t=!0,this.documentHelper.endnoteCollection.splice(n,0,e);break}}t||this.documentHelper.endnoteCollection.push(e);var a=this.documentHelper.pages.length;if(this.documentHelper.endnoteCollection.length>0){var d=!1,h=void 0,c=void 0,p=this.documentHelper.endnoteCollection.indexOf(e),u=1,g=void 0,f=this.documentHelper.pages[a-1].bodyWidgets[0];if(f.page.endnoteWidget)for(var m=0;m<f.page.endnoteWidget.bodyWidgets.length;m++){var v=this.documentHelper.endnoteCollection.indexOf(f.page.endnoteWidget.bodyWidgets[m].footNoteReference);if(v>p&&v-p==1){u=m,d=!0;break}}if(h=e,f.page.endnoteWidget instanceof r.a&&"Endnote"===f.page.endnoteWidget.footNoteType)c=f.page.endnoteWidget;else{g=!0,c=new r.a,c.footNoteType="Endnote",c.page=f.page;var y=new r.g;y.characterFormat=new o.a,y.paragraphFormat=new l.F,y.index=0;var w=new r.p(y);y.childWidgets.push(w),this.viewer.cutFromTop(this.viewer.clientActiveArea.y+18)}for(var b=h.bodyWidget,m=0;m<h.bodyWidget.childWidgets.length;m++){var x=h.bodyWidget.childWidgets[m];this.documentHelper.layout.isLayoutWhole?x.containerWidget=void 0:(x.containerWidget=b,b.page=f.page,b.sectionFormat=c.sectionFormat,x.containerWidget.containerWidget=c),d?c.bodyWidgets.splice(u,0,b):c.bodyWidgets.push(b)}u++,g&&(f.page.endnoteWidget=c),c.height+=0}}},e.prototype.updateEndNoteIndex=function(){for(var e=this.documentHelper.endnoteCollection,t=0;t<e.length;t++)e[t].text=this.documentHelper.layout.getFootEndNote(e[t].paragraph.bodyWidget.sectionFormat.endnoteNumberFormat,t+1),i.i(a.isNullOrUndefined)(e[t].bodyWidget.childWidgets[0].childWidgets[0].children[0])||(e[t].bodyWidget.childWidgets[0].childWidgets[0].children[0].text=e[t].text)},e.prototype.separator=function(e){var t=new r.g,i=new r.p(t),n=new r.d;n.characterFormat.fontColor="#00000000",n.line=i,n.text=String.fromCharCode(3),i.children.push(n),t.childWidgets.push(i),"footnote"===e&&this.documentHelper.footnotes.separator.length<1?this.documentHelper.footnotes.separator.push(t):"endnote"===e&&this.documentHelper.endnotes.separator.length<1&&this.documentHelper.endnotes.separator.push(t)},e.prototype.continuationSeparator=function(e){var t=new r.g,i=new r.p(t),n=new r.d;n.characterFormat.fontColor="#00000000",n.line=i,n.text=String.fromCharCode(4),i.children.push(n),t.childWidgets.push(i),"footnote"===e&&this.documentHelper.footnotes.continuationSeparator.length<1?this.documentHelper.footnotes.continuationSeparator.push(t):"endnote"===e&&this.documentHelper.endnotes.continuationSeparator.length<1&&this.documentHelper.endnotes.continuationSeparator.push(t)},e.prototype.updateFootNoteIndex=function(){for(var e=this.documentHelper.footnoteCollection,t=0;t<e.length;t++)e[t].text=(t+1).toString(),i.i(a.isNullOrUndefined)(e[t].bodyWidget.childWidgets[0].childWidgets[0].children[0])||(e[t].bodyWidget.childWidgets[0].childWidgets[0].children[0].text=(t+1).toString())},e.prototype.setCharFormatForCollaborativeEditing=function(e){if(!i.i(a.isNullOrUndefined)(this.editorHistory)&&!i.i(a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&this.owner.enableCollaborativeEditing){var t={};s.a.writeCharacterFormat(t,!0,e,void 0,!0),this.editorHistory.currentBaseHistoryInfo.type="CharacterFormat",this.editorHistory.currentBaseHistoryInfo.format=JSON.stringify(t)}},e.prototype.clear=function(){this.pageRefFields&&(this.pageRefFields={})},e}()},function(e,t,i){"use strict";i.d(t,"a",function(){return c}),i.d(t,"b",function(){return p}),i.d(t,"c",function(){return u});var n=i(0),r=(i.n(n),i(7)),o=i(6),s=i(20),a=i(2),l=i(4),d=i(29),h=i(16),c=function(){function e(e,t){this.resizeContainerDiv=void 0,this.topLeftRect=void 0,this.topMiddleRect=void 0,this.topRightRect=void 0,this.bottomLeftRect=void 0,this.bottomMiddleRect=void 0,this.bottomRightRect=void 0,this.leftMiddleRect=void 0,this.rightMiddleRect=void 0,this.topLeftRectParent=void 0,this.topMiddleRectParent=void 0,this.topRightRectParent=void 0,this.bottomLeftRectParent=void 0,this.bottomMiddleRectParent=void 0,this.bottomRightRectParent=void 0,this.leftMiddleRectParent=void 0,this.rightMiddleRectParent=void 0,this.resizeMarkSizeIn=7,this.selectedImageWidget=void 0,this.baseHistoryInfo=void 0,this.isImageResizing=!1,this.isImageResizerVisible=!1,this.isImageMoveToNextPage=!1,this.selectedResizeElement=void 0,this.topValue=void 0,this.leftValue=void 0,this.owner=e,this.selectedImageWidget=new o.a,this.documentHelper=t,this.imageResizerPoints=new p,i.i(n.isNullOrUndefined)(this.imageResizerDiv)&&this.viewer&&this.documentHelper.pageContainer&&this.initializeImageResizer()}return Object.defineProperty(e.prototype,"currentImageElementBox",{get:function(){return this.currentImageElementBoxIn},set:function(e){this.currentImageElementBoxIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"resizeMarkSize",{get:function(){return this.resizeMarkSizeIn},set:function(e){this.resizeMarkSizeIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isShapeResize",{get:function(){return this.currentImageElementBox instanceof a.s},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"ImageResizer"},e.prototype.setImageResizerPositions=function(e,t,i,n){this.imageResizerDivElement.style.top=t.toString()+"px",this.imageResizerDivElement.style.left=e.toString()+"px",this.imageResizerDivElement.style.borderWidth="0px",this.imageResizerDivElement.style.height=n+"px",this.owner.viewer instanceof r.C?this.imageResizerDivElement.style.width=i-e-this.documentHelper.scrollbarWidth+"px":this.imageResizerDivElement.style.width=i+"px",this.imageResizerDivElement.style.backgroundColor="transparent",this.imageResizerDivElement.style.overflow="hidden",this.imageResizerDivElement.style.position="absolute"},e.prototype.initializeImageResizer=function(){this.imageResizerDivElement=document.createElement("div"),this.imageResizerDivElement.style.zIndex="1",this.imageResizerDivElement.style.display="none",this.documentHelper.pageContainer.appendChild(this.imageResizerDivElement)},e.prototype.positionImageResizer=function(e){this.selectedImageWidget.clear();var t;i.i(n.isNullOrUndefined)(this.documentHelper.currentPage)||(t=this.imageResizerDivElement),i.i(n.isNullOrUndefined)(t)||t.contains(this.imageResizerDiv)||(this.imageResizerDiv=this.initResizeMarks(t,this)),this.imageResizerDiv.style.width=e.width+"px",this.imageResizerDiv.style.height=e.height+"px",this.currentImageElementBox=e;var o,s,l=e.line;e instanceof a.r&&"Inline"!==e.textWrappingStyle?(o=e.y,s=e.x):(o=this.documentHelper.selection.getTop(l)+e.margin.top,s=this.documentHelper.selection.getLeftInternal(l,e,0));var d=this.documentHelper.selection.getPage(l.paragraph);this.currentPage=d;var h=0;i.i(n.isNullOrUndefined)(t)||(this.owner.viewer instanceof r.C&&(this.imageResizerDivElement.style.width=d.boundingRectangle.width-d.boundingRectangle.x-s-this.documentHelper.scrollbarWidth+"px"),this.imageResizerDivElement.style.display="block",this.owner.viewer instanceof r.C?t.style.width=d.boundingRectangle.width-this.documentHelper.scrollbarWidth-d.boundingRectangle.x-s+"px":t.style.width=d.boundingRectangle.width+"px",t.style.height=d.boundingRectangle.height+"px",t.style.left=d.boundingRectangle.x+"px",t.style.top=d.boundingRectangle.y+"px",t.style.borderWidth="0px",t.style.backgroundColor="transparent",t.style.overflow="hidden",t.style.position="absolute");var c=0,p=this.documentHelper.getPageWidth(d);c=parseFloat(this.imageResizerDivElement.style.width),h=(this.documentHelper.visibleBounds.width-c*this.documentHelper.zoomFactor)/2,h<30&&(h=30),p<c&&(h+=(c-p)*this.documentHelper.zoomFactor/2);var g=this.imageResizerDivElement,f=parseFloat(g.style.width),m=parseFloat(g.style.height),v=parseFloat(this.imageResizerDiv.style.width),y=parseFloat(this.imageResizerDiv.style.height),w=(this.resizeMarkSize-1)/2,b=v+2*w,x=y+2*w;if(b>(f-s)*this.documentHelper.zoomFactor+w&&(b=(f-s)*this.documentHelper.zoomFactor),x>(m-o)*this.documentHelper.zoomFactor+w&&(x=(m-o)*this.documentHelper.zoomFactor),this.imageResizerDivElement.style.width=parseInt(this.imageResizerDivElement.style.width.replace("px",""),10)*this.documentHelper.zoomFactor+"px",this.imageResizerDivElement.style.height=parseInt(this.imageResizerDivElement.style.height.replace("px",""),10)*this.documentHelper.zoomFactor+"px",x=this.documentHelper.render.getScaledValue(e.height),b=this.documentHelper.render.getScaledValue(e.width),e instanceof a.r?(s=this.documentHelper.render.getScaledValue(s),o=this.documentHelper.render.getScaledValue(o)):(s=e.x*this.documentHelper.zoomFactor,o=e.y*this.documentHelper.zoomFactor),this.setImageResizerPosition(s,o,b,x,this),this.owner.selection.isInShape?this.resizeContainerDiv.style.borderStyle="dashed":this.resizeContainerDiv.style.borderStyle="solid",!this.selectedImageWidget.containsKey(l)){var C=new u(e.height,e.width);this.selectedImageWidget.add(l,C)}},e.prototype.showImageResizer=function(){i.i(n.isNullOrUndefined)(this.imageResizerDivElement)||(this.imageResizerDivElement.style.display=""),i.i(n.isNullOrUndefined)(this.resizeContainerDiv)||(this.resizeContainerDiv.style.display=""),i.i(n.isNullOrUndefined)(this.bottomLeftRect)||(this.bottomLeftRect.style.display="",this.bottomLeftRectParent.style.display=""),i.i(n.isNullOrUndefined)(this.bottomRightRect)||(this.bottomRightRect.style.display="",this.bottomRightRectParent.style.display=""),i.i(n.isNullOrUndefined)(this.bottomMiddleRect)||(this.bottomMiddleRect.style.display="",this.bottomMiddleRectParent.style.display=""),i.i(n.isNullOrUndefined)(this.rightMiddleRect)||(this.rightMiddleRect.style.display="",this.rightMiddleRectParent.style.display=""),i.i(n.isNullOrUndefined)(this.topRightRect)||(this.topRightRect.style.display="",this.topRightRectParent.style.display=""),i.i(n.isNullOrUndefined)(this.topLeftRect)||(this.topLeftRect.style.display="",this.topLeftRectParent.style.display=""),i.i(n.isNullOrUndefined)(this.leftMiddleRect)||(this.leftMiddleRect.style.display="",this.leftMiddleRectParent.style.display=""),i.i(n.isNullOrUndefined)(this.topMiddleRect)||(this.topMiddleRect.style.display="",this.topMiddleRectParent.style.display=""),this.isImageResizerVisible=!0},e.prototype.hideImageResizer=function(){i.i(n.isNullOrUndefined)(this.imageResizerDivElement)||(this.imageResizerDivElement.style.display="none"),i.i(n.isNullOrUndefined)(this.resizeContainerDiv)||(this.resizeContainerDiv.style.display="none"),i.i(n.isNullOrUndefined)(this.bottomLeftRect)||(this.bottomLeftRect.style.display="none",this.bottomLeftRectParent.style.display="none"),i.i(n.isNullOrUndefined)(this.bottomRightRect)||(this.bottomRightRect.style.display="none",this.bottomRightRectParent.style.display="none"),i.i(n.isNullOrUndefined)(this.bottomMiddleRect)||(this.bottomMiddleRect.style.display="none",this.bottomMiddleRectParent.style.display="none"),i.i(n.isNullOrUndefined)(this.rightMiddleRect)||(this.rightMiddleRect.style.display="none",this.rightMiddleRectParent.style.display="none"),i.i(n.isNullOrUndefined)(this.topRightRect)||(this.topRightRect.style.display="none",this.topRightRectParent.style.display="none"),i.i(n.isNullOrUndefined)(this.topLeftRect)||(this.topLeftRect.style.display="none",this.topLeftRectParent.style.display="none"),i.i(n.isNullOrUndefined)(this.leftMiddleRect)||(this.leftMiddleRect.style.display="none",this.leftMiddleRectParent.style.display="none"),i.i(n.isNullOrUndefined)(this.topMiddleRect)||(this.topMiddleRect.style.display="none",this.topMiddleRectParent.style.display="none"),this.isImageResizerVisible=!1,this.currentPage=void 0},e.prototype.initResizeMarks=function(e,t){return this.initResizeContainerDiv(t),e.appendChild(t.resizeContainerDiv),t.topRightRectParent=document.createElement("div"),t.topRightRectParent.style.cursor="ne-resize",t.topRightRectParent.id=this.documentHelper.owner.containerId+"_TopRightRectParent",this.applyProperties(t.topRightRectParent),t.topRightRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.topRightRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.topRightRectParent.style.opacity="-1",e.appendChild(t.topRightRectParent),t.topRightRect=document.createElement("div"),t.topRightRect.id=this.documentHelper.owner.containerId+"_TopRightRect",t.topRightRect.style.cursor="ne-resize",this.applyProperties(t.topRightRect),e.appendChild(t.topRightRect),t.topLeftRectParent=document.createElement("div"),t.topLeftRectParent.style.cursor="nw-resize",t.topLeftRectParent.id=this.documentHelper.owner.containerId+"_TopLeftRectParent",this.applyProperties(t.topLeftRectParent),t.topLeftRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.topLeftRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.topLeftRectParent.style.opacity="-1",e.appendChild(t.topLeftRectParent),t.topLeftRect=document.createElement("div"),t.topLeftRect.id=this.documentHelper.owner.containerId+"_TopLeftRect",t.topLeftRect.style.cursor="nw-resize",this.applyProperties(t.topLeftRect),e.appendChild(t.topLeftRect),t.topMiddleRectParent=document.createElement("div"),t.topMiddleRectParent.style.cursor="n-resize",t.topMiddleRectParent.id=this.documentHelper.owner.containerId+"_TopMiddleRectParent",this.applyProperties(t.topMiddleRectParent),t.topMiddleRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.topMiddleRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.topMiddleRectParent.style.opacity="-1",e.appendChild(t.topMiddleRectParent),t.topMiddleRect=document.createElement("div"),t.topMiddleRect.id=this.documentHelper.owner.containerId+"_TopMiddleRect",t.topMiddleRect.style.cursor="n-resize",this.applyProperties(t.topMiddleRect),e.appendChild(t.topMiddleRect),t.bottomRightRectParent=document.createElement("div"),t.bottomRightRectParent.style.cursor="se-resize",t.bottomRightRectParent.id=this.documentHelper.owner.containerId+"_BottomRightRectParent",this.applyProperties(t.bottomRightRectParent),t.bottomRightRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.bottomRightRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.bottomRightRectParent.style.opacity="-1",e.appendChild(t.bottomRightRectParent),t.bottomRightRect=document.createElement("div"),t.bottomRightRect.id=this.documentHelper.owner.containerId+"_BottomRightRect",t.bottomRightRect.style.cursor="se-resize",this.applyProperties(t.bottomRightRect),e.appendChild(t.bottomRightRect),t.bottomLeftRectParent=document.createElement("div"),t.bottomLeftRectParent.style.cursor="sw-resize",t.bottomLeftRectParent.id=this.documentHelper.owner.containerId+"_BottomLeftRectParent",this.applyProperties(t.bottomLeftRectParent),t.bottomLeftRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.bottomLeftRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.bottomLeftRectParent.style.opacity="-1",e.appendChild(t.bottomLeftRectParent),t.bottomLeftRect=document.createElement("div"),t.bottomLeftRect.id=this.documentHelper.owner.containerId+"_BottomLeftRect",t.bottomLeftRect.style.cursor="sw-resize",this.applyProperties(t.bottomLeftRect),e.appendChild(t.bottomLeftRect),t.bottomMiddleRectParent=document.createElement("div"),t.bottomMiddleRectParent.style.cursor="s-resize",t.bottomMiddleRectParent.id=this.documentHelper.owner.containerId+"_BottomMiddleRectParent",this.applyProperties(t.bottomMiddleRectParent),t.bottomMiddleRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.bottomMiddleRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.bottomMiddleRectParent.style.opacity="-1",e.appendChild(t.bottomMiddleRectParent),t.bottomMiddleRect=document.createElement("div"),t.bottomMiddleRect.id=this.documentHelper.owner.containerId+"_BottomMiddleRect",t.bottomMiddleRect.style.cursor="s-resize",this.applyProperties(t.bottomMiddleRect),e.appendChild(t.bottomMiddleRect),t.rightMiddleRectParent=document.createElement("div"),t.rightMiddleRectParent.style.cursor="e-resize",t.rightMiddleRectParent.id=this.documentHelper.owner.containerId+"_RightMiddleRectParent",this.applyProperties(t.rightMiddleRectParent),t.rightMiddleRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.rightMiddleRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.rightMiddleRectParent.style.opacity="-1",e.appendChild(t.rightMiddleRectParent),t.rightMiddleRect=document.createElement("div"),t.rightMiddleRect.id=this.documentHelper.owner.containerId+"_RightMiddleRect",t.rightMiddleRect.style.cursor="e-resize",this.applyProperties(t.rightMiddleRect),e.appendChild(t.rightMiddleRect),t.leftMiddleRectParent=document.createElement("div"),t.leftMiddleRectParent.style.cursor="w-resize",t.leftMiddleRectParent.id=this.documentHelper.owner.containerId+"_LeftMiddleRectParent",this.applyProperties(t.leftMiddleRectParent),t.leftMiddleRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.leftMiddleRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.leftMiddleRectParent.style.opacity="-1",e.appendChild(t.leftMiddleRectParent),t.leftMiddleRect=document.createElement("div"),t.leftMiddleRect.id=this.documentHelper.owner.containerId+"_LeftMiddleRect",t.leftMiddleRect.style.cursor="w-resize",this.applyProperties(t.leftMiddleRect),e.appendChild(t.leftMiddleRect),t.resizeContainerDiv},e.prototype.setImageResizerPosition=function(e,t,i,n,r){r.resizeContainerDiv.style.width=i+"px",r.resizeContainerDiv.style.height=n+"px",r.resizeContainerDiv.style.left=e+"px",r.resizeContainerDiv.style.top=t+"px",r.topRightRect.style.left=e+i-5+"px",r.topRightRect.style.top=t-4+"px",r.topLeftRect.style.left=e-5+"px",r.topLeftRect.style.top=t-4+"px",r.topMiddleRect.style.left=parseFloat(r.topLeftRect.style.left)+i/2-4+"px",r.topMiddleRect.style.top=t-4+"px",r.bottomRightRect.style.left=r.topRightRect.style.left,r.bottomRightRect.style.top=parseFloat(r.topRightRect.style.top)+n+"px",r.bottomLeftRect.style.left=r.topLeftRect.style.left,r.bottomLeftRect.style.top=parseFloat(r.topLeftRect.style.top)+n+"px",r.bottomMiddleRect.style.left=r.topMiddleRect.style.left,r.bottomMiddleRect.style.top=parseFloat(r.topMiddleRect.style.top)+n+"px",r.rightMiddleRect.style.left=e+i-4+"px",r.rightMiddleRect.style.top=parseFloat(r.topRightRect.style.top)+n/2+"px",r.leftMiddleRect.style.left=r.topLeftRect.style.left,r.leftMiddleRect.style.top=parseFloat(r.topLeftRect.style.top)+n/2+"px",r.topRightRectParent.style.left=this.documentHelper.isTouchInput?e+i-15+"px":e+i-8+"px",r.topRightRectParent.style.top=this.documentHelper.isTouchInput?t-15+"px":t-7+"px",r.topLeftRectParent.style.left=this.documentHelper.isTouchInput?e-15+"px":e-8+"px",r.topLeftRectParent.style.top=this.documentHelper.isTouchInput?t-15+"px":t-7+"px",r.topMiddleRectParent.style.left=parseFloat(r.topLeftRectParent.style.left)+i/2-4+"px",r.topMiddleRectParent.style.top=this.documentHelper.isTouchInput?t-15+"px":t-7+"px",r.bottomRightRectParent.style.left=r.topRightRectParent.style.left,r.bottomRightRectParent.style.top=parseFloat(r.topRightRectParent.style.top)+n+"px",r.bottomLeftRectParent.style.left=r.topLeftRectParent.style.left,r.bottomLeftRectParent.style.top=parseFloat(r.topLeftRectParent.style.top)+n+"px",r.bottomMiddleRectParent.style.left=r.topMiddleRectParent.style.left,r.bottomMiddleRectParent.style.top=parseFloat(r.topMiddleRectParent.style.top)+n+"px",r.rightMiddleRectParent.style.left=this.documentHelper.isTouchInput?e+i-15+"px":e+i-7+"px",r.rightMiddleRectParent.style.top=parseFloat(r.topRightRectParent.style.top)+n/2+"px",r.leftMiddleRectParent.style.left=r.topLeftRectParent.style.left,r.leftMiddleRectParent.style.top=parseFloat(r.topLeftRectParent.style.top)+n/2+"px",this.setImageResizingPoints(r),this.documentHelper.isTouchInput?this.applyPropertiesForTouch():this.applyPropertiesForMouse()},e.prototype.setImageResizingPoints=function(e){this.imageResizerPoints.resizeContainerDiv.x=parseFloat(e.resizeContainerDiv.style.left),this.imageResizerPoints.resizeContainerDiv.y=parseFloat(e.resizeContainerDiv.style.top),this.imageResizerPoints.bottomLeftRectParent.x=parseFloat(e.bottomLeftRectParent.style.left),this.imageResizerPoints.bottomLeftRectParent.y=parseFloat(e.bottomLeftRectParent.style.top),this.imageResizerPoints.bottomRightRectParent.x=parseFloat(e.bottomRightRectParent.style.left),this.imageResizerPoints.bottomRightRectParent.y=parseFloat(e.bottomRightRectParent.style.top),this.imageResizerPoints.bottomMiddleRectParent.x=parseFloat(e.bottomMiddleRectParent.style.left),this.imageResizerPoints.bottomMiddleRectParent.y=parseFloat(e.bottomMiddleRectParent.style.top),this.imageResizerPoints.topLeftRectParent.x=parseFloat(e.topLeftRectParent.style.left),this.imageResizerPoints.topLeftRectParent.y=parseFloat(e.topLeftRectParent.style.top),this.imageResizerPoints.topRightRectParent.x=parseFloat(e.topRightRectParent.style.left),this.imageResizerPoints.topRightRectParent.y=parseFloat(e.topRightRectParent.style.top),this.imageResizerPoints.topMiddleRectParent.x=parseFloat(e.topMiddleRectParent.style.left),this.imageResizerPoints.topMiddleRectParent.y=parseFloat(e.topMiddleRectParent.style.top),this.imageResizerPoints.leftMiddleRectParent.x=parseFloat(e.leftMiddleRectParent.style.left),this.imageResizerPoints.leftMiddleRectParent.y=parseFloat(e.leftMiddleRectParent.style.top),this.imageResizerPoints.rightMiddleRectParent.x=parseFloat(e.rightMiddleRectParent.style.left),this.imageResizerPoints.rightMiddleRectParent.y=parseFloat(e.rightMiddleRectParent.style.top)},e.prototype.initResizeContainerDiv=function(e){e.resizeContainerDiv=document.createElement("div"),e.resizeContainerDiv.id=this.documentHelper.owner.containerId+"_ResizeDivElement",e.resizeContainerDiv.style.position="absolute",e.resizeContainerDiv.style.border="1px solid #bfbfbf",e.resizeContainerDiv.style.zIndex="30",e.resizeContainerDiv.style.backgroundColor="transparent",e.resizeContainerDiv.style.display="block"},e.prototype.applyProperties=function(e){e.style.position="absolute",e.style.width="8px",e.style.height="8px",e.style.fontSize="0px",e.style.zIndex=" 551",e.style.backgroundColor="#ffffff",e.style.border="1px solid #bfbfbf",e.style.boxShadow="0 1px 2px 0 #bfbfbf 0.35",e.style.color="#000000"},e.prototype.handleImageResizing=function(e,t,r){t/=this.documentHelper.zoomFactor,r/=this.documentHelper.zoomFactor,this.leftValue=i.i(n.isNullOrUndefined)(this.leftValue)?t:this.leftValue,this.topValue=i.i(n.isNullOrUndefined)(this.topValue)?r:this.topValue;var o,s=this.selectedResizeElement.id.split("_"),a=s[s.length-1];switch(a){case"TopRightRectParent":o=this.topRightResizing(e),t=o.left,r=o.top;break;case"TopLeftRectParent":o=this.topLeftResizing(e),t=-o.left,r=-o.top;break;case"TopMiddleRectParent":t=0,r=this.topMiddleResizing(e);break;case"BottomRightRectParent":o=this.bottomRightResizing(e),t=o.left,r=o.top;break;case"BottomLeftRectParent":o=this.bottomLeftResizing(e),t=-o.left,r=-o.top;break;case"BottomMiddleRectParent":r=e.y-r,t=0;break;case"RightMiddleRectParent":t=e.x-t,r=0;break;case"LeftMiddleRectParent":t=this.leftMiddleResizing(e),r=0}if(0!==t||0!==r){var d=this.currentImageElementBox.line.paragraph,h=this.currentImageElementBox;if(!i.i(n.isNullOrUndefined)(d)&&d.isInsideTable){var c=d.containerWidget;if(!i.i(n.isNullOrUndefined)(c)){var p=c.containerWidget,u=l.a.convertPointToPixel(h.height),g=p.height-u;r>0&&p.y+g+u+r>this.viewer.clientArea.bottom&&(this.isImageMoveToNextPage=!0)}}if(this.owner.enableHistoryMode&&this.initHistoryForImageResizer(this.currentImageElementBox),!i.i(n.isNullOrUndefined)(this.currentImageElementBox)){var f=this.currentImageElementBox.width+t>10?this.currentImageElementBox.width+t:10,m=this.currentImageElementBox.height+r>10?this.currentImageElementBox.height+r:10;"BottomRightRectParent"!==a&&"TopRightRectParent"!==a&&"BottomLeftRectParent"!==a&&"TopLeftRectParent"!==a||(m=this.currentImageElementBox.height/this.currentImageElementBox.width*f,f=this.currentImageElementBox.width/this.currentImageElementBox.height*m),this.currentImageElementBox.width=f,this.currentImageElementBox.height=m;this.currentImageElementBox.line.paragraph;this.positionImageResizer(this.currentImageElementBox)}this.isImageResizing=!0}},e.prototype.handleImageResizingOnMouse=function(e){if(!i.i(n.isNullOrUndefined)(this.selectedResizeElement)){var t=parseFloat(this.selectedResizeElement.style.left),r=parseFloat(this.selectedResizeElement.style.top),o=new l.b(e.offsetX,e.offsetY),s=this.viewer.findFocusedPage(o,!0);this.handleImageResizing(s,t,r)}},e.prototype.topMiddleResizing=function(e){var t;return this.topValue>=e.y?(t=this.topValue/e.y,this.topValue=e.y,this.viewer instanceof r.D&&this.topValue<=this.viewer.pageGap&&(t=1)):(t=-e.y/this.topValue,this.topValue=e.y,0===this.topValue&&(t=-1)),t},e.prototype.leftMiddleResizing=function(e){var t;return this.leftValue>=e.x?(t=this.leftValue/e.x,this.leftValue=e.x,0===this.leftValue&&(t=1,this.leftValue=parseFloat(this.selectedResizeElement.style.left))):(t=-e.x/this.leftValue,this.leftValue=e.x),t},e.prototype.topRightResizing=function(e){return this.leftValue<=e.x&&this.topValue>=e.y?this.getOuterResizingPoint(e):this.getInnerResizingPoint(e)},e.prototype.topLeftResizing=function(e){return this.leftValue>=e.x&&this.topValue>=e.y?this.getOuterResizingPoint(e):this.getInnerResizingPoint(e)},e.prototype.bottomRightResizing=function(e){return this.leftValue<=e.x&&this.topValue<=e.y?this.getOuterResizingPoint(e):this.getInnerResizingPoint(e)},e.prototype.bottomLeftResizing=function(e){return this.leftValue>=e.x&&this.topValue<=e.y?this.getOuterResizingPoint(e):this.getInnerResizingPoint(e)},e.prototype.getOuterResizingPoint=function(e){var t,i;return t=e.x-this.leftValue,this.leftValue=e.x,i=e.y-this.topValue,this.topValue=e.y,{left:t,top:i}},e.prototype.getInnerResizingPoint=function(e){var t,i;return t=-(this.leftValue-e.x),this.leftValue=e.x,i=-(this.topValue-e.y),this.topValue=e.y,{left:t,top:i}},e.prototype.handleImageResizingOnTouch=function(e){if(!i.i(n.isNullOrUndefined)(this.selectedResizeElement)){var t=parseFloat(this.selectedResizeElement.style.left)+24,r=parseFloat(this.selectedResizeElement.style.top)+24,o=e.touches,s=new l.b(o[0].clientX,o[0].clientY),a=this.viewer.findFocusedPage(s,!0);if(i.i(n.isNullOrUndefined)(this.currentImageElementBox)||i.i(n.isNullOrUndefined)(this.currentImageElementBox))return;this.handleImageResizing(a,t,r)}},e.prototype.getImagePoint=function(e){var t=this.documentHelper.render.getScaledValue(e.x,1),r=this.documentHelper.render.getScaledValue(e.y,2);e=new l.b(t,r);var o=this.imageResizerPoints,s="",a=void 0,d=o.bottomMiddleRectParent,h=o.bottomRightRectParent,c=o.bottomLeftRectParent,p=o.topMiddleRectParent,u=o.topRightRectParent,g=o.topLeftRectParent,f=o.rightMiddleRectParent,m=o.leftMiddleRectParent;return i.i(n.isNullOrUndefined)(this.bottomMiddleRectParent)||"none"===this.bottomMiddleRectParent.style.display||(e.x>d.x&&e.x<=d.x+15&&e.y>d.y&&e.y<=d.y+15?(a=this.bottomMiddleRectParent,s="s-resize"):e.x>h.x&&e.x<=h.x+15&&e.y>h.y&&e.y<=h.y+15?(a=this.bottomRightRectParent,s="se-resize"):e.x>c.x&&e.x<=c.x+15&&e.y>c.y&&e.y<=c.y+15?(a=this.bottomLeftRectParent,s="sw-resize"):e.x>p.x&&e.x<=p.x+15&&e.y>p.y&&e.y<=p.y+15?(a=this.topMiddleRectParent,s="n-resize"):e.x>u.x&&e.x<=u.x+15&&e.y>u.y&&e.y<=u.y+15?(a=this.topRightRectParent,s="ne-resize"):e.x>g.x&&e.x<=g.x+15&&e.y>g.y&&e.y<=g.y+15?(a=this.topLeftRectParent,s="nw-resize"):e.x>m.x&&e.x<=m.x+15&&e.y>m.y&&e.y<=m.y+15?(a=this.leftMiddleRectParent,s="w-resize"):e.x>f.x&&e.x<=f.x+15&&e.y>f.y&&e.y<=f.y+15?(a=this.rightMiddleRectParent,s="e-resize"):!i.i(n.isNullOrUndefined)(this.resizeContainerDiv)&&e.x>parseFloat(this.resizeContainerDiv.style.left)&&e.x<=parseFloat(this.resizeContainerDiv.style.left)+parseFloat(this.resizeContainerDiv.style.width)&&e.y>parseFloat(this.resizeContainerDiv.style.top)&&e.y<=parseFloat(this.resizeContainerDiv.style.top)+parseFloat(this.resizeContainerDiv.style.height)&&(s="move")),{selectedElement:a,resizePosition:s}},e.prototype.applyPropertiesForMouse=function(){i.i(n.isNullOrUndefined)(this.bottomLeftRectParent)||(this.bottomMiddleRectParent.style.width="14px",this.bottomMiddleRectParent.style.height="14px",this.bottomRightRectParent.style.width="14px",this.bottomRightRectParent.style.height="14px",this.bottomLeftRectParent.style.width="14px",this.bottomLeftRectParent.style.height="14px",this.topMiddleRectParent.style.width="14px",this.topMiddleRectParent.style.height="14px",this.topRightRectParent.style.width="14px",this.topRightRectParent.style.height="14px",this.topLeftRectParent.style.width="14px",this.topLeftRectParent.style.height="14px",this.leftMiddleRectParent.style.width="14px",this.leftMiddleRectParent.style.height="14px",this.rightMiddleRectParent.style.width="14px",this.rightMiddleRectParent.style.height="14px")},e.prototype.getImagePointOnTouch=function(e){var t=this.documentHelper.render.getScaledValue(e.x,1),r=this.documentHelper.render.getScaledValue(e.y,2);e=new l.b(t,r);var o=this.imageResizerPoints,s="",a=void 0,d=o.bottomMiddleRectParent,h=o.bottomRightRectParent,c=o.bottomLeftRectParent,p=o.topMiddleRectParent,u=o.topRightRectParent,g=o.topLeftRectParent,f=o.rightMiddleRectParent,m=o.leftMiddleRectParent;return i.i(n.isNullOrUndefined)(this.bottomMiddleRectParent)||"none"===this.bottomMiddleRectParent.style.display||(e.x>d.x&&e.x<=d.x+25&&e.y>d.y&&e.y<=d.y+25?(a=this.bottomMiddleRectParent,s="s-resize"):e.x>h.x&&e.x<=h.x+25&&e.y>h.y&&e.y<=h.y+25?(a=this.bottomRightRectParent,s="se-resize"):e.x>c.x&&e.x<=c.x+25&&e.y>c.y&&e.y<=c.y+25?(a=this.bottomLeftRectParent,s="sw-resize"):e.x>p.x&&e.x<=p.x+25&&e.y>p.y&&e.y<=p.y+25?(a=this.topMiddleRectParent,s="n-resize"):e.x>u.x&&e.x<=u.x+25&&e.y>u.y&&e.y<=u.y+25?(a=this.topRightRectParent,s="ne-resize"):e.x>g.x&&e.x<=g.x+25&&e.y>g.y&&e.y<=g.y+25?(a=this.topLeftRectParent,s="nw-resize"):e.x>m.x&&e.x<=m.x+25&&e.y>m.y&&e.y<=m.y+25?(a=this.leftMiddleRectParent,s="w-resize"):e.x>f.x&&e.x<=f.x+25&&e.y>f.y&&e.y<=f.y+25?(a=this.rightMiddleRectParent,s="e-resize"):!i.i(n.isNullOrUndefined)(this.resizeContainerDiv)&&e.x>parseFloat(this.resizeContainerDiv.style.left)&&e.x<=parseFloat(this.resizeContainerDiv.style.left)+parseFloat(this.resizeContainerDiv.style.width)&&e.y>parseFloat(this.resizeContainerDiv.style.top)&&e.y<=parseFloat(this.resizeContainerDiv.style.top)+parseFloat(this.resizeContainerDiv.style.height)&&(s="move")),{selectedElement:a,resizePosition:s}},e.prototype.applyPropertiesForTouch=function(){i.i(n.isNullOrUndefined)(this.bottomLeftRectParent)||(this.bottomMiddleRectParent.style.width="30px",this.bottomMiddleRectParent.style.height="30px",this.bottomRightRectParent.style.width="30px",this.bottomRightRectParent.style.height="30px",this.bottomLeftRectParent.style.width="30px",this.bottomLeftRectParent.style.height="30px",this.topMiddleRectParent.style.width="30px",this.topMiddleRectParent.style.height="30px",this.topRightRectParent.style.width="30px",this.topRightRectParent.style.height="30px",this.topLeftRectParent.style.width="30px",this.topLeftRectParent.style.height="30px",this.leftMiddleRectParent.style.width="30px",this.leftMiddleRectParent.style.height="30px",this.rightMiddleRectParent.style.width="30px",this.rightMiddleRectParent.style.height="30px")},e.prototype.mouseUpInternal=function(){this.currentImageElementBox.width=parseFloat(this.imageResizerDiv.style.width)/this.documentHelper.zoomFactor,this.currentImageElementBox.height=parseFloat(this.imageResizerDiv.style.height)/this.documentHelper.zoomFactor,this.owner.isShiftingEnabled=!0,this.owner.editorModule.setOffsetValue(this.owner.selection),this.documentHelper.layout.reLayoutParagraph(this.currentImageElementBox.line.paragraph,0,0),this.updateHistoryForImageResizer(),this.owner.editorModule.reLayout(this.owner.selection,!0),this.viewer.updateScrollBars()},e.prototype.initHistoryForImageResizer=function(e){!i.i(n.isNullOrUndefined)(this.owner)&&i.i(n.isNullOrUndefined)(this.baseHistoryInfo)&&(this.baseHistoryInfo=new d.a(this.owner),this.baseHistoryInfo.action="ImageResizing",this.baseHistoryInfo.updateSelection(),this.baseHistoryInfo.modifiedProperties.push(new s.b(e)))},e.prototype.updateHistoryForImageResizer=function(){if(!i.i(n.isNullOrUndefined)(this.owner)&&!i.i(n.isNullOrUndefined)(this.baseHistoryInfo)){var e=this.baseHistoryInfo.modifiedProperties[0];this.currentImageElementBox.width===e.width&&this.currentImageElementBox.height===e.height?this.baseHistoryInfo.modifiedProperties.pop():(this.baseHistoryInfo.insertedText=h.c.Image,this.baseHistoryInfo.insertedData={width:l.a.convertPixelToPoint(this.currentImageElementBox.width),height:l.a.convertPixelToPoint(this.currentImageElementBox.height)},this.owner.editorHistory.recordChanges(this.baseHistoryInfo)),this.baseHistoryInfo=void 0}},e.prototype.updateImageResizerPosition=function(){if(!i.i(n.isNullOrUndefined)(this.currentImageElementBox)){var e,t=(this.currentImageElementBox,a.r,this.currentImageElementBox),r=t.line,o=void 0,s=void 0,l=void 0;this.currentImageElementBox instanceof a.r?(e=this.documentHelper.selection.getTop(r)+t.margin.top,o=this.documentHelper.selection.getLeftInternal(r,t,0),s=e*this.documentHelper.zoomFactor,l=o*this.documentHelper.zoomFactor):(l=t.x*this.documentHelper.zoomFactor,s=t.y*this.documentHelper.zoomFactor);var d=this.documentHelper.render.getScaledValue(t.height,2),h=this.documentHelper.render.getScaledValue(t.width,1);this.setImageResizerPosition(l,s,h,d,this)}},e.prototype.destroy=function(){i.i(n.isNullOrUndefined)(this.resizeContainerDiv)||(this.resizeContainerDiv.innerHTML=""),i.i(n.isNullOrUndefined)(this.topLeftRect)||(this.topLeftRect.innerHTML=""),i.i(n.isNullOrUndefined)(this.topMiddleRect)||(this.topMiddleRect.innerHTML=""),i.i(n.isNullOrUndefined)(this.topRightRect)||(this.topRightRect.innerHTML=""),i.i(n.isNullOrUndefined)(this.bottomLeftRect)||(this.bottomLeftRect.innerHTML=""),i.i(n.isNullOrUndefined)(this.bottomMiddleRect)||(this.bottomMiddleRect.innerHTML=""),i.i(n.isNullOrUndefined)(this.bottomRightRect)||(this.bottomRightRect.innerHTML=""),i.i(n.isNullOrUndefined)(this.leftMiddleRect)||(this.leftMiddleRect.innerHTML=""),i.i(n.isNullOrUndefined)(this.rightMiddleRect)||(this.rightMiddleRect.innerHTML=""),i.i(n.isNullOrUndefined)(this.imageResizerDiv)||(this.imageResizerDiv.innerHTML=""),i.i(n.isNullOrUndefined)(this.selectedImageWidget)||this.selectedImageWidget.destroy(),i.i(n.isNullOrUndefined)(this.imageResizerDivElement)||(this.imageResizerDivElement.innerHTML="",i.i(n.isNullOrUndefined)(this.imageResizerDivElement.parentElement)||this.imageResizerDivElement.parentElement.removeChild(this.imageResizerDivElement)),this.imageResizerDivElement=void 0,this.resizeContainerDiv=void 0,this.topLeftRect=void 0,this.topMiddleRect=void 0,this.topRightRect=void 0,this.bottomLeftRect=void 0,this.bottomMiddleRect=void 0,this.bottomRightRect=void 0,this.leftMiddleRect=void 0,this.rightMiddleRect=void 0,this.imageResizerDiv=void 0,this.selectedImageWidget=void 0,this.isImageResizing=!1,this.isImageResizerVisible=!1,this.currentImageElementBoxIn=void 0,this.imageResizerPoints=void 0,this.resizeMarkSizeIn=void 0,this.currentPage=void 0,this.documentHelper=void 0,this.owner=void 0},e}(),p=function(){function e(){this.resizeContainerDiv=new l.b(0,0),this.topLeftRectParent=new l.b(0,0),this.topMiddleRectParent=new l.b(0,0),this.topRightRectParent=new l.b(0,0),this.bottomLeftRectParent=new l.b(0,0),this.bottomMiddleRectParent=new l.b(0,0),this.bottomRightRectParent=new l.b(0,0),this.leftMiddleRectParent=new l.b(0,0),this.rightMiddleRectParent=new l.b(0,0)}return e}(),u=function(){function e(e,t){this.heightIn=0,this.widthIn=0,this.heightIn=e,this.widthIn=t}return Object.defineProperty(e.prototype,"height",{get:function(){return this.heightIn},set:function(e){this.heightIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.widthIn},set:function(e){this.widthIn=e},enumerable:!0,configurable:!0}),e}()},function(e,t,i){"use strict";var n=i(108);i.d(t,"c",function(){return n.a});var r=i(109);i.d(t,"d",function(){return r.a}),i.d(t,"e",function(){return r.b}),i.d(t,"f",function(){return r.c});var o=i(54);i.d(t,"g",function(){return o.a});var s=i(4);i.d(t,"a",function(){return s.a}),i.d(t,"b",function(){return s.b}),i.d(t,"h",function(){return s.c}),i.d(t,"i",function(){return s.d});var a=i(107);i.d(t,"j",function(){return a.a})},function(e,t,i){"use strict";i.d(t,"a",function(){return d});var n=i(0),r=(i.n(n),i(6)),o=i(12),s=i(13),a=i(27),l=i(37),d=function(){function e(e){this.uniqueCellFormat=void 0,this.borders=new a.a(this),this.shading=new l.a(this),this.ownerBase=e,this.borders=new a.a(this),this.shading=new l.a(this)}return Object.defineProperty(e.prototype,"leftMargin",{get:function(){return this.getPropertyValue("leftMargin")},set:function(e){this.setPropertyValue("leftMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightMargin",{get:function(){return this.getPropertyValue("rightMargin")},set:function(e){this.setPropertyValue("rightMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topMargin",{get:function(){return this.getPropertyValue("topMargin")},set:function(e){this.setPropertyValue("topMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomMargin",{get:function(){return this.getPropertyValue("bottomMargin")},set:function(e){this.setPropertyValue("bottomMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cellWidth",{get:function(){return this.getPropertyValue("cellWidth")},set:function(e){this.setPropertyValue("cellWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columnSpan",{get:function(){return this.getPropertyValue("columnSpan")},set:function(e){this.setPropertyValue("columnSpan",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rowSpan",{get:function(){return this.getPropertyValue("rowSpan")},set:function(e){this.setPropertyValue("rowSpan",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredWidth",{get:function(){return this.getPropertyValue("preferredWidth")},set:function(e){this.setPropertyValue("preferredWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"verticalAlignment",{get:function(){return this.getPropertyValue("verticalAlignment")},set:function(e){this.setPropertyValue("verticalAlignment",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredWidthType",{get:function(){return this.getPropertyValue("preferredWidthType")},set:function(e){this.setPropertyValue("preferredWidthType",e)},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(t){if(this.hasValue(t)){var r=o.a.getPropertyType(e.uniqueFormatType,t);if(!i.i(n.isNullOrUndefined)(this.uniqueCellFormat)&&this.uniqueCellFormat.propertiesHash.containsKey(r))return this.uniqueCellFormat.propertiesHash.get(r)}return e.getPropertyDefaultValue(t)},e.prototype.setPropertyValue=function(t,r){if((i.i(n.isNullOrUndefined)(r)||""===r)&&(r=e.getPropertyDefaultValue(t)),i.i(n.isNullOrUndefined)(this.uniqueCellFormat))this.initializeUniqueCellFormat(t,r);else{var s=o.a.getPropertyType(this.uniqueCellFormat.uniqueFormatType,t);if(this.uniqueCellFormat.propertiesHash.containsKey(s)&&this.uniqueCellFormat.propertiesHash.get(s)===r)return;this.uniqueCellFormat=e.uniqueCellFormats.updateUniqueFormat(this.uniqueCellFormat,t,r)}},e.prototype.initializeUniqueCellFormat=function(t,i){var n=new r.a;this.addUniqueCellFormat("leftMargin",t,i,n),this.addUniqueCellFormat("topMargin",t,i,n),this.addUniqueCellFormat("bottomMargin",t,i,n),this.addUniqueCellFormat("rightMargin",t,i,n),this.addUniqueCellFormat("cellWidth",t,i,n),this.addUniqueCellFormat("columnSpan",t,i,n),this.addUniqueCellFormat("rowSpan",t,i,n),this.addUniqueCellFormat("preferredWidth",t,i,n),this.addUniqueCellFormat("verticalAlignment",t,i,n),this.addUniqueCellFormat("preferredWidthType",t,i,n),this.uniqueCellFormat=e.uniqueCellFormats.addUniqueFormat(n,e.uniqueFormatType)},e.prototype.addUniqueCellFormat=function(t,i,n,r){var s=o.a.getPropertyType(e.uniqueFormatType,t);t===i&&r.add(s,n)},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"leftMargin":case"topMargin":case"bottomMargin":case"rightMargin":t=void 0;break;case"cellWidth":t=0;break;case"columnSpan":case"rowSpan":t=1;break;case"preferredWidth":t=0;break;case"verticalAlignment":t="Top";break;case"preferredWidthType":t="Point"}return t},e.prototype.containsMargins=function(){return!(i.i(n.isNullOrUndefined)(this.leftMargin)&&i.i(n.isNullOrUndefined)(this.rightMargin)&&i.i(n.isNullOrUndefined)(this.bottomMargin)&&i.i(n.isNullOrUndefined)(this.topMargin))},e.prototype.destroy=function(){i.i(n.isNullOrUndefined)(this.borders)||this.borders.destroy(),i.i(n.isNullOrUndefined)(this.shading)||this.shading.destroy(),i.i(n.isNullOrUndefined)(this.uniqueCellFormat)||e.uniqueCellFormats.remove(this.uniqueCellFormat),this.uniqueCellFormat=void 0,this.borders=void 0,this.shading=void 0},e.prototype.cloneFormat=function(){var t=new e(void 0);return t.verticalAlignment=this.verticalAlignment,t.leftMargin=this.leftMargin,t.rightMargin=this.rightMargin,t.topMargin=this.topMargin,t.bottomMargin=this.bottomMargin,t.preferredWidth=this.preferredWidth,t.preferredWidthType=this.preferredWidthType,t.cellWidth=this.cellWidth,t.borders=i.i(n.isNullOrUndefined)(this.borders)?void 0:this.borders.cloneFormat(),t.shading=i.i(n.isNullOrUndefined)(this.shading)?void 0:this.shading.cloneFormat(),t},e.prototype.hasValue=function(e){if(!i.i(n.isNullOrUndefined)(this.uniqueCellFormat)){var t=o.a.getPropertyType(this.uniqueCellFormat.uniqueFormatType,e);return this.uniqueCellFormat.propertiesHash.containsKey(t)}return!1},e.prototype.copyFormat=function(e){i.i(n.isNullOrUndefined)(e)||(i.i(n.isNullOrUndefined)(e.uniqueCellFormat)||(this.cellWidth=e.cellWidth,this.leftMargin=e.leftMargin,this.topMargin=e.topMargin,this.rightMargin=e.rightMargin,this.bottomMargin=e.bottomMargin,this.preferredWidth=e.preferredWidth,this.columnSpan=e.columnSpan,this.rowSpan=e.rowSpan,this.preferredWidthType=e.preferredWidthType,this.verticalAlignment=e.verticalAlignment),i.i(n.isNullOrUndefined)(e.shading)||(this.shading=new l.a(this),this.shading.copyFormat(e.shading)),i.i(n.isNullOrUndefined)(e.borders)||(this.borders=new a.a(this),this.borders.copyFormat(e.borders)))},e.clear=function(){this.uniqueCellFormats.clear()},e.uniqueCellFormats=new s.a,e.uniqueFormatType=4,e}()},function(e,t,i){"use strict";i.d(t,"a",function(){return d});var n=i(6),r=i(12),o=i(13),s=i(27),a=i(37),l=i(0),d=(i.n(l),function(){function e(e){this.uniqueTableFormat=void 0,this.borders=new s.a(this),this.shading=new a.a(this),this._title=void 0,this._description=void 0,this.ownerBase=void 0,this._styleName=void 0,this.ownerBase=e,this.assignTableMarginValue(5.4,0,5.4,0)}return Object.defineProperty(e.prototype,"title",{get:function(){return this._title},set:function(e){this._title=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"description",{get:function(){return this._description},set:function(e){this._description=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allowAutoFit",{get:function(){return this.getPropertyValue("allowAutoFit")},set:function(e){this.setPropertyValue("allowAutoFit",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cellSpacing",{get:function(){return this.getPropertyValue("cellSpacing")},set:function(e){if(e<0||e>264.6)throw new RangeError("The measurement must be between 0 px and 264.6 px.");this.setPropertyValue("cellSpacing",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftMargin",{get:function(){return this.getPropertyValue("leftMargin")},set:function(e){this.setPropertyValue("leftMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topMargin",{get:function(){return this.getPropertyValue("topMargin")},set:function(e){this.setPropertyValue("topMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightMargin",{get:function(){return this.getPropertyValue("rightMargin")},set:function(e){this.setPropertyValue("rightMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomMargin",{get:function(){return this.getPropertyValue("bottomMargin")},set:function(e){this.setPropertyValue("bottomMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tableAlignment",{get:function(){return this.getPropertyValue("tableAlignment")},set:function(e){this.setPropertyValue("tableAlignment",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftIndent",{get:function(){return this.getPropertyValue("leftIndent")},set:function(e){if(e<-1440||e>1440)throw new RangeError("The measurement must be between -1440 px and 1440 px.");this.setPropertyValue("leftIndent",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredWidth",{get:function(){return this.getPropertyValue("preferredWidth")},set:function(e){this.setPropertyValue("preferredWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredWidthType",{get:function(){return this.getPropertyValue("preferredWidthType")},set:function(e){this.setPropertyValue("preferredWidthType",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bidi",{get:function(){return this.getPropertyValue("bidi")},set:function(e){this.setPropertyValue("bidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"horizontalPositionAbs",{get:function(){return this.getPropertyValue("horizontalPositionAbs")},set:function(e){this.setPropertyValue("horizontalPositionAbs",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"horizontalPosition",{get:function(){return this.getPropertyValue("horizontalPosition")},set:function(e){this.setPropertyValue("horizontalPosition",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"styleName",{get:function(){return this._styleName},set:function(e){this._styleName=e},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(t){if(this.hasValue(t)){var n=r.a.getPropertyType(e.uniqueFormatType,t);if(!i.i(l.isNullOrUndefined)(this.uniqueTableFormat)&&this.uniqueTableFormat.propertiesHash.containsKey(n))return this.uniqueTableFormat.propertiesHash.get(n)}return e.getPropertyDefaultValue(t)},e.prototype.setPropertyValue=function(t,n){if((i.i(l.isNullOrUndefined)(n)||""===n)&&(n=e.getPropertyDefaultValue(t)),i.i(l.isNullOrUndefined)(this.uniqueTableFormat))this.initializeUniqueTableFormat(t,n);else{var o=r.a.getPropertyType(this.uniqueTableFormat.uniqueFormatType,t);if(this.uniqueTableFormat.propertiesHash.containsKey(o)&&this.uniqueTableFormat.propertiesHash.get(o)===n)return;this.uniqueTableFormat=e.uniqueTableFormats.updateUniqueFormat(this.uniqueTableFormat,t,n)}},e.prototype.initializeUniqueTableFormat=function(t,i){var r=new n.a;this.addUniqueTableFormat("allowAutoFit",t,i,r),this.addUniqueTableFormat("cellSpacing",t,i,r),this.addUniqueTableFormat("leftMargin",t,i,r),this.addUniqueTableFormat("topMargin",t,i,r),this.addUniqueTableFormat("bottomMargin",t,i,r),this.addUniqueTableFormat("rightMargin",t,i,r),this.addUniqueTableFormat("leftIndent",t,i,r),this.addUniqueTableFormat("tableAlignment",t,i,r),this.addUniqueTableFormat("preferredWidth",t,i,r),this.addUniqueTableFormat("preferredWidthType",t,i,r),this.addUniqueTableFormat("bidi",t,i,r),this.addUniqueTableFormat("horizontalPositionAbs",t,i,r),this.addUniqueTableFormat("horizontalPosition",t,i,r),this.uniqueTableFormat=e.uniqueTableFormats.addUniqueFormat(r,e.uniqueFormatType)},e.prototype.addUniqueTableFormat=function(t,i,n,o){var s;s=r.a.getPropertyType(e.uniqueFormatType,t),t===i&&o.add(s,n)},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"allowAutoFit":t=!1;break;case"cellSpacing":t=0;break;case"leftMargin":t=5.4;break;case"topMargin":case"bottomMargin":t=0;break;case"rightMargin":t=5.4;break;case"leftIndent":t=0;break;case"tableAlignment":t="Left";break;case"preferredWidth":t=0;break;case"preferredWidthType":t="Point";break;case"bidi":t=!1;break;case"horizontalPositionAbs":t=null;break;case"horizontalPosition":t=0}return t},e.prototype.assignTableMarginValue=function(e,t,i,n){this.leftMargin=e,this.topMargin=t,this.rightMargin=i,this.bottomMargin=n},e.prototype.initializeTableBorders=function(){this.borders.left.lineStyle="Single",this.borders.left.lineWidth=.5,this.borders.right.lineStyle="Single",this.borders.right.lineWidth=.5,this.borders.top.lineStyle="Single",this.borders.top.lineWidth=.5,this.borders.bottom.lineStyle="Single",this.borders.bottom.lineWidth=.5,this.borders.horizontal.lineStyle="Single",this.borders.horizontal.lineWidth=.5,this.borders.vertical.lineStyle="Single",this.borders.vertical.lineWidth=.5},e.prototype.destroy=function(){i.i(l.isNullOrUndefined)(this.borders)||this.borders.destroy(),i.i(l.isNullOrUndefined)(this.shading)||this.shading.destroy(),i.i(l.isNullOrUndefined)(this.uniqueTableFormat)||e.uniqueTableFormats.remove(this.uniqueTableFormat),this.uniqueTableFormat=void 0,this.ownerBase=void 0,this.borders=void 0,this.shading=void 0},e.prototype.cloneFormat=function(){var t=new e(void 0);return t.leftIndent=this.leftIndent,t.tableAlignment=this.tableAlignment,t.cellSpacing=this.cellSpacing,t.leftMargin=this.leftMargin,t.rightMargin=this.rightMargin,t.topMargin=this.topMargin,t.bottomMargin=this.bottomMargin,t.preferredWidth=this.preferredWidth,t.preferredWidthType=this.preferredWidthType,t.horizontalPositionAbs=this.horizontalPositionAbs,t.horizontalPosition=this.horizontalPosition,t.borders=i.i(l.isNullOrUndefined)(this.borders)?void 0:this.borders.cloneFormat(),t.shading=i.i(l.isNullOrUndefined)(this.shading)?void 0:this.shading.cloneFormat(),t.bidi=this.bidi,t.allowAutoFit=this.allowAutoFit,t.styleName=this.styleName,t.title=this.title,t.description=this.description,t},e.prototype.hasValue=function(e){if(!i.i(l.isNullOrUndefined)(this.uniqueTableFormat)){var t=r.a.getPropertyType(this.uniqueTableFormat.uniqueFormatType,e);return this.uniqueTableFormat.propertiesHash.containsKey(t)}return!1},e.prototype.copyFormat=function(e){i.i(l.isNullOrUndefined)(e)||(i.i(l.isNullOrUndefined)(e.uniqueTableFormat)||(this.cellSpacing=e.cellSpacing,this.leftMargin=e.leftMargin,this.topMargin=e.topMargin,this.rightMargin=e.rightMargin,this.bottomMargin=e.bottomMargin,this.leftIndent=e.leftIndent,this.tableAlignment=e.tableAlignment,this.preferredWidth=e.preferredWidth,this.preferredWidthType=e.preferredWidthType,this.bidi=e.bidi,this.allowAutoFit=e.allowAutoFit,this.horizontalPosition=e.horizontalPosition,this.horizontalPositionAbs=e.horizontalPositionAbs,this.styleName=e.styleName),i.i(l.isNullOrUndefined)(e.borders)||(this.borders=new s.a(this),this.borders.copyFormat(e.borders)),i.i(l.isNullOrUndefined)(e.shading)||(this.shading=new a.a(this),this.shading.copyFormat(e.shading)),i.i(l.isNullOrUndefined)(e.title)||(this.title=e.title),i.i(l.isNullOrUndefined)(e.description)||(this.description=e.description))},e.clear=function(){this.uniqueTableFormats.clear()},e.uniqueTableFormats=new o.a,e.uniqueFormatType=8,e}())},function(e,t,i){"use strict";var n=i(24);i.d(t,"a",function(){return n.a});var r=i(14);i.d(t,"b",function(){return r.a});var o=i(23);i.d(t,"c",function(){return o.a});var s=i(26);i.d(t,"d",function(){return s.a})},function(e,t,i){"use strict";i.d(t,"a",function(){return r});var n=i(0),r=(i.n(n),function(){function e(){var e=this;this.windowPrint=void 0,this.closePrintWindow=function(){e.windowPrint&&!e.windowPrint.closed&&e.windowPrint.close()}}return e.prototype.getModuleName=function(){return"Print"},e.prototype.print=function(e,t){this.printWindow(e,void 0!==navigator?navigator.userAgent:"",t)},e.prototype.printWindow=function(e,t,r){var o=this.getPageHeight(e.pages),s=this.getPageWidth(e.pages),a=document.createElement("div");a.style.width="100%",a.style.height="100%",a.style.overflow="scroll",this.generatePrintContent(e,a),i.i(n.isNullOrUndefined)(r)&&(r=window.open("","print","height=452,width=1024,tabbar=no")),this.windowPrint=r;var l=s.toString()+"px "+o.toString()+"px";s>o&&(l="landscape"),-1!==t.indexOf("Chrome")?(r.document.write("<!DOCTYPE html>"),r.document.write("<html><head><title>"+e.owner.documentName+"</title><style>img { height: 100%; width: 100%; display: block;}img { box-sizing: border-box; }br, button { display: none; }@page{ margin: 0cm; size:"+l+"; }</style></head> <body><center>")):-1!==t.indexOf("Firefox")?(r.document.write("<!DOCTYPE html>"),r.document.write("<html moznomarginboxes mozdisallowselectionprint><head><title>"+e.owner.documentName+"</title><style>html, body { height: 100%; } img { height: 100%; width: 100%; display: block;}img { box-sizing: border-box; }br, button { display: none; }@page{ margin: 0cm; size:"+l+"; }@media print{ body { margin: 0cm; size:"+l+"; }}</style></head> <body><center>")):r.document.write("<html><head><title>"+e.owner.documentName+"</title><style>@page{margin:0;size:"+l+";}</style></head><body><center>"),r.document.write(a.innerHTML+"</center><script> (function() { window.ready = true; })(); <\/script></body></html>"),a=void 0,r.document.close(),r.focus(),window.addEventListener("beforeunload",this.closePrintWindow);var d=setInterval(function(){r.ready&&(r.print(),r.close(),clearInterval(d))},500)},e.prototype.exportAsImage=function(e,t,r){var o;if(!i.i(n.isNullOrUndefined)(t)&&t<=e.pages.length&&t>=1){var s=e.pages[t-1],a=s.boundingRectangle.height,l=s.boundingRectangle.width;e.render.isPrinting=!0,e.render.renderWidgets(s,0,0,0,0);var d=e.render.pageCanvas.toDataURL(r,1);e.render.isPrinting=!1,o=new Image,o.src=d,o.setAttribute("style","margin:0px;display:block;width:"+l.toString()+"px;height:"+a.toString()+"px;")}return o},e.prototype.generatePrintContent=function(e,t){for(var i="",n=0;n<e.pages.length;n++){var r=e.pages[n],o=r.boundingRectangle.height,s=r.boundingRectangle.width;e.render.isPrinting=!0,e.render.renderWidgets(r,0,0,s,0);var a=e.render.pageCanvas.toDataURL();e.render.isPrinting=!1;var l=n==e.pages.length-1?"":"<br/>";i+="<div><img src="+a+' style="margin:0px;display:block;width: '+s.toString()+"px; height:"+o.toString()+'px; "/></div>'+l}t.innerHTML=i},e.prototype.getPageWidth=function(e){for(var t=0,i=0;i<e.length;i++)t<e[i].boundingRectangle.width&&(t=e[i].boundingRectangle.width);return t},e.prototype.getPageHeight=function(e){for(var t=0,i=0;i<e.length;i++)t<e[i].boundingRectangle.height&&(t=e[i].boundingRectangle.height);return t},e.prototype.destroy=function(){window.removeEventListener("beforeunload",this.closePrintWindow),this.windowPrint=void 0},e}())},function(e,t,i){"use strict";var n=i(57);i.d(t,"a",function(){return n.a});var r=i(58);i.d(t,"b",function(){return r.a}),i.d(t,"c",function(){return r.b});var o=i(59);i.d(t,"d",function(){return o.a})},function(e,t,i){"use strict";var n=i(117);i.d(t,"a",function(){return n.a})},function(e,t,i){"use strict";i.d(t,"a",function(){return o});var n=i(4),r=i(131),o=function(){function e(e,t){this.interval=4,this.segmentWidth=47.9988,this.orientation="Horizontal",this.tickAlignment="RightOrBottom",this.markerColor="red",this.thickness=15,this.arrangeTick=null,this.length=400,this.offset=0,this.scale=1,this.rulerStartValue=1584,this.zeroPosition=n.a.convertPointToPixel(1584),this.addSegmentWidth=!1,this.element=e,this.rulerHelper=t}return e.prototype.appendTo=function(){this.preRender(),this.render()},e.prototype.preRender=function(){this.unWireEvents(),this.wireEvents()},e.prototype.render=function(){this.updateRulerGeometry()},e.prototype.getModuleName=function(){return"Ruler"},e.prototype.destroy=function(){this.unWireEvents(),this.element.classList.remove("e-ruler")},e.prototype.showHideRuler=function(e){this.element.style.display=e?"block":"none"},e.prototype.updateRulerGeometry=function(){this.element.style.textAlign="left",this.renderRulerSpace(),this.updateRuler()},e.prototype.renderRulerSpace=function(){var e=this.getRulerGeometry(),t=document.getElementById(this.element.id+"_ruler_space");return t||(t=this.rulerHelper.createHtmlElement("div",{id:this.element.id+"_ruler_space",style:"height:"+e.height+"px;width:"+e.width+"px;cssFloat:left;"}),this.element.appendChild(t)),t},e.prototype.updateRuler=function(){var e=this.getRulerSize(),t=this.getRulerGeometry(),i=0,n=0,o=new r.a,s=this.getRulerSVG(t);if(s&&(i=this.length,o.height=e,n=this.offset,i&&i!==1/0)){var a=i,l=n;this.updateSegments(l,a+Math.abs(l),s,e)}},e.prototype.updateSegments=function(e,t,i,r){var o=e,s={trans:0};for(this.rulerStartValue=n.a.convertPixelToPoint(this.zeroPosition);o<t;){var a=this.getNewSegment(o,i);a&&(i.appendChild(a.segment),o=this.updateSegment(e,t,a,o,s,r))}this.addSegmentWidth=!1},e.prototype.updateSegment=function(e,t,i,r,o,s){var a=this.updateSegmentWidth(this.scale);if(r===e)this.startValue=Math.floor(e/a)*a/this.scale,this.startValue=this.startValue%1!=0?Number(this.startValue.toFixed(1)):this.startValue,i.label.textContent=this.rulerStartValue.toString(),this.defStartValue=r=this.startValue*this.scale,"Horizontal"===this.orientation?this.hRulerOffset=e-r:this.vRulerOffset=e-r;else{this.startValue=n.a.convertPixelToPoint(r),this.startValue=this.startValue%1!=0?Number(this.startValue.toFixed(1)):this.startValue;var l=void 0;0==this.rulerStartValue&&(this.addSegmentWidth=!0),l=this.addSegmentWidth?Math.abs(this.rulerStartValue+36):Math.abs(this.rulerStartValue-36),i.label.textContent=l.toString(),this.rulerStartValue=l}this.updateTickLabel(i,s);var d="Horizontal"===this.orientation?o.trans+.5+",0.5":"0.5,"+(o.trans+.5);return i.segment.setAttribute("transform","translate("+d+") scale(1,1)"),o.trans+=a*this.scale,r+=a},e.prototype.updateTickLabel=function(e,t){var i=e.segment.lastChild.getBBox(),n="Horizontal"===this.orientation,r="RightOrBottom"===this.tickAlignment,o=n?-4:0,s=n?r?t/2+5.5-5.5:t/2+5.5:i.height;n&&(s+=2),n||(o+=10,s+=2);var a=r?-(i.width+2)+","+(t/2-i.height):-(i.width+2)+","+(t/2-i.height/2),l=n?{x:o,y:s}:{x:o,y:s,transform:"rotate(270)translate("+a+")"};this.rulerHelper.setAttributeSvg(e.segment.lastChild,l)},e.prototype.getNewSegment=function(e,t){var i=this.createNewTicks(e,t);return{segment:i,label:this.createTickLabel(t,i)}},e.prototype.createNewTicks=function(e,t){var i,n,r=this.updateSegmentWidth(this.scale),o={class:"e-de-ruler-segment"},s=this.rulerHelper.createSvgElement("g",o),a={class:"e-de-ruler-segment1"},l=this.rulerHelper.createSvgElement("rect",a),d="Horizontal"===this.orientation?r*this.scale:15,h="Horizontal"===this.orientation?15:r;l.setAttribute("x","0"),l.setAttribute("y","0"),l.setAttribute("width",d.toString()),l.setAttribute("height",h.toString()),l.setAttribute("fill","lightgrey");for(var c=0;c<this.interval;c++)n=r/this.interval,(i=this.createTick(t,n,c+1,e))&&s.appendChild(i);return s},e.prototype.getLinePoint=function(e,t,i){var n=this.updateSegmentWidth(this.scale),r=this.getRulerSize();return t*=i-1,i=t%n==0?r:.3*r},e.prototype.createTick=function(e,t,i,n){var r,o=this.getLinePoint(e,t,i),s=this.getRulerSize(),a="Horizontal"===this.orientation,l="RightOrBottom"===this.tickAlignment,d=t*(i-1)*this.scale,h=a?d:l?s:0,c=a?d:l?s-o:s-(s-o),p=a?l?s:s-(s-o):d,u=a?l?s-o:0:d;if(0!==u){p-=6,u-=6,a||(h-=6,c-=6);var g={x1:h,y1:p,x2:c,y2:u,"stroke-width":"0.25",stroke:"black"};r=this.rulerHelper.createSvgElement("line",g),r.setAttribute("class","e-de-ruler-tick")}return r},e.prototype.createTickLabel=function(e,t){var i;if(t){var n={class:"e-de-ruler-tick-label",style:"font-weight: 400"};i=this.rulerHelper.createSvgElement("text",n),t.appendChild(i)}return i},e.prototype.updateSegmentWidth=function(e){if(100!==this.segmentWidth)return this.segmentWidth;var t,i=1,n=Math.pow(2,Math.round(Math.log(e)/Math.log(2)));for(t=100,t=100/n;t>100;)i/=10,t/=10;for(;t<25;)i*=10,t*=10;return t>=25&&t%25!=0&&(t=25*Math.round(t/25)),t*e/i},e.prototype.createMarkerLine=function(e,t,i){var n;return t&&(n=e.getElementById(t.id+"_marker"),n&&n.parentNode.removeChild(n),n=this.rulerHelper.createSvgElement("line",i)),n},e.prototype.drawRulerMarker=function(e,t,i){var n,r,o,s,a,l,d,h="Horizontal"===this.orientation,c=e.getElementsByTagName("svg");for(a=0;a<c.length;a++){c[parseInt(a.toString(),10)]&&(n=c[parseInt(a.toString(),10)]);break}if(n){r=this.getRulerSize(),l={id:e.id+"_marker",x1:0,y1:0,x2:h?0:r,y2:h?r:0,stroke:this.markerColor,"stroke-width":1.5,class:"e-d-ruler-marker"},d=this.createMarkerLine(n,e,l),o=this.scale,s=this.offset-this.defStartValue;var p=h?t.x:t.y,u=p*o+i+s;d.setAttribute("transform","translate("+(h?u+.5+" 0.5":"0.5 "+(u+.5))+")"),n.appendChild(d)}},e.prototype.getRulerGeometry=function(){return"Horizontal"===this.orientation?new r.a(this.length,this.element?this.element.getBoundingClientRect().height:0):new r.a(this.element?this.element.getBoundingClientRect().width:0,this.length)},e.prototype.getRulerSize=function(){return this.thickness},e.prototype.getRulerSVG=function(e){var t,i,n=this.getRulerSize();if(this.element&&(t=document.getElementById(this.element.id+"_ruler_space"))){var r={id:this.element.id+"_Ruler_svg",width:"Horizontal"===this.orientation?this.length:n+"px",height:"Horizontal"===this.orientation?n:e.height+"px",style:"position:inherit;"};if(i=this.rulerHelper.createSvgElement("svg",r),t.childNodes.length>0)for(var o=t.childNodes.length-1;o>=0;o--)t.childNodes[parseInt(o.toString(),10)].parentNode.removeChild(t.childNodes[parseInt(o.toString(),10)]);t.appendChild(i)}return i},e.prototype.wireEvents=function(){},e.prototype.unWireEvents=function(){},e}()},function(e,t,i){"use strict";var n=i(121);i.d(t,"b",function(){return n.a});var r=i(119);i.d(t,"c",function(){return r.a});var o=i(38);i.d(t,"d",function(){return o.a}),i.d(t,"e",function(){return o.b});var s=i(60);i.d(t,"f",function(){return s.a});var a=i(61);i.d(t,"a",function(){return a.a})},function(e,t,i){"use strict";i.d(t,"a",function(){return a});var n=i(0),r=(i.n(n),i(4)),o=i(3),s=(i.n(o),i(15)),a=(i.n(s),function(){function e(e){var t=this;this.isOptionsPaneShow=!1,this.findOption="None",this.matchCase=void 0,this.wholeWord=void 0,this.searchText="Navigation",this.resultsText="Results",this.messageDivText="No matches",this.replaceButtonText="Replace",this.replaceAllButtonText="Replace All",this.focusedIndex=-1,this.focusedElement=[],this.isOptionsPane=!0,this.replacePaneText="Replace",this.findPaneText="Find",this.matchDivReplaceText="No matches",this.tabInstance=void 0,this.isReplace=!1,this.searchOptionChange=function(){t.clearSearchResultItems(),t.documentHelper.owner.searchModule.clearSearchHighlight();var e=t.searchInput.value;if(""!==e){var i=t.documentHelper.owner.searchModule.textSearch.stringToRegex(e,t.findOption),n=t.documentHelper.selection.end,r=n.getHierarchicalIndexInternal();t.results=t.documentHelper.owner.searchModule.textSearch.findAll(i,t.findOption,r),null!=t.results&&t.results.length>0?t.navigateSearchResult(!1):(t.viewer.renderVisiblePages(),t.messageDiv.innerHTML=t.localeValue.getConstant("No matches"),t.resultContainer.style.display="block",t.resultsListBlock.style.display="none",t.clearFocusElement(),t.resultsListBlock.innerHTML="")}},this.onEnableDisableReplaceButton=function(){0!==t.searchInput.value.length?(t.replaceButton.disabled=!1,t.replaceAllButton.disabled=!1):(t.replaceButton.disabled=!0,t.replaceAllButton.disabled=!0)},this.onKeyDownOnOptionPane=function(e){if(9===e.keyCode){e.preventDefault();var r=void 0;r=e.shiftKey?0===t.focusedIndex||i.i(n.isNullOrUndefined)(t.focusedIndex)?t.focusedElement.length-1:t.focusedIndex-1:t.focusedElement.length-1===t.focusedIndex||i.i(n.isNullOrUndefined)(t.focusedIndex)?0:t.focusedIndex+1;var o=t.focusedElement[r];o.focus(),o instanceof HTMLInputElement&&o.select(),t.focusedIndex=r,o instanceof HTMLLIElement&&t.scrollToPosition(o)}else if(13===e.keyCode){if(t.hideMatchDiv(),e.target!==t.searchInput&&e.target!==t.closeButton){e.preventDefault();var s=t.focusedElement.indexOf(e.target);if(-1!==s){var a=t.focusedElement[s];a.click(),a.focus(),t.focusedIndex=s}}}else if((40===e.keyCode||38===e.keyCode)&&"none"!==t.resultsListBlock.style.display){var s=void 0,o=void 0;40===e.keyCode?t.focusedIndex>7?t.focusedIndex+1<t.focusedElement.length&&(o=t.focusedElement[t.focusedIndex+1],o.focus(),t.focusedIndex=t.focusedIndex+1):(s=t.focusedElement.length-t.resultsListBlock.children.length+t.results.currentIndex+1)<t.focusedElement.length&&(o=t.focusedElement[s],o.focus(),t.focusedIndex=s):t.focusedIndex>6&&(s=t.focusedIndex-1,o=t.focusedElement[s],o.focus(),t.focusedIndex=s)}},this.onReplaceButtonClick=function(){var e=(t.optionsPane,t.searchInput.value),r=t.replaceWith.value,o=t.documentHelper.owner.searchModule.textSearchResults;if(""!==e&&!i.i(n.isNullOrUndefined)(e)&&null!=t.documentHelper.owner.selection){var s=t.documentHelper.owner.selection.text;if(t.documentHelper.owner.selection.isEmpty||(t.documentHelper.owner.selection.isForward?t.documentHelper.owner.selection.selectContent(t.documentHelper.owner.selection.start,!0):t.documentHelper.owner.selection.selectContent(t.documentHelper.owner.selection.end,!0)),i.i(n.isNullOrUndefined)(o)||i.i(n.isNullOrUndefined)(o.currentSearchResult))t.documentHelper.owner.search.findAll(e,t.findOption),t.messageDiv.style.display="block",t.messageDiv.innerHTML=t.localeValue.getConstant(t.matchDivReplaceText);else{var a=o.currentSearchResult;if(t.documentHelper.owner.searchModule.navigate(a),a.text===s){var l=i.i(n.isNullOrUndefined)(r)?"":r;t.documentHelper.owner.searchModule.replace(l,a,o);var d=t.documentHelper.owner.searchModule.textSearch.stringToRegex(e,t.findOption),h=t.documentHelper.selection.end,c=h.getHierarchicalIndexInternal();t.results=t.documentHelper.owner.searchModule.textSearch.findAll(d,t.findOption,c),i.i(n.isNullOrUndefined)(t.results)||i.i(n.isNullOrUndefined)(t.results.currentSearchResult)?(t.messageDiv.style.display="block",t.messageDiv.innerHTML=t.localeValue.getConstant(t.matchDivReplaceText)):t.documentHelper.owner.searchModule.navigate(t.results.currentSearchResult),t.documentHelper.owner.findResultsList=[],!i.i(n.isNullOrUndefined)(t.results)&&t.results.innerList.length>0?t.navigateSearchResult(!0):t.resultsListBlock.innerHTML=""}else t.documentHelper.owner.search.findAll(e,t.findOption)}}},this.onReplaceAllButtonClick=function(){t.replaceAll(),t.resultsListBlock.style.display="none",t.messageDiv.innerHTML="",t.documentHelper.updateFocus()},this.searchIconClickInternal=function(){var e=document.getElementById(t.documentHelper.owner.containerId+"_option_search_text_box"),i=e.value;if(""!==i){if(t.hideMatchDiv(),t.searchIcon.classList.contains("e-de-op-search-close-icon"))return t.searchIcon.classList.add("e-de-op-search-icon"),t.searchIcon.classList.remove("e-de-op-search-close-icon"),e.value="",t.messageDiv.innerHTML=t.localeValue.getConstant("No matches"),t.resultContainer.style.display="block",t.resultsListBlock.style.display="none",t.matchDiv.style.display="none",t.occurrenceDiv.style.display="none",t.onEnableDisableReplaceButton(),t.clearFocusElement(),t.resultsListBlock.innerHTML="",t.clearSearchResultItems(),t.documentHelper.owner.searchModule.clearSearchHighlight(),void t.viewer.renderVisiblePages();t.searchIcon.classList.contains("e-de-op-search-icon")&&i.length>=1&&(t.searchIcon.classList.add("e-de-op-search-close-icon"),t.searchIcon.classList.remove("e-de-op-search-icon"),t.onEnableDisableReplaceButton()),t.clearSearchResultItems(),t.documentHelper.owner.searchModule.clearSearchHighlight();var n=t.documentHelper.owner.searchModule.textSearch.stringToRegex(i,t.findOption),r=t.documentHelper.selection.end,o=r.getHierarchicalIndexInternal();if(t.results=t.documentHelper.owner.searchModule.textSearch.findAll(n,t.findOption,o),null!=t.results&&t.results.length>0){var s=t.results.innerList[t.results.currentIndex].start,a=t.results.innerList[t.results.currentIndex].end;t.documentHelper.scrollToPosition(s,a,!0),t.navigateSearchResult(!1),t.getMessageDivHeight();var l=(t.isOptionsPane,t.optionsPane.offsetHeight-t.findTab.offsetHeight);t.resultsListBlock.style.height=l+"px"}else t.messageDiv.innerHTML=t.localeValue.getConstant("No matches"),t.resultContainer.style.display="block",t.resultsListBlock.style.display="none",t.clearFocusElement(),t.resultsListBlock.innerHTML=""}},this.navigateNextResultButtonClick=function(){if(null!=document.getElementById(t.documentHelper.owner.containerId+"_list_box_container")&&"none"!==document.getElementById(t.documentHelper.owner.containerId+"_list_box_container").style.display){var e=t.documentHelper.owner.selection.end,r=void 0,o=0;e.isExistAfter(t.results.currentSearchResult.start)&&(o=t.results.currentIndex);for(var s=o;s<t.results.length;s++){var a=t.results.innerList[s];if(e.isExistBefore(a.start)||e.isAtSamePosition(a.start)){r=a,t.results.currentIndex=s;break}}i.i(n.isNullOrUndefined)(r)&&(t.results.currentIndex=0,r=t.results.innerList[0]),t.messageDiv.innerHTML=t.localeValue.getConstant("Result")+" "+(t.results.currentIndex+1)+" "+t.localeValue.getConstant("of")+" "+t.resultsListBlock.children.length,t.updateListItems(r),t.focusedIndex=t.focusedElement.indexOf(t.navigateToNextResult)}},this.navigatePreviousResultButtonClick=function(){if(null!=document.getElementById(t.documentHelper.owner.containerId+"_list_box_container")&&"none"!==document.getElementById(t.documentHelper.owner.containerId+"_list_box_container").style.display){var e=void 0,r=t.documentHelper.owner.selection.start,o=t.results.currentIndex;r.isExistAfter(t.results.currentSearchResult.start)&&(o=t.results.length-1);for(var s=o;s>=0;s--){var a=t.results.innerList[s];if(r.isExistAfter(a.start)||t.documentHelper.owner.selection.end.isAtSamePosition(a.start)){e=a,t.results.currentIndex=s;break}}i.i(n.isNullOrUndefined)(e)&&(t.results.currentIndex=t.results.length-1,e=t.results.innerList[t.results.currentIndex]),t.messageDiv.innerHTML=t.localeValue.getConstant("Result")+" "+(t.results.currentIndex+1)+" "+t.localeValue.getConstant("of")+" "+t.resultsListBlock.children.length,t.updateListItems(e),t.focusedIndex=t.focusedElement.indexOf(t.navigateToPreviousResult)}},this.onKeyDown=function(e){var i=e.which||e.keyCode;13===i&&9!==e.keyCode&&40!==e.keyCode?(e.preventDefault(),t.findDiv.style.height="",t.onKeyDownInternal()):8===i&&0===t.searchInput.value.length?t.resultContainer.style.display="block":9!==e.keyCode&&40!==e.keyCode&&27!==e.keyCode?(t.documentHelper.owner.searchModule.clearSearchHighlight(),t.clearSearchResultItems(),t.viewer.renderVisiblePages(),t.resultsListBlock.style.display="none",t.messageDiv.innerHTML=t.localeValue.getConstant("No matches"),t.resultContainer.style.display="none",t.clearFocusElement(),t.resultsListBlock.innerHTML="",t.searchIcon.classList.contains("e-de-op-search-close-icon")&&(t.searchIcon.classList.add("e-de-op-search-icon"),t.searchIcon.classList.remove("e-de-op-search-close-icon"))):27===i&&27===e.keyCode&&(t.showHideOptionsPane(!1),t.documentHelper.updateFocus())},this.close=function(){t.clearFocusElement(),t.showHideOptionsPane(!1),t.resultsListBlock.innerHTML="",t.focusedIndex=1,t.isOptionsPane=!0,t.documentHelper.updateFocus()},this.resultListBlockClick=function(e){for(var i=e.target,n=t.resultsListBlock.children,r=0,o=0;o<n.length;o++){var s=n[o];s.classList.contains("e-de-search-result-hglt")&&(s.classList.remove("e-de-search-result-hglt"),s.children[0].classList.remove("e-de-op-search-word-text"),s.classList.add("e-de-search-result-item"))}for(var a,o=0;o<n.length;o++)i===n[o]&&(r=o,a=n[o],a.classList.contains("e-de-search-result-item")&&(a.classList.remove("e-de-search-result-item"),a.classList.add("e-de-search-result-hglt"),a.children[0].classList.add("e-de-op-search-word-text"),t.focusedIndex=t.focusedElement.indexOf(a)));var l=t.results.innerList[r];t.results.currentIndex=r,t.messageDiv.innerHTML=t.localeValue.getConstant("Result")+" "+(r+1)+" "+t.localeValue.getConstant("of")+" "+t.resultsListBlock.children.length,t.documentHelper.owner.searchModule.navigate(l),t.documentHelper.owner.searchModule.highlight(t.results),a&&a.focus()},this.documentHelper=e}return Object.defineProperty(e.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"OptionsPane"},e.prototype.initOptionsPane=function(e,t){this.viewer;this.localeValue=e,this.optionsPane=i.i(n.createElement)("div",{className:"e-de-op",styles:"display:none;"}),this.optionsPane.addEventListener("keydown",this.onKeyDownOnOptionPane),this.findTab=i.i(n.createElement)("div",{id:this.documentHelper.owner.containerId+"_findTabDiv",className:"e-de-op-tab"}),this.optionsPane.appendChild(this.findTab),this.searchDiv=i.i(n.createElement)("div",{className:"e-de-op-header",innerHTML:e.getConstant(this.searchText)}),this.findTab.appendChild(this.searchDiv),this.closeButton=i.i(n.createElement)("button",{className:"e-de-op-close-button e-de-close-icon e-de-op-icon-btn e-btn e-flat e-icon-btn",id:"close",attrs:{type:"button"}}),this.closeButton.setAttribute("aria-label",e.getConstant("Close")),this.findTab.appendChild(this.closeButton);var r=i.i(n.createElement)("span",{className:"e-de-op-close-icon e-de-close-icon e-btn-icon e-icons"});this.closeButton.appendChild(r),this.focusedElement.push(this.closeButton);var a=i.i(n.createElement)("div");this.findTab.appendChild(a),this.findTabButton=i.i(n.createElement)("div",{innerHTML:e.getConstant(this.findPaneText)}),this.replaceTabButton=i.i(n.createElement)("div",{innerHTML:e.getConstant(this.replacePaneText)});var l=[{header:{text:this.findTabButton}},{header:{text:this.replaceTabButton}}];this.tabInstance=new s.Tab({items:l,enableRtl:t,selected:this.selectedTabItem.bind(this)}),this.tabInstance.isStringTemplate=!0,this.tabInstance.appendTo(a),this.findTabContentDiv=i.i(n.createElement)("div",{className:"e-de-search-tab-content"}),this.findTab.appendChild(this.findTabContentDiv),this.searchTextBoxContainer=i.i(n.createElement)("div",{className:"e-input-group e-de-op-input-group"}),this.findTabContentDiv.appendChild(this.searchTextBoxContainer),this.searchInput=i.i(n.createElement)("input",{className:"e-input e-de-search-input",id:this.documentHelper.owner.containerId+"_option_search_text_box",attrs:{placeholder:e.getConstant("Search for")}}),this.searchTextBoxContainer.appendChild(this.searchInput),this.searchIcon=i.i(n.createElement)("span",{className:"e-de-op-icon e-de-op-search-icon e-input-group-icon e-icon",id:this.documentHelper.owner.containerId+"_search-icon"}),this.searchIcon.tabIndex=0,this.searchTextBoxContainer.appendChild(this.searchIcon),this.focusedElement.push(this.searchIcon),this.navigateToPreviousResult=i.i(n.createElement)("span",{className:"e-de-op-icon e-de-op-nav-btn e-arrow-up e-spin-up e-btn-icon e-icon e-input-group-icon"}),this.navigateToPreviousResult.tabIndex=0,this.searchTextBoxContainer.appendChild(this.navigateToPreviousResult),this.focusedElement.push(this.navigateToPreviousResult),this.navigateToNextResult=i.i(n.createElement)("span",{className:"e-de-op-icon e-de-op-nav-btn e-arrow-down e-spin-down e-btn-icon e-icon e-input-group-icon"}),this.navigateToNextResult.tabIndex=0,this.searchTextBoxContainer.appendChild(this.navigateToNextResult),this.focusedElement.push(this.navigateToNextResult);var d=i.i(n.createElement)("div",{className:"e-de-op-more-less"});this.matchInput=i.i(n.createElement)("input",{attrs:{type:"checkbox"},id:this.documentHelper.owner.containerId+"_matchCase"}),d.appendChild(this.matchInput),this.matchCase=new o.CheckBox({label:e.getConstant("Match case"),enableRtl:t,checked:!1,change:this.matchChange.bind(this)}),this.matchCase.appendTo(this.matchInput),this.focusedElement.push(this.matchInput),this.matchInput.tabIndex=0;var h;h=t?"_e-de-rtl":"_e-de-ltr",this.wholeInput=i.i(n.createElement)("input",{attrs:{type:"checkbox"},id:this.documentHelper.owner.containerId+"_wholeWord"+h}),d.appendChild(this.wholeInput),this.wholeWord=new o.CheckBox({label:e.getConstant("Whole words"),enableRtl:t,checked:!1,change:this.wholeWordsChange.bind(this)}),this.wholeWord.appendTo(this.wholeInput),this.focusedElement.push(this.wholeInput),this.wholeInput.tabIndex=0,this.findTab.appendChild(d),this.replaceTabContentDiv=i.i(n.createElement)("div",{className:"e-de-op-replacetabcontentdiv",styles:"display:none;"}),this.findTab.appendChild(this.replaceTabContentDiv),this.createReplacePane(t),this.resultContainer=i.i(n.createElement)("div",{styles:"width:85%;display:block;",className:"e-de-op-result-container"}),this.findTab.appendChild(this.resultContainer),this.messageDiv=i.i(n.createElement)("div",{className:this.documentHelper.owner.containerId+"_messageDiv e-de-op-msg",innerHTML:this.localeValue.getConstant(this.messageDivText),id:this.documentHelper.owner.containerId+"_search_status"}),this.resultContainer.appendChild(this.messageDiv);var c=i.i(n.createElement)("div",{id:this.documentHelper.owner.containerId+"_resultDiv"});this.optionsPane.appendChild(c),this.findDiv=i.i(n.createElement)("div",{className:"findDiv",styles:"display:block;"}),c.appendChild(this.findDiv),this.resultsListBlock=i.i(n.createElement)("div",{id:this.documentHelper.owner.containerId+"_list_box_container",styles:"display:none;width:270px;list-style:none;padding-right:5px;overflow:auto;",className:"e-de-result-list-block"}),this.findDiv.appendChild(this.resultsListBlock),this.onWireEvents(),t&&(this.optionsPane.classList.add("e-de-rtl"),this.closeButton.classList.add("e-de-rtl"),this.searchDiv.classList.add("e-de-rtl"))},e.prototype.createReplacePane=function(e){this.replaceDiv=i.i(n.createElement)("div"),this.replaceTabContentDiv.appendChild(this.replaceDiv),this.replaceWith=i.i(n.createElement)("input",{className:"e-de-op-replacewith e-input",attrs:{placeholder:this.localeValue.getConstant("Replace with")}}),this.replaceDiv.appendChild(this.replaceWith);var t,r;e?(t="text-align:left",r="margin-left:10px"):(t="text-align:right",r="margin-right:10px");var o=i.i(n.createElement)("div",{styles:t,className:"e-de-op-dlg-footer"});this.replaceDiv.appendChild(o),this.replaceButton=i.i(n.createElement)("button",{className:"e-control e-btn e-flat e-replace",styles:r,innerHTML:this.localeValue.getConstant(this.replaceButtonText),attrs:{type:"button"}}),o.appendChild(this.replaceButton),this.replaceButton.setAttribute("aria-label",this.localeValue.getConstant(this.replaceButtonText)),this.replaceAllButton=i.i(n.createElement)("button",{className:"e-control e-btn e-flat e-replaceall",innerHTML:this.localeValue.getConstant(this.replaceAllButtonText),attrs:{type:"button"}}),o.appendChild(this.replaceAllButton),this.replaceAllButton.setAttribute("aria-label",this.localeValue.getConstant(this.replaceAllButtonText)),this.matchDiv=i.i(n.createElement)("div",{styles:"display:none;padding-top:10px;"}),this.replaceDiv.appendChild(this.matchDiv);var s=i.i(n.createElement)("div",{className:"e-de-op-search-replacediv"});this.replaceDiv.appendChild(s),this.occurrenceDiv=i.i(n.createElement)("div",{styles:"display:none;"}),this.replaceDiv.appendChild(this.occurrenceDiv)},e.prototype.selectedTabItem=function(e){var t=this.findTab.getElementsByClassName("e-content").item(0);if(e.previousIndex!==e.selectedIndex){var r=t.children[0],o=t.children[1],s=r.firstElementChild;s&&(s.parentElement&&s.parentElement.removeChild(s),o.appendChild(s))}var a=t.children[0];i.i(n.isNullOrUndefined)(a)||(0===e.selectedIndex?(this.isOptionsPane=!0,this.onFindPane()):(this.isOptionsPane=!1,this.onReplacePane()))},e.prototype.navigateSearchResult=function(e){e&&this.documentHelper.owner.searchModule.navigate(this.results.innerList[this.results.currentIndex]),this.documentHelper.owner.searchModule.highlight(this.results),this.documentHelper.owner.searchModule.addFindResultView(this.results),this.resultsListBlock.style.display="block",this.resultContainer.style.display="block";for(var t=this.documentHelper.owner.findResultsList,i="",n=0;n<t.length;n++)i+=t[n];var r=this.optionsPane.offsetHeight-this.findTab.offsetHeight;this.resultsListBlock.style.height=r+"px",this.clearFocusElement(),this.resultsListBlock.innerHTML=i;for(var n=0;n<this.resultsListBlock.children.length;n++)this.focusedElement.push(this.resultsListBlock.children[n]);var o=this.results.currentIndex;this.messageDiv.innerHTML=this.localeValue.getConstant("Result")+" "+(o+1)+" "+this.localeValue.getConstant("of")+" "+this.resultsListBlock.children.length;var s=this.resultsListBlock.children[o];s.classList.contains("e-de-search-result-item")&&(s.classList.remove("e-de-search-result-item"),s.classList.add("e-de-search-result-hglt"),s.children[0].classList.add("e-de-op-search-word-text"),this.scrollToPosition(s))},e.prototype.wholeWordsChange=function(){this.matchInput.checked&&this.wholeInput.checked?this.findOption="CaseSensitiveWholeWord":this.matchInput.checked&&!this.wholeInput.checked?this.findOption="CaseSensitive":!this.matchInput.checked&&this.wholeInput.checked?this.findOption="WholeWord":this.findOption="None",this.searchOptionChange()},e.prototype.matchChange=function(){this.matchInput.checked&&this.wholeInput.checked?this.findOption="CaseSensitiveWholeWord":!this.matchInput.checked&&this.wholeInput.checked?this.findOption="WholeWord":this.matchInput.checked&&!this.wholeInput.checked?this.findOption="CaseSensitive":this.findOption="None";var e=this.optionsPane.offsetHeight-this.findTab.offsetHeight;this.resultsListBlock.style.height=e+"px",this.searchOptionChange()},e.prototype.onWireEvents=function(){this.searchIcon.addEventListener("click",this.searchIconClickInternal),this.navigateToNextResult.addEventListener("click",this.navigateNextResultButtonClick),this.navigateToPreviousResult.addEventListener("click",this.navigatePreviousResultButtonClick),this.searchInput.addEventListener("keydown",this.onKeyDown),this.searchInput.addEventListener("keyup",this.onEnableDisableReplaceButton),this.resultsListBlock.addEventListener("click",this.resultListBlockClick),this.closeButton.addEventListener("click",this.close),this.replaceButton.addEventListener("click",this.onReplaceButtonClick),this.replaceAllButton.addEventListener("click",this.onReplaceAllButtonClick)},e.prototype.onKeyDownInternal=function(){var e=document.getElementById(this.documentHelper.owner.containerId+"_option_search_text_box");if(!i.i(n.isNullOrUndefined)(e)){e.blur();var t=e.value;if(""!==t){t.length>=1&&this.searchIcon.classList.contains("e-de-op-search-icon")&&(this.searchIcon.classList.add("e-de-op-search-close-icon"),this.searchIcon.classList.remove("e-de-op-search-icon"));this.isOptionsPane;this.clearSearchResultItems(),this.documentHelper.owner.searchModule.clearSearchHighlight();var r=this.documentHelper.owner.searchModule.textSearch.stringToRegex(t,this.findOption),o=this.documentHelper.selection.end,s=o.getHierarchicalIndexInternal();this.results=this.documentHelper.owner.searchModule.textSearch.findAll(r,this.findOption,s);var a=this.results;if(i.i(n.isNullOrUndefined)(a)&&this.viewer.renderVisiblePages(),null!=a&&a.length>0){-1===this.focusedElement.indexOf(this.navigateToPreviousResult)&&this.isOptionsPane&&this.focusedElement.push(this.navigateToPreviousResult),-1===this.focusedElement.indexOf(this.navigateToNextResult)&&this.isOptionsPane&&this.focusedElement.push(this.navigateToNextResult),this.documentHelper.owner.searchModule.navigate(this.results.innerList[this.results.currentIndex]),this.documentHelper.owner.searchModule.highlight(a),this.documentHelper.owner.searchModule.addFindResultView(a),this.resultContainer.style.display="block",this.resultsListBlock.style.display="block";var l=this.optionsPane.offsetHeight-this.findTab.offsetHeight;this.resultsListBlock.style.height=l+"px";var d=this.documentHelper.owner.findResultsList,h="";this.clearFocusElement(),this.resultsListBlock.innerHTML="";for(var c=0;c<d.length;c++)h+=d[c];this.resultsListBlock.innerHTML=h;for(var c=0;c<this.resultsListBlock.children.length;c++)this.focusedElement.push(this.resultsListBlock.children[c]);var p=(this.resultsListBlock.children,this.results.currentIndex);this.messageDiv.innerHTML=this.localeValue.getConstant("Result")+" "+(p+1)+" "+this.localeValue.getConstant("of")+" "+this.resultsListBlock.children.length;var u=this.resultsListBlock.children[p];u.classList.contains("e-de-search-result-item")&&(u.classList.remove("e-de-search-result-item"),u.classList.add("e-de-search-result-hglt"),u.children[0].classList.add("e-de-op-search-word-text")),this.navigateToNextResult.focus(),this.focusedIndex=this.focusedElement.indexOf(this.navigateToNextResult),this.getMessageDivHeight()}else this.messageDiv.innerHTML=this.localeValue.getConstant("No matches"),this.resultContainer.style.display="block",this.resultsListBlock.style.display="none",this.clearFocusElement(),this.resultsListBlock.innerHTML=""}}},e.prototype.onFindPane=function(){this.replaceDiv.style.display="none",this.occurrenceDiv.style.display="none",i.i(n.isNullOrUndefined)(this.results)||0!==this.results.length||(this.resultsListBlock.innerHTML="",this.resultsListBlock.style.display="none",this.messageDiv.innerHTML=this.localeValue.getConstant("No matches"));var e=(this.isOptionsPane,this.optionsPane.offsetHeight-(this.findTab.offsetHeight-this.replaceTabContentDiv.offsetHeight));this.resultsListBlock.style.height=e+"px",this.replaceTabContentDiv.style.display="none",this.findDiv.style.display="block",this.messageDiv.style.display="block",this.focusedElement=[],this.focusedElement.push(this.closeButton,this.searchInput,this.searchIcon,this.navigateToPreviousResult,this.navigateToNextResult,this.matchInput,this.wholeInput),this.focusedIndex=1,this.searchInput.select(),this.getMessageDivHeight()},e.prototype.getMessageDivHeight=function(){!this.isOptionsPane&&this.messageDiv.classList.contains("e-de-op-msg")?(this.messageDiv.classList.add("e-de-op-replace-messagediv"),this.messageDiv.classList.remove("e-de-op-msg")):this.isOptionsPane&&this.messageDiv.classList.contains("e-de-op-replace-messagediv")&&(this.messageDiv.classList.add("e-de-op-msg"),this.messageDiv.classList.remove("e-de-op-replace-messagediv"))},e.prototype.onReplacePane=function(){this.findDiv.style.display="block",this.replaceDiv.style.display="block",this.replaceTabContentDiv.style.display="block";var e=(this.isOptionsPane,this.optionsPane.offsetHeight-this.findTab.offsetHeight);this.resultsListBlock.style.height=e+"px",this.isOptionsPane=!1,0!==this.searchInput.value.length?(this.replaceButton.disabled=!1,this.replaceAllButton.disabled=!1):(this.replaceButton.disabled=!0,this.replaceAllButton.disabled=!0),this.focusedElement=[],this.focusedElement.push(this.closeButton,this.searchInput,this.searchIcon,this.navigateToPreviousResult,this.navigateToNextResult,this.matchInput,this.wholeInput,this.replaceWith,this.replaceButton,this.replaceAllButton),this.focusedIndex=1,""===this.searchInput.value?this.searchInput.select():this.replaceWith.select(),this.getMessageDivHeight()},e.prototype.replaceAll=function(){var e=(this.optionsPane,this.searchInput.value),t=this.replaceWith.value;if(""!==e&&!i.i(n.isNullOrUndefined)(e)){var r=this.documentHelper.owner.searchModule.textSearch.stringToRegex(e,this.findOption),o=this.documentHelper.selection.end,s=o.getHierarchicalIndexInternal(),a=this.documentHelper.owner.searchModule.textSearch.findAll(r,this.findOption,s),l=i.i(n.isNullOrUndefined)(t)?"":t,d=i.i(n.isNullOrUndefined)(a)?0:a.length;this.documentHelper.owner.searchModule.replaceAll(l,a),this.documentHelper.layout.isReplacingAll=!1,this.matchDiv.style.display="block",this.matchDiv.innerHTML=this.localeValue.getConstant("All Done")+"!",this.occurrenceDiv.style.display="block",this.occurrenceDiv.innerHTML=this.localeValue.getConstant("We replaced all")+" "+d+" "+this.localeValue.getConstant("instances")+" "+this.localeValue.getConstant("of")+' "'+e+'" '+this.localeValue.getConstant("with")+' "'+t+'" '}},e.prototype.hideMatchDiv=function(){this.matchDiv.style.display="none",this.occurrenceDiv.style.display="none"},e.prototype.updateListItems=function(e){for(var t=this.resultsListBlock.getElementsByClassName("e-de-search-result-hglt"),r=0;r<t.length;r++){var o=t[r];i.i(n.classList)(o,["e-de-search-result-item"],["e-de-search-result-hglt"]),i.i(n.classList)(o.children[0],[],["e-de-op-search-word-text"])}var s=this.resultsListBlock.children[this.results.currentIndex];i.i(n.classList)(s,["e-de-search-result-hglt"],["e-de-search-result-item"]),i.i(n.classList)(s.children[0],["e-de-op-search-word-text"],[]),this.scrollToPosition(s),this.documentHelper.owner.searchModule.navigate(e),this.documentHelper.owner.searchModule.highlight(this.results)},e.prototype.scrollToPosition=function(e){var t,i=e.getBoundingClientRect();i.top>0?(t=i.top-e.parentElement.getBoundingClientRect().top,e.parentElement.offsetHeight-t<=e.offsetHeight?(Math.ceil(t+e.offsetHeight)===e.parentElement.scrollHeight&&(e.parentElement.scrollTop=t),e.parentElement.scrollTop=e.parentElement.scrollTop+e.parentElement.offsetHeight/100*30):t<0&&(e.parentElement.scrollTop=e.parentElement.scrollTop-e.parentElement.offsetHeight/100*30)):e.parentElement.scrollTop=0},e.prototype.clearFocusElement=function(){for(var e=0;e<this.resultsListBlock.children.length;e++){var t=this.focusedElement.indexOf(this.resultsListBlock.children[e]);-1!==t&&this.focusedElement.splice(t,1)}this.focusedIndex=1},e.prototype.showHideOptionsPane=function(e){if(!i.i(n.isNullOrUndefined)(this.documentHelper.owner.selectionModule))if(e){if(this.localeValue=new n.L10n("documenteditor",this.documentHelper.owner.defaultLocale),this.localeValue.setLocale(this.documentHelper.owner.locale),i.i(n.isNullOrUndefined)(this.optionsPane)){this.initOptionsPane(this.localeValue,this.documentHelper.owner.enableRtl);var t=this.documentHelper.owner.enableRtl,o=void 0;o=t?"display:inline-flex;direction:rtl;":"display:inline-flex;",this.documentHelper.optionsPaneContainer.setAttribute("style",o),this.documentHelper.optionsPaneContainer.insertBefore(this.documentHelper.owner.optionsPaneModule.optionsPane,this.documentHelper.viewerContainer)}this.optionsPane.style.display="block",this.documentHelper.owner.isReadOnlyMode?this.tabInstance.hideTab(1):this.tabInstance.hideTab(1,!1),this.isReplace&&!this.documentHelper.owner.isReadOnlyMode?(this.tabInstance.select(1),this.isReplace=!1,this.isOptionsPane=!1):this.tabInstance.select(0),this.searchDiv.innerHTML=this.localeValue.getConstant(this.searchText),this.isOptionsPaneShow=!0;var s=document.getElementById(this.documentHelper.owner.getDocumentEditorElement().id+"_option_search_text_box"),a=this.documentHelper.owner.selection.text;if(!i.i(n.isNullOrUndefined)(a)){var l=["\v","\r"],d=r.a.indexOfAny(a,l);a=d<0?a:a.substring(0,d)}s.value=a,s.select(),this.messageDiv.innerHTML="",this.searchIcon.classList.contains("e-de-op-search-close-icon")&&(this.searchIcon.classList.add("e-de-op-search-icon"),this.searchIcon.classList.remove("e-de-op-search-close-icon")),this.documentHelper.selection.caret.style.display="none",this.focusedIndex=1,this.focusedElement=[],this.isOptionsPane?this.focusedElement.push(this.closeButton,this.searchInput,this.searchIcon,this.navigateToPreviousResult,this.navigateToNextResult,this.matchInput,this.wholeInput):this.focusedElement.push(this.closeButton,this.searchInput,this.searchIcon,this.navigateToPreviousResult,this.navigateToNextResult,this.matchInput,this.wholeInput,this.replaceWith,this.replaceButton,this.replaceAllButton),this.documentHelper.updateViewerSize()}else{if(!i.i(n.isNullOrUndefined)(this.optionsPane)){this.clearSearchResultItems(),i.i(n.isNullOrUndefined)(this.documentHelper.owner.searchModule)||this.documentHelper.owner.searchModule.clearSearchHighlight(),this.isOptionsPaneShow=!1;var h=document.getElementById(this.documentHelper.owner.containerId+"_list_box_container"),c=document.getElementById(this.documentHelper.owner.containerId+"_search_status");i.i(n.isNullOrUndefined)(h)||i.i(n.isNullOrUndefined)(c)||(h.style.display="none",this.clearFocusElement(),h.innerHTML="",c.innerHTML=this.localeValue.getConstant("No matches"))}this.documentHelper.updateViewerSize(),i.i(n.isNullOrUndefined)(this.optionsPane)||"none"!==this.optionsPane.style.display&&(this.documentHelper.selection.updateCaretPosition(),this.optionsPane.style.display="none"),this.documentHelper.owner.enableAutoFocus&&this.documentHelper.updateFocus(),this.documentHelper.owner.enableAutoFocus&&(this.documentHelper.selection.caret.style.display="block")}},e.prototype.clearSearchResultItems=function(){i.i(n.isNullOrUndefined)(this.documentHelper.owner.findResultsList)||(this.documentHelper.owner.findResultsList=[])},e.prototype.destroy=function(){this.optionsPane&&(this.optionsPane.innerHTML="",this.optionsPane=void 0),this.resultsListBlock&&(this.resultsListBlock.innerHTML="",this.resultsListBlock=void 0),this.messageDiv&&(this.messageDiv.innerHTML="",this.messageDiv=void 0),this.resultContainer&&(this.resultContainer.innerHTML=""),this.resultContainer=void 0,this.searchInput&&(this.searchInput.value="",this.searchInput=void 0),this.searchDiv&&(this.searchDiv.innerHTML="",this.searchDiv=void 0),this.searchTextBoxContainer&&(this.searchTextBoxContainer.innerHTML="",this.searchTextBoxContainer=void 0),this.replaceWith&&(this.replaceWith.innerHTML="",this.replaceWith=void 0),this.findDiv&&(this.findDiv.innerHTML="",this.findDiv=void 0),this.replaceButton&&(this.replaceButton.innerHTML="",this.replaceButton=void 0),this.replaceAllButton&&(this.replaceAllButton.innerHTML="",this.replaceAllButton=void 0),this.matchInput&&(this.matchInput.innerHTML="",this.matchCase=void 0),this.wholeInput&&(this.wholeInput.innerHTML="",this.wholeWord=void 0),i.i(n.isNullOrUndefined)(this.results)||this.results.destroy(),this.focusedElement&&(this.focusedElement=[]),this.focusedElement=void 0,this.destroyInternal(),this.documentHelper=void 0},e.prototype.destroyInternal=function(){this.searchText&&(this.searchText=void 0),this.resultsText&&(this.resultsText=void 0),this.messageDivText&&(this.messageDivText=void 0),this.replaceButtonText&&(this.replaceButtonText=void 0),this.replaceAllButtonText&&(this.replaceAllButtonText=void 0)},e}())},function(e,t,i){"use strict";i.d(t,"a",function(){return n});var n=function(){function e(e){this.searchModule=e}return Object.defineProperty(e.prototype,"length",{get:function(){return this.searchModule.textSearchResults.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return this.searchModule.textSearchResults.currentIndex},set:function(e){0===this.length||e<0||e>this.searchModule.textSearchResults.length-1||(this.searchModule.textSearchResults.currentIndex=e,this.navigate())},enumerable:!0,configurable:!0}),e.prototype.getTextSearchResultsOffset=function(){for(var e,t=[],i=0;i<this.searchModule.textSearchResults.innerList.length;i++)e=this.getOffset(this.searchModule.textSearchResults.innerList[parseInt(i.toString(),10)]),t.push(e);return t},e.prototype.getOffset=function(e){var t=e.start,i=e.end,n=this.searchModule.documentHelper.owner.selection.getParagraphInfo(t),r=this.searchModule.documentHelper.owner.selection.getHierarchicalIndex(n.paragraph,n.offset.toString());return n=this.searchModule.documentHelper.owner.selection.getParagraphInfo(i),{startOffset:r,endOffset:this.searchModule.documentHelper.owner.selection.getHierarchicalIndex(n.paragraph,n.offset.toString())}},e.prototype.getModuleName=function(){return"SearchResults"},e.prototype.replace=function(e){-1!==this.index&&this.searchModule.replaceInternal(e)},e.prototype.replaceAll=function(e){-1!==this.index&&this.searchModule.replaceAllInternal(e)},e.prototype.navigate=function(){this.searchModule.navigate(this.searchModule.textSearchResults.currentSearchResult),this.searchModule.highlight(this.searchModule.textSearchResults)},e.prototype.clear=function(){this.searchModule.textSearchResults.clearResults(),this.searchModule.clearSearchHighlight(),this.searchModule.viewer.renderVisiblePages()},e}()},function(e,t,i){"use strict";i.d(t,"a",function(){return p});var n=i(6),r=i(0),o=(i.n(r),i(20)),s=i(2),a=i(38),l=i(38),d=i(61),h=i(120),c=i(11),p=function(){function e(e){this.searchHighlighters=void 0,this.owner=e,this.searchHighlighters=new n.a,this.textSearch=new l.a(this.owner),this.textSearchResults=new d.a(this.owner),this.searchResultsInternal=new h.a(this)}return Object.defineProperty(e.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"searchResults",{get:function(){return this.searchResultsInternal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"Search"},e.prototype.find=function(e,t){i.i(r.isNullOrUndefined)(t)&&(t="None");var n=this.textSearch.find(e,t);i.i(r.isNullOrUndefined)(n)||this.navigate(n)},e.prototype.findAll=function(e,t){if(!i.i(r.isNullOrUndefined)(e||""===e)){i.i(r.isNullOrUndefined)(t)&&(t="None");var n=this.textSearch.findAll(e,t);!i.i(r.isNullOrUndefined)(n)&&n.length>0&&(this.navigate(n.innerList[n.currentIndex]),this.highlight(n))}},e.prototype.replace=function(e,t,n){if(i.i(r.isNullOrUndefined)(this.viewer.owner)||this.viewer.owner.isReadOnlyMode||!this.viewer.owner.editorModule.canEditContentControl||i.i(r.isNullOrUndefined)(n))return 0;i.i(r.isNullOrUndefined)(this.viewer)||this.clearSearchHighlight(),this.navigate(t);var s=this.documentHelper.selection.start;if(this.owner.enableTrackChanges&&this.documentHelper.selection.start.currentWidget){var a=void 0;a=this.documentHelper.selection.end.currentWidget.getInline(this.owner.selection.start.offset,0).element,a.revisions.length>0&&(this.isRepalceTracking=!0)}if(n.indexOf(t)<0)return 0;this.owner.editorModule.insertTextInternal(e,!0);var l=t.end,d=new o.a(this.viewer.owner);if(0===l.currentWidget.children.length){var h=l.currentWidget.paragraph.childWidgets[0];d.setPositionParagraph(h,s.offset-e.length)}else d.setPositionParagraph(l.currentWidget,s.offset-e.length);this.documentHelper.selection.selectRange(s,d);var p={source:this.viewer.owner};return this.viewer.owner.trigger(c.w,p),1},e.prototype.replaceInternal=function(e,t){if(""!==e&&!i.i(r.isNullOrUndefined)(e)){i.i(r.isNullOrUndefined)(t)&&(t="None");var n=this.textSearchResults.currentSearchResult.text,o=this.viewer.owner.searchModule.textSearch.stringToRegex(n,t),s=this.owner.selection.end.getHierarchicalIndexInternal(),a=this.viewer.owner.searchModule.textSearch.findNext(o,t,s);i.i(r.isNullOrUndefined)(a)||(this.navigate(a),this.textSearchResults.addResult(),this.textSearchResults.innerList[0]=a,this.replace(e,a,this.textSearchResults),s=this.owner.selection.end.getHierarchicalIndexInternal(),(a=this.textSearch.findNext(n,t,s))&&(this.textSearchResults.addResult(),this.textSearchResults.innerList[0]=a,this.navigate(a)))}},e.prototype.replaceAll=function(e,t){if(this.documentHelper.layout.isReplacingAll=!0,i.i(r.isNullOrUndefined)(this.viewer.owner)||this.viewer.owner.isReadOnlyMode||i.i(r.isNullOrUndefined)(t))return 0;this.owner.editorHistory&&this.owner.editorHistory.initComplexHistory(this.owner.selection,"ReplaceAll");var n=t.length;this.viewer.owner.isLayoutEnabled=!1;for(var o=t.innerList[0].text,s=n-1;s>=0;s--){var a=t.innerList[parseInt(s.toString(),10)];if(0===a.start.currentWidget.children.length)t=this.textSearch.findAll(o),s=t.length;else{if(this.navigate(a),this.viewer.owner.isReadOnlyMode||!this.viewer.owner.editorModule.canEditContentControl)continue;var l=!0;if(s>0){t.innerList[s-1].start.paragraph.equals(a.start.paragraph)&&(l=!1)}this.owner.editorModule.insertTextInternal(e,!0,void 0,l),a.destroy()}}return this.owner.editorHistory&&!i.i(r.isNullOrUndefined)(this.owner.editorHistory.currentHistoryInfo)?this.owner.editorHistory.updateComplexHistory():this.owner.editorModule.updateComplexWithoutHistory(2),this.searchResults.clear(),this.documentHelper.layout.isReplacingAll=!1,n},e.prototype.replaceAllInternal=function(e,t){i.i(r.isNullOrUndefined)(e)||(i.i(r.isNullOrUndefined)(t)&&(t="None"),this.textSearchResults.length>0&&(this.navigate(this.textSearchResults.innerList[this.textSearchResults.currentIndex]),this.highlight(this.textSearchResults),this.replaceAll(e,this.textSearchResults)))},e.prototype.navigate=function(e){if(e){var t=e.start,n=e.end;i.i(r.isNullOrUndefined)(this.owner)||i.i(r.isNullOrUndefined)(this.owner.selection)||i.i(r.isNullOrUndefined)(t)||i.i(r.isNullOrUndefined)(n)||i.i(r.isNullOrUndefined)(t.paragraph)||i.i(r.isNullOrUndefined)(n.paragraph)||(this.owner.selection.selectRange(t,n),this.documentHelper.updateFocus())}},e.prototype.highlight=function(e){this.searchHighlighters=new n.a;for(var t=0;t<e.innerList.length;t++){var i=e.innerList[parseInt(t.toString(),10)];this.highlightResult(i)}this.viewer.renderVisiblePages()},e.prototype.highlightResult=function(e){this.highlightSearchResult(e.start.paragraph,e.start,e.end)},e.prototype.highlightSearchResult=function(e,t,n){var o=0,a=0,l=null,d=null,h=this.documentHelper.selection.getStartLineWidget(e,t,l,o);o=h.index,l=h.element;var c=l?l.line:e.childWidgets[0],p=this.documentHelper.selection.getEndLineWidget(n,d,a);a=p.index,d=p.element;var u=d?d.line:n.paragraph.childWidgets[n.paragraph.childWidgets.length-1],g=this.documentHelper.selection.getTop(c),f=this.documentHelper.selection.getLeftInternal(c,l,o);if(i.i(r.isNullOrUndefined)(c)||c!==u){if(!i.i(r.isNullOrUndefined)(c)){e!==c.paragraph&&(e=c.paragraph);var m=this.documentHelper.selection.getWidth(c,!0)-(f-c.paragraph.x);if(e.bidi||l instanceof s.d&&l.isRightToLeft){var v=0,y=this.documentHelper.selection.getElementsForward(c,l,d,e.bidi);if(y)for(var w=!1,b=0;b<y.length;b++){var x=y[b],C=x instanceof s.d?x.length:1;v=this.documentHelper.selection.getLeftInternal(c,x,C),w=!1,f=x===l?this.documentHelper.selection.getLeftInternal(c,x,o):this.documentHelper.selection.getLeftInternal(c,x,0),x instanceof s.d&&(w=x.isRightToLeft),m=Math.abs(v-f),this.createHighlightBorder(c,m,w?v:f,g)}}else this.createHighlightBorder(c,m,f,g);for(var I=c.paragraph.childWidgets.indexOf(c),b=0;b<e.childWidgets.length;b++){if(e===c.paragraph&&(I+=1),this.highlightSearchResultParaWidget(e,I,u,d,a),e===u.paragraph)return;I=0}}}else{var v=this.documentHelper.selection.getLeftInternal(u,d,a),F=!1;d instanceof s.d&&(F=d.isRightToLeft);var m=0;if(m=Math.abs(v-f),!F&&l instanceof s.d&&(F=l.isRightToLeft),F||e.bidi){var k=this.documentHelper.selection.getElementsForward(c,l,d,e.bidi);if(k&&k.length>1)for(var b=0;b<k.length;b++){var x=k[b],w=!1,C=x instanceof s.d?x.length:1;x===l?(f=this.documentHelper.selection.getLeftInternal(c,x,o),v=this.documentHelper.selection.getLeftInternal(c,x,C)):x===d?(f=this.documentHelper.selection.getLeftInternal(c,x,0),v=this.documentHelper.selection.getLeftInternal(c,x,a)):(f=this.documentHelper.selection.getLeftInternal(c,x,0),v=this.documentHelper.selection.getLeftInternal(c,x,C)),x instanceof s.d&&(w=x.isRightToLeft),m=Math.abs(v-f),this.createHighlightBorder(c,m,w?v:f,g)}else this.createHighlightBorder(c,m,F?v:f,g)}else this.createHighlightBorder(c,m,f,g)}},e.prototype.createHighlightBorder=function(e,t,i,n){var r=this.addSearchHighlightBorder(e),o=this.viewer.owner.selection.getPage(e.paragraph);o.boundingRectangle.y,o.boundingRectangle.x;r.left=Math.ceil(i),n=Math.ceil(n),r.width=Math.floor(t);Math.floor(e.height),this.documentHelper.containerContext},e.prototype.addSearchHighlightBorder=function(e){var t=void 0,i=this.searchHighlighters;i.containsKey(e)?t=i.get(e):(t=[],i.add(e,t));var n=new a.b(0,0);return t.push(n),n},e.prototype.highlightSearchResultParaWidget=function(e,t,i,n,r){for(var o=0,a=0,l=!1,d=t;d<e.childWidgets.length;d++){var h=e.childWidgets[d];d===t&&(o=this.documentHelper.selection.getTop(h));var c=this.documentHelper.selection.getLeft(h);if(n instanceof s.d&&(l=n.isRightToLeft),h===i){var p=0;if(l||e.bidi){for(var u=this.documentHelper.selection.getElementsBackward(h,n,n,e.bidi),g=0;g<u.length;g++){var f=u[g],m=!1;if(c=this.documentHelper.selection.getLeftInternal(h,f,0),f===n)p=this.documentHelper.selection.getLeftInternal(h,f,r);else{var v=f instanceof s.d?f.length:1;p=this.documentHelper.selection.getLeftInternal(h,f,v)}f instanceof s.d&&(m=f.isRightToLeft),a=Math.abs(p-c),this.createHighlightBorder(h,a,m?p:c,o)}return}return p=this.documentHelper.selection.getLeftInternal(i,n,r),a=Math.abs(p-c),void this.createHighlightBorder(h,a,l?p:c,o)}a=this.documentHelper.selection.getWidth(h,!0)-(c-e.x),this.createHighlightBorder(h,a,c,o),o+=h.height}},e.prototype.addSearchResultItems=function(e){i.i(r.isNullOrUndefined)(e)||""===e||(i.i(r.isNullOrUndefined)(this.owner.findResultsList)&&(this.owner.findResultsList=[]),this.owner.findResultsList.push(e))},e.prototype.addFindResultView=function(e){for(var t=0;t<e.innerList.length;t++){var i=e.innerList[t];this.addFindResultViewForSearch(i)}},e.prototype.addFindResultViewForSearch=function(e){if(null!=e.start&&null!=e.end&&null!=e.start.paragraph&&null!=e.end.paragraph){var t=void 0,i=0,n=e.start.currentWidget.getInline(e.start.offset,i),r=n.element;i=n.index;var o="",a=0;if(r instanceof s.b){var l=this.owner.selection.getRenderedInline(r,i);l.element.nextNode instanceof s.d?(r=l.element.nextNode,i=l.index):(r=l.element,i=l.index)}var d=this.owner.selection.getElementBoxInternal(r,i),h=d.element;if(i=d.index,null!=h){h instanceof s.d&&i>0&&(o=h.text.substring(0,i));var c=h.line.children.indexOf(h);for(a=o.lastIndexOf(" ");a<0&&c>0&&h.line.children[c-1]instanceof s.d;)o=h.line.children[c-1].text+o,c--,a=o.lastIndexOf(" ")}var p=o.lastIndexOf("\v");p>0?o=o.substring(0,p):(a=o.lastIndexOf(" "),a<0?o:o.substring(a+1)),e.text;var u=0,g=e.end.currentWidget.getInline(e.end.offset,u),f=g.element;if(u=g.index,t="",null!=d&&(d=this.owner.selection.getElementBoxInternal(f,u),h=d.element,u=d.index),null!=h){h instanceof s.d&&u<h.length&&(t=h.text.substring(u));for(var c=h.line.children.indexOf(h);c+1<h.line.children.length&&h.line.children[c+1]instanceof s.d||h.line.children[c+1]instanceof s.b;)h.line.children[c+1]instanceof s.b?c+=2:(t+=h.line.children[c+1].text,c+=1)}a=t.lastIndexOf(" "),t="\v"===t?t="":t;var m="",v="",y=e.start.paragraph.containerWidget,w=y instanceof s.x?y.headerFooterType:"";-1!=w.indexOf("Header")?m='<span class="e-de-header-footer-list">Header: </span>':-1!=w.indexOf("Footer")&&(v='<li tabindex=0 class="e-de-search-result-item e-de-op-search-txt">'+m+o+'<span class="e-de-op-search-word" style="pointer-events:none">'+e.text+"</span>"+t+"</li>",m='<span class="e-de-header-footer-list">Footer: </span>'),v='<li tabindex=0 class="e-de-search-result-item e-de-op-search-txt">'+m+o+'<span class="e-de-op-search-word" style="pointer-events:none">'+e.text+"</span>"+t+"</li>",this.addSearchResultItems(v)}},e.prototype.clearSearchHighlight=function(){i.i(r.isNullOrUndefined)(this.searchHighlighters)||(this.searchHighlighters.clear(),this.searchHighlighters=void 0);var e={source:this.viewer.owner};this.viewer.owner.trigger(c.w,e)},e.prototype.destroy=function(){this.textSearchResults&&this.textSearchResults.destroy(),this.textSearchResults=void 0,this.owner=void 0},e}()},function(e,t,i){"use strict";var n=i(123);i.d(t,"d",function(){return n.a});var r=i(62);i.d(t,"c",function(){return r.a}),i.d(t,"e",function(){return r.h}),i.d(t,"f",function(){return r.i}),i.d(t,"g",function(){return r.b}),i.d(t,"h",function(){return r.j}),i.d(t,"i",function(){return r.c}),i.d(t,"j",function(){return r.f}),i.d(t,"k",function(){return r.e}),i.d(t,"l",function(){return r.d}),i.d(t,"m",function(){return r.g}),i.d(t,"n",function(){return r.k});var o=i(20);i.d(t,"a",function(){return o.a}),i.d(t,"b",function(){return o.b}),i.d(t,"o",function(){return o.d}),i.d(t,"p",function(){return o.c})},function(e,t,i){"use strict";i.d(t,"a",function(){return g});var n=i(2),r=i(4),o=i(62),s=i(7),a=i(0),l=(i.n(a),i(6)),d=i(11),h=i(69),c=i(8),p=(i.n(c),i(20)),u=i(19),g=(i.n(u),function(){function e(e){var t=this;this.upDownSelectionLength=0,this.isSkipLayouting=!1,this.isImageSelected=!1,this.contextTypeInternal=void 0,this.caret=void 0,this.isRetrieveFormatting=!1,this.skipFormatRetrieval=!1,this.isModifyingSelectionInternally=!1,this.isMoveDownOrMoveUp=!1,this.isEndOffset=!1,this.isViewPasteOptions=!1,this.skipEditRangeRetrieval=!1,this.selectedWidgets=void 0,this.isHighlightEditRegionIn=!1,this.isHighlightFormFields=!1,this.isHightlightEditRegionInternal=!1,this.isCurrentUser=!1,this.isHighlightNext=!1,this.isWebLayout=!1,this.editRegionHighlighters=void 0,this.formFieldHighlighters=void 0,this.isSelectList=!1,this.previousSelectedFormField=void 0,this.isFormatUpdated=!1,this.isCellPrevSelected=!1,this.currentFormField=void 0,this.pasteOptions=function(e){var i=new a.L10n("documenteditor",t.owner.defaultLocale);i.setLocale(t.owner.locale),e.item.text===i.getConstant("Keep source formatting")?t.owner.editor.applyPasteOptions("KeepSourceFormatting"):e.item.text===i.getConstant("Match destination formatting")?t.owner.editor.applyPasteOptions("MergeWithExistingFormatting"):e.item.text===i.getConstant("NestTable")?t.owner.editor.applyTablePasteOptions("NestTable"):e.item.text===i.getConstant("InsertAsRows")?t.owner.editor.applyTablePasteOptions("InsertAsRows"):e.item.text===i.getConstant("InsertAsColumns")?t.owner.editor.applyTablePasteOptions("InsertAsColumns"):e.item.text===i.getConstant("OverwriteCells")?t.owner.editor.applyTablePasteOptions("OverwriteCells"):t.owner.editor.applyPasteOptions("KeepTextOnly")},this.hideCaret=function(){i.i(a.isNullOrUndefined)(t.caret)||(t.caret.style.display="none")},this.owner=e,this.documentHelper=this.owner.documentHelper,this.start=new p.a(this.owner),this.end=new p.a(this.owner),this.selectedWidgets=new l.a,this.characterFormatIn=new o.a(this),this.paragraphFormatIn=new o.b(this,this.documentHelper),this.sectionFormatIn=new o.c(this),this.rowFormatIn=new o.d(this),this.cellFormatIn=new o.e(this),this.tableFormatIn=new o.f(this),this.imageFormatInternal=new o.g(this),this.editRangeCollection=[],this.editRegionHighlighters=new l.a,this.formFieldHighlighters=new l.a}return Object.defineProperty(e.prototype,"isHighlightEditRegion",{get:function(){return this.isHighlightEditRegionIn},set:function(e){this.isHighlightEditRegionIn=e,this.onHighlight()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"htmlWriter",{get:function(){return i.i(a.isNullOrUndefined)(this.htmlWriterIn)&&(this.htmlWriterIn=new h.a),this.htmlWriterIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"start",{get:function(){if(!i.i(a.isNullOrUndefined)(this.owner)&&!i.i(a.isNullOrUndefined)(this.viewer))return i.i(a.isNullOrUndefined)(this.startInternal)&&(this.startInternal=this.owner.documentStart),this.startInternal},set:function(e){this.startInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"characterFormat",{get:function(){return this.characterFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paragraphFormat",{get:function(){return this.paragraphFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sectionFormat",{get:function(){return this.sectionFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tableFormat",{get:function(){return this.tableFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cellFormat",{get:function(){return this.cellFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rowFormat",{get:function(){return this.rowFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageFormat",{get:function(){return this.imageFormatInternal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this.endInternal},set:function(e){this.endInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"startPage",{get:function(){return!this.owner.isDocumentLoaded||i.i(a.isNullOrUndefined)(this.viewer)||this.viewer instanceof s.C||i.i(a.isNullOrUndefined)(this.documentHelper.selectionStartPage)?1:this.documentHelper.pages.indexOf(this.documentHelper.selectionStartPage)+1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endPage",{get:function(){return!this.owner.isDocumentLoaded||i.i(a.isNullOrUndefined)(this.viewer)||this.viewer instanceof s.C||i.i(a.isNullOrUndefined)(this.documentHelper.selectionEndPage)?1:this.documentHelper.pages.indexOf(this.documentHelper.selectionEndPage)+1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isForward",{get:function(){return this.start.isExistBefore(this.end)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isinFootnote",{get:function(){var e=this.getContainerWidget(this.start.paragraph);return e instanceof n.a&&"Footnote"===e.footNoteType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isinEndnote",{get:function(){var e=this.getContainerWidget(this.start.paragraph);return e instanceof n.a&&"Endnote"===e.footNoteType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEmpty",{get:function(){return!!i.i(a.isNullOrUndefined)(this.start)||this.start.isAtSamePosition(this.end)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"startOffset",{get:function(){return this.getHierarchicalIndexByPosition(this.start)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endOffset",{get:function(){return this.getHierarchicalIndexByPosition(this.end)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isInShape",{get:function(){var e=this.start.paragraph.containerWidget;do{if(e instanceof n.i)return!0;e&&(e=e.containerWidget)}while(e);return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this.getText(!1)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contextType",{get:function(){return this.contextTypeInternal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bookmarks",{get:function(){return this.getSelBookmarks(!1)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sfdt",{get:function(){return this.owner.editorModule&&this.start.offset!==this.end.offset?JSON.stringify(this.writeSfdt()):void 0},enumerable:!0,configurable:!0}),e.prototype.getBookmarks=function(e){return this.getSelBookmarks(e)},Object.defineProperty(e.prototype,"isCleared",{get:function(){return i.i(a.isNullOrUndefined)(this.end)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isInField",{get:function(){return!i.i(a.isNullOrUndefined)(this.getHyperlinkField(!0))},enumerable:!0,configurable:!0}),e.prototype.getFieldInfo=function(){var e=this.getHyperlinkField(!0);if(!i.i(a.isNullOrUndefined)(e)){return{code:this.getFieldCode(e),result:this.owner.editorModule.getFieldResultText(e)}}},e.prototype.getSelBookmarks=function(e){var t=[],n=this.documentHelper.bookmarks,r=this.start,o=this.end;this.isForward||(r=this.end,o=this.start);for(var s,l,d=!1,h=this.getSelectedCells(),c=0;c<n.length;c++)if(e||!e&&0!==n.keys[c].indexOf("_")){if(s=n.get(n.keys[c]),l=s.reference,i.i(a.isNullOrUndefined)(l))continue;var p=this.getElementPosition(s).startPosition,u=this.getElementPosition(l,!0).startPosition;if(p.paragraph.isInsideTable||u.paragraph.isInsideTable)if(h.length>0){if(h.indexOf(p.paragraph.associatedCell)>=0||h.indexOf(u.paragraph.associatedCell)>=0)d=!0;else if(d=!1,h.indexOf(p.paragraph.associatedCell)<0||h.indexOf(u.paragraph.associatedCell)<0){var g=o.paragraph.isInsideTable&&o.paragraph.associatedCell,f=u.paragraph.associatedCell;if(g&&f&&g.ownerTable.equals(f.ownerTable)&&!(g.ownerTable&&h.indexOf(this.getCellInTable(g.ownerTable,f))>=0))continue}}else d=!1;else d=!1;((r.isExistAfter(p)||r.isAtSamePosition(p))&&(o.isExistBefore(u)||o.isAtSamePosition(u))||(p.isExistAfter(r)||p.isAtSamePosition(r))&&(u.isExistBefore(o)||u.isAtSamePosition(o))||p.isExistAfter(r)&&p.isExistBefore(o)&&(o.isExistAfter(u)||o.isExistBefore(u))||u.isExistBefore(o)&&u.isExistAfter(r)&&(r.isExistBefore(p)||r.isExistAfter(p))||d)&&t.push(s.name)}return t},Object.defineProperty(e.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"Selection"},e.prototype.checkLayout=function(){"Continuous"===this.owner.layoutType&&(this.isWebLayout=!0,this.documentHelper.isHeaderFooter=!0,this.owner.layoutType="Pages",this.owner.viewer.destroy(),this.owner.viewer=new s.D(this.owner),this.owner.editor.layoutWholeDocument())},e.prototype.goToHeader=function(){this.checkLayout(),this.owner.enableHeaderAndFooter=!0,this.enableHeadersFootersRegion(this.start.paragraph.bodyWidget.page.headerWidget,this.start.paragraph.bodyWidget.page),this.isWebLayout=!1},e.prototype.goToFooter=function(){this.checkLayout(),this.owner.enableHeaderAndFooter=!0,this.enableHeadersFootersRegion(this.start.paragraph.bodyWidget.page.footerWidget,this.start.paragraph.bodyWidget.page),this.isWebLayout=!1},e.prototype.closeHeaderFooter=function(){this.disableHeaderFooter(),this.documentHelper.isHeaderFooter&&"Pages"===this.owner.layoutType&&(this.owner.layoutType="Continuous",this.documentHelper.isHeaderFooter=!1)},e.prototype.goToPage=function(e){if(this.owner.scrollToPage(e),e>=1&&e<=this.owner.documentHelper.pages.length){var t=this.owner.documentHelper.pages[e-1];this.updateTextPositionForBlockContainer(t.bodyWidgets[0])}},e.prototype.selectTable=function(){this.owner.enableSelection&&this.selectTableInternal()},e.prototype.selectRow=function(){this.owner.enableSelection&&this.selectTableRow()},e.prototype.selectColumn=function(){this.owner.enableSelection&&this.selectColumnInternal()},e.prototype.selectCell=function(){this.owner.enableSelection&&this.selectTableCell()},e.prototype.select=function(e,t){if("string"==typeof e){var i=this.getTextPosBasedOnLogicalIndex(e),n=this.getTextPosBasedOnLogicalIndex(t);this.selectPosition(i,n)}else{var o=new r.b(e.x,e.y),s=this.viewer.findFocusedPage(o,!0);e.extend?this.moveTextPosition(s,this.end):this.documentHelper.updateTextPositionForSelection(s,1)}},e.prototype.selectByHierarchicalIndex=function(e,t){var i=this.getTextPosBasedOnLogicalIndex(e),n=this.getTextPosBasedOnLogicalIndex(t);this.selectPosition(i,n)},e.prototype.selectField=function(e){!this.isInField&&i.i(a.isNullOrUndefined)(e)||(i.i(a.isNullOrUndefined)(e)&&(e=this.getHyperlinkField(!0)),this.selectFieldInternal(e))},e.prototype.selectFieldInternal=function(e,t,i){if(e){var r=this.documentHelper.isFormFillProtectedMode||i,o=e.fieldEnd;r&&(e=e.fieldSeparator);var s=e.line.getOffset(e,r?1:0),a=new p.a(this.owner);a.setPositionParagraph(e.line,s);e.nextNode instanceof n.e&&!r&&e.nextElement.reference&&(o=e.nextElement.reference);var l=o.line.getOffset(o,r?0:1),d=new p.a(this.owner);d.setPositionParagraph(o.line,l),this.documentHelper.selection.selectRange(a,d),i||this.triggerFormFillEvent(t)}},e.prototype.selectShape=function(e){if(e){var t=e.line.getOffset(e,0),i=new p.a(this.owner);i.setPositionParagraph(e.line,t);var n=e.line.getOffset(e,1),r=new p.a(this.owner);r.setPositionParagraph(e.line,n),this.documentHelper.selection.selectRange(i,r)}},e.prototype.toggleBold=function(){this.owner.editorModule&&this.owner.editorModule.toggleBold()},e.prototype.toggleItalic=function(){this.owner.editorModule&&this.owner.editorModule.toggleItalic()},e.prototype.toggleAllCaps=function(){this.owner.editorModule&&this.owner.editorModule.toggleAllCaps()},e.prototype.toggleUnderline=function(e){this.owner.editor&&this.owner.editor.toggleUnderline(e)},e.prototype.toggleStrikethrough=function(e){this.owner.editor&&this.owner.editor.toggleStrikethrough(e)},e.prototype.toggleHighlightColor=function(e){this.owner.editor&&this.owner.editor.toggleHighlightColor(e)},e.prototype.toggleSubscript=function(){this.owner.editor&&this.owner.editor.toggleSubscript()},e.prototype.toggleSuperscript=function(){this.owner.editor&&this.owner.editor.toggleSuperscript()},e.prototype.toggleTextAlignment=function(e){this.owner.editor&&this.owner.editor.toggleTextAlignment(e)},e.prototype.increaseIndent=function(){this.owner.editor&&this.owner.editor.increaseIndent()},e.prototype.decreaseIndent=function(){this.owner.editor&&this.owner.editor.decreaseIndent()},e.prototype.navigateHyperlink=function(){var e=this.getHyperlinkField();e&&this.fireRequestNavigate(e)},e.prototype.fireRequestNavigate=function(e){var t=this.getFieldCode(e);if(0!==t.toLowerCase().indexOf("ref ")||t.match("\\h")){var i=new p.c(e,this),n={isHandled:!1,navigationLink:i.navigationLink,linkType:i.linkType,localReference:i.localReference,source:this.owner};this.owner.trigger(d.n,n),n.isHandled||this.documentHelper.selection.navigateBookmark(i.localReference,!0)}},e.prototype.copyHyperlink=function(){var e=this.getHyperlinkField(),t=this.getLinkText(e,!0);this.copyToClipboard(t)},e.prototype.isHideSelection=function(e){var t=e.bodyWidget,i=t.sectionFormat,n=i.pageHeight-i.footerDistance,o=t.page.boundingRectangle.height/100*40;return this.contextType.indexOf("Footer")>=0&&e.y+e.height>r.a.convertPointToPixel(n)||this.contextType.indexOf("Header")>=0&&e.y+e.height>o},e.prototype.highlightSelection=function(e,t){if(this.owner.enableImageResizerMode&&this.owner.imageResizerModule.hideImageResizer(),this.isEmpty){if(!this.isInShape&&this.isHideSelection(this.start.paragraph))return void this.hideCaret();this.isInShape&&this.showResizerForShape(),this.updateCaretPosition()}else this.isForward?this.highlightSelectedContent(this.start,this.end):this.highlightSelectedContent(this.end,this.start),this.documentHelper.isComposingIME&&this.updateCaretPosition();this.documentHelper.updateTouchMarkPosition(),e&&this.documentHelper.scrollToPosition(this.start,this.end,void 0,t)},e.prototype.createHighlightBorder=function(e,t,i,n,r){t<0&&(t=0);var o=e.paragraph,s=[];if(o.floatingElements.length>0)for(var a=0;a<o.floatingElements.length;a++){var l=o.floatingElements[a];if(l.line===e){var d=this.start,h=this.end;this.isForward||(d=this.end,h=this.start);var c=l.line.getOffset(l,0);(d.currentWidget!==e&&h.currentWidget!==e||d.currentWidget===e&&d.offset<=c&&(h.currentWidget===e&&h.offset>=c+1||h.currentWidget!==e)||d.currentWidget!==e&&h.currentWidget===e&&h.offset>=c)&&s.push(l)}}var u=this.getPage(e.paragraph),g=(e.height,this.selectedWidgets),f=void 0,m=void 0;if(this.isHightlightEditRegionInternal)return void this.addEditRegionHighlight(e,i,t);if(this.isHighlightFormFields)return void this.addFormFieldHighlight(e,i,t);if(g.containsKey(e))g.get(e)instanceof p.d?(f=g.get(e),r&&(g.remove(e),m=[],g.add(e,m))):m=g.get(e);else if(r)m=[],g.add(e,m);else{var v=this.getWrapPosition(e,o);if(v.length>0){var y=this.splitSelectionHighlightPosition(i,t,v);if(y.length>0)return y[0].floatingItems=s,g.add(e,y),void this.renderHighlight(u,e,y,n,s);f=new p.d(i,t),f.floatingItems=s,g.add(e,f)}else f=new p.d(i,t),f.floatingItems=s,g.add(e,f)}void 0===f&&(f=new p.d(i,t),f.floatingItems=s,g.add(e,f)),this.renderHighlight(u,e,[f],n,s),r&&m.push(f)},e.prototype.renderHighlight=function(e,t,i,n,r){var o=this.owner.documentHelper,s=this.getPageTop(e),a=e.boundingRectangle.x,l=t.height;if(this.viewer.containerTop<=s||s<this.viewer.containerTop+o.selectionCanvas.height){var d=o.zoomFactor;this.clipSelection(e,s);for(var h=0;h<i.length;h++){var c=i[h],p=c.left,u=c.width;this.documentHelper.isComposingIME?this.renderDashLine(o.selectionContext,e,t,a+p*d-this.viewer.containerLeft,n,u*d,l):(this.documentHelper.selectionContext.fillStyle="gray",o.selectionContext.globalAlpha=.4,o.selectionContext.fillRect(a+p*d-this.viewer.containerLeft,s+n*d-this.viewer.containerTop,u*d,l*d))}if(r.length>0)for(var g=0;g<r.length;g++){var p=r[g].x,f=r[g].y,m=r[g].width,v=r[g].height;o.selectionContext.fillRect(a+p*d-this.viewer.containerLeft,s+f*d-this.viewer.containerTop,m*d,v*d)}o.selectionContext.restore()}},e.prototype.getWrapPosition=function(e,t){var r=t.bodyWidget;if(!i.i(a.isNullOrUndefined)(r)&&r.floatingElements.length>0&&e.children.length>0){for(var o=this.getLeftInternal(e,e.children[0],0),s=0,l=[],d=!1,h=0;h<e.children.length;h++){var c=e.children[h];if(!(c instanceof n.v&&"Inline"!==c.textWrappingStyle)){if(c.padding.left>0){1===l.length&&0===l[0].end&&(l[0].end=l[0].start-t.x,l[0].start=t.x,o=t.x);var p={};p.start=o+s,p.end=0,d&&(p.end=o+s+c.padding.left),l.push(p)}s+=c.padding.left+c.width,c instanceof n.d&&(d=!0)}}return 1===l.length&&0===l[0].end&&(l[0].end=l[0].start-t.x,l[0].start=t.x),l}return[]},e.prototype.splitSelectionHighlightPosition=function(e,t,i){for(var n=[],r=0;r<i.length;r++){var o=i[r];e<o.start&&e+t<o.end||e>o.end||(e<o.start&&e+t>o.end?(n.push(new p.d(e,o.start-e)),t=e+t-o.end,e=o.end):e===o.start&&(e+=o.end,t-=o.end),r===i.length-1&&n.push(new p.d(e,t)))}return n},e.prototype.addEditRegionHighlight=function(e,t,i){var n=void 0,r=this.editRegionHighlighters;r.containsKey(e)?n=r.get(e):(n=[],r.add(e,n));var o=new p.d(t,i);return this.isCurrentUser&&(o.color=""!==this.owner.userColor?this.owner.userColor:"#FFFF00"),n.push(o),o},e.prototype.addFormFieldHighlight=function(e,t,i){var n=void 0,r=this.formFieldHighlighters;r.containsKey(e)?n=r.get(e):(n=[],r.add(e,n));var o=new p.d(t,i);n.push(o)},e.prototype.createHighlightBorderInsideTable=function(e){var t=this.getPage(e),i=void 0,n=e.x-e.margin.left+e.leftBorderWidth,r=e.width+e.margin.left+e.margin.right-e.leftBorderWidth-e.rightBorderWidth,o=e.y,s=e.height,a=this.getPageTop(t),l=t.boundingRectangle.x,d=this.documentHelper.isPageInVisibleBound(t,a),h=this.selectedWidgets;if(this.isHightlightEditRegionInternal||this.isHighlightFormFields||(h.containsKey(e)&&h.get(e)instanceof p.d?(i=h.get(e),d&&this.documentHelper.selectionContext.clearRect(l+i.left*this.documentHelper.zoomFactor-this.viewer.containerLeft,a+o*this.documentHelper.zoomFactor-this.viewer.containerTop,i.width*this.documentHelper.zoomFactor,s*this.documentHelper.zoomFactor)):(i=new p.d(n,r),h.containsKey(e)&&h.remove(h.get(e)),h.add(e,i))),d){this.documentHelper.selectionContext.fillStyle="gray",this.documentHelper.selectionContext.globalAlpha=.4;var c=this.documentHelper.zoomFactor;this.clipSelection(t,a),this.documentHelper.selectionContext.fillRect(l+n*c-this.viewer.containerLeft,a+o*c-this.viewer.containerTop,r*c,s*c),this.documentHelper.selectionContext.restore()}},e.prototype.clipSelection=function(e,t){var i,n,r=this.owner.documentHelper;this.viewer instanceof s.C&&this.documentHelper.zoomFactor<1?(i=e.boundingRectangle.width/this.documentHelper.zoomFactor,n=e.boundingRectangle.height/this.documentHelper.zoomFactor):(i=e.boundingRectangle.width*this.documentHelper.zoomFactor,n=e.boundingRectangle.height*this.documentHelper.zoomFactor);var o=e.boundingRectangle.x;r.selectionContext.beginPath(),r.selectionContext.save(),r.selectionContext.rect(o-this.viewer.containerLeft,t-this.viewer.containerTop,i,n),r.selectionContext.clip()},e.prototype.addSelectionHighlight=function(e,t,n,r){if(this.selectedWidgets.containsKey(t)){var o=this.documentHelper.render.getScaledValue(t.height),s=this.selectedWidgets.get(t),l=void 0;if(s instanceof p.d?(l=[],l.push(s)):l=s,!i.i(a.isNullOrUndefined)(l))for(var d=0;d<l.length;d++){var h=l[d],c=this.documentHelper.render.getScaledValue(l[d].width),u=this.documentHelper.render.getScaledValue(l[d].left,1);if(i.i(a.isNullOrUndefined)(r)&&(r=this.owner.selection.getPage(t.paragraph)),this.owner.selection.clipSelection(r,this.owner.selection.getPageTop(r)),this.documentHelper.isComposingIME)this.renderDashLine(e,r,t,u,n,c,o);else if(e.globalAlpha=.4,e.fillStyle="gray",e.fillRect(u,this.documentHelper.render.getScaledValue(n,2),c,o),h.floatingItems&&h.floatingItems.length>0)for(var g=0;g<h.floatingItems.length;g++){var f=h.floatingItems[g];c=this.documentHelper.render.getScaledValue(f.width),u=this.documentHelper.render.getScaledValue(f.x,1);var m=this.documentHelper.render.getScaledValue(f.y,2);e.fillRect(u,m,c,this.documentHelper.render.getScaledValue(f.height))}e.restore()}}},e.prototype.renderDashLine=function(e,t,i,n,o,a,l){var d=this.characterFormat.fontColor,h=d?r.a.getColor(d):"#000000";e.globalAlpha=1;var c=this.owner.editor.copyInsertFormat(new s.g,!1),p=this.documentHelper.textHelper.getHeight(c),u=this.getPageTop(t),g=p.Height-p.BaselineOffset;o=this.documentHelper.render.getUnderlineYPosition(i)+o+4-g,this.documentHelper.render.renderDashLine(e,n,u-this.viewer.containerTop+o*this.documentHelper.zoomFactor,a,h,!0)},e.prototype.addSelectionHighlightTable=function(e,t,n){if(this.selectedWidgets.containsKey(t)){var r=this.selectedWidgets.get(t),o=void 0;if(r instanceof p.d?(o=[],o.push(r)):o=r,!i.i(a.isNullOrUndefined)(o))for(var s=0;s<o.length;s++){var l=this.documentHelper.render.getScaledValue(o[s].left,1),d=this.documentHelper.render.getScaledValue(t.y,2),h=this.documentHelper.render.getScaledValue(o[s].width),c=this.documentHelper.render.getScaledValue(t.height);e.fillStyle="gray",i.i(a.isNullOrUndefined)(n)&&(n=this.owner.selection.getPage(t)),this.owner.selection.clipSelection(n,this.owner.selection.getPageTop(n)),e.fillRect(l,d,h,c),e.restore()}}},e.prototype.removeSelectionHighlight=function(e){var t=0,r=0,o=0,s=0,l=void 0;if(e instanceof n.p){var d=e,h=d.paragraph;if(l=i.i(a.isNullOrUndefined)(h)?void 0:this.getPage(d.paragraph),i.i(a.isNullOrUndefined)(l))return;r=this.getTop(d),s=d.height}else if(e instanceof n.j){if(l=i.i(a.isNullOrUndefined)(e)?void 0:this.getPage(e),i.i(a.isNullOrUndefined)(l))return;r=e.y,s=e.height}if(!i.i(a.isNullOrUndefined)(l)){var c=this.selectedWidgets.get(e),u=void 0;if(c instanceof p.d?(u=[],u.push(c)):u=c,!i.i(a.isNullOrUndefined)(u))for(var g=0;g<u.length;g++){o=u[g].width,t=u[g].left;var f=l.boundingRectangle,m=this.documentHelper.pages.indexOf(l),v=this.viewer.pageGap,y=(f.y-v*(m+1))*this.documentHelper.zoomFactor+v*(m+1),w=f.x,b=this.documentHelper.zoomFactor;(this.viewer.containerTop<=y||y<this.viewer.containerTop+this.documentHelper.selectionCanvas.height)&&this.documentHelper.selectionContext.clearRect(w+t*b-this.viewer.containerLeft-.5,y+r*b-this.viewer.containerTop-.5,o*b+.5,s*b+.5)}}},e.prototype.selectCurrentWord=function(e){var t=this.start.clone(),i=this.end.clone();this.selectCurrentWordRange(t,i,e||!1),this.selectRange(t,i)},e.prototype.selectParagraph=function(){i.i(a.isNullOrUndefined)(this.start)||(this.start.paragraphStartInternal(this,!1),this.end.moveToParagraphEndInternal(this,!1),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},e.prototype.selectLine=function(){i.i(a.isNullOrUndefined)(this.start)||(this.moveToLineStart(),this.handleShiftEndKey())},e.prototype.moveToDocumentStart=function(){this.handleControlHomeKey()},e.prototype.moveToDocumentEnd=function(){this.handleControlEndKey()},e.prototype.moveToParagraphStart=function(){this.isForward?(this.start.paragraphStartInternal(this,!1),this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.end.location.x):(this.end.paragraphStartInternal(this,!1),this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.start.location.x),this.fireSelectionChanged(!0)},e.prototype.moveToParagraphEnd=function(){this.isForward?(this.start.moveToParagraphEndInternal(this,!1),this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.end.location.x):(this.end.moveToParagraphEndInternal(this,!1),this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.start.location.x),this.fireSelectionChanged(!0)},e.prototype.moveToNextLine=function(){this.moveDown()},e.prototype.moveToPreviousLine=function(){this.moveUp()},e.prototype.moveToNextCharacter=function(){this.handleRightKey()},e.prototype.moveToPreviousCharacter=function(){this.handleLeftKey()},e.prototype.selectCurrentWordRange=function(e,t,r){if(!i.i(a.isNullOrUndefined)(e)){if(e.offset>0){var o=e.clone(),s=0,l=e.currentWidget.getInline(e.offset,s),d=l.element;s=l.index,!i.i(a.isNullOrUndefined)(d)&&d instanceof n.b&&1===d.fieldType?e.offset>2&&(!i.i(a.isNullOrUndefined)(d.fieldSeparator)||i.i(a.isNullOrUndefined)(d.fieldBegin))?(o.setPositionParagraph(o.currentWidget,e.offset-2),o.moveToWordEndInternal(0,!1),o.paragraph===e.paragraph&&o.offset===e.offset-1||e.moveToWordStartInternal(2)):e.offset>3&&i.i(a.isNullOrUndefined)(d.fieldSeparator)&&(o.setPositionParagraph(o.currentWidget,e.offset-3),o.moveToWordEndInternal(0,!1),o.paragraph===e.paragraph&&o.offset===e.offset||e.moveToWordStartInternal(2)):(o.setPositionParagraph(o.currentWidget,e.offset-1),o.moveToWordEndInternal(0,!1),o.paragraph===e.paragraph&&o.offset===e.offset||e.moveToWordStartInternal(2))}t.moveToWordEndInternal(2,r)}},e.prototype.extendToParagraphStart=function(){i.i(a.isNullOrUndefined)(this.start)||(this.end.paragraphStartInternal(this,!0),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},e.prototype.extendToParagraphEnd=function(){i.i(a.isNullOrUndefined)(this.start)||(this.end.moveToParagraphEndInternal(this,!0),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},e.prototype.moveNextPosition=function(){if(!i.i(a.isNullOrUndefined)(this.start)&&(this.isEmpty&&(this.start.moveNextPosition(),this.end.setPositionInternal(this.start)),this.updateForwardSelection(),this.upDownSelectionLength=this.start.location.x,this.fireSelectionChanged(!0),this.documentHelper.isFormFillProtectedMode)){var e=this.getCurrentFormField();e||(e=this.getFormFieldInFormFillMode(),this.selectPrevNextFormField(!0,e))}},e.prototype.moveToNextParagraph=function(){i.i(a.isNullOrUndefined)(this.start)||(this.end.moveToNextParagraphStartInternal(),this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},e.prototype.nextFootnote=function(){if(this.isinFootnote){var e=this.start.paragraph.bodyWidget.footNoteReference,t=(this.documentHelper.footnoteCollection.length,this.documentHelper.footnoteCollection.indexOf(e)),n=this.documentHelper.footnoteCollection[t+1];i.i(a.isNullOrUndefined)(n)&&(n=e);for(var r=this.start.clone(),o=this.end.clone(),s=0;s<this.documentHelper.pages.length;s++)for(var l=this.documentHelper.pages[s].footnoteWidget,d=1;d<l.bodyWidgets.length;d++){var h=l.bodyWidgets[d].footNoteReference;h===n&&(r.setPositionParagraph(l.bodyWidgets[d].childWidgets[0].childWidgets[0],0),o.setPositionInternal(r),this.selectRange(r,o))}}},e.prototype.previousFootnote=function(){if(this.isinFootnote){var e=this.start.paragraph.bodyWidget.footNoteReference,t=(this.documentHelper.footnoteCollection.length,this.documentHelper.footnoteCollection.indexOf(e)),n=this.documentHelper.footnoteCollection[t-1];i.i(a.isNullOrUndefined)(n)&&(n=e);for(var r=this.start.clone(),o=this.end.clone(),s=0;s<this.documentHelper.pages.length;s++)for(var l=this.documentHelper.pages[s].footnoteWidget,d=1;d<l.bodyWidgets.length;d++){var h=l.bodyWidgets[d].footNoteReference;h===n&&(r.setPositionParagraph(l.bodyWidgets[d].childWidgets[0].childWidgets[0],0),o.setPositionInternal(r),this.selectRange(r,o))}}},e.prototype.nextEndnote=function(){if(this.isinEndnote){var e=this.start.paragraph.bodyWidget.footNoteReference,t=this.documentHelper.endnoteCollection.indexOf(e),n=this.documentHelper.endnoteCollection[t+1];i.i(a.isNullOrUndefined)(n)&&(n=e);for(var r=this.start.clone(),o=this.end.clone(),s=this.documentHelper.pages[this.endPage-1].endnoteWidget,l=0;l<s.childWidgets.length;l++){s.bodyWidgets[l].footNoteReference===n&&(r.setPositionParagraph(s.bodyWidgets[l].childWidgets[0].childWidgets[0],0),o.setPositionInternal(r),this.selectRange(r,o))}}},e.prototype.previousEndnote=function(){if(this.isinEndnote){var e=this.start.paragraph.bodyWidget.footNoteReference,t=this.documentHelper.endnoteCollection.indexOf(e),n=this.documentHelper.endnoteCollection[t-1];i.i(a.isNullOrUndefined)(n)&&(n=e);for(var r=this.start.clone(),o=this.end.clone(),s=this.documentHelper.pages[this.endPage-1].endnoteWidget,l=0;l<s.childWidgets.length;l++){s.bodyWidgets[l].footNoteReference===n&&(r.setPositionParagraph(s.bodyWidgets[l].childWidgets[0].childWidgets[0],0),o.setPositionInternal(r),this.selectRange(r,o))}}},e.prototype.movePreviousPosition=function(){if(!i.i(a.isNullOrUndefined)(this.start)&&(this.isEmpty&&(this.start.movePreviousPosition(),this.end.setPositionInternal(this.start)),this.updateBackwardSelection(),this.upDownSelectionLength=this.start.location.x,this.fireSelectionChanged(!0),this.documentHelper.isFormFillProtectedMode)){var e=this.getCurrentFormField();e||(e=this.getFormFieldInFormFillMode(),this.selectPrevNextFormField(!1,e))}},e.prototype.moveToPreviousParagraph=function(){i.i(a.isNullOrUndefined)(this.start)||(this.end.moveToPreviousParagraph(this),this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},e.prototype.extendToPreviousLine=function(){i.i(a.isNullOrUndefined)(this.start)||(this.end.moveToPreviousLine(this,this.upDownSelectionLength),this.fireSelectionChanged(!0))},e.prototype.extendToLineEnd=function(){i.i(a.isNullOrUndefined)(this.start)||(this.end.moveToLineEndInternal(this,!0),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},e.prototype.extendToLineStart=function(){i.i(a.isNullOrUndefined)(this.start)||(this.end.moveToLineStartInternal(this,!0),this.upDownSelectionLength=this.end.location.x,this.start.paragraph===this.end.paragraph&&this.start.offset===this.start.currentWidget.getEndOffset()&&this.isParagraphLastLine(this.start.currentWidget)&&this.isParagraphFirstLine(this.end.currentWidget)&&this.start.setPositionParagraph(this.start.currentWidget,this.start.offset+1),this.fireSelectionChanged(!0))},e.prototype.moveUp=function(){if(this.documentHelper.isFormFillProtectedMode)return void this.selectPrevNextFormField(!1);if(!i.i(a.isNullOrUndefined)(this.start)){this.isEmpty||(this.isForward?this.end.setPositionInternal(this.start):this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.start.location.x),this.upDownSelectionLength=this.start.location.x;var e=this.start.currentWidget.paragraph.bodyWidget.columnIndex,t=this.start.currentWidget.paragraph.bodyWidget.sectionFormat.numberOfColumns>1,n=this.start.currentWidget.paragraph.bodyWidget.index;this.start.moveUp(this,this.upDownSelectionLength),t=this.start.currentWidget.paragraph.bodyWidget.sectionFormat.numberOfColumns>1;var r=this.start.currentWidget.paragraph.bodyWidget.columnIndex;if(t)if(e===r||n!==this.start.currentWidget.paragraph.bodyWidget.index&&1===this.start.currentWidget.paragraph.bodyWidget.sectionFormat.numberOfColumns)this.end.setPositionInternal(this.start);else do{if(i.i(a.isNullOrUndefined)(this.start.currentWidget.paragraph.previousRenderedWidget)||n!==this.start.currentWidget.paragraph.bodyWidget.index&&1===this.start.currentWidget.paragraph.bodyWidget.sectionFormat.numberOfColumns)break;if(n!==this.start.currentWidget.paragraph.bodyWidget.index&&this.start.currentWidget.paragraph.bodyWidget.sectionFormat.numberOfColumns>1&&e>this.start.currentWidget.paragraph.bodyWidget.columnIndex)break;this.start.moveUp(this,this.upDownSelectionLength)}while(e!==this.start.currentWidget.paragraph.bodyWidget.columnIndex);this.end.setPositionInternal(this.start),this.fireSelectionChanged(!0)}},e.prototype.moveDown=function(){if(this.documentHelper.isFormFillProtectedMode)return void this.selectPrevNextFormField(!0);if(!i.i(a.isNullOrUndefined)(this.start)){this.isEmpty||(this.isForward?this.start.setPositionInternal(this.end):this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.start.location.x),this.upDownSelectionLength=this.start.location.x;var e=this.start.currentWidget.paragraph.bodyWidget.columnIndex,t=this.start.currentWidget.paragraph.bodyWidget.index,n=this.start.currentWidget.paragraph.bodyWidget.sectionFormat.numberOfColumns>1;this.start.moveDown(this,this.upDownSelectionLength);var r=this.start.currentWidget.paragraph.bodyWidget.columnIndex;if(n)if(e===r||t!==this.start.currentWidget.paragraph.bodyWidget.index&&1===this.start.currentWidget.paragraph.bodyWidget.sectionFormat.numberOfColumns)this.end.setPositionInternal(this.start);else do{if(i.i(a.isNullOrUndefined)(this.start.currentWidget.paragraph.nextRenderedWidget)||t!==this.start.currentWidget.paragraph.bodyWidget.index&&1===this.start.currentWidget.paragraph.bodyWidget.sectionFormat.numberOfColumns)break;if(t!==this.start.currentWidget.paragraph.bodyWidget.index&&this.start.currentWidget.paragraph.bodyWidget.sectionFormat.numberOfColumns>1&&this.documentHelper.layout.getBodyWidget(this.start.currentWidget.paragraph.bodyWidget,!1)===this.start.currentWidget.paragraph.bodyWidget)break;this.start.moveDown(this,this.upDownSelectionLength)}while(e!==this.start.currentWidget.paragraph.bodyWidget.columnIndex);this.end.setPositionInternal(this.start),this.fireSelectionChanged(!0)}},e.prototype.updateForwardSelection=function(){this.isEmpty||(this.isForward?this.start.setPositionInternal(this.end):this.end.setPositionInternal(this.start))},e.prototype.updateBackwardSelection=function(){this.isEmpty||(this.isForward?this.end.setPositionInternal(this.start):this.start.setPositionInternal(this.end))},e.prototype.getFirstBlockInFirstCell=function(e){if(e.childWidgets.length>0){var t=e.childWidgets[0];if(t.childWidgets.length>0){var i=t.childWidgets[0];if(0===i.childWidgets.length)return;return i.childWidgets[0]}}},e.prototype.getFirstCellInRegion=function(e,t,n,o){var s=this.getCellLeft(e,t),l=s+t.cellFormat.cellWidth,d=!0;if(s<=n&&n<l)for(var h=0;h<e.childWidgets.length;h++){var c=this.getCellLeft(e,e.childWidgets[h]);if(r.a.round(s,2)<=r.a.round(c,2)&&r.a.round(c,2)<r.a.round(l,2))return d=!1,e.childWidgets[h]}else for(var p=0;p<e.childWidgets.length;p++){var u=this.getCellLeft(e,e.childWidgets[p]);if(u<=n&&u+e.childWidgets[p].cellFormat.cellWidth>n)return d=!1,e.childWidgets[p]}if(d){if(!i.i(a.isNullOrUndefined)(e.previousRenderedWidget)&&o){var g=e.previousRenderedWidget;return this.getFirstCellInRegion(g,t,n,o)}if(!i.i(a.isNullOrUndefined)(e.nextRenderedWidget)&&!o)return this.getFirstCellInRegion(e.nextRenderedWidget,t,n,o)}return e.childWidgets[0]},e.prototype.getFirstParagraph=function(e){for(;e.previousSplitWidget;)e=e.previousSplitWidget;var t=e.firstChild;return this.documentHelper.getFirstParagraphBlock(t)},e.prototype.getLastBlockInLastCell=function(e){if(e.childWidgets.length>0){for(var t=e.childWidgets[e.childWidgets.length-1],n=t.childWidgets[t.childWidgets.length-1];0===n.childWidgets.length&&!i.i(a.isNullOrUndefined)(n.previousSplitWidget);)n=n.previousSplitWidget;return n.childWidgets[n.childWidgets.length-1]}},e.prototype.moveToLineStart=function(){i.i(a.isNullOrUndefined)(this.start)||(this.updateBackwardSelection(),this.start.moveToLineStartInternal(this,!1),this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.start.location.x,this.fireSelectionChanged(!0))},e.prototype.moveToLineEnd=function(){i.i(a.isNullOrUndefined)(this.start)||(this.updateForwardSelection(),this.start.moveToLineEndInternal(this,!1),this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.start.location.x,this.fireSelectionChanged(!0))},e.prototype.getPageTop=function(e){return(e.boundingRectangle.y-this.viewer.pageGap*(this.documentHelper.pages.indexOf(e)+1))*this.documentHelper.zoomFactor+this.viewer.pageGap*(this.documentHelper.pages.indexOf(e)+1)},e.prototype.moveTextPosition=function(e,t,n){if(!i.i(a.isNullOrUndefined)(this.start)){var r=this.documentHelper.getLineWidgetInternal(e,!0);i.i(a.isNullOrUndefined)(r)||this.updateTextPositionWidget(r,e,t,!0),this.upDownSelectionLength=t.location.x;var o=this.start.getHierarchicalIndexInternal(),s=this.end.getHierarchicalIndexInternal();o===s||n||(p.a.isForwardSelection(o,s)?t.validateForwardFieldSelection(o,s):t.validateBackwardFieldSelection(o,s)),this.fireSelectionChanged(!0)}},e.prototype.getDocumentStart=function(){var e=this.documentHelper.pages[0].bodyWidgets[0].childWidgets[0];return this.setPositionForBlock(e,!0)},e.prototype.getDocumentEnd=function(){var e=void 0,t=this.owner.documentStart,r=this.documentHelper.pages[this.documentHelper.pages.length-1];if(!i.i(a.isNullOrUndefined)(t)&&r.bodyWidgets[r.bodyWidgets.length-1].childWidgets.length>0){var o=void 0,s=r.bodyWidgets[r.bodyWidgets.length-1],l=s.childWidgets,d=l.length-1,h=l[d];h instanceof n.C&&(o=h),e=this.setPositionForBlock(o,!1)}return e},e.prototype.handleControlEndKey=function(){var e=void 0;i.i(a.isNullOrUndefined)(this.owner.documentEnd)||(e=this.owner.documentEnd),i.i(a.isNullOrUndefined)(e)||this.owner.selection.selectContent(e,!0),this.owner.enableAutoFocus&&this.checkForCursorVisibility()},e.prototype.handleControlHomeKey=function(){var e=void 0;i.i(a.isNullOrUndefined)(this.owner.documentStart)||(e=this.owner.documentStart),i.i(a.isNullOrUndefined)(e)||this.owner.selection.selectContent(e,!0),this.owner.enableAutoFocus&&this.checkForCursorVisibility()},e.prototype.handleControlLeftKey=function(){this.extendToWordStartInternal(!0),this.checkForCursorVisibility()},e.prototype.handleControlRightKey=function(){this.extendToWordEndInternal(!0),this.checkForCursorVisibility()},e.prototype.handleControlDownKey=function(){this.moveToNextParagraph(),this.checkForCursorVisibility()},e.prototype.handleControlUpKey=function(){this.moveToPreviousParagraph(),this.checkForCursorVisibility()},e.prototype.handleShiftLeftKey=function(){this.extendBackward(),this.checkForCursorVisibility()},e.prototype.handleShiftUpKey=function(){this.extendToPreviousLine(),this.checkForCursorVisibility()},e.prototype.handleShiftRightKey=function(){this.extendForward(),this.checkForCursorVisibility()},e.prototype.handleShiftDownKey=function(){this.extendToNextLine(),this.checkForCursorVisibility()},e.prototype.handleControlShiftLeftKey=function(){(this.isForward?this.start.isCurrentParaBidi:this.end.isCurrentParaBidi)?this.extendToWordEndInternal(!1):this.extendToWordStartInternal(!1),this.checkForCursorVisibility()},e.prototype.handleControlShiftUpKey=function(){this.extendToParagraphStart(),this.checkForCursorVisibility()},e.prototype.handleControlShiftRightKey=function(){(this.isForward?this.start.isCurrentParaBidi:this.end.isCurrentParaBidi)?this.extendToWordStartInternal(!1):this.extendToWordEndInternal(!1),this.checkForCursorVisibility()},e.prototype.handleControlShiftDownKey=function(){this.extendToParagraphEnd(),this.checkForCursorVisibility()},e.prototype.handleLeftKey=function(){this.end.isCurrentParaBidi?this.moveNextPosition():this.movePreviousPosition(),this.owner.enableAutoFocus&&this.checkForCursorVisibility()},e.prototype.handleUpKey=function(){this.isMoveDownOrMoveUp=!0,this.moveUp(),this.isMoveDownOrMoveUp=!1,this.checkForCursorVisibility()},e.prototype.handleRightKey=function(){this.end.isCurrentParaBidi?this.movePreviousPosition():this.moveNextPosition(),this.owner.enableAutoFocus&&this.checkForCursorVisibility()},e.prototype.handleEndKey=function(){this.moveToLineEnd(),this.checkForCursorVisibility()},e.prototype.handleHomeKey=function(){this.moveToLineStart(),this.checkForCursorVisibility()},e.prototype.handleDownKey=function(){this.isMoveDownOrMoveUp=!0,this.moveDown(),this.isMoveDownOrMoveUp=!1,this.checkForCursorVisibility()},e.prototype.handleShiftEndKey=function(){this.extendToLineEnd(),this.checkForCursorVisibility()},e.prototype.handleShiftHomeKey=function(){this.extendToLineStart(),this.checkForCursorVisibility()},e.prototype.handleControlShiftEndKey=function(){var e=void 0;i.i(a.isNullOrUndefined)(this.owner.documentEnd)||(e=this.owner.documentEnd),i.i(a.isNullOrUndefined)(e)||(this.end.setPosition(e.currentWidget,!1),this.fireSelectionChanged(!0)),this.checkForCursorVisibility()},e.prototype.handleControlShiftHomeKey=function(){var e=void 0;i.i(a.isNullOrUndefined)(this.owner.documentStart)||(e=this.owner.documentStart),i.i(a.isNullOrUndefined)(e)||(this.end.setPositionInternal(e),this.fireSelectionChanged(!0)),this.checkForCursorVisibility()},e.prototype.handleSpaceBarKey=function(){this.owner.documentHelper.isDocumentProtected&&"FormFieldsOnly"===this.owner.documentHelper.protectionType&&"CheckBox"===this.getFormFieldType()&&this.owner.editor.toggleCheckBoxFormField(this.getCurrentFormField())},e.prototype.handleTabKey=function(e,t){var n=this.start,o=!1,s=!1;if(!i.i(a.isNullOrUndefined)(n)){if(0===n.offset&&-1==n.paragraph.paragraphFormat.listFormat.listId&&(n.currentWidget.isFirstLine()&&(o=!0),s=!0),n.paragraph.isInsideTable&&this.end.paragraph.isInsideTable&&(e||t))this.owner.documentHelper.isDocumentProtected||"FormFieldsOnly"===this.documentHelper.protectionType||(t?this.selectPreviousCell():this.selectNextCell());else if(!e&&!t||i.i(a.isNullOrUndefined)(n)||n.offset!==this.getStartOffset(n.paragraph)||i.i(a.isNullOrUndefined)(n.paragraph.paragraphFormat)||i.i(a.isNullOrUndefined)(n.paragraph.paragraphFormat.listFormat)||-1===n.paragraph.paragraphFormat.listFormat.listId||this.owner.isReadOnlyMode)this.owner.isReadOnlyMode||this.documentHelper.isFormFillProtectedMode||(o&&n.paragraph.paragraphFormat.firstLineIndent<this.documentHelper.defaultTabWidth?this.documentHelper.owner.editorModule.onApplyParagraphFormat("firstLineIndent",this.documentHelper.defaultTabWidth,!0,!1):s?t?this.owner.editorModule.decreaseIndent():r.a.convertPointToPixel(n.paragraph.paragraphFormat.firstLineIndent+n.paragraph.paragraphFormat.leftIndent)<this.documentHelper.viewer.clientArea.width&&this.owner.editorModule.increaseIndent():this.owner.editorModule.handleTextInput("\t"));else{var l=this.documentHelper.selection,d=n.paragraph,h=!1;l.isForward||(d=l.end.paragraph),h=this.owner.editorModule.isFirstParaForList(l,d),h?t?this.owner.editorModule.updateListLevelIndent(-this.documentHelper.defaultTabWidth,d):this.owner.editorModule.updateListLevelIndent(this.documentHelper.defaultTabWidth,d):this.owner.editorModule.updateListLevel(!t)}"FormFieldsOnly"===this.documentHelper.protectionType&&this.documentHelper.formFields.length>0&&this.selectPrevNextFormField(!t),this.checkForCursorVisibility()}},e.prototype.handlePageUpPageDownKey=function(e,t){var i=this,n=this.end.location.x,r=this.end.location.y,o=this.end.paragraph.bodyWidget.page,s=this.getPageTop(o),a=this.documentHelper.viewerContainer.scrollTop;r=r*this.documentHelper.zoomFactor+(s-a),n=n*this.documentHelper.zoomFactor+o.boundingRectangle.x,e?this.documentHelper.viewerContainer.scrollTop+=this.documentHelper.visibleBounds.height:this.documentHelper.viewerContainer.scrollTop-=this.documentHelper.visibleBounds.height;var l=!1;a===this.documentHelper.viewerContainer.scrollTop&&(l=!0),t&&(this.documentHelper.skipScrollToPosition=!0),setTimeout(function(){if(l)if(t){var o=void 0;o=e?i.getDocumentEnd():i.getDocumentStart(),i.end.setPositionForLineWidget(o.currentWidget,o.offset),i.fireSelectionChanged(!0)}else e?i.moveToDocumentEnd():i.moveToDocumentStart();else i.select({x:n,y:r,extend:t})},0)},e.prototype.getFormFieldInFormFillMode=function(){for(var e,t=this.owner.selection.start,i=this.documentHelper.formFields.length-1;i>=0;i--)if(this.documentHelper.formFields[i].formFieldData.enabled){var n=this.getElementPosition(this.documentHelper.formFields[i]).startPosition;if(n.isExistBefore(t)){e=this.documentHelper.formFields[i];break}0===i&&(e=this.documentHelper.formFields[this.documentHelper.formFields.length-1])}return e},e.prototype.selectPrevNextFormField=function(e,t){if(this.documentHelper.isFormFillProtectedMode){t||(t=this.getCurrentFormField());var i=this.documentHelper.formFields.indexOf(t);if(e)for(var n=i;;n++){n===this.documentHelper.formFields.length-1?n=0:n+=1;{if(this.documentHelper.formFields[n].formFieldData.enabled){this.selectFieldInternal(this.documentHelper.formFields[n],!0);break}n-=1}}else for(var n=i;;n--){0===n?n=this.documentHelper.formFields.length-1:n-=1;{if(this.documentHelper.formFields[n].formFieldData.enabled){this.selectFieldInternal(this.documentHelper.formFields[n],!0);break}n+=1}}}},e.prototype.navigateToNextFormField=function(){for(var e,t=this.owner.selection.end,i=0;i<this.documentHelper.formFields.length;i++)if(e=this.documentHelper.formFields[i],this.documentHelper.formFields[i].formFieldData.enabled){var r=this.getElementPosition(this.documentHelper.formFields[i]).startPosition;if(r.isExistAfter(t)){e.formFieldData instanceof n.l&&"Text"===e.formFieldData.type&&this.documentHelper.isInlineFormFillProtectedMode?this.selectTextElementStartOfField(this.documentHelper.formFields[i]):this.selectFieldInternal(this.documentHelper.formFields[i]);break}i===this.documentHelper.formFields.length-1&&(e=this.documentHelper.formFields[0],e.formFieldData instanceof n.l&&"Text"===e.formFieldData.type&&this.documentHelper.isInlineFormFillProtectedMode?this.selectTextElementStartOfField(this.documentHelper.formFields[0]):this.selectFieldInternal(this.documentHelper.formFields[0]))}},e.prototype.selectTextElementStartOfField=function(e){var t=e.fieldSeparator,i=t.nextElement;if(i){for(;!(i instanceof n.d);)i=i.nextElement;var r=e.line.getOffset(i,0),o=this.getPhysicalPositionInternal(e.line,r,!1);this.selectInternal(e.line,i,0,o)}},e.prototype.triggerFormFillEvent=function(e){var t,r,o=this.previousSelectedFormField,s=this.currentFormField;s!==o&&o&&o.formFieldData instanceof n.l&&"Text"===o.formFieldData.type&&(""===o.formFieldData.format||this.isFormatUpdated||(this.owner.editor.applyFormTextFormat(o),i.i(a.isNullOrUndefined)(this.previousSelectedFormField)||(o=this.previousSelectedFormField)),t={fieldName:o.formFieldData.name,value:this.owner.editorModule.getFieldResultText(o)},this.owner.trigger(d.c,t)),s!==o&&s&&(s.formFieldData instanceof n.l&&"Text"===s.formFieldData.type&&void 0==e||(s.formFieldData instanceof n.l&&"Inline"===this.owner.documentEditorSettings.formFieldSettings.formFillingMode||s.formFieldData instanceof n.m)&&e)&&(r={fieldName:s.formFieldData.name,value:this.owner.editorModule.getFieldResultText(s)},this.owner.trigger(d.b,r))},e.prototype.selectPreviousCell=function(){var e=this.start.paragraph.associatedCell,t=e.ownerRow;t.ownerTable;if(i.i(a.isNullOrUndefined)(e.previousWidget)){if(!i.i(a.isNullOrUndefined)(t.previousRenderedWidget)){var r=void 0;t.previousRenderedWidget instanceof n.z&&(r=t.previousRenderedWidget),this.selectTableCellInternal(r.childWidgets[r.childWidgets.length-1],!0)}}else{var o=void 0;e.previousWidget instanceof n.j&&(o=e.previousWidget),this.selectTableCellInternal(o,!0)}},e.prototype.selectNextCell=function(){var e=this.start.paragraph.associatedCell,t=e.ownerRow;t.ownerTable;if(i.i(a.isNullOrUndefined)(e.nextWidget))if(i.i(a.isNullOrUndefined)(t.nextRenderedWidget)&&!this.owner.isReadOnlyMode)this.owner.editorModule.insertRow(!1);else{var r=void 0;t.nextRenderedWidget instanceof n.z&&(r=t.nextRenderedWidget),this.selectTableCellInternal(r.childWidgets[0],!0)}else{var o=void 0;e.nextRenderedWidget instanceof n.j&&(o=e.nextRenderedWidget),this.selectTableCellInternal(o,!0)}},e.prototype.selectTableCellInternal=function(e,t){var i=this.getFirstParagraph(e),n=this.getLastParagraph(e);if(i===n&&n.isEmpty())this.selectParagraphInternal(n,!0);else{var r=n.childWidgets[0];this.start.setPosition(i.childWidgets[0],!0),this.end.setPositionParagraph(r,r.getEndOffset()),this.fireSelectionChanged(!0)}},e.prototype.selectTableInternal=function(){var e=this.start,t=this.end;if(this.isForward||(e=this.end,t=this.start),!i.i(a.isNullOrUndefined)(e)&&!i.i(a.isNullOrUndefined)(t)&&!i.i(a.isNullOrUndefined)(this.getTable(e,t))){var n=this.getContainerCellOf(e.paragraph.associatedCell,t.paragraph.associatedCell),r=n.ownerTable,o=this.documentHelper.getFirstParagraphBlock(r),s=this.documentHelper.getLastParagraphBlock(r),l=s.lastChild.getEndOffset();this.start.setPosition(o.childWidgets[0],!0),this.end.setPositionParagraph(s.lastChild,l+1)}this.selectPosition(this.start,this.end)},e.prototype.getTableRevision=function(){var e=this.start.clone(),t=this.end.clone();if(this.isForward||(e=this.end.clone(),t=this.start.clone()),!i.i(a.isNullOrUndefined)(e)&&!i.i(a.isNullOrUndefined)(t)&&!i.i(a.isNullOrUndefined)(this.getTable(e,t))){var n=this.getContainerCellOf(e.paragraph.associatedCell,t.paragraph.associatedCell),r=n.ownerTable,o=this.documentHelper.getFirstParagraphBlock(r),s=this.documentHelper.getLastParagraphBlock(r),l=s.lastChild.getEndOffset();e.setPosition(o.childWidgets[0],!0),t.setPositionParagraph(s.lastChild,l+1)}var d=this.getAbsolutePositionFromRelativePosition(e),h=this.getAbsolutePositionFromRelativePosition(t);return Math.abs(h-d)},e.prototype.selectColumnInternal=function(){var e=this.start,t=this.end;if(this.isForward||(e=this.end,t=this.start),!i.i(a.isNullOrUndefined)(e)&&!i.i(a.isNullOrUndefined)(t)&&!i.i(a.isNullOrUndefined)(this.getTable(e,t))){var n=this.getContainerCellOf(e.paragraph.associatedCell,t.paragraph.associatedCell);if(n.ownerTable.contains(t.paragraph.associatedCell)){var r=this.getSelectedCell(e.paragraph.associatedCell,n),o=this.getSelectedCell(t.paragraph.associatedCell,n);if(this.containsCell(n,t.paragraph.associatedCell)){var s=(r.ownerRow,n.ownerTable.getColumnCellsForSelection(n,n));if(s.length>0){var l=this.getFirstParagraph(s[0]),d=this.getLastParagraph(s[s.length-1]);this.start.setPosition(l.firstChild,!0);var h=d.lastChild;this.end.setPositionParagraph(h,h.getEndOffset()+1)}}else{var c=n.ownerTable.getColumnCellsForSelection(r,r),p=n.ownerTable.getColumnCellsForSelection(o,o);if(c.length>0&&p.length>0){var l=this.getFirstParagraph(c[0]),d=this.getLastParagraph(p[p.length-1]);this.start.setPosition(l.firstChild,!0);var h=d.lastChild;this.end.setPositionParagraph(h,h.getEndOffset()+1)}}}}this.selectPosition(this.start,this.end)},e.prototype.selectTableRow=function(){var e=this.start,t=this.end;if(this.isForward||(e=this.end,t=this.start),!i.i(a.isNullOrUndefined)(e)&&!i.i(a.isNullOrUndefined)(t)&&!i.i(a.isNullOrUndefined)(this.getTable(e,t))){var n=void 0;if(n=this.getContainerCellOf(e.paragraph.associatedCell,t.paragraph.associatedCell),n.ownerTable.contains(t.paragraph.associatedCell)){var r=this.getSelectedCell(e.paragraph.associatedCell,n),o=this.getSelectedCell(t.paragraph.associatedCell,n);if(this.containsCell(n,t.paragraph.associatedCell)){var s=r.ownerRow,l=this.getFirstParagraph(s.childWidgets[0]),d=this.getLastParagraph(s.childWidgets[s.childWidgets.length-1]);this.start.setPosition(l.firstChild,!0),this.end.setPositionParagraph(d.lastChild,d.lastChild.getEndOffset()+1)}else{var l=this.getFirstParagraph(r.ownerRow.childWidgets[0]),d=void 0;d=this.getLastParagraph(o.ownerRow.childWidgets[o.ownerRow.childWidgets.length-1]),this.start.setPosition(l.firstChild,!0),this.end.setPositionParagraph(d.lastChild,d.lastChild.getEndOffset()+1)}}}this.selectPosition(this.start,this.end)},e.prototype.selectTableCell=function(){var e=this.start,t=this.end;if(this.isForward||(e=this.end,t=this.start),!i.i(a.isNullOrUndefined)(this.getTable(e,t))){if(this.isEmpty){if(e.paragraph.isInsideTable&&!i.i(a.isNullOrUndefined)(e.paragraph.associatedCell)){var n=this.getFirstParagraph(e.paragraph.associatedCell),r=this.getLastParagraph(t.paragraph.associatedCell);n===r?(this.start.setPosition(r.firstChild,!0),this.end.setPositionParagraph(r.lastChild,r.lastChild.getEndOffset()+1)):(this.start.setPosition(n.firstChild,!0),this.end.setPositionParagraph(r.lastChild,r.lastChild.getEndOffset()+1))}}else{var o=this.getContainerCell(e.paragraph.associatedCell);if(this.containsCell(o,e.paragraph.associatedCell)&&this.containsCell(o,t.paragraph.associatedCell)){var n=this.getFirstParagraph(o),r=this.getLastParagraph(o);i.i(a.isNullOrUndefined)(n)||i.i(a.isNullOrUndefined)(r)||(this.start.setPosition(n.firstChild,!0),this.end.setPositionParagraph(r.lastChild,r.lastChild.getEndOffset()+1))}}this.selectPosition(this.start,this.end)}},e.prototype.selectAll=function(){var e,t;this.documentHelper.skipScrollToPosition=!0;var r=this.getContainerWidget(this.start.paragraph);if(this.owner.enableHeaderAndFooter){var o=this.getContainerWidget(this.start.paragraph);e=this.setPositionForBlock(o.firstChild,!0),t=this.setPositionForBlock(o.lastChild,!1)}else if(this.isInShape){var s=this.getCurrentTextFrame();e=this.setPositionForBlock(s.firstChild,!0),t=this.setPositionForBlock(s.lastChild,!1)}else if(r instanceof n.a&&"Footnote"===r.footNoteType){var l=void 0,d=void 0,h=this.documentHelper.pages.length;for(l=0;l<=h-1;l++)if(!i.i(a.isNullOrUndefined)(this.documentHelper.pages[l].footnoteWidget)){e=this.setPositionForBlock(this.documentHelper.pages[l].footnoteWidget.bodyWidgets[0].firstChild,!0);break}for(d=h-1;d>=0;d--)if(!i.i(a.isNullOrUndefined)(this.documentHelper.pages[d].footnoteWidget)){var c=this.documentHelper.pages[d].footnoteWidget.bodyWidgets.length,p=this.documentHelper.pages[d].footnoteWidget.bodyWidgets[c-1].childWidgets.length;t=this.setPositionForBlock(this.documentHelper.pages[d].footnoteWidget.bodyWidgets[c-1].childWidgets[p-1],!1);break}}else if(r instanceof n.a&&"Endnote"===r.footNoteType){var u=this.getContainerWidget(this.start.paragraph);e=this.setPositionForBlock(u.bodyWidgets[0].firstChild,!0),t=this.setPositionForBlock(u.bodyWidgets[u.bodyWidgets.length-1].firstChild,!1)}else e=this.owner.documentStart,t=this.owner.documentEnd;i.i(a.isNullOrUndefined)(e)||(this.start.setPositionInternal(e),this.end.setPositionParagraph(t.currentWidget,t.offset+1),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},e.prototype.extendBackward=function(){if(!i.i(a.isNullOrUndefined)(this.start)){(this.isForward?this.start.isCurrentParaBidi:this.end.isCurrentParaBidi)?this.end.moveForward():this.end.moveBackward(),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0)}},e.prototype.extendForward=function(){if(!i.i(a.isNullOrUndefined)(this.start)){(this.isForward?this.start.isCurrentParaBidi:this.end.isCurrentParaBidi)?this.end.moveBackward():this.end.moveForward(),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0)}},e.prototype.extendToWordStartEnd=function(){return!(!this.start.paragraph.isInsideTable&&!this.end.paragraph.isInsideTable||this.start.paragraph.associatedCell===this.end.paragraph.associatedCell&&!this.isCellSelected(this.start.paragraph.associatedCell,this.start,this.end))},e.prototype.extendToWordStart=function(){this.extendToWordStartInternal(!1)},e.prototype.extendToWordEnd=function(){this.extendToWordEndInternal(!1)},e.prototype.extendToWordStartInternal=function(e){if(!i.i(a.isNullOrUndefined)(this.start)){this.extendToWordStartEnd()?this.end.moveToPreviousParagraphInTable(this):e&&this.end.isCurrentParaBidi?this.end.moveToWordEndInternal(e?0:1,!1):this.end.moveToWordStartInternal(e?0:1),e&&this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0)}},e.prototype.extendToWordEndInternal=function(e){if(!i.i(a.isNullOrUndefined)(this.start)){this.extendToWordStartEnd()?this.end.moveToNextParagraphInTable():e&&this.end.isCurrentParaBidi?this.end.moveToWordStartInternal(e?0:1):this.end.moveToWordEndInternal(e?0:1,!1),e&&this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0)}},e.prototype.extendToNextLine=function(){i.i(a.isNullOrUndefined)(this.start)||(this.end.moveToNextLine(this.upDownSelectionLength),this.fireSelectionChanged(!0))},e.prototype.getTextPosition=function(e){var t=new p.a(this.owner);return t.setPositionForCurrentIndex(e),t},e.prototype.getText=function(e){if(!(i.i(a.isNullOrUndefined)(this.start)||i.i(a.isNullOrUndefined)(this.end)||i.i(a.isNullOrUndefined)(this.start.paragraph)||i.i(a.isNullOrUndefined)(this.end.paragraph))){var t=this.start,n=this.end;return t.isAtSamePosition(n)?"":this.getTextInternal(t,n,e)}},e.prototype.getTextInternal=function(e,t,r){if(e.isExistAfter(t)){var o=t;t=e,e=o}var s=e,l=t;if(!(i.i(a.isNullOrUndefined)(e)||i.i(a.isNullOrUndefined)(t)||i.i(a.isNullOrUndefined)(e.paragraph)||i.i(a.isNullOrUndefined)(t.paragraph))){var d=0,h=0,c=e.offset,p=t.offset,u=e.currentWidget.getInline(c,d);d=u.index;var g=u.element;if(g instanceof n.b&&!i.i(a.isNullOrUndefined)(g.fieldEnd)){var f=this.getRenderedInline(g,d);g=f.element,d=f.index}var m=t.currentWidget.getInline(p,h),v=m.element;h=m.index;var y="";if(g instanceof n.r&&r&&0===d?y=n.c.objectCharacter:g instanceof n.d&&(y=i.i(a.isNullOrUndefined)(g.text)||""===g.text||g.text.length<d?y:g.text.substring(d)),s.paragraph===l.paragraph)g instanceof n.c&&(g===v&&g instanceof n.d?y=y.length<h-d?y:y.substring(0,h-d):g.nextNode instanceof n.c&&(y+=this.getTextInline(g.nextNode,l.paragraph,v,h,r)));else if(g instanceof n.c&&g.nextNode instanceof n.c)y+=this.getTextInline(g.nextNode,l.paragraph,v,h,r);else{var w=this.documentHelper.selection.getNextParagraphBlock(s.paragraph);for(y+="\r";!i.i(a.isNullOrUndefined)(w)&&w.isEmpty();){if(y+="\r",w===l.paragraph)return y;w=this.documentHelper.selection.getNextParagraphBlock(w)}i.i(a.isNullOrUndefined)(w)||w.isEmpty()||(y+=this.getTextInline(w.childWidgets[0].children[0],l.paragraph,v,h,r))}return p===l.currentWidget.getEndOffset()+1&&(y+="\r"),y}},e.prototype.getHierarchicalIndex=function(e,t){var r;if(e){if(e instanceof n.x){var o=-1!==e.headerFooterType.indexOf("Header")?"H":"F",s=e.page.index.toString(),l=e.page.sectionIndex;r=l+";"+o+";"+s+";"+t}else if(e instanceof n.o&&!i.i(a.isNullOrUndefined)(e.containerWidget)&&e.containerWidget instanceof n.a){var d=e.containerWidget.bodyWidgets.indexOf(e);r=d+";"+t}else r=e.index+";"+t;if(e instanceof n.i){return r="S;"+e.containerShape.line.getOffset(e.containerShape,1)+";"+t,this.getHierarchicalIndex(e.containerShape.paragraph,r)}if(e instanceof n.a){var o="Footnote"===e.footNoteType?"FN":"EN",s=e.page.index.toString(),l=e.page.sectionIndex;r=l+";"+o+";"+s+";"+t}if(e.containerWidget)return e instanceof n.j&&e.rowIndex!==e.containerWidget.index&&(r=e.rowIndex+";"+r,e=e.containerWidget),this.getHierarchicalIndex(e.containerWidget,r)}return r},e.prototype.getHierarchicalIndexByPosition=function(e){var t=this.getParagraphInfo(e);return this.getHierarchicalIndex(t.paragraph,t.offset.toString())},e.prototype.getTextPosBasedOnLogicalIndex=function(e){var t=new p.a(this.owner),i=this.getParagraph({index:e}),n=this.getLineInfoBasedOnParagraph(i.paragraph,i.offset);return t.setPositionForLineWidget(n.line,n.offset),t},e.prototype.getLineInfoBasedOnParagraph=function(e,t){var r=this.getParagraphLength(e),o=e.nextSplitWidget;for(t>r+1&&i.i(a.isNullOrUndefined)(o)&&(t=r);t>r&&o instanceof n.g;)t-=r,e=o,r=this.getParagraphLength(e),o=e.nextSplitWidget;return this.getLineInfo(e,t)},e.prototype.getParagraph=function(e){return{paragraph:this.getParagraphInternal(this.getBodyWidget(e),e),offset:parseInt(e.index,10)}},e.prototype.getBodyWidget=function(e){var t=e.index.indexOf(";"),i=e.index.substring(0,t);e.index=e.index.substring(t).replace(";","");var n=parseInt(i,10);return t=parseInt(i,10),t=e.index.indexOf(";"),"H"===(i=e.index.substring(0,t))||"F"===i?this.getHeaderFooterWidget(e):"FN"===i||"EN"===i?this.getFootNoteWidget(e):(t=parseInt(i,10),this.getBodyWidgetInternal(n,t))},e.prototype.getFootNoteWidget=function(e){var t=e.index.indexOf(";"),i=e.index.substring(0,t);e.index=e.index.substring(t).replace(";","");var n="FN"===i;t=e.index.indexOf(";"),i=e.index.substring(0,t),e.index=e.index.substring(t).replace(";",""),t=parseInt(i,10);var r=this.documentHelper.pages[t];return t=e.index.indexOf(";"),i=e.index.substring(0,t),e.index=e.index.substring(t).replace(";",""),t=parseInt(i,10),n?r.footnoteWidget.bodyWidgets[t]:r.endnoteWidget.bodyWidgets[t]},e.prototype.getHeaderFooterWidget=function(e){var t=e.index.indexOf(";"),n=e.index.substring(0,t);e.index=e.index.substring(t).replace(";","");var r="H"===n;t=e.index.indexOf(";"),n=e.index.substring(0,t),e.index=e.index.substring(t).replace(";",""),t=parseInt(n,10);var o,s=this.documentHelper.pages[t];return o=r?s.headerWidget:s.footerWidget,i.i(a.isNullOrUndefined)(o)||(o.page=s),o},e.prototype.getBodyWidgetInternal=function(e,t){for(var i=0;i<this.documentHelper.pages.length;i++)for(var n=0;n<this.documentHelper.pages[i].bodyWidgets.length;n++){var r=this.documentHelper.pages[i].bodyWidgets[n];if(r.index===e&&r.childWidgets.length>0&&r.firstChild.index<=t&&r.lastChild.index>=t)return r;if(r.index>e)break}},e.prototype.getParagraphInternal=function(e,t){if(!i.i(a.isNullOrUndefined)(t.index)){var r=t.index.indexOf(";"),o="0";r>=0&&(o=t.index.substring(0,r),t.index=t.index.substring(r).replace(";","")),r=parseInt(o,10),e instanceof n.z&&r>=e.childWidgets.length&&(t.index="0;0",r=e.childWidgets.length-1);var s=this.getBlockByIndex(e,r);if(s){if("S"===(o=t.index.substring(0,1))){t.index=t.index.substring(1).replace(";","");var l=t.index.substring(0,t.index.indexOf(";"));t.index=t.index.substring(t.index.indexOf(";")).replace(";","");var d=t.index.substring(0,t.index.indexOf(";"));t.index=t.index.substring(t.index.indexOf(";")).replace(";","");s=s.getInline(parseInt(l),0).element.textFrame.childWidgets[d]}var h=s;if(h instanceof n.g)return t.index.indexOf(";")>0&&(t.index="0"),h;if(h instanceof n.w){if(t.index.indexOf(";")>0)return this.getParagraphInternal(h,t);if(h instanceof n.u)return this.documentHelper.getFirstParagraphInFirstCell(h);return}}else if(e){var c=e.getSplitWidgets().pop().nextRenderedWidget;if(c instanceof n.w)return t.index="0",c instanceof n.u?this.documentHelper.getFirstParagraphInFirstCell(c):c}}},e.prototype.getBlockByIndex=function(e,t){var i;if(e){for(var r=0;r<e.childWidgets.length;r++)if(e.childWidgets[r].index===t){i=e.childWidgets[r];break}if(!(i||e instanceof n.x))return this.getBlockByIndex(e.nextSplitWidget,t)}return i},e.prototype.getParagraphInfo=function(e){return this.getParagraphInfoInternal(e.currentWidget,e.offset)},e.prototype.getCellFromSelection=function(e){var t,i=this.getSelectedCells();if(!this.hasMergedCells()){if(0==e&&i.length>0){if(!(this.selectedWidgets.keys[0]instanceof n.j))return;t=i[0];for(var r=t.rowIndex,o=t.columnIndex,s=t.ownerTable.index,a=0;a<i.length;a++){var l=i[a];l.rowIndex<r&&(r=l.rowIndex),l.columnIndex<o&&(o=l.columnIndex),l.ownerTable.index<s&&(s=l.ownerTable.index)}for(var a=0;a<i.length;a++){var l=i[a];r==l.rowIndex&&o==l.columnIndex&&s==l.ownerTable.index&&(t=l)}}else if(1==e&&i.length>0){if(!(this.selectedWidgets.keys[this.selectedWidgets.length-1]instanceof n.j))return;t=i[i.length-1];for(var r=t.rowIndex,o=t.columnIndex,s=t.ownerTable.index,a=i.length-1;a>=0;a--){var l=i[a];l.rowIndex>r&&(r=l.rowIndex),l.columnIndex>o&&(o=l.columnIndex),l.ownerTable.index>s&&(s=l.ownerTable.index)}for(var a=0;a<i.length;a++){var l=i[a];r==l.rowIndex&&o==l.columnIndex&&s==l.ownerTable.index&&(t=l)}}return t instanceof n.j?t:void 0}},e.prototype.getCellFromSelectionInTable=function(e){for(var t,n=this.getSelectedCells(),r=this.getCellBoundsInfo(),o=[],s=[],l=0;l<n.length;l++){var d=n[l];o.push(d.rowIndex),s.push(d.columnIndex)}o.sort(),s.sort();var h,c;if(1==e){h=r.row.rowLast,c=r.column.colLast;for(var p=!1;!p&&i.i(a.isNullOrUndefined)(t);){for(var l=0;l<n.length;l++){var u=n[l];if(u.rowIndex==h&&u.columnIndex==c){p=!0,t=u;break}}p||(h-=1)}}else if(0==e){h=r.row.rowFirst,c=r.column.colFirst;for(var p=!1;!p&&i.i(a.isNullOrUndefined)(t);){for(var l=0;l<n.length;l++){var g=n[l];if(g.rowIndex==h&&g.columnIndex==c){p=!0,t=g;break}}p||(c+=1)}}return t},e.prototype.getActualOffset=function(e,t){var i;if(0==t){var n=this.getFirstParagraph(e);i=this.getHierarchicalIndex(n,this.getStartOffset(n).toString())}else if(1==t){var n=this.getLastParagraph(e),r=n.lastChild,o=this.getParagraphLength(n,r)+this.getLineLength(r)+1;i=this.getHierarchicalIndex(n,o.toString())}return i},e.prototype.getBookmarkProperties=function(e){var t=this.selectedWidgets.keys;if(0==e.bookmarkType){if(!(t[0]instanceof n.j))return;var r=this.getCellBoundsInfo();if(!i.i(a.isNullOrUndefined)(r))return{columnFirst:r.column.colFirst.toString(),columnLast:r.column.colLast.toString()}}if(1==e.bookmarkType){if(t[t.length-1]instanceof n.j)return;var o={};this.isParagraphMarkSelected()&&(o.isAfterParagraphMark=!0);var s=e.reference,l=this.getSelectedCells();if(s&&!i.i(a.isNullOrUndefined)(s.properties)&&1==l.length&&this.isCellSelected(l[0],this.start,this.end)&&(o.isAfterCellMark=!0,delete o.isAfterParagraphMark),this.isTableSelected()&&(o.isAfterTableMark=!0),this.isRowSelected()&&(o.isAfterRowMark=!0),!i.i(a.isNullOrUndefined)(o.isAfterParagraphMark)||!i.i(a.isNullOrUndefined)(o.isAfterCellMark))return o}},e.prototype.isParagraphMarkSelected=function(){var e,t=this.end.currentWidget;t instanceof n.p&&(e=t.paragraph);var i=this.getParagraphLength(e),r=this.endOffset.split(";");return parseInt(r[r.length-1])>i},e.prototype.isRowSelected=function(){var e=this.start,t=this.end;if(this.isForward||(e=this.end,t=this.start),i.i(a.isNullOrUndefined)(e.paragraph.associatedCell)||i.i(a.isNullOrUndefined)(t.paragraph.associatedCell))return!1;var n,r,o=t.paragraph.associatedCell.ownerRow.getSplitWidgets();if(o[0].childWidgets.length>0){if(r=o[0].childWidgets[0],0===r.childWidgets.length)return;n=r.childWidgets[0]}for(var s,l=o[o.length-1],d=l.childWidgets[l.childWidgets.length-1];0===d.childWidgets.length&&!i.i(a.isNullOrUndefined)(d.previousSplitWidget);)d=d.previousSplitWidget;return s=d.childWidgets[d.childWidgets.length-1],r.equals(n.associatedCell)&&t.paragraph.associatedCell.equals(s.associatedCell)&&(!n.associatedCell.equals(s.associatedCell)||0===e.offset&&t.offset===this.getLineLength(s.lastChild)+1)},e.prototype.getCellBoundsInfo=function(){var e=this.getSelectedCells();if(e.length>0){for(var t=e[0].columnIndex,i=e[e.length-1].columnIndex,n=e[0].rowIndex,r=e[e.length-1].rowIndex,o=0;o<e.length;o++){var s=e[o];s.columnIndex<t&&(t=s.columnIndex),s.columnIndex>i&&(i=s.columnIndex),s.rowIndex<n&&(n=s.rowIndex),s.rowIndex>r&&(r=s.rowIndex)}return{column:{colFirst:t,colLast:i},row:{rowFirst:n,rowLast:r}}}},e.prototype.hasMergedCells=function(){for(var e=this.getSelectedCells(),t=0;t<e.length;t++){var i=e[t];if(i.cellFormat.rowSpan>1||i.cellFormat.columnSpan>1)return!0}return!1},e.prototype.getParagraphInfoInternal=function(e,t){for(var i=e.paragraph,r=this.getParagraphLength(i,e)+t,o=i.previousSplitWidget;o instanceof n.g;)i=o,r+=this.documentHelper.selection.getParagraphLength(i),o=i.previousSplitWidget;return{paragraph:i,offset:r}},e.prototype.getListTextElementBox=function(e){if(!i.i(a.isNullOrUndefined)(e)){var t;if(!e.isEmpty()){var r=e.childWidgets[0];r.children.length>1&&r.children[0]instanceof n.q&&(t=r.children[0])}return t}},e.prototype.getListLevel=function(e){var t=void 0,n=0;if(i.i(a.isNullOrUndefined)(e.paragraphFormat)||i.i(a.isNullOrUndefined)(e.paragraphFormat.listFormat)||(t=this.documentHelper.getListById(e.paragraphFormat.listFormat.listId),n=e.paragraphFormat.listFormat.listLevelNumber),!i.i(a.isNullOrUndefined)(t)&&!i.i(a.isNullOrUndefined)(this.documentHelper.getAbstractListById(t.abstractListId))&&!i.i(a.isNullOrUndefined)(this.documentHelper.getAbstractListById(t.abstractListId).levels))return this.documentHelper.layout.getListLevel(t,n)},e.prototype.getTextInline=function(e,t,r,o,s){var l="";do{if(e===r){if(e instanceof n.d){var d=e;i.i(a.isNullOrUndefined)(d.text)||""===d.text||(d.text.length<o?l+=d.text:l+=d.text.substring(0,o))}else e instanceof n.r&&s&&o===e.length&&(l+=n.c.objectCharacter);return l}if(e instanceof n.d?l+=e.text:e instanceof n.r&&s?l+=n.c.objectCharacter:e instanceof n.b&&!i.i(a.isNullOrUndefined)(e.fieldEnd)&&(e=i.i(a.isNullOrUndefined)(e.fieldSeparator)?e.fieldEnd:e.fieldSeparator),i.i(a.isNullOrUndefined)(e.nextNode))break;e=e.nextNode}while(!i.i(a.isNullOrUndefined)(e));if(t===e.line.paragraph)return l;for(var h=this.documentHelper.selection.getNextParagraphBlock(e.line.paragraph);!i.i(a.isNullOrUndefined)(h)&&h.isEmpty();){if(l+="\r",h===t)return l;h=this.documentHelper.selection.getNextParagraphBlock(h)}if(!i.i(a.isNullOrUndefined)(h)&&!h.isEmpty()){var c=h.childWidgets[0];l=l+"\r"+this.getTextInline(c.children[0],t,r,o,s)}return l},e.prototype.getFieldCode=function(e,t){var r="";if(!(i.i(a.isNullOrUndefined)(e)||e.fieldEnd instanceof n.b))return r;var o=e.paragraph,s=e.fieldEnd.paragraph;e.fieldSeparator instanceof n.b&&(s=e.fieldSeparator.paragraph);var l=e.line.indexInOwner,d=e.indexInOwner;do{if(r+=this.getFieldCodeInternal(o,l,d),o===s)break;o=this.getNextParagraphBlock(o),l=0,d=0}while(o instanceof n.g);return t?r:r.trim()},e.prototype.getFieldCodeInternal=function(e,t,i){for(var r="",o=t;o<e.childWidgets.length;o++){for(var s=e.childWidgets[o],a=i;a<s.children.length;a++){var l=s.children[a];if(l instanceof n.d&&(r+=l.text),l instanceof n.b&&(2===l.fieldType||1===l.fieldType))return r}i=0}return r},e.prototype.getTocFieldInternal=function(){var e=this.start.paragraph;for(this.isEmpty||this.isForward||(e=this.end.paragraph);e instanceof n.g&&e.childWidgets.length>0;){var t=e.firstChild;if(t.children.length>0){var i=t.children[0],r=i.nextNode;if(i instanceof n.b&&0===i.fieldType&&r instanceof n.d&&0===r.text.trim().toLowerCase().indexOf("toc"))return i}e=e.previousRenderedWidget}},e.prototype.getNextParagraph=function(e){if(e.nextRenderedWidget instanceof n.o){var t=e.nextRenderedWidget.childWidgets[0];return this.documentHelper.getFirstParagraphBlock(t)}},e.prototype.getPreviousParagraph=function(e){if(e.previousRenderedWidget instanceof n.o){var t=e.previousRenderedWidget,i=t.childWidgets[t.childWidgets.length-1];return this.documentHelper.getLastParagraphBlock(i)}},e.prototype.getNextStartInline=function(e,t){var r=0,o=e.getInline(t,r),s=o.element;if(r=o.index,!i.i(a.isNullOrUndefined)(s)&&r===s.length&&s.nextNode instanceof n.b||s instanceof n.s){var l=this.getNextValidElement(s.nextNode);l instanceof n.b&&0===l.fieldType&&(s=l)}return s},e.prototype.getPreviousTextInline=function(e){return e.previousNode instanceof n.d?e.previousNode:e.previousNode instanceof n.b&&r.a.isLinkedFieldCharacter(e.previousNode)?0===e.previousNode.fieldType||1===e.previousNode.fieldType?e.previousNode:e.previousNode.fieldBegin:i.i(a.isNullOrUndefined)(e.previousNode)?void 0:this.getPreviousTextInline(e.previousNode)},e.prototype.getNextTextInline=function(e){return e.nextNode instanceof n.d?e.nextNode:e.nextNode instanceof n.b&&r.a.isLinkedFieldCharacter(e.nextNode)?1===e.nextNode.fieldType||0===e.nextNode.fieldType?e.nextNode:e.nextNode.fieldEnd:i.i(a.isNullOrUndefined)(e.nextNode)?void 0:this.getNextTextInline(e.nextNode)},e.prototype.getContainerTable=function(e){if(e.isInsideTable&&(e=e.associatedCell.ownerTable.isInsideTable?this.getContainerTable(e.associatedCell.ownerTable):e.associatedCell.ownerTable),e instanceof n.u)return e},e.prototype.isElementInSelection=function(e,t){var i=e.line.getOffset(e,t?0:1),n=new p.a(this.owner);n.setPositionParagraph(e.line,i);var r=this.start,o=this.end;return this.isForward||(r=this.end,o=this.start),(n.isExistAfter(r)||n.isAtSamePosition(r))&&(n.isExistBefore(o)||n.isAtSamePosition(o))},e.prototype.isSelectionInsideElement=function(e){if(this.isEmpty){var t=e.line.getOffset(e,0),i=new p.a(this.owner);i.setPositionParagraph(e.line,t);var n=e.line.getOffset(e,e.length),r=new p.a(this.owner);return r.setPositionParagraph(e.line,n),(this.start.isExistAfter(i)||this.start.isAtSamePosition(i))&&(this.start.isExistBefore(r)||this.start.isAtSamePosition(r))}return!1},e.prototype.isExistBefore=function(e,t){if(e.isInsideTable){var i=e.associatedCell;if(t.isInsideTable){var r=t.associatedCell;if(i===r)return i.childWidgets.indexOf(e)<i.childWidgets.indexOf(t);if(i.ownerRow===r.ownerRow)return i.cellIndex<r.cellIndex;if(i.ownerTable===r.ownerTable)return i.ownerRow.rowIndex<r.ownerRow.rowIndex;var o=this.getContainerCellOf(i,r);return o.ownerTable.contains(r)?(i=this.getSelectedCell(i,o),r=this.getSelectedCell(r,o),i===o?this.isExistBefore(e,r.ownerTable):r===o?this.isExistBefore(i.ownerTable,t):o.ownerRow===r.ownerRow?o.cellIndex<r.cellIndex:o.ownerTable===r.ownerTable?o.ownerRow.rowIndex<r.ownerRow.rowIndex:this.isExistBefore(i.ownerTable,r.ownerTable)):this.isExistBefore(o.ownerTable,this.getContainerTable(r.ownerTable))}var s=this.getContainerTable(e);return this.isExistBefore(s,t)}if(t.isInsideTable){var s=this.getContainerTable(t);return this.isExistBefore(e,s)}if(e.containerWidget===t.containerWidget)return e.index<t.index;if(e.containerWidget instanceof n.o&&t.containerWidget instanceof n.o){var a=this.documentHelper.pages.indexOf(e.containerWidget.page),l=this.documentHelper.pages.indexOf(t.containerWidget.page);if(a===l)return e.containerWidget.indexInOwner<t.containerWidget.indexInOwner;if(a===l&&e.containerWidget.containerWidget instanceof n.a&&t.containerWidget.containerWidget instanceof n.a){var d=this.documentHelper.pages[a].footnoteWidget.bodyWidgets.indexOf(e.containerWidget),h=this.documentHelper.pages[l].footnoteWidget.bodyWidgets.indexOf(t.containerWidget);return d<h}if(a===l&&e.containerWidget.index!==t.containerWidget.index){var d=this.documentHelper.pages[a].bodyWidgets.indexOf(e.containerWidget),h=this.documentHelper.pages[l].bodyWidgets.indexOf(t.containerWidget);return d<h}return a<l}return!1},e.prototype.isExistAfter=function(e,t){if(e.isInsideTable){var i=e.associatedCell;if(t.isInsideTable){var r=t.associatedCell;if(i===r)return i.childWidgets.indexOf(e)>i.childWidgets.indexOf(t);if(i.ownerRow===r.ownerRow)return i.cellIndex>r.cellIndex;if(i.ownerTable===r.ownerTable)return i.ownerRow.rowIndex>r.ownerRow.rowIndex;var o=this.getContainerCellOf(i,r);return o.ownerTable.contains(r)?(i=this.getSelectedCell(i,o),r=this.getSelectedCell(r,o),i===o?this.isExistAfter(e,r.ownerTable):r===o?this.isExistAfter(i.ownerTable,t):o.ownerRow===r.ownerRow?o.cellIndex>r.cellIndex:o.ownerTable===r.ownerTable?o.ownerRow.rowIndex>r.ownerRow.rowIndex:this.isExistAfter(i.ownerTable,r.ownerTable)):this.isExistAfter(o.ownerTable,this.getContainerTable(r.ownerTable))}var s=this.getContainerTable(e);return this.isExistAfter(s,t)}if(t.isInsideTable){var s=this.getContainerTable(t);return this.isExistAfter(e,s)}if(e.containerWidget===t.containerWidget)return e.index>t.index;if(e.containerWidget instanceof n.o&&t.containerWidget instanceof n.o||e.containerWidget instanceof n.a&&t.containerWidget instanceof n.a){return this.documentHelper.pages.indexOf(e.containerWidget.page)>this.documentHelper.pages.indexOf(t.containerWidget.page)}return!1},e.prototype.isExistBeforeInline=function(e,t){if(e.line===t.line)return e.line.children.indexOf(e)<=t.line.children.indexOf(t);if(e.line.paragraph===t.line.paragraph)return e.line.paragraph.childWidgets.indexOf(e.line)<t.line.paragraph.childWidgets.indexOf(t.line);var i=e.line.paragraph,r=t.line.paragraph;if(i.containerWidget===r.containerWidget){if(i.isInsideTable)return i.associatedCell.childWidgets.indexOf(i)<r.associatedCell.childWidgets.indexOf(r);if(!(i.containerWidget instanceof n.x))return i.containerWidget.childWidgets.indexOf(i)<r.containerWidget.childWidgets.indexOf(r)}return this.isExistBefore(i,r)},e.prototype.isExistAfterInline=function(e,t,i){if(e.line===t.line){var r=this.documentHelper.selection;return i?e.line.children.indexOf(e)>=t.line.children.indexOf(t):e===t&&r.start.offset!==r.end.offset?e.line.children.indexOf(e)===t.line.children.indexOf(t):e.line.children.indexOf(e)>t.line.children.indexOf(t)}if(e.line.paragraph===t.line.paragraph)return e.line.paragraph.childWidgets.indexOf(e.line)>t.line.paragraph.childWidgets.indexOf(t.line);var o=e.line.paragraph,s=t.line.paragraph;if(o.containerWidget===s.containerWidget){if(o.isInsideTable)return o.associatedCell.childWidgets.indexOf(o)>s.associatedCell.childWidgets.indexOf(s);if(!(o.containerWidget instanceof n.x))return o.containerWidget.childWidgets.indexOf(o)>s.containerWidget.childWidgets.indexOf(s)}return this.isExistAfter(o,s)},e.prototype.getNextRenderedBlock=function(e){return i.i(a.isNullOrUndefined)(e.nextWidget)?e.nextRenderedWidget:e.nextWidget},e.prototype.getPreviousRenderedBlock=function(e){return i.i(a.isNullOrUndefined)(e.previousWidget)?e.previousRenderedWidget:e.previousWidget},e.prototype.getNextParagraphBlock=function(e){if(e.nextRenderedWidget instanceof n.g)return e.nextRenderedWidget;if(e.nextRenderedWidget instanceof n.u)return this.documentHelper.getFirstParagraphInFirstCell(e.nextRenderedWidget);if(e.containerWidget instanceof n.j)return this.getNextParagraphCell(e.containerWidget);if(e.containerWidget instanceof n.o){e.containerWidget;return this.getNextParagraph(e.containerWidget)}return e.containerWidget instanceof n.x&&this.isMoveDownOrMoveUp?this.getFirstBlockInNextHeaderFooter(e):void 0},e.prototype.getFirstBlockInNextHeaderFooter=function(e){var t,i=e.containerWidget;if(-1!==i.headerFooterType.indexOf("Header"))t=i.page.footerWidget.firstChild;else{if(!i.page.nextPage)return;var r=i.page.nextPage,o=r.headerWidget;o.page=r,r.footerWidget&&(r.footerWidget.page=r),t=o.firstChild}return t instanceof n.g?t:this.getFirstBlockInFirstCell(t)},e.prototype.getLastBlockInPreviousHeaderFooter=function(e){var t,i=e.containerWidget;if(-1!==i.headerFooterType.indexOf("Footer"))t=i.page.headerWidget.lastChild;else{if(!i.page.previousPage)return;var r=i.page.previousPage,o=r.footerWidget;o.page=r,r.headerWidget&&(r.headerWidget.page=r),t=o.lastChild}return t instanceof n.g?t:this.getFirstBlockInFirstCell(t)},e.prototype.getPreviousParagraphBlock=function(e,t){return e.previousRenderedWidget instanceof n.g?e.previousRenderedWidget:e.previousRenderedWidget instanceof n.u?this.documentHelper.getLastParagraphInLastCell(e.previousRenderedWidget):e.containerWidget instanceof n.j?this.getPreviousParagraphCell(e.containerWidget):e.containerWidget instanceof n.o?this.getPreviousParagraph(e.containerWidget):e.containerWidget instanceof n.x&&this.isMoveDownOrMoveUp&&!t?this.getLastBlockInPreviousHeaderFooter(e):void 0},e.prototype.hasValidInline=function(e,t,i){for(var o=e.childWidgets.indexOf(t.line),s=o;s<e.childWidgets.length;s++)for(var a=0;a<e.childWidgets[s].children.length;a++){var l=e.childWidgets[s].children[a];if(0!==l.length){if(l===i)return!1;if(l instanceof n.d||l instanceof n.r||l instanceof n.b&&r.a.isLinkedFieldCharacter(l))return!0}}return!1},e.prototype.getParagraphLength=function(e,t,r,o){var s=0;if(!i.i(a.isNullOrUndefined)(e))for(var l=0;l<e.childWidgets.length;l++){var d=e.childWidgets[l];if(t instanceof n.p&&t===d){r&&(s+=this.getLineLength(d,r,o));break}s+=this.getLineLength(d,void 0,o)}return s},e.prototype.getLineLength=function(e,t,i){for(var r=0,o=e.paragraph.bidi,s=o?e.children.length-1:0;o?s>-1:s<e.children.length;o?s--:s++){var a=e.children[s];if(!(a instanceof n.q)){if(i)if(a instanceof n.s)for(var l=0;l<a.textFrame.childWidgets.length;l++){var d=a.textFrame.childWidgets[l];r+=this.getParagraphLength(d)+1}else if(a instanceof n.f)for(var l=0;l<a.bodyWidget.childWidgets.length;l++){var d=a.bodyWidget.childWidgets[l];r+=this.getParagraphLength(d)+1}if(t&&t.element instanceof n.c&&t.element===a){r+=t.index;break}r+=a.length}}return r},e.prototype.getLineInfo=function(e,t){for(var i=void 0,n=0,r=e.childWidgets.length,o=0;o<r&&(i=e.childWidgets[o],n=this.getLineLength(i),!(t<=n||o===r-1));o++)t-=n;return{line:i,offset:t}},e.prototype.getElementInfo=function(e,t){for(var r=void 0,o=0;o<e.children.length;o++)if(!((r=e.children[o])instanceof n.q)){if(!(t>r.length)||t===r.length+1&&i.i(a.isNullOrUndefined)(r.nextNode))break;t-=r.length}return{element:r,index:t}},e.prototype.getStartOffset=function(e){if(e.childWidgets.length>0){var t=e.childWidgets[0];return this.getStartLineOffset(t)}return 0},e.prototype.getStartLineOffset=function(e){for(var t=0,i=0;i<e.children.length;i++){var o=e.children[i];if(0!==o.length){if(o instanceof n.d||o instanceof n.r||o instanceof n.e||o instanceof n.s||o instanceof n.G||o instanceof n.F||o instanceof n.B||o instanceof n.b&&r.a.isLinkedFieldCharacter(o)||o instanceof n.H)return t;o instanceof n.q||(t+=o.length)}}return t},e.prototype.getPreviousSelectionCell=function(e){if(!i.i(a.isNullOrUndefined)(e.previousRenderedWidget)){if(this.isForward){var t=e.previousRenderedWidget.childWidgets,r=t[t.length-1];return r instanceof n.g?r:this.getPreviousParagraphSelection(r.childWidgets[r.childWidgets.length-1])}var r=e.previousRenderedWidget.childWidgets[0];return r instanceof n.g?r:this.documentHelper.getFirstParagraphInLastRow(r)}return this.getPreviousSelectionRow(e.ownerRow)},e.prototype.getPreviousSelectionRow=function(e){if(!i.i(a.isNullOrUndefined)(e.previousRenderedWidget)){if(this.isForward)return this.getPreviousParagraphSelection(e.previousRenderedWidget);var t=e.previousRenderedWidget.childWidgets[0],n=t.childWidgets[0];return this.documentHelper.getFirstParagraphBlock(n)}return this.getPreviousSelectionBlock(e.ownerTable)},e.prototype.getNextSelectionBlock=function(e){return e.nextRenderedWidget instanceof n.g?e.nextRenderedWidget:e.nextRenderedWidget instanceof n.u?this.isEmpty||this.isForward?this.documentHelper.getLastParagraphInFirstRow(e.nextRenderedWidget):this.getNextParagraphSelection(e.nextRenderedWidget.childWidgets[0]):e.containerWidget instanceof n.j?this.getNextSelectionCell(e.containerWidget):e.containerWidget instanceof n.o?this.getNextSelection(e.containerWidget):void 0},e.prototype.getNextSelectionCell=function(e){if(!i.i(a.isNullOrUndefined)(e.nextRenderedWidget)){if(this.isEmpty||this.isForward){var t=e.nextRenderedWidget.childWidgets[e.nextRenderedWidget.childWidgets.length-1];return this.documentHelper.getLastParagraphBlock(t)}var t=e.nextRenderedWidget.childWidgets[0];return t instanceof n.g?t:this.getNextParagraphSelection(t.childWidgets[0])}return this.getNextSelectionRow(e.ownerRow)},e.prototype.getNextSelectionRow=function(e){if(!i.i(a.isNullOrUndefined)(e.nextRenderedWidget)){if(this.isEmpty||this.isForward){var t=e.nextRenderedWidget.childWidgets[e.nextRenderedWidget.childWidgets.length-1],n=t.childWidgets[t.childWidgets.length-1];return this.documentHelper.getLastParagraphBlock(n)}return this.getNextParagraphSelection(e.nextRenderedWidget)}return this.getNextSelectionBlock(e.ownerTable)},e.prototype.getNextSelection=function(e){if(e.nextRenderedWidget instanceof n.o){var t=e.nextRenderedWidget.childWidgets[0];return t instanceof n.g?t:this.isEmpty||this.isForward?this.documentHelper.getLastParagraphInFirstRow(t):this.getNextParagraphSelection(t.childWidgets[0])}},e.prototype.getNextParagraphSelection=function(e){var t=e.childWidgets[0];if(this.start.paragraph.isInsideTable&&e.ownerTable.contains(this.start.paragraph.associatedCell)){var i=this.getCellInTable(e.ownerTable,this.start.paragraph.associatedCell);t=this.getFirstCellInRegion(e,i,this.upDownSelectionLength,!1)}var n=t.childWidgets[0];return this.documentHelper.getFirstParagraphBlock(n)},e.prototype.getPreviousSelectionBlock=function(e){return e.previousRenderedWidget instanceof n.g?e.previousRenderedWidget:e.previousRenderedWidget instanceof n.u?this.isForward?this.getPreviousParagraphSelection(e.previousRenderedWidget.childWidgets[e.previousRenderedWidget.childWidgets.length-1]):this.documentHelper.getFirstParagraphInLastRow(e.previousRenderedWidget):e.containerWidget instanceof n.j?this.getPreviousSelectionCell(e.containerWidget):e.containerWidget instanceof n.o?this.getPreviousSelection(e.containerWidget):void 0},e.prototype.getPreviousSelection=function(e){if(e.previousRenderedWidget instanceof n.o){var t=e.previousRenderedWidget,i=t.childWidgets[t.childWidgets.length-1];if(i instanceof n.g)return i;if(this.isForward){var r=i;return this.getPreviousParagraphSelection(r.childWidgets[r.childWidgets.length-1])}return this.documentHelper.getFirstParagraphInLastRow(i)}},e.prototype.getPreviousParagraphSelection=function(e){var t=e.childWidgets[e.childWidgets.length-1];if(this.start.paragraph.isInsideTable&&e.ownerTable.contains(this.start.paragraph.associatedCell)){var i=this.getCellInTable(e.ownerTable,this.start.paragraph.associatedCell);t=this.getLastCellInRegion(e,i,this.upDownSelectionLength,!0)}var n=t.childWidgets[t.childWidgets.length-1];return this.documentHelper.getLastParagraphBlock(n)},e.prototype.getLastCellInRegion=function(e,t,n,o){var s=this.getCellLeft(e,t),l=s+t.cellFormat.cellWidth,d=!0;if(s<=n&&n<l)for(var h=e.childWidgets.length-1;h>=0;h--){var c=this.getCellLeft(e,e.childWidgets[h]);if(r.a.round(s,2)<=r.a.round(c,2)&&r.a.round(c,2)<r.a.round(l,2))return d=!1,e.childWidgets[h]}else for(var h=e.childWidgets.length-1;h>=0;h--){var c=this.getCellLeft(e,e.childWidgets[h]);if(c<=n&&c+e.childWidgets[h].cellFormat.cellWidth>n)return d=!1,e.childWidgets[h]}if(d){if(!i.i(a.isNullOrUndefined)(e.previousRenderedWidget)&&o)return this.getLastCellInRegion(e.previousRenderedWidget,t,n,o);if(!i.i(a.isNullOrUndefined)(e.nextRenderedWidget)&&!o)return this.getLastCellInRegion(e.nextRenderedWidget,t,n,o)}return e.childWidgets[e.childWidgets.length-1]},e.prototype.getCellInTable=function(e,t){for(;t.ownerTable.isInsideTable;){if(e.equals(t.ownerTable))return t;t=t.ownerTable.associatedCell}return t},e.prototype.getPreviousValidOffset=function(e,t){if(0===t)return 0;for(var i=0,o=0,s=(e.paragraphFormat.bidi,0);s<e.childWidgets.length;s++)for(var a=e.childWidgets[s],l=0;l<a.children.length;l++){var d=a.children[l];if(!(0===d.length||d instanceof n.q)){if(t<=o+d.length)return t-1===o?i:t-1;(d instanceof n.d||d instanceof n.r||d instanceof n.e||d instanceof n.b&&r.a.isLinkedFieldCharacter(d))&&(i=o+d.length),o+=d.length}}return t-1===o?i:t-1},e.prototype.getNextValidOffset=function(e,t){for(var i=0,o=0;o<e.children.length;o++){var s=e.children[o];if(!(0===s.length||s instanceof n.q)){if(t<i+s.length&&(s instanceof n.d||s instanceof n.r||s instanceof n.b&&r.a.isLinkedFieldCharacter(s)))return(t>i?t:i)+1;if(t===i+s.length&&s instanceof n.b&&1===s.fieldType&&s.previousNode instanceof n.r)return t;i+=s.length}}return t},e.prototype.getParagraphMarkSize=function(e,t,i){var r=this.documentHelper.textHelper.getParagraphMarkSize(e.characterFormat),o=r.BaselineOffset,s=r.Height,a=o;if(e instanceof n.g){if(e.childWidgets.length>0){e.childWidgets[0]}var l=this.documentHelper.layout.getLineSpacing(e,s),d=this.documentHelper.layout.getBeforeSpacing(e);t=a-o,i=s-a-(r.Height-o);var h=e.paragraphFormat.lineSpacingType;"Multiple"===h?l>s?i+=l-s:t+=l-s:"Exactly"===h?t+=l-(t+r.Height+i):l>t+r.Height+i&&(t+=l-(t+r.Height+i)),t+=d,i+=this.documentHelper.layout.getAfterSpacing(e)}return{width:r.Width,height:r.Height,topMargin:t,bottomMargin:i}},e.prototype.getPhysicalPositionInternal=function(e,t,i){if(e.paragraph.isEmpty()){var n=e.paragraph,o=n.x;if(n.childWidgets.length>0){var s=n.childWidgets[0];o=this.getLeft(s)}var a=this.getParagraphMarkSize(e.paragraph,0,0);return(t>0||0===t&&n.isEmpty()&&n.bidi)&&(o+=a.width),new r.b(o,n.y+a.topMargin)}var l=0,d=e.getInline(t,l,e.paragraph.bidi),h=d.element;return l=d.index,this.getPhysicalPositionInline(h,l,i)},e.prototype.highlightSelectedContent=function(e,t){if(e.paragraph.isInsideTable&&(!t.paragraph.isInsideTable||!e.paragraph.associatedCell.equals(t.paragraph.associatedCell)||!this.documentHelper.isSelectionChangedOnMouseMoved&&this.isCellSelected(e.paragraph.associatedCell,e,t)||this.isCellPrevSelected))this.highlightCell(e.paragraph.associatedCell,this,e,t),this.isCellPrevSelected=!0;else{var r=void 0,o=0;if(!this.owner.isReadOnlyMode&&e.paragraph===t.paragraph)if(e.offset+1===t.offset){var s=t.currentWidget.getInline(t.offset,o);if(r=s.element,o=s.index,r instanceof n.r||r instanceof n.s){var l=e.currentWidget.getOffset(r,0);l!==e.offset&&(r=void 0)}}else{var d=0,h=e.currentWidget.getInline(e.offset,d),c=h.element;d=h.index,d===c.length&&(c=this.getNextRenderedElementBox(c,d));var p=t.currentWidget.getInline(t.offset,d),u=p.element;if(d=p.index,c instanceof n.b&&u instanceof n.b&&!i.i(a.isNullOrUndefined)(c.fieldSeparator)){var g=c.fieldSeparator.nextNode;g instanceof n.r&&g.nextNode===u&&(r=g)}}if(!this.owner.isReadOnlyMode&&this.owner.isDocumentLoaded&&(r instanceof n.r||r instanceof n.s)){var f=this.getElementBoxInternal(r,o),m=f.element;o=f.index,this.owner.enableImageResizerMode&&(this.owner.imageResizerModule.positionImageResizer(m),this.owner.imageResizerModule.showImageResizer()),this.documentHelper.isTouchInput&&(this.documentHelper.touchStart.style.display="none",this.documentHelper.touchEnd.style.display="none")}else e.paragraph.isInsideTable&&e.paragraph.associatedCell.equals(t.paragraph.associatedCell)&&t.paragraph.equals(this.getLastParagraph(t.paragraph.associatedCell))&&this.getParagraphLength(t.paragraph)+1==t.offset&&t.offset--,this.highlight(e.paragraph,e,t),this.isHighlightNext&&(this.highlightNextBlock(this.hightLightNextParagraph,e,t),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0);this.isInShape&&this.showResizerForShape()}},e.prototype.showResizerForShape=function(){var e=this.getCurrentTextFrame().containerShape;this.owner.imageResizerModule.positionImageResizer(e),this.owner.imageResizerModule.showImageResizer()},e.prototype.highlight=function(e,t,r){var o=0,s=0,l=void 0,d=void 0,h=void 0,c=void 0,p=this.getStartLineWidget(e,t,l,o);l=p.element,h=i.i(a.isNullOrUndefined)(l)?e.childWidgets[0]:l.line,o=p.index;var u=this.getEndLineWidget(r,d,s);d=u.element,c=d?d.line:r.paragraph.childWidgets[r.paragraph.childWidgets.length-1],s=u.index;var g=0,f=0;if(i.i(a.isNullOrUndefined)(h)||(g=this.getTop(h),f=this.getLeftInternal(h,l,o)),i.i(a.isNullOrUndefined)(h)||h!==c){if(!i.i(a.isNullOrUndefined)(h)){h.paragraph.x;e!==h.paragraph&&(e=h.paragraph);var m=this.getWidth(h,!0)-(f-h.paragraph.x);if(e.bidi||l instanceof n.d&&l.isRightToLeft){var v=0,y=this.getElementsForward(h,l,d,e.bidi);if(y){for(var w=!1,b=0;b<y.length;b++){var x=y[b];w=!1,f=x===l?this.getLeftInternal(h,x,o):this.getLeftInternal(h,x,0);var C=x instanceof n.d?x.length:1;v=this.getLeftInternal(h,x,C),x instanceof n.d&&(w=x.isRightToLeft),m=Math.abs(v-f),this.createHighlightBorder(h,m,w?v:f,g,!0)}if(h.isLastLine()){var I=y[y.length-1].line.paragraph.characterFormat,F=this.documentHelper.textHelper.getParagraphMarkSize(I).Width;f=e.bidi?this.getLineStartLeft(h)-F:w?h.paragraph.x+this.getWidth(h,!1):v,this.createHighlightBorder(h,F,f,g,!0)}}else this.createHighlightBorder(h,m,f,g,!1)}else this.createHighlightBorder(h,m,f,g,!1);var k=h.paragraph.childWidgets.indexOf(h);if(this.highlightParagraph(e,k+1,c,d,s),-1!==e.childWidgets.indexOf(r.currentWidget))return}if(this.isHideSelection(e))return void(this.isHighlightNext=!1);this.isHighlightNext=!0,this.hightLightNextParagraph=e}else{var v=this.getLeftInternal(c,d,s),m=0,P=!1;if(d instanceof n.d&&(P=d.isRightToLeft),!P&&l instanceof n.d&&(P=l.isRightToLeft),m=Math.abs(v-f),P||e.bidi){var T=this.getElementsForward(h,l,d,e.bidi);if(T&&T.length>1)for(var b=0;b<T.length;b++){var x=T[b],w=!1,C=x instanceof n.d?x.length:1;if(x===l?(f=this.getLeftInternal(h,x,o),v=this.getLeftInternal(h,x,C)):x===d?(f=this.getLeftInternal(h,x,0),v=this.getLeftInternal(h,x,s)):(f=this.getLeftInternal(h,x,0),v=this.getLeftInternal(h,x,C)),x instanceof n.d&&(w=x.isRightToLeft),m=Math.abs(v-f),x===d&&x instanceof n.d&&s>x.length){var I=x.line.paragraph.characterFormat,F=this.documentHelper.textHelper.getParagraphMarkSize(I).Width;if(e.bidi&&!w){m-=F,this.createHighlightBorder(h,m,f,g,!0),f=this.getLineStartLeft(h)-F,this.createHighlightBorder(h,F,f,g,!0);continue}}this.createHighlightBorder(h,m,w?v:f,g,!0)}else if(d instanceof n.d&&s>d.length){var I=d.line.paragraph.characterFormat,F=this.documentHelper.textHelper.getParagraphMarkSize(I).Width;!e.bidi&&P?(v+=F,m-=F,this.createHighlightBorder(h,m,v,g,!0),v+=d.width,this.createHighlightBorder(h,F,v,g,!0)):e.bidi&&!P?(m-=F,this.createHighlightBorder(h,m,f,g,!0),f=this.getLineStartLeft(h)-F,this.createHighlightBorder(h,F,f,g,!0)):this.createHighlightBorder(h,m,P?v:f,g,!1)}else this.createHighlightBorder(h,m,P?v:f,g,!1)}else this.createHighlightBorder(h,m,e.bidi?v:f,g,!1)}},e.prototype.highlightNextBlock=function(e,t,r){var o=e.nextRenderedWidget;i.i(a.isNullOrUndefined)(o)||(o instanceof n.g?(this.isHighlightNext=!1,this.highlight(o,t,r),this.isHighlightNext&&(this.highlightNextBlock(this.hightLightNextParagraph,t,r),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0)):this.highlightTable(o,t,r))},e.prototype.getStartLineWidget=function(e,t,i,r){var o=e===t.paragraph?t.offset:this.getStartOffset(e),s=void 0;if(s=e===t.paragraph?t.currentWidget.getInline(o,r):e.firstChild.getInline(o,r),i=s.element,r=s.index,i instanceof n.b){var a=this.getRenderedInline(i,r);i=a.element,r=a.index}return o===this.getParagraphLength(t.paragraph)+1&&r++,{index:r,element:i}},e.prototype.getEndLineWidget=function(e,t,i){var r=e.currentWidget.getInline(e.offset,i);if(t=r.element,i=r.index,t instanceof n.b){var o=this.getRenderedInline(t,i);t=o.element,i=o.index}return e.paragraph.childWidgets.indexOf(e.currentWidget)===e.paragraph.childWidgets.length-1&&e.offset===this.getLineLength(e.currentWidget)+1&&(i=t?t.length+1:1),{index:i,element:t}},e.prototype.getLineWidgetInternal=function(e,t,i){var r=void 0;if(0===e.children.length&&e instanceof n.p)r=e;else{var o=0,s=e.getInline(t,o),a=s.element;o=s.index,r=a instanceof n.c?a.line:this.getLineWidgetInternalInline(a,o,i)}return r},e.prototype.getLineWidgetParagraph=function(e,t){var i=void 0;if(0===t.children.length)i=t;else{var n=0,r=t.getInline(e,n),o=r.element;n=r.index,i=this.getLineWidget(o,n)}return i},e.prototype.highlightCells=function(e,t,i){var n=this.getCellLeft(t.ownerRow,t),r=n+t.cellFormat.cellWidth,o=this.getCellLeft(i.ownerRow,i),s=o+i.cellFormat.cellWidth;n>o&&(n=o),r<s&&(r=s),n>this.upDownSelectionLength&&(n=this.upDownSelectionLength),r<this.upDownSelectionLength&&(r=this.upDownSelectionLength);var a=e.getSplitWidgets(),l=a.indexOf(t.ownerRow.ownerTable),d=a.indexOf(i.ownerRow.ownerTable);if(l===d)for(var h=e.childWidgets.indexOf(i.ownerRow),c=e.childWidgets.indexOf(t.ownerRow);c<=h;c++)this.highlightRow(e.childWidgets[c],n,r);else for(var p=0,u=0,c=l;c<=d;c++){e=a[c],p=c===l?e.childWidgets.indexOf(t.ownerRow):0,u=c===d?e.childWidgets.indexOf(i.ownerRow):e.childWidgets.length-1;for(var g=p;g<=u;g++)this.highlightRow(e.childWidgets[g],n,r)}},e.prototype.highlightTable=function(e,t,i){this.highlightInternal(e.childWidgets[0],t,i),i.paragraph.isInsideTable&&e.contains(i.paragraph.associatedCell)||this.highlightNextBlock(e,t,i)},e.prototype.getCellLeft=function(e,t){var i=0;return i+=t.x-t.margin.left},e.prototype.getNextParagraphRow=function(e){if(!i.i(a.isNullOrUndefined)(e.nextRenderedWidget)){var t=e.nextRenderedWidget.childWidgets[0],n=t.childWidgets[0];return this.documentHelper.getFirstParagraphBlock(n)}return this.getNextParagraphBlock(e.ownerTable)},e.prototype.getPreviousParagraphRow=function(e){if(!i.i(a.isNullOrUndefined)(e.previousRenderedWidget)){var t=e.previousRenderedWidget.lastChild,n=t.lastChild?t.lastChild:t.previousSplitWidget.lastChild;return this.documentHelper.getLastParagraphBlock(n)}return this.getPreviousParagraphBlock(e.ownerTable)},e.prototype.containsRow=function(e,t){if(-1!==e.childWidgets.indexOf(t))return!0;for(;t.ownerTable.isInsideTable;){if(-1!==e.childWidgets.indexOf(t))return!0;t=t.ownerTable.associatedCell}return-1!==e.childWidgets.indexOf(t)},e.prototype.highlightRow=function(e,t,i){for(var n=0;n<e.childWidgets.length;n++){var o=this.getCellLeft(e,e.childWidgets[n]);r.a.round(t,2)<=r.a.round(o,2)&&r.a.round(o,2)<r.a.round(i,2)&&this.highlightCellWidget(e.childWidgets[n])}},e.prototype.highlightInternal=function(e,t,i){for(var r=0;r<e.childWidgets.length;r++)this.highlightCellWidget(e.childWidgets[r]);i.paragraph.isInsideTable&&this.containsRow(e,i.paragraph.associatedCell)||e.nextRenderedWidget instanceof n.z&&this.highlightInternal(e.nextRenderedWidget,t,i)},e.prototype.getLastParagraph=function(e){for(;e.nextSplitWidget&&e.nextSplitWidget.childWidgets.length>0;)e=e.nextSplitWidget;var t;return t=e.childWidgets.length>0?e.lastChild:e.previousSplitWidget.lastChild,this.documentHelper.getLastParagraphBlock(t)},e.prototype.containsCell=function(e,t){if(e.equals(t))return!0;for(;t.ownerTable.isInsideTable;){if(e.equals(t.ownerTable.associatedCell))return!0;t=t.ownerTable.associatedCell}return!1},e.prototype.isCellSelected=function(e,t,i){var n=this.getLastParagraph(e);return n===i.paragraph&&i.offset===this.getParagraphLength(n)+1||!this.containsCell(e,t.paragraph.associatedCell)||!this.containsCell(e,i.paragraph.associatedCell)},e.prototype.getContainerCellOf=function(e,t){for(;e.ownerTable.isInsideTable;){if(e.ownerTable.contains(t))return e;e=e.ownerTable.associatedCell}return e},e.prototype.getSelectedCell=function(e,t){if(e.ownerTable.equals(t.ownerTable))return e;for(;e.ownerTable.isInsideTable;){if(e.ownerTable.associatedCell.equals(t))return e;e=e.ownerTable.associatedCell}return e},e.prototype.getSelectedCells=function(){for(var e=[],t=0;t<this.selectedWidgets.keys.length;t++){var i=this.selectedWidgets.keys[t];i instanceof n.j&&e.push(i)}return e},e.prototype.getLevelFormatNumber=function(){var e="%";return e=e+((this.paragraphFormat.listLevelNumber<=0?0:this.paragraphFormat.listLevelNumber)+1)+"."},e.prototype.getNextParagraphCell=function(e){if(e.nextRenderedWidget&&e.nextRenderedWidget instanceof n.j){e=e.nextRenderedWidget,e.getSplitWidgets()[0]instanceof n.j&&(e=e.getSplitWidgets()[0]);var t=e.firstChild;return t?this.documentHelper.getFirstParagraphBlock(t):this.getNextParagraphCell(e)}return e.nextSplitWidget&&0===e.nextSplitWidget.childWidgets.length&&(e=e.getSplitWidgets().pop()),this.getNextParagraphRow(e.containerWidget)},e.prototype.getPreviousParagraphCell=function(e){if(!i.i(a.isNullOrUndefined)(e.previousRenderedWidget)&&e.previousRenderedWidget instanceof n.j){e=e.previousRenderedWidget;var t=e.lastChild;return this.documentHelper.getLastParagraphBlock(t)}return this.getPreviousParagraphRow(e.ownerRow)},e.prototype.getContainerCell=function(e){for(;!i.i(a.isNullOrUndefined)(e.ownerTable)&&e.ownerTable.isInsideTable;)e=e.ownerTable.associatedCell;return e},e.prototype.highlightCell=function(e,t,n,r){if(r.paragraph.isInsideTable){var o=this.getContainerCellOf(e,r.paragraph.associatedCell);if(o.ownerTable.contains(r.paragraph.associatedCell)){var s=this.getSelectedCell(e,o),l=this.getSelectedCell(r.paragraph.associatedCell,o);if(this.containsCell(o,r.paragraph.associatedCell))this.isCellSelected(o,n,r)?this.highlightCellWidget(o):s===o?(this.highlight(n.paragraph,n,r),this.isHighlightNext&&(this.highlightNextBlock(this.hightLightNextParagraph,n,r),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0)):this.highlightContainer(s,n,r);else if(this.highlightCellWidget(o),o.ownerRow.equals(l.ownerRow))for(s=o;!i.i(a.isNullOrUndefined)(s.nextRenderedWidget)&&(s=s.nextRenderedWidget,this.highlightCellWidget(s),s!==l););else this.highlightCells(o.ownerTable,o,l)}else this.highlightContainer(o,n,r)}else{var d=this.getContainerCell(e);this.highlightContainer(d,n,r)}},e.prototype.highlightContainer=function(e,t,i){this.highlightInternal(e.containerWidget,t,i),this.highlightNextBlock(e.ownerTable.getSplitWidgets().pop(),t,i)},e.prototype.getPreviousValidElement=function(e){var t=void 0;if(this.documentHelper.isFormFillProtectedMode&&2===e.fieldType)return e;for(;e instanceof n.b;)r.a.isLinkedFieldCharacter(e)&&(e instanceof n.b&&0===e.fieldType?t=e:e instanceof n.b&&1===e.fieldType?(t=e,i.i(a.isNullOrUndefined)(e.fieldSeparator)&&(e=e.fieldBegin,t=e)):(e=e.fieldBegin,t=e)),e=e.previousNode;return i.i(a.isNullOrUndefined)(t)?e:t},e.prototype.getNextValidElement=function(e){var t=void 0;if(e instanceof n.e&&1===e.bookmarkType)return e;for(;e instanceof n.b;){if(0===e.fieldType&&!i.i(a.isNullOrUndefined)(e.fieldEnd))return i.i(a.isNullOrUndefined)(t)?e:t;1!==e.fieldType||i.i(a.isNullOrUndefined)(e.fieldBegin)||(t=e),e=e.nextNode}return i.i(a.isNullOrUndefined)(t)?e:t},e.prototype.validateTextPosition=function(e,t){var i=e.nextNode;if(e.length===t&&(i instanceof n.b||!(e instanceof n.r)&&(i instanceof n.e||i instanceof n.B))){var r=this.getNextValidElement(e.nextNode);(r instanceof n.b&&1===r.fieldType||r instanceof n.e&&1===r.bookmarkType||r instanceof n.B&&1===r.commentType)&&(e=r,t=this.documentHelper.isFormFillProtectedMode?0:1)}else if(0===t&&e.previousNode instanceof n.b){var o=this.getPreviousValidElement(e.previousNode);e=o,t=e instanceof n.b?0:e.length,e instanceof n.b&&1===e.fieldType&&t++}return{element:e,index:t}},e.prototype.getPhysicalPositionInline=function(e,t,o){var s=void 0;s=this.getElementBox(e,t,o).element;var l=void 0;if(i.i(a.isNullOrUndefined)(s)||i.i(a.isNullOrUndefined)(s.line)){if(!(e instanceof n.b&&1===e.fieldType))return e instanceof n.b||e instanceof n.e||e instanceof n.B?this.getFieldCharacterPosition(e):new r.b(0,0);s=e}var d=s.margin,h=0,c=0;if(s instanceof n.d&&"\v"===s.text&&i.i(a.isNullOrUndefined)(e.nextNode)&&!this.owner.editor.handledEnter?(l=this.getNextLineWidget(s.line.paragraph,s),t=0):l=s.line,h=this.getTop(l),s instanceof n.r&&"Inline"===s.textWrappingStyle){var p=s.line.paragraph.characterFormat,u=this.getPreviousTextElement(e);if(i.i(a.isNullOrUndefined)(u)){var g=this.getNextTextElement(e);i.i(a.isNullOrUndefined)(g)||(p=g.characterFormat)}else p=u.characterFormat;var f=this.documentHelper.textHelper.getHeight(p);s.margin.top+s.height-f.BaselineOffset>0&&(h+=s.margin.top+s.height-f.BaselineOffset)}else s instanceof n.b||(h+=d.top>0?d.top:0);return c=i.i(a.isNullOrUndefined)(s)||i.i(a.isNullOrUndefined)(l)?0:this.getLeftInternal(l,s,t),new r.b(c,h)},e.prototype.getFieldCharacterPosition=function(e){var t=this.getNextValidElementForField(e);if(i.i(a.isNullOrUndefined)(t)){var n=e.line.paragraph;return this.getEndPosition(n)}return this.getPhysicalPositionInline(t,0,!0)},e.prototype.isRenderBookmarkAtEnd=function(e){var t;if((t=1==e.bookmarkType?e.reference:e)&&i.i(a.isNullOrUndefined)(t.properties)){var n=t.reference?t.reference.paragraph.associatedCell:void 0;if(i.i(a.isNullOrUndefined)(n))return!1;var r=t.reference?t.reference.paragraph.associatedCell.ownerRow:void 0,o=r?r.childWidgets[r.childWidgets.length-1]:void 0;return!i.i(a.isNullOrUndefined)(o)&&n==o}return!1},e.prototype.getNextValidElementForField=function(e){if(e instanceof n.b&&0===e.fieldType&&r.a.isLinkedFieldCharacter(e)){var t=e;e=i.i(a.isNullOrUndefined)(t.fieldSeparator)?t.fieldEnd:t.fieldSeparator}var o=void 0;return i.i(a.isNullOrUndefined)(e.nextNode)||(o=this.getNextValidElement(e.nextNode)),o},e.prototype.getEndPosition=function(e){var t=e.x,n=e.y,o=void 0;e.childWidgets.length>0&&(o=e.childWidgets[e.childWidgets.length-1],t+=this.getWidth(o,!1)),i.i(a.isNullOrUndefined)(o)||(n=this.getTop(o));var s=this.getParagraphMarkSize(e,0,0);return new r.b(t,n+s.topMargin)},e.prototype.getElementBox=function(e,t,i){var r=void 0;return e instanceof n.b||e instanceof n.e||e instanceof n.B||(r=e),{element:r,index:t}},e.prototype.getPreviousTextElement=function(e){return e.previousNode instanceof n.d?e.previousNode:i.i(a.isNullOrUndefined)(e.previousNode)?void 0:this.getPreviousTextElement(e.previousNode)},e.prototype.getNextTextElement=function(e){return e.nextNode instanceof n.d?e.nextNode:i.i(a.isNullOrUndefined)(e.nextNode)?void 0:this.getNextTextElement(e.nextNode)},e.prototype.getNextRenderedElementBox=function(e,t){if(e instanceof n.b){var r=e;if(0===r.fieldType&&(e=this.getRenderedField(r),r===e))return r;t=1}for(;!i.i(a.isNullOrUndefined)(e)&&t===e.length&&e.nextNode instanceof n.b;){var o=this.getNextValidElement(e.nextNode);if(o instanceof n.b&&0===o.fieldType){var r=o;if(e=this.getRenderedField(r),!i.i(a.isNullOrUndefined)(e)&&r===e)return r;t=1}else e=o}return e},e.prototype.getElementBoxInternal=function(e,t){var i=void 0;return i=e,{element:i,index:t}},e.prototype.getLineWidget=function(e,t){return this.getLineWidgetInternalInline(e,t,!0)},e.prototype.getLineWidgetInternalInline=function(e,t,r){var o=this.getElementBox(e,t,r),s=o.element;if(t=o.index,!i.i(a.isNullOrUndefined)(s))return r&&s instanceof n.d&&"\v"===s.text&&1===t?this.getNextLineWidget(s.line.paragraph,s):s.line;var l=e,d=this.getNextValidElementForField(l);if(i.i(a.isNullOrUndefined)(d)){var h=void 0,c=l.line.paragraph;return c.childWidgets.length>0&&(h=c.childWidgets[c.childWidgets.length-1]),h}return this.getLineWidget(d,0)},e.prototype.getNextLineWidget=function(e,t){var i=void 0,n=e;if(n.childWidgets.length>0){var r=n.childWidgets.indexOf(t.line);r===n.childWidgets.length-1?(n=e,r=-1):r>n.childWidgets.length-1?(n=this.getNextParagraphBlock(e),r=-1):r<0&&(n=e,r=n.childWidgets.indexOf(t.line)),i=n.childWidgets[r+1]}return i},e.prototype.getCaretHeight=function(e,t,r,o,s,l){var d=this.getElementBox(e,t,!1),h=d.element,c=e;if(i.i(a.isNullOrUndefined)(h))return c instanceof n.b?this.getFieldCharacterHeight(c,r,o,s,l):{height:this.documentHelper.textHelper.getHeight(r).Height,topMargin:s,isItalic:l};var p=h.margin,u=h.height,g=0;if(h instanceof n.r){var f=this.getPreviousTextElement(e),m=this.getNextTextElement(e);if(i.i(a.isNullOrUndefined)(f)&&i.i(a.isNullOrUndefined)(m)){var v=0,y=0,w=e.line.paragraph,b=this.getParagraphMarkSize(w,v,y);v=b.topMargin,y=b.bottomMargin,g=b.height,l=w.characterFormat.italic,o||(g+=this.documentHelper.layout.getAfterSpacing(w))}else{if(i.i(a.isNullOrUndefined)(f))return l=m.characterFormat.italic,this.getCaretHeight(m,0,m.characterFormat,o,s,l);if(i.i(a.isNullOrUndefined)(m)||!(h instanceof n.r))return l=f.characterFormat.italic,this.getCaretHeight(f,f.length,f.characterFormat,o,s,l);var x=this.documentHelper.textHelper.getHeight(h.characterFormat),C=x.Height,I=x.BaselineOffset;g=h.margin.top<0&&I>h.margin.top+h.height?h.margin.top+h.height+C-I:C,o||(g+=h.margin.bottom)}}else{var F=r.baselineAlignment,k=u;"Normal"!==F&&o&&(k/=1.5,"Subscript"===F&&(s=u-k)),g=(p.top<0?p.top:0)+k,o||(g+=p.bottom)}if(!o)return{height:g,topMargin:s,isItalic:l};var P=this.documentHelper.textHelper.getHeight(r).Height;return P>g&&(P=g),{height:P,topMargin:s,isItalic:l}},e.prototype.getFieldCharacterHeight=function(e,t,n,r,o){var s=this.getNextValidElementForField(e);if(i.i(a.isNullOrUndefined)(s)){var l=e.line.paragraph,d=this.documentHelper.textHelper.getParagraphMarkSize(t).Height,h=0,c=0,p=this.getParagraphMarkSize(l,h,c),u=p.height;return h=p.topMargin,(c=p.bottomMargin,n)?(d>u&&(d=u),{height:d,topMargin:r,isItalic:o}):(u+=c,{height:u,topMargin:r,isItalic:o})}return this.getCaretHeight(s,0,t,n,r,o)},e.prototype.getRenderedInline=function(e,t){if(this.documentHelper.isFormFillProtectedMode&&2===e.fieldType)return{element:e,index:t};for(var o=this.getPreviousValidElement(e);o instanceof n.b;)(o=this.getPreviousTextElement(o))instanceof n.b&&(o=o.previousNode);if(!i.i(a.isNullOrUndefined)(o))return t=o.length,{element:o,index:t};t=0;var s=this.getNextRenderedElementBox(e,0);if(s instanceof n.b&&0===s.fieldType)for(s=s.fieldSeparator,s=s.nextNode;s instanceof n.b;)s instanceof n.b&&0===s.fieldType&&r.a.isLinkedFieldCharacter(s)&&(s=i.i(a.isNullOrUndefined)(s.fieldSeparator)?s.fieldEnd:s.fieldSeparator),s=s.nextNode;return{element:s,index:t}},e.prototype.getRenderedField=function(e){var t=e;if(i.i(a.isNullOrUndefined)(e.fieldSeparator))t=e.fieldEnd;else{t=e.fieldSeparator;var n=t.line.paragraph;if(n!==e.fieldEnd.line.paragraph||this.hasValidInline(n,t,e.fieldEnd))return t;t=e.fieldEnd}return t},e.prototype.isLastRenderedInline=function(e,t){for(;t===e.length&&e.nextNode instanceof n.b;){var r=this.getNextValidElement(e.nextNode);if(t=0,r instanceof n.b&&0===r.fieldType&&(e=r),e instanceof n.b&&0===e.fieldType&&!i.i(a.isNullOrUndefined)(e.fieldEnd)){var o=e;if(i.i(a.isNullOrUndefined)(o.fieldSeparator))e=o.fieldEnd,t=1;else{e=o.fieldSeparator;var s=e.line.paragraph;if(t=1,s!==o.fieldEnd.line.paragraph||this.hasValidInline(s,e,o.fieldEnd))break;e=o.fieldEnd}}}return t===e.length&&i.i(a.isNullOrUndefined)(e.nextNode)},e.prototype.getPage=function(e){var t=void 0;if(e.containerWidget instanceof n.i){var r=e.containerWidget.containerShape;r.line&&(t=this.getPage(r.line.paragraph))}else if(e.containerWidget instanceof n.h){e.containerWidget;t=e.containerWidget.page}else i.i(a.isNullOrUndefined)(e.containerWidget)||(t=this.getPage(e.containerWidget));return t},e.prototype.clearSelectionHighlightInSelectedWidgets=function(){var e=!1,t=this.selectedWidgets.keys;if(!this.viewer.documentHelper.isDragStarted){for(var i=0;i<t.length;i++)this.removeSelectionHighlight(t[i]),e=!0;this.selectedWidgets.clear()}return e},e.prototype.clearChildSelectionHighlight=function(e){for(var t=0;t<e.childWidgets.length;t++)e.childWidgets[t]instanceof n.p?this.clearSelectionHighlightLineWidget(e.childWidgets[t]):e.childWidgets[t]instanceof n.j?this.clearSelectionHighlight(e.childWidgets[t]):e.childWidgets[t]instanceof n.w&&this.clearChildSelectionHighlight(e.childWidgets[t])},e.prototype.getLineWidgetBodyWidget=function(e,t,r){r=!!i.i(a.isNullOrUndefined)(r)||r;var o=e;if(o instanceof n.h)for(var s=0;s<o.floatingElements.length;s++){var l=o.floatingElements[s];if(l instanceof n.u){var d=l.getTableCellWidth();if(t.x<=l.x+d&&t.x>=l.x&&t.y<=l.y+l.height&&t.y>=l.y)return this.getLineWidgetTableWidget(l,t)}else if(l instanceof n.v&&l.x<=t.x&&l.x+l.width>=t.x&&l.y<=t.y&&l.y+l.height>=t.y)return l.line}if(e instanceof n.a)for(var h=void 0,c=!1,p=0;p<e.bodyWidgets.length;p++)if(e.sectionFormat.columns.length<=1)for(var u=0;u<e.bodyWidgets[p].childWidgets.length;u++){var g=e.bodyWidgets[p].childWidgets[u];if(g instanceof n.w&&g.y<=t.y&&g.y+g.height>=t.y)return g instanceof n.g?this.getLineWidgetParaWidget(g,t):this.getLineWidgetTableWidget(g,t)}else{var f=e.bodyWidgets[p];if(f.firstChild.x+f.sectionFormat.columns[f.columnIndex].width>=t.x&&f.firstChild.x<=t.x&&f.firstChild.y<=t.y&&this.documentHelper.layout.getNextWidgetHeight(f)>=t.y?h=f:f.firstChild.x+f.sectionFormat.columns[f.columnIndex].width<t.x&&f.firstChild.y<=t.y&&this.documentHelper.layout.getNextWidgetHeight(f)>=t.y?h=f:e.x>t.x&&f.firstChild.y<=t.y&&this.documentHelper.layout.getNextWidgetHeight(f)>=t.y&&!c&&(h=f,c=!0),p===e.bodyWidgets.length-1&&!i.i(a.isNullOrUndefined)(h))for(var u=0;u<h.childWidgets.length;u++){var g=h.childWidgets[u];if(g instanceof n.w&&g.y<=t.y&&g.y+g.height>=t.y)return g instanceof n.g?this.getLineWidgetParaWidget(g,t):this.getLineWidgetTableWidget(g,t)}}for(var m=0;m<e.childWidgets.length;m++){var v=e.childWidgets[m];if(v instanceof n.a)return v[m];if(v instanceof n.w&&v.y<=t.y&&v.y+v.height>=t.y){if(v instanceof n.g)return this.getLineWidgetParaWidget(v,t);var y=v;if(y.wrapTextAround)continue;return this.getLineWidgetTableWidget(y,t)}}var w=void 0;if(r&&e.childWidgets.length>0){var b=e.childWidgets[0];if(b instanceof n.w&&b.y<=t.y)if(e.childWidgets[e.childWidgets.length-1]instanceof n.g)for(var m=0;m<e.childWidgets.length;m++)w=this.getLineWidgetParaWidget(e.childWidgets[m],t);else for(var m=0;m<e.childWidgets.length;m++)w=this.getLineWidgetTableWidget(e.childWidgets[m],t);else{var v=void 0;b instanceof n.w&&(v=b),i.i(a.isNullOrUndefined)(v)||(w=v instanceof n.g?this.getLineWidgetParaWidget(b,t):this.getLineWidgetTableWidget(b,t))}}return w},e.prototype.getLineWidgetParaWidget=function(e,t){for(var i=e.childWidgets,n=e.y,r=0;r<i.length;r++){var o=i[r];n+=o.marginTop;var s=o.height;if(o.nextLine&&o.nextLine.marginTop>0&&(s+=o.nextLine.marginTop),n<=t.y&&n+s>=t.y)return o;n+=o.height}var a=void 0;return i.length>0&&(a=e.y<=t.y?i[i.length-1]:i[0]),a},e.prototype.highlightParagraph=function(e,t,i,r,o){var s=0,a=0,l=!1;e.paragraphFormat.bidi&&i.children.indexOf(r)>0&&(r=i.children[0]);for(var d=t;d<e.childWidgets.length;d++){var h=e.childWidgets[d];d===t?s=this.getTop(h):s+=h.marginTop,r instanceof n.d&&(l=r.isRightToLeft);var c=this.getLeft(h);if(h===i){var p=0;if(l||e.bidi){for(var u=this.getElementsBackward(h,r,r,e.bidi),g=0;g<u.length;g++){var f=u[g],m=!1;if(f===r)p=this.getLeftInternal(h,f,f.length);else{var v=f instanceof n.d?f.length:1;p=this.getLeftInternal(h,f,v)}if(c=this.getLeftInternal(h,f,0),f instanceof n.d&&(m=f.isRightToLeft),a=Math.abs(p-c),f===r&&f instanceof n.d&&o>f.length){var y=this.documentHelper.textHelper.getParagraphMarkSize(f.line.paragraph.characterFormat).Width;if(!e.bidi&&m)p+=y;else if(e.bidi&&!m){a-=y,this.createHighlightBorder(h,a,c,s,!0),c=this.getLineStartLeft(h)-y,this.createHighlightBorder(h,y,c,s,!0);continue}}this.createHighlightBorder(h,a,m?p:c,s,!0)}return}return p=this.getLeftInternal(i,r,o),a=Math.abs(p-c),void this.createHighlightBorder(h,a,l?p:c,s,!1)}a=this.getWidth(h,!0)-(c-e.x),e.bidi&&h.isLastLine()&&(c-=this.documentHelper.textHelper.getParagraphMarkSize(e.characterFormat).Width),this.createHighlightBorder(h,a,c,s,!1),s+=h.height}},e.prototype.getLineWidgetTableWidget=function(e,t){for(var o=void 0,s=0;s<e.childWidgets.length;s++){var l=e.childWidgets[s];if(l instanceof n.z&&l.y<=t.y){if("Exactly"===l.rowFormat.heightType&&l.y+r.a.convertPointToPixel(l.rowFormat.height)<t.y)continue;o=this.getLineWidgetRowWidget(l,t);var d=void 0;!i.i(a.isNullOrUndefined)(o)&&o.paragraph.containerWidget instanceof n.j&&(d=o.paragraph.containerWidget);var h=0,c=0;if(!i.i(a.isNullOrUndefined)(d)){var p=d.ownerRow.containerWidget;h=r.a.convertPointToPixel(p.tableFormat.cellSpacing),c=d.cellFormat.rowSpan}var u=0,g=0,f=0,m=0;if(h>0){u=0===d.cellIndex?h:h/2,g=d.cellIndex===d.ownerRow.childWidgets.length-1?h:h/2;var v=void 0;d.containerWidget instanceof n.z&&(v=d.containerWidget);var p=void 0;d.containerWidget.containerWidget instanceof n.u&&(p=d.containerWidget.containerWidget),i.i(a.isNullOrUndefined)(v)||i.i(a.isNullOrUndefined)(p)||(f=0===d.ownerRow.rowIndex?h:h/2,m=d.ownerRow.rowIndex+c===d.ownerTable.childWidgets.length?h:h/2)}if(!i.i(a.isNullOrUndefined)(o)&&o.paragraph.x<=t.x&&o.paragraph.x+o.width>=t.x&&o.paragraph.y<=t.y&&this.getTop(o)+o.height>=t.y||!i.i(a.isNullOrUndefined)(d)&&d.x-d.margin.left-u<=t.x&&d.x+d.width+d.margin.right+g>=t.x&&d.y-d.margin.top-f<=t.y&&d.y+d.height+d.margin.bottom+m>=t.y)break}}return o},e.prototype.getLineWidgetRowWidget=function(e,t){for(var i=0;i<e.childWidgets.length;i++){var n=0;n=r.a.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing);var o=0,s=0;if(n>0&&(o=0===e.childWidgets[i].columnIndex?n:n/2,s=e.childWidgets[i].cellIndex===e.childWidgets[i].ownerRow.childWidgets.length-1?n:n/2),e.childWidgets[i].x-e.childWidgets[i].margin.left-o<=t.x&&e.childWidgets[i].x+e.childWidgets[i].width+e.childWidgets[i].margin.right+s>=t.x)return this.getLineWidgetCellWidget(e.childWidgets[i],t)}var a=void 0;return e.childWidgets.length>0&&(a=e.childWidgets[0].x<=t.x?this.getLineWidgetCellWidget(e.childWidgets[e.childWidgets.length-1],t):this.getLineWidgetCellWidget(e.childWidgets[0],t)),a},e.prototype.getFirstBlock=function(e){if(e.childWidgets.length>0)return e.childWidgets[0]},e.prototype.highlightCellWidget=function(e){var t=[];e.previousSplitWidget||e.nextSplitWidget?t=e.getSplitWidgets():t.push(e);for(var i=0;i<t.length;i++)e=t[i],this.clearChildSelectionHighlight(e),this.createHighlightBorderInsideTable(e)},e.prototype.clearSelectionHighlight=function(e){this.selectedWidgets.containsKey(e)&&(this.removeSelectionHighlight(e),this.selectedWidgets.remove(e))},e.prototype.getLineWidgetCellWidget=function(e,t){for(var i=0;i<e.childWidgets.length;i++)if(e.childWidgets[i].y<=t.y&&e.childWidgets[i].y+e.childWidgets[i].height>=t.y)return e.childWidgets[i]instanceof n.g?this.getLineWidgetParaWidget(e.childWidgets[i],t):this.getLineWidgetTableWidget(e.childWidgets[i],t);var r=void 0;return e.childWidgets.length>0&&e.childWidgets[0].y<=t.y&&(r=e.childWidgets[e.childWidgets.length-1]instanceof n.g?this.getLineWidgetParaWidget(e.childWidgets[e.childWidgets.length-1],t):this.getLineWidgetTableWidget(e.childWidgets[0],t)),r},e.prototype.updateTextPosition=function(e,t){var n=t,r=void 0,o=0,s=!1;if(this.owner.enableHeaderAndFooter){var l=this.start.paragraph.bodyWidget;-1!=l.headerFooterType.indexOf("Header")?this.comparePageWidthAndMargins(l.page.headerWidget,l.page):this.comparePageWidthAndMargins(l.page.footerWidget,l.page)}var d=this.updateTextPositionIn(e,r,o,t,!1);i.i(a.isNullOrUndefined)(d)||(r=d.element,o=d.index,n=d.caretPosition,s=d.isImageSelected,this.isImageSelected=s),s?(this.selectInternal(e,r,o,n),0===o?this.extendForward():this.extendBackward()):this.selectInternal(e,r,o,n)},e.prototype.updateTextPositionIn=function(e,t,o,s,l){var d=!1,h=this.getTop(e),c=e.paragraph.x,p=this.getFirstElement(e,c),u=p.element,g=!1,f=!1;c=p.left;var m=e.renderedElements;if(i.i(a.isNullOrUndefined)(u)){var v=0,y=0,w=this.getParagraphMarkSize(e.paragraph,v,y);v=w.topMargin,y=w.bottomMargin;var b=!(this.documentHelper.mouseDownOffset.y>=h&&this.documentHelper.mouseDownOffset.y<h+e.height)||this.documentHelper.mouseDownOffset.x<c+w.width;b&&l&&s.x>c+w.width/2?(c+=w.width,m.length>0&&(t=m[m.length-1],o=t.length),o++):e.paragraph.isEmpty()&&e.paragraph.bidi&&(c+=w.width),s=new r.b(c,v>0?h+v:h)}else if(!i.i(a.isNullOrUndefined)(u)){if(s.x>c+u.margin.left||u instanceof n.v&&"Inline"!==u.textWrappingStyle){var x=!1;e.paragraph.floatingElements.length>0&&(x=this.documentHelper.checkPointIsInLine(e,s));for(var C=m.indexOf(u);C<m.length;C++)if((u=m[C])instanceof n.v&&"Inline"!==u.textWrappingStyle){if(this.documentHelper.isInShapeBorder(u,s)&&!this.documentHelper.isSelectionChangedOnMouseMoved&&!x){c=u.x,h=u.y;break}}else{var I=!1;if((u instanceof n.q||u instanceof n.d)&&(I=u.line.paragraph.paragraphFormat.bidi),s.x<c+u.margin.left+u.width+u.padding.left||C===m.length-1||m[C+1]instanceof n.q&&I)break;c+=u.margin.left+u.width+u.padding.left}if(u instanceof n.d&&(g=u.isRightToLeft,f=u.line.paragraph.paragraphFormat.bidi),s.x>c+u.margin.left+u.width+u.padding.left)o=u instanceof n.d?u.length:1,g&&f&&(o=0),(u instanceof n.d&&"\v"!==u.text&&"\f"!==u.text&&u.text!==String.fromCharCode(14)||l)&&(c+=u.margin.left+u.width+u.padding.left);else if(u instanceof n.d){u instanceof n.d&&g&&(c+=u.width+u.padding.left);var F=0;F=g?c+u.margin.left-s.x:s.x-c-u.margin.left-u.padding.left,c+=u.margin.left+u.padding.left;for(var k=0,P=0,C=1;C<=u.length;C++){var T=0;if(C===u.length?T=u.width+u.padding.left:(T=this.documentHelper.textHelper.getWidth(u.text.substr(0,C),u.characterFormat,u.scriptType),u.trimEndWidth=T),F<T||C===u.length){var S=T-k;if(F-k>S/2)g?c-=T:c+=T,P=C;else if(g?c-=k:c+=k,P=C-1,1===C&&u!==m[0]&&!(m[0]instanceof n.v&&"Inline"!==m[0].textWrappingStyle)){var W=m.indexOf(u);m[W-1]instanceof n.q||g||(u=m[W-1],u instanceof n.v&&"Inline"!==u.textWrappingStyle&&0==P&&!i.i(a.isNullOrUndefined)(u.previousElement)&&(u=m[m.indexOf(u)-1]),P=u instanceof n.d?u.length:1)}break}k=T}o=P}else if(d=u instanceof n.r||u instanceof n.s,s.x-c-u.margin.left>u.width/2)o=1,c+=u.margin.left+u.width+u.padding.left;else if(u!==m[0]&&!d){var W=m.indexOf(u);m[W-1]instanceof n.q||(u=m[W-1],o=u instanceof n.d?u.length:1)}u instanceof n.d&&("\v"===u.text||"\f"===u.text||u.text===String.fromCharCode(14))&&(o=0)}else g=u.isRightToLeft,f=u.line.paragraph.paragraphFormat.bidi,o=u instanceof n.d&&(f||g)&&s.x<c+u.margin.left+u.width+u.padding.left?this.getTextLength(u.line,u)+u.length:this.getTextLength(u.line,u),c+=u.margin.left;if(u instanceof n.d)h+=u.margin.top>0?u.margin.top:0;else{var N=this.documentHelper.textHelper.getHeight(u.characterFormat),H=u.height;u instanceof n.e&&!this.documentHelper.layout.hasValidElement(u.line.paragraph)&&(H=N.Height),h+=u.margin.top+H-N.BaselineOffset}t=u,t instanceof n.b&&2===t.fieldType&&!i.i(a.isNullOrUndefined)(t.fieldBegin)&&(t=t.fieldBegin,o=0),t instanceof n.F&&(o=0),!i.i(a.isNullOrUndefined)(t.previousElement)&&t.previousElement instanceof n.v&&"Inline"!==t.previousElement.textWrappingStyle&&0==o&&(t=t.previousElement);var E=this.validateTextPosition(t,o);t=E.element,o=E.index;var O=i.i(a.isNullOrUndefined)(t.nextNode)&&o===t.length,_=t.line.isEndsWithLineBreak&&t instanceof n.d&&"\v"===t.text;if(l&&t.nextNode instanceof n.b&&o===t.length&&(O=this.isLastRenderedInline(t,o)),l&&O||_){var T=0;if(O){T=this.documentHelper.textHelper.getParagraphMarkWidth(e.paragraph.characterFormat);var b=!(this.documentHelper.mouseDownOffset.y>=h&&this.documentHelper.mouseDownOffset.y<h+e.height)||this.documentHelper.mouseDownOffset.x<c+T;b&&s.x>c+T/2&&(c+=T,o=t.length+1)}else _&&(T=u.width+u.padding.left,c+=T)}s=new r.b(c,h)}return{element:t,index:o,caretPosition:s,isImageSelected:d}},e.prototype.checkAllFloatingElements=function(e,t){var r,o,s=!1,l=!1;if(!i.i(a.isNullOrUndefined)(e)){r=e.paragraph.bodyWidget,s=!1,l=!1;for(var d=0;d<r.floatingElements.length;d++)if(!(r.floatingElements[d]instanceof n.u)&&(o=r.floatingElements[d],t.x<o.x+o.margin.left+o.width&&t.x>o.x&&t.y<o.y+o.margin.top+o.height&&t.y>o.y)){s=!0,this.documentHelper.isInShapeBorder(o,t)&&(l=!0);break}}return{element:o,caretPosition:t,isShapeSelected:s,isInShapeBorder:l}},e.prototype.getTextLength=function(e,t){var i=0,r=e.renderedElements,o=r.indexOf(t);r.length>0&&r[0]instanceof n.q&&(r[1]instanceof n.q?o-=2:o-=1);for(var s=1;s<o;s++)i+=r[s].length;return i},e.prototype.getLeft=function(e){var t=e.paragraph.x,i=e.paragraph.paragraphFormat;this.isParagraphFirstLine(e)&&!i.bidi&&"Right"!==i.textAlignment&&(t+=r.a.convertPointToPixel(i.firstLineIndent));for(var o=e.renderedElements,s=0;s<o.length;s++){var a=o[s];if(!(a instanceof n.q)||i.bidi){t+=a.margin.left;break}t+=0===s?a.margin.left+a.width:a.width}return t},e.prototype.getTop=function(e){for(var t=e.paragraph.y,i=e.paragraph.childWidgets.indexOf(e),n=0;n<i;n++){var r=e.paragraph.childWidgets[n];t=t+r.height+r.marginTop}return t+=e.marginTop},e.prototype.getFirstElement=function(e,t){var i=0;this.isParagraphFirstLine(e)&&!e.paragraph.paragraphFormat.bidi&&(i=r.a.convertPointToPixel(e.paragraph.paragraphFormat.firstLineIndent)),t+=i;for(var o=void 0,s=e.renderedElements,a=0;a<s.length&&((o=s[a])instanceof n.q||o instanceof n.B);a++){if(e.paragraph.paragraphFormat.bidi){t+=o.margin.left,o=void 0;break}t+=o.margin.left+o.width,o=void 0}return{element:o,left:t}},e.prototype.getIndexInInline=function(e){var t=0;if(e instanceof n.d)for(var i=e.line.children.indexOf(e),r=0;r<i;r++){var o=e.line.children[r];o instanceof n.b||o instanceof n.q||(t+=o.length)}return t},e.prototype.isParagraphFirstLine=function(e){return!(!i.i(a.isNullOrUndefined)(e.paragraph.previousSplitWidget)||e!==e.paragraph.firstChild)},e.prototype.isParagraphLastLine=function(e){return!(!i.i(a.isNullOrUndefined)(e.paragraph.nextSplitWidget)||e!==e.paragraph.lastChild)},e.prototype.getWidth=function(e,t){var o=0,s=e.paragraph.paragraphFormat;this.isParagraphFirstLine(e)&&!s.bidi&&(o+=r.a.convertPointToPixel(s.firstLineIndent));for(var l=0;l<e.children.length;l++){var d=e.children[l];d instanceof n.v&&"Inline"!==d.textWrappingStyle||(o+=d.margin.left+d.width+d.padding.left)}return t&&e.paragraph.childWidgets.indexOf(e)===e.paragraph.childWidgets.length-1&&i.i(a.isNullOrUndefined)(e.paragraph.nextSplitWidget)&&(o+=this.documentHelper.textHelper.getParagraphMarkWidth(e.paragraph.characterFormat)),o},e.prototype.getLeftInternal=function(e,t,o){var s=e.paragraph.x,l=e.paragraph.paragraphFormat;this.isParagraphFirstLine(e)&&!l.bidi&&(s+=r.a.convertPointToPixel(e.paragraph.paragraphFormat.firstLineIndent));var h=e.renderedElements,c=h.indexOf(t);(1===h.length&&h[0]instanceof n.q||2===h.length&&h[0]instanceof n.q&&h[1]instanceof n.q)&&(c=h.length);for(var p=!1,u=0;u<c;u++){var g=h[u];g instanceof n.b&&2===g.fieldType&&(p=!1),p||(g instanceof n.v&&"Inline"!==g.textWrappingStyle||(1===u&&g instanceof n.q?s+=g.width:g instanceof n.I&&t===g?s+=g.margin.left:s+=g.margin.left+g.width+g.padding.left,g instanceof n.b&&0===g.fieldType&&(p=!0)))}var f=!1,m=e.paragraph.bidi;i.i(a.isNullOrUndefined)(t)||(f=t.characterRange===d.o.RightToLeft,m=t.line.paragraph.paragraphFormat.bidi,s+=t.margin.left+t.padding.left,t instanceof n.v&&!i.i(a.isNullOrUndefined)(t.nextElement)&&(s+=t.nextElement.margin.left+t.nextElement.padding.left),(f||1===this.documentHelper.moveCaretPosition&&!f&&m)&&(s+=t.width));var v=0;if(t instanceof n.d){if(0!==this.documentHelper.moveCaretPosition&&(m||f))return(f&&m&&2===this.documentHelper.moveCaretPosition||f&&!m&&1===this.documentHelper.moveCaretPosition)&&(s-=t.width),this.documentHelper.moveCaretPosition=0,s;o!==t.length||f?o>t.length?(v=this.documentHelper.textHelper.getParagraphMarkWidth(t.line.paragraph.characterFormat),f?s-=t.width+v:s+=t.width+v):(v=o===t.length&&f&&"Justify"===l.textAlignment?t.width:this.documentHelper.textHelper.getWidth(t.text.substr(0,o),t.characterFormat,t.scriptType),f?s-=v:s+=v):s+=t.width,this.documentHelper.moveCaretPosition=0}else if(o>0)if(i.i(a.isNullOrUndefined)(t)||t instanceof n.q)s+=this.documentHelper.textHelper.getParagraphMarkWidth(e.paragraph.characterFormat);else if(t instanceof n.v&&"Inline"!==t.textWrappingStyle||(s+=t.width),2===o){var y=t.line.paragraph;s+=this.documentHelper.textHelper.getParagraphMarkWidth(y.characterFormat)}return s},e.prototype.getLineStartLeft=function(e){var t=e.paragraph.x,i=e.paragraph.paragraphFormat;return this.isParagraphFirstLine(e)&&!i.bidi&&(t+=r.a.convertPointToPixel(i.firstLineIndent)),e.children.length>0&&(t+=e.children[0].margin.left),t},e.prototype.updateTextPositionWidget=function(e,t,i,n){var r,o=t,s=void 0,a=0;r=this.updateTextPositionIn(e,s,a,o,n),s=r.element,a=r.index,o=r.caretPosition,i.setPositionForSelection(e,s,a,o)},e.prototype.clearSelectionHighlightLineWidget=function(e){!i.i(a.isNullOrUndefined)(this.owner)&&this.selectedWidgets.length>0&&this.clearSelectionHighlight(this)},e.prototype.getFirstElementInternal=function(e){for(var t=void 0,i=e.children.length,r=0;r<i&&(t=e.children[r])instanceof n.q;r++)t=void 0;return t},e.prototype.selectRange=function(e,t,i){this.start.setPositionInternal(e),this.end.setPositionInternal(t),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0,!0,i)},e.prototype.selectParagraphInternal=function(e,t){var n;if(!i.i(a.isNullOrUndefined)(e)&&!i.i(a.isNullOrUndefined)(e.firstChild))if(n=e.firstChild,t)this.start.setPosition(n,t);else{var r=n.getEndOffset();this.start.setPositionParagraph(n,r)}this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.start.location.x,this.fireSelectionChanged(!0)},e.prototype.setPositionForBlock=function(e,t){var i;if(e instanceof n.u&&(e=t?this.documentHelper.getFirstParagraphInFirstCell(e):this.documentHelper.getLastParagraphInLastCell(e)),e instanceof n.g)if(i=new p.a(this.owner),t)i.setPosition(e.firstChild,!0);else{var r=e.lastChild;i.setPositionParagraph(r,r.getEndOffset())}return i},e.prototype.selectContent=function(e,t){if(i.i(a.isNullOrUndefined)(e))throw new Error("textPosition is undefined.");this.start.setPositionInternal(e),this.end.setPositionInternal(e),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0)},e.prototype.selectInternal=function(e,t,i,n){this.start.setPositionForSelection(e,t,i,n),this.end.setPositionInternal(this.start),this.upDownSelectionLength=n.x,this.fireSelectionChanged(!0)},e.prototype.selects=function(e,t,i){this.documentHelper.clearSelectionHighlight(),this.start.setPositionForLineWidget(e,t),this.end.setPositionInternal(this.start),i||this.fireSelectionChanged(!0)},e.prototype.selectPosition=function(e,t){if(i.i(a.isNullOrUndefined)(e)||i.i(a.isNullOrUndefined)(t))throw new Error("TextPosition cannot be undefined");if(i.i(a.isNullOrUndefined)(e.paragraph)||e.offset>this.getParagraphLength(e.paragraph)+1)throw new Error("Start TextPosition is not valid.");if(i.i(a.isNullOrUndefined)(t.paragraph)||t.offset>this.getParagraphLength(t.paragraph)+1)throw new Error("End TextPosition is not valid.");e.isAtSamePosition(t)?this.selectRange(e,e):(e.isExistBefore(t)?t.validateForwardFieldSelection(e.getHierarchicalIndexInternal(),t.getHierarchicalIndexInternal()):e.validateForwardFieldSelection(t.getHierarchicalIndexInternal(),e.getHierarchicalIndexInternal()),this.selectRange(e,t))},e.prototype.fireSelectionChanged=function(e,t,i){this.isEmpty||(this.isForward?(this.start.updatePhysicalPosition(!0),this.end.updatePhysicalPosition(!1)):(this.start.updatePhysicalPosition(!1),this.end.updatePhysicalPosition(!0))),this.isModifyingSelectionInternally||(!this.documentHelper.isFormFillProtectedMode||!e||this.isFormatUpdated||this.documentHelper.isTextFormEmpty||this.owner.documentHelper.layout.isRelayout||(this.currentFormField=this.getCurrentFormField()),this.skipFormatRetrieval||this.retrieveCurrentFormatProperties(),this.documentHelper.clearSelectionHighlight(),this.hideToolTip(),this.owner.isLayoutEnabled&&!this.owner.isShiftingEnabled&&this.highlightSelection(!0,i),this.documentHelper.restrictEditingPane.isShowRestrictPane&&!this.skipEditRangeRetrieval&&this.documentHelper.restrictEditingPane.updateUserInformation(),e&&(this.start.paragraph.isInHeaderFooter&&!this.owner.enableHeaderAndFooter?this.owner.enableHeaderAndFooter=!0:!this.start.paragraph.isInHeaderFooter&&this.owner.enableHeaderAndFooter&&(this.owner.enableHeaderAndFooter=!1),this.owner.fireSelectionChange()),this.owner.enableAutoFocus&&this.documentHelper.updateFocus(),this.documentHelper.isFormFillProtectedMode&&e&&(this.triggerFormFillEvent(t),this.previousSelectedFormField=this.currentFormField),this.owner.rulerHelper&&this.owner.documentEditorSettings&&this.owner.documentEditorSettings.showRuler&&!this.owner.isReadOnlyMode&&this.owner.rulerHelper.updateRuler(this.owner,!1))},e.prototype.retrieveCurrentFormatProperties=function(){this.isRetrieveFormatting=!0;var e=this.start,t=this.end;this.isForward||(e=this.end,t=this.start),this.retrieveImageFormat(e,t),this.retrieveCharacterFormat(e,t),this.retrieveParagraphFormat(e,t),this.retrieveSectionFormat(e,t),this.retrieveTableFormat(e,t),this.isRetrieveFormatting=!1,this.setCurrentContextType()},e.prototype.retrieveImageFormat=function(e,t){var i;if(e.currentWidget===t.currentWidget&&e.offset+1===t.offset){var r=t.currentWidget.getInline(t.offset,0);i=r.element;r.index;if(i instanceof n.r){e.currentWidget.getOffset(i,0)!==e.offset&&(i=void 0)}}i instanceof n.r?this.imageFormat.copyImageFormat(i):this.imageFormat.clearImageFormat()},e.prototype.getPreviousContextType=function(e){var t=this.start;if(t.offset>0){var i=t.currentWidget.getInline(t.offset,0).element;return i=e?i.previousElement:t.currentWidget.getInline(t.offset-1,0).element,this.getContextElement(i)}},e.prototype.getNextContextType=function(e){var t=this.start,i=t.currentWidget.getInline(t.offset,0).element;return i=e&&i.nextElement?i.nextElement:t.currentWidget.getInline(t.offset+1,0).element,this.getContextElement(i)},e.prototype.getContextElement=function(e){return e instanceof n.d?"Text":e instanceof n.b||e instanceof n.D?"Field":e instanceof n.e?"Bookmark":e instanceof n.r?"Image":e instanceof n.s?"Shape":e instanceof n.M||e instanceof n.B?"Comment":e instanceof n.q?"List":e instanceof n.G||e instanceof n.F?"EditRange":void 0},e.prototype.setCurrentContextType=function(){var e=!!this.imageFormat.image,t=!i.i(a.isNullOrUndefined)(this.tableFormat)&&!i.i(a.isNullOrUndefined)(this.tableFormat.table),n=this.start.paragraph.paragraphFormat.baseStyle;if(n instanceof s.E&&0===n.name.toLowerCase().indexOf("toc")){var r=this.getTocFieldInternal();if(!i.i(a.isNullOrUndefined)(r))return void(this.contextTypeInternal="TableOfContents")}var o=this.getCurrentRevision();if(!i.i(a.isNullOrUndefined)(o)&&this.owner.showRevisions?(this.owner.trackChangesPane.currentSelectedRevision=o[0],i.i(a.isNullOrUndefined)(this.owner.documentHelper.currentSelectedComment)&&this.owner.commentReviewPane.selectReviewTab("Changes"),this.owner.notify("reviewPane",{comment:this.owner.showComments,changes:!0,isUserClosed:!1})):i.i(a.isNullOrUndefined)(this.owner.trackChangesPane.currentSelectedRevision)||(this.owner.trackChangesPane.currentSelectedRevision=void 0),this.start.paragraph.isInHeaderFooter){var l=-1!==this.start.paragraph.bodyWidget.headerFooterType.indexOf("Header");this.contextTypeInternal=t?e?l?"HeaderTableImage":"FooterTableImage":l?"HeaderTableText":"FooterTableText":e?l?"HeaderImage":"FooterImage":l?"HeaderText":"FooterText"}else this.contextTypeInternal=t?e?"TableImage":"TableText":e?"Image":"Text"},e.prototype.addItemRevisions=function(e,t){for(var i=0;i<e.revisions.length;i++){var n=e.revisions[i];this.selectRevision(n),t?n.accept():n.reject()}},e.prototype.hasRevisions=function(){return!!this.getCurrentRevision()},e.prototype.getCurrentRevision=function(){var e=this.start,t=this.end;this.isForward||(e=this.end,t=this.start);var n,r=e.currentWidget.getInline(e.offset,0),o=r.element,s=e.paragraph,l=e.currentWidget.getInline(e.offset+1,0).element;if(o&&o===l){var d=o.line.getOffset(o,o.length);if(n=new p.a(this.owner),n.setPositionParagraph(o.line,d),t.offset===n.offset&&!i.i(a.isNullOrUndefined)(o.nextElement))return}if(!i.i(a.isNullOrUndefined)(o)&&o.revisions.length>0)return o.revisions;if(s.isInsideTable){var h=s.associatedCell;if(!i.i(a.isNullOrUndefined)(h.ownerRow)&&h.ownerRow.rowFormat.revisions.length>0)return h.ownerRow.rowFormat.revisions}return t.offset>t.paragraph.getLength()&&t.paragraph.characterFormat.revisions.length>0?t.paragraph.characterFormat.revisions:void 0},e.prototype.processLineRevisions=function(e,t){for(var i=0;i<e.children.length;i++){var n=e.children[i];n.revisions.length>0&&this.addItemRevisions(n,t)}},e.prototype.handleAcceptReject=function(e){if(this.isEmpty){var t=this.start.currentWidget.getInline(this.start.offset+1,0),n=t.element,r=this.start.paragraph;if(!i.i(a.isNullOrUndefined)(n)&&n.revisions.length>0&&this.addItemRevisions(n,e),r.isInsideTable){var o=r.associatedCell;if(i.i(a.isNullOrUndefined)(o)){if(!r.isEmpty())for(var s=0;s<o.childWidgets.length;s++)for(var l=o.childWidgets[s],d=void 0;d<l.childWidgets.length;d++){var h=l.childWidgets[d];this.processLineRevisions(h,e)}}else o.ownerRow.rowFormat.revisions.length>0&&this.addItemRevisions(o.ownerRow.rowFormat,e)}}else for(var c=this.getselectedRevisionElements(),s=0;s<c.length;s++)this.acceptReject(c[s],e)},e.prototype.acceptReject=function(e,t){this.selectRevision(e),t?e.accept():e.reject()},e.prototype.getselectedRevisionElements=function(){var e=[],t=this.start,i=this.end;this.isForward||(t=this.end,i=this.start);for(var r=0;r<this.selectedWidgets.length;r++){var o=this.selectedWidgets.keys[r];if(o instanceof n.p)e=this.getSelectedLineRevisions(o,t,i,e);else if(o instanceof n.j){o.ownerRow.rowFormat.revisions.length>0&&(e=this.addRevisionsCollec(o.ownerRow.rowFormat.revisions,e));for(var s=0;s<o.childWidgets.length;s++)for(var a=o.childWidgets[s],l=0;l<a.childWidgets.length;l++){var d=a.childWidgets[l];e=this.getSelectedLineRevisions(d,t,i,e)}}}return e},e.prototype.getSelectedLineRevisions=function(e,t,i,n){e.paragraph.characterFormat.revisions.length>0&&(n=this.addRevisionsCollec(e.paragraph.characterFormat.revisions,n));for(var r=0;r<e.children.length;r++){var o=e.children[r],s=o.line.getOffset(o,0),a=new p.a(this.owner);a.setPositionParagraph(o.line,s),s=o.line.getOffset(o,o.length);var l=new p.a(this.owner);l.setPositionParagraph(o.line,s),(l.isExistAfter(t)&&l.isExistBefore(i)||a.isExistAfter(t)&&a.isExistBefore(i)||a.isAtSamePosition(t)||t.isExistAfter(a)&&i.isExistBefore(l))&&o.revisions.length>0&&(n=this.addRevisionsCollec(o.revisions,n))}return n},e.prototype.addRevisionsCollec=function(e,t){for(var i=0;i<e.length;i++)-1===t.indexOf(e[i])&&t.push(e[i]);return t},e.prototype.retrieveTableFormat=function(e,t){var n=this.getTable(e,t);i.i(a.isNullOrUndefined)(n)?this.tableFormat.clearFormat():(this.tableFormat.table=n,this.tableFormat.copyFormat(n.tableFormat),this.retrieveCellFormat(e,t),this.retrieveRowFormat(e,t))},e.prototype.retrieveCellFormat=function(e,t){e.paragraph.isInsideTable&&t.paragraph.isInsideTable?(this.cellFormat.copyFormat(e.paragraph.associatedCell.cellFormat),this.getCellFormat(e.paragraph.associatedCell.ownerTable,e,t)):this.cellFormat.clearCellFormat()},e.prototype.retrieveRowFormat=function(e,t){e.paragraph.isInsideTable&&t.paragraph.isInsideTable?(this.rowFormat.copyFormat(e.paragraph.associatedCell.ownerRow.rowFormat),this.getRowFormat(e.paragraph.associatedCell.ownerTable,e,t)):this.rowFormat.clearRowFormat()},e.prototype.getCellFormat=function(e,t,i){if(!t.paragraph.associatedCell.equals(i.paragraph.associatedCell))for(var n=!1,r=0;r<e.childWidgets.length;r++){var o=e.childWidgets[r];if(o===t.paragraph.associatedCell.ownerRow&&(n=!0),n)for(var s=0;s<o.childWidgets.length;s++){var a=o.childWidgets[s];if(this.isCellSelected(a,t,i)&&this.cellFormat.combineFormat(a.cellFormat),a===i.paragraph.associatedCell)return void this.cellFormat.combineFormat(a.cellFormat)}}},e.prototype.getRowFormat=function(e,t,i){var n=t.paragraph.associatedCell.ownerRow;if(n!==i.paragraph.associatedCell.ownerRow)for(var r=e.childWidgets.indexOf(n)+1;r<e.childWidgets.length;r++){var o=e.childWidgets[r];if(this.rowFormat.combineFormat(o.rowFormat),o===i.paragraph.associatedCell.ownerRow)return}},e.prototype.getTable=function(e,t){if(!i.i(a.isNullOrUndefined)(e.paragraph.associatedCell)&&!i.i(a.isNullOrUndefined)(t.paragraph.associatedCell)){var n=e.paragraph.associatedCell.ownerTable,r=e.paragraph.associatedCell.ownerTable;if(n===r)return n;if(n.contains(e.paragraph.associatedCell))return n;if(r.contains(e.paragraph.associatedCell))return r;if(!n.isInsideTable||!r.isInsideTable)return;do{if((n=n.associatedCell.ownerTable)===r||n.contains(r.associatedCell))return n;if(r.contains(n.associatedCell))return r}while(!i.i(a.isNullOrUndefined)(n.associatedCell))}},e.prototype.getContainerWidget=function(e){var t;if(e.containerWidget instanceof n.i)t=e.containerWidget.containerShape.line.paragraph.bodyWidget;else if(e.containerWidget instanceof n.h)t=!i.i(a.isNullOrUndefined)(e.containerWidget.containerWidget)&&e.containerWidget.containerWidget instanceof n.a?e.containerWidget.containerWidget:e.containerWidget;else for(t=e.containerWidget;!(t instanceof n.h);)t instanceof n.i&&(t=t.containerShape.line.paragraph),t=t.containerWidget;return t},e.prototype.retrieveSectionFormat=function(e,t){var n=this.getContainerWidget(e.paragraph),r=this.getContainerWidget(t.paragraph);if(!i.i(a.isNullOrUndefined)(n)){this.sectionFormat.copyFormat(n.sectionFormat);for(var o=this.documentHelper.pages.indexOf(n.page),s=this.documentHelper.pages.indexOf(r.page),l=o+1;l<=s;l++)this.sectionFormat.combineFormat(this.documentHelper.pages[l].bodyWidgets[0].sectionFormat)}},e.prototype.retrieveParagraphFormat=function(e,t){this.getParagraphFormatForSelection(e.paragraph,this,e,t)},e.prototype.getParagraphFormatForSelection=function(e,t,n,r){if(!n.paragraph.isInsideTable||r.paragraph.isInsideTable&&n.paragraph.associatedCell===r.paragraph.associatedCell&&!this.isCellSelected(n.paragraph.associatedCell,n,r)){if(this.getParagraphFormatInternalInParagraph(e,n,r),r.paragraph===e)return;var o=this.getNextRenderedBlock(e);i.i(a.isNullOrUndefined)(o)||this.getParagraphFormatInternalInBlock(o,n,r)}else this.getParagraphFormatInternalInCell(n.paragraph.associatedCell,n,r)},e.prototype.getParagraphsInSelection=function(){var e=this.owner.selection,t=e.selectedWidgets.keys,i=[];if(e.isEmpty||e.start.paragraph===e.end.paragraph)return[e.start.paragraph];for(var n=0;n<t.length;n++){var r=t[n];-1===i.indexOf(r.paragraph)&&i.push(r.paragraph)}return i},e.prototype.getParagraphFormatInternalInParagraph=function(e,t,i){t.paragraph===e?this.paragraphFormat.copyFormat(e.paragraphFormat):this.paragraphFormat.combineFormat(e.paragraphFormat)},e.prototype.getParagraphFormatInternalInBlock=function(e,t,r){if(e instanceof n.g){if(this.getParagraphFormatInternalInParagraph(e,t,r),r.paragraph===e)return;var o=this.getNextRenderedBlock(e);i.i(a.isNullOrUndefined)(o)||this.getParagraphFormatInternalInBlock(o,t,r)}else this.getParagraphFormatInternalInTable(e,t,r)},e.prototype.getParagraphFormatInternalInTable=function(e,t,i){for(var n=0;n<e.childWidgets.length;n++){for(var r=e.childWidgets[n],o=0;o<r.childWidgets.length;o++)this.getParagraphFormatInCell(r.childWidgets[o]);if(i.paragraph.isInsideTable&&this.containsRow(r,i.paragraph.associatedCell))return}var s=this.getNextRenderedBlock(e);this.getParagraphFormatInternalInBlock(s,t,i)},e.prototype.getParagraphFormatInCell=function(e){for(var t=0;t<e.childWidgets.length;t++)this.getParagraphFormatInBlock(e.childWidgets[t])},e.prototype.getParagraphFormatInBlock=function(e){e instanceof n.g?this.getParagraphFormatInParagraph(e):this.getParagraphFormatInTable(e)},e.prototype.getParagraphFormatInTable=function(e){for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],n=0;n<i.childWidgets.length;n++)this.getParagraphFormatInCell(i.childWidgets[n])},e.prototype.getParagraphFormatInParagraph=function(e){this.start.paragraph===e?this.paragraphFormat.copyFormat(e.paragraphFormat):this.paragraphFormat.combineFormat(e.paragraphFormat)},e.prototype.getParagraphFormatInternalInCell=function(e,t,n){if(n.paragraph.isInsideTable){var r=this.getContainerCellOf(e,n.paragraph.associatedCell);if(r.ownerTable.contains(n.paragraph.associatedCell)){var o=this.getSelectedCell(e,r),s=this.getSelectedCell(n.paragraph.associatedCell,r);if(this.containsCell(r,n.paragraph.associatedCell))if(this.isCellSelected(r,t,n))this.getParagraphFormatInCell(r);else if(o===r){if(this.getParagraphFormatInternalInParagraph(t.paragraph,t,n),n.paragraph===t.paragraph)return;var l=this.getNextRenderedBlock(t.paragraph);i.i(a.isNullOrUndefined)(l)||this.getParagraphFormatInternalInBlock(l,t,n)}else this.getParagraphFormatInRow(o.ownerRow,t,n);else this.getParaFormatForCell(r.ownerTable,r,s)}else this.getParagraphFormatInRow(r.ownerRow,t,n)}else{var d=this.getContainerCell(e);this.getParagraphFormatInRow(d.ownerRow,t,n)}},e.prototype.getParaFormatForCell=function(e,t,i){var n=this.getCellLeft(t.ownerRow,t),o=n+t.cellFormat.cellWidth,s=this.getCellLeft(i.ownerRow,i),a=s+i.cellFormat.cellWidth;n>s&&(n=s),o<a&&(o=a),n>this.upDownSelectionLength&&(n=this.upDownSelectionLength),n<this.upDownSelectionLength&&(n=this.upDownSelectionLength);for(var l=e.childWidgets.indexOf(i.ownerRow),d=e.childWidgets.indexOf(t.ownerRow);d<=l;d++)for(var h=e.childWidgets[d],c=0;c<h.childWidgets.length;c++){var p=h.childWidgets[c],u=this.getCellLeft(h,p);r.a.round(n,2)<=r.a.round(u,2)&&r.a.round(u,2)<r.a.round(o,2)&&this.getParagraphFormatInCell(p)}},e.prototype.getParagraphFormatInRow=function(e,t,i){for(var n=e.rowIndex;n<e.ownerTable.childWidgets.length;n++){for(var r=e.ownerTable.childWidgets[n],o=0;o<r.childWidgets.length;o++)this.getParagraphFormatInCell(r.childWidgets[o]);if(i.paragraph.isInsideTable&&this.containsRow(r,i.paragraph.associatedCell))return}var s=this.getNextRenderedBlock(e.ownerTable);this.getParagraphFormatInternalInBlock(s,t,i)},e.prototype.retrieveCharacterFormat=function(e,t){if(this.characterFormat.copyFormat(e.paragraph.characterFormat),e.paragraph.isEmpty()&&this.characterFormat.copyFormat(e.paragraph.characterFormat,this.documentHelper.textHelper.getFontNameToRender(0,e.paragraph.characterFormat)),e.paragraph!==t.paragraph||!e.currentWidget.isLastLine()||e.offset!==this.getLineLength(e.currentWidget)||e.offset+1!==t.offset){var n=e.paragraph;if(e.paragraph===t.paragraph&&this.isSelectList){var r=this.getListLevel(e.paragraph);return void(r&&r.characterFormat.uniqueCharacterFormat&&this.characterFormat.copyFormat(r.characterFormat))}for(e.offset!==this.getParagraphLength(n)||this.isEmpty||(n=this.getNextParagraphBlock(n));!i.i(a.isNullOrUndefined)(n)&&n!==t.paragraph&&n.isEmpty();)n=this.getNextParagraphBlock(n);var o=n===e.paragraph?e.offset:0;if(!i.i(a.isNullOrUndefined)(n)&&!n.isEmpty()){var s=new p.a(this.owner),l=e.currentWidget.getInline(o,0),d=this.getPhysicalPositionInternal(e.currentWidget,o,!0);s.setPositionForSelection(e.currentWidget,l.element,l.index,d),this.getCharacterFormatForSelection(n,this,s,t)}}},e.prototype.getCharacterFormatForSelection=function(e,t,i,r){i.paragraph instanceof n.g&&i.paragraph.isInsideTable&&(!r.paragraph.isInsideTable||i.paragraph.associatedCell!==r.paragraph.associatedCell||this.isCellSelected(i.paragraph.associatedCell,i,r))?this.getCharacterFormatInTableCell(i.paragraph.associatedCell,t,i,r):this.getCharacterFormat(e,i,r)},e.prototype.getCharacterFormatForTableRow=function(e,t,i){for(var n=e.rowIndex;n<e.ownerTable.childWidgets.length;n++){for(var r=e.ownerTable.childWidgets[n],o=0;o<r.childWidgets.length;o++)this.getCharacterFormatForSelectionCell(r.childWidgets[o],t,i);if(i.paragraph.isInsideTable&&this.containsRow(r,i.paragraph.associatedCell))return}var s=this.getNextRenderedBlock(e.ownerTable);this.getCharacterFormatForBlock(s,t,i)},e.prototype.getCharacterFormatInTableCell=function(e,t,i,n){if(n.paragraph.isInsideTable){var r=this.getContainerCellOf(e,n.paragraph.associatedCell);if(r.ownerTable.contains(n.paragraph.associatedCell)){var o=this.getSelectedCell(e,r),s=this.getSelectedCell(n.paragraph.associatedCell,r);this.containsCell(r,n.paragraph.associatedCell)?this.isCellSelected(r,i,n)?this.getCharacterFormatForSelectionCell(r,i,n):o===r?this.getCharacterFormat(i.paragraph,i,n):this.getCharacterFormatForTableRow(o.ownerRow,i,n):this.getCharacterFormatInternalInTable(r.ownerTable,r,s,i,n)}else this.getCharacterFormatForTableRow(r.ownerRow,i,n)}else{var a=this.getContainerCell(e);this.getCharacterFormatForTableRow(a.ownerRow,i,n)}},e.prototype.getCharacterFormatInternalInTable=function(e,t,i,n,o){var s=this.getCellLeft(t.ownerRow,t),a=s+t.cellFormat.cellWidth,l=this.getCellLeft(i.ownerRow,i),d=l+i.cellFormat.cellWidth;s>l&&(s=l),a<d&&(a=d),s>this.upDownSelectionLength&&(s=this.upDownSelectionLength),a<this.upDownSelectionLength&&(a=this.upDownSelectionLength);for(var h=e.childWidgets.indexOf(i.ownerRow),c=e.childWidgets.indexOf(t.ownerRow);c<=h;c++)for(var p=e.childWidgets[c],u=0;u<p.childWidgets.length;u++){var g=p.childWidgets[u],f=this.getCellLeft(p,g);r.a.round(s,2)<=r.a.round(f,2)&&r.a.round(f,2)<r.a.round(a,2)&&this.getCharacterFormatForSelectionCell(g,n,o)}},e.prototype.getCharacterFormat=function(e,t,o){if((e===t.paragraph||e===o.paragraph||e.isEmpty()||(this.getCharacterFormatInternal(e,this),this.characterFormat.canRetrieveNextCharacterFormat()))&&(o.paragraph!==e||t.paragraph===e||0!==o.offset)){var s=0,l=this.getParagraphLength(e);if(e===t.paragraph){s=t.offset;if(this.setCharacterFormat(e,t,o,l))return}var d=-1!==e.childWidgets.indexOf(t.currentWidget)?e.childWidgets.indexOf(t.currentWidget):0,h=-1!==e.childWidgets.indexOf(o.currentWidget)?e.childWidgets.indexOf(o.currentWidget):e.childWidgets.length-1,c=o.offset;e!==o.paragraph&&(c=l);for(var p=d;p<=h;p++){var u=e.childWidgets[p];p!==d&&(s=this.getStartLineOffset(u)),c=u===o.currentWidget?o.offset:this.getLineLength(u);for(var g=0,f=0;f<u.children.length;f++){var m=u.children[f];if(!(m instanceof n.q))if(s>=g+m.length)g+=m.length;else if(m instanceof n.b&&0===m.fieldType&&r.a.isLinkedFieldCharacter(m)){var v=i.i(a.isNullOrUndefined)(m.fieldEnd)?m.fieldBegin:m.fieldEnd;f--;do{this.characterFormat.combineFormat(m.characterFormat),g+=m.length,m=m.nextNode,p++,f++}while(!i.i(a.isNullOrUndefined)(m)&&m!==v)}else{if((m instanceof n.d||m instanceof n.b)&&this.characterFormat.combineFormat(m.characterFormat,this.documentHelper.textHelper.getFontNameToRender(m.scriptType,m.characterFormat)),i.i(a.isNullOrUndefined)(m)||c<=g+m.length)break;g+=m.length}}}if(o.paragraph!==e){var y=this.getNextRenderedBlock(e);i.i(a.isNullOrUndefined)(y)||this.getCharacterFormatForBlock(y,t,o)}}},e.prototype.setCharacterFormat=function(e,t,r,o){var s=0,l=t.offset,d=t.currentWidget.getInline(l,s);s=d.index;var h=d.element;if(i.i(a.isNullOrUndefined)(h)){t.paragraph.childWidgets.indexOf(t.currentWidget);if(t.currentWidget.previousLine)return h=t.currentWidget.previousLine.children[t.currentWidget.previousLine.children.length-1],this.characterFormat.copyFormat(h.characterFormat,this.documentHelper.textHelper.getFontNameToRender(h.scriptType,h.characterFormat)),!0}if(l<o){if(this.isEmpty){if(h instanceof n.d||h instanceof n.b&&(0===h.fieldType||1===h.fieldType)){var c=this.getPreviousTextElement(h);0===l&&c&&(h=c),this.characterFormat.copyFormat(h.characterFormat,this.documentHelper.textHelper.getFontNameToRender(h.scriptType,h.characterFormat))}else if(i.i(a.isNullOrUndefined)(this.getPreviousTextElement(h)))if(i.i(a.isNullOrUndefined)(this.getNextTextElement(h)))this.characterFormat.copyFormat(e.characterFormat);else{var p=this.getNextTextElement(h);this.characterFormat.copyFormat(p.characterFormat,this.documentHelper.textHelper.getFontNameToRender(p.scriptType,h.characterFormat))}else{var p=this.getPreviousTextElement(h);this.characterFormat.copyFormat(p.characterFormat,this.documentHelper.textHelper.getFontNameToRender(p.scriptType,h.characterFormat))}return!0}s!==h.length||i.i(a.isNullOrUndefined)(h.nextNode)?h instanceof n.d?this.characterFormat.copyFormat(h.characterFormat,this.documentHelper.textHelper.getFontNameToRender(h.scriptType,h.characterFormat)):h instanceof n.b&&this.characterFormat.copyFormat(this.getNextValidCharacterFormatOfField(h)):this.characterFormat.copyFormat(this.getNextValidCharacterFormat(h),this.documentHelper.textHelper.getFontNameToRender(h.scriptType,h.characterFormat))}else if(o===r.offset)return h instanceof n.d||h instanceof n.b?this.characterFormat.copyFormat(h.characterFormat,this.documentHelper.textHelper.getFontNameToRender(h.scriptType,h.characterFormat)):i.i(a.isNullOrUndefined)(h)?this.characterFormat.copyFormat(e.characterFormat):(h=this.getPreviousTextElement(h),i.i(a.isNullOrUndefined)(h)||this.characterFormat.copyFormat(h.characterFormat,this.documentHelper.textHelper.getFontNameToRender(h.scriptType,h.characterFormat))),!0;return!1},e.prototype.getCharacterFormatForBlock=function(e,t,i){e instanceof n.g?this.getCharacterFormat(e,t,i):this.getCharacterFormatInTable(e,t,i)},e.prototype.getCharacterFormatInTable=function(e,t,i){for(var n=0;n<e.childWidgets.length;n++){for(var r=e.childWidgets[n],o=0;o<r.childWidgets.length;o++)this.getCharacterFormatForSelectionCell(r.childWidgets[o],t,i);if(i.paragraph.isInsideTable&&this.containsRow(r,i.paragraph.associatedCell))return}var s=this.getNextRenderedBlock(e);this.getCharacterFormatForBlock(s,t,i)},e.prototype.getCharacterFormatForSelectionCell=function(e,t,i){for(var n=0;n<e.childWidgets.length;n++)this.getCharacterFormatForBlock(e.childWidgets[n],t,i)},e.prototype.getCharacterFormatInternal=function(e,t){for(var i=0;i<e.childWidgets.length;i++)for(var r=e.childWidgets[i],o=0;o<r.children.length;o++){var s=r.children[o];s instanceof n.r||s instanceof n.b||s instanceof n.q||t.characterFormat.combineFormat(s.characterFormat)}},e.prototype.getNextValidCharacterFormat=function(e){var t=this.getNextTextElement(e);if(i.i(a.isNullOrUndefined)(t))return e.characterFormat;var r=void 0;return t instanceof n.b&&0===r.fieldType&&(r=t),i.i(a.isNullOrUndefined)(r)?t.characterFormat:this.getNextValidCharacterFormatOfField(r)},e.prototype.getNextValidCharacterFormatOfField=function(e){var t=e;r.a.isLinkedFieldCharacter(e)&&(t=i.i(a.isNullOrUndefined)(e.fieldSeparator)?e.fieldEnd:e.fieldSeparator);var n=void 0;return i.i(a.isNullOrUndefined)(t.nextNode)||(n=this.getNextValidElement(t.nextNode)),i.i(a.isNullOrUndefined)(n)?t.characterFormat:n.characterFormat},e.prototype.checkCursorIsInSelection=function(e,t){if(i.i(a.isNullOrUndefined)(this.start)||this.isEmpty||i.i(a.isNullOrUndefined)(e))return!1;var r=!1;do{if(this.selectedWidgets.containsKey(e)){var o=void 0;e instanceof n.p?(o=this.owner.selection.getTop(e),this.owner.selection.getLeft(e)):(o=e.y,e.x);var s=this.selectedWidgets.get(e);if(s instanceof p.d)r=s.left<=t.x&&o<=t.y&&o+e.height>=t.y&&s.left+s.width>=t.x;else for(var l=s,d=0;d<l.length&&!(l[d]instanceof p.d&&(r=l[d].left<=t.x&&o<=t.y&&o+e.height>=t.y&&l[d].left+l[d].width>=t.x));d++);}e=e instanceof n.p?e.paragraph:e.containerWidget}while(!i.i(a.isNullOrUndefined)(e)&&!r);return r},e.prototype.copySelectionParagraphFormat=function(){var e=new s.F;return this.paragraphFormat.copyToFormat(e),e},e.prototype.getHyperlinkDisplayText=function(e,t,r,o,s){var l=e;if(l!==r.line.paragraph)return o=!0,{displayText:"<<Selection in Document>>",isNestedField:o,format:s};for(var d="",h=l.childWidgets.indexOf(t.line),c=l.childWidgets[h].children.indexOf(t),p=h;p<l.childWidgets.length;p++){var u=l.childWidgets[p];p!==h&&(c=-1);for(var g=c+1;g<u.children.length;g++){var f=u.children[g];if(f===r)return{displayText:d,isNestedField:o,format:s};if(f instanceof n.d)d+=f.text,s=f.characterFormat;else{if(!(f instanceof n.b))return o=!0,{displayText:"<<Selection in Document>>",isNestedField:o,format:s};f instanceof n.b&&0===f.fieldType&&!i.i(a.isNullOrUndefined)(f.fieldEnd)&&(c=i.i(a.isNullOrUndefined)(f.fieldSeparator)?u.children.indexOf(f.fieldEnd):u.children.indexOf(f.fieldSeparator))}}}return{displayText:d,isNestedField:o,format:s}},e.prototype.navigateHyperLinkOnEvent=function(e,t){var n=this,r=this.documentHelper.getLineWidget(e);if(!i.i(a.isNullOrUndefined)(r)){var o=this.getHyperLinkFieldInCurrentSelection(r,e);i.i(a.isNullOrUndefined)(o)||(this.documentHelper.updateTextPositionForSelection(e,1),this.fireRequestNavigate(o),setTimeout(function(){n.viewer&&(n.documentHelper.isTouchInput=t,n.documentHelper.updateFocus(),n.documentHelper.isTouchInput=!1)}))}},e.prototype.getLinkText=function(e,t){var n=new p.c(e,this),r=n.navigationLink,o=n.screenTip;return t?(n.localReference.length>0&&("_"!==n.localReference[0]||!i.i(a.isNullOrUndefined)(r)&&0!==r.length?n.isCrossRef?r+=n.localReference:r+="#"+n.localReference:r="Current Document"),n.destroy(),r):(n.destroy(),o)},e.prototype.setHyperlinkContentToToolTip=function(e,t,n,r){if(e){if(this.owner.contextMenuModule&&"block"===this.owner.contextMenuModule.contextMenuInstance.element.style.display)return;this.toolTipElement||(this.toolTipElement=i.i(a.createElement)("div",{className:"e-de-tooltip"}),this.documentHelper.viewerContainer.appendChild(this.toolTipElement),this.screenTipElement=i.i(a.createElement)("p"),this.toolTipElement.appendChild(this.screenTipElement),this.toolTipTextElement=i.i(a.createElement)("p",{styles:"font-weight:bold"}),this.toolTipElement.appendChild(this.toolTipTextElement)),this.toolTipElement.style.display="block";var o=new a.L10n("documenteditor",this.owner.defaultLocale);o.setLocale(this.owner.locale);var s=o.getConstant("Click to follow link");this.owner.useCtrlClickToFollowHyperlink&&(s=this.documentHelper.isIosDevice?"Command+"+s:"Ctrl+"+s);var l=this.getScreenTipText(e);if(r){var d=e.formFieldData.helpText;if(i.i(a.isNullOrUndefined)(d)||""===d)return;this.screenTipElement.innerText=d}else this.screenTipElement.innerText=l,this.toolTipTextElement.innerText=s;var h=this.getTooltipPosition(e.line,n,this.toolTipElement,!1);this.showToolTip(h.x,h.y),i.i(a.isNullOrUndefined)(this.toolTipField)||e===this.toolTipField||(this.toolTipObject.position={X:h.x,Y:h.y}),this.toolTipObject.show(),this.toolTipField=e}else this.hideToolTip()},e.prototype.getScreenTipText=function(e){var t=new p.c(e,this);return t.screenTip||t.localReference?t.screenTip?t.screenTip:t.localReference:t.navigationLink},e.prototype.setFootnoteContentToToolTip=function(e,t,n){if(e){if("block"===this.owner.contextMenuModule.contextMenuInstance.element.style.display&&this.owner.contextMenuModule)return;this.toolTipElement||(this.toolTipElement=i.i(a.createElement)("div",{className:"e-de-tooltip"}),this.documentHelper.viewerContainer.appendChild(this.toolTipElement)),this.toolTipElement.style.display="block";var r=new a.L10n("documenteditor",this.owner.defaultLocale);r.setLocale(this.owner.locale);var o=void 0;"Endnote"===e.footnoteType?o=r.getConstant("Click to View/Edit Endnote"):"Footnote"===e.footnoteType&&(o=r.getConstant("Click to View/Edit Footnote")),this.toolTipElement.innerHTML="<b>"+o+"</b>";var s=this.getTooltipPosition(e.line,n,this.toolTipElement,!1);this.showToolTip(s.x,s.y),i.i(a.isNullOrUndefined)(this.toolTipField)||(this.toolTipObject.position={X:s.x,Y:s.y}),this.toolTipObject.show()}else this.hideToolTip()},e.prototype.setLockInfoTooptip=function(e,t,n){if(e){if(this.owner.contextMenuModule&&"block"===this.owner.contextMenuModule.contextMenuInstance.element.style.display)return;var r=this.toolTipElement;this.toolTipElement||(r=i.i(a.createElement)("div",{className:"e-de-tooltip"}),this.documentHelper.viewerContainer.appendChild(r),this.toolTipElement=r),r.style.display="block";var o=new a.L10n("documenteditor",this.owner.defaultLocale);o.setLocale(this.owner.locale);var s=o.getConstant("This region is locked by");r.innerHTML=s+" <b>"+n+"</b>";var l=this.getTooltipPosition(e,t,r,!1);this.showToolTip(l.x,l.y),i.i(a.isNullOrUndefined)(this.toolTipField)||n===this.toolTipField||(this.toolTipObject.position={X:l.x,Y:l.y}),this.toolTipObject.show(),this.toolTipField=n}else this.hideToolTip()},e.prototype.getTooltipPosition=function(e,t,i,n){var o=this.getTop(e)*this.documentHelper.zoomFactor,s=this.getPage(e.paragraph),a=this.documentHelper.viewerContainer.getBoundingClientRect().width+this.documentHelper.viewerContainer.scrollLeft,l=s.boundingRectangle.x+t*this.documentHelper.zoomFactor;l+i.clientWidth+10>a&&(l-=i.clientWidth-(a-l)+15);var d=n?0:i.offsetHeight,h=this.getPageTop(s)+(o-d);return h=h>this.documentHelper.viewerContainer.scrollTop?h:h+e.height+d,new r.b(l,h)},e.prototype.createPasteElement=function(e,t){var n,r=new a.L10n("documenteditor",this.owner.defaultLocale);switch(r.setLocale(this.owner.locale),this.currentPasteAction){case"DefaultPaste":n=[{text:r.getConstant("Keep source formatting"),iconCss:"e-icons e-de-paste-source"},{text:r.getConstant("Match destination formatting"),iconCss:"e-icons e-de-paste-merge"},{text:r.getConstant("Text only"),iconCss:"e-icons e-de-paste-text"}];break;case"TextOnly":n=[{text:r.getConstant("Text only"),iconCss:"e-icons e-de-paste-text"}];break;case"InsertAsColumns":case"OverwriteCells":case"InsertAsRows":if(n=[{text:r.getConstant("NestTable"),iconCss:"e-icons e-de-paste-nested-table"},{text:r.getConstant("InsertAsRows"),iconCss:"e-icons e-de-paste-row"}],"InsertAsColumns"===this.currentPasteAction){var o={text:r.getConstant("InsertAsColumns"),iconCss:"e-icons e-de-paste-column"};n.unshift(o)}else if("OverwriteCells"===this.currentPasteAction){var o={text:r.getConstant("OverwriteCells"),iconCss:"e-icons e-de-paste-overwrite-cells"};n.splice(2,0,o)}}if(this.pasteElement)this.pasteDropDwn.items=n;else{this.pasteElement=i.i(a.createElement)("div",{className:"e-de-tooltip"}),this.documentHelper.viewerContainer.appendChild(this.pasteElement);var s=i.i(a.createElement)("button",{id:this.owner.containerId+"_iconsplitbtn"});this.pasteElement.appendChild(s),this.pasteDropDwn=new u.DropDownButton({items:n,iconCss:"e-icons e-de-paste",select:this.pasteOptions}),this.pasteDropDwn.appendTo(s)}this.pasteElement.style.display="block",this.pasteElement.style.position="absolute",this.pasteElement.style.left=t,this.pasteElement.style.top=e,this.pasteDropDwn.dataBind()},e.prototype.showToolTip=function(e,t){this.toolTipObject||(this.toolTipObject=new c.Popup(this.toolTipElement,{height:"auto",width:"auto",relateTo:this.documentHelper.viewerContainer.parentElement,position:{X:e,Y:t}}))},e.prototype.hideToolTip=function(){this.toolTipField=void 0,this.toolTipObject&&(this.toolTipElement.style.display="none",this.toolTipObject.hide(),this.toolTipObject.destroy(),this.toolTipObject=void 0)},e.prototype.getHyperLinkFieldInCurrentSelection=function(e,t,n){var o=void 0,s=this.getTop(e),l=this.getLineStartLeft(e),d=r.a.convertPointToPixel(e.paragraph.paragraphFormat.leftIndent),h=r.a.convertPointToPixel(e.paragraph.paragraphFormat.rightIndent);if(!(t.y<s||t.y>s+e.height||t.x<l||t.x>l+e.paragraph.width+d+h)){var c=e.paragraph.x,p=this.getFirstElement(e,c);c=p.left;var u=p.element;if(i.i(a.isNullOrUndefined)(u)){var g=this.documentHelper.textHelper.getParagraphMarkWidth(e.paragraph.characterFormat);if(t.x<=l+g||t.x>=l+g){var f=[],m=this.getHyperLinkFields(e.paragraph,f,!1,n);return f=[],f=void 0,m}}else{var v=e.renderedElements;if(t.x>c+u.margin.left)for(var y=v.indexOf(u);y<v.length&&(u=v[y],!(t.x<c+u.margin.left+u.width||y===v.length-1));y++)c+=u.margin.left+u.width;o=u;var g=u.margin.left+u.width;if(i.i(a.isNullOrUndefined)(o.nextNode)&&(g+=this.documentHelper.textHelper.getParagraphMarkWidth(o.line.paragraph.characterFormat)),t.x<=c+g){var f=[],m=this.getHyperLinkFieldInternal(o.line.paragraph,o,f,!1,n);return f=[],f=void 0,m}}}},e.prototype.getFootNoteElementInCurrentSelection=function(e,t){var r=void 0,o=this.getTop(e),s=this.getLineStartLeft(e);if(!(t.y<o||t.y>o+e.height||t.x<s||t.x>s+e.paragraph.width)){var l=e.paragraph.x,d=this.getFirstElement(e,l);l=d.left;var h=d.element;if(i.i(a.isNullOrUndefined)(h)){var c=this.documentHelper.textHelper.getParagraphMarkWidth(e.paragraph.characterFormat);if(t.x<=s+c||t.x>=s+c){var p=this.documentHelper.selection.start.currentWidget.getInline(this.documentHelper.selection.start.offset,0),u=p.element;return u instanceof n.f?u:void 0}}else{if(t.x>l+h.margin.left)for(var g=e.children.indexOf(h);g<e.children.length&&(h=e.children[g],!(t.x<l+h.margin.left+h.width||g===e.children.length-1));g++)l+=h.margin.left+h.width;h instanceof n.f&&(r=h);var c=h.margin.left+h.width;if(i.i(a.isNullOrUndefined)(h.nextNode)&&(c+=this.documentHelper.textHelper.getParagraphMarkWidth(h.line.paragraph.characterFormat)),t.x<=l+c)return r}}},e.prototype.getHyperlinkField=function(e){if(!i.i(a.isNullOrUndefined)(this.end)){var t=0,r=this.documentHelper.selection,o=(r.start,r.end);r.isForward||(r.end,o=r.start);var s=this.end.currentWidget.getInline(o.offset,t);t=s.index;var l=s.element,d=[],h=void 0;if(i.i(a.isNullOrUndefined)(l))h=this.getHyperLinkFields(this.end.paragraph,d,e);else if(this.documentHelper.isFormFillProtectedMode&&l instanceof n.e&&l.previousNode instanceof n.b&&1===l.previousNode.fieldType)h=void 0;else{var c=l.line.paragraph;h=this.getHyperLinkFieldInternal(c,l,d,e,!1)}return d=[],h}},e.prototype.getHyperLinkFields=function(e,t,n,r){for(var o=0;o<this.documentHelper.fields.length;o++)if(-1===t.indexOf(this.documentHelper.fields[o])&&!i.i(a.isNullOrUndefined)(this.documentHelper.fields[o].fieldSeparator)){t.push(this.documentHelper.fields[o]);var s=this.getFieldCode(this.documentHelper.fields[o]);s=s.trim().toLowerCase();var l=this.paragraphIsInFieldResult(this.documentHelper.fields[o],e);if((n||!n&&s.match("hyperlink "))&&l)return this.documentHelper.fields[o];if(l&&r&&this.documentHelper.fields[o].formFieldData)return this.documentHelper.fields[o];if((n||!n&&s.match("ref "))&&l)return this.documentHelper.fields[o]}},e.prototype.getHyperLinkFieldInternal=function(e,t,r,o,s){for(var l=0;l<this.documentHelper.fields.length;l++)if(-1===r.indexOf(this.documentHelper.fields[l])&&!i.i(a.isNullOrUndefined)(this.documentHelper.fields[l].fieldSeparator)){r.push(this.documentHelper.fields[l]);var d=this.getFieldCode(this.documentHelper.fields[l]);d=d.trim().toLowerCase();var h=this.documentHelper.fields[l],c=h.fieldEnd;o&&h.nextNode instanceof n.e&&h.nextNode.reference&&(c=h.nextNode.reference);var p=this.inlineIsInFieldResult(h,c,h.fieldSeparator,t,o)||this.isImageField();if((o||!o&&d.match("hyperlink "))&&p)return this.documentHelper.fields[l];if(p&&s&&this.documentHelper.fields[l].formFieldData)return this.documentHelper.fields[l];if((o||!o&&d.match("ref "))&&p)return this.documentHelper.fields[l]}if(e.containerWidget instanceof n.o&&!(e instanceof n.x))return this.getHyperLinkFieldInternal(e.containerWidget,t,r,o,s)},e.prototype.getBlock=function(e){if(""!==e&&!i.i(a.isNullOrUndefined)(e)){var t={index:e},n=this.start.getPage(t),r=t.index.indexOf(";"),o=t.index.substring(0,r);t.index=t.index.substring(r).replace(";","");var s=n.bodyWidgets[parseInt(o,10)];return this.getBlockInternal(s,t.index)}},e.prototype.getBlockInternal=function(e,t){if(""!==t&&!i.i(a.isNullOrUndefined)(t)){var r=t.indexOf(";"),o=t.substring(0,r);t=t.substring(r).replace(";","");var s=e;if(!((r=parseInt(o,10))>=0&&r<e.childWidgets.length))return s;var l=e.childWidgets[r];if(!(t.indexOf(";")>=0))return l;if(l instanceof n.g)return t.indexOf(";")>=0&&(t="0"),l;if(l instanceof n.C){return this.getBlockInternal(l,t)}return s}},e.prototype.inlineIsInFieldResult=function(e,t,n,r,o){return!(i.i(a.isNullOrUndefined)(t)||i.i(a.isNullOrUndefined)(n)||!this.isExistBeforeInline(n,r))&&this.isExistAfterInline(t,r,o)},e.prototype.paragraphIsInFieldResult=function(e,t){if(!i.i(a.isNullOrUndefined)(e.fieldEnd)&&!i.i(a.isNullOrUndefined)(e.fieldSeparator)){var n=e.fieldSeparator.line.paragraph;if(e.fieldSeparator.line.paragraph===t||this.isExistBefore(n,t)){return e.fieldEnd.line.paragraph!==t&&this.isExistAfter(n,t)}}return!1},e.prototype.isImageField=function(){if(this.start.paragraph.isEmpty()||this.end.paragraph.isEmpty())return!1;var e=this.start,t=this.end;this.isForward||(e=this.end,t=this.start);var i=0,r=e.paragraph.getInline(e.offset,i),o=r.element;i=r.index,i===o.length&&(o=this.getNextRenderedElementBox(o,i)),r=t.paragraph.getInline(t.offset,i);var s=r.element;if(i=r.index,o instanceof n.b&&0===o.fieldType&&s instanceof n.b&&1===s.fieldType&&o.fieldSeparator){var a=o.fieldSeparator.nextNode;if(a instanceof n.r&&a.nextNode===s)return!0}return!1},e.prototype.isFormField=function(){var e=this.currentFormField;return!!(e instanceof n.b&&e.formFieldData)},e.prototype.isReferenceField=function(e){if(i.i(a.isNullOrUndefined)(e)&&(e=this.getHyperlinkField(!0)),e){var t=this.getFieldCode(e);if(t=t.toLowerCase(),e instanceof n.b&&t.match("ref "))return!0}return!1},e.prototype.isInlineFormFillMode=function(e){return!!(this.documentHelper.isInlineFormFillProtectedMode&&(e=i.i(a.isNullOrUndefined)(e)?this.currentFormField:e,i.i(a.isNullOrUndefined)(e)&&(e=this.getCurrentFormField()),e&&e.formFieldData instanceof n.l&&"Text"===e.formFieldData.type))},e.prototype.getFormFieldType=function(e){if(i.i(a.isNullOrUndefined)(e)&&(e=this.currentFormField),e instanceof n.b){if(e.formFieldData instanceof n.l)return"Text";if(e.formFieldData instanceof n.m)return"CheckBox";if(e.formFieldData instanceof n.n)return"DropDown"}},e.prototype.getCurrentFormField=function(e){var t;if(e||this.documentHelper.isFormFillProtectedMode&&this.owner.documentEditorSettings.formFieldSettings&&"Inline"===this.owner.documentEditorSettings.formFieldSettings.formFillingMode)for(var o=0;o<this.documentHelper.formFields.length;o++){var s=this.documentHelper.formFields[o],l=this.start,d=this.end;if(this.isForward||(l=this.end,d=this.start),r.a.isLinkedFieldCharacter(s)){var h=s.fieldSeparator.line.getOffset(s.fieldSeparator,1),c=new p.a(this.owner);c.setPositionParagraph(s.fieldSeparator.line,h);var u=s.fieldEnd;h=u.line.getOffset(u,0);var g=new p.a(this.owner);if(g.setPositionParagraph(u.line,h),(l.isExistAfter(c)||l.isAtSamePosition(c))&&(d.isExistBefore(g)||d.isAtSamePosition(g))){t=s;break}}}else t=this.getHyperlinkField(!0);if(t instanceof n.b&&0===t.fieldType&&!i.i(a.isNullOrUndefined)(t.formFieldData))return t},e.prototype.getCurrentTextFrame=function(){var e=this.start.paragraph.containerWidget;do{if(e instanceof n.i)return e;e&&(e=e.containerWidget)}while(e);return null},e.prototype.isTableSelected=function(e){var t=this.start,r=this.end;if(this.isForward||(t=this.end,r=this.start),i.i(a.isNullOrUndefined)(t.paragraph.associatedCell)||i.i(a.isNullOrUndefined)(r.paragraph.associatedCell))return!1;var o=t.paragraph.associatedCell.ownerTable.getSplitWidgets(),s=this.getFirstBlockInFirstCell(o[0]),l=this.getLastBlockInLastCell(o[o.length-1]);if(e){for(var d=l.associatedCell.ownerTable;d.containerWidget instanceof n.j;)d=d.containerWidget.ownerTable;l=this.getLastBlockInLastCell(d)}return t.paragraph.associatedCell.equals(s.associatedCell)&&r.paragraph.associatedCell.equals(l.associatedCell)&&(!s.associatedCell.equals(l.associatedCell)||0===t.offset&&r.offset===this.getLineLength(l.lastChild)+1)},e.prototype.selectListText=function(){var e=this.documentHelper.selectionLineWidget,t=e.getHierarchicalIndex("0"),i=this.getTextPosition(t),n=this.getTextPosition(t);this.isSelectList=!0,this.selectRange(i,n),this.isSelectList=!1,this.highlightListText(this.documentHelper.selectionLineWidget),this.contextTypeInternal="List"},e.prototype.highlightListText=function(e){var t=e.children[0].width,i=this.documentHelper.getLeftValue(e),n=e.paragraph.y;this.createHighlightBorder(e,t,i,n,!1),this.documentHelper.isListTextSelected=!0},e.prototype.updateImageSize=function(e){this.owner.isShiftingEnabled=!0;var t=this.start,i=this.end;this.isForward||(t=this.end,i=this.start);var r=null,o=0,s=t.paragraph;if(s===i.paragraph&&t.offset+1===i.offset){var a=s.getInline(i.offset,o);r=a.element,o=a.index}if(r instanceof n.r||r instanceof n.s){var l=r.width,d=r.height,h=r.alternateText;if(r.width=e.width,r.height=e.height,r.alternateText=e.alternatetext,e.width=l,e.height=d,e.alternatetext=h,null!==s&&null!==s.containerWidget&&this.owner.editorModule){var c=s.childWidgets.indexOf(r.line),p=r.line.children.indexOf(r);this.documentHelper.layout.reLayoutParagraph(s,c,p),this.highlightSelection(!1)}}},e.prototype.getSelectedCellsInTable=function(e,t,i){for(var n=t.columnIndex,r=i.columnIndex+i.cellFormat.columnSpan-1,o=t.ownerRow.index,s=i.ownerRow.index,a=[],l=0;l<e.childWidgets.length;l++){var d=e.childWidgets[l];if(d.index>=o&&d.index<=s)for(var h=0;h<d.childWidgets.length;h++){var c=d.childWidgets[h];c.columnIndex>=n&&c.columnIndex<=r&&a.push(c)}if(d.index>s)break}return a},e.prototype.copy=function(){this.isEmpty||this.copySelectedContent(!1)},e.prototype.copySelectedContent=function(e){i.i(a.isNullOrUndefined)(this.owner.sfdtExportModule)||(this.owner.editor.isCopying=!0,this.copyToClipboard(this.getHtmlContent()),this.owner.editor.isCopying=!1,e&&this.owner.editorModule&&this.owner.editorModule.handleCut(this),this.owner.enableAutoFocus&&this.documentHelper.updateFocus())},e.prototype.writeSfdt=function(){var e=this.start,t=this.end;return this.isForward||(e=this.end,t=this.start),this.owner.sfdtExportModule.write(this.owner.documentEditorSettings.optimizeSfdt?1:0,e.currentWidget,e.offset,t.currentWidget,t.offset,!0)},e.prototype.getHtmlContent=function(){var e=this.writeSfdt();this.owner.editorModule&&(this.owner.editorModule.copiedData=JSON.stringify(e));var t=this.owner.documentEditorSettings.optimizeSfdt;return this.htmlWriter.writeHtml(e,t)},e.prototype.copyToClipboard=function(e){window.getSelection().removeAllRanges();var t,i=/Android|Windows Phone|iPhone|Trident|webOS/i.test(navigator.userAgent),n=document.createElement("div");if(n.style.left="-10000px",n.style.top="-10000px",n.style.position="relative",n.innerHTML=e,i)document.body.appendChild(n);else{t=document.createElement("div");t.attachShadow({mode:"open"}).appendChild(n),document.body.appendChild(t)}void 0!==navigator&&-1!==navigator.userAgent.indexOf("Firefox")&&(n.contentEditable="true");var r=document.createRange();r.selectNodeContents(n),window.getSelection().addRange(r);var o=!1;try{o=document.execCommand("copy")}catch(e){}finally{window.getSelection().removeAllRanges(),n.parentNode.removeChild(n),i||t.parentNode.removeChild(t)}return o},e.prototype.showCaret=function(){var e=i.i(a.isNullOrUndefined)(this.documentHelper.currentPage)?this.documentHelper.currentRenderingPage:this.documentHelper.currentPage;if(!(i.i(a.isNullOrUndefined)(e)||this.documentHelper.isRowOrCellResizing||this.owner.enableImageResizerMode&&this.owner.imageResizerModule.isImageResizerVisible&&!this.owner.imageResizerModule.isShapeResize)){var t,n=e.boundingRectangle.x;if(t=this.viewer instanceof s.D?e.boundingRectangle.width*this.documentHelper.zoomFactor+n:e.boundingRectangle.width-this.owner.viewer.padding.right-this.documentHelper.scrollbarWidth,!this.owner.enableImageResizerMode||!this.owner.imageResizerModule.isImageResizerVisible||this.owner.imageResizerModule.isShapeResize)if(this.isHideSelection(this.start.paragraph))this.caret.style.display="none";else if(this.isEmpty&&(!this.owner.isReadOnly||this.owner.enableCursorOnReadOnly||this.isInlineFormFillMode())){var r=parseInt(this.caret.style.left.replace("px",""),10);this.caret.style.display=r<n||r>t?"none":"block"}else this.isImageSelected&&!this.owner.enableImageResizerMode?this.caret.style.display="block":("block"===this.caret.style.display||i.i(a.isNullOrUndefined)(this))&&(this.documentHelper.isComposingIME||(this.caret.style.display="none"));if(i.i(a.isNullOrUndefined)(this)||!this.documentHelper.isTouchInput||this.owner.isReadOnlyMode)this.documentHelper.touchStart.style.display="none",this.documentHelper.touchEnd.style.display="none";else{var o=parseInt(this.documentHelper.touchStart.style.left.replace("px",""),10)+14,l=parseInt(this.documentHelper.touchEnd.style.left.replace("px",""),10)+14,d=this.getSelectionPage(this.start);d&&(this.documentHelper.touchEnd.style.display=l<n||l>t?"none":"block",this.isEmpty||(n=d.boundingRectangle.x,t=d.boundingRectangle.width*this.documentHelper.zoomFactor+n),this.documentHelper.touchStart.style.display=o<n||o>t?"none":"block")}}},e.prototype.setEditableDivCaretPosition=function(e){this.documentHelper.editableDiv.focus();var t=this.documentHelper.editableDiv.childNodes[this.documentHelper.editableDiv.childNodes.length-1];if(t){var i=document.createRange();i.setStart(t,e),i.collapse(!0),window.getSelection().removeAllRanges(),window.getSelection().addRange(i)}},e.prototype.initCaret=function(){this.caret=i.i(a.createElement)("div",{styles:"position:absolute",className:"e-de-blink-cursor e-de-cursor-animation"}),this.caret.style.display="none",this.owner.documentHelper.viewerContainer.appendChild(this.caret)},e.prototype.updateCaretPosition=function(){var e=this.end.location,t=this.getSelectionPage(this.end);if(t&&!i.i(a.isNullOrUndefined)(this.caret)){this.caret.style.left=t.boundingRectangle.x+Math.round(e.x)*this.documentHelper.zoomFactor+"px";var n=this.updateCaretSize(this.owner.selection.end),r=n.topMargin,o=this.viewer,s=(t.boundingRectangle.y-o.pageGap*(this.documentHelper.pages.indexOf(t)+1))*this.documentHelper.zoomFactor+o.pageGap*(this.documentHelper.pages.indexOf(t)+1);this.caret.style.top=s+Math.round(e.y+r)*this.documentHelper.zoomFactor+"px","Subscript"===this.owner.selection.characterFormat.baselineAlignment&&(this.caret.style.top=parseFloat(this.caret.style.top)+parseFloat(this.caret.style.height)/2+"px"),(this.documentHelper.isTouchInput||"none"!==this.documentHelper.touchStart.style.display)&&(this.documentHelper.touchStart.style.left=t.boundingRectangle.x+(Math.round(e.x)*this.documentHelper.zoomFactor-14)+"px",this.documentHelper.touchStart.style.top=s+(e.y+n.height)*this.documentHelper.zoomFactor+"px",this.documentHelper.touchEnd.style.left=t.boundingRectangle.x+(Math.round(e.x)*this.documentHelper.zoomFactor-14)+"px",this.documentHelper.touchEnd.style.top=s+(e.y+n.height)*this.documentHelper.zoomFactor+"px")}this.showHidePasteOptions(this.caret.style.top,this.caret.style.left)},e.prototype.showHidePasteOptions=function(e,t){if(!a.Browser.isIE)if(this.isViewPasteOptions){if(this.pasteElement&&"block"===this.pasteElement.style.display)return;this.createPasteElement(e,t)}else this.pasteElement&&(this.pasteElement.style.display="none",i.i(a.isNullOrUndefined)(this.owner.editor)||(this.owner.editor.isHtmlPaste=!1))},e.prototype.getRect=function(e){var t=e.location,i=this.getSelectionPage(e);if(i){var n=this.owner.documentHelper,o=i.boundingRectangle.x+Math.round(t.x)*n.zoomFactor,s=this.viewer.pageGap,a=(i.boundingRectangle.y-s*(i.index+1))*n.zoomFactor+s*(i.index+1),l=a+Math.round(t.y)*n.zoomFactor;return new r.b(o,l)}return new r.b(0,0)},e.prototype.getSelectionPage=function(e){var t=this.getLineWidgetInternal(e.currentWidget,e.offset,!0);if(t)return this.getPage(t.paragraph)},e.prototype.updateCaretSize=function(e,t){var n,r=0,o=!1,s=0,l=0;if(this.characterFormat.italic&&(o=this.characterFormat.italic),e.paragraph.isEmpty()){var d=e.paragraph,h=0,c=this.getParagraphMarkSize(d,r,h);r=c.topMargin,h=c.bottomMargin;var p=c.height;l=r<0?r+p:p,t||(this.caret.style.height=l*this.documentHelper.zoomFactor+"px"),r=0}else{var u=e.currentWidget.getInline(e.offset,s);s=u.index;var g=u.element;i.i(a.isNullOrUndefined)(g)||(n=this.getCaretHeight(g,s,g.characterFormat,!0,r,o),l=n.height,t||(this.caret.style.height=n.height*this.documentHelper.zoomFactor+"px"))}return t||(this.caret.style.transform=o?"rotate(13deg)":""),{topMargin:r,height:l}},e.prototype.updateCaretToPage=function(e,t){if(!i.i(a.isNullOrUndefined)(t))if(this.documentHelper.selectionEndPage=t,this.owner.selection.isEmpty)this.documentHelper.selectionStartPage=t;else{var n=this.getLineWidgetParagraph(e.offset,e.paragraph.childWidgets[0]),r=this.getPage(n.paragraph);i.i(a.isNullOrUndefined)(r)||(this.documentHelper.selectionStartPage=r)}this.owner.enableAutoFocus&&this.checkForCursorVisibility()},e.prototype.getCaretBottom=function(e,t){var i=e.location.y;if(e.paragraph.isEmpty()){var n=e.paragraph,o=0,s=0,a=this.getParagraphMarkSize(n,o,s);o=a.topMargin,s=a.bottomMargin,i+=a.height,i+=o,t||(i+=s)}else{var l=0,d=e.paragraph.getInline(e.offset,l),h=d.element;l=d.index;var o=0,c=!1,p=this.getCaretHeight(h,l,h.characterFormat,!1,o,c);o=p.topMargin,c=p.isItalic,i+=p.height,t&&(i-=r.a.convertPointToPixel(this.documentHelper.layout.getAfterSpacing(e.paragraph)))}return i},e.prototype.checkForCursorVisibility=function(){this.showCaret()},e.prototype.onKeyDownInternal=function(e,t,r,o){var s=e.which||e.keyCode;if(this.owner.focusIn(),!t||r||o)if(!r||t||o)if(r&&t&&!o)switch(s){case 32:this.owner.editor.insertText(String.fromCharCode(160));break;case 35:this.handleControlShiftEndKey();break;case 36:this.handleControlShiftHomeKey();break;case 37:this.handleControlShiftLeftKey();break;case 38:this.handleControlShiftUpKey();break;case 39:this.handleControlShiftRightKey();break;case 40:this.handleControlShiftDownKey();break;case 56:this.owner.toggleShowHiddenMarksInternal()}else switch(s){case 33:e.preventDefault(),this.handlePageUpPageDownKey(!1,r);break;case 34:e.preventDefault(),this.handlePageUpPageDownKey(!0,r);break;case 35:this.handleEndKey(),e.preventDefault();break;case 36:this.handleHomeKey(),e.preventDefault();break;case 37:this.handleLeftKey(),e.preventDefault();break;case 38:this.handleUpKey(),e.preventDefault();break;case 39:this.handleRightKey(),e.preventDefault();break;case 40:this.handleDownKey(),e.preventDefault()}else switch(this.documentHelper.isCompleted=!1,s){case 33:e.preventDefault(),this.handlePageUpPageDownKey(!1,r);break;case 34:e.preventDefault(),this.handlePageUpPageDownKey(!0,r);break;case 35:this.handleShiftEndKey(),e.preventDefault();break;case 36:this.handleShiftHomeKey(),e.preventDefault();break;case 37:this.handleShiftLeftKey(),e.preventDefault();break;case 38:this.handleShiftUpKey(),e.preventDefault();break;case 39:this.handleShiftRightKey(),e.preventDefault();break;case 40:this.handleShiftDownKey(),e.preventDefault()}else switch(this.documentHelper.isControlPressed=!0,s){case 35:this.handleControlEndKey();break;case 36:this.handleControlHomeKey();break;case 37:this.handleControlLeftKey();break;case 38:this.handleControlUpKey();break;case 39:this.handleControlRightKey();break;case 40:this.handleControlDownKey();break;case 65:this.owner.selection.selectAll();break;case 67:e.preventDefault(),this.copy();break;case 70:e.preventDefault(),i.i(a.isNullOrUndefined)(this.owner.optionsPaneModule)||this.owner.optionsPaneModule.showHideOptionsPane(!0)}if(this.isFormField()&&!this.documentHelper.isDocumentProtected){var l=this.getCurrentFormField(!0);if(l&&l.formFieldData instanceof n.n){l=37===e.keyCode||38===e.keyCode||40===e.keyCode?l:l.nextElement instanceof n.e?l.nextElement.reference:l.fieldEnd;var d=39===e.keyCode?1:0,h=l.line.getOffset(l,d),c=this.getPhysicalPositionInternal(l.line,h,!1);this.selectInternal(l.line,l,d,c)}}!this.owner.isReadOnlyMode||this.documentHelper.isCommentOnlyMode||this.isInlineFormFillMode()?this.owner.editorModule.onKeyDownInternal(e,t,r,o):this.documentHelper.isDocumentProtected&&"FormFieldsOnly"===this.documentHelper.protectionType&&(9!==e.keyCode&&32!==e.keyCode||this.owner.editorModule.onKeyDownInternal(e,t,r,o)),this.owner.searchModule&&!i.i(a.isNullOrUndefined)(this.owner.searchModule.searchHighlighters)&&this.owner.searchModule.searchHighlighters.length>0&&this.owner.searchModule.searchResults.clear(),27!==e.keyCode&&27!==e.which||(i.i(a.isNullOrUndefined)(this.owner.optionsPaneModule)||(this.owner.optionsPaneModule.showHideOptionsPane(!1),this.documentHelper.updateFocus()),this.owner.enableHeaderAndFooter&&this.disableHeaderFooter())},e.prototype.checkAndEnableHeaderFooter=function(e,t){var i=this.documentHelper.currentPage;if(this.isCursorInsidePageRect(e,i)){if(this.isCursorInHeaderRegion(e,i))return!this.owner.enableHeaderAndFooter&&this.enableHeadersFootersRegion(i.headerWidget,i);if(this.isCursorInFooterRegion(e,i))return!this.owner.enableHeaderAndFooter&&this.enableHeadersFootersRegion(i.footerWidget,i)}return!!this.owner.enableHeaderAndFooter&&(this.owner.enableHeaderAndFooter=!1,this.documentHelper.updateTextPositionForSelection(t,1),!0)},e.prototype.isCursorInsidePageRect=function(e,t){return this.viewer.containerLeft+e.x>=t.boundingRectangle.x&&this.viewer.containerLeft+e.x<=t.boundingRectangle.x+t.boundingRectangle.width*this.documentHelper.zoomFactor&&this.viewer instanceof s.D||this.viewer.containerLeft+e.x>=t.boundingRectangle.x&&this.viewer.containerLeft+e.x<=t.boundingRectangle.x+t.boundingRectangle.width},e.prototype.isCursorInHeaderRegion=function(e,t){if(this.viewer instanceof s.D){var i=this.getPageTop(t),n=0,o=t.headerWidget;o&&(n=o.y+o.height);var a=o.isEmpty&&!this.owner.enableHeaderAndFooter,l=r.a.convertPointToPixel(t.bodyWidgets[0].sectionFormat.topMargin),d=r.a.convertPointToPixel(t.bodyWidgets[0].sectionFormat.pageHeight),h=a?l:Math.min(Math.max(n,l),d/100*40);if(h*=this.documentHelper.zoomFactor,this.viewer.containerTop+e.y>=i&&this.viewer.containerTop+e.y<=i+h)return!0}return!1},e.prototype.isCursorInFooterRegion=function(e,t){if(this.viewer instanceof s.D){var i=t.boundingRectangle,n=this.getPageTop(t),o=n+i.height*this.documentHelper.zoomFactor,a=r.a.convertPointToPixel(t.bodyWidgets[0].sectionFormat.footerDistance),l=0;t.footerWidget&&(l=t.footerWidget.height);var d=r.a.convertPointToPixel(t.bodyWidgets[0].sectionFormat.bottomMargin),h=t.footerWidget.isEmpty&&!this.owner.enableHeaderAndFooter,c=i.height;if(c=h?(c-d)*this.documentHelper.zoomFactor:(c-Math.min(i.height/100*40,Math.max(l+a,d)))*this.documentHelper.zoomFactor,this.viewer.containerTop+e.y<=o&&this.viewer.containerTop+e.y>=n+c)return!0}return!1},e.prototype.enableHeadersFootersRegion=function(e,t){return this.viewer instanceof s.D&&(this.owner.enableHeaderAndFooter=!0,e.page=t,this.comparePageWidthAndMargins(e,t),this.updateTextPositionForBlockContainer(e),this.shiftBlockOnHeaderFooterEnableDisable(),!0)},e.prototype.comparePageWidthAndMargins=function(e,t){var n,r=e.headerFooterType,o=-1!=r.indexOf("Header"),s=!1;if(n=o?t.headerWidgetIn:t.footerWidgetIn,!i.i(a.isNullOrUndefined)(n)){var l=e.sectionFormat,d=n.sectionFormat;i.i(a.isNullOrUndefined)(l)||i.i(a.isNullOrUndefined)(d)||(o?e.width==n.width&&l.headerDistance==d.headerDistance||(s=!0):e.width==n.width&&l.footerDistance==d.footerDistance||(s=!0)),s&&(this.owner.viewer.updateHFClientArea(e.sectionFormat,o),e=this.documentHelper.layout.layoutHeaderFooterItems(this.owner.viewer,e))}},e.prototype.shiftBlockOnHeaderFooterEnableDisable=function(){for(var e=0;e<this.documentHelper.headersFooters.length;e++){var t=this.documentHelper.headersFooters[e],n=this.getBodyWidgetInternal(e,0);if(!i.i(a.isNullOrUndefined)(n))for(var r=n.sectionFormat,o=0,s=Object.keys(t);o<s.length;o++){var l=s[o],d=t[l];d.isEmpty&&this.owner.editor.shiftPageContent(d.headerFooterType,r)}}},e.prototype.updateTextPositionForBlockContainer=function(e){var t=e.firstChild;t instanceof n.u&&(t=this.getFirstBlockInFirstCell(t))instanceof n.u&&(t=this.getFirstBlockInFirstCell(t)),this.selectParagraphInternal(t,!0)},e.prototype.disableHeaderFooter=function(){var e=this.getPage(this.start.paragraph);this.updateTextPositionForBlockContainer(e.bodyWidgets[0]),this.owner.enableHeaderAndFooter=!1,this.shiftBlockOnHeaderFooterEnableDisable()},e.prototype.clear=function(){this.editRegionHighlighters&&this.editRegionHighlighters.clear(),this.editRangeCollection=[],this.selectedWidgets&&this.selectedWidgets.clear()},e.prototype.destroy=function(){i.i(a.isNullOrUndefined)(this.contextTypeInternal)||(this.contextTypeInternal=void 0),this.pasteDropDwn&&(this.pasteDropDwn.destroy(),this.pasteDropDwn=void 0),this.caret=void 0,this.contextTypeInternal=void 0,this.upDownSelectionLength=void 0,this.owner=void 0,this.upDownSelectionLength=void 0,this.isSkipLayouting=void 0,this.isImageSelected=void 0,i.i(a.isNullOrUndefined)(this.documentHelper)||(this.documentHelper=void 0),this.contextTypeInternal=void 0,this.isRetrieveFormatting=void 0,this.characterFormatIn&&this.characterFormatIn.destroy(),this.characterFormatIn=void 0,this.paragraphFormatIn&&this.paragraphFormatIn.destroy(),this.paragraphFormatIn=void 0,this.sectionFormatIn&&this.sectionFormatIn.destroy(),this.sectionFormatIn=void 0,this.tableFormatIn&&this.tableFormatIn.destroy(),this.tableFormatIn=void 0,this.cellFormatIn&&this.cellFormatIn.destroy(),this.cellFormatIn=void 0,this.rowFormatIn&&this.rowFormatIn.destroy(),this.rowFormatIn=void 0,this.imageFormatInternal=void 0,this.skipFormatRetrieval=void 0,this.startInternal=void 0,this.endInternal=void 0,this.htmlWriterIn=void 0,this.toolTipElement=void 0,i.i(a.isNullOrUndefined)(this.toolTipObject)||this.toolTipObject.destroy(),this.toolTipField=void 0,this.isMoveDownOrMoveUp=void 0,this.pasteElement=void 0,this.currentPasteAction=void 0,this.isViewPasteOptions=void 0,this.skipEditRangeRetrieval=void 0,this.editPosition=void 0,i.i(a.isNullOrUndefined)(this.selectedWidgets)||this.selectedWidgets.destroy(),this.isHighlightEditRegionIn=void 0,this.isHighlightFormFields=void 0,this.editRangeCollection=[],this.editRangeCollection=void 0,this.isHightlightEditRegionInternal=void 0,this.isCurrentUser=void 0,this.isHighlightNext=void 0,this.hightLightNextParagraph=void 0,this.isWebLayout=void 0,i.i(a.isNullOrUndefined)(this.editRegionHighlighters)||this.editRegionHighlighters.destroy(),i.i(a.isNullOrUndefined)(this.formFieldHighlighters)||this.formFieldHighlighters.destroy(),this.isCellPrevSelected=void 0,this.currentFormField=void 0},e.prototype.getCellsToSelect=function(e,t,n,r){var o=e.childWidgets;if(!(i.i(a.isNullOrUndefined)(r.paragraph.associatedCell)||!i.i(a.isNullOrUndefined)(r.reference)&&i.i(a.isNullOrUndefined)(r.reference.paragraph.associatedCell))){for(var s=r.paragraph.associatedCell.ownerRow.rowIndex,l=r.reference.paragraph.associatedCell.ownerRow.rowIndex,d=[],h=s;h<=l;h++)for(var c=o[h],p=t;p<=n;p++){var u=c.childWidgets[p];i.i(a.isNullOrUndefined)(u)||d.push(u)}return d}},e.prototype.selectBookmarkInTable=function(e){this.documentHelper.clearSelectionHighlight();var t=parseInt(e.properties.columnFirst),n=parseInt(e.properties.columnLast),r=e.paragraph.associatedCell.ownerTable,o=this.getCellsToSelect(r,t,n,e);if(!i.i(a.isNullOrUndefined)(o))for(var s=0;s<o.length;s++)this.highlightCellWidget(o[s])},e.prototype.navigateBookmark=function(e,t,r){var o=this.documentHelper.bookmarks;if(o.containsKey(e)){var s=o.get(e);if(i.i(a.isNullOrUndefined)(s.properties)){var l=s.line.getOffset(s,0);r&&l++;var d=new p.a(this.owner);if(d.setPositionParagraph(s.line,l),t)this.documentHelper.selection.selectRange(d,d,!0);else{var h=s.reference;s.reference&&null==s.reference.line.paragraph.bodyWidget&&(h=s);var c=h.line.getOffset(h,1);h instanceof n.e&&!r&&(i.i(a.isNullOrUndefined)(h.properties)||h.properties.isAfterParagraphMark&&(c=h.line.getOffset(h,1))),r&&c--;var u=new p.a(this.owner);u.setPositionParagraph(h.line,c),this.documentHelper.selection.selectRange(d,u,!0)}}else this.selectBookmarkInTable(s)}},e.prototype.selectBookmark=function(e,t){this.navigateBookmark(e,void 0,t)},e.prototype.getTocField=function(){for(var e=this.start.paragraph,t=void 0;void 0!==e&&this.isTocStyle(e);)t=e,e=e.previousRenderedWidget;if(void 0!==t){var i=t.childWidgets[0];if(void 0!==i)return i.children[0]}},e.prototype.isTocStyle=function(e){var t=e.paragraphFormat.baseStyle;return void 0!==t&&-1!==t.name.toLowerCase().indexOf("toc")},e.prototype.isTOC=function(){for(var e=this.getParagraphInfo(this.start),t=e.paragraph,i=0;i<t.childWidgets[0].children.length;i++){var r=t.childWidgets[0].children[i];if(r instanceof n.b){var o=this.owner.selection.getFieldCode(r);if(o.match("TOC ")||o.match("Toc"))return!0}}return!1},e.prototype.getElementsForward=function(e,t,n,r){if(!i.i(a.isNullOrUndefined)(t)){for(var o=[],s=e.children.indexOf(t);s>=0;){for(var l=s;l<e.children.length;l++){var d=e.children[l];if(d.line!==e){s=-1;break}if(d===n){o.push(d),s=-1;break}o.push(d)}s=-1}return 0===o.length?void 0:o}},e.prototype.getElementsBackward=function(e,t,i,r){for(var o=[];r&&t&&t.previousElement&&(!t.isRightToLeft||t instanceof n.d&&this.documentHelper.textHelper.isRTLText(t.text));)t=t.previousElement;for(var s=e.children.indexOf(t);s>=0;){for(var a=s;a>-1&&a<e.children.length;r?a++:a--){var l=e.children[a];if(l.line!==e){s=-1;break}o.push(l)}s=-1}return o},e.prototype.navigatePreviousComment=function(){this.commentNavigateInternal(!1)},e.prototype.navigateNextComment=function(){this.commentNavigateInternal(!0)},e.prototype.commentNavigateInternal=function(e){if(!this.documentHelper.currentSelectedComment){if(0===this.documentHelper.comments.length)return;this.documentHelper.currentSelectedComment=this.documentHelper.comments[0]}if(this.documentHelper.currentSelectedComment){var t=this.documentHelper.comments,i=this.documentHelper.currentSelectedComment,n=t.indexOf(i);i=e?n===t.length-1?t[0]:t[n+1]:0===n?t[t.length-1]:t[n-1],this.documentHelper.currentSelectedComment=i,this.selectComment(i)}},e.prototype.navigatePreviousRevision=function(){this.revisionNavigateInternal(!1)},e.prototype.navigateNextRevision=function(){this.revisionNavigateInternal(!0)},e.prototype.revisionNavigateInternal=function(e){if(!this.documentHelper.currentSelectedRevisionInternal){if(0===this.documentHelper.owner.revisions.length)return;this.documentHelper.currentSelectedRevision=this.documentHelper.owner.revisions.get(0)}if(this.documentHelper.currentSelectedRevision){var t=this.documentHelper.owner.revisions.changes,i=this.documentHelper.currentSelectedRevision,n=t.indexOf(i);i=e?n===t.length-1?t[0]:t[n+1]:0===n?t[t.length-1]:t[n-1],this.documentHelper.currentSelectedRevision=i,this.selectRevision(i)}this.owner.trackChangesPane.currentSelectedRevision=this.documentHelper.currentSelectedRevision},e.prototype.selectComment=function(e){if(!i.i(a.isNullOrUndefined)(e)){var t=this.getElementPosition(e.commentStart,!0).startPosition,n=this.getElementPosition(e.commentEnd,!1).startPosition;this.owner.commentReviewPane&&this.owner.commentReviewPane.selectComment(e),this.selectPosition(t,n)}},e.prototype.selectRevision=function(e){if(!i.i(a.isNullOrUndefined)(e)&&e.range.length>0){var t=e.range[0],r=e.range[e.range.length-1];if(t instanceof s.f){var o=t.ownerBase,l=o.childWidgets[0],d=o.childWidgets[o.childWidgets.length-1],h=this.getFirstParagraph(l),c=this.getLastParagraph(d);this.start.setPosition(h.firstChild,!0),this.end.setPositionParagraph(c.lastChild,c.lastChild.getEndOffset()+1),this.selectPosition(this.start,this.end)}else if(t&&r){var u=new p.a(this.owner),g=0;if(t instanceof s.g){var f=t.ownerBase;g=f.childWidgets.length>1?this.getParagraphLength(f)-this.getParagraphLength(f,f.lastChild):f.getLength(),u.setPositionParagraph(f.lastChild,g)}else{g=t.line.getOffset(t,0);var m=t.line;if(m.isFirstLine())for(var v=0;v<m.children.length;v++){if(t===m.children[v]&&m.children[v]instanceof n.d){g=0;break}if(m.children[v]instanceof n.d)break}u.setPositionForLineWidget(t.line,g)}var y=new p.a(this.owner);if(r instanceof s.g){var f=r.ownerBase,w=f.getSplitWidgets();f=w[w.length-1],(f.isEndsWithPageBreak||f.isEndsWithColumnBreak)&&(this.owner.trackChangesPane.isTrackingPageBreak=!0),g=f.childWidgets.length>1?this.getParagraphLength(f)-this.getParagraphLength(f,f.lastChild):f.getLength(),y.setPositionParagraph(f.lastChild,g+1)}else g=r.line.getOffset(r,0)+r.length,this.isTOC()&&(g+=1),y.setPositionForLineWidget(r.line,g);var b=u.clone();u.isExistBefore(y)||(u=y,y=b),this.selectPosition(u,y)}}},e.prototype.selectTableRevision=function(e){if(!i.i(a.isNullOrUndefined)(e)&&e[0].range.length>0){var t=e[0].range[0],n=e[e.length-1].range[0];if(t instanceof s.f){var r=t.ownerBase,o=r.childWidgets[0],l=n.ownerBase,d=l.childWidgets[l.childWidgets.length-1],h=this.getFirstParagraph(o),c=this.getLastParagraph(d);this.start.setPosition(h.firstChild,!0),this.end.setPositionParagraph(c.lastChild,c.lastChild.getEndOffset()+1),this.selectPosition(this.start,this.end)}}},e.prototype.updateEditRangeCollection=function(){this.editRangeCollection.length>0&&(this.editRangeCollection=[]);var e,t;if(this.documentHelper.isDocumentProtected){if(this.documentHelper.editRanges.containsKey(this.owner.currentUser)){e=this.documentHelper.editRanges.get(this.owner.currentUser);for(var i=0;i<e.length;i++)this.editRangeCollection.push(e[i])}if(this.documentHelper.editRanges.containsKey("Everyone")){var n="Everyone";t=this.documentHelper.editRanges.get(n);for(var i=0;i<t.length;i++)this.editRangeCollection.push(t[i])}}else for(var r=0;r<this.documentHelper.editRanges.length;r++){var n=this.documentHelper.editRanges.keys[r];e=this.documentHelper.editRanges.get(n);for(var i=0;i<e.length;i++)this.editRangeCollection.push(e[i])}},e.prototype.onHighlight=function(){this.isHighlightEditRegion?this.highlightEditRegion():this.unHighlightEditRegion(),this.viewer.renderVisiblePages()},e.prototype.highlightEditRegion=function(){if(this.updateEditRangeCollection(),this.owner.enableLockAndEdit)return void this.viewer.updateScrollBars();if(!this.isHighlightEditRegion)return void this.unHighlightEditRegion();this.isHightlightEditRegionInternal=!0,i.i(a.isNullOrUndefined)(this.editRegionHighlighters)&&(this.editRegionHighlighters=new l.a),this.editRegionHighlighters.clear();for(var e=0;e<this.editRangeCollection.length;e++)this.highlightEditRegionInternal(this.editRangeCollection[e]);this.isHightlightEditRegionInternal=!1,this.viewer.updateScrollBars()},e.prototype.highlightFormFields=function(){i.i(a.isNullOrUndefined)(this.formFieldHighlighters)&&(this.formFieldHighlighters=new l.a),this.formFieldHighlighters.clear();var e=this.documentHelper.formFields;if(!i.i(a.isNullOrUndefined)(e)&&e.length>0){for(var t=0;t<e.length;t++){var n=e[t];if(r.a.isLinkedFieldCharacter(n)){var o=n.line.getOffset(n,0),s=new p.a(this.owner);s.setPositionParagraph(n.line,o);var d=n.fieldEnd;o=d.line.getOffset(d,1);var h=new p.a(this.owner);h.setPositionParagraph(d.line,o),this.isHighlightFormFields=!0,this.highlight(s.paragraph,s,h),this.isHighlightNext&&(this.highlightNextBlock(this.hightLightNextParagraph,s,h),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0)}}this.isHighlightFormFields=!1,this.viewer.updateScrollBars()}},e.prototype.unHighlightEditRegion=function(){i.i(a.isNullOrUndefined)(this.editRegionHighlighters)||(this.editRegionHighlighters.clear(),this.editRegionHighlighters=void 0),this.isHightlightEditRegionInternal=!1},e.prototype.highlightEditRegionInternal=function(e){var t=this.getPosition(e),i=t.startPosition,n=t.endPosition;this.isCurrentUser=!0,this.highlightEditRegions(e,i,n),this.isCurrentUser=!1},e.prototype.showAllEditingRegion=function(){0===this.editRangeCollection.length&&this.updateEditRangeCollection(),this.documentHelper.clearSelectionHighlight();for(var e=0;e<this.editRangeCollection.length;e++){var t=this.editRangeCollection[e],i=this.getPosition(t),n=i.startPosition,r=i.endPosition;this.highlightEditRegions(t,n,r)}},e.prototype.highlightEditRegions=function(e,t,i){if(!e.line.paragraph.isInsideTable||e.line.paragraph.isInsideTable&&!e.editRangeEnd.line.paragraph.isInsideTable||-1===e.columnFirst)this.highlight(e.line.paragraph,t,i),this.isHighlightNext&&(this.highlightNextBlock(this.hightLightNextParagraph,t,i),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0);else{var r=e.line.paragraph.associatedCell.ownerRow,o=r.childWidgets[e.columnFirst];if(o)for(var s=0;s<o.childWidgets.length;s++)o.childWidgets[s]instanceof n.g&&(this.highlight(o.childWidgets[s],t,i),this.isHighlightNext&&(this.highlightNextBlock(this.hightLightNextParagraph,t,i),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0))}},e.prototype.navigateToNextEditingRegion=function(){var e=this.getEditRangeStartElement();if(this.editRangeCollection.length>0){this.sortEditRangeCollection();var t=this.editRangeCollection.length,n=t;i.i(a.isNullOrUndefined)(e)||(n=this.editRangeCollection.indexOf(e));var r=n<t-1?this.editRangeCollection[n+1]:this.editRangeCollection[0],o=this.getPosition(r),s=o.startPosition,l=o.endPosition;this.selectRange(s,l)}},e.prototype.sortEditRangeCollection=function(){for(var e=this.editRangeCollection.length-1;e>=0;e--)for(var t=1;t<=e;t++){var i=this.getPosition(this.editRangeCollection[t-1]).startPosition,n=this.getPosition(this.editRangeCollection[t]).startPosition;if(i.isExistAfter(n)){var r=this.editRangeCollection[t-1];this.editRangeCollection[t-1]=this.editRangeCollection[t],this.editRangeCollection[t]=r}}},e.prototype.toggleEditingRegionHighlight=function(){this.isHighlightEditRegion=!this.isHighlightEditRegion},e.prototype.getEditRangeStartElement=function(){for(var e=0;e<this.editRangeCollection.length;e++){var t=this.editRangeCollection[e],i=this.getPosition(t),n=i.startPosition,r=i.endPosition;if((this.start.isExistAfter(n)||this.start.isAtSamePosition(n))&&(this.end.isExistBefore(r)||this.end.isAtSamePosition(r)))return t}},e.prototype.isSelectionInEditRegion=function(){return!!this.documentHelper.isDocumentProtected&&this.checkSelectionIsAtEditRegion()},e.prototype.checkSelectionIsAtEditRegion=function(e,t){i.i(a.isNullOrUndefined)(e)&&i.i(a.isNullOrUndefined)(t)&&(e=this.start,t=this.end,this.isForward||(e=this.end,t=this.start));for(var n=0;n<this.editRangeCollection.length;n++){var r=this.editRangeCollection[n];if(!r.line.paragraph.isInsideTable||r.line.paragraph.isInsideTable&&!r.editRangeEnd.line.paragraph.isInsideTable||-1===r.columnFirst){if(this.isSelectionInsideEditRange(r,e,t))return!0}else if(r.paragraph.isInsideTable&&r.editRangeEnd&&r.editRangeEnd.line.paragraph.isInsideTable){var o=r.paragraph.associatedCell.ownerRow,s=e.paragraph.associatedCell,l=t.paragraph.associatedCell;if(!i.i(a.isNullOrUndefined)(s)&&!i.i(a.isNullOrUndefined)(l)&&o.equals(s.ownerRow)&&o.equals(l.ownerRow)&&s.index>=r.columnFirst&&s.index<=r.columnLast)if(this.isEmpty&&s.index===r.line.paragraph.associatedCell.index){if(this.isSelectionInsideEditRange(r,e,t))return!0}else if(!this.isCellSelected(s,e,t))return!0}}return!1},e.prototype.isEditRangeCellSelected=function(e,t){i.i(a.isNullOrUndefined)(e)&&i.i(a.isNullOrUndefined)(t)&&(e=this.start,t=this.end,this.isForward||(e=this.end,t=this.start));for(var n=0;n<this.editRangeCollection.length;n++){var r=this.editRangeCollection[n];if(r.paragraph.isInsideTable&&r.editRangeEnd&&r.editRangeEnd.line.paragraph.isInsideTable){var o=e.paragraph.associatedCell,s=t.paragraph.associatedCell,l=r.paragraph.associatedCell;if(!i.i(a.isNullOrUndefined)(o)&&!i.i(a.isNullOrUndefined)(s)&&o.index>=r.columnFirst&&o.index<=r.columnLast&&this.isCellSelected(l,e,t))return!0}}return!1},e.prototype.isSelectionInsideEditRange=function(e,t,i){var n=this.getPosition(e),r=n.startPosition,o=n.endPosition;return!(!t.isExistAfter(r)&&!t.isAtSamePosition(r)||!i.isExistBefore(o)&&!i.isAtSamePosition(o))},e.prototype.getPosition=function(e){var t=e.line.getOffset(e,1),r=new p.a(this.owner);r.setPositionParagraph(e.line,t);var o;e instanceof n.G?o=e.editRangeEnd:e instanceof n.H?o=e.reference:e instanceof n.e?o=e.reference:e instanceof n.B&&(o=e.comment.commentEnd);var s;return i.i(a.isNullOrUndefined)(o.line)?s=r.clone():(t=o.line.getOffset(o,1),s=new p.a(this.owner),s.setPositionParagraph(o.line,t)),{startPosition:r,endPosition:s}},e.prototype.checkContentControlLocked=function(e){this.owner.editorModule.isXmlMapped=!1;for(var t=0;t<this.documentHelper.contentControlCollection.length;t++){var n=this.documentHelper.contentControlCollection[t],r=this.getPosition(n),o=r.startPosition,s=r.endPosition,l=this.start,h=this.end;if(this.isForward||(l=this.end,h=this.start),i.i(a.isNullOrUndefined)(e)){var c=(o.isExistAfter(l)||o.isAtSamePosition(l))&&(o.isExistBefore(h)||o.isAtSamePosition(h)),p=(s.isExistAfter(l)||s.isAtSamePosition(l))&&(s.isExistBefore(h)||s.isAtSamePosition(h));if(c&&p)return!!n.contentControlProperties.lockContentControl&&(this.owner.trigger(d.p),!0);if((c||p)&&!o.isAtSamePosition(l)&&!s.isAtSamePosition(l)&&(n.contentControlProperties.lockContentControl||n.contentControlProperties.lockContents))return!0}if((l.isExistAfter(o)||l.isAtSamePosition(o))&&(h.isExistBefore(s)||h.isAtSamePosition(s))){if(n.contentControlProperties.xmlMapping&&n.contentControlProperties.xmlMapping.isMapped&&(this.owner.editorModule.isXmlMapped=!0),n.contentControlProperties.lockContents)return this.owner.trigger(d.p),!0;if(i.i(a.isNullOrUndefined)(e)&&("CheckBox"===n.contentControlProperties.type||"ComboBox"===n.contentControlProperties.type||"DropDownList"===n.contentControlProperties.type||"Date"===n.contentControlProperties.type))return this.owner.trigger(d.p),!0}}return!1},e.prototype.getElementPosition=function(e,t){var i=e.line.getOffset(e,t?0:1),n=new p.a(this.owner);return n.setPositionParagraph(e.line,i),{startPosition:n,endPosition:void 0}},e.prototype.updateRefField=function(e){if(i.i(a.isNullOrUndefined)(e)&&(e=this.getHyperlinkField(!0)),!i.i(a.isNullOrUndefined)(e)){if(!this.isReferenceField(e))return;var t=this.getFieldCode(e).replace(/\s+/g," ");if(t=t.trim(),0===t.toLowerCase().indexOf("ref")){var r=t.split(" ");if(r.length>1){var o=r[1];if(this.documentHelper.bookmarks.containsKey(o)){var s=this.start,l=this.end;this.isForward||(s=this.end,l=this.start);var d=this.documentHelper.bookmarks.get(o),h=d.reference,c=d.previousNode;!i.i(a.isNullOrUndefined)(c)&&c instanceof n.b||!h||!(h.previousNode instanceof n.b)||1!==h.previousNode.fieldType||i.i(a.isNullOrUndefined)(h.previousNode.fieldBegin)||i.i(a.isNullOrUndefined)(h.previousNode.fieldBegin.formFieldData)?c instanceof n.b&&0===c.fieldType&&!i.i(a.isNullOrUndefined)(c.formFieldData)&&(d=c.fieldSeparator,h=c.fieldEnd):(d=h.previousNode.fieldBegin.fieldSeparator,h=h.previousNode.fieldBegin.fieldEnd);var p=d.line.getOffset(d,1);s.setPositionParagraph(d.line,p),l.setPositionParagraph(h.line,h.line.getOffset(h,0));var u=this.owner.sfdtExportModule.write(this.owner.documentEditorSettings.optimizeSfdt?1:0,s.currentWidget,s.offset,l.currentWidget,l.offset,!1,!0),g=e.fieldSeparator,f=e.fieldEnd;s.setPositionParagraph(g.line,g.line.getOffset(g,1)),l.setPositionParagraph(f.line,f.line.getOffset(f,0)),this.owner.editor.pasteContents(u)}}}}},e.prototype.footnoteReferenceElement=function(e,t,r){var o=this.getContainerWidget(e.paragraph),s=0;if(o instanceof n.a)for(var l=this.start.paragraph.bodyWidget.footNoteReference,d=0;d<this.documentHelper.pages.length;d++){s=0;for(var h=this.documentHelper.pages[d],c=0;c<h.bodyWidgets.length;c++)for(var p=h.bodyWidgets[c],u=0;u<p.childWidgets.length;u++){var g=p.childWidgets[u];if(g instanceof n.u)for(var f=0;f<g.childWidgets.length;f++)for(var m=g.childWidgets[f],v=0;v<m.childWidgets.length;v++)for(var y=m.childWidgets[v],w=0;w<y.childWidgets.length;w++)for(var b=y.childWidgets[w],x=0;x<b.childWidgets.length;x++){var C=b.childWidgets[x];if(s=0,!i.i(a.isNullOrUndefined)(C.children))for(var I=0;I<C.children.length;I++){var F=C.children[I];s+=F.length,F instanceof n.f&&F===l&&(e.setPositionParagraph(C,s-1),t.setPositionParagraph(C,s),this.selectRange(e,t))}}else for(var k=0;k<g.childWidgets.length;k++){var C=g.childWidgets[k];if(s=0,!i.i(a.isNullOrUndefined)(C.children))for(var I=0;I<C.children.length;I++){var F=C.children[I];s+=F.length,F instanceof n.f&&F===l&&(e.setPositionParagraph(C,s-1),t.setPositionParagraph(C,s),this.selectRange(e,t))}}}}},e.prototype.getAbsolutePositionFromRelativePosition=function(e){var t;t="string"==typeof e?this.getTextPosBasedOnLogicalIndex(e):e;var i=this.getParagraphInfo(t),n={position:0,done:!1};return this.getPositionInfoForHeaderFooter(i,n),n.position},e.prototype.getPositionInfoForBodyContent=function(e,t,n,r){var o=i.i(a.isNullOrUndefined)(n)?this.documentHelper.pages[0].bodyWidgets[0].childWidgets[0]:n;return t.position+=this.getBlockIndex(o,e,t,r),t},e.prototype.getPositionInfoForHeaderFooter=function(e,t,i){return t=this.getPositionInfoForBodyContent(e,t,void 0,i),t.done||this.getBlockIndexFromHeaderFooter(e,t,i),t},e.prototype.getBlockIndexFromHeaderFooter=function(e,t,i){for(var n=this.documentHelper.headersFooters,r=0,o=n;r<o.length;r++)for(var s=o[r],a=0;a<6;a++){var l=s[a];if(l){if(t.position+=this.getBlockIndex(l.childWidgets[0],e,t,i),t.done)return t}else t.position+=1}return t},e.prototype.getBlockIndex=function(e,t,r,o){var s=0,l={length:0};do{if(e instanceof n.g&&!i.i(a.isNullOrUndefined)(t)&&!i.i(a.isNullOrUndefined)(t.paragraph)&&t.paragraph.equals(e)){s+=1;var d=e.getInline(t.offset,0);s+=this.getBlockOffsetByElement(t,e,d.element,d.index,l),this.isEndOffset&&this.end.offset===this.getLineLength(this.end.currentWidget)+1&&(s+=1),r.done=!0;break}if(s=this.getBlockLength(t,e,s,r,!0,o,l),r.done)break;if(!i.i(a.isNullOrUndefined)(e))if(e.containerWidget instanceof n.o&&e.containerWidget.containerWidget instanceof n.a){var h=e.getSplitWidgets().pop().nextRenderedWidget;if(!i.i(a.isNullOrUndefined)(h)&&e.containerWidget!==h.containerWidget)break;e=h}else e=e.getSplitWidgets().pop().nextRenderedWidget}while(e);return s},e.prototype.getBlockTotalLength=function(e,t,i,r,o){for(var s=0,a=!1,l=e.getSplitWidgets(),d=0;d<l.length;d++)for(var h=0;h<l[d].childWidgets.length;h++)for(var c=l[d].childWidgets[h],p=0;p<c.children.length;p++){var u=c.children[p];if(!(u instanceof n.q)){if((u instanceof n.s||u instanceof n.f)&&(u instanceof n.s?u.textFrame.childWidgets.length>0&&(s+=this.getBlockIndex(u.textFrame.childWidgets[0],t,i,void 0)):s+=this.getBlockIndex(u.bodyWidget.childWidgets[0],t,i,void 0),i.done))return s;u instanceof n.b&&0==u.fieldType&&u.formFieldData instanceof n.n&&(a=!0),a&&u instanceof n.b&&1==u.fieldType&&u.previousNode instanceof n.d&&(o.length+=u.previousNode.length,a=!1),s+=u.length}}return s},e.prototype.getBlockLength=function(e,t,r,o,s,l,d){if(e&&t instanceof n.g&&!i.i(a.isNullOrUndefined)(e.paragraph)&&e.paragraph.equals(t)){r+=1;var h=t.getInline(e.offset,0);return r+=this.getBlockOffsetByElement(e,t,h.element,h.index,d),this.isEndOffset&&t.isInsideTable&&t.associatedCell.lastChild.equals(t)&&e.offset===this.getParagraphLength(t)+1&&(r+=1),o.done=!0,r}if(t instanceof n.g)r+=1,r+=s?this.getBlockTotalLength(t,e,o,l,d):t.getTotalLength();else if(t instanceof n.u){if(r+=1,!i.i(a.isNullOrUndefined)(l)&&l instanceof n.u&&l.equals(t))return o.done=!0,r;for(var c=t.firstChild;c;){if(r+=1,!i.i(a.isNullOrUndefined)(l)&&l instanceof n.z&&l.equals(c))return o.done=!0,r;for(var p=c.firstChild;p;){if(r+=1,!i.i(a.isNullOrUndefined)(l)&&l instanceof n.j&&l.equals(p))return o.done=!0,r;for(var u=p.firstChild;u;){if(r=this.getBlockLength(e,u,r,o,s,l,d),o.done)return r;u=u.getSplitWidgets().pop().nextRenderedWidget}p=p.nextWidget}c=c.getSplitWidgets().pop().nextRenderedWidget}}return r},e.prototype.calculateCellLength=function(e){for(var t=e.firstChild,i=0,n={done:!1},r={paragraph:null,offset:0};t;)i=this.getBlockLength(r,t,i,n,!0,void 0,void 0),t=t.getSplitWidgets().pop().nextRenderedWidget;return i},e.prototype.getBlockOffsetByElement=function(e,t,i,r,o){for(var s=0,a=!1,l=t.getSplitWidgets(),d=0;d<l.length;d++)for(var h=0;h<l[d].childWidgets.length;h++)for(var c=l[d].childWidgets[h],p=0;p<c.children.length;p++){var u=c.children[p];if(!(u instanceof n.q)){if(u instanceof n.b&&0==u.fieldType&&u.formFieldData instanceof n.n&&(a=!0),a&&u instanceof n.b&&1==u.fieldType&&u.previousNode instanceof n.d&&(o.length+=u.previousNode.length,a=!1),u===i)return s+r;if(u instanceof n.s||u instanceof n.f)if(u instanceof n.s){if(u.textFrame.childWidgets.length>0)for(var g=0;g<u.textFrame.childWidgets.length;g++)s=this.getBlockLength(e,u.textFrame.childWidgets[g],s,{done:!1},!1,void 0,void 0)}else if(u.bodyWidget.childWidgets.length>0)for(var g=0;g<u.bodyWidget.childWidgets.length;g++)s=this.getBlockLength(e,u.bodyWidget.childWidgets[g],s,{done:!1},!1,void 0,void 0);s+=u.length}}return s},e.prototype.getTableRelativeValue=function(e,t){if(e.currentWidget.paragraph.isInsideTable){if(this.isTableSelected())return 3;if(this.isRowSelect()&&t.paragraph.isInsideTable&&e.paragraph.associatedCell.ownerTable.equals(t.paragraph.associatedCell.ownerTable))return 2;var i=e.paragraph.associatedCell.ownerTable.getSplitWidgets(),r=this.getFirstBlockInFirstCell(i[0]);if(e.paragraph.associatedCell.equals(r.associatedCell)){if(t.paragraph.isInsideTable){if(e.paragraph.associatedCell.ownerTable.equals(t.paragraph.associatedCell.ownerTable))return 0;for(var o=this.isRowSelect()?2:3,s=e.paragraph.associatedCell.ownerTable;s.containerWidget instanceof n.j&&(o+=3,s=s.containerWidget.ownerTable,!s.equals(t.paragraph.associatedCell.ownerTable)););return o}return 3}return t.currentWidget.paragraph.isInsideTable&&e.paragraph.associatedCell.ownerTable.equals(t.paragraph.associatedCell.ownerTable)?0:2}return 0},e.prototype.isRowSelect=function(){var e=this.start,t=this.end;if(this.isForward||(e=this.end,t=this.start),i.i(a.isNullOrUndefined)(e.paragraph.associatedCell)||i.i(a.isNullOrUndefined)(t.paragraph.associatedCell)||e.paragraph.associatedCell.equals(t.paragraph.associatedCell)||this.isTableSelected(!0))return!1;var r=t.paragraph.associatedCell.ownerTable,o=!1;if(r.containerWidget instanceof n.j)for(;r.containerWidget instanceof n.j;){r=r.containerWidget.ownerTable;for(var s=0;s<r.childWidgets.length;s++){var l=r.childWidgets[s];l.childWidgets[l.childWidgets.length-1].equals(r.containerWidget)&&(o=!0)}}else for(var s=0;s<r.childWidgets.length;s++){var d=r.childWidgets[s];d.childWidgets[d.childWidgets.length-1].equals(t.paragraph.associatedCell)&&(o=!0)}var h,c=e.paragraph.associatedCell.ownerRow.getSplitWidgets();return c[0].childWidgets.length>0&&(h=c[0].childWidgets[0]),e.paragraph.associatedCell.equals(h)&&o},e}())},function(e,t,i){"use strict";var n=i(63);i.d(t,"a",function(){return n.a})},function(e,t,i){"use strict";var n=i(126);i.d(t,"a",function(){return n.a});var r=i(127);i.d(t,"b",function(){return r.a})},function(e,t,i){"use strict";i.d(t,"a",function(){return r});var n=i(0),r=(i.n(n),function(){function e(e){this.documentHelper=e,this.optimizedHeightCollection={}}return e.prototype.getModuleName=function(){return"Optimized"},e.prototype.getkeyFromCharFormat=function(e){var t=e.fontFamily.toLocaleLowerCase();return e.bold&&(t+=";bold"),e.italic&&(t+=";italic"),t},e.prototype.getFontInfo=function(e){var t=i.i(n.createElement)("iframe");document.body.appendChild(t);i.i(n.isNullOrUndefined)(t.contentDocument)||(t.contentDocument.open(),t.contentDocument.write("<!DOCTYPE html><html><head></head><body></body></html>"),t.contentDocument.close());var r=document.createElement("div");r.setAttribute("style","position:absolute;top:-1000px;left:-1000px;opacity:0;font-size:0px;line-height:normal;");var o=1/window.devicePixelRatio;r.style.transform="scale("+o.toString()+","+o.toString()+")",r.innerHTML='<span class="e-de-font-info" style="font-size:0; font-family: '+e.fontFamily+'; display: inline-block;">m</span><span class="e-de-font-info" style="font-size:288pt; font-family: '+e.fontFamily+";"+(e.bold?"font-weight:bold;":"")+(e.italic?"font-style:italic;":"")+' display: inline-block;">m</span>',t.contentDocument.body.appendChild(r);var s=r.firstChild.offsetTop/r.lastChild.offsetHeight,a=parseFloat((r.lastChild.offsetHeight/288).toFixed(2));return document.body.removeChild(t),{HeightFactor:a,BaselineFactor:s}},e.prototype.getHeightInternal=function(e){var t=this.getkeyFromCharFormat(e);if(i.i(n.isNullOrUndefined)(this.optimizedHeightCollection[""+t])){var r=this.getFontInfo(e);this.optimizedHeightCollection[""+t]=r;var o=r.HeightFactor*e.fontSize;return{Height:o,BaselineOffset:r.BaselineFactor*o}}var s=this.optimizedHeightCollection[""+t],o=s.HeightFactor*e.fontSize;return{Height:o,BaselineOffset:s.BaselineFactor*o}},e.prototype.destroy=function(){this.documentHelper=void 0,this.optimizedHeightCollection=void 0},e}())},function(e,t,i){"use strict";i.d(t,"a",function(){return r});var n=i(0),r=(i.n(n),function(){function e(e){this.documentHelper=e}return e.prototype.getModuleName=function(){return"Regular"},e.prototype.getHeightInternal=function(e,t){var r=0,o=0,s=document.createElement("span");s.innerText="m";var a=i.i(n.createElement)("iframe");document.body.appendChild(a);i.i(n.isNullOrUndefined)(a.contentDocument)||(a.contentDocument.open(),a.contentDocument.write("<!DOCTYPE html><html><head></head><body></body></html>"),a.contentDocument.close()),this.applyStyle(s,e,t);var l=document.createElement("div");l.setAttribute("style","display:inline-block;position:absolute;");var d=document.createElement("div");d.setAttribute("style","display:inline-block;width: 1px; height: 0px;vertical-align: baseline;"),l.appendChild(s),l.appendChild(d),a.contentDocument.body.appendChild(l),r=s.offsetHeight;var h=s.offsetTop;return o=d.offsetTop-h,document.body.removeChild(a),{Height:r,BaselineOffset:o}},e.prototype.applyStyle=function(e,t,r){if(!i.i(n.isNullOrUndefined)(e)&&!i.i(n.isNullOrUndefined)(t)){var o="white-space:nowrap;";i.i(n.isNullOrUndefined)(r)||""===r?o+="font-family:"+t.fontFamily+";":o+="font-family:"+r+";";var s=t.fontSize;s<=.5&&(s=.5),o+="font-size:"+s.toString()+"pt;",t.bold&&(o+="font-weight:bold;"),t.italic&&(o+="font-style:italic;"),e.setAttribute("style",o)}},e.prototype.destroy=function(){this.documentHelper=void 0},e}())},function(e,t,i){"use strict";var n=i(64);i.d(t,"a",function(){return n.b}),i.d(t,"b",function(){return n.a});var r=i(66);i.d(t,"c",function(){return r.a});var o=i(65);i.d(t,"d",function(){return o.a})},function(e,t,i){"use strict";var n=i(25);i.d(t,"a",function(){return n.b}),i.d(t,"b",function(){return n.a});var r=i(39);i.d(t,"c",function(){return r.a}),i.d(t,"d",function(){return r.b})},function(e,t,i){"use strict";i.d(t,"a",function(){return l});var n=i(0),r=(i.n(n),i(116)),o=i(4),s=i(17),a=function(){function e(e,t){this.width=e,this.height=t}return e.prototype.isEmpty=function(){return 0===this.height&&0===this.width},e.prototype.clone=function(){return new e(this.width,this.height)},e}(),l=function(){function e(){}return e.prototype.hideTabStopSwitch=function(e){this.tabStopStwitch&&this.showHideElement(e,this.tabStopStwitch)},e.prototype.hideRulerBottom=function(e){this.hRulerBottom&&this.showHideElement(e,this.hRulerBottom),this.vRulerBottom&&this.showHideElement(e,this.vRulerBottom)},e.prototype.showHideElement=function(e,t){t.style.display=e?"block":"none"},e.prototype.createHtmlElement=function(e,t){var r=i.i(n.createElement)(e);return this.setAttributeHtml(r,t),r},e.prototype.createSvgElement=function(e,t){var i=document.createElementNS("http://www.w3.org/2000/svg",e);return this.setAttributeSvg(i,t),i},e.prototype.applyStyleAgainstCsp=function(e,t){for(var i=t.split(";"),n=0;n<i.length;n++){var r=i[parseInt(n.toString(),10)].split(":");2===r.length&&(e.style[r[0].trim()]=r[1].trim())}},e.prototype.setAttributeSvg=function(e,t){for(var i=Object.keys(t),n=0;n<i.length;n++)e&&"style"!==i[parseInt(n.toString(),10)]?e.setAttribute(i[parseInt(n.toString(),10)],t[i[parseInt(n.toString(),10)]]):this.applyStyleAgainstCsp(e,t[i[parseInt(n.toString(),10)]])},e.prototype.setAttributeHtml=function(e,t){for(var i=Object.keys(t),n=0;n<i.length;n++)"style"!==i[parseInt(n.toString(),10)]?e.setAttribute(i[parseInt(n.toString(),10)],t[i[parseInt(n.toString(),10)]]):this.applyStyleAgainstCsp(e,t[i[parseInt(n.toString(),10)]])},e.prototype.renderOverlapElement=function(e){var t=this.getRulerSize(e),i={id:e.element.id+"_overlapRuler",style:"height:"+t.height+"px;width:"+t.width+"px;position:absolute;margin-left:0;margin-top:0;diplay:none",class:"e-ruler-overlap"},n=this.createHtmlElement("div",i),r=document.getElementById(e.element.id+"_viewerContainer");return r.insertBefore(n,r.firstChild),n},e.prototype.renderRulerMarkerIndicatorElement=function(e){if(e.enableSelection){var t=this.getRulerSize(e),r={id:e.element.id+"_markIndicator",style:"height:"+t.height+"px;width:"+t.width+"px;position:absolute;margin-left:0;margin-top:0;z-index:5;border:1px solid #ccc;display:"+("Pages"===e.layoutType?"block;":"none;"),class:"e-de-ruler-markIndicator"},o=this.createHtmlElement("div",r);this.tabStopStwitch=o;var s=document.getElementById(e.element.id+"_viewerContainer");s.insertBefore(o,s.firstChild);var a=e.element.id,l=document.getElementById(a+"_firstLineIndent").cloneNode(!0),d=document.getElementById(a+"_hangingIndent").cloneNode(!0);l.style.left="1px",l.style.top=t.height/2-3+"px",l.style.display="none",l.classList.add("e-de-ruler-marker"),l.setAttribute("id",a+"_firstLineIndent_-1"),d.style.left="1px",d.style.top=t.height/2-3+"px",d.style.display="none",d.classList.add("e-de-ruler-marker"),d.setAttribute("id",a+"_hangingIndent_-1"),o.appendChild(d),o.appendChild(l);var h=["Left","Center","Right","Decimal","Bar"],c=new n.L10n("documenteditor",e.defaultLocale);c.setLocale(e.locale);for(var p=0;p<5;p++){this.renderTab(e,t,void 0,h[parseInt(p.toString(),10)],-1,c);var u=document.getElementById(e.element.id+"_"+h[parseInt(p.toString(),10)]+"Tab_-1");i.i(n.isNullOrUndefined)(u)||(u.classList.remove("e-de-ruler-tab"),u.classList.add("e-de-ruler-marker"),u.style.display=0==p?"block":"none",u.style.position="absolute",u.style.margin="4px 3px",o.appendChild(u))}o.addEventListener("click",function(e){for(var t=document.querySelector(".e-de-ruler-markIndicator"),i=0;i<t.childNodes.length;i++){var n=t.childNodes[parseInt(i.toString(),10)];if("block"===n.style.display){n.style.display="none";var r=(i+1)%t.childNodes.length;t.childNodes[parseInt(r.toString(),10)].style.display="block";break}}})}},e.prototype.renderRuler=function(e,t){var a=this;if(e.enableSelection){var l=document.getElementById(e.element.id+(t?"_hRuler":"_vRuler")),d=this.getRulerSize(e),h=this.getRulerGeometry(e),c=t?e.selection.end.paragraph.bodyWidget.page.boundingRectangle.x:e.selection.getPageTop(e.selection.end.paragraph.bodyWidget.page),p=t?"margin-left:"+c+"px;":"margin-top:"+c+"px;";if(e.selection.isForward?this.position=e.selection.start:this.position=e.selection.end,!l){var u="height:"+(t?d.height:h.height)+"px;overflow:hidden;width:"+(t?h.width:d.width)+"px;position:absolute;font-size:9px;text-align: left;z-index: 4;user-select:none;"+p,g={id:e.element.id+(t?"_hRuler":"_vRuler"),style:u,class:t?"e-de-hRuler":"e-de-vRuler"};l=this.createHtmlElement("div",g)}l.addEventListener("dblclick",function(){e.showDialog("PageSetup")});var f=document.getElementById(e.element.id+"_pageContainer"),m="height:"+(t?d.height:f.getBoundingClientRect().height)+"px;overflow:hidden;width:"+(t?f.getBoundingClientRect().width:d.width)+"px;position:absolute;z-index: 3;",v={id:e.element.id+(t?"_hRulerBottom":"_vRulerBottom"),style:m,class:t?"e-de-hRuler":"e-de-vRuler"},y=this.createHtmlElement("div",v);t?this.hRulerBottom=y:this.vRulerBottom=y;var w=document.getElementById(e.element.id+"_viewerContainer");w.insertBefore(y,w.firstChild);var b=t?document.getElementById(e.element.id+"_hRulerBottom"):document.getElementById(e.element.id+"_vRulerBottom");b.insertBefore(l,b.firstChild),this.renderRulerMargins(e,t,l);var x=new r.a(l,this);x.orientation=t?"Horizontal":"Vertical",this.updateMargin(x,e,t),x.length=2*x.zeroPosition,x.appendTo(),t?e.hRuler=x:e.vRuler=x,this.updateRulerPosition(e,t);var C=document.getElementById(e.element.id+(t?"_hRuler":"_vRuler"));t?e.hRuler.element=C:e.vRuler.element=C,C&&(t?C.scrollLeft=x.zeroPosition-o.a.convertPointToPixel(e.selection.end.paragraph.bodyWidget.sectionFormat.leftMargin):C.scrollTop=x.zeroPosition-o.a.convertPointToPixel(e.selection.end.paragraph.bodyWidget.sectionFormat.topMargin)),this.locale=new n.L10n("documenteditor",e.defaultLocale),t&&this.renderIndents(e,t,d,h,this.locale);var I,F,k,P,T,S,W=!1,N=!1,H=void 0,E=!1,O=!1,_=document.getElementById(e.element.id+"_hRuler");if(t){document.addEventListener("mousemove",function(t){if(!e.isDestroyed&&e.documentEditorSettings.showRuler){var i=_.getBoundingClientRect(),n=e.selection.end.paragraph.bodyWidget.sectionFormat.leftMargin*e.zoomFactor,r=o.a.convertPixelToPoint(i.width)-e.selection.end.paragraph.bodyWidget.sectionFormat.rightMargin*e.zoomFactor,s=Math.round(t.clientX-i.left),l=o.a.convertPixelToPoint(s);if(!N)if(e.isOnIndent)_.style.cursor="default",_.hasAttribute("title")&&_.removeAttribute("title"),W=!1;else if(n-3<=l&&n+3>=l)"Pages"===e.layoutType&&(_.style.cursor="e-resize",_.setAttribute("title",a.locale.getConstant("Left Margin")),W=!0,H=!0);else if(r-3<=l&&r+3>=l)"Pages"===e.layoutType&&(_.style.cursor="e-resize",_.setAttribute("title",a.locale.getConstant("Right Margin")),W=!0,H=!1);else if(e.selection.end.paragraph.bodyWidget.sectionFormat.columns.length>0){var d=e.selection.end.paragraph.bodyWidget.sectionFormat.columns;if("Pages"===e.layoutType)for(var h=1;h<=d.length;h++){var c=document.getElementById(e.element.id+"_hRuler_Margin"+h),p=c.getBoundingClientRect().left,u=c.getBoundingClientRect().width;if(p-3<=t.clientX&&p+3>=t.clientX){_.style.cursor="e-resize",I=c,_.setAttribute("title",a.locale.getConstant("Left Margin")),E=!0,W=!0;break}if(p+u-3<=t.clientX&&p+u+3>=t.clientX){_.style.cursor="e-resize",I=c,_.setAttribute("title",a.locale.getConstant("Right Margin")),O=!0,W=!0;break}_.style.cursor="default",_.hasAttribute("title")&&_.removeAttribute("title"),E=!1,O=!1,W=!1}}else _.style.cursor="default",_.hasAttribute("title")&&_.removeAttribute("title"),W=!1;if(N){var g=o.a.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin)*e.zoomFactor,f=e.selection.sectionFormat.pageWidth,m=e.selection.sectionFormat.rightMargin,v=e.selection.paragraphFormat.rightIndent;v=v>0?v:0;var y=e.selection.paragraphFormat.firstLineIndent,w=e.selection.sectionFormat.leftMargin;y=y>=0?y:0;var b=e.selection.paragraphFormat.leftIndent;if(H){var x=g+o.a.convertPointToPixel(f-m-v-42-y-b)*e.zoomFactor,C=g;s+g>x?(s=x-g,l=o.a.convertPixelToPoint(s)):s+g<C&&(s=C-g,l=o.a.convertPixelToPoint(s))}else{var F=g+o.a.convertPointToPixel(w+b+y+42+v)*e.zoomFactor,B=g+o.a.convertPointToPixel(f)*e.zoomFactor;s+g>B?(s=B-g,l=o.a.convertPixelToPoint(s)):s+g<F&&(s=F-g,l=o.a.convertPixelToPoint(s))}S=l;var L=o.a.convertPixelToPoint(i.width)-e.selection.end.paragraph.bodyWidget.sectionFormat.rightMargin*e.zoomFactor;e.selection.end.paragraph.bodyWidget.sectionFormat.numberOfColumns<=1&&a.resizeRulerMargins(H,k,P,L,_,l,!0,e);var R=document.getElementById(e.element.id+"_rightIndent");if(H){var A=l-k;R.style.left=T-o.a.convertPointToPixel(A)+"px"}else{var A=l-k;R.style.left=T+o.a.convertPointToPixel(A)+"px"}var D=e.documentHelper.currentPage.boundingRectangle.x,U=D+s;document.getElementById(e.element.id+"_hRuler_indicator_svg").style.left=U+"px"}}});var B,L;_.addEventListener("mouseenter",function(e){i.i(n.isNullOrUndefined)(a.currentTabStopElement)||(a.currentTabStopElement.style.display="block")}),_.addEventListener("mouseleave",function(e){i.i(n.isNullOrUndefined)(a.currentTabStopElement)||(a.currentTabStopElement.style.display="none")}),_.addEventListener("mousedown",function(t){if(W&&!e.isTableMarkerDragging){N=!0,e.selection.end.paragraph.bodyWidget.sectionFormat.columns.length>0&&(E?F=I.getBoundingClientRect().left:O&&(F=I.getBoundingClientRect().left+I.getBoundingClientRect().width));var r=_.getBoundingClientRect();k=o.a.convertPixelToPoint(Math.round(t.clientX-r.left)),P=_.scrollLeft;var s=document.getElementById(e.element.id+"_rightIndent");T=o.a.getNumberFromString(s.style.left);var l=Math.round(t.clientX-r.left),d=e.documentHelper.currentPage.boundingRectangle.x,h=d+l,c=document.getElementById(e.element.id+"_hRuler_indicator_svg");c.style.left=h+"px",c.style.display="block"}var p=_.getBoundingClientRect();if(p.y+p.height/2<=t.clientY)if(B=t.clientX-_.getBoundingClientRect().left,"Pages"===e.layoutType){if(B=o.a.convertPixelToPoint(B-o.a.convertPointToPixel(e.selection.end.paragraph.bodyWidget.sectionFormat.leftMargin)*e.zoomFactor),a.position.paragraph.paragraphFormat.bidi){var u=i.i(n.isNullOrUndefined)(a.position.paragraph.absoluteXPosition)?a.position.paragraph.width:parseFloat(a.position.paragraph.absoluteXPosition.width.toString());u=o.a.convertPixelToPoint(u*e.zoomFactor),B=u-B}}else if("Continuous"===e.layoutType)if(a.position.paragraph.paragraphFormat.bidi){B=o.a.convertPixelToPoint(B-20);var u=i.i(n.isNullOrUndefined)(a.position.paragraph.absoluteXPosition)?a.position.paragraph.width:parseFloat(a.position.paragraph.absoluteXPosition.width.toString());u=o.a.convertPixelToPoint(u*e.zoomFactor),B=u-B}else B=o.a.convertPixelToPoint(B-20)}),_.addEventListener("mouseup",function(t){var r=document.getElementById(e.element.id+"_markIndicator"),l=_.getBoundingClientRect();if(l.y+l.height/2<=t.clientY){if(L=t.clientX-_.getBoundingClientRect().left,"Pages"===e.layoutType){if(L=o.a.convertPixelToPoint(L-o.a.convertPointToPixel(e.selection.end.paragraph.bodyWidget.sectionFormat.leftMargin)*e.zoomFactor),a.position.paragraph.paragraphFormat.bidi){var d=i.i(n.isNullOrUndefined)(a.position.paragraph.absoluteXPosition)?a.position.paragraph.width:parseFloat(a.position.paragraph.absoluteXPosition.width.toString());d=o.a.convertPixelToPoint(d*e.zoomFactor),L=d-L}}else if("Continuous"===e.layoutType)if(a.position.paragraph.paragraphFormat.bidi){L=o.a.convertPixelToPoint(L-20);var d=i.i(n.isNullOrUndefined)(a.position.paragraph.absoluteXPosition)?a.position.paragraph.width:parseFloat(a.position.paragraph.absoluteXPosition.width.toString());d=o.a.convertPixelToPoint(d*e.zoomFactor),L=d-L}else L=o.a.convertPixelToPoint(L-20);var h=document.getElementById(e.element.id+"_rightIndent"),c=o.a.getNumberFromString(h.style.left),p=c;if(L>0&&L<p&&B==L&&!i.i(n.isNullOrUndefined)(r)){var u=r.querySelector('.e-de-ruler-marker[style*="display: block;"]');if(!i.i(n.isNullOrUndefined)(u)){L/=e.zoomFactor;var g=u.getAttribute("data-name");if("LeftTab"==g||"CenterTab"==g||"RightTab"==g||"DecimalTab"==g||"BarTab"==g){var f=new s.b;f.position=L,f.tabJustification=a.getTabJustification(g),f.deletePosition=0,f.tabLeader="None",e.editor.onApplyParagraphFormat("tabStop",[f],!1,!1)}else if("FirstLineIndent"==g||"HangingIndent"==g){if("HangingIndent"==g){var m=e.selection.paragraphFormat.firstLineIndent,v=L+m,y=e.selection.start.paragraph.paragraphFormat.firstLineIndent;e.editor.onApplyParagraphFormat("firstLineIndent",y-v,!1,!1);var w=e.selection.start.paragraph.paragraphFormat.leftIndent+y;y-=v,e.editor.onApplyParagraphFormat("leftIndent",w-y,!1,!1,!0)}else e.editor.onApplyParagraphFormat("firstLineIndent",B,!1,!1)}}}}}),document.addEventListener("mouseup",function(t){if(N&&!e.isTableMarkerDragging){var i=(_.getBoundingClientRect(),S);if(E||O){var n=0;n=t.clientX-F;for(var r=e.selection.end.paragraph.bodyWidget.sectionFormat.cloneFormat(),s=e.selection.sectionFormat.pageWidth-e.selection.end.paragraph.bodyWidget.sectionFormat.leftMargin-e.selection.end.paragraph.bodyWidget.sectionFormat.rightMargin,a=E?r.columns[0].space+o.a.convertPixelToPoint(n):r.columns[0].space-o.a.convertPixelToPoint(n),l=0;l<r.columns.length;l++){var d=r.columns[parseInt(l.toString(),10)];if(a>=0&&d.width>=36){var c=o.a.convertPointToPixel((s-o.a.convertPixelToPoint(a)*(r.numberOfColumns-1))/r.numberOfColumns);d.width=c,l<r.columns.length-1&&(d.space=a)}else d[0].space=d[1].space}e.editorModule.onApplySectionFormat(void 0,r),E=!1,O=!1}else if(H)e.hRuler.startMargin=i/e.zoomFactor,e.selection.sectionFormat.leftMargin=i/e.zoomFactor;else{var p=o.a.convertPixelToPoint(h.width)-i/e.zoomFactor;e.selection.sectionFormat.rightMargin=p}W=!1,N=!1,H=void 0;document.getElementById(e.element.id+"_hRuler_indicator_svg").style.display="none"}})}var R,A,D=document.getElementById(e.element.id+"_vRuler"),U=!1;t||(document.addEventListener("mousemove",function(t){if(!e.isDestroyed&&e.documentEditorSettings.showRuler){var i=D.getBoundingClientRect(),n=e.selection.end.paragraph.bodyWidget.sectionFormat.topMargin*e.zoomFactor,r=o.a.convertPixelToPoint(i.height)-e.selection.end.paragraph.bodyWidget.sectionFormat.bottomMargin*e.zoomFactor,s=o.a.convertPixelToPoint(Math.round(t.clientY-i.top)),l=Math.round(t.clientY-i.top);if(N||(n-3<=s&&n+3>=s?(D.style.cursor="n-resize",D.setAttribute("title",a.locale.getConstant("Top Margin")),W=!0,U=!0):r-3<=s&&r+3>=s?(D.style.cursor="n-resize",D.setAttribute("title",a.locale.getConstant("Bottom Margin")),W=!0,U=!1):(D.style.cursor="default",D.hasAttribute("title")&&D.removeAttribute("title"),W=!1)),N){var d=o.a.convertPixelToPoint(Math.round(t.clientY-i.top)),h=o.a.convertPointToPixel(1584-e.selection.sectionFormat.topMargin)*e.zoomFactor,c=e.selection.sectionFormat.pageHeight,p=e.selection.sectionFormat.bottomMargin,u=e.selection.sectionFormat.topMargin;if(U){var g=h,f=h+o.a.convertPointToPixel(c-p-12)*e.zoomFactor;l+h>f?(l=f-h,d=o.a.convertPixelToPoint(l)):l+h<g&&(l=g-h,d=o.a.convertPixelToPoint(l))}else{var m=h+o.a.convertPointToPixel(u+12)*e.zoomFactor,v=h+o.a.convertPointToPixel(c)*e.zoomFactor;l+h>v?(l=v-h,d=o.a.convertPixelToPoint(l)):l+h<m&&(l=m-h,d=o.a.convertPixelToPoint(l))}var y=o.a.convertPixelToPoint(i.height)-e.selection.end.paragraph.bodyWidget.sectionFormat.bottomMargin*e.zoomFactor;a.resizeVRulerMargins(U,R,A,y,D,d,e);var w=e.documentHelper.currentPage.boundingRectangle.y*e.zoomFactor,b=w+l;document.getElementById(e.element.id+"_vRuler_indicator_svg").style.top=b+"px"}}}),D.addEventListener("mousedown",function(t){if(W){N=!0;var i=D.getBoundingClientRect();R=o.a.convertPixelToPoint(Math.round(t.clientY-i.top)),A=D.scrollTop;var n=Math.round(t.clientY-i.top),r=document.getElementById(e.element.id+"_vRuler_indicator_svg"),s=e.documentHelper.currentPage.boundingRectangle.y*e.zoomFactor,a=s+n;r.style.top=a+"px",r.style.display="block"}}),document.addEventListener("mouseup",function(t){if(N){var i=D.getBoundingClientRect(),n=o.a.convertPixelToPoint(Math.round(t.clientY-i.top));if(U)e.vRuler.startMargin=n/e.zoomFactor,e.selection.sectionFormat.topMargin=n/e.zoomFactor;else{var r=o.a.convertPixelToPoint(h.height)-n/e.zoomFactor;e.vRuler.endMargin=r,e.selection.sectionFormat.bottomMargin=r}W=!1,N=!1;document.getElementById(e.element.id+"_vRuler_indicator_svg").style.display="none",U=void 0}}))}},e.prototype.updateRulerPosition=function(e,t){var i=document.getElementById(e.element.id+(t?"_hRuler":"_vRuler"));t?e.hRuler.element=i:e.vRuler.element=i,i&&(i.scrollLeft=2112-o.a.convertPointToPixel(e.selection.end.paragraph.bodyWidget.sectionFormat.leftMargin))},e.prototype.updateIndicatorLines=function(e){var t=document.getElementById(e.element.id+"_hRuler_indicator_svg"),i=document.getElementById(e.element.id+"_hRuler_indicator"),n=document.getElementById(e.element.id+"_vRuler_indicator_svg"),r=document.getElementById(e.element.id+"_vRuler_indicator"),o=document.getElementById(e.element.id+"_pageContainer"),s=o.getBoundingClientRect(),a=s.height,l=s.width;t.style.height=a+"px",i.setAttribute("y2",""+a),n.style.width=l+"px",r.setAttribute("x2",""+l)},e.prototype.createIndicatorLines=function(e){if(e.enableSelection){var t=document.getElementById(e.element.id+"_viewerContainer"),i=document.getElementById(e.element.id+"_pageContainer"),n=(t.getBoundingClientRect(),i.getBoundingClientRect()),r=n.height,o=n.width,s=document.getElementById(e.element.id+"_hRuler"),a={id:e.element.id+"_hRuler_indicator_svg",width:"0.5px",height:r+"px",style:"position:absolute;z-index:1;display:none;"},l=this.createSvgElement("svg",a),d={x1:0,y1:s.getBoundingClientRect().height+5,x2:0,y2:r,"stroke-width":.5,stroke:"black"},h=this.createSvgElement("line",d);h.setAttribute("id",e.element.id+"_hRuler_indicator"),l.appendChild(h),t.insertBefore(l,t.firstChild);var c=document.getElementById(e.element.id+"_vRuler"),p={id:e.element.id+"_vRuler_indicator_svg",width:o+"px",height:"0.5px",style:"position:absolute;z-index:1;display:none;"},u=this.createSvgElement("svg",p),g={x1:c.getBoundingClientRect().width+5,y1:0,x2:o,y2:0,"stroke-width":.5,stroke:"black"},f=this.createSvgElement("line",g);f.setAttribute("id",e.element.id+"_vRuler_indicator"),u.appendChild(f),t.insertBefore(u,t.firstChild)}},e.prototype.updateIndentMarkers=function(e){if(!(i.i(n.isNullOrUndefined)(e)||i.i(n.isNullOrUndefined)(e.element)||i.i(n.isNullOrUndefined)(e.element.id)||i.i(n.isNullOrUndefined)(e.hRuler)||i.i(n.isNullOrUndefined)(e.hRuler.zeroPosition))){var t=void 0,r=e.element.id,s=o.a.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin),a=this.getRulerGeometry(e);if(this.position.paragraph.paragraphFormat.bidi||this.position.paragraph.isInsideTable&&this.position.paragraph.associatedCell.ownerTable.tableFormat.bidi){s-=a.width/e.zoomFactor-o.a.convertPointToPixel(this.position.paragraph.bodyWidget.sectionFormat.rightMargin+this.position.paragraph.bodyWidget.sectionFormat.leftMargin)}var l,d=i.i(n.isNullOrUndefined)(this.position.paragraph.absoluteXPosition)?this.position.paragraph.x:parseFloat(this.position.paragraph.absoluteXPosition.x.toString()),h=i.i(n.isNullOrUndefined)(this.position.paragraph.absoluteXPosition)?this.position.paragraph.width:parseFloat(this.position.paragraph.absoluteXPosition.width.toString());this.position.paragraph.paragraphFormat.bidi&&(s=o.a.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin-(e.selection.sectionFormat.pageWidth-e.selection.sectionFormat.leftMargin-e.selection.sectionFormat.rightMargin)));var c=document.getElementById(e.element.id+"_leftIndent"),p=document.getElementById(e.element.id+"_rightIndent");this.position.paragraph.paragraphFormat.bidi?(c.setAttribute("title",this.locale.getConstant("Right Indent")),p.setAttribute("title",this.locale.getConstant("Left Indent")),l=s+d+h):(c.setAttribute("title",this.locale.getConstant("Left Indent")),p.setAttribute("title",this.locale.getConstant("Right Indent")),l=s+d);var u=this.position.paragraph.paragraphFormat.firstLineIndent;t=document.getElementById(r+"_leftIndent"),i.i(n.isNullOrUndefined)(t)||("Pages"===e.layoutType?t.style.left=l*e.zoomFactor-6+"px":"Continuous"===e.layoutType&&(this.position.paragraph.paragraphFormat.bidi?(s=e.hRuler.zeroPosition*e.zoomFactor-20-e.viewer.clientArea.width,l=s+d+h,t.style.left=l+"px"):(s=e.hRuler.zeroPosition*e.zoomFactor-20,l=s+d*e.zoomFactor,t.style.left=l+"px"))),t=document.getElementById(r+"_hangingIndent"),i.i(n.isNullOrUndefined)(t)||("Pages"===e.layoutType?t.style.left=l*e.zoomFactor-6+"px":"Continuous"===e.layoutType&&(this.position.paragraph.paragraphFormat.bidi?(s=e.hRuler.zeroPosition*e.zoomFactor-20-e.viewer.clientArea.width,l=s+d+h,t.style.left=l+"px"):(s=e.hRuler.zeroPosition*e.zoomFactor-20,l=s+d*e.zoomFactor,t.style.left=l+"px"))),t=document.getElementById(r+"_firstLineIndent"),"Pages"===e.layoutType?i.i(n.isNullOrUndefined)(t)||(this.position.paragraph.paragraphFormat.bidi?t.style.left=(l-o.a.convertPointToPixel(u))*e.zoomFactor-6+"px":t.style.left=(l+o.a.convertPointToPixel(u))*e.zoomFactor-6+"px"):"Continuous"===e.layoutType&&(this.position.paragraph.paragraphFormat.bidi?(s=e.hRuler.zeroPosition*e.zoomFactor-20-e.viewer.clientArea.width,l=s+d+h-o.a.convertPointToPixel(u)*e.zoomFactor):(s=e.hRuler.zeroPosition*e.zoomFactor-20,l=s+(d+o.a.convertPointToPixel(u))*e.zoomFactor),t.style.left=l+"px"),t=document.getElementById(r+"_rightIndent"),"Pages"===e.layoutType?(l=this.position.paragraph.paragraphFormat.bidi?s+d:s+d+h,i.i(n.isNullOrUndefined)(t)||(t.style.left=l*e.zoomFactor-6+"px")):"Continuous"===e.layoutType&&(this.position.paragraph.paragraphFormat.bidi?(s=e.hRuler.zeroPosition*e.zoomFactor-20-e.viewer.clientArea.width*e.zoomFactor,l=s+d,t.style.left=l+"px"):(s=e.hRuler.zeroPosition*e.zoomFactor-20,l=s+(d+h)*e.zoomFactor,t.style.left=l+"px"))}},e.prototype.updateTabStopMarkers=function(e){if(!(i.i(n.isNullOrUndefined)(e)||i.i(n.isNullOrUndefined)(e.element)||i.i(n.isNullOrUndefined)(e.element.id)||i.i(n.isNullOrUndefined)(e.hRuler)||i.i(n.isNullOrUndefined)(e.hRuler.zeroPosition))){var t=new n.L10n("documenteditor",e.defaultLocale);t.setLocale(e.locale);var r=e.element.id;document.getElementById(r+"_markIndicator").style.display="Pages"===e.layoutType?"block":"none";for(var s=this.position.paragraph,a=s.paragraphFormat.tabs,l=e.zoomFactor,d=this.getRulerSize(e),h=o.a.convertNodeListToArray(document.querySelectorAll(".e-de-ruler-tab")),c=0;c<a.length;c++){var p=a[parseInt(c.toString(),10)],u=p.tabJustification,g=e.element.id+"_"+u+"Tab_"+c.toString(),f=document.getElementById(g);if(i.i(n.isNullOrUndefined)(f))this.renderTab(e,d,p,u,c,t);else{!i.i(n.isNullOrUndefined)(h)&&h.length>0&&h.splice(h.indexOf(f),1);var m=this.position.paragraph.paragraphFormat.bidi?o.a.convertPointToPixel(1584-p.position):o.a.convertPointToPixel(1584+p.position);f.style.left="Center"===u||"Decimal"===u?m*l-4+"px":"Right"===u?m*l-5.5+"px":m*l-1.5+"px"}}if(!i.i(n.isNullOrUndefined)(h))for(var c=0;c<h.length;c++){var v=h[parseInt(c.toString(),10)];i.i(n.isNullOrUndefined)(v)||v.parentNode.removeChild(v)}}},e.prototype.renderRulerMargins=function(e,t,i){var n,r=this.getRulerSize(e),s=this.getRulerGeometry(e),a=(t?e.selection.end.paragraph.bodyWidget.page.boundingRectangle.x:(e.selection.end.paragraph.bodyWidget.page.boundingRectangle.y,r.height),2112*e.zoomFactor),l=t?"margin-left:"+a+"px;":"margin-top:"+a+"px;",d=t?r.height:s.height-o.a.convertPointToPixel(e.selection.end.paragraph.bodyWidget.sectionFormat.topMargin+e.selection.end.paragraph.bodyWidget.sectionFormat.bottomMargin)*e.zoomFactor;if(t)for(var h=1;h<=13;h++){if(!(n=document.getElementById(e.element.id+"_hRuler_Margin"+h))){var c="height:"+d+"px;overflow:hidden;width:"+(s.width-o.a.convertPointToPixel(e.selection.end.paragraph.bodyWidget.sectionFormat.rightMargin+e.selection.end.paragraph.bodyWidget.sectionFormat.leftMargin)*e.zoomFactor)+"px;position:absolute;font-size:9px;text-align: left;z-index: -1;display: block"+l,p={id:e.element.id+"_hRuler_Margin"+h,style:c,class:"e-de-ruler-margin"};n=this.createHtmlElement("div",p)}i.appendChild(n)}else{if(!n){n=document.getElementById(e.element.id+"_vRuler_Margin");var c="height:"+d+"px;overflow:hidden;width:"+r.width+"px;position:absolute;font-size:9px;text-align: left;z-index: -1;"+l,p={id:e.element.id+"_vRuler_Margin",style:c,class:"e-de-ruler-margin"};n=this.createHtmlElement("div",p)}i.appendChild(n)}},e.prototype.updateRulerMargins=function(e){var t=this.getRulerGeometry(e),i=e.hRuler.zeroPosition*e.zoomFactor;this.updateHorizontalRulerMargin(e);var n=document.getElementById(e.element.id+"_vRuler_Margin"),r=t.height-o.a.convertPointToPixel(e.selection.end.paragraph.bodyWidget.sectionFormat.bottomMargin*e.zoomFactor+e.selection.end.paragraph.bodyWidget.sectionFormat.topMargin*e.zoomFactor);n.style.marginTop=i+"px",n.style.height=r+"px"},e.prototype.updateHorizontalRulerMargin=function(e){var t=e.selection.end.paragraph.bodyWidget.sectionFormat.columns,r=e.hRuler.zeroPosition*e.zoomFactor,s=!1,a=this.position.paragraph.paragraphFormat.bidi,l=!1,d=o.a.convertPointToPixel(e.selection.end.paragraph.bodyWidget.sectionFormat.leftMargin-72),h=o.a.convertPointToPixel(e.selection.end.paragraph.bodyWidget.sectionFormat.rightMargin-72);this.position.paragraph.isInsideTable&&(l=this.position.paragraph.associatedCell.ownerTable.tableFormat.bidi);var c=this.getRulerGeometry(e).width-o.a.convertPointToPixel(e.selection.end.paragraph.bodyWidget.sectionFormat.rightMargin*e.zoomFactor+e.selection.end.paragraph.bodyWidget.sectionFormat.leftMargin*e.zoomFactor);(a||l)&&(r=e.hRuler.zeroPosition*e.zoomFactor-c);for(var p=0;p<13;p++){var u=document.getElementById(e.element.id+"_hRuler_Margin"+(p+1));if(u)if(0===t.length&&!s||"Continuous"===e.layoutType&&!s){if(a||l){var g=e.hRuler.zeroPosition*e.zoomFactor-c;u.style.marginLeft=g+"px"}else u.style.marginLeft=r+"px";if(u.style.display="block","Continuous"===e.layoutType){var f=i.i(n.isNullOrUndefined)(this.position.paragraph.absoluteXPosition)?this.position.paragraph.width:parseFloat(this.position.paragraph.absoluteXPosition.width.toString());u.style.width=f*e.zoomFactor+"px"}else u.style.width=c+"px";s=!0}else t.length>=p+1&&"Pages"===e.layoutType?(u.style.marginLeft=r+"px",r-=(d+h)/t.length*e.zoomFactor,r+=(t[parseInt(p.toString(),10)].width+t[parseInt(p.toString(),10)].space)*e.zoomFactor,u.style.display="block",u.style.width=(t[parseInt(p.toString(),10)].width-(d+h)/t.length)*e.zoomFactor+"px"):u.style.display="none"}},e.prototype.resizeVRulerMargins=function(e,t,i,n,r,s,a){var l=document.getElementById(a.element.id+"_vRuler_Margin"),d=this.getRulerGeometry(a);if(e)l.style.height=(d.height-o.a.convertPointToPixel(a.selection.end.paragraph.bodyWidget.sectionFormat.bottomMargin*a.zoomFactor+s)).toString()+"px",r.scrollTop=t<s?i-o.a.convertPointToPixel(s-t):i+o.a.convertPointToPixel(t-s);else{var h=o.a.convertPixelToPoint(d.height)-s;l.style.height=(d.height-o.a.convertPointToPixel(a.selection.end.paragraph.bodyWidget.sectionFormat.topMargin*a.zoomFactor+h)).toString()+"px"}},e.prototype.resizeRulerMargins=function(e,t,r,s,a,l,d,h){var c=document.getElementById(h.element.id+(d?"_hRuler_Margin1":"_vRuler_Margin")),p=this.getRulerGeometry(h);if(!i.i(n.isNullOrUndefined)(e)&&e)c.style.width=(p.width-o.a.convertPointToPixel(h.selection.end.paragraph.bodyWidget.sectionFormat.rightMargin*h.zoomFactor+l)).toString()+"px",a.scrollLeft=t<l?r-o.a.convertPointToPixel(l-t):r+o.a.convertPointToPixel(t-l);else{var u=o.a.convertPixelToPoint(p.width)-l;c.style.width=(p.width-o.a.convertPointToPixel(h.selection.end.paragraph.bodyWidget.sectionFormat.leftMargin*h.zoomFactor+u)).toString()+"px"}},e.prototype.getRulerOrigin=function(){o.a.convertPointToPixel(1584)},e.prototype.renderIndents=function(e,t,i,n,r){var s=this,a=document.getElementById(e.element.id+"_hRuler"),l=document.getElementById(e.element.id+"_firstLineIndent");if(!l){var d="left:"+(o.a.convertPointToPixel(e.selection.end.paragraph.bodyWidget.sectionFormat.leftMargin)-6)*e.zoomFactor+"px;",h="height:"+(i.height-3)/2+"px;overflow:hidden;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 5;"+d,c={id:e.element.id+"_firstLineIndent",style:h,"data-name":"FirstLineIndent",class:"e-de-ruler-indent"};l=this.createHtmlElement("div",c),l.setAttribute("title",r.getConstant("First Line Indent"));var p=void 0,u={id:e.element.id+"_firstLineIndent_svg",width:i.width+"px",height:(i.height-3)/2+"px",style:"position:inherit;left:0px"};p=this.createSvgElement("svg",u),p.setAttribute("fill","none");var g={style:"position:inherit;left:0px"},f=this.createSvgElement("path",g);f.setAttribute("class","e-de-ruler-indent-svg"),f.setAttribute("d","M 0.5 0.5 H 11.5 V 2.7128 L 6 5.4211 L 0.5 2.7128 V 0.5 Z"),f.setAttribute("fill","white"),f.setAttribute("stroke","#A1A1A1"),p.appendChild(f),l.appendChild(p),a.append(l),l.addEventListener("dblclick",function(t){e.showDialog("Paragraph"),t.stopPropagation()});var m,v=!1,y=o.a.getNumberFromString(l.style.left);o.a.getNumberFromString(l.style.left);l.addEventListener("mouseenter",function(t){e.isOnIndent=!0}),l.addEventListener("mouseleave",function(t){e.isOnIndent=!1}),l.addEventListener("mousedown",function(t){v=!0,m=t.clientX-l.getBoundingClientRect().left,y=o.a.getNumberFromString(l.style.left);var i=o.a.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin)*e.zoomFactor;e.selection.paragraphFormat.bidi&&(i=o.a.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin-(e.selection.sectionFormat.pageWidth-e.selection.sectionFormat.leftMargin-e.selection.sectionFormat.rightMargin))*e.zoomFactor),"Continuous"===e.layoutType&&(i=e.hRuler.zeroPosition*e.zoomFactor-20,e.selection.paragraphFormat.bidi&&(i=e.hRuler.zeroPosition*e.zoomFactor-20-e.viewer.clientArea.width*e.zoomFactor));var n=i+t.clientX-m-a.getBoundingClientRect().left,r=e.documentHelper.currentPage.boundingRectangle.x;r="Continuous"===e.layoutType?0:r;var s=r+(n-i)+6,d=document.getElementById(e.element.id+"_hRuler_indicator_svg");d.style.left=s+"px",d.style.display="block",t.stopPropagation()}),document.addEventListener("mousemove",function(t){if(v){var i=void 0,n=void 0,r=void 0,d=document.getElementById(e.element.id+"_rightIndent"),h=o.a.getNumberFromString(d.style.left);"Pages"===e.layoutType?e.selection.paragraphFormat.bidi?(i=o.a.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin-(e.selection.sectionFormat.pageWidth-e.selection.sectionFormat.leftMargin-e.selection.sectionFormat.rightMargin))*e.zoomFactor,n=i-6+o.a.convertPointToPixel(e.selection.sectionFormat.pageWidth)*e.zoomFactor,r=h+o.a.convertPointToPixel(42)*e.zoomFactor):(i=o.a.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin)*e.zoomFactor,r=i-6,n=h-o.a.convertPointToPixel(42)*e.zoomFactor):"Continuous"===e.layoutType&&(s.position.paragraph.paragraphFormat.bidi?(i=e.hRuler.zeroPosition*e.zoomFactor-20-e.viewer.clientArea.width*e.zoomFactor,n=e.hRuler.zeroPosition*e.zoomFactor-20+40-6,r=h+o.a.convertPointToPixel(42)*e.zoomFactor):(i=e.hRuler.zeroPosition*e.zoomFactor-20,r=i-6,n=h-o.a.convertPointToPixel(42)*e.zoomFactor));var c=i+t.clientX-m-a.getBoundingClientRect().left;c<r?c=r:c>n&&(c=n),l.style.left=c+"px";var p=e.documentHelper.currentPage.boundingRectangle.x;p="Continuous"===e.layoutType?0:p;var u=p+(c-i)+6;document.getElementById(e.element.id+"_hRuler_indicator_svg").style.left=u+"px"}}),document.addEventListener("mouseup",function(){if(v){v=!1;var t=o.a.getNumberFromString(l.style.left);parseInt(l.style.left.replace("px",""))<0&&(t*=-1),e.selection.paragraphFormat.bidi?e.editor.applyRulerMarkerValues("firstLineIndent",t,y):e.editor.applyRulerMarkerValues("firstLineIndent",y,t),y=t;document.getElementById(e.element.id+"_hRuler_indicator_svg").style.display="none"}})}var w=document.getElementById(e.element.id+"_hangingIndent");if(!w){var d="left:"+(o.a.convertPointToPixel(e.selection.end.paragraph.bodyWidget.sectionFormat.leftMargin)-6)+"px;",h="height:"+i.height/2+"px;top:"+((i.height-3)/2+1)+"px;overflow:hidden;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 5;"+d,c={id:e.element.id+"_hangingIndent",style:h,"data-name":"HangingIndent",class:"e-de-ruler-indent"};w=this.createHtmlElement("div",c),w.setAttribute("title",r.getConstant("Hanging Indent"));var b=void 0,u={id:e.element.id+"_hangingIndent_svg",width:i.width+"px",height:(i.height-3)/2+"px",style:"position:inherit;left:0px"};b=this.createSvgElement("svg",u),b.setAttribute("fill","none");var g={style:"position:inherit;left:0px"},f=this.createSvgElement("path",g);f.setAttribute("class","e-de-ruler-indent-svg"),f.setAttribute("d","M 0.5 5.3211 H 11.5 V 3.1083 L 6 0.4 L 0.5 3.1083 V 5.3211 Z"),f.setAttribute("fill","white"),f.setAttribute("stroke","#A1A1A1"),b.appendChild(f),w.appendChild(b),a.append(w),w.addEventListener("dblclick",function(t){e.showDialog("Paragraph"),t.stopPropagation()});var x,C,I,F,k=!1,P=o.a.getNumberFromString(w.style.left);o.a.getNumberFromString(w.style.left);w.addEventListener("mouseenter",function(t){e.isOnIndent=!0}),w.addEventListener("mouseleave",function(t){e.isOnIndent=!1}),w.addEventListener("mousedown",function(t){k=!0,x=t.clientX-w.getBoundingClientRect().left,P=o.a.getNumberFromString(w.style.left);var i,n=document.getElementById(e.element.id+"_rightIndent"),r=o.a.getNumberFromString(n.style.left);"Pages"===e.layoutType?e.selection.paragraphFormat.bidi?(i=o.a.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin-(e.selection.sectionFormat.pageWidth-e.selection.sectionFormat.leftMargin-e.selection.sectionFormat.rightMargin))*e.zoomFactor,C=r+o.a.convertPointToPixel(42)*e.zoomFactor,I=i-6+o.a.convertPointToPixel(e.selection.sectionFormat.pageWidth)*e.zoomFactor):(i=o.a.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin)*e.zoomFactor,C=i-6,I=r-o.a.convertPointToPixel(42)*e.zoomFactor):"Continuous"===e.layoutType&&(s.position.paragraph.paragraphFormat.bidi?(i=e.hRuler.zeroPosition*e.zoomFactor-20-e.viewer.clientArea.width*e.zoomFactor,I=e.hRuler.zeroPosition*e.zoomFactor-20+40-6,C=r+o.a.convertPointToPixel(42)*e.zoomFactor):(i=e.hRuler.zeroPosition*e.zoomFactor-20,C=i-6,I=r-o.a.convertPointToPixel(42)*e.zoomFactor)),F=document.getElementById(e.element.id+"_leftIndent");var l=i+t.clientX-x-a.getBoundingClientRect().left,d=e.documentHelper.currentPage.boundingRectangle.x;d="Continuous"===e.layoutType?0:d;var h=d+(l-i)+6,c=document.getElementById(e.element.id+"_hRuler_indicator_svg");c.style.left=h+"px",c.style.display="block",t.stopPropagation()}),document.addEventListener("mousemove",function(t){if(k){var i=void 0;"Pages"===e.layoutType?i=e.selection.paragraphFormat.bidi?o.a.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin-(e.selection.sectionFormat.pageWidth-e.selection.sectionFormat.leftMargin-e.selection.sectionFormat.rightMargin))*e.zoomFactor:o.a.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin)*e.zoomFactor:"Continuous"===e.layoutType&&(i=s.position.paragraph.paragraphFormat.bidi?e.hRuler.zeroPosition*e.zoomFactor-20-e.viewer.clientArea.width*e.zoomFactor:e.hRuler.zeroPosition*e.zoomFactor-20);var n=i+t.clientX-x-a.getBoundingClientRect().left;n>I?n=I:n<C&&(n=C),F.style.left=n+"px",w.style.left=n+"px";var r=e.documentHelper.currentPage.boundingRectangle.x;r="Continuous"===e.layoutType?0:r;var l=r+(n-i)+6;document.getElementById(e.element.id+"_hRuler_indicator_svg").style.left=l+"px"}}),document.addEventListener("mouseup",function(){if(k){k=!1;var t=o.a.getNumberFromString(w.style.left);parseInt(w.style.left.replace("px",""))<0&&(t*=-1),e.selection.paragraphFormat.bidi?e.editor.applyRulerMarkerValues("hangingIndent",t,P):e.editor.applyRulerMarkerValues("hangingIndent",P,t),P=t;document.getElementById(e.element.id+"_hRuler_indicator_svg").style.display="none"}})}var T=document.getElementById(e.element.id+"_leftIndent");if(!T){var d="left:"+(o.a.convertPointToPixel(e.selection.end.paragraph.bodyWidget.sectionFormat.leftMargin)-6)+"px;",h="height:4px;top:11px;overflow:hidden;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 5;"+d,c={id:e.element.id+"_leftIndent",style:h,class:"e-de-ruler-indent"};T=this.createHtmlElement("div",c),T.setAttribute("title",r.getConstant("Left Indent"));var S=void 0,u={id:e.element.id+"_leftIndent_svg",width:i.width+"px",height:"4px",style:"position:inherit;left:0px"};S=this.createSvgElement("svg",u),S.setAttribute("fill","none");var g={style:"position:inherit;left:0px"},f=this.createSvgElement("path",g);f.setAttribute("class","e-de-ruler-indent-svg"),f.setAttribute("d","M 0.5 3.5 H 11.5 V 0.5 H 0.5 V 3.5 Z"),f.setAttribute("fill","white"),f.setAttribute("stroke","#A1A1A1"),S.appendChild(f),T.appendChild(S),a.append(T),T.addEventListener("dblclick",function(t){e.showDialog("Paragraph"),t.stopPropagation()});var W,N,H,E,O,_,B=!1,L=o.a.getNumberFromString(T.style.left);o.a.getNumberFromString(T.style.left);T.addEventListener("mouseenter",function(t){e.isOnIndent=!0}),T.addEventListener("mouseleave",function(t){e.isOnIndent=!1}),T.addEventListener("mousedown",function(t){var i;B=!0,W=t.clientX-T.getBoundingClientRect().left,L=o.a.getNumberFromString(T.style.left),N=o.a.getNumberFromString(l.style.left),H=N-L,l=document.getElementById(e.element.id+"_firstLineIndent");var n=document.getElementById(e.element.id+"_rightIndent"),r=o.a.getNumberFromString(n.style.left);"Pages"===e.layoutType?e.selection.paragraphFormat.bidi?(i=o.a.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin-(e.selection.sectionFormat.pageWidth-e.selection.sectionFormat.leftMargin-e.selection.sectionFormat.rightMargin))*e.zoomFactor,E=r+o.a.convertPointToPixel(42)*e.zoomFactor,O=i-6+o.a.convertPointToPixel(e.selection.sectionFormat.pageWidth)*e.zoomFactor,_=o.a.getNumberFromString(w.style.left)-r<=o.a.getNumberFromString(l.style.left)-r):(i=o.a.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin)*e.zoomFactor,E=i-6,O=r-o.a.convertPointToPixel(42)*e.zoomFactor,_=r-o.a.getNumberFromString(w.style.left)<=r-o.a.getNumberFromString(l.style.left)):"Continuous"===e.layoutType&&(s.position.paragraph.paragraphFormat.bidi?(i=e.hRuler.zeroPosition*e.zoomFactor-20-e.viewer.clientArea.width*e.zoomFactor,O=e.hRuler.zeroPosition*e.zoomFactor-20+40-6,E=r+o.a.convertPointToPixel(42)*e.zoomFactor,_=o.a.getNumberFromString(w.style.left)-r<=o.a.getNumberFromString(l.style.left)-r):(i=e.hRuler.zeroPosition*e.zoomFactor-20,E=i-6,O=r-o.a.convertPointToPixel(42)*e.zoomFactor,_=r-o.a.getNumberFromString(w.style.left)<=r-o.a.getNumberFromString(l.style.left)));var d=i+t.clientX-W-a.getBoundingClientRect().left,h=e.documentHelper.currentPage.boundingRectangle.x;h="Continuous"===e.layoutType?0:h;var c=h+(d-i)+6,p=document.getElementById(e.element.id+"_hRuler_indicator_svg");p.style.left=c+"px",p.style.display="block",t.stopPropagation()}),document.addEventListener("mousemove",function(t){if(B){var i=void 0,n=void 0;e.selection.paragraphFormat.bidi?("Pages"===e.layoutType?i=o.a.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin-(e.selection.sectionFormat.pageWidth-e.selection.sectionFormat.leftMargin-e.selection.sectionFormat.rightMargin))*e.zoomFactor:"Continuous"===e.layoutType&&(i=e.hRuler.zeroPosition*e.zoomFactor-20-e.viewer.clientArea.width*e.zoomFactor),n=i+t.clientX-W-a.getBoundingClientRect().left,_?n+H>O&&(n=O-H):n>O&&(n=O),_?n<E&&(n=E):n+H<E&&(n=E-H)):("Pages"===e.layoutType?i=o.a.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin)*e.zoomFactor:"Continuous"===e.layoutType&&(i=e.hRuler.zeroPosition*e.zoomFactor-20),n=i+t.clientX-W-a.getBoundingClientRect().left,_?n>O&&(n=O):n+H>O&&(n=O-H),_?n+H<E&&(n=E-H):n<E&&(n=E)),w.style.left=n+"px",T.style.left=n+"px",l.style.left=N+(n-L)+"px";var r=e.documentHelper.currentPage.boundingRectangle.x;r="Continuous"===e.layoutType?0:r;var s=r+(n-i)+6;document.getElementById(e.element.id+"_hRuler_indicator_svg").style.left=s+"px"}}),document.addEventListener("mouseup",function(){if(B){B=!1;var t=o.a.getNumberFromString(T.style.left);parseInt(T.style.left.replace("px",""))<0&&(t*=-1),e.selection.paragraphFormat.bidi?e.editor.applyRulerMarkerValues("leftIndent",t,L):e.editor.applyRulerMarkerValues("leftIndent",L,t),L=t;document.getElementById(e.element.id+"_hRuler_indicator_svg").style.display="none"}})}var R=document.getElementById(e.element.id+"_rightIndent");if(!R){var d="left:"+(e.selection.end.paragraph.bodyWidget.page.boundingRectangle.width-o.a.convertPointToPixel(e.selection.end.paragraph.bodyWidget.sectionFormat.rightMargin)-6)+"px;",h="height:7px;top:8px;overflow:hidden;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 4;"+d,c={id:e.element.id+"_rightIndent",style:h,class:"e-de-ruler-indent"};R=this.createHtmlElement("div",c),R.setAttribute("title",r.getConstant("Right Indent"));var A=void 0,u={id:e.element.id+"_rightIndent_svg",width:i.width+"px",height:"7px",style:"position:inherit;left:0px"};A=this.createSvgElement("svg",u),A.setAttribute("fill","none");var g={style:"position:inherit;left:0px"},f=this.createSvgElement("path",g);f.setAttribute("class","e-de-ruler-indent-svg"),f.setAttribute("d","M 0.5 6.5 H 11.5 V 4.2872 L 6 1.5789 L 0.5 4.2872 V 6.5 Z"),f.setAttribute("fill","white"),f.setAttribute("stroke","#A1A1A1"),A.appendChild(f),R.appendChild(A),a.append(R),R.addEventListener("dblclick",function(t){e.showDialog("Paragraph"),t.stopPropagation()});var D,U=!1,M=o.a.getNumberFromString(R.style.left);o.a.getNumberFromString(R.style.left);R.addEventListener("mouseenter",function(t){e.isOnIndent=!0}),R.addEventListener("mouseleave",function(t){e.isOnIndent=!1}),R.addEventListener("mousedown",function(t){U=!0,D=t.clientX-R.getBoundingClientRect().left,M=o.a.getNumberFromString(R.style.left);var i=o.a.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin)*e.zoomFactor;e.selection.paragraphFormat.bidi&&(i=o.a.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin-(e.selection.sectionFormat.pageWidth-e.selection.sectionFormat.leftMargin-e.selection.sectionFormat.rightMargin))*e.zoomFactor),"Continuous"===e.layoutType&&(i=e.hRuler.zeroPosition*e.zoomFactor-20,e.selection.paragraphFormat.bidi&&(i=e.hRuler.zeroPosition*e.zoomFactor-20-e.viewer.clientArea.width*e.zoomFactor));var n=i+t.clientX-D-a.getBoundingClientRect().left,r=e.documentHelper.currentPage.boundingRectangle.x;r="Continuous"===e.layoutType?0:r;var s=r+(n-i)+6,l=document.getElementById(e.element.id+"_hRuler_indicator_svg");l.style.left=s+"px",l.style.display="block",t.stopPropagation()}),document.addEventListener("mousemove",function(t){if(U){var i=void 0,n=void 0,r=document.getElementById(e.element.id+"_leftIndent"),s=document.getElementById(e.element.id+"_firstLineIndent"),l=void 0,d=void 0;if(e.selection.paragraphFormat.bidi){"Pages"===e.layoutType?i=o.a.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin-(e.selection.sectionFormat.pageWidth-e.selection.sectionFormat.leftMargin-e.selection.sectionFormat.rightMargin))*e.zoomFactor:"Continuous"===e.layoutType&&(i=e.hRuler.zeroPosition*e.zoomFactor-20-e.viewer.clientArea.width*e.zoomFactor),n=i+t.clientX-D-a.getBoundingClientRect().left;var h=o.a.getNumberFromString(r.style.left)-n<=o.a.getNumberFromString(s.style.left)-n?r:s,c=o.a.getNumberFromString(h.style.left);l=c-o.a.convertPointToPixel(42)*e.zoomFactor,d=i-6}else{"Pages"===e.layoutType?i=o.a.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin)*e.zoomFactor:"Continuous"===e.layoutType&&(i=e.hRuler.zeroPosition*e.zoomFactor-20),n=i+t.clientX-D-a.getBoundingClientRect().left;var h=n-o.a.getNumberFromString(r.style.left)<=n-o.a.getNumberFromString(s.style.left)?r:s,c=o.a.getNumberFromString(h.style.left);l=i+e.documentHelper.currentPage.boundingRectangle.width*e.zoomFactor-6,d=c+o.a.convertPointToPixel(42)*e.zoomFactor}n<d?n=d:n>l&&(n=l),R.style.left=n+"px";var p=e.documentHelper.currentPage.boundingRectangle.x;p="Continuous"===e.layoutType?0:p;var u=p+(n-i)+6;document.getElementById(e.element.id+"_hRuler_indicator_svg").style.left=u+"px"}}),document.addEventListener("mouseup",function(){if(U){U=!1;var t=o.a.getNumberFromString(R.style.left);e.selection.paragraphFormat.bidi?e.editor.applyRulerMarkerValues("rightIndent",M,t):e.editor.applyRulerMarkerValues("rightIndent",t,M),M=t;document.getElementById(e.element.id+"_hRuler_indicator_svg").style.display="none"}})}this.updateIndentMarkers(e)},e.prototype.updateRuler=function(e,t){if(!(e.rulerHelper&&e.documentEditorSettings&&!e.documentEditorSettings.showRuler||e.isReadOnlyMode)){i.i(n.isNullOrUndefined)(e.hRuler)&&i.i(n.isNullOrUndefined)(e.vRuler)||(e.selection.isForward?this.position=e.selection.start:this.position=e.selection.end,this.updateRulerDimension(e,e.hRuler,0,t),this.updateRulerDimension(e,e.vRuler,0,t),this.updateRulerMargins(e),this.updateIndentMarkers(e),this.updateTabStopMarkers(e),this.position.paragraph.isInsideTable?this.updateTableMarkers(e,e.hRuler):this.removeTableMarkers(e,e.hRuler),this.updateIndicatorLines(e))}},e.prototype.removeTableMarkers=function(e,t){var r=o.a.convertNodeListToArray(document.querySelectorAll(".e-de-ruler-table-marker"));if(!i.i(n.isNullOrUndefined)(r))for(var s=0;s<r.length;s++){var a=r[parseInt(s.toString(),10)];i.i(n.isNullOrUndefined)(a)||a.parentNode.removeChild(a)}},e.prototype.updateTableMarkers=function(e,t){var r=o.a.convertNodeListToArray(document.querySelectorAll(".e-de-ruler-table-marker"));i.i(n.isNullOrUndefined)(r)?this.renderTableMarkers(e,t):this.position.paragraph.isInsideTable&&this.renderTableMarkers(e,t)},e.prototype.renderTableMarkers=function(e,t){var i=this;this.removeTableMarkers(e,e.hRuler);var r=(this.position.paragraph.containerWidget.ownerTable,this.position.paragraph.associatedCell.ownerRow.clone()),s=r.childWidgets,a=this.position.paragraph.associatedCell.ownerTable.tableFormat.bidi?s.length:0;this.position.paragraph.associatedCell.ownerTable.tableFormat.bidi&&s.reverse();for(var l,d=document.getElementById(e.element.id+"_hRuler"),h=this,c=0;c<=s.length;c++)!function(r){var c=document.getElementById(e.element.id+"_tableMarker_"+a),p=void 0;0==r?(l=(s[parseInt(r.toString(),10)].x-s[parseInt(r.toString(),10)].margin.left)*e.zoomFactor+d.scrollLeft,p="left:"+(l-4)+"px;"):(l+=(s[r-1].width+s[r-1].margin.left+s[r-1].margin.right)*e.zoomFactor,p="left:"+(l-4)+"px;");var u="height:"+t.thickness+"px;overflow:hidden;width:10px;position:absolute;font-size:11px;text-align: left;z-index: 4;"+p,g={id:e.element.id+"_tableMarker_"+a,class:"e-de-ruler-table-marker",style:u};c=h.createHtmlElement("div",g);var f=new n.L10n("documenteditor",e.defaultLocale);c.setAttribute("title",f.getConstant("Move Table Column"));var m={id:e.element.id+"_tableMarker_svg"+r,width:"9px",height:"11px",style:"position:inherit;left:0px;top:3px;"},v=h.createSvgElement("svg",m);v.setAttribute("fill","none");var y={style:"position:inherit;left:0px;"},w=h.createSvgElement("path",y);w.setAttribute("class","e-de-ruler-table-svg"),w.setAttribute("d","M1 1V0H2V1H3V0H4V1H5V0H6V1H7V2H6V3H7V4H6V5H7V6H6V7H7V8H0V7H1V6H0V5H1V4H0V3H1V2H0V1H1ZM2 2V3H3V2H2ZM4 2V3H5V2H4ZM5 4H4V5H5V4ZM5 6H4V7H5V6ZM3 7V6H2V7H3ZM2 5H3V4H2V5Z"),w.setAttribute("fill","#A1A1A1"),v.appendChild(w),c.appendChild(v),d.append(c),h.position.paragraph.associatedCell.ownerTable.tableFormat.bidi?a--:a++,c.addEventListener("dblclick",function(t){e.showDialog("TableProperties"),t.stopPropagation()});var b;c.addEventListener("mousedown",function(t){b=t.clientX-c.getBoundingClientRect().left,e.startXPosition=o.a.convertPixelToPoint(t.clientX),e.isTableMarkerDragging=!0;var i,n=new o.b(t.clientX,t.clientY),r=e.viewer.findFocusedPage(n,!0,!0);if(t.currentTarget instanceof HTMLElement){var s=t.currentTarget.id.split("_"),a=s[s.length-1];i=parseInt(a)}var l=e.selection.end.paragraph.containerWidget.ownerTable;e.editorModule.tableResize.currentResizingTable=l,e.editorModule.tableResize.resizeNode=0,e.editorModule.tableResize.resizerPosition=i,e.editorModule.tableResize.startingPoint.x=r.x,e.editorModule.tableResize.startingPoint.y=r.y,e.editorHistory.initResizingHistory(r,e.editorModule.tableResize);var h=o.a.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin)*e.zoomFactor,p=h+t.clientX-b-d.getBoundingClientRect().left,u=e.documentHelper.currentPage.boundingRectangle.x,g=u+(p-h)+6,f=document.getElementById(e.element.id+"_hRuler_indicator_svg");f.style.left=g-6+"px",f.style.display="block"}),document.addEventListener("mousemove",function(t){if(!e.isDestroyed&&e.documentEditorSettings.showRuler&&e.isTableMarkerDragging){var n=document.getElementById(e.element.id+"_hRuler"),r=o.a.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin)*e.zoomFactor;if(e.selection.end.paragraph.associatedCell.ownerTable.tableFormat.bidi){r-=i.getRulerGeometry(e).width-o.a.convertPointToPixel(e.selection.end.paragraph.bodyWidget.sectionFormat.rightMargin*e.zoomFactor+e.selection.end.paragraph.bodyWidget.sectionFormat.leftMargin*e.zoomFactor)}var s=r+t.clientX-b-n.getBoundingClientRect().left;c.style.left=s+"px";var a=e.documentHelper.currentPage.boundingRectangle.x,l=a+(s-r)+6;document.getElementById(e.element.id+"_hRuler_indicator_svg").style.left=l-6+"px"}}),document.addEventListener("mouseup",function(t){if(!e.isDestroyed&&e.documentEditorSettings.showRuler&&e.isTableMarkerDragging){var n=new o.b(t.clientX,t.clientY),r=i.position.paragraph.associatedCell.ownerTable.tableFormat.bidi?e.startXPosition-o.a.convertPixelToPoint(t.clientX):o.a.convertPixelToPoint(t.clientX)-e.startXPosition;e.editorModule.tableResize.handleResizing(n,!0,r/e.zoomFactor),e.editorModule.tableResize.updateResizingHistory(e.viewer.findFocusedPage(n,!0,!0)),e.isTableMarkerDragging=!1;document.getElementById(e.element.id+"_hRuler_indicator_svg").style.display="none"}})}(c)},e.prototype.updateRulerDimension=function(e,t,i,n){var r="Horizontal"===t.orientation,s=(this.getRulerSize(e),this.getRulerGeometry(e));this.updateRulerDiv(e,s,r,t),this.updateRulerSpace(e,s,r,t),this.updateMargin(t,e,r),t.length=e.zoomFactor<1?2*t.zeroPosition/e.zoomFactor:2*t.zeroPosition*e.zoomFactor;var a=t.element;if(r?a.style.marginLeft=("Pages"===e.layoutType?e.selection.end.paragraph.bodyWidget.page.boundingRectangle.x:0)+"px":(a.parentElement.style.display="Pages"===e.layoutType?"block":"none",a.style.marginTop=e.selection.getPageTop(e.selection.end.paragraph.bodyWidget.page)+"px"),n&&(t.offset=i,t.scale=e.zoomFactor,t.length=e.zoomFactor<1?2*t.zeroPosition/e.zoomFactor:2*t.zeroPosition*e.zoomFactor,t.updateRuler()),r)if("Pages"===e.layoutType){var l=this.position.paragraph.paragraphFormat.bidi,d=!1;if(this.position.paragraph.isInsideTable&&(d=this.position.paragraph.associatedCell.ownerTable.tableFormat.bidi),l||d){var h=s.width-o.a.convertPointToPixel(e.selection.end.paragraph.bodyWidget.sectionFormat.rightMargin*e.zoomFactor);a.scrollLeft=e.hRuler.zeroPosition*e.zoomFactor-h}else a.scrollLeft=(t.zeroPosition-o.a.convertPointToPixel(e.selection.end.paragraph.bodyWidget.sectionFormat.leftMargin))*e.zoomFactor}else{var l=this.position.paragraph.paragraphFormat.bidi,d=!1;this.position.paragraph.isInsideTable&&(d=this.position.paragraph.associatedCell.ownerTable.tableFormat.bidi),a.scrollLeft=l||d?(t.zeroPosition-e.viewer.clientActiveArea.width)*e.zoomFactor-20:t.zeroPosition*e.zoomFactor-20}else a.scrollTop=(t.zeroPosition-o.a.convertPointToPixel(e.selection.end.paragraph.bodyWidget.sectionFormat.topMargin))*e.zoomFactor},e.prototype.updateRulerSpace=function(e,t,i,n){var r=document.getElementById(e.element.id+(i?"_hRuler_ruler_space":"_vRuler_ruler_space"));r&&e&&t&&(r.style.width=(i?t.width+2*n.segmentWidth:n.thickness)+"px",r.style.height=(i?n.thickness:t.height+2*n.segmentWidth)+"px")},e.prototype.updateRulerDiv=function(e,t,i,n){var r=document.getElementById(e.element.id+(i?"_hRuler":"_vRuler"));if(r&&e&&t&&(r.style.width=(i?"Continuous"===e.layoutType?t.width/e.zoomFactor:t.width:n.thickness)+"px",r.style.height=(i?n.thickness:t.height)+"px",(r=document.getElementById(e.element.id+"_overlapRuler"))&&(i?(r.style.height,n.thickness):(r.style.width,n.thickness))),i&&this.hRulerBottom){var o=document.getElementById(e.element.id+"_pageContainer");this.hRulerBottom.style.width=o.getBoundingClientRect().width+"px"}},e.prototype.getRulerGeometry=function(e){var t=(this.getRulerSize(e),e.selection.end.paragraph.bodyWidget.page.boundingRectangle.height*e.zoomFactor),i=e.selection.end.paragraph.bodyWidget.page.boundingRectangle.width*e.zoomFactor;return new a(i,t)},e.prototype.getVerticalHeight=function(e){var t=o.a.convertPixelToPoint(e.selection.end.paragraph.bodyWidget.page.boundingRectangle.height),i=e.element.getBoundingClientRect().height;return t<i?t:i-e.documentHelper.pages[0].boundingRectangle.y},e.prototype.renderTab=function(e,t,r,s,a,l){var d,h=this,c=document.getElementById(e.element.id+"_hRuler"),p=e.documentHelper.zoomFactor;switch(s){case"Left":var u=document.getElementById(e.element.id+"_LeftTab_"+a);if(!u){var g="";if(!i.i(n.isNullOrUndefined)(r)){d=this.position.paragraph.paragraphFormat.bidi?o.a.convertPointToPixel(1584-r.position):o.a.convertPointToPixel(1584+r.position);var f="left:"+(d-1.5)*p+"px;";g="height:9px;overflow:hidden;top:7px;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 4;"+f}var m={id:e.element.id+"_LeftTab_"+a,class:"e-de-ruler-tab e-de-ruler-tab-left",style:g,"data-name":"LeftTab"};u=this.createHtmlElement("div",m),u.setAttribute("title",l.getConstant("Left Tab"));var v=void 0,y={id:e.element.id+"_leftTab_svg",width:t.width/2+"px",height:t.height/2+"px",style:"position:inherit;left:0px"};v=this.createSvgElement("svg",y),v.setAttribute("fill","none");var w={style:"position:inherit;left:0px"},b=this.createSvgElement("path",w);b.setAttribute("class","e-de-ruler-tab-svg"),b.setAttribute("d","M3 5H7V7H1V1H3V5Z"),b.setAttribute("fill","#605E5C"),b.setAttribute("stroke","#A1A1A1"),v.appendChild(b),u.appendChild(v),c.append(u)}break;case"Center":var x=document.getElementById(e.element.id+"_CenterTab_"+a);if(!x){var g="";if(!i.i(n.isNullOrUndefined)(r)){d=this.position.paragraph.paragraphFormat.bidi?o.a.convertPointToPixel(1584-r.position):o.a.convertPointToPixel(1584+r.position);var f="left:"+(d-4)*p+"px;";g="height:9px;overflow:hidden;top:7px;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 4;"+f}var m={id:e.element.id+"_CenterTab_"+a,class:"e-de-ruler-tab e-de-ruler-tab-center",style:g,"data-name":"CenterTab"};x=this.createHtmlElement("div",m),x.setAttribute("title",l.getConstant("Center Tab"));var v=void 0,y={id:e.element.id+"_centerTab_svg",width:t.width/2+"px",height:t.height/2+"px",style:"position:inherit;left:0px"};v=this.createSvgElement("svg",y),v.setAttribute("fill","none");var w={style:"position:inherit;left:0px"},b=this.createSvgElement("path",w);b.setAttribute("class","e-de-ruler-tab-svg"),b.setAttribute("d","M5 5H8V7H0V5H3V1H5V5Z"),b.setAttribute("fill","#605E5C"),b.setAttribute("stroke","#A1A1A1"),v.appendChild(b),x.appendChild(v),c.append(x)}break;case"Right":var C=document.getElementById(e.element.id+"_RightTab_"+a);if(!C){var g="";if(!i.i(n.isNullOrUndefined)(r)){d=this.position.paragraph.paragraphFormat.bidi?o.a.convertPointToPixel(1584-r.position):o.a.convertPointToPixel(1584+r.position);var f="left:"+(d-5.5)*p+"px;";g="height:9px;overflow:hidden;top:7px;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 4;"+f}var m={id:e.element.id+"_RightTab_"+a,class:"e-de-ruler-tab e-de-ruler-tab-right",style:g,"data-name":"RightTab"};C=this.createHtmlElement("div",m),C.setAttribute("title",l.getConstant("Right Tab"));var v=void 0,y={id:e.element.id+"_rightTab_svg",width:t.width/2+"px",height:t.height/2+"px",style:"position:inherit;left:0px"};v=this.createSvgElement("svg",y),v.setAttribute("fill","none");var w={style:"position:inherit;left:0px"},b=this.createSvgElement("path",w);b.setAttribute("class","e-de-ruler-tab-svg"),b.setAttribute("d","M5 5V1H7V7H1V5H5Z"),b.setAttribute("fill","#605E5C"),b.setAttribute("stroke","#A1A1A1"),v.appendChild(b),C.appendChild(v),c.append(C)}break;case"Decimal":var I=document.getElementById(e.element.id+"_DecimalTab_"+a);if(!I){var g="";if(!i.i(n.isNullOrUndefined)(r)){d=this.position.paragraph.paragraphFormat.bidi?o.a.convertPointToPixel(1584-r.position):o.a.convertPointToPixel(1584+r.position);var f="left:"+(d*p-4)+"px;";g="height:9px;overflow:hidden;top:7px;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 4;"+f}var m={id:e.element.id+"_DecimalTab_"+a,class:"e-de-ruler-tab e-de-ruler-tab-decimal",style:g,"data-name":"DecimalTab"};I=this.createHtmlElement("div",m),I.setAttribute("title",l.getConstant("Decimal Tab"));var v=void 0,y={id:e.element.id+"_decimalTab_svg",width:t.width/2+"px",height:t.height/2+"px",style:"position:inherit;left:0px"};v=this.createSvgElement("svg",y),v.setAttribute("fill","none");var w={style:"position:inherit;left:0px"},b=this.createSvgElement("path",w);b.setAttribute("class","e-de-ruler-tab-svg"),b.setAttribute("d","M6 0H4V6H0V8H4H6H10V6H6V0Z"),b.setAttribute("fill","#605E5C"),b.setAttribute("clip-rule","evenodd"),b.setAttribute("fill-rule","evenodd"),b.setAttribute("stroke","#A1A1A1"),v.appendChild(b),I.appendChild(v),c.append(I)}break;case"Bar":var F=document.getElementById(e.element.id+"_BarTab_"+a);if(!F){var g="";if(!i.i(n.isNullOrUndefined)(r)){d=this.position.paragraph.paragraphFormat.bidi?o.a.convertPointToPixel(1584-r.position):o.a.convertPointToPixel(1584+r.position);var f="left:"+(d-1.5)*p+"px;";g="height:9px;overflow:hidden;top:7px;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 4;"+f}var m={id:e.element.id+"_BarTab_"+a,class:"e-de-ruler-tab e-de-ruler-tab-bar",style:g,"data-name":"BarTab"};F=this.createHtmlElement("div",m),F.setAttribute("title",l.getConstant("Bar Tab"));var v=void 0,y={id:e.element.id+"_barTab_svg",width:t.width/2+"px",height:t.height/2+"px",style:"position:inherit;left:0px"};v=this.createSvgElement("svg",y),v.setAttribute("fill","none");var k={style:"position:inherit;left:0px"},P=this.createSvgElement("rect",k);P.setAttribute("width","2"),P.setAttribute("height","8"),P.setAttribute("fill","#605E5C"),P.setAttribute("stroke","#A1A1A1"),v.appendChild(P),F.appendChild(v),c.append(F)}}if(!i.i(n.isNullOrUndefined)(r)){var T=document.getElementById(e.element.id+"_"+s+"Tab_"+a);i.i(n.isNullOrUndefined)(r)||T.addEventListener("dblclick",function(t){e.showTabDialog(),t.stopPropagation()});var S,W=!1,N=o.a.getNumberFromString(T.style.left),H=(o.a.getNumberFromString(T.style.left),T.getAttribute("data-name")),E=this.position.paragraph,O=0,_=void 0;T.addEventListener("mousedown",function(t){t.stopPropagation(),W=!0,S=t.clientX-T.getBoundingClientRect().left,N=o.a.getNumberFromString(T.style.left),O=parseInt(T.id.split("_")[3]),_=E.paragraphFormat.tabs[parseInt(O.toString(),10)],h.currentTabStopElement=T;var i=o.a.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin)*e.zoomFactor;"Continuous"===e.layoutType&&(i=e.hRuler.zeroPosition*e.zoomFactor-20,h.position.paragraph.paragraphFormat.bidi&&(i=e.hRuler.zeroPosition*e.zoomFactor-20-e.viewer.clientArea.width*e.zoomFactor));var n=i+t.clientX-S-c.getBoundingClientRect().left,r=e.documentHelper.currentPage.boundingRectangle.x;r="Continuous"===e.layoutType?0:r;var s=r+(n-i),a=document.getElementById(e.element.id+"_hRuler_indicator_svg");a.style.left=s+"px",a.style.display="block"}),T.addEventListener("mouseup",function(){i.i(n.isNullOrUndefined)(h.currentTabStopElement)||(h.currentTabStopElement=void 0)}),document.addEventListener("mousemove",function(t){if(W){var i=void 0;"Continuous"===e.layoutType?(i=e.hRuler.zeroPosition*e.zoomFactor-20,h.position.paragraph.paragraphFormat.bidi&&(i=e.hRuler.zeroPosition*e.zoomFactor-20-e.viewer.clientArea.width*e.zoomFactor)):"Pages"===e.layoutType&&(i=o.a.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin)*e.zoomFactor,h.position.paragraph.bidi&&(i=o.a.convertPointToPixel(1584+e.selection.sectionFormat.rightMargin-e.selection.sectionFormat.pageWidth)*e.zoomFactor));var n=i+t.clientX-S-c.getBoundingClientRect().left,r=i,s=document.getElementById(e.element.id+"_rightIndent"),a=o.a.getNumberFromString(s.style.left),l=a,d=document.getElementById(e.element.id+"_leftIndent"),p=o.a.getNumberFromString(d.style.left);r=p,h.position.paragraph.paragraphFormat.bidi&&(r=a,l=p),l+="CenterTab"===H||"DecimalTab"===H?4:"RightTab"===H?5.5:1.5,n<r?n=r:n>l&&(n=l),T.style.left=n+"px";var u=e.documentHelper.currentPage.boundingRectangle.x;u="Continuous"===e.layoutType?0:u;var g=u+(n-i)+6;document.getElementById(e.element.id+"_hRuler_indicator_svg").style.left=g+"px"}}),document.addEventListener("mouseup",function(){if(W&&!i.i(n.isNullOrUndefined)(_)){if(i.i(n.isNullOrUndefined)(h.currentTabStopElement)||"none"!=h.currentTabStopElement.style.display){var t=o.a.getNumberFromString(T.style.left);N=t,e.editor.removeTabStops([E],[_]),t=o.a.convertPixelToPoint(t/e.zoomFactor)-1584,t=E.paragraphFormat.bidi?-1*t:t,_.position=t,e.editor.updateTabStopCollection(E,[_])}else e.editor.removeTabStops([E],[_]),h.currentTabStopElement.parentNode.removeChild(h.currentTabStopElement);h.updateTabStopMarkers(e),W=!1;document.getElementById(e.element.id+"_hRuler_indicator_svg").style.display="none",h.currentTabStopElement=void 0}})}},e.prototype.updateMargin=function(e,t,i){i?(e.startMargin=t.selection.end.paragraph.bodyWidget.sectionFormat.leftMargin,e.endMargin=t.selection.end.paragraph.bodyWidget.sectionFormat.rightMargin):(e.startMargin=t.selection.end.paragraph.bodyWidget.sectionFormat.topMargin,e.endMargin=t.selection.end.paragraph.bodyWidget.sectionFormat.bottomMargin)},e.prototype.getTabJustification=function(e){switch(e){case"LeftTab":return"Left";case"CenterTab":return"Center";case"RightTab":return"Right";case"DecimalTab":return"Decimal";case"BarTab":return"Bar"}return"Left"},e.prototype.getRulerSize=function(e){var t=0,i=0;return t=15,i=15,new a(i,t)},e}()},function(e,t,i){"use strict";i.d(t,"a",function(){return n});var n=function(){function e(e,t){this.width=e,this.height=t}return e.prototype.isEmpty=function(){return 0===this.height&&0===this.width},e.prototype.clone=function(){return new e(this.width,this.height)},e}()},function(e,t,i){"use strict";i.d(t,"a",function(){return n});var n=function(){function e(){this.style={},this.context=new r}return e.prototype.getContext=function(e,t){return this.context},e.prototype.toDataURL=function(e,t){return this.context.renderedPath},e}(),r=function(){function e(){this.renderedPath=""}return Object.defineProperty(e.prototype,"globalAlpha",{set:function(e){this.renderedPath+="GA:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"globalCompositeOperation",{set:function(e){this.renderedPath+="GCP:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fillStyle",{set:function(e){this.renderedPath+="FS:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strokeStyle",{set:function(e){this.renderedPath+="SS:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"direction",{set:function(e){this.renderedPath+="Dir:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"font",{set:function(e){this.renderedPath+="Fn:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textAlign",{set:function(e){this.renderedPath+="TA:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textBaseline",{set:function(e){this.renderedPath+="TBL:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineWidth",{set:function(e){this.renderedPath+="LW:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineCap",{set:function(e){this.renderedPath+="LC:"+e+";"},enumerable:!0,configurable:!0}),e.prototype.drawImage=function(e,t,i,n,r,o,s,a,l){this.renderedPath+="LC:"+e.src+";",this.renderedPath+="sx:"+t+";",this.renderedPath+="sy:"+i+";",this.renderedPath+="sw:"+n+";",this.renderedPath+="sh:"+r+";",o&&(this.renderedPath+="dx:"+o+";"),s&&(this.renderedPath+="dy:"+s+";"),a&&(this.renderedPath+="dw:"+a+";"),l&&(this.renderedPath+="dh:"+l+";")},e.prototype.beginPath=function(){this.renderedPath+="BP;"},e.prototype.clip=function(e){this.renderedPath+="Cl;"},e.prototype.fill=function(e){this.renderedPath+="Fl;"},e.prototype.stroke=function(){this.renderedPath+="Stk;"},e.prototype.closePath=function(){this.renderedPath+="CP;"},e.prototype.lineTo=function(e,t){this.renderedPath+="LT:x:"+e+";y:"+t+";"},e.prototype.moveTo=function(e,t){this.renderedPath+="MT:x:"+e+";y:"+t+";"},e.prototype.rect=function(e,t,i,n){this.renderedPath+="Rt:x:"+e+";y:"+t+";w:"+i+";h:"+n+";"},e.prototype.setLineDash=function(e){this.renderedPath+="Sgm:"+e.toString()+";"},e.prototype.clearRect=function(e,t,i,n){this.renderedPath+="CR:x:"+e+";y:"+t+";w:"+i+";h:"+n+";"},e.prototype.fillRect=function(e,t,i,n){this.renderedPath+="FR:x:"+e+";y:"+t+";w:"+i+";h:"+n+";"},e.prototype.strokeRect=function(e,t,i,n){this.renderedPath+="SR:x:"+e+";y:"+t+";w:"+i+";h:"+n+";"},e.prototype.restore=function(){this.renderedPath+="RES;"},e.prototype.save=function(){this.renderedPath+="S;"},e.prototype.fillText=function(e,t,i,n){this.renderedPath+="FT:"+e+";x:"+t+";y:"+i+";",n&&(this.renderedPath+="MW:"+n+";")},e.prototype.measureText=function(e){return{width:30}},e.prototype.strokeText=function(e,t,i,n){this.renderedPath+="ST:"+e+";x:"+t+";y:"+i+";",n&&(this.renderedPath+="MW:"+n+";")},e.prototype.scale=function(e,t){this.renderedPath+="SC:x:"+e+";y:"+t+";"},e}()},function(e,t,i){"use strict";var n=i(32);i.d(t,"s",function(){return n.a}),i.d(t,"t",function(){return n.b}),i.d(t,"u",function(){return n.c}),i.d(t,"v",function(){return n.d}),i.d(t,"w",function(){return n.e});var r=i(2);i.d(t,"a",function(){return r.l}),i.d(t,"b",function(){return r.m}),i.d(t,"c",function(){return r.n}),i.d(t,"d",function(){return r.b}),i.d(t,"e",function(){return r.h}),i.d(t,"f",function(){return r.z}),i.d(t,"g",function(){return r.p}),i.d(t,"h",function(){return r.w}),i.d(t,"i",function(){return r.u}),i.d(t,"j",function(){return r.o}),i.d(t,"k",function(){return r.e}),i.d(t,"l",function(){return r.j}),i.d(t,"m",function(){return r.r}),i.d(t,"n",function(){return r.d}),i.d(t,"o",function(){return r.B}),i.d(t,"p",function(){return r.q}),i.d(t,"q",function(){return r.c}),i.d(t,"r",function(){return r.g}),i.d(t,"x",function(){return r.t}),i.d(t,"y",function(){return r.y}),i.d(t,"z",function(){return r.E}),i.d(t,"A",function(){return r.x}),i.d(t,"B",function(){return r.C}),i.d(t,"C",function(){return r.a}),i.d(t,"D",function(){return r.O}),i.d(t,"E",function(){return r._3}),i.d(t,"F",function(){return r.k}),i.d(t,"G",function(){return r.f}),i.d(t,"H",function(){return r._2}),i.d(t,"I",function(){return r.D}),i.d(t,"J",function(){return r.I}),i.d(t,"K",function(){return r.H}),i.d(t,"L",function(){return r.N}),i.d(t,"M",function(){return r.Q}),i.d(t,"N",function(){return r.P}),i.d(t,"O",function(){return r.R}),i.d(t,"P",function(){return r.S}),i.d(t,"Q",function(){return r._4}),i.d(t,"R",function(){return r.v}),i.d(t,"S",function(){return r.s}),i.d(t,"T",function(){return r.i}),i.d(t,"U",function(){return r.T}),i.d(t,"V",function(){return r.U}),i.d(t,"W",function(){return r.F}),i.d(t,"X",function(){return r.G}),i.d(t,"Y",function(){return r.J}),i.d(t,"Z",function(){return r._5}),i.d(t,"_0",function(){return r.V}),i.d(t,"_1",function(){return r.W}),i.d(t,"_2",function(){return r._6}),i.d(t,"_3",function(){return r.X}),i.d(t,"_4",function(){return r._7}),i.d(t,"_5",function(){return r.Y}),i.d(t,"_6",function(){return r.Z}),i.d(t,"_7",function(){return r._1}),i.d(t,"_8",function(){return r._8}),i.d(t,"_9",function(){return r._0}),i.d(t,"_10",function(){return r._9}),i.d(t,"_11",function(){return r._10}),i.d(t,"_12",function(){return r._11}),i.d(t,"_13",function(){return r._12}),i.d(t,"_14",function(){return r.M}),i.d(t,"_15",function(){return r.A}),i.d(t,"_16",function(){return r.L}),i.d(t,"_17",function(){return r._13}),i.d(t,"_18",function(){return r._14}),i.d(t,"_19",function(){return r._15}),i.d(t,"_20",function(){return r.K}),i.d(t,"_21",function(){return r._16});var o=i(40);i.d(t,"_22",function(){return o.a});var s=i(67);i.d(t,"_23",function(){return s.a});var a=i(134);i.d(t,"_24",function(){return a.a});var l=i(41);i.d(t,"_25",function(){return l.a});var d=i(68);i.d(t,"_26",function(){return d.a})},function(e,t,i){"use strict";i.d(t,"a",function(){return m});var n=i(0),r=(i.n(n),i(24)),o=i(23),s=i(14),a=i(26),l=i(9),d=i(2),h=i(4),c=i(6),p=i(140),u=(i.n(p),i(25)),g=i(7),f=i(1),m=function(){function e(e){this.documentHelper=void 0,this.commentStarts=void 0,this.commentEnds=void 0,this.commentsCollection=void 0,this.revisionCollection=void 0,this.isPageBreakInsideTable=!1,this.referedRevisions=[],this.isParseHeader=!1,this.footnotes=void 0,this.endnotes=void 0,this.keywordIndex=void 0,this.themes=void 0,this.isCutPerformed=!1,this.isPaste=!1,this.isHtmlPaste=!1,this.documentHelper=e,this.editableRanges=new c.a}return Object.defineProperty(e.prototype,"isPasting",{get:function(){return this.viewer&&this.viewer.owner.isPastingContent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.convertJsonToDocument=function(e,t){this.commentStarts=new c.a,this.commentEnds=new c.a,this.commentsCollection=new c.a,this.revisionCollection=new c.a,this.referedRevisions=[],this.keywordIndex=0,this.footnotes=new d.k,this.endnotes=new d.k;var r=[],o=h.a.getSfdtDocument(e);return!i.i(n.isNullOrUndefined)(o.optimizeSfdt)&&o.optimizeSfdt&&(this.keywordIndex=1),i.i(n.isNullOrUndefined)(o[f._4[this.keywordIndex]])?this.parseCharacterFormat(0,this.viewer.owner.characterFormat,this.documentHelper.characterFormat):this.parseCharacterFormat(this.keywordIndex,o[f._4[this.keywordIndex]],this.documentHelper.characterFormat),i.i(n.isNullOrUndefined)(o[f._5[this.keywordIndex]])?this.parseParagraphFormat(0,this.viewer.owner.paragraphFormat,this.documentHelper.paragraphFormat):this.parseParagraphFormat(this.keywordIndex,o[f._5[this.keywordIndex]],this.documentHelper.paragraphFormat),i.i(n.isNullOrUndefined)(o[f._33[this.keywordIndex]])||this.parseCharacterFormat(this.keywordIndex,o[f._33[this.keywordIndex]],this.documentHelper.themeFontLanguage),this.parseDocumentProtection(o),i.i(n.isNullOrUndefined)(o[f._13[this.keywordIndex]])||(this.documentHelper.defaultTabWidth=o[f._13[this.keywordIndex]]),i.i(n.isNullOrUndefined)(o[f._15[this.keywordIndex]])||(this.documentHelper.owner.enableTrackChanges=h.a.parseBoolValue(o[f._15[this.keywordIndex]])),i.i(n.isNullOrUndefined)(o[f._26[this.keywordIndex]])||(this.documentHelper.dontUseHtmlParagraphAutoSpacing=h.a.parseBoolValue(o[f._26[this.keywordIndex]])),i.i(n.isNullOrUndefined)(o[f._371[this.keywordIndex]])||(this.documentHelper.allowSpaceOfSameStyleInTable=h.a.parseBoolValue(o[f._371[this.keywordIndex]])),i.i(n.isNullOrUndefined)(o[f._27[this.keywordIndex]])||(this.documentHelper.alignTablesRowByRow=h.a.parseBoolValue(o[f._27[this.keywordIndex]])),i.i(n.isNullOrUndefined)(o[f._8[this.keywordIndex]])||(this.documentHelper.backgroundColor=this.getColor(o[f._8[this.keywordIndex]][f._221[this.keywordIndex]])),i.i(n.isNullOrUndefined)(o[f._32[this.keywordIndex]])||(this.documentHelper.compatibilityMode=this.getCompatibilityMode(o[f._32[this.keywordIndex]]),i.i(n.isNullOrUndefined)(this.documentHelper.owner.documentSettings)||(this.documentHelper.owner.documentSettings.compatibilityMode=this.getCompatibilityMode(o[f._32[this.keywordIndex]]))),i.i(n.isNullOrUndefined)(o[f._7[this.keywordIndex]])||this.parseAbstractList(o,this.documentHelper.abstractLists),i.i(n.isNullOrUndefined)(o[f._6[this.keywordIndex]])||this.parseList(o,this.documentHelper.lists),i.i(n.isNullOrUndefined)(o[f._9[this.keywordIndex]])||this.parseStyles(o,this.documentHelper.styles),i.i(n.isNullOrUndefined)(o[f._10[this.keywordIndex]])||this.parseComments(o,this.documentHelper.comments),i.i(n.isNullOrUndefined)(o[f._11[this.keywordIndex]])||this.parseRevisions(o,this.viewer.owner.revisionsInternal.changes),i.i(n.isNullOrUndefined)(o[f._377[this.keywordIndex]])||this.parseImages(o[f._377[this.keywordIndex]]),i.i(n.isNullOrUndefined)(o[f._2[this.keywordIndex]])||this.parseSections(o[f._2[this.keywordIndex]],r),i.i(n.isNullOrUndefined)(o[f._12[this.keywordIndex]])||this.parseCustomXml(o),i.i(n.isNullOrUndefined)(o[f._28[this.keywordIndex]])||(this.documentHelper.owner.documentEditorSettings.formFieldSettings.applyShading=h.a.parseBoolValue(o[f._28[this.keywordIndex]])),i.i(n.isNullOrUndefined)(o[f._30[this.keywordIndex]])||this.parseFootnotes(o[f._30[this.keywordIndex]],this.documentHelper.footnotes),i.i(n.isNullOrUndefined)(o[f._31[this.keywordIndex]])||this.parseEndtnotes(o[f._31[this.keywordIndex]],this.documentHelper.endnotes),i.i(n.isNullOrUndefined)(o[f._34[this.keywordIndex]])||this.parseThemes(o[f._34[this.keywordIndex]],this.documentHelper.themes),this.generalizeRevisions(),this.removeUnmappedBookmark(),i.i(n.isNullOrUndefined)(o[f._384[0]])||(t[f._384[0]]=o[f._384[0]]),this.documentHelper.fieldStacks&&this.documentHelper.fieldStacks.length>0&&(this.documentHelper.fieldStacks=[]),r},e.prototype.removeUnmappedBookmark=function(){for(var e=this.documentHelper.bookmarks.keys,t=this.documentHelper.endBookmarksUpdated,i=0;i<e.length;i++)if(-1===t.indexOf(e[i])){var n=this.documentHelper.bookmarks.get(e[i]);n&&n.line.children.splice(n.line.children.indexOf(n),1),this.documentHelper.bookmarks.remove(e[i])}this.documentHelper.endBookmarksUpdated=[]},e.prototype.generalizeRevisions=function(){var e=this,t=new c.a,i=[];this.referedRevisions.forEach(function(n){var r=e.documentHelper.revisionsInternal.get(n);-1===i.indexOf(r)&&(i.push(r),t.add(n,r))}),this.viewer.owner.revisionsInternal.changes=i,this.documentHelper.revisionsInternal=t},e.prototype.parseFootnotes=function(e,t){i.i(n.isNullOrUndefined)(e[f._334[this.keywordIndex]])||this.parseBody(e[f._334[this.keywordIndex]],t.separator),i.i(n.isNullOrUndefined)(e[f._336[this.keywordIndex]])||this.parseBody(e[f._336[this.keywordIndex]],t.continuationNotice),i.i(n.isNullOrUndefined)(e[f._335[this.keywordIndex]])||this.parseBody(e[f._335[this.keywordIndex]],t.continuationSeparator)},e.prototype.parseImages=function(e){for(var t in e)if(Array.isArray(e[""+t]))this.documentHelper.images.add(parseInt(t),e[""+t]);else{var i=[];i.push(e[""+t]),this.documentHelper.images.add(parseInt(t),i)}},e.prototype.parseEndtnotes=function(e,t){i.i(n.isNullOrUndefined)(e[f._334[this.keywordIndex]])||this.parseBody(e[f._334[this.keywordIndex]],t.separator),i.i(n.isNullOrUndefined)(e[f._336[this.keywordIndex]])||this.parseBody(e[f._336[this.keywordIndex]],t.continuationNotice),i.i(n.isNullOrUndefined)(e[f._335[this.keywordIndex]])||this.parseBody(e[f._335[this.keywordIndex]],t.continuationSeparator)},e.prototype.parseCustomXml=function(e){for(var t=0;t<e[f._12[this.keywordIndex]].length;t++){var i=e[f._12[this.keywordIndex]][t];this.revisionCollection.containsKey(i[f._261[this.keywordIndex]])||this.documentHelper.customXmlData.add(i[f._261[this.keywordIndex]],i[f._262[this.keywordIndex]])}},e.prototype.parseDocumentProtection=function(e){i.i(n.isNullOrUndefined)(e[f._14[this.keywordIndex]])||(this.documentHelper.restrictFormatting=h.a.parseBoolValue(e[f._14[this.keywordIndex]])),i.i(n.isNullOrUndefined)(e[f._17[this.keywordIndex]])||(this.documentHelper.isDocumentProtected=h.a.parseBoolValue(e[f._17[this.keywordIndex]])),i.i(n.isNullOrUndefined)(e[f._16[this.keywordIndex]])||(this.documentHelper.protectionType=this.getProtectionType(e[f._16[this.keywordIndex]])),i.i(n.isNullOrUndefined)(e[f._18[this.keywordIndex]])||(this.documentHelper.hashValue=e[f._18[this.keywordIndex]]),i.i(n.isNullOrUndefined)(e[f._19[this.keywordIndex]])||(this.documentHelper.saltValue=e[f._19[this.keywordIndex]])},e.prototype.parseStyles=function(e,t){for(var r=0;r<e[f._9[this.keywordIndex]].length;r++){var o=this.documentHelper.owner.editor;(!i.i(n.isNullOrUndefined)(o)&&o.isRemoteAction||i.i(n.isNullOrUndefined)(this.documentHelper.styles.findByName(e[f._9[this.keywordIndex]][r][f._35[this.keywordIndex]])))&&this.parseStyle(e,e[f._9[this.keywordIndex]][r],t)}},e.prototype.parseRevisions=function(e,t){for(var r=0;r<e[f._11[this.keywordIndex]].length;r++){var o=e[f._11[this.keywordIndex]][r];if(!i.i(n.isNullOrUndefined)(o[f._260[this.keywordIndex]])&&!i.i(n.isNullOrUndefined)(o[f._259[this.keywordIndex]])){var s=this.parseRevision(o),a=!0;if(!this.documentHelper.owner.sfdtExportModule.copyWithTrackChange&&this.isPaste){if("Insertion"===this.getRevisionType(o[f._259[this.keywordIndex]])&&this.isPaste&&this.documentHelper.owner.enableTrackChanges){var l=this.documentHelper.owner.editor;!i.i(n.isNullOrUndefined)(l)&&l.isRemoteAction&&this.documentHelper.owner.editor.revisionData.push(this.documentHelper.owner.editor.getMarkerData(void 0,void 0,s));continue}this.revisionCollection.containsKey(o[f._260[this.keywordIndex]])||this.revisionCollection.add(o[f._260[this.keywordIndex]],s)}else this.revisionCollection.add(o[f._260[this.keywordIndex]],s);for(var d=0;d<t.length;d++)t[d].revisionID===s.revisionID&&(a=!1);a&&t.push(s)}}this.documentHelper.revisionsInternal=this.revisionCollection,this.documentHelper.owner.sfdtExportModule&&(this.documentHelper.owner.sfdtExportModule.copyWithTrackChange=!1)},e.prototype.parseRevision=function(e){if(!i.i(n.isNullOrUndefined)(e)){var t=new u.b(this.viewer.owner,e[f._254[this.keywordIndex]],e[f._256[this.keywordIndex]]);return t.revisionID=e[f._260[this.keywordIndex]],t.revisionType=this.getRevisionType(e[f._259[this.keywordIndex]]),t}},e.prototype.checkAndApplyRevision=function(e,t,r){if(!i.i(n.isNullOrUndefined)(t[f._64[e]])&&t[f._64[e]].length>0)for(var o=0;o<t[f._64[e]].length;o++){var s=t[f._64[e]][o];if(this.revisionCollection.containsKey(s)){this.referedRevisions.push(s);var a=this.revisionCollection.get(s);r instanceof l.a||a.range.push(r),r.revisions.push(a)}}},e.prototype.parseComments=function(e,t){for(var i=0,n=0;n<e[f._10[this.keywordIndex]].length;n++){var r=e[f._10[this.keywordIndex]][n],o=void 0;for(o=this.parseComment(r,o);i<r[f._258[this.keywordIndex]].length;){var s=void 0;s=this.parseComment(r[f._258[this.keywordIndex]][i],s),s.ownerComment=o,s.isReply=!0,o.replyComments.push(s),this.commentsCollection.add(s.commentId,s),i++}this.commentsCollection.add(o.commentId,o),t.push(o),i=0}},e.prototype.parseComment=function(e,t){return t=new d.M(e[f._256[this.keywordIndex]]),t.author=e[f._254[this.keywordIndex]],t.initial=e[f._255[this.keywordIndex]],t.commentId=e[f._252[this.keywordIndex]],t.isResolved=h.a.parseBoolValue(e[f._257[this.keywordIndex]]),t.text=this.parseCommentText(e[f._314[this.keywordIndex]]),t},e.prototype.parseCommentText=function(e){for(var t="",i=0;i<e.length;i++){0!==i&&(t+="\n");for(var n=0;n<e[i][f._267[this.keywordIndex]].length;n++)t+=e[i][f._267[this.keywordIndex]][n][f._198[this.keywordIndex]]}return t},e.prototype.parseStyle=function(e,t,r,o){var s,a=0,d=this.documentHelper.owner.editor;if(!i.i(n.isNullOrUndefined)(o)&&o&&(a=this.keywordIndex,this.keywordIndex=0),!i.i(n.isNullOrUndefined)(t[f._359[this.keywordIndex]])){if("Paragraph"===this.getStyleType(t[f._359[this.keywordIndex]])&&(s=new l.k,s.type="Paragraph"),"Character"===this.getStyleType(t[f._359[this.keywordIndex]])&&(s=new l.l,s.type="Character"),i.i(n.isNullOrUndefined)(t[f._35[this.keywordIndex]])||(s.name=t[f._35[this.keywordIndex]]),r.push(s),!i.i(n.isNullOrUndefined)(t[f._36[this.keywordIndex]])){var h=void 0;if(h=!i.i(n.isNullOrUndefined)(d)&&d.isRemoteAction?this.documentHelper.styles.findByName(t[f._36[this.keywordIndex]]):r.findByName(t[f._36[this.keywordIndex]]),i.i(n.isNullOrUndefined)(h)){var c=this.getStyle(t[f._36[this.keywordIndex]],e),p=void 0;p=i.i(n.isNullOrUndefined)(c)||this.getStyleType(c[f._359[this.keywordIndex]])!==s.type?"Paragraph"===s.type?JSON.parse('{"type":"Paragraph","name":"Normal","next":"Normal"}'):JSON.parse('{"type": "Character","name": "Default Paragraph Font"}'):c,this.parseStyle(e,p,r),!i.i(n.isNullOrUndefined)(d)&&d.isRemoteAction?s.basedOn=this.documentHelper.styles.findByName(p[f._35[this.keywordIndex]]):s.basedOn=r.findByName(p[f._35[this.keywordIndex]])}else h.type===s.type&&h.name!==s.name&&(s.basedOn=h)}if(!i.i(n.isNullOrUndefined)(t[f._38[this.keywordIndex]])){var u=r.findByName(t[f._38[this.keywordIndex]]),g=this.getStyle(t[f._38[this.keywordIndex]],e);!i.i(n.isNullOrUndefined)(d)&&d.isRemoteAction&&(u=this.documentHelper.styles.findByName(t[f._38[this.keywordIndex]]));var p=void 0;if(i.i(n.isNullOrUndefined)(u)){if(i.i(n.isNullOrUndefined)(g)){var m={};m.characterFormat=t[f._4[this.keywordIndex]],m.name=t[f._35[this.keywordIndex]]+" Char",m.type="Character",m.basedOn="Normal"===t[f._36[this.keywordIndex]]?"Default Paragraph Font":t[f._36[this.keywordIndex]]+" Char",p=m}else p=g;this.parseStyle(e,p,r),!i.i(n.isNullOrUndefined)(d)&&d.isRemoteAction?s.link=i.i(n.isNullOrUndefined)(this.documentHelper.styles.findByName(p.name))?t[f._38[this.keywordIndex]]:this.documentHelper.styles.findByName(p.name):s.link=i.i(n.isNullOrUndefined)(r.findByName(p.name))?t[f._38[this.keywordIndex]]:r.findByName(p.name)}else s.link=u}if(i.i(n.isNullOrUndefined)(t[f._4[this.keywordIndex]])||this.parseCharacterFormat(this.keywordIndex,t[f._4[this.keywordIndex]],s.characterFormat),i.i(n.isNullOrUndefined)(t[f._5[this.keywordIndex]])||this.parseParagraphFormat(this.keywordIndex,t[f._5[this.keywordIndex]],s.paragraphFormat),!i.i(n.isNullOrUndefined)(t[f._37[this.keywordIndex]]))if(t[f._37[this.keywordIndex]]===t[f._35[this.keywordIndex]])s.next=s;else{var v=void 0;if(v=!i.i(n.isNullOrUndefined)(d)&&d.isRemoteAction?this.documentHelper.styles.findByName(t[f._37[this.keywordIndex]]):r.findByName(t[f._37[this.keywordIndex]]),i.i(n.isNullOrUndefined)(v)||v.type!==s.type){var y=this.getStyle(t[f._37[this.keywordIndex]],e);i.i(n.isNullOrUndefined)(y)?s.next=s:(this.parseStyle(e,y,r),!i.i(n.isNullOrUndefined)(d)&&d.isRemoteAction?s.next=this.documentHelper.styles.findByName(y.name):s.next=r.findByName(y.name))}else s.next=v}}!i.i(n.isNullOrUndefined)(o)&&o&&(this.keywordIndex=a),i.i(n.isNullOrUndefined)(s)||this.documentHelper.addToStylesMap(s)},e.prototype.getStyle=function(e,t){for(var i=0;i<t[f._9[this.keywordIndex]].length;i++)if(t[f._9[this.keywordIndex]][i][f._35[this.keywordIndex]]===e)return t[f._9[this.keywordIndex]][i]},e.prototype.parseAbstractList=function(e,t){for(var r=0;r<e[f._7[this.keywordIndex]].length;r++){var o=new s.a,a=e[f._7[this.keywordIndex]][r];if(!i.i(n.isNullOrUndefined)(a)&&(i.i(n.isNullOrUndefined)(a[f._329[this.keywordIndex]])||(o.abstractListId=a[f._329[this.keywordIndex]]),i.i(n.isNullOrUndefined)(a[f._330])?o.nsid=h.a.generateUniqueId(void 0,t):o.nsid=a[f._330],!i.i(n.isNullOrUndefined)(a[f._331[this.keywordIndex]])))for(var l=0;l<a[f._331[this.keywordIndex]].length;l++){var d=a[f._331[this.keywordIndex]][l];if(!i.i(n.isNullOrUndefined)(d)){var c=this.parseListLevel(d,o);o.levels.push(c)}}t.push(o)}},e.prototype.parseListLevel=function(e,t){var r=new o.a(t);return"Bullet"===this.getListLevelPattern(e[f._323[this.keywordIndex]])?(r.listLevelPattern="Bullet",r.numberFormat=i.i(n.isNullOrUndefined)(e[f._328[this.keywordIndex]])?"":e[f._328[this.keywordIndex]]):(r.listLevelPattern=this.getListLevelPattern(e[f._323[this.keywordIndex]]),r.startAt=e[f._325[this.keywordIndex]],r.numberFormat=i.i(n.isNullOrUndefined)(e[f._328[this.keywordIndex]])?"":e[f._328[this.keywordIndex]],e[f._326[this.keywordIndex]]>=0?r.restartLevel=e[f._326[this.keywordIndex]]:r.restartLevel=e[f._327[this.keywordIndex]]),r.isLegalStyleNumbering=!i.i(n.isNullOrUndefined)(e[f._301[this.keywordIndex]])&&h.a.parseBoolValue(e[f._301[this.keywordIndex]]),r.followCharacter=this.getFollowCharacterType(e[f._324[this.keywordIndex]]),this.parseCharacterFormat(this.keywordIndex,e[f._4[this.keywordIndex]],r.characterFormat),this.parseParagraphFormat(this.keywordIndex,e[f._5[this.keywordIndex]],r.paragraphFormat),r},e.prototype.parseList=function(e,t){for(var o=0;o<e[f._6[this.keywordIndex]].length;o++){var s=new r.a,a=e[f._6[this.keywordIndex]][o];i.i(n.isNullOrUndefined)(a[f._329[this.keywordIndex]])||(s.abstractListId=a[f._329[this.keywordIndex]],s.abstractList=this.documentHelper.getAbstractListById(a[f._329[this.keywordIndex]])),t.push(s),i.i(n.isNullOrUndefined)(a[f._65[this.keywordIndex]])||(s.listId=a[f._65[this.keywordIndex]]),i.i(n.isNullOrUndefined)(a[f._330])?s.nsid=s.abstractList.nsid:s.nsid=a[f._330],a.hasOwnProperty(f._333[this.keywordIndex])&&this.parseLevelOverride(a[f._333[this.keywordIndex]],s)}},e.prototype.parseLevelOverride=function(e,t){if(!i.i(n.isNullOrUndefined)(e))for(var r=0;r<e.length;r++){var o=new a.a,s=e[r];o.startAt=s[f._325[this.keywordIndex]],o.levelNumber=s[f._327[this.keywordIndex]],i.i(n.isNullOrUndefined)(s[f._332[this.keywordIndex]])||(o.overrideListLevel=this.parseListLevel(s[f._332[this.keywordIndex]],o)),t.levelOverrides.push(o)}},e.prototype.parseSections=function(e,t){for(var r=0;r<e.length;r++){var o=new d.o;o.sectionFormat=new l.i(o),o.index=r;var s=e[r],a="",h=e[r+1],c=h&&h[f._322[this.keywordIndex]]?h[f._322[this.keywordIndex]]:void 0;a=c&&c[f._110[this.keywordIndex]]?c[f._110[this.keywordIndex]]:"NewPage",i.i(n.isNullOrUndefined)(s[f._322[this.keywordIndex]])||this.parseSectionFormat(this.keywordIndex,s[f._322[this.keywordIndex]],o.sectionFormat),i.i(n.isNullOrUndefined)(s[f._321[this.keywordIndex]])&&(s[f._321[this.keywordIndex]]={}),this.documentHelper.headersFooters.push(this.parseHeaderFooter(s[f._321[this.keywordIndex]],this.documentHelper.headersFooters)),this.isParseHeader=!1,this.parseTextBody(s[f._314[this.keywordIndex]],o,r+1<e.length,a);for(var p=0;p<o.childWidgets.length;p++)o.childWidgets[p].containerWidget=o;t.push(o)}},e.prototype.parseHeaderFooter=function(e,t){this.isParseHeader=!0;var r={};if(!i.i(n.isNullOrUndefined)(e[f._315[this.keywordIndex]])){var o=new d.x("OddHeader");r[0]=o,this.parseTextBody(e[f._315[this.keywordIndex]][f._314[this.keywordIndex]],o)}if(!i.i(n.isNullOrUndefined)(e[f._316[this.keywordIndex]])){var s=new d.x("OddFooter");r[1]=s,this.parseTextBody(e[f._316[this.keywordIndex]][f._314[this.keywordIndex]],s)}if(!i.i(n.isNullOrUndefined)(e[f._317[this.keywordIndex]])){var a=new d.x("EvenHeader");r[2]=a,this.parseTextBody(e[f._317[this.keywordIndex]][f._314[this.keywordIndex]],a)}if(!i.i(n.isNullOrUndefined)(e[f._318[this.keywordIndex]])){var l=new d.x("EvenFooter");r[3]=l,this.parseTextBody(e[f._318[this.keywordIndex]][f._314[this.keywordIndex]],l)}if(!i.i(n.isNullOrUndefined)(e[f._319[this.keywordIndex]])){var h=new d.x("FirstPageHeader");r[4]=h,this.parseTextBody(e[f._319[this.keywordIndex]][f._314[this.keywordIndex]],h)}if(!i.i(n.isNullOrUndefined)(e[f._320[this.keywordIndex]])){var c=new d.x("FirstPageFooter");r[5]=c,this.parseTextBody(e[f._320[this.keywordIndex]][f._314[this.keywordIndex]],c)}return r},e.prototype.parseTextBody=function(e,t,i,n){this.parseBody(e,t.childWidgets,t,i,void 0,void 0,n)},e.prototype.addCustomStyles=function(e){if(!i.i(n.isNullOrUndefined)(e[f._9[this.keywordIndex]]))for(var t=0;t<e[f._9[this.keywordIndex]].length;t++){var r=this.documentHelper.styles.findByName(e[f._9[this.keywordIndex]][t][f._35[this.keywordIndex]]);void 0===r&&this.parseStyle(e,e[f._9[this.keywordIndex]][t],this.documentHelper.styles)}},e.prototype.parseBody=function(e,t,r,o,s,a,h){if(!i.i(n.isNullOrUndefined)(e))for(var c=0;c<e.length;c++){var p=e[c],u=!1;if(p.hasOwnProperty(f._267[this.keywordIndex])){var g=new d.g;if(g.characterFormat=new l.c(g),g.paragraphFormat=new l.a(g),p[f._267[this.keywordIndex]].length>0&&(u=this.parseParagraph(p[f._267[this.keywordIndex]],g,!1),p.hasOwnProperty(f._23[this.keywordIndex])&&(g.isCreatedUsingHtmlSpanTag=p[f._23[this.keywordIndex]])),!o||p!==e[e.length-1]||0!==p[f._267[this.keywordIndex]].length||u){this.parseCharacterFormat(this.keywordIndex,p[f._4[this.keywordIndex]],g.characterFormat),this.parseParagraphFormat(this.keywordIndex,p[f._5[this.keywordIndex]],g.paragraphFormat);var m=void 0,v="Normal";i.i(n.isNullOrUndefined)(p[f._5[this.keywordIndex]])||i.i(n.isNullOrUndefined)(p[f._5[this.keywordIndex]][f._51[this.keywordIndex]])||(v=p[f._5[this.keywordIndex]][f._51[this.keywordIndex]],!0),m=this.documentHelper.styles.findByName(v,"Paragraph"),i.i(n.isNullOrUndefined)(m)||g.paragraphFormat.applyStyle(m),t.push(g)}else if(o&&1===e.length)t.push(g);else if(o&&p===e[e.length-1]&&0===p[f._267[this.keywordIndex]].length&&!u&&"NoBreak"!=h){var y=e.indexOf(p),w=e[y-1];!i.i(n.isNullOrUndefined)(w)&&w.hasOwnProperty(f._298[this.keywordIndex])&&(t.push(g),g.isSectionBreak=!0)}g.index=t.length-1,g.containerWidget=r}else if(p.hasOwnProperty(f._298[this.keywordIndex]))this.parseTable(p,t,t.length,r);else if(p.hasOwnProperty(f._268[this.keywordIndex])){var b=new d.H("Block"),x=new d.H("Block");this.parseContentControlProperties(p[f._268[this.keywordIndex]],b.contentControlProperties),x.contentControlProperties=b.contentControlProperties,b.type=0,x.type=1,this.parseBody(p[f._314[this.keywordIndex]],t,r,o,b.contentControlProperties);for(var C=0;C<2;C++){var I=t.length<p[f._314[this.keywordIndex]].length?t[0]:0===C?t[t.length-p[f._314[this.keywordIndex]].length]:t[t.length-1],F=void 0;if(I instanceof d.g)F=I;else if(I instanceof d.u)if(0===C)F=I.firstChild.firstChild.firstChild;else{var k=I.lastChild.lastChild;F=k.lastChild}if(!i.i(n.isNullOrUndefined)(F)&&0===F.childWidgets.length){var P=new d.p(F);F.childWidgets.push(P)}0===C?(F.firstChild.children.splice(0,0,b),b.line=F.firstChild):(F.lastChild.children.push(x),x.line=F.lastChild)}}i.i(n.isNullOrUndefined)(s)||(t[t.length-1].contentControlProperties=s)}},e.prototype.parseTable=function(e,t,r,o){var s=new d.u;s.index=r,i.i(n.isNullOrUndefined)(e[f._303[this.keywordIndex]])||this.parseTableFormat(e[f._303[this.keywordIndex]],s.tableFormat,this.keywordIndex),s.tableFormat.title=e[f._272[this.keywordIndex]],s.tableFormat.description=e[f._299[this.keywordIndex]],this.parseTablePositioning(e,s);for(var a=0;a<e[f._298[this.keywordIndex]].length;a++){var h=new d.z;h.rowFormat=new l.e(h);var c=e[f._298[this.keywordIndex]][a];if(i.i(n.isNullOrUndefined)(c[f._268[this.keywordIndex]])||(h.contentControlProperties=new d.N("Row"),this.parseContentControlProperties(c[f._268[this.keywordIndex]],h.contentControlProperties)),c.hasOwnProperty(f._296[this.keywordIndex])){this.parseRowFormat(c[f._296[this.keywordIndex]],h.rowFormat,this.keywordIndex),h.index=a;for(var p=0;p<c[f._297[this.keywordIndex]].length;p++){var u=new d.j;u.cellFormat=new l.f(u);var g=c[f._297[this.keywordIndex]][p];i.i(n.isNullOrUndefined)(g[f._268[this.keywordIndex]])||(u.contentControlProperties=new d.N("Cell"),this.parseContentControlProperties(g[f._268[this.keywordIndex]],u.contentControlProperties)),h.childWidgets.push(u),u.containerWidget=h,u.index=p,u.rowIndex=a,u.columnIndex=p,g.hasOwnProperty(f._295[this.keywordIndex])&&this.parseCellFormat(g[f._295[this.keywordIndex]],u.cellFormat,this.keywordIndex);for(var m=g[f._314[this.keywordIndex]],v=0;v<m.length;v++)m[v].hasOwnProperty([f._298[this.keywordIndex]])&&(s.isContainInsideTable=!0);if(this.isPageBreakInsideTable=!0,this.parseTextBody(g[f._314[this.keywordIndex]],u,!1),!i.i(n.isNullOrUndefined)(u.contentControlProperties)){var y=new d.H("Cell"),w=new d.H("Cell");if(y.contentControlProperties=u.contentControlProperties,w.contentControlProperties=u.contentControlProperties,y.type=0,w.type=1,0===u.firstChild.childWidgets.length){var b=new d.p(u.firstChild);u.firstChild.childWidgets.push(b)}if(y.line=u.firstChild.firstChild,u.firstChild.firstChild.children.splice(0,0,y),0===u.lastChild.childWidgets.length){var b=new d.p(u.lastChild);u.lastChild.childWidgets.push(b)}w.line=u.lastChild.lastChild,u.lastChild.lastChild.children.push(w)}if(!i.i(n.isNullOrUndefined)(h.contentControlProperties))if(h.firstChild===u){var x=new d.H("Row");if(x.contentControlProperties=h.contentControlProperties,x.type=0,0===u.firstChild.childWidgets.length){var b=new d.p(u.firstChild);u.firstChild.childWidgets.push(b)}x.line=u.firstChild.firstChild,u.firstChild.firstChild.children.splice(0,0,x)}else if(h.lastChild===u){var C=new d.H("Row");if(C.contentControlProperties=h.contentControlProperties,C.type=1,0===u.lastChild.childWidgets.length){var b=new d.p(u.lastChild);u.lastChild.childWidgets.push(b)}C.line=u.lastChild.lastChild,u.lastChild.lastChild.children.push(C)}this.isPageBreakInsideTable=!1}}s.childWidgets.push(h),h.containerWidget=s}s.containerWidget=o,t.push(s),s.isGridUpdated=!1},e.prototype.parseTablePositioning=function(e,t){t.wrapTextAround=!i.i(n.isNullOrUndefined)(e[f._300[this.keywordIndex]])&&h.a.parseBoolValue(e[f._300[this.keywordIndex]]),t.wrapTextAround&&(t.positioning=new d.O,t.positioning.allowOverlap=h.a.parseBoolValue(e[f._302[this.keywordIndex]][f._304[this.keywordIndex]]),i.i(n.isNullOrUndefined)(e[f._302[this.keywordIndex]][f._308[this.keywordIndex]])||(t.positioning.distanceBottom=h.a.convertPointToPixel(e[f._302[this.keywordIndex]][f._308[this.keywordIndex]])),i.i(n.isNullOrUndefined)(e[f._302[this.keywordIndex]][f._307[this.keywordIndex]])||(t.positioning.distanceLeft=h.a.convertPointToPixel(e[f._302[this.keywordIndex]][f._307[this.keywordIndex]])),i.i(n.isNullOrUndefined)(e[f._302[this.keywordIndex]][f._306[this.keywordIndex]])||(t.positioning.distanceRight=h.a.convertPointToPixel(e[f._302[this.keywordIndex]][f._306[this.keywordIndex]])),i.i(n.isNullOrUndefined)(e[f._302[this.keywordIndex]][f._305[this.keywordIndex]])||(t.positioning.distanceTop=h.a.convertPointToPixel(e[f._302[this.keywordIndex]][f._305[this.keywordIndex]])),i.i(n.isNullOrUndefined)(e[f._302[this.keywordIndex]][f._114[this.keywordIndex]])||(t.positioning.verticalAlignment=this.getTableVerticalPosition(e[f._302[this.keywordIndex]][f._114[this.keywordIndex]])),i.i(n.isNullOrUndefined)(e[f._302[this.keywordIndex]][f._309[this.keywordIndex]])||(t.positioning.verticalOrigin=this.getTableVerticalRelation(e[f._302[this.keywordIndex]][f._309[this.keywordIndex]])),t.positioning.verticalPosition=e[f._302[this.keywordIndex]][f._310[this.keywordIndex]],i.i(n.isNullOrUndefined)(e[f._302[this.keywordIndex]][f._312[this.keywordIndex]])||(t.positioning.horizontalAlignment=this.getTableHorizontalPosition(e[f._302[this.keywordIndex]][f._312[this.keywordIndex]])),i.i(n.isNullOrUndefined)(e[f._302[this.keywordIndex]][f._311[this.keywordIndex]])||(t.positioning.horizontalOrigin=this.getTableHorizontalRelation(e[f._302[this.keywordIndex]][f._311[this.keywordIndex]])),t.positioning.horizontalPosition=e[f._302[this.keywordIndex]][f._313[this.keywordIndex]])},e.prototype.parseRowGridValues=function(e,t,r){i.i(n.isNullOrUndefined)(e[f._120[r]])||(t.gridBefore=e[f._120[r]]),i.i(n.isNullOrUndefined)(e[f._121[r]])||(t.gridBeforeWidth=e[f._121[r]]),i.i(n.isNullOrUndefined)(e[f._122[r]])||(t.gridBeforeWidthType=this.getWidthType(e[f._122[r]])),i.i(n.isNullOrUndefined)(e[f._123[r]])||(t.gridAfter=e[f._123[r]]),i.i(n.isNullOrUndefined)(e[f._124[r]])||(t.gridAfterWidth=e[f._124[r]]),i.i(n.isNullOrUndefined)(e[f._125[r]])||(t.gridAfterWidthType=this.getWidthType(e[f._125[r]]))},e.prototype.parseContentControlProperties=function(e,t){if(i.i(n.isNullOrUndefined)(e[f._269[this.keywordIndex]])||(t.lockContentControl=h.a.parseBoolValue(e[f._269[this.keywordIndex]])),i.i(n.isNullOrUndefined)(e[f._270[this.keywordIndex]])||(t.lockContents=h.a.parseBoolValue(e[f._270[this.keywordIndex]])),i.i(n.isNullOrUndefined)(e[f._271[this.keywordIndex]])||(t.tag=e[f._271[this.keywordIndex]]),i.i(n.isNullOrUndefined)(e[f._221[this.keywordIndex]])||(t.color=e[f._221[this.keywordIndex]]),i.i(n.isNullOrUndefined)(e[f._272[this.keywordIndex]])||(t.title=e[f._272[this.keywordIndex]]),i.i(n.isNullOrUndefined)(e[f._369[this.keywordIndex]])||(t.appearance=this.getContentControlAppearance(e[f._369[this.keywordIndex]])),i.i(n.isNullOrUndefined)(e[f._359[this.keywordIndex]])||(t.type=this.getContentControlType(e[f._359[this.keywordIndex]])),i.i(n.isNullOrUndefined)(e[f._273[this.keywordIndex]])||(t.hasPlaceHolderText=h.a.parseBoolValue(e[f._273[this.keywordIndex]])),i.i(n.isNullOrUndefined)(e[f._274[this.keywordIndex]])||(t.multiline=h.a.parseBoolValue(e[f._274[this.keywordIndex]])),i.i(n.isNullOrUndefined)(e[f._275[this.keywordIndex]])||(t.isTemporary=h.a.parseBoolValue(e[f._275[this.keywordIndex]])),i.i(n.isNullOrUndefined)(e[f._4[this.keywordIndex]])||this.parseCharacterFormat(this.keywordIndex,e[f._4[this.keywordIndex]],t.characterFormat),"CheckBox"===t.type)i.i(n.isNullOrUndefined)(e[f._280[this.keywordIndex]])||(t.isChecked=h.a.parseBoolValue(e[f._280[this.keywordIndex]])),i.i(n.isNullOrUndefined)(e[f._281[this.keywordIndex]])||(t.uncheckedState=new d.P,t.uncheckedState.font=e[f._281[this.keywordIndex]][f._285[this.keywordIndex]],t.uncheckedState.value=e[f._281[this.keywordIndex]][f._286[this.keywordIndex]]),i.i(n.isNullOrUndefined)(e[f._282[this.keywordIndex]])||(t.checkedState=new d.P,t.checkedState.font=e[f._282[this.keywordIndex]][f._285[this.keywordIndex]],t.checkedState.value=e[f._282[this.keywordIndex]][f._286[this.keywordIndex]]);else if("Date"===t.type)i.i(n.isNullOrUndefined)(e[f._276[this.keywordIndex]])||(t.dateCalendarType=this.getDateCalendarType(e[f._276[this.keywordIndex]])),i.i(n.isNullOrUndefined)(e[f._277[this.keywordIndex]])||(t.dateStorageFormat=this.getDateStorageFormat(e[f._277[this.keywordIndex]])),i.i(n.isNullOrUndefined)(e[f._278[this.keywordIndex]])||(t.dateDisplayLocale=e[f._278[this.keywordIndex]]),i.i(n.isNullOrUndefined)(e[f._279[this.keywordIndex]])||(t.dateDisplayFormat=e[f._279[this.keywordIndex]]);else if(("ComboBox"===t.type||"DropDownList"===t.type)&&!i.i(n.isNullOrUndefined)(e[f._283[this.keywordIndex]]))for(var r=0;r<e[f._283[this.keywordIndex]].length;r++){var o=new d.Q;o.displayText=e[f._283[this.keywordIndex]][r][f._287[this.keywordIndex]],o.value=e[f._283[this.keywordIndex]][r][f._286[this.keywordIndex]],t.contentControlListItems.push(o)}i.i(n.isNullOrUndefined)(e[f._284[this.keywordIndex]])||(t.xmlMapping=new d.R,t.xmlMapping.isMapped=h.a.parseBoolValue(e[f._284[this.keywordIndex]][f._288[this.keywordIndex]]),t.xmlMapping.isWordMl=h.a.parseBoolValue(e[f._284[this.keywordIndex]][f._289[this.keywordIndex]]),i.i(n.isNullOrUndefined)(e[f._284[this.keywordIndex]][f._290[this.keywordIndex]])||(t.xmlMapping.prefixMapping=e[f._284[this.keywordIndex]][f._290[this.keywordIndex]]),t.xmlMapping.xPath=e[f._284[this.keywordIndex]][f._291[this.keywordIndex]],t.xmlMapping.storeItemId=e[f._284[this.keywordIndex]][f._292[this.keywordIndex]],i.i(n.isNullOrUndefined)(e[f._284[this.keywordIndex]][f._293[this.keywordIndex]])||(t.xmlMapping.customXmlPart=new d.S,t.xmlMapping.customXmlPart.id=e[f._284[this.keywordIndex]][f._293[this.keywordIndex]][f._294[this.keywordIndex]],t.xmlMapping.customXmlPart.xml=e[f._284[this.keywordIndex]][f._293[this.keywordIndex]][f._262[this.keywordIndex]]))},e.prototype.parseSymbol=function(e,t){var i=e.split(" "),n=i.indexOf("SYMBOL");if(-1!==n){var r=i[n+1],o=new d.d;o.characterFormat=new l.c(o),o.text=String.fromCharCode(parseInt(r));var s=i.indexOf("\\f");if(-1!==s){for(var a="",h=s+1;h<i.length&&"\\s"!==i[h];h++)a+=i[h]+" ";null!==a&&(a=a.replace(/"/g,""),a=a.trim(),o.characterFormat.fontFamily=a)}var c=i.indexOf("\\s");-1!==c&&(o.characterFormat.fontSize=parseInt(i[c+1])),o.line=t,t.children.push(o)}},e.prototype.parseParagraph=function(e,t,r,o){var s=this,a=!1;i.i(n.isNullOrUndefined)(o)?o=new d.p(t):a=!0,e.hasOwnProperty(f._23[this.keywordIndex])&&(t.isCreatedUsingHtmlSpanTag=e[f._23[this.keywordIndex]]);for(var c,u,g=!1,m=this.viewer.owner.enableTrackChanges,v=0,y=!1,w=!1,b=void 0,x=this,C=0;C<e.length;C++)!function(a){var C=e[a];if(y=!1,C.hasOwnProperty([f._237[x.keywordIndex]])&&(2===C[f._237[x.keywordIndex]]&&(v=a),1===C[f._237[x.keywordIndex]]&&v+1===a&&(y=!0,v=0)),y&&x.documentHelper.isPageField){var I=new d.D;return I.characterFormat=new l.c(I),I.text="",I.line=o,o.children.push(I),g=!0,a--,u=a,"continue"}if(y&&!i.i(n.isNullOrUndefined)(b)&&-1!==b.indexOf("SYMBOL")&&(x.parseSymbol(b,o),b=void 0,y=!1),C.hasOwnProperty(f._198[x.keywordIndex])||C.hasOwnProperty(f._54[x.keywordIndex])){var I=void 0;if(x.documentHelper.isPageField)I=new d.D,I.fieldBegin=x.documentHelper.fieldStacks[x.documentHelper.fieldStacks.length-1];else if("\t"===C[f._198[x.keywordIndex]])I=new d.I;else{if("\f"===C[f._198[x.keywordIndex]]&&x.isPageBreakInsideTable)return u=a,"continue";C.hasOwnProperty(f._54[x.keywordIndex])?(I=new d.K,I.breakClearType=x.getBreakClearType(C[f._54[x.keywordIndex]])):I=new d.d}if(I.characterFormat=new l.c(I),x.parseCharacterFormat(x.keywordIndex,C[f._4[x.keywordIndex]],I.characterFormat,r),x.applyCharacterStyle(C,I),I.text=I instanceof d.K?"\v":C[f._198[x.keywordIndex]],b=I.text,x.isHtmlPaste&&(I instanceof d.d||I instanceof d.K)){var F=void 0;o.children.length>0&&(F=o.children[o.children.length-1]),x.documentHelper.textHelper.isRTLText(I.text)?(I.characterFormat.bidi=!0,F instanceof d.d&&" "===F.text&&(F.characterFormat.bidi=!0)):" "===I.text&&F&&F.characterFormat.bidi&&(I.characterFormat.bidi=!0)}if(x.documentHelper.owner.parser.isPaste&&!x.isCutPerformed){if(!i.i(n.isNullOrUndefined)(C[f._64[x.keywordIndex]]))for(var k=0;k<C[f._64[x.keywordIndex]].length;k++)if(x.revisionCollection.containsKey(C[f._64[x.keywordIndex]][k])){if(m&&(c=x.revisionCollection.get(C[f._64[x.keywordIndex]][k])),!i.i(n.isNullOrUndefined)(c)&&!i.i(n.isNullOrUndefined)(o.children[a-1].revisions[k])&&(!m||m&&"Deletion"===c.revisionType)&&c.revisionID===C[f._64[x.keywordIndex]][k]){C[f._64[x.keywordIndex]][k]=o.children[a-1].revisions[k].revisionID,x.checkAndApplyRevision(x.keywordIndex,C,I);continue}m||(c=x.documentHelper.revisionsInternal.get(C[f._64[x.keywordIndex]][k])),x.documentHelper.owner.editorModule.insertRevision(I,c.revisionType,c.author),C[f._64[x.keywordIndex]][k]=I.revisions[k].revisionID}}else x.checkAndApplyRevision(x.keywordIndex,C,I);I.line=o;for(var P=o.children,T=P.length-1;P.length>0&&P[T]instanceof d.e&&!i.i(n.isNullOrUndefined)(P[T].properties)&&!0===P[T].properties.isAfterParagraphMark;)T--;T!==P.length-1?P.splice(T+1,0,I):P.push(I),I instanceof d.d&&I.text.length>90&&h.a.splitWordByMaxLength(I,o,!0),g=!0}else if(C.hasOwnProperty(f._263[x.keywordIndex])){var S=new d.f;S.line=o,S.footnoteType=x.getFootnoteType(C[f._263[x.keywordIndex]]),"Footnote"===S.footnoteType?x.documentHelper.footnoteCollection.push(S):x.documentHelper.endnoteCollection.push(S),S.symbolCode=C[f._264[x.keywordIndex]],S.symbolFontName=C[f._265[x.keywordIndex]],S.customMarker=C[f._266[x.keywordIndex]],S.characterFormat=new l.c(S),x.parseCharacterFormat(x.keywordIndex,C[f._4[x.keywordIndex]],S.characterFormat,r),x.applyCharacterStyle(C,S),x.parseBody(C[f._314[x.keywordIndex]],S.bodyWidget.childWidgets,S.bodyWidget,!1),x.checkAndApplyRevision(x.keywordIndex,C,S),o.children.push(S),g=!0}else if(C.hasOwnProperty(f._194[x.keywordIndex])){x.documentHelper.owner.editor&&(x.documentHelper.owner.editor.chartType=!0);var W=new d.J;W.title=C[f._193[x.keywordIndex]],W.type=C[f._194[x.keywordIndex]],W.chartGapWidth=C[f._195[x.keywordIndex]],W.chartOverlap=C[f._196[x.keywordIndex]],x.parseChartTitleArea(C[f._188[x.keywordIndex]],W.chartTitleArea),x.parseChartArea(C[f._187[x.keywordIndex]],W.chartArea),x.parseChartArea(C[f._189[x.keywordIndex]],W.chartPlotArea),x.parseChartLegend(C[f._190[x.keywordIndex]],W.chartLegend),x.parseChartData(C,W),x.parseChartCategoryAxis(C[f._191[x.keywordIndex]],W.chartPrimaryCategoryAxis),x.parseChartCategoryAxis(C[f._192[x.keywordIndex]],W.chartPrimaryValueAxis),null!=C[f._197[x.keywordIndex]]&&x.parseChartDataTable(C[f._197[x.keywordIndex]],W.chartDataTable),W.line=o,o.children.push(W),W.height=h.a.convertPointToPixel(C[f._205[x.keywordIndex]]),W.width=h.a.convertPointToPixel(C[f._204[x.keywordIndex]]);var N=new p.ChartComponent;N.chartRender(C,x.keywordIndex),W.officeChart=N,N.chart.appendTo(W.targetElement),g=!0}else if(C.hasOwnProperty(f._224[x.keywordIndex])){var H=new d.r(h.a.parseBoolValue(C[f._227[x.keywordIndex]]));H.isMetaFile=h.a.parseBoolValue(C[f._228[x.keywordIndex]]),H.isCompressed=C[f._375[x.keywordIndex]],H.metaFileImageString=C[f._225[x.keywordIndex]],H.characterFormat=new l.c(H),H.line=o,x.checkAndApplyRevision(x.keywordIndex,C,H),o.children.push(H);var E=h.a.formatClippedString(C[f._224[x.keywordIndex]]).formatClippedString,O=x.validateImageUrl(E);O?x.isPaste&&!i.i(n.isNullOrUndefined)(x.documentHelper.owner.editor.pasteImageIndex)?H.imageString=x.documentHelper.owner.editor.pasteImageIndex.get(C[f._224[x.keywordIndex]]):H.imageString=C[f._224[x.keywordIndex]]:H.imageString="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAgVBMVEX///8AAADgAADY2Njl5eVcXFxjY2NZWVl/f3+wsLCmpqb4+PiioqKpqam7u7vV1dX2uLj2wsLhFRXzpKT3vb30sbHhCwv74+P40dH+9vbkIyO2trbBwcHLy8tsbGycnJz529v4zMzrbGzlLS3qZmblNzfrdXXoRkbvi4vvgYHlHh7CZsBOAAADpUlEQVR4nO3da1faQBSF4ekAUQlUEFs14AXxVv7/D6yaQiZx5mSEYXF2ut+PNKzyyK5diYDmR9czx34AB49C/CjE759w3jvvWr15Tdgz3atXE54f++EcIArxoxA/CvGjED8K8aMQPwrxoxA/CvGLEeZ9jPJdhfk4GyCUjb3ECGE/Q6m/q3DwfudjP0ERZYN9hKdn2hvd3+0jHJz5/kBVuTk96bbQUEjhYR9ckiikUH8UUqg/CinUH4UU6o9CCvVHIYX6o5BC/VFIof4opFB/FFKoPwop1B+FFOqPQgrjyxfjVC38Lxk9tnAxGqZqdKtSOE4GHA5/fuNJpDCtcNHbv4VqYYqPLjgfUViPQgrjozA2CptRSGF8/59w+Wrt+rr1btNna1cPzg0wwuXavncxabnX7PfHYYXzlYARvlobQZyUR9mXm+1NMEK7SSLONgcVV9vb8IQXv4J3KSeKKlxXxNCzONkeYp8AV3p9UT1+P3FWHVAsq5thhGZSEb1DrSZq7dS5HUdoLiuBZ6jORG3tCwAkNJfCUJ2Jrqe1P0ESCkMNTdSACYNDDU7UoAkDQw1P1MAJvUMVJmrwhJ6hShM1gMIvQxUnahCFjaHKEzWQQneoxR95ogZTWBuqPFEDKnSHKk/UoArdoYoTNbDC5lBDEzW4QjMpYiZqgIXG/S76JhwHK5zVVipcnkIVuv/RW/HyFKhwYhuFr6NiCmdNoDBUSGFjovJQEYXuRN9ahwoorJ8uSZenPsMTNk+X2q6jwgm/ntHL11HhhL4zenmoYEL/Gb04VCxh6KKTNFQoYfiikzBUJKF00Sk8VCChfF00OFQcYdt10dBQYYRT5xn0n9G7Q0X8GfCzNNEyZ6iPgD/HlydaVg11DfhajJaJlm2HugIUrlomWrYZKuJKHz6vHhbSM/hROdRnxNe1meuXYvW0DB6+aflYrB7dlzDiCM3N1dVN6GDhMCDhjlHYjEIK46MwNgqbUUhhfJ/vA07wO8N1vw94ONo/3e/lTpVOYfc/UyG//ZmqW52fi/FuTNW3/lZ+eguF+qOQQv1RSKH+KKRQfxRSqD8KKdQfhRTqj0IK9UchhfqjkEL9UUih/iikUH8UUqg/CmXh6Hsv3jlK+wnvD/vgkrSHMMuyu1P9ZdmuwnycDQYn+svG3n9KEUKT9zHyf6+IEWJHIX4U4kchfhTiRyF+FOJHIX4U4kchfnVhijeZa6sunCf4ZdPamteEHY5C/CjEr/vCv0ec0g+AtS1QAAAAAElFTkSuQmCC";var _=parseInt(C[f._224[x.keywordIndex]]);"NaN"===_.toString()&&x.documentHelper.addBase64StringInCollection(H),H.width=h.a.convertPointToPixel(C[f._204[x.keywordIndex]]),H.height=h.a.convertPointToPixel(C[f._205[x.keywordIndex]]);var B=x.documentHelper.getImageString(H);i.i(n.isNullOrUndefined)(B)||!h.a.startsWith(B,"http://")&&!h.a.startsWith(B,"https://")||(H.element.crossOrigin="Anonymous",x.viewer.documentHelper.getBase64(B,H.width,H.height).then(function(e){s.viewer.documentHelper.images.get(parseInt(H.imageString))[1]=e}),B+="?t="+(new Date).getTime()),H.element.src=B,H.top=C[f._229[x.keywordIndex]],H.left=C[f._232[x.keywordIndex]],H.bottom=C[f._230[x.keywordIndex]],H.right=C[f._231[x.keywordIndex]],H.cropHeightScale=C[f._233[x.keywordIndex]],H.cropWidthScale=C[f._234[x.keywordIndex]],H.name=C[f._35[x.keywordIndex]],H.alternateText=C[f._200[x.keywordIndex]],H.title=C[f._272[x.keywordIndex]],H.visible=h.a.parseBoolValue(C[f._201[x.keywordIndex]]),H.widthScale=C[f._206[x.keywordIndex]],H.heightScale=C[f._207[x.keywordIndex]],H.verticalPosition=h.a.convertPointToPixel(C[f._310[x.keywordIndex]]),H.verticalOrigin=x.getVerticalOrigin(C[f._309[x.keywordIndex]]),H.verticalAlignment=x.getShapeVerticalAlignment(C[f._114[x.keywordIndex]]),H.horizontalPosition=h.a.convertPointToPixel(C[f._313[x.keywordIndex]]),H.horizontalOrigin=x.getHorizontalOrigin(C[f._311[x.keywordIndex]]),H.horizontalAlignment=x.getShapeHorizontalAlignment(C[f._312[x.keywordIndex]]),H.allowOverlap=h.a.parseBoolValue(C[f._304[x.keywordIndex]]),i.i(n.isNullOrUndefined)(C[f._210[x.keywordIndex]])||(H.textWrappingStyle=x.getTextWrappingStyle(C[f._210[x.keywordIndex]])),i.i(n.isNullOrUndefined)(C[f._211[x.keywordIndex]])||(H.textWrappingType=x.getTextWrappingType(C[f._211[x.keywordIndex]])),H.isBelowText=h.a.parseBoolValue(C[f._202[x.keywordIndex]]),i.i(n.isNullOrUndefined)(C[f._308[x.keywordIndex]])||(H.distanceBottom=h.a.convertPointToPixel(C[f._308[x.keywordIndex]])),i.i(n.isNullOrUndefined)(C[f._307[x.keywordIndex]])||(H.distanceLeft=h.a.convertPointToPixel(C[f._307[x.keywordIndex]])),i.i(n.isNullOrUndefined)(C[f._306[x.keywordIndex]])||(H.distanceRight=h.a.convertPointToPixel(C[f._306[x.keywordIndex]])),i.i(n.isNullOrUndefined)(C[f._305[x.keywordIndex]])||(H.distanceTop=h.a.convertPointToPixel(C[f._305[x.keywordIndex]])),H.zOrderPosition=C[f._216[x.keywordIndex]],H.layoutInCell=h.a.parseBoolValue(C[f._217[x.keywordIndex]]),(!i.i(n.isNullOrUndefined)(C[f._229[x.keywordIndex]])&&0!==C[f._229[x.keywordIndex]]||!i.i(n.isNullOrUndefined)(C[f._230[x.keywordIndex]])&&0!==C[f._230[x.keywordIndex]]||!i.i(n.isNullOrUndefined)(C[f._232[x.keywordIndex]])&&0!==C[f._232[x.keywordIndex]]||!i.i(n.isNullOrUndefined)(C[f._231[x.keywordIndex]])&&0!==C[f._231[x.keywordIndex]])&&(H.isCrop=!0),"Inline"!==x.getTextWrappingStyle(H.textWrappingStyle)&&t.floatingElements.push(H),x.parseCharacterFormat(x.keywordIndex,C[f._4[x.keywordIndex]],H.characterFormat),g=!0}else if(C.hasOwnProperty(f._235[x.keywordIndex])||C.hasOwnProperty(f._237[x.keywordIndex])&&0===C[f._237[x.keywordIndex]]){w=!0;var L=new d.b(0);if(x.parseCharacterFormat(x.keywordIndex,C[f._4[x.keywordIndex]],L.characterFormat,r),x.applyCharacterStyle(C,L),L.fieldCodeType=C.fieldCodeType,L.hasFieldEnd=C[f._235[x.keywordIndex]],C.hasOwnProperty(f._236[x.keywordIndex])){var R=void 0;R=x.parseFormFieldData(x.keywordIndex,C,R),L.formFieldData=R,x.documentHelper.formFields.push(L)}x.documentHelper.fieldStacks.push(L),x.checkAndApplyRevision(x.keywordIndex,C,L),L.line=o,x.documentHelper.fields.push(L),o.children.push(L)}else if(C.hasOwnProperty([f._237[x.keywordIndex]])){var A=void 0;if(2===C[f._237[x.keywordIndex]]||1===C[f._237[x.keywordIndex]]&&w){if(A=new d.b(2),x.parseCharacterFormat(x.keywordIndex,C[f._4[x.keywordIndex]],A.characterFormat,r),x.checkAndApplyRevision(x.keywordIndex,C,A),x.fieldSeparator=A,x.documentHelper.fieldStacks.length>0){A.fieldBegin=x.documentHelper.fieldStacks[x.documentHelper.fieldStacks.length-1],A.fieldBegin.fieldSeparator=A;var D=o.children.length;if(D>=2){var U=x.containsFieldBegin(o);if(!i.i(n.isNullOrUndefined)(U)&&U instanceof d.d&&(U.text.match("PAGE")||U.text.match("page"))){var M=U.text.replace(/^\s+/g,"");M.startsWith("HYPERLINK")||(x.documentHelper.isPageField=!0)}}}1===C[f._237[x.keywordIndex]]&&w&&(a--,v=a),w=!1}else 1===C[f._237[x.keywordIndex]]&&(A=new d.b(1),x.parseCharacterFormat(x.keywordIndex,C[f._4[x.keywordIndex]],A.characterFormat,r),x.applyCharacterStyle(C,A),x.checkAndApplyRevision(x.keywordIndex,C,A),x.documentHelper.fieldStacks.length>0&&(A.fieldBegin=x.documentHelper.fieldStacks[x.documentHelper.fieldStacks.length-1],A.fieldBegin.fieldEnd=A),!i.i(n.isNullOrUndefined)(A.fieldBegin)&&A.fieldBegin.fieldSeparator&&(A.fieldSeparator=A.fieldBegin.fieldSeparator,A.fieldBegin.fieldSeparator.fieldEnd=A,g=!0),x.documentHelper.fieldStacks.splice(x.documentHelper.fieldStacks.length-1,1),x.fieldSeparator=void 0,x.documentHelper.isPageField=!1,x.documentHelper.fieldCollection.push(A.fieldBegin),b=void 0);A.line=o,o.children.push(A)}else if(C.hasOwnProperty([f._337[x.keywordIndex]])){var V=void 0;if(V=new d.e(C[f._337[x.keywordIndex]]),V.name=C[f._35[x.keywordIndex]],V.properties=C[f._338[x.keywordIndex]],i.i(n.isNullOrUndefined)(C[f._338[x.keywordIndex]])||(i.i(n.isNullOrUndefined)(C[f._338[x.keywordIndex]][f._378[x.keywordIndex]])||(V.properties.isAfterParagraphMark=h.a.parseBoolValue(C[f._338[x.keywordIndex]][f._378[x.keywordIndex]])),i.i(n.isNullOrUndefined)(C[f._338[x.keywordIndex]][f._383[x.keywordIndex]])||(V.properties.isAfterTableMark=h.a.parseBoolValue(C[f._338[x.keywordIndex]][f._383[x.keywordIndex]])),i.i(n.isNullOrUndefined)(C[f._338[x.keywordIndex]][f._380[x.keywordIndex]])||(V.properties.isAfterRowMark=h.a.parseBoolValue(C[f._338[x.keywordIndex]][f._380[x.keywordIndex]])),i.i(n.isNullOrUndefined)(C[f._338[x.keywordIndex]][f._379[x.keywordIndex]])||(V.properties.isAfterCellMark=h.a.parseBoolValue(C[f._338[x.keywordIndex]][f._379[x.keywordIndex]])),i.i(n.isNullOrUndefined)(C[f._338[x.keywordIndex]][f._345[x.keywordIndex]])||(V.properties.columnFirst=C[f._338[x.keywordIndex]][f._345[x.keywordIndex]]),i.i(n.isNullOrUndefined)(C[f._338[x.keywordIndex]][f._346[x.keywordIndex]])||(V.properties.columnLast=C[f._338[x.keywordIndex]][f._346[x.keywordIndex]])),x.checkAndApplyRevision(x.keywordIndex,C,V),o.children.push(V),V.line=o,!x.isParseHeader||x.isPaste)if(0===C[f._337[x.keywordIndex]]){var z=x.isPaste&&!x.documentHelper.bookmarks.containsKey(V.name);!x.isPaste||z?x.documentHelper.bookmarks.add(V.name,V):z||o.children.splice(o.children.indexOf(V),1)}else if(1===C[f._337[x.keywordIndex]]&&x.documentHelper.bookmarks.containsKey(V.name)){var j=x.documentHelper.bookmarks.get(V.name),q=x.isPaste&&i.i(n.isNullOrUndefined)(j.reference);!x.isPaste||q?(j.reference=V,V.reference=j,x.documentHelper.endBookmarksUpdated.push(V.name)):q||o.children.splice(o.children.indexOf(V),1)}0!==V.name.indexOf("_")&&(g=!0)}else if(C.hasOwnProperty([f._344[x.keywordIndex]])){if(C.hasOwnProperty(f._349[x.keywordIndex])){var G=new d.F;if(x.editableRanges.containsKey(C[f._344[x.keywordIndex]])){var K=x.editableRanges.get(C[f._344[x.keywordIndex]]);G.editRangeStart=K,K.editRangeEnd=G,i.i(n.isNullOrUndefined)(C[f._344[x.keywordIndex]])||(G.editRangeId=C[f._344[x.keywordIndex]]),x.editableRanges.remove(C[f._344[x.keywordIndex]])}o.children.push(G),G.line=o}else{var Z=x.parseEditableRangeStart(C);o.children.push(Z),Z.line=o,x.editableRanges.containsKey(C[f._344[x.keywordIndex]])||x.editableRanges.add(C[f._344[x.keywordIndex]],Z)}g=!0}else if(C.hasOwnProperty([f._252[x.keywordIndex]])){var X=C[f._252[x.keywordIndex]],J=void 0;x.commentStarts.containsKey(X)&&x.commentStarts.get(X);if(x.commentEnds.containsKey(X)&&x.commentEnds.get(X),C.hasOwnProperty([f._253[x.keywordIndex]])){if(0===C[f._253[x.keywordIndex]]){var Y=new d.B(0);Y.commentId=X,x.commentStarts.containsKey(X)||x.commentStarts.add(X,Y),Y.line=o,o.children.push(Y),J=x.commentsCollection.get(X),i.i(n.isNullOrUndefined)(J)||(J.commentStart=Y,Y.comment=J)}else{var Q=new d.B(1);Q.commentId=X,x.commentEnds.containsKey(X)||x.commentEnds.add(X,Q),Q.line=o,o.children.push(Q),J=x.commentsCollection.get(X),i.i(n.isNullOrUndefined)(J)||(J.commentEnd=Q,Q.comment=J)}!i.i(n.isNullOrUndefined)(J)&&J.isReply&&(i.i(n.isNullOrUndefined)(J.ownerComment.commentStart)&&(J.ownerComment.commentStart=J.commentStart),i.i(n.isNullOrUndefined)(J.ownerComment.commentEnd)&&(J.ownerComment.commentEnd=J.commentEnd))}}else if(C.hasOwnProperty([f._199[x.keywordIndex]])){var $=new d.s;if($.shapeId=C[f._199[x.keywordIndex]],$.name=C[f._35[x.keywordIndex]],$.alternateText=C[f._200[x.keywordIndex]],$.title=C[f._272[x.keywordIndex]],$.visible=h.a.parseBoolValue(C[f._201[x.keywordIndex]]),$.width=h.a.convertPointToPixel(C[f._204[x.keywordIndex]]),$.height=h.a.convertPointToPixel(C[f._205[x.keywordIndex]]),0===$.height&&($.isZeroHeight=!0),$.widthScale=C[f._206[x.keywordIndex]],$.heightScale=C[f._207[x.keywordIndex]],$.verticalPosition=h.a.convertPointToPixel(C[f._310[x.keywordIndex]]),$.verticalOrigin=x.getVerticalOrigin(C[f._309[x.keywordIndex]]),$.verticalAlignment=x.getShapeVerticalAlignment(C[f._114[x.keywordIndex]]),$.verticalRelativePercent=C[f._212[x.keywordIndex]],$.horizontalPosition=h.a.convertPointToPixel(C[f._313[x.keywordIndex]]),$.horizontalOrigin=x.getHorizontalOrigin(C[f._311[x.keywordIndex]]),$.horizontalAlignment=x.getShapeHorizontalAlignment(C[f._312[x.keywordIndex]]),$.horizontalRelativePercent=C[f._213[x.keywordIndex]],$.heightRelativePercent=C[f._214[x.keywordIndex]],$.widthRelativePercent=C[f._215[x.keywordIndex]],$.zOrderPosition=C[f._216[x.keywordIndex]],$.allowOverlap=h.a.parseBoolValue(C[f._304[x.keywordIndex]]),$.textWrappingStyle=x.getTextWrappingStyle(C[f._210[x.keywordIndex]]),$.textWrappingType=x.getTextWrappingType(C[f._211[x.keywordIndex]]),$.isBelowText=h.a.parseBoolValue(C[f._202[x.keywordIndex]]),$.isHorizontalRule=h.a.parseBoolValue(C[f._203[x.keywordIndex]]),i.i(n.isNullOrUndefined)(C[f._308[x.keywordIndex]])||($.distanceBottom=h.a.convertPointToPixel(C[f._308[x.keywordIndex]])),i.i(n.isNullOrUndefined)(C[f._307[x.keywordIndex]])||($.distanceLeft=h.a.convertPointToPixel(C[f._307[x.keywordIndex]])),i.i(n.isNullOrUndefined)(C[f._306[x.keywordIndex]])||($.distanceRight=h.a.convertPointToPixel(C[f._306[x.keywordIndex]])),i.i(n.isNullOrUndefined)(C[f._305[x.keywordIndex]])||($.distanceTop=h.a.convertPointToPixel(C[f._305[x.keywordIndex]])),$.layoutInCell=h.a.parseBoolValue(C[f._217[x.keywordIndex]]),$.lockAnchor=h.a.parseBoolValue(C[f._218[x.keywordIndex]]),$.autoShapeType=x.getAutoShapeType(C[f._219[x.keywordIndex]]),C.hasOwnProperty(f._208[x.keywordIndex])){var ee=new d.T;ee.line=h.a.parseBoolValue(C[f._208[x.keywordIndex]][f._149[x.keywordIndex]]),ee.lineFormatType=x.getLineFormatType(C[f._208[x.keywordIndex]][f._370[x.keywordIndex]]),ee.color=C[f._208[x.keywordIndex]][f._221[x.keywordIndex]],ee.weight=C[f._208[x.keywordIndex]][f._372[x.keywordIndex]],ee.dashStyle=x.getLineDashStyle(C[f._208[x.keywordIndex]][f._142[x.keywordIndex]]),$.lineFormat=ee}if(C.hasOwnProperty(f._209[x.keywordIndex])){var te=new d.U;te.color=C[f._209[x.keywordIndex]][f._221[x.keywordIndex]],te.fill=h.a.parseBoolValue(C[f._209[x.keywordIndex]][f._222[x.keywordIndex]]),$.fillFormat=te}if(C.hasOwnProperty(f._220[x.keywordIndex])){var ie=new d.i;ie.textVerticalAlignment=x.getTextVerticalAlignment(C[f._220[x.keywordIndex]][f._223[x.keywordIndex]]),ie.marginLeft=h.a.convertPointToPixel(C[f._220[x.keywordIndex]][f._93[x.keywordIndex]]),ie.marginRight=h.a.convertPointToPixel(C[f._220[x.keywordIndex]][f._94[x.keywordIndex]]),ie.marginTop=h.a.convertPointToPixel(C[f._220[x.keywordIndex]][f._95[x.keywordIndex]]),ie.marginBottom=h.a.convertPointToPixel(C[f._220[x.keywordIndex]][f._96[x.keywordIndex]]),x.parseBody(C[f._220[x.keywordIndex]][f._314[x.keywordIndex]],ie.childWidgets,ie),$.textFrame=ie,ie.containerShape=$}$.line=o,x.checkAndApplyRevision(x.keywordIndex,C,$),o.children.push($),t.floatingElements.push($)}else if(C.hasOwnProperty(f._268[x.keywordIndex])){var ne=new d.H("Inline"),re=new d.H("Inline");x.parseContentControlProperties(C[f._268[x.keywordIndex]],ne.contentControlProperties),re.contentControlProperties=ne.contentControlProperties,ne.line=o,re.line=o,ne.type=0,re.type=1,o.children.push(ne),x.parseParagraph(C[f._267[x.keywordIndex]],t,r,o);for(var oe=o.children[o.children.length-1];!(oe instanceof d.H);)oe.contentControlProperties=ne.contentControlProperties,oe=oe.previousElement;o.children.push(re),g=!0}u=a}(C),C=u;return this.isCutPerformed=!1,a||t.childWidgets.push(o),g},e.prototype.parseFormFieldData=function(e,t,i){return i instanceof d.l||i instanceof d.m||i instanceof d.n?(i instanceof d.m?(i.sizeType=t.sizeType,i.size=t.size,i.defaultValue=t.defaultValue,i.checked=t.checked):i instanceof d.l?(i.type=t.type,i.maxLength=t.maxLength,i.defaultValue=t.defaultValue,i.format=t.format):(i.dropdownItems=t.dropdownItems,i.selectedIndex=t.selectedIndex),i.name=t.name,i.enabled=t.enabled,i.helpText=t.helpText,i.statusText=t.statusText):(t[f._236[e]].hasOwnProperty(f._241[e])?(i=new d.l,i.type=this.getTextFormFieldType(t[f._236[e]][f._241[e]][f._359[e]]),i.maxLength=t[f._236[e]][f._241[e]][f._244[e]],i.defaultValue=t[f._236[e]][f._241[e]][f._245[e]],i.format=this.getTextFormFieldFormat(t[f._236[e]][f._241[e]][f._246[e]])):t[f._236[e]].hasOwnProperty(f._242[e])?(i=new d.m,i.sizeType=this.getCheckBoxSizeType(t[f._236[e]][f._242[e]][f._247[e]]),i.size=t[f._236[e]][f._242[e]][f._248[e]],i.defaultValue=h.a.parseBoolValue(t[f._236[e]][f._242[e]][f._245[e]]),i.checked=h.a.parseBoolValue(t[f._236[e]][f._242[e]][f._249[e]])):(i=new d.n,i.dropdownItems=t[f._236[e]][f._243[e]][f._250[e]],i.selectedIndex=t[f._236[e]][f._243[e]][f._251[e]]),i.name=t[f._236[e]][f._35[e]],i.enabled=h.a.parseBoolValue(t[f._236[e]][f._238[e]]),i.helpText=t[f._236[e]][f._239[e]],i.statusText=t[f._236[e]][f._240[e]]),i},e.prototype.applyCharacterStyle=function(e,t){if(!i.i(n.isNullOrUndefined)(e[f._4[this.keywordIndex]])&&!i.i(n.isNullOrUndefined)(e[f._4[this.keywordIndex]][f._51[this.keywordIndex]])){var r=this.documentHelper.styles.findByName(e[f._4[this.keywordIndex]][f._51[this.keywordIndex]],"Character");t.characterFormat.applyStyle(r)}},e.prototype.parseEditableRangeStart=function(e){var t=new d.G;return i.i(n.isNullOrUndefined)(e[f._345[this.keywordIndex]])||(t.columnFirst=e[f._345[this.keywordIndex]]),i.i(n.isNullOrUndefined)(e[f._346[this.keywordIndex]])||(t.columnLast=e[f._346[this.keywordIndex]]),i.i(n.isNullOrUndefined)(e[f._344[this.keywordIndex]])||(t.editRangeId=e[f._344[this.keywordIndex]]),i.i(n.isNullOrUndefined)(e[f._347[this.keywordIndex]])||(t.user=e[f._347[this.keywordIndex]],-1===this.documentHelper.userCollection.indexOf(t.user)&&this.documentHelper.userCollection.push(t.user),this.addEditRangeCollection(t.user,t)),i.i(n.isNullOrUndefined)(e[f._348[this.keywordIndex]])||""===e[f._348[this.keywordIndex]]||(t.group=e[f._348[this.keywordIndex]],t.group="everyone"===t.group?"Everyone":t.group,-1===this.documentHelper.userCollection.indexOf(t.group)&&this.documentHelper.userCollection.push(t.group),this.addEditRangeCollection(t.group,t)),t},e.prototype.addEditRangeCollection=function(e,t){if(this.documentHelper.editRanges.containsKey(e)){this.documentHelper.editRanges.get(e).push(t)}else{var i=[];i.push(t),this.documentHelper.editRanges.add(e,i)}},e.prototype.parseChartTitleArea=function(e,t){t.chartfontName=e[f._374[this.keywordIndex]],t.chartFontSize=e[f._48[this.keywordIndex]],this.parseChartDataFormat(e[f._145[this.keywordIndex]],t.dataFormat),this.parseChartLayout(e[f._144[this.keywordIndex]],t.layout)},e.prototype.parseChartDataFormat=function(e,t){t.fill.color=e[f._222[this.keywordIndex]][f._150[this.keywordIndex]],t.fill.rgb=e[f._222[this.keywordIndex]][f._368[this.keywordIndex]],t.line.color=e[f._149[this.keywordIndex]][f._221[this.keywordIndex]],t.line.rgb=e[f._149[this.keywordIndex]][f._368[this.keywordIndex]]},e.prototype.parseChartLayout=function(e,t){t.chartLayoutLeft=e[f._152[this.keywordIndex]],t.chartLayoutTop=e[f._153[this.keywordIndex]]},e.prototype.parseChartLegend=function(e,t){t.chartLegendPostion=e[f._340[this.keywordIndex]],this.parseChartTitleArea(e[f._188[this.keywordIndex]],t.chartTitleArea)},e.prototype.parseChartCategoryAxis=function(e,t){t.categoryAxisType=e[f._184[this.keywordIndex]],t.categoryNumberFormat=e[f._328[this.keywordIndex]],t.interval=e[f._360[this.keywordIndex]],t.axisFontSize=e[f._48[this.keywordIndex]],t.axisFontName=e[f._374[this.keywordIndex]],t.max=e[f._361[this.keywordIndex]],t.min=e[f._362[this.keywordIndex]],t.majorGridLines=h.a.parseBoolValue(e[f._363[this.keywordIndex]]),t.minorGridLines=h.a.parseBoolValue(e[f._364[this.keywordIndex]]),t.majorTick=e[f._365[this.keywordIndex]],t.minorTick=e[f._366[this.keywordIndex]],t.tickPosition=e[f._367[this.keywordIndex]],t.categoryAxisTitle=e[f._193[this.keywordIndex]],null!=e[f._193[this.keywordIndex]]&&this.parseChartTitleArea(e[f._188[this.keywordIndex]],t.chartTitleArea)},e.prototype.parseChartDataTable=function(e,t){t.showSeriesKeys=h.a.parseBoolValue(e[f._180[this.keywordIndex]]),t.hasHorzBorder=h.a.parseBoolValue(e[f._181[this.keywordIndex]]),t.hasVertBorder=h.a.parseBoolValue(e[f._182[this.keywordIndex]]),t.hasBorders=h.a.parseBoolValue(e[f._183[this.keywordIndex]])},e.prototype.parseChartArea=function(e,t){t.chartForeColor=e[f._150[this.keywordIndex]]},e.prototype.parseChartData=function(e,t){for(var i=0;i<e[f._185[this.keywordIndex]].length;i++){var n=new d.V,r=e[f._185[this.keywordIndex]][i];r.hasOwnProperty(f._148[this.keywordIndex])&&(n.xName=r[f._148[this.keywordIndex]]);for(var o=0;o<r[f._147[this.keywordIndex]].length;o++){var s=new d.W,a=r[f._147[this.keywordIndex]][o];s.yAxisValue=a[f._146[this.keywordIndex]],"Bubble"===e[f._194[this.keywordIndex]]&&(s.bubbleSize=a[f._248[this.keywordIndex]]),n.chartData.push(s)}t.chartCategory.push(n)}this.parseChartSeries(e,t)},e.prototype.parseChartSeries=function(e,t){for(var i=e[f._194[this.keywordIndex]],n="Pie"===i||"Doughnut"===i,r=0;r<e[f._186[this.keywordIndex]].length;r++){var o=new d.X,s=e[f._186[this.keywordIndex]][r];if(s.hasOwnProperty(f._165[this.keywordIndex])){if(o.seriesName=s[f._165[this.keywordIndex]],n&&(s.hasOwnProperty(f._171[this.keywordIndex])&&(o.firstSliceAngle=s[f._171[this.keywordIndex]]),"Doughnut"===i&&(o.doughnutHoleSize=s[f._172[this.keywordIndex]])),s.hasOwnProperty(f._166[this.keywordIndex])&&this.parseChartDataLabels(s[f._166[this.keywordIndex]],o),s.hasOwnProperty(f._168[this.keywordIndex])){var a=new d.Y,l=s[f._168[this.keywordIndex]];a.markerStyle=l[f._157[this.keywordIndex]],a.markerColor=l[f._158[this.keywordIndex]],a.numberValue=l[f._159[this.keywordIndex]],o.seriesFormat=a}if(s.hasOwnProperty(f._167[this.keywordIndex])){var h=o.errorBar;h.errorType=s[f._167[this.keywordIndex]][f._359[this.keywordIndex]],h.errorDirection=s[f._167[this.keywordIndex]][f._154[this.keywordIndex]],h.errorEndStyle=s[f._167[this.keywordIndex]][f._155[this.keywordIndex]],h.numberValue=s[f._167[this.keywordIndex]][f._156[this.keywordIndex]]}s.hasOwnProperty(f._169[this.keywordIndex])&&this.parseChartTrendLines(s[f._169[this.keywordIndex]],o),this.parseChartSeriesDataPoints(s[f._170[this.keywordIndex]],o)}t.chartSeries.push(o)}},e.prototype.parseChartDataLabels=function(e,t){var i=new d.Z;i.labelPosition=e[f._340[this.keywordIndex]],i.fontName=e[f._374[this.keywordIndex]],i.fontColor=e[f._49[this.keywordIndex]],i.fontSize=e[f._48[this.keywordIndex]],i.isLegendKey=h.a.parseBoolValue(e[f._173[this.keywordIndex]]),i.isBubbleSize=h.a.parseBoolValue(e[f._174[this.keywordIndex]]),i.isCategoryName=h.a.parseBoolValue(e[f._175[this.keywordIndex]]),i.isSeriesName=h.a.parseBoolValue(e[f._176[this.keywordIndex]]),i.isValue=h.a.parseBoolValue(e[f._177[this.keywordIndex]]),i.isPercentage=h.a.parseBoolValue(e[f._178[this.keywordIndex]]),i.isLeaderLines=h.a.parseBoolValue(e[f._179[this.keywordIndex]]),t.dataLabels=i},e.prototype.parseChartSeriesDataPoints=function(e,t){for(var i=0;i<e.length;i++){var n=new d._0;this.parseChartDataFormat(e[i],n),t.chartDataFormat.push(n)}},e.prototype.parseChartTrendLines=function(e,t){for(var i=0;i<e.length;i++){var n=e[i],r=new d._1;r.trendLineName=n[f._35[this.keywordIndex]],r.trendLineType=n[f._359[this.keywordIndex]],r.forwardValue=n[f._160[this.keywordIndex]],r.backwardValue=n[f._161[this.keywordIndex]],r.interceptValue=n[f._162[this.keywordIndex]],r.isDisplayEquation=h.a.parseBoolValue(n[f._164[this.keywordIndex]]),r.isDisplayRSquared=h.a.parseBoolValue(n[f._163[this.keywordIndex]]),t.trendLines.push(r)}},e.prototype.parseTableFormat=function(e,t,r){this.parseBorders(r,e[f._85[r]],t.borders),i.i(n.isNullOrUndefined)(e[f._126[r]])||(t.allowAutoFit=h.a.parseBoolValue(e[f._126[r]])),i.i(n.isNullOrUndefined)(e[f._127[r]])||(t.cellSpacing=e[f._127[r]]),i.i(n.isNullOrUndefined)(e[f._93[r]])||(t.leftMargin=e[f._93[r]]),i.i(n.isNullOrUndefined)(e[f._95[r]])||(t.topMargin=e[f._95[r]]),i.i(n.isNullOrUndefined)(e[f._94[r]])||(t.rightMargin=e[f._94[r]]),i.i(n.isNullOrUndefined)(e[f._96[r]])||(t.bottomMargin=e[f._96[r]]),i.i(n.isNullOrUndefined)(e[f._69[r]])||(t.leftIndent=e[f._69[r]]),this.parseShading(e[f._128[r]],t.shading,r),i.i(n.isNullOrUndefined)(e[f._129[r]])||(t.tableAlignment=this.getTableAlignment(e[f._129[r]])),i.i(n.isNullOrUndefined)(e[f._130[r]])||(t.preferredWidth=e[f._130[r]]),i.i(n.isNullOrUndefined)(e[f._131[r]])||(t.preferredWidthType=this.getWidthType(e[f._131[r]])),i.i(n.isNullOrUndefined)(e[f._52[r]])||(t.bidi=h.a.parseBoolValue(e[f._52[r]])),i.i(n.isNullOrUndefined)(e[f._132[r]])||(t.horizontalPositionAbs=this.getHorizontalPositionAbs(e[f._132[r]])),i.i(n.isNullOrUndefined)(e[f._313[r]])||(t.horizontalPosition=e[f._313[r]]),i.i(n.isNullOrUndefined)(e[f._51[r]])||(t.styleName=e[f._51[r]])},e.prototype.parseCellFormat=function(e,t,r){i.i(n.isNullOrUndefined)(e)||(this.parseBorders(r,e[f._85[r]],t.borders),e.isSamePaddingAsTable||this.parseCellMargin(e,t,r),i.i(n.isNullOrUndefined)(e[f._111[r]])||(t.cellWidth=e[f._111[r]]),i.i(n.isNullOrUndefined)(e[f._112[r]])||(t.columnSpan=e[f._112[r]]),i.i(n.isNullOrUndefined)(e[f._113[r]])||(t.rowSpan=e[f._113[r]]),this.parseShading(e[f._128[r]],t.shading,r),i.i(n.isNullOrUndefined)(e[f._114[r]])||(t.verticalAlignment=this.getCellVerticalAlignment(e[f._114[r]])),i.i(n.isNullOrUndefined)(e[f._131[r]])||(t.preferredWidthType=this.getWidthType(e[f._131[r]])),i.i(n.isNullOrUndefined)(e[f._130[r]])||(t.preferredWidth=e[f._130[r]]))},e.prototype.parseCellMargin=function(e,t,r){i.i(n.isNullOrUndefined)(e[f._93[r]])||(t.leftMargin=e[f._93[r]]),i.i(n.isNullOrUndefined)(e[f._94[r]])||(t.rightMargin=e[f._94[r]]),i.i(n.isNullOrUndefined)(e[f._95[r]])||(t.topMargin=e[f._95[r]]),i.i(n.isNullOrUndefined)(e[f._96[r]])||(t.bottomMargin=e[f._96[r]])},e.prototype.parseRowFormat=function(e,t,r){i.i(n.isNullOrUndefined)(e)||(i.i(n.isNullOrUndefined)(e[f._115[r]])||(t.allowBreakAcrossPages=h.a.parseBoolValue(e[f._115[this.keywordIndex]])),i.i(n.isNullOrUndefined)(e[f._116[r]])||(t.isHeader=h.a.parseBoolValue(e[f._116[r]])),i.i(n.isNullOrUndefined)(e[f._117[r]])||(t.heightType=this.getHeightType(e[f._117[r]])),i.i(n.isNullOrUndefined)(e[f._205[r]])||(t.height=e[f._205[r]]),i.i(n.isNullOrUndefined)(e[f._93[r]])||(t.leftMargin=e[f._93[r]]),i.i(n.isNullOrUndefined)(e[f._95[r]])||(t.topMargin=e[f._95[r]]),i.i(n.isNullOrUndefined)(e[f._94[r]])||(t.rightMargin=e[f._94[r]]),i.i(n.isNullOrUndefined)(e[f._96[r]])||(t.bottomMargin=e[f._96[r]]),i.i(n.isNullOrUndefined)(e[f._69[r]])||(t.leftIndent=e[f._69[r]]),!i.i(n.isNullOrUndefined)(e[f._64[r]])&&e[f._64[r]].length>0&&this.checkAndApplyRevision(r,e,t),this.parseRowGridValues(e,t,r),this.parseBorders(r,e[f._85[r]],t.borders))},e.prototype.parseBorders=function(e,t,r){i.i(n.isNullOrUndefined)(t)||(r.isParsing=!0,this.parseBorder(e,t[f._232[e]],r.left),this.parseBorder(e,t[f._231[e]],r.right),this.parseBorder(e,t[f._229[e]],r.top),this.parseBorder(e,t[f._230[e]],r.bottom),this.parseBorder(e,t[f._138[e]],r.vertical),this.parseBorder(e,t[f._139[e]],r.horizontal),this.parseBorder(e,t[f._141[e]],r.diagonalDown),this.parseBorder(e,t[f._140[e]],r.diagonalUp),r.isParsing=!1)},e.prototype.parseBorder=function(e,t,r){i.i(n.isNullOrUndefined)(t)||(i.i(n.isNullOrUndefined)(t[f._221[e]])||(r.color=this.getColor(t[f._221[e]])),i.i(n.isNullOrUndefined)(t[f._142[e]])||(r.lineStyle=this.getLineStyle(t[f._142[e]])),i.i(n.isNullOrUndefined)(t[f._143[e]])||(r.lineWidth=t[f._143[e]]),i.i(n.isNullOrUndefined)(t[f._137[e]])||(r.hasNoneStyle=h.a.parseBoolValue(t[f._137[e]])),i.i(n.isNullOrUndefined)(t[f._350[e]])||(r.space=t[f._350[e]]),i.i(n.isNullOrUndefined)(t[f._136[e]])||(r.shadow=h.a.parseBoolValue(t[f._136[e]])))},e.prototype.parseShading=function(e,t,r){i.i(n.isNullOrUndefined)(e)||(i.i(n.isNullOrUndefined)(e[f._134[r]])||(t.backgroundColor=this.getColor(e[f._134[r]])),i.i(n.isNullOrUndefined)(e[f._135[r]])||(t.foregroundColor=this.getColor(e[f._135[r]])),i.i(n.isNullOrUndefined)(e[f._133[r]])&&i.i(n.isNullOrUndefined)(e.textureStyle)||(t.textureStyle=i.i(n.isNullOrUndefined)(e[f._133[r]])?this.getTextureStyle(e.textureStyle):this.getTextureStyle(e[f._133[r]])))},e.prototype.parseCharacterFormat=function(e,t,r,o){if(!i.i(n.isNullOrUndefined)(t)){if(o&&t.hasOwnProperty(f._373[e]))return void this.parseCharacterFormat(e,t.inlineFormat,r);if(i.i(n.isNullOrUndefined)(t[f._45[e]])||(r.baselineAlignment=this.getBaseAlignment(t[f._45[e]])),i.i(n.isNullOrUndefined)(t[f._44[e]])||(r.underline=this.getUnderline(t[f._44[e]])),i.i(n.isNullOrUndefined)(t[f._46[e]])||(r.strikethrough=this.getStrikethrough(t[f._46[e]])),!i.i(n.isNullOrUndefined)(t[f._48[e]])){t[f._48[e]]=parseFloat(t[f._48[e]]);var s=10*t[f._48[e]];s%10!=0&&(s=10*t[f._48[e]].toFixed(1),t[f._48[e]]=s%5==0?t[f._48[e]].toFixed(1):Math.round(t[f._48[e]]));var a=parseFloat(t[f._48[e]]);r.fontSize=a<0?0:a}i.i(n.isNullOrUndefined)(t[f._50[e]])||(-1!==t[f._50[e]].indexOf('"')&&(t[f._50[e]]=t[f._50[e]].replace('"',"")),r.fontFamily=t[f._50[e]],i.i(n.isNullOrUndefined)(t[f._62[e]])&&(r.fontFamilyFarEast=t[f._50[e]]),i.i(n.isNullOrUndefined)(t[f._61[e]])&&(r.fontFamilyAscii=t[f._50[e]]),i.i(n.isNullOrUndefined)(t[f._63[e]])&&(r.fontFamilyNonFarEast=t[f._50[e]])),i.i(n.isNullOrUndefined)(t[f._42[e]])||(r.bold=h.a.parseBoolValue(t[f._42[e]])),i.i(n.isNullOrUndefined)(t[f._43[e]])||(r.italic=h.a.parseBoolValue(t[f._43[e]])),i.i(n.isNullOrUndefined)(t[f._47[e]])||(r.highlightColor=this.getHighlightColor(t[f._47[e]])),i.i(n.isNullOrUndefined)(t[f._49[e]])||(r.fontColor=this.getColor(t[f._49[e]])),i.i(n.isNullOrUndefined)(t[f._52[e]])||(r.bidi=h.a.parseBoolValue(t[f._52[e]])),i.i(n.isNullOrUndefined)(t[f._53[e]])||(r.bdo=this.getBiDirectionalOverride(t[f._53[e]])),i.i(n.isNullOrUndefined)(t[f._55[e]])||(r.fontSizeBidi=t[f._55[e]]<0?0:t[f._55[e]]),i.i(n.isNullOrUndefined)(t[f._56[e]])||(-1!==t[f._56[e]].indexOf('"')&&(t[f._56[e]]=t[f._56[e]].replace('"',"")),r.fontFamilyBidi=t[f._56[e]]),i.i(n.isNullOrUndefined)(t[f._57[e]])||(r.boldBidi=h.a.parseBoolValue(t[f._57[e]])),i.i(n.isNullOrUndefined)(t[f._58[e]])||(r.italicBidi=h.a.parseBoolValue(t[f._58[e]])),!i.i(n.isNullOrUndefined)(t[f._64[e]])&&t[f._64[e]].length>0&&this.checkAndApplyRevision(e,t,r),i.i(n.isNullOrUndefined)(t[f._59[e]])||(r.allCaps=h.a.parseBoolValue(t[f._59[e]])),i.i(n.isNullOrUndefined)(t[f._41[e]])||(r.localeIdBidi=t[f._41[e]]),i.i(n.isNullOrUndefined)(t[f._39[e]])||(r.localeIdAscii=t[f._39[e]]),i.i(n.isNullOrUndefined)(t[f._40[e]])||(r.localeIdFarEast=t[f._40[e]]),i.i(n.isNullOrUndefined)(t[f._60[e]])||(r.complexScript=h.a.parseBoolValue(t[f._60[e]])),i.i(n.isNullOrUndefined)(t[f._62[e]])||(-1!==t[f._62[e]].indexOf('"')&&(t[f._62[e]]=t[f._62[e]].replace('"',"")),r.fontFamilyFarEast=t[f._62[e]]),i.i(n.isNullOrUndefined)(t[f._61[e]])||(-1!==t[f._61[e]].indexOf('"')&&(t[f._61[e]]=t[f._61[e]].replace('"',"")),r.fontFamilyAscii=t[f._61[e]]),i.i(n.isNullOrUndefined)(t[f._63[e]])||(-1!==t[f._63[e]].indexOf('"')&&(t[f._63[e]]=t[f._63[e]].replace('"',"")),r.fontFamilyNonFarEast=t[f._63[e]]),i.i(n.isNullOrUndefined)(t[f._66[e]])||(r.characterSpacing=t[f._66[e]]),i.i(n.isNullOrUndefined)(t[f._67[e]])||(r.scaling=t[f._67[e]])}},e.prototype.getColor=function(e){return e||"#ffffff"},e.prototype.parseThemes=function(e,t){this.parseFontScheme(e[f._351[this.keywordIndex]],t)},e.prototype.parseFontScheme=function(e,t){i.i(n.isNullOrUndefined)(e[f._352[this.keywordIndex]])||(t.fontScheme.fontSchemeName=e[f._352[this.keywordIndex]]),i.i(n.isNullOrUndefined)(e[f._353[this.keywordIndex]])||this.parseMajorMinorFontScheme(e[f._353[this.keywordIndex]],t.fontScheme.majorFontScheme),i.i(n.isNullOrUndefined)(e[f._354[this.keywordIndex]])||this.parseMajorMinorFontScheme(e[f._354[this.keywordIndex]],t.fontScheme.minorFontScheme)},e.prototype.parseMajorMinorFontScheme=function(e,t){if(!i.i(n.isNullOrUndefined)(e[f._356[this.keywordIndex]])&&Object.keys(e[f._356[this.keywordIndex]]).length>0){for(var r=Object.keys(e[f._356[this.keywordIndex]]),o=0,s=r;o<s.length;o++){var a=s[o];t.fontTypeface.add(a,e[f._356[this.keywordIndex]][a])}this.documentHelper.hasThemes=!0}if(!i.i(n.isNullOrUndefined)(e[f._355[this.keywordIndex]])&&e[f._355[this.keywordIndex]].length>0){for(var l=0;l<e[f._355[this.keywordIndex]].length;l++){var d=e[f._355[this.keywordIndex]][l],h=new g.B;h.name=i.i(n.isNullOrUndefined)(d.fontName)?d[f._35[this.keywordIndex]]:d[f._374[this.keywordIndex]],h.typeface=i.i(n.isNullOrUndefined)(d.fontTypeface)?d[f._357[this.keywordIndex]]:d.fontTypeface,h.panose=i.i(n.isNullOrUndefined)(d.pnose)?d[f._358[this.keywordIndex]]:d.pnose,t.fontSchemeList.push(h)}this.documentHelper.hasThemes=!0}},e.prototype.parseParagraphFormat=function(e,t,r){i.i(n.isNullOrUndefined)(t)||(i.i(n.isNullOrUndefined)(t[f._85[e]])||this.parseBorders(e,t[f._85[e]],r.borders),i.i(n.isNullOrUndefined)(t[f._52[e]])||(r.bidi=h.a.parseBoolValue(t[f._52[e]])),i.i(n.isNullOrUndefined)(t[f._69[e]])||(r.leftIndent=t[f._69[e]]),i.i(n.isNullOrUndefined)(t[f._70[e]])||(r.rightIndent=t[f._70[e]]),i.i(n.isNullOrUndefined)(t[f._71[e]])||(r.firstLineIndent=t[f._71[e]]),i.i(n.isNullOrUndefined)(t[f._73[e]])||(r.afterSpacing=t[f._73[e]]),i.i(n.isNullOrUndefined)(t[f._74[e]])||(r.beforeSpacing=t[f._74[e]]),i.i(n.isNullOrUndefined)(t[f._76[e]])||(r.spaceBeforeAuto=h.a.parseBoolValue(t[f._76[e]])),i.i(n.isNullOrUndefined)(t[f._75[e]])||(r.spaceAfterAuto=h.a.parseBoolValue(t[f._75[e]])),i.i(n.isNullOrUndefined)(t[f._77[e]])||(r.lineSpacing=t[f._77[e]]),i.i(n.isNullOrUndefined)(t[f._78[e]])?i.i(n.isNullOrUndefined)(t[f._77[e]])||(r.lineSpacingType="Multiple"):r.lineSpacingType=this.getLineSpacingType(t[f._78[e]]),i.i(n.isNullOrUndefined)(t[f._72[e]])||(r.textAlignment=this.getTextAlignment(t[f._72[e]])),i.i(n.isNullOrUndefined)(t[f._83[e]])||(r.outlineLevel=this.getOutlineLevel(t[f._83[e]])),i.i(n.isNullOrUndefined)(t[f._84[e]])||(r.contextualSpacing=h.a.parseBoolValue(t[f._84[e]])),i.i(n.isNullOrUndefined)(t[f._80[e]])||(r.keepWithNext=h.a.parseBoolValue(t[f._80[e]])),i.i(n.isNullOrUndefined)(t[f._82[e]])||(r.keepLinesTogether=h.a.parseBoolValue(t[f._82[e]])),i.i(n.isNullOrUndefined)(t[f._81[e]])||(r.widowControl=h.a.parseBoolValue(t[f._81[e]])),r.listFormat=new l.m(r),t.hasOwnProperty(f._79[e])&&this.parseListFormat(e,t,r.listFormat),t.hasOwnProperty(f._86[e])&&this.parseTabStop(e,t[f._86[e]],r.tabs))},e.prototype.parseListFormat=function(e,t,r){i.i(n.isNullOrUndefined)(t[f._79[e]])||(i.i(n.isNullOrUndefined)(t[f._79[e]][f._65[e]])||(r.listId=t[f._79[e]][f._65[e]],r.list=this.documentHelper.getListById(t[f._79[e]][f._65[e]])),i.i(n.isNullOrUndefined)(t[f._79[e]][f._330])?i.i(n.isNullOrUndefined)(r.list)||(r.nsid=r.list.nsid):r.nsid=t[f._79[e]][f._330],i.i(n.isNullOrUndefined)(t[f._79[e]][f._68[e]])||(r.listLevelNumber=t[f._79[e]][f._68[e]]))},e.prototype.parseSectionFormat=function(e,t,r){if(i.i(n.isNullOrUndefined)(t[f._91[e]])||(r.pageWidth=t[f._91[e]]),i.i(n.isNullOrUndefined)(t[f._92[e]])||(r.pageHeight=t[f._92[e]]),i.i(n.isNullOrUndefined)(t[f._93[e]])||(r.leftMargin=t[f._93[e]]),i.i(n.isNullOrUndefined)(t[f._95[e]])||(r.topMargin=t[f._95[e]]),i.i(n.isNullOrUndefined)(t[f._94[e]])||(r.rightMargin=t[f._94[e]]),i.i(n.isNullOrUndefined)(t[f._96[e]])||(r.bottomMargin=t[f._96[e]]),i.i(n.isNullOrUndefined)(t[f._87[e]])||(r.headerDistance=t[f._87[e]]),i.i(n.isNullOrUndefined)(t[f._88[e]])||(r.footerDistance=t[f._88[e]]),i.i(n.isNullOrUndefined)(t[f._89[e]])||(r.differentFirstPage=h.a.parseBoolValue(t[f._89[e]])),i.i(n.isNullOrUndefined)(t[f._90[e]])||(r.differentOddAndEvenPages=h.a.parseBoolValue(t[f._90[e]])),i.i(n.isNullOrUndefined)(t[f._52[e]])||(r.bidi=h.a.parseBoolValue(t[f._52[e]])),i.i(n.isNullOrUndefined)(t[f._97[e]])||(r.restartPageNumbering=h.a.parseBoolValue(t[f._97[e]])),i.i(n.isNullOrUndefined)(t[f._98[e]])||(r.pageStartingNumber=t[f._98[e]]),i.i(n.isNullOrUndefined)(t[f._99[e]])||(r.endnoteNumberFormat=this.getFootEndNoteNumberFormat(t[f._99[e]])),i.i(n.isNullOrUndefined)(t[f._100[e]])||(r.footNoteNumberFormat=this.getFootEndNoteNumberFormat(t[f._100[e]])),i.i(n.isNullOrUndefined)(t[f._101[e]])||(r.restartIndexForFootnotes=this.getFootnoteRestartIndex(t[f._101[e]])),i.i(n.isNullOrUndefined)(t[f._102[e]])||(r.restartIndexForEndnotes=this.getFootnoteRestartIndex(t[f._102[e]])),i.i(n.isNullOrUndefined)(t[f._103[e]])||(r.initialFootNoteNumber=t[f._103[e]]),i.i(n.isNullOrUndefined)(t[f._104[e]])||(r.initialEndNoteNumber=t[f._104[e]]),i.i(n.isNullOrUndefined)(t[f._105[e]])||(r.pageNumberStyle=t[f._105[e]]),!i.i(n.isNullOrUndefined)(t[f._106[e]])&&!i.i(n.isNullOrUndefined)(t[f._107[e]])&&t[f._107[e]]>1&&(r.numberOfColumns=t[f._107[e]],r.equalWidth=h.a.parseBoolValue(t[f._108[e]]),r.lineBetweenColumns=h.a.parseBoolValue(t[f._109[e]]),t[f._106[e]]))for(var o=0;o<t[f._106[e]].length;o++){var s=new l.j;s.width=h.a.convertPointToPixel(t[f._106[e]][o][f._204[e]]),s.space=h.a.convertPointToPixel(t[f._106[e]][o][f._350[e]]),s.index=o,r.columns.push(s)}i.i(n.isNullOrUndefined)(t[f._110[e]])||(r.breakCode=t[f._110[e]])},e.prototype.parseColumns=function(e,t){if(t=[],e)for(var i=0;i<e.length;i++){var n=new l.j;n.width=h.a.convertPointToPixel(e[i][f._204[this.keywordIndex]]),n.space=h.a.convertPointToPixel(e[i][f._350[this.keywordIndex]]),n.index=i,t.push(n)}},e.prototype.parseTabStop=function(e,t,i){if(t)for(var n=0;n<t.length;n++){var r=t[n];if(Object.keys(r).length>0){var o=new l.n;o.position=r[f._340[e]],o.tabLeader=this.getTabLeader(r[f._343[e]]),o.deletePosition=r[f._341[e]],o.tabJustification=this.getTabJustification(r[f._339[e]]),i.push(o)}}},e.prototype.validateImageUrl=function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");var i=3*e.length/4;return e.charAt(e.length-1)===t.charAt(64)&&i--,e.charAt(e.length-2)===t.charAt(64)&&i--,i%1==0},e.prototype.containsFieldBegin=function(e){for(var t=void 0,i=e.children.length-1;i>=0;i--){if((t=e.children[i])instanceof d.b&&t.hasFieldEnd&&t.nextElement instanceof d.d)return t.nextElement;if(t instanceof d.b)return}return t},e.prototype.getBaseAlignment=function(e){switch(e){case 0:return"Normal";case 1:return"Superscript";case 2:return"Subscript";default:return e}},e.prototype.getUnderline=function(e){switch(e){case 0:return"None";case 1:return"Single";case 2:return"Words";case 3:return"Double";case 4:return"Dotted";case 5:return"Thick";case 6:return"Dash";case 7:return"DashLong";case 8:return"DotDash";case 9:return"DotDotDash";case 10:return"Wavy";case 11:return"DottedHeavy";case 12:return"DashHeavy";case 13:return"DashLongHeavy";case 14:return"DotDashHeavy";case 15:return"DotDotDashHeavy";case 16:return"WavyHeavy";case 17:return"WavyDouble";default:return e}},e.prototype.getStrikethrough=function(e){switch(e){case 0:return"None";case 1:return"SingleStrike";case 2:return"DoubleStrike";default:return e}},e.prototype.getHighlightColor=function(e){switch(e){case 0:return"NoColor";case 1:return"Yellow";case 2:return"BrightGreen";case 3:return"Turquoise";case 4:return"Pink";case 5:return"Blue";case 6:return"Red";case 7:return"DarkBlue";case 8:return"Teal";case 9:return"Green";case 10:return"Violet";case 11:return"DarkRed";case 12:return"DarkYellow";case 13:return"Gray50";case 14:return"Gray25";case 15:return"Black";default:return e}},e.prototype.getLineSpacingType=function(e){switch(e){case 0:return"Multiple";case 1:return"AtLeast";case 2:return"Exactly";default:return e}},e.prototype.getOutlineLevel=function(e){switch(e){case 0:return"BodyText";case 1:return"Level1";case 2:return"Level2";case 3:return"Level3";case 4:return"Level4";case 5:return"Level5";case 6:return"Level6";case 7:return"Level7";case 8:return"Level8";case 9:return"Level9";default:return e}},e.prototype.getTextAlignment=function(e){switch(e){case 0:return"Left";case 1:return"Center";case 2:return"Right";case 3:return"Justify";default:return e}},e.prototype.getWidthType=function(e){switch(e){case 0:return"Auto";case 1:return"Percent";case 2:return"Point";default:return e}},e.prototype.getTableAlignment=function(e){switch(e){case 0:return"Left";case 1:return"Center";case 2:return"Right";default:return e}},e.prototype.getLineStyle=function(e){switch(e){case 0:return"Single";case 1:return"None";case 2:return"Dot";case 3:return"DashSmallGap";case 4:return"DashLargeGap";case 5:return"DashDot";case 6:return"DashDotDot";case 7:return"Double";case 8:return"Triple";case 9:return"ThinThickSmallGap";case 10:return"ThickThinSmallGap";case 11:return"ThinThickThinSmallGap";case 12:return"ThinThickMediumGap";case 13:return"ThickThinMediumGap";case 14:return"ThinThickThinMediumGap";case 15:return"ThinThickLargeGap";case 16:return"ThickThinLargeGap";case 17:return"ThinThickThinLargeGap";case 18:return"SingleWavy";case 19:return"DoubleWavy";case 20:return"DashDotStroked";case 21:return"Emboss3D";case 22:return"Engrave3D";case 23:return"Outset";case 24:return"Inset";case 25:return"Thick";case 26:return"Cleared";default:return e}},e.prototype.getTextureStyle=function(e){switch(e){case 0:return"TextureNone";case 1:return"Texture2Pt5Percent";case 2:return"Texture5Percent";case 3:return"Texture7Pt5Percent";case 4:return"Texture10Percent";case 5:return"Texture12Pt5Percent";case 6:return"Texture15Percent";case 7:return"Texture17Pt5Percent";case 8:return"Texture20Percent";case 9:return"Texture22Pt5Percent";case 10:return"Texture25Percent";case 11:return"Texture27Pt5Percent";case 12:return"Texture30Percent";case 13:return"Texture32Pt5Percent";case 14:return"Texture35Percent";case 15:return"Texture37Pt5Percent";case 16:return"Texture40Percent";case 17:return"Texture42Pt5Percent";case 18:return"Texture45Percent";case 19:return"Texture47Pt5Percent";case 20:return"Texture50Percent";case 21:return"Texture52Pt5Percent";case 22:return"Texture55Percent";case 23:return"Texture57Pt5Percent";case 24:return"Texture60Percent";case 25:return"Texture62Pt5Percent";case 26:return"Texture65Percent";case 27:return"Texture67Pt5Percent";case 28:return"Texture70Percent";case 29:return"Texture72Pt5Percent";case 30:return"Texture75Percent";case 31:return"Texture77Pt5Percent";case 32:return"Texture80Percent";case 33:return"Texture82Pt5Percent";case 34:return"Texture85Percent";case 35:return"Texture87Pt5Percent";case 36:return"Texture90Percent";case 37:return"Texture92Pt5Percent";case 38:return"Texture95Percent";case 39:return"Texture97Pt5Percent";case 40:return"TextureSolid";case 41:return"TextureDarkHorizontal";case 42:return"TextureDarkVertical";case 43:return"TextureDarkDiagonalDown";case 44:return"TextureDarkDiagonalUp";case 45:return"TextureDarkCross";case 46:return"TextureDarkDiagonalCross";case 47:return"TextureHorizontal";case 48:return"TextureVertical";case 49:return"TextureDiagonalDown";case 50:return"TextureDiagonalUp";case 51:return"TextureCross";case 52:return"TextureDiagonalCross";default:return e}},e.prototype.getHeightType=function(e){switch(e){case 0:return"AtLeast";case 1:return"Exactly";default:return e}},e.prototype.getCellVerticalAlignment=function(e){switch(e){case 0:return"Top";case 1:return"Center";case 2:return"Bottom";default:return e}},e.prototype.getListLevelPattern=function(e){switch(e){case 0:return"None";case 1:case 13:case"KanjiDigit":return"Arabic";case 2:return"UpRoman";case 3:return"LowRoman";case 4:return"UpLetter";case 5:return"LowLetter";case 6:return"Ordinal";case 7:return"Number";case 8:return"OrdinalText";case 9:return"LeadingZero";case 10:return"Bullet";case 11:return"FarEast";case 12:return"Special";default:return e}},e.prototype.getFollowCharacterType=function(e){switch(e){case 0:return"Tab";case 1:return"Space";case 2:return"None";default:return e}},e.prototype.getStyleType=function(e){switch(e){case 0:return"Paragraph";case 1:return"Character";default:return e}},e.prototype.getProtectionType=function(e){switch(e){case 0:return"NoProtection";case 1:return"ReadOnly";case 2:return"FormFieldsOnly";case 3:return"CommentsOnly";case 4:return"RevisionsOnly";default:return e}},e.prototype.getRevisionType=function(e){switch(e){case 1:return"Insertion";case 2:return"Deletion";case 3:return"MoveTo";case 4:return"MoveFrom";default:return e}},e.prototype.getFootnoteType=function(e){switch(e){case 0:return"Footnote";case 1:return"Endnote";default:return e}},e.prototype.getFootnoteRestartIndex=function(e){switch(e){case 0:return"DoNotRestart";case 1:return"RestartForEachSection";case 2:return"RestartForEachPage";default:return e}},e.prototype.getFootEndNoteNumberFormat=function(e){switch(e){case 0:return"Arabic";case 1:return"UpperCaseRoman";case 2:return"LowerCaseRoman";case 3:return"UpperCaseLetter";case 4:return"LowerCaseLetter";default:return e}},e.prototype.getBiDirectionalOverride=function(e){switch(e){case 0:return"None";case 1:return"LTR";case 2:return"RTL";default:return e}},e.prototype.getBreakClearType=function(e){switch(e){case 0:return"None";case 1:return"Left";case 2:return"Right";case 3:return"All";default:return e}},e.prototype.getTextVerticalAlignment=function(e){switch(e){case 0:return"Top";case 1:return"Center";case 2:return"Bottom";default:return e}},e.prototype.getShapeVerticalAlignment=function(e){switch(e){case 0:return"None";case 1:return"Top";case 2:return"Center";case 3:return"Bottom";case 4:return"Inline";case 5:return"Inside";case 6:return"Outside";default:return e}},e.prototype.getShapeHorizontalAlignment=function(e){switch(e){case 0:return"None";case 1:return"Center";case 2:return"Inside";case 3:return"Left";case 4:return"Outside";case 5:return"Right";default:return e}},e.prototype.getVerticalOrigin=function(e){switch(e){case 0:return"Paragraph";case 1:return"BottomMargin";case 2:return"InsideMargin";case 3:return"Line";case 4:return"Margin";case 5:return"OutsideMargin";case 6:return"Page";case 7:return"TopMargin";default:return e}},e.prototype.getHorizontalOrigin=function(e){switch(e){case 0:return"Column";case 1:return"Character";case 2:return"InsideMargin";case 3:return"LeftMargin";case 4:return"Margin";case 5:return"OutsideMargin";case 6:return"Page";case 7:return"RightMargin";default:return e}},e.prototype.getTableVerticalRelation=function(e){switch(e){case 0:return"Paragraph";case 1:return"Margin";case 2:return"Page";default:return e}},e.prototype.getTableHorizontalRelation=function(e){switch(e){case 0:return"Column";case 1:return"Margin";case 2:return"Page";default:return e}},e.prototype.getTableVerticalPosition=function(e){switch(e){case 0:return"None";case 1:return"Top";case 2:return"Center";case 3:return"Bottom";case 4:return"Inside";case 5:return"Outside";default:return e}},e.prototype.getTableHorizontalPosition=function(e){switch(e){case 0:return"Left";case 1:return"Center";case 2:return"Inside";case 3:return"Outside";case 4:return"Right";default:return e}},e.prototype.getLineDashStyle=function(e){switch(e){case 0:return"Solid";case 1:return"Dash";case 2:return"DashDot";case 3:return"DashDotDot";case 4:return"DashDotGEL";case 5:return"DashGEL";case 6:return"Dot";case 7:return"DotGEL";case 8:return"LongDashDotDotGEL";case 9:return"LongDashDotGEL";case 10:return"LongDashGEL";default:return e}},e.prototype.getHorizontalPositionAbs=function(e){switch(e){case 0:return"Left";case 1:return"Center";case 2:return"Right";case 3:return"Inside";case 4:return"Outside";default:return e}},e.prototype.getTabJustification=function(e){switch(e){case 0:return"Left";case 1:return"Bar";case 2:return"Center";case 3:return"Decimal";case 4:return"List";case 5:return"Right";default:return e}},e.prototype.getTabLeader=function(e){switch(e){case 0:return"None";case 1:return"Single";case 2:return"Dot";case 3:return"Hyphen";case 4:return"Underscore";default:return e}},e.prototype.getTextFormFieldType=function(e){switch(e){case 0:return"Text";case 1:return"Number";case 2:return"Date";case 3:return"Calculation";default:return e}},e.prototype.getTextFormFieldFormat=function(e){switch(e){case 0:return"None";case 1:return"FirstCapital";case 2:return"Lowercase";case 3:return"Uppercase";case 4:return"Titlecase";default:return e}},e.prototype.getCheckBoxSizeType=function(e){switch(e){case 0:return"Auto";case 1:return"Exactly";default:return e}},e.prototype.getContentControlAppearance=function(e){switch(e){case 1:return"BoundingBox";case 2:return"Hidden";case 3:return"Tags";default:return e}},e.prototype.getContentControlType=function(e){switch(e){case 0:return"RichText";case 1:return"BuildingBlockGallery";case 2:return"CheckBox";case 3:return"ComboBox";case 4:return"Date";case 5:return"DropDownList";case 6:return"Group";case 7:return"Picture";case 8:return"RepeatingSection";case 9:return"Text";default:return e}},e.prototype.getDateCalendarType=function(e){switch(e){case 0:return"Gregorian";case 1:return"GregorianArabic";case 2:return"GregorianEnglish";case 3:return"GregorianMiddleEastFrench";case 4:return"GregorianTransliteratedEnglish";case 5:return"GregorianTransliteratedFrench";case 6:return"Hebrew";case 7:return"Hijri";case 8:return"Japan";case 9:return"Korean";case 10:return"Saka";case 11:return"Taiwan";case 12:return"Thai";default:return e}},e.prototype.getDateStorageFormat=function(e){switch(e){case 1:return"DateStorageDate";case 2:return"DateStorageDateTime";case 3:return"DateStorageText";default:return e}},e.prototype.getTextWrappingStyle=function(e){switch(e){case 0:return"Inline";case 1:return"InFrontOfText";case 2:return"Square";case 3:return"TopAndBottom";case 4:return"Behind";default:return e}},e.prototype.getTextWrappingType=function(e){switch(e){case 0:return"Both";case 1:return"Left";case 2:return"Right";case 3:return"Largest";default:return e}},e.prototype.getCompatibilityMode=function(e){switch(e){case 0:return"Word2013";case 1:return"Word2003";case 2:return"Word2007";case 3:return"Word2010";default:return e}},e.prototype.getLineFormatType=function(e){switch(e){case 0:return"Solid";case 1:return"Patterned";case 2:return"Gradient";case 3:return"None";default:return e}},e.prototype.getAutoShapeType=function(e){switch(e){case 1:return"Rectangle";case 2:return"RoundedRectangle";case 3:return"StraightConnector";default:return e}},e.prototype.destroy=function(){this.footnotes&&this.footnotes.destroy(),this.footnotes=void 0,this.endnotes&&this.endnotes.destroy(),this.endnotes=void 0,this.editableRanges&&this.editableRanges.destroy(),this.editableRanges=void 0,this.commentEnds&&this.commentEnds.destroy(),this.commentEnds=void 0,this.commentStarts&&this.commentStarts.destroy(),this.commentStarts=void 0,this.commentsCollection&&this.commentsCollection.destroy(),this.commentsCollection=void 0,this.revisionCollection&&this.revisionCollection.destroy(),this.revisionCollection=void 0,this.documentHelper=void 0,this.keywordIndex=void 0},e}()},function(e,t,i){"use strict";var n=i(138);i.d(t,"a",function(){return n.a});var r=i(137);i.d(t,"b",function(){return r.a});var o=i(136);i.d(t,"c",function(){return o.a});var s=i(69);i.d(t,"d",function(){return s.a})},function(e,t,i){"use strict";i.d(t,"a",function(){return h});var n=i(17),r=i(9),o=i(2),s=i(0),a=(i.n(s),i(4)),l=i(33),d=(i.n(l),i(1)),h=function(){function e(e){this.startLine=void 0,this.endLine=void 0,this.endOffset=void 0,this.endCell=void 0,this.startColumnIndex=void 0,this.endColumnIndex=void 0,this.lists=void 0,this.document=void 0,this.writeInlineStyles=void 0,this.blockContent=!1,this.startContent=!1,this.multipleLineContent=!1,this.nestedContent=!1,this.editRangeId=-1,this.selectedCommentsId=[],this.selectedRevisionId=[],this.nestedBlockContent=!1,this.nestedBlockEnabled=!1,this.blocks=[],this.contentInline=[],this.isContentControl=!1,this.isBlockClosed=!0,this.isWriteInlinesFootNote=!1,this.isWriteEndFootNote=!1,this.iscommentInsert=!0,this.keywordIndex=void 0,this.isExport=!0,this.isWordExport=!1,this.isPartialExport=!1,this.checkboxOrDropdown=!1,this.copyWithTrackChange=!1,this.documentHelper=e}return Object.defineProperty(e.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"owner",{get:function(){return this.documentHelper.owner},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"SfdtExport"},e.prototype.clear=function(){this.writeInlineStyles=void 0,this.startLine=void 0,this.endLine=void 0,this.lists=void 0,this.document=void 0,this.endCell=void 0,this.startColumnIndex=void 0,this.endColumnIndex=void 0,this.selectedCommentsId=[],this.selectedRevisionId=[],this.startBlock=void 0,this.endBlock=void 0,this.isPartialExport=!1,this.keywordIndex=void 0},e.prototype.serialize=function(){return this.seralizeInternal(this.owner.documentEditorSettings.optimizeSfdt?1:0)},e.prototype.seralizeInternal=function(e){return JSON.stringify(this.write(e))},e.prototype.saveAsBlobNonOptimized=function(e){var t=new Blob([this.serialize()],{type:"text/plain"});return new Promise(function(e,i){e(t)})},e.prototype.saveAsBlob=function(e){var t=this.serialize(),i=new Blob([t],{type:"application/json"}),n=new l.ZipArchiveItem(i,"sfdt"),r=new l.ZipArchive;return r.addItem(n),r.saveAsBlob()},e.prototype.updateEditRangeId=function(){for(var e=-1,t=0;t<this.documentHelper.editRanges.keys.length;t++)for(var i=this.documentHelper.editRanges.keys,n=0;n<i[t].length;n++)for(var r=this.documentHelper.editRanges.get(i[t]),o=0;o<r.length;o++)e++,r[o].editRangeId=e,r[o].editRangeEnd.editRangeId=e},e.prototype.write=function(e,t,n,r,a,l,h){var c;if(l&&(this.writeInlineStyles=!0),i.i(s.isNullOrUndefined)(e)?this.keywordIndex=this.owner.documentEditorSettings.optimizeSfdt?1:0:this.keywordIndex=e,this.Initialize(),this.updateEditRangeId(),t instanceof o.p&&r instanceof o.p){this.isExport=!1,i.i(s.isNullOrUndefined)(h)||(this.isExport=h);var p=t.paragraph,u=r.paragraph;this.isPartialExport&&(this.startBlock=this.getParentBlock(p),this.endBlock=this.getParentBlock(u));var g=p.associatedCell,f=u.associatedCell,m=(p.bodyWidget,this.createSection(t.paragraph.bodyWidget));this.document[d._2[this.keywordIndex]].push(m);var v=g,y=f;g instanceof o.j&&(v=this.getParentCell(v)),f instanceof o.j&&(y=this.getParentCell(y));var w=v instanceof o.j&&y instanceof o.j&&v.equals(y);if(w||i.i(s.isNullOrUndefined)(f))this.startLine=t,this.endLine=r,this.endOffset=a;else if(g instanceof o.j){var b=g.getContainerTable(),x=f.getContainerTable();b.tableFormat===x.tableFormat&&(this.endCell=f,this.endCell.ownerTable!==g.ownerTable&&g.ownerTable.associatedCell&&g.ownerTable.associatedCell.ownerTable===this.endCell.ownerTable&&0===g.ownerTable.associatedCell.childWidgets.indexOf(g.ownerTable)&&(g=g.ownerTable.associatedCell),this.endColumnIndex=this.endCell.columnIndex+this.endCell.cellFormat.columnSpan,this.startColumnIndex=g.columnIndex)}else this.endCell=f;var C=void 0;if(w&&!this.isPartialExport||i.i(s.isNullOrUndefined)(g)){var I=this.createParagraph(t.paragraph);m[d._314[this.keywordIndex]].push(I);var F=t.paragraph;for(C=this.writeParagraph(t.paragraph,I,m[d._314[this.keywordIndex]],t.indexInOwner,n),this.isPartialExport&&(C=this.getNextBlock(C,F),m=this.document[d._2[this.keywordIndex]][this.document[d._2[this.keywordIndex]].length-1]);C;)F=C,C=this.writeBlock(C,0,m[d._314[this.keywordIndex]]),this.isPartialExport&&i.i(s.isNullOrUndefined)(C)&&(C=this.getNextBlock(C,F),m=this.document[d._2[this.keywordIndex]][this.document[d._2[this.keywordIndex]].length-1])}else{if(i.i(s.isNullOrUndefined)(f)&&g.ownerTable.associatedCell){var b=g.getContainerTable(),k=b.childWidgets[b.childWidgets.length-1],P=k.childWidgets[k.childWidgets.length-1];if(P.ownerTable!==g.ownerTable&&g.ownerTable.associatedCell&&0===g.ownerTable.associatedCell.childWidgets.indexOf(g.ownerTable))for(;g.ownerTable!==P.ownerTable;)g=g.ownerTable.associatedCell;this.endColumnIndex=P.columnIndex+P.cellFormat.columnSpan,this.startColumnIndex=g.columnIndex}var T=this.createTable(g.ownerTable);m[d._314[this.keywordIndex]].push(T);var F=g.ownerTable;for(C=this.writeTable(g.ownerTable,T,g.ownerRow.indexInOwner,m[d._314[this.keywordIndex]]),this.isPartialExport&&(C=this.getNextBlock(C,F),m=this.document[d._2[this.keywordIndex]][this.document[d._2[this.keywordIndex]].length-1]);C;)F=C,C=this.writeBlock(C,0,m[d._314[this.keywordIndex]]),this.isPartialExport&&(C=this.getNextBlock(C,F),m=this.document[d._2[this.keywordIndex]][this.document[d._2[this.keywordIndex]].length-1])}}else if(this.isExport=!0,this.documentHelper.pages.length>0){var S=this.documentHelper.pages[0];this.writePage(S)}this.document[d._8[this.keywordIndex]]=(c={},c[d._221[this.keywordIndex]]=this.documentHelper.backgroundColor,c),this.writeStyles(this.documentHelper),this.writeLists(this.documentHelper),this.writeComments(this.documentHelper),this.writeRevisions(this.documentHelper),this.writeCustomXml(this.documentHelper),this.writeImages(this.documentHelper),this.footnotes(this.documentHelper),this.endnotes(this.documentHelper);var W=this.document;return this.clear(),W},e.prototype.getNextBlock=function(e,t){if(i.i(s.isNullOrUndefined)(e)&&this.isPartialExport&&this.endBlock&&!this.endBlock.equals(t))if((e=t.getSplitWidgets().pop().nextRenderedWidget)&&t.bodyWidget.index!==e.bodyWidget.index){var n=this.createSection(e.bodyWidget);this.document[d._2[this.keywordIndex]].push(n)}else e=void 0;return e},e.prototype.Initialize=function(){this.lists=[],this.document={},this.document.optimizeSfdt=this.owner.documentEditorSettings.optimizeSfdt,this.document[d._2[this.keywordIndex]]=[],this.document[d._4[this.keywordIndex]]=this.writeCharacterFormat(this.documentHelper.characterFormat),this.document[d._5[this.keywordIndex]]=this.writeParagraphFormat(this.documentHelper.paragraphFormat),this.document[d._33[this.keywordIndex]]=this.writeCharacterFormat(this.documentHelper.themeFontLanguage),this.document[d._13[this.keywordIndex]]=this.documentHelper.defaultTabWidth,this.document[d._15[this.keywordIndex]]=a.a.getBoolInfo(this.owner.enableTrackChanges,this.keywordIndex),this.document[d._17[this.keywordIndex]]=a.a.getBoolInfo(this.documentHelper.isDocumentProtected,this.keywordIndex),this.document[d._18[this.keywordIndex]]=this.documentHelper.hashValue,this.document[d._19[this.keywordIndex]]=this.documentHelper.saltValue,this.document[d._14[this.keywordIndex]]=a.a.getBoolInfo(this.documentHelper.restrictFormatting,this.keywordIndex),this.document[d._16[this.keywordIndex]]=1==this.keywordIndex?this.getProtectionTypeEnumValue(this.documentHelper.protectionType):this.documentHelper.protectionType,this.document[d._26[this.keywordIndex]]=a.a.getBoolInfo(this.documentHelper.dontUseHtmlParagraphAutoSpacing,this.keywordIndex),this.document[d._28[this.keywordIndex]]=a.a.getBoolInfo(this.documentHelper.owner.documentEditorSettings.formFieldSettings.applyShading,this.keywordIndex),this.document[d._32[this.keywordIndex]]=1==this.keywordIndex?this.getCompatibilityModeEnumValue(this.documentHelper.compatibilityMode):this.documentHelper.compatibilityMode,this.document[d._371[this.keywordIndex]]=a.a.getBoolInfo(this.documentHelper.allowSpaceOfSameStyleInTable,this.keywordIndex),this.documentHelper.hasThemes&&(this.document[d._34[this.keywordIndex]]=this.writeThemes(this.documentHelper.themes))},e.prototype.writePage=function(e){if(e.bodyWidgets.length>0){var t=e.bodyWidgets[0];do{t=this.writeBodyWidget(t,0)}while(!i.i(s.isNullOrUndefined)(t))}return this.document},e.prototype.writeBodyWidget=function(e,t){if(e instanceof o.o){var n=this.createSection(e);this.document[d._2[this.keywordIndex]].push(n),this.writeHeaderFooters(this.documentHelper.headersFooters[e.index],n);var r=e.childWidgets[t];i.i(s.isNullOrUndefined)(r)&&e.nextRenderedWidget&&(r=e.nextRenderedWidget.childWidgets[t]);do{r=this.writeBlock(r,0,n[d._314[this.keywordIndex]])}while(r);var a=e;do{e=a,a=a.nextRenderedWidget,!i.i(s.isNullOrUndefined)(a)||i.i(s.isNullOrUndefined)(e.page.nextPage)||i.i(s.isNullOrUndefined)(e.page.nextPage)||(a=e.page.nextPage.bodyWidgets[0])}while(a instanceof o.o&&a.index===e.index);var l;if(!i.i(s.isNullOrUndefined)(e.lastChild)&&e.lastChild instanceof o.g&&(l=e.lastChild.isEmpty(),e.lastChild.isSectionBreak&&!i.i(s.isNullOrUndefined)(e.lastChild.previousRenderedWidget)&&e.lastChild.previousRenderedWidget instanceof o.u&&(l=!1)),!i.i(s.isNullOrUndefined)(a)&&a instanceof o.o&&e.sectionIndex!==a.sectionIndex&&l&&!this.isWordExport){var h={};h[d._267[this.keywordIndex]]=[],n[d._314[this.keywordIndex]].push(h)}return a}},e.prototype.writeHeaderFooters=function(e,t){if(!i.i(s.isNullOrUndefined)(e)){var n=t[d._321[this.keywordIndex]];i.i(s.isNullOrUndefined)(e[0])||e[0].isEmpty||(n[d._315[this.keywordIndex]]=this.writeHeaderFooter(e[0]),"{}"==JSON.stringify(n[d._315[this.keywordIndex]])&&delete n[d._315[this.keywordIndex]]),i.i(s.isNullOrUndefined)(e[1])||e[1].isEmpty||(n[d._316[this.keywordIndex]]=this.writeHeaderFooter(e[1]),"{}"==JSON.stringify(n[d._316[this.keywordIndex]])&&delete n[d._316[this.keywordIndex]]),i.i(s.isNullOrUndefined)(e[2])||e[2].isEmpty||(n[d._317[this.keywordIndex]]=this.writeHeaderFooter(e[2]),"{}"==JSON.stringify(n[d._317[this.keywordIndex]])&&delete n[d._317[this.keywordIndex]]),i.i(s.isNullOrUndefined)(e[3])||e[3].isEmpty||(n[d._318[this.keywordIndex]]=this.writeHeaderFooter(e[3]),"{}"==JSON.stringify(n[d._318[this.keywordIndex]])&&delete n[d._318[this.keywordIndex]]),i.i(s.isNullOrUndefined)(e[4])||e[4].isEmpty||(n[d._319[this.keywordIndex]]=this.writeHeaderFooter(e[4]),"{}"==JSON.stringify(n[d._319[this.keywordIndex]])&&delete n[d._319[this.keywordIndex]]),i.i(s.isNullOrUndefined)(e[5])||e[5].isEmpty||(n[d._320[this.keywordIndex]]=this.writeHeaderFooter(e[5]),"{}"==JSON.stringify(n[d._320[this.keywordIndex]])&&delete n[d._320[this.keywordIndex]])}},e.prototype.writeHeaderFooter=function(e){if(!i.i(s.isNullOrUndefined)(e)&&!e.isEmpty){var t={};if(e&&e.childWidgets&&e.childWidgets.length>0){t[d._314[this.keywordIndex]]=[];var n=e.firstChild;do{n=this.writeBlock(n,0,t[d._314[this.keywordIndex]])}while(n)}return t}},e.prototype.createSection=function(e){var t={};return t[d._322[this.keywordIndex]]={},t[d._322[this.keywordIndex]]=this.writeSectionFormat(e.sectionFormat,t[d._322[this.keywordIndex]],this.keywordIndex),t[d._314[this.keywordIndex]]=[],t[d._321[this.keywordIndex]]={},t},e.prototype.writeSectionFormat=function(e,t,n){if(t[d._91[n]]=e.pageWidth,t[d._92[n]]=e.pageHeight,t[d._93[n]]=e.leftMargin,t[d._94[n]]=e.rightMargin,t[d._95[n]]=e.topMargin,t[d._96[n]]=e.bottomMargin,t[d._87[n]]=e.headerDistance,t[d._88[n]]=e.footerDistance,t[d._89[n]]=a.a.getBoolInfo(e.differentFirstPage,n),t[d._90[n]]=a.a.getBoolInfo(e.differentOddAndEvenPages,n),t[d._52[n]]=a.a.getBoolInfo(e.bidi,n),i.i(s.isNullOrUndefined)(e.breakCode)||(t[d._110[n]]=e.breakCode),e.restartPageNumbering&&(t[d._97[n]]=a.a.getBoolInfo(e.restartPageNumbering,n),t[d._98[n]]=e.pageStartingNumber),t[d._99[n]]=1==n?this.getFootEndNoteNumberFormatEnumValue(e.endnoteNumberFormat):e.endnoteNumberFormat,t[d._100[n]]=1==n?this.getFootEndNoteNumberFormatEnumValue(e.footNoteNumberFormat):e.footNoteNumberFormat,t[d._101[n]]=1==n?this.getFootnoteRestartIndexEnumValue(e.restartIndexForFootnotes):e.restartIndexForFootnotes,t[d._102[n]]=1==n?this.getFootnoteRestartIndexEnumValue(e.restartIndexForEndnotes):e.restartIndexForEndnotes,t[d._103[n]]=e.initialFootNoteNumber,t[d._104[n]]=e.initialEndNoteNumber,i.i(s.isNullOrUndefined)(e.pageNumberStyle)||(t[d._105[n]]=e.pageNumberStyle),!i.i(s.isNullOrUndefined)(e.columns)&&!i.i(s.isNullOrUndefined)(e.numberOfColumns&&e.numberOfColumns>1)){var r=e.columns;t[d._107[n]]=e.numberOfColumns,t[d._108[n]]=a.a.getBoolInfo(e.equalWidth,n),t[d._109[n]]=a.a.getBoolInfo(e.lineBetweenColumns,n),t[d._106[n]]=[];for(var o=0;o<r.length;o++){var l={};l[d._204[n]]=a.a.convertPixelToPoint(r[o].width),l[d._350[n]]=a.a.convertPixelToPoint(r[o].space),t[d._106[n]].push(l)}}return t},e.prototype.writeBlock=function(e,t,n){if(e instanceof o.C){if(e instanceof o.g){if(e.hasOwnProperty("contentControlProperties")&&"BuildingBlockGallery"!==e.contentControlProperties.type){var r=this.blockContentControl(e);return this.blockContent=!1,i.i(s.isNullOrUndefined)(r)||!this.isBlockClosed&&this.nestedBlockContent||(this.nestedBlockEnabled=!1,n.push(r),this.blocks=[]),this.nextBlock}var a=this.createParagraph(e);return n.push(a),this.writeParagraph(e,a,n)}var l=e;if(l.hasOwnProperty("contentControlProperties")&&"BuildingBlockGallery"!==l.contentControlProperties.type){var r=this.tableContentControl(l);return!i.i(s.isNullOrUndefined)(r)&&this.isBlockClosed&&n.push(r),this.nextBlock}var d=this.createTable(l);return n.push(d),this.writeTable(l,d,0,n)}},e.prototype.writeParagraphs=function(e){var t=this.blocks,n=e.childWidgets[0],r=n.children[0],a=n.children[1];if((r instanceof o.q||a instanceof o.q)&&(r=n.children[2],a=n.children[3]),!i.i(s.isNullOrUndefined)(e.contentControlProperties)&&e.containerWidget instanceof o.j&&!i.i(s.isNullOrUndefined)(e.containerWidget.containerWidget)&&!i.i(s.isNullOrUndefined)(e.containerWidget.containerWidget.containerWidget.contentControlProperties)&&(t=[]),this.nestedBlockEnabled&&(t=[]),r instanceof o.H&&a instanceof o.H&&!this.nestedBlockContent||this.blockContent&&r instanceof o.H&&!this.nestedBlockContent){var l=!1;if(a instanceof o.H&&"Block"===a.contentControlWidgetType&&(l=!0),l||this.blockContent&&r instanceof o.H&&!this.nestedBlockContent&&0===r.type&&a instanceof o.H&&"Block"===r.contentControlWidgetType){this.nestedBlockContent=!0,this.nestedBlockEnabled=!0;var d=this.blockContentControl(e);i.i(s.isNullOrUndefined)(d)||this.blocks.push(d)}else{var h=this.createParagraph(e);t.push(h),this.nextBlock=this.writeParagraph(e,h,t)}}else{var h=this.createParagraph(e);t.push(h),this.nextBlock=this.writeParagraph(e,h,t)}return!this.nestedBlockContent&&this.nestedBlockEnabled&&(this.nestedBlockEnabled=!1),t},e.prototype.contentControlProperty=function(e){var t={},n=[];if(t[d._269[this.keywordIndex]]=a.a.getBoolInfo(e.lockContentControl,this.keywordIndex),t[d._270[this.keywordIndex]]=a.a.getBoolInfo(e.lockContents,this.keywordIndex),t[d._271[this.keywordIndex]]=e.tag,t[d._221[this.keywordIndex]]=e.color,t[d._272[this.keywordIndex]]=e.title,i.i(s.isNullOrUndefined)(e.appearance)||(t[d._369[this.keywordIndex]]=1==this.keywordIndex?this.getContentControlAppearanceEnumValue(e.appearance):e.appearance),t[d._359[this.keywordIndex]]=1==this.keywordIndex?this.getContentControlTypeEnumValue(e.type):e.type,t[d._273[this.keywordIndex]]=a.a.getBoolInfo(e.hasPlaceHolderText,this.keywordIndex),t[d._274[this.keywordIndex]]=a.a.getBoolInfo(e.multiline,this.keywordIndex),t[d._275[this.keywordIndex]]=a.a.getBoolInfo(e.isTemporary,this.keywordIndex),i.i(s.isNullOrUndefined)(e.isChecked)||(t[d._280[this.keywordIndex]]=a.a.getBoolInfo(e.isChecked,this.keywordIndex)),i.i(s.isNullOrUndefined)(e.uncheckedState)||(t[d._281[this.keywordIndex]]=this.tounCheckedState(e.uncheckedState)),i.i(s.isNullOrUndefined)(e.checkedState)||(t[d._282[this.keywordIndex]]=this.toCheckedState(e.checkedState)),i.i(s.isNullOrUndefined)(e.dateCalendarType)||(t[d._276[this.keywordIndex]]=1==this.keywordIndex?this.getDateCalendarTypeEnumValue(e.dateCalendarType):e.dateCalendarType),i.i(s.isNullOrUndefined)(e.dateStorageFormat)||(t[d._277[this.keywordIndex]]=1==this.keywordIndex?this.getDateStorageFormatEnumValue(e.dateStorageFormat):e.dateStorageFormat),i.i(s.isNullOrUndefined)(e.dateDisplayLocale)||(t[d._278[this.keywordIndex]]=e.dateDisplayLocale),i.i(s.isNullOrUndefined)(e.dateDisplayFormat)||(t[d._279[this.keywordIndex]]=e.dateDisplayFormat),!i.i(s.isNullOrUndefined)(e.xmlMapping)){var r={},o={};r[d._288[this.keywordIndex]]=a.a.getBoolInfo(e.xmlMapping.isMapped,this.keywordIndex),r[d._289[this.keywordIndex]]=a.a.getBoolInfo(e.xmlMapping.isWordMl,this.keywordIndex),i.i(s.isNullOrUndefined)(e.xmlMapping.prefixMapping)||(r[d._290[this.keywordIndex]]=e.xmlMapping.prefixMapping),r[d._291[this.keywordIndex]]=e.xmlMapping.xPath,r[d._292[this.keywordIndex]]=e.xmlMapping.storeItemId,i.i(s.isNullOrUndefined)(e.xmlMapping.customXmlPart)||(o[d._294[this.keywordIndex]]=e.xmlMapping.customXmlPart.id,o[d._262[this.keywordIndex]]=e.xmlMapping.customXmlPart.xml,r[d._293[this.keywordIndex]]=o),t[d._284[this.keywordIndex]]=r}if(i.i(s.isNullOrUndefined)(e.characterFormat)||(t[d._4[this.keywordIndex]]=this.writeCharacterFormat(e.characterFormat)),!i.i(s.isNullOrUndefined)(e.contentControlListItems))for(var l=0;l<e.contentControlListItems.length;l++){var h={};h[d._287[this.keywordIndex]]=e.contentControlListItems[l].displayText,h[d._286[this.keywordIndex]]=e.contentControlListItems[l].value,n.push(h)}return t[d._283[this.keywordIndex]]=n,t},e.prototype.tounCheckedState=function(e){var t={};return t[d._285[this.keywordIndex]]=e.font,t[d._286[this.keywordIndex]]=e.value,t},e.prototype.toCheckedState=function(e){var t={};return t[d._285[this.keywordIndex]]=e.font,t[d._286[this.keywordIndex]]=e.value,t},e.prototype.blockContentControl=function(e){var t={};if(0===e.childWidgets.length)return void(this.nextBlock=e.nextWidget);if(t[d._314[this.keywordIndex]]=this.writeParagraphs(e),i.i(s.isNullOrUndefined)(this.nextBlock))this.isBlockClosed=!0;else{if(e.contentControlProperties===this.nextBlock.contentControlProperties)return this.isBlockClosed=!1,this.nestedBlockContent=!0,this.blocks=t[d._314[this.keywordIndex]];this.isBlockClosed=!0}if(!i.i(s.isNullOrUndefined)(t[d._314[this.keywordIndex]])){var n=e.childWidgets[0],r=n.children[0],a=n.children[1];if((r instanceof o.q||a instanceof o.q)&&(r=n.children[2],a=n.children[3]),r instanceof o.H&&a instanceof o.H&&!this.nestedBlockContent||this.blockContent&&r instanceof o.H&&!this.nestedBlockContent){if(!(a instanceof o.H))return t[d._268[this.keywordIndex]]=this.contentControlProperty(r.contentControlProperties),t;"Block"===a.contentControlWidgetType?t[d._268[this.keywordIndex]]=this.contentControlProperty(a.contentControlProperties):t[d._268[this.keywordIndex]]=this.contentControlProperty(e.contentControlProperties)}else t[d._268[this.keywordIndex]]=this.contentControlProperty(e.contentControlProperties);return t}},e.prototype.tableContentControl=function(e){var t={};if(t[d._314[this.keywordIndex]]=this.tableContentControls(e),!i.i(s.isNullOrUndefined)(this.nextBlock)){if(e.contentControlProperties===this.nextBlock.contentControlProperties)return this.isBlockClosed=!1,this.blocks=t[d._314[this.keywordIndex]];this.isBlockClosed=!0}return t[d._268[this.keywordIndex]]=this.contentControlProperty(e.contentControlProperties),t},e.prototype.tableContentControls=function(e){var t=[];this.isBlockClosed||(t=this.blocks);var i=this.createTable(e);return t.push(i),this.nextBlock=this.writeTable(e,i,0,t),t},e.prototype.writeParagraph=function(e,t,n,r,a){i.i(s.isNullOrUndefined)(r)&&(r=0),i.i(s.isNullOrUndefined)(a)&&(a=0);for(var l=e;l instanceof o.g;){var h=this.owner.selection,c=void 0,p=void 0,u=void 0;if(i.i(s.isNullOrUndefined)(h)||(p=h.getElementInfo(h.end.currentWidget,h.end.offset),u=h.getParagraphLength(e,h.isForward?h.end.currentWidget:h.start.currentWidget,p)),!i.i(s.isNullOrUndefined)(this.owner.editor)&&this.owner.editor.isCopying&&h.getParagraphLength(e)+1===Math.abs(u)&&h.start.paragraph===h.end.paragraph&&(c=h.getParagraphsInSelection()),this.writeLines(l,r,a,t[d._267[this.keywordIndex]]))return void(i.i(s.isNullOrUndefined)(c)||1!==c.length||c[0]!==e||(t[d._23[this.keywordIndex]]=!0));r=0,a=0,i.i(s.isNullOrUndefined)(c)||1!==c.length||c[0]!==e||(t[d._23[this.keywordIndex]]=!0),e=l,l=e.nextSplitWidget}return l=e.nextRenderedWidget,"Continuous"!==this.documentHelper.owner.layoutType&&i.i(s.isNullOrUndefined)(l)&&e.containerWidget instanceof o.o&&!i.i(s.isNullOrUndefined)(e.containerWidget.page.nextPage)&&!i.i(s.isNullOrUndefined)(e.containerWidget.page.nextPage.bodyWidgets)&&(l=e.containerWidget.page.nextPage.bodyWidgets[0].childWidgets[0]),this.isExport?l instanceof o.C&&e.containerWidget.index===l.containerWidget.index?l:void 0:l},e.prototype.writeInlines=function(e,t,n){this.contentInline=[];for(var r=t,a=!1,l=0;l<r.children.length;l++){var d=r.children[l];if(this.isExport&&this.checkboxOrDropdown){if(a&&d instanceof o.d)continue;d instanceof o.b&&2===d.fieldType&&(a=!0)}if(!(d instanceof o.q))if(d instanceof o.f)n.push(this.writeInlinesFootNote(e,d,t,n));else{if(d instanceof o.H||this.startContent||this.blockContent)this.writeInlinesContentControl(d,t,n,l);else{var h=this.writeInline(d);i.i(s.isNullOrUndefined)(h)||n.push(h)}this.isExport&&d instanceof o.b&&1===d.fieldType&&(a=!1,this.checkboxOrDropdown=!1)}}},e.prototype.inlineContentControl=function(e,t,n){var r={},a=[];if(i.i(s.isNullOrUndefined)(n))if(this.nestedContent){r[d._267[this.keywordIndex]]=this.inlineContentControls(e,void 0,a);var l=this.nestedContentProperty(t,r);i.i(s.isNullOrUndefined)(l)&&!this.multipleLineContent||(this.contentInline.push(r),a=[])}else r[d._267[this.keywordIndex]]=this.inlineContentControls(e,this.contentInline);else if(this.nestedContent){n=n[n.length-1][d._267[this.keywordIndex]],void 0==n[n.length-1][d._267[this.keywordIndex]]&&(n[n.length-1][d._267[this.keywordIndex]]=[]),r=this.inlineContentControls(e,n[n.length-1][d._267[this.keywordIndex]]);var l=this.nestedContentProperty(t,n[n.length-1]);i.i(s.isNullOrUndefined)(l)||(this.contentInline.push(r),a=[])}else this.inlineContentControls(e,n[n.length-1][d._267[this.keywordIndex]]);return t instanceof o.H&&1===t.type&&!this.nestedContent?this.multipleLineContent&&!i.i(s.isNullOrUndefined)(n)?(n[n.length-1][d._268[this.keywordIndex]]=this.contentControlProperty(t.contentControlProperties),void(this.multipleLineContent=!1)):(r[d._268[this.keywordIndex]]=this.contentControlProperty(t.contentControlProperties),r):this.startContent?(this.multipleLineContent=!0,r):void 0},e.prototype.nestedContentProperty=function(e,t,n){if(i.i(s.isNullOrUndefined)(e)){if(this.startContent)return this.multipleLineContent=!0,t}else{if(1===e.type)return t[d._268[this.keywordIndex]]=this.contentControlProperty(e.contentControlProperties),t;if(this.startContent)return this.multipleLineContent=!0,t}},e.prototype.inlineContentControls=function(e,t,n){var r=this.writeInline(e);return i.i(s.isNullOrUndefined)(n)?(t.push(r),t):(n.push(r),n)},e.prototype.writeInline=function(e){var t={};if(e.removedIds.length>0)for(var n=0;n<e.removedIds.length;n++)e.revisions[n]=this.documentHelper.revisionsInternal.get(e.removedIds[n]);if(t[d._4[this.keywordIndex]]=this.writeCharacterFormat(e.characterFormat),e instanceof o.b)t[d._237[this.keywordIndex]]=e.fieldType,0===e.fieldType&&(t[d._235[this.keywordIndex]]=e.hasFieldEnd,e.formFieldData&&(t[d._236[this.keywordIndex]]={},t[d._236[this.keywordIndex]][d._35[this.keywordIndex]]=e.formFieldData.name,t[d._236[this.keywordIndex]][d._238[this.keywordIndex]]=a.a.getBoolInfo(e.formFieldData.enabled,this.keywordIndex),t[d._236[this.keywordIndex]][d._239[this.keywordIndex]]=e.formFieldData.helpText,t[d._236[this.keywordIndex]][d._240[this.keywordIndex]]=e.formFieldData.statusText,e.formFieldData instanceof o.l?(t[d._236[this.keywordIndex]][d._241[this.keywordIndex]]={},t[d._236[this.keywordIndex]][d._241[this.keywordIndex]][d._359[this.keywordIndex]]=1==this.keywordIndex?this.getTextFormFieldTypeEnumValue(e.formFieldData.type):e.formFieldData.type,t[d._236[this.keywordIndex]][d._241[this.keywordIndex]][d._244[this.keywordIndex]]=e.formFieldData.maxLength,t[d._236[this.keywordIndex]][d._241[this.keywordIndex]][d._245[this.keywordIndex]]=e.formFieldData.defaultValue,t[d._236[this.keywordIndex]][d._241[this.keywordIndex]][d._246[this.keywordIndex]]=1==this.keywordIndex&&"Text"===e.formFieldData.type?this.getTextFormFieldFormatEnumValue(e.formFieldData.format):e.formFieldData.format):e.formFieldData instanceof o.m?(t[d._236[this.keywordIndex]][d._242[this.keywordIndex]]={},this.checkboxOrDropdown=!0,t[d._236[this.keywordIndex]][d._242[this.keywordIndex]][d._247[this.keywordIndex]]=1==this.keywordIndex?this.getCheckBoxSizeTypeEnumValue(e.formFieldData.sizeType):e.formFieldData.sizeType,t[d._236[this.keywordIndex]][d._242[this.keywordIndex]][d._248[this.keywordIndex]]=e.formFieldData.size,t[d._236[this.keywordIndex]][d._242[this.keywordIndex]][d._245[this.keywordIndex]]=a.a.getBoolInfo(e.formFieldData.defaultValue,this.keywordIndex),t[d._236[this.keywordIndex]][d._242[this.keywordIndex]][d._249[this.keywordIndex]]=a.a.getBoolInfo(e.formFieldData.checked,this.keywordIndex)):(t[d._236[this.keywordIndex]][d._243[this.keywordIndex]]={},this.checkboxOrDropdown=!0,t[d._236[this.keywordIndex]][d._243[this.keywordIndex]][d._250[this.keywordIndex]]=e.formFieldData.dropdownItems,t[d._236[this.keywordIndex]][d._243[this.keywordIndex]][d._251[this.keywordIndex]]=e.formFieldData.selectedIndex))),e.fieldCodeType&&""!==e.fieldCodeType&&(t.fieldCodeType=e.fieldCodeType);else if(e instanceof o.J)this.writeChart(e,t);else if(e instanceof o.r)t[d._224[this.keywordIndex]]=e.imageString,t[d._225[this.keywordIndex]]=e.metaFileImageString,t[d._228[this.keywordIndex]]=a.a.getBoolInfo(e.isMetaFile,this.keywordIndex),t[d._375[this.keywordIndex]]=e.isCompressed,t[d._204[this.keywordIndex]]=a.a.convertPixelToPoint(e.width),t[d._205[this.keywordIndex]]=a.a.convertPixelToPoint(e.height),e.isCrop&&(t[d._230[this.keywordIndex]]=e.bottom,t[d._231[this.keywordIndex]]=e.right,t[d._232[this.keywordIndex]]=e.left,t[d._229[this.keywordIndex]]=e.top,t[d._234[this.keywordIndex]]=e.cropWidthScale,t[d._233[this.keywordIndex]]=e.cropHeightScale),t[d._35[this.keywordIndex]]=e.name,t[d._200[this.keywordIndex]]=e.alternateText,t[d._272[this.keywordIndex]]=e.title,t[d._201[this.keywordIndex]]=a.a.getBoolInfo(e.visible,this.keywordIndex),t[d._206[this.keywordIndex]]=e.widthScale,t[d._207[this.keywordIndex]]=e.heightScale,t[d._310[this.keywordIndex]]=a.a.convertPixelToPoint(e.verticalPosition),t[d._309[this.keywordIndex]]=1==this.keywordIndex?this.getVerticalOriginEnumValue(e.verticalOrigin):e.verticalOrigin,t[d._114[this.keywordIndex]]=1==this.keywordIndex?this.getShapeVerticalAlignmentEnumValue(e.verticalAlignment):e.verticalAlignment,t[d._313[this.keywordIndex]]=a.a.convertPixelToPoint(e.horizontalPosition),t[d._311[this.keywordIndex]]=1==this.keywordIndex?this.getHorizontalOriginEnumValue(e.horizontalOrigin):e.horizontalOrigin,t[d._312[this.keywordIndex]]=1==this.keywordIndex?this.getShapeHorizontalAlignmentEnumValue(e.horizontalAlignment):e.horizontalAlignment,t[d._304[this.keywordIndex]]=a.a.getBoolInfo(e.allowOverlap,this.keywordIndex),t[d._210[this.keywordIndex]]=1==this.keywordIndex?this.getTextWrappingStyleEnumValue(e.textWrappingStyle):e.textWrappingStyle,t[d._211[this.keywordIndex]]=1==this.keywordIndex?this.getTextWrappingTypeEnumValue(e.textWrappingType):e.textWrappingType,t[d._202[this.keywordIndex]]=a.a.getBoolInfo(e.isBelowText,this.keywordIndex),i.i(s.isNullOrUndefined)(e.distanceBottom)||(t[d._308[this.keywordIndex]]=a.a.convertPixelToPoint(e.distanceBottom)),i.i(s.isNullOrUndefined)(e.distanceLeft)||(t[d._307[this.keywordIndex]]=a.a.convertPixelToPoint(e.distanceLeft)),i.i(s.isNullOrUndefined)(e.distanceRight)||(t[d._306[this.keywordIndex]]=a.a.convertPixelToPoint(e.distanceRight)),i.i(s.isNullOrUndefined)(e.distanceTop)||(t[d._305[this.keywordIndex]]=a.a.convertPixelToPoint(e.distanceTop)),t[d._217[this.keywordIndex]]=a.a.getBoolInfo(e.layoutInCell,this.keywordIndex),t[d._216[this.keywordIndex]]=e.zOrderPosition;else if(e instanceof o.e){if(t[d._337[this.keywordIndex]]=e.bookmarkType,t[d._35[this.keywordIndex]]=e.name,!i.i(s.isNullOrUndefined)(e.properties)){var r={};i.i(s.isNullOrUndefined)(e.properties.isAfterParagraphMark)||(r[d._378[this.keywordIndex]]=a.a.getBoolInfo(e.properties.isAfterParagraphMark,this.keywordIndex)),i.i(s.isNullOrUndefined)(e.properties.isAfterTableMark)||(r[d._383[this.keywordIndex]]=a.a.getBoolInfo(e.properties.isAfterTableMark,this.keywordIndex)),i.i(s.isNullOrUndefined)(e.properties.isAfterRowMark)||(r[d._380[this.keywordIndex]]=a.a.getBoolInfo(e.properties.isAfterRowMark,this.keywordIndex)),i.i(s.isNullOrUndefined)(e.properties.isAfterCellMark)||(r[d._379[this.keywordIndex]]=a.a.getBoolInfo(e.properties.isAfterCellMark,this.keywordIndex)),i.i(s.isNullOrUndefined)(e.properties.columnFirst)||(r[d._345[this.keywordIndex]]=e.properties.columnFirst),i.i(s.isNullOrUndefined)(e.properties.columnLast)||(r[d._346[this.keywordIndex]]=e.properties.columnLast),t[d._338[this.keywordIndex]]=r}}else if(e instanceof o.K)t[d._54[this.keywordIndex]]=1==this.keywordIndex?a.a.getBreakClearType(e.breakClearType):e.breakClearType;else if(e instanceof o.d){var l=e.text;if(this.isWriteEndFootNote||!i.i(s.isNullOrUndefined)(this.owner.editorModule)&&this.owner.editorModule.isPaste||(l=a.a.removeInvalidXmlChars(l)),this.isWriteInlinesFootNote&&0===e.indexInOwner&&0===e.line.indexInOwner&&0==e.paragraph.indexInOwner&&a.a.checkTextFormat(l)&&(l=""),-1!==l.indexOf(String.fromCharCode(30)))t[d._198[this.keywordIndex]]=l.replace(/\u001e/g,"-");else if(-1!==l.indexOf(String.fromCharCode(31)))t[d._198[this.keywordIndex]]=l.replace(/\u001f/g,"");else if(0!==e.revisions.length)if(this.isExport||!this.owner.enableTrackChanges||this.isPartialExport)t[d._198[this.keywordIndex]]=l;else{this.copyWithTrackChange=!0;for(var h=0;h<e.revisions.length;h++){var c=e.revisions[h];-1===this.selectedRevisionId.indexOf(c.revisionID)&&this.selectedRevisionId.push(c.revisionID),"Deletion"!==e.revisions[h].revisionType&&(t[d._198[this.keywordIndex]]=l)}}else t[d._198[this.keywordIndex]]=l}else if(e instanceof o.G)""!==e.user&&(t[d._347[this.keywordIndex]]=e.user),t[d._348[this.keywordIndex]]=e.group,t[d._345[this.keywordIndex]]=e.columnFirst,t[d._346[this.keywordIndex]]=e.columnLast,t[d._344[this.keywordIndex]]=e.editRangeId.toString();else if(e instanceof o.F)t[d._349[this.keywordIndex]]={},t[d._349[this.keywordIndex]][d._347[this.keywordIndex]]=e.editRangeStart.user,t[d._349[this.keywordIndex]][d._348[this.keywordIndex]]=e.editRangeStart.group,t[d._349[this.keywordIndex]][d._345[this.keywordIndex]]=e.editRangeStart.columnFirst,t[d._349[this.keywordIndex]][d._346[this.keywordIndex]]=e.editRangeStart.columnLast,t[d._344[this.keywordIndex]]=e.editRangeId.toString();else if(e instanceof o.B){if(!this.iscommentInsert)return;this.isExport||0!==e.commentType||this.selectedCommentsId.push(e.commentId),t[d._253[this.keywordIndex]]=e.commentType,t[d._252[this.keywordIndex]]=e.commentId}else e instanceof o.s?this.writeShape(e,t):t=void 0;return this.writeInlineRevisions(t,e),t},e.prototype.writeInlineRevisions=function(e,t){if(t.revisions.length>0&&(this.isExport||!this.isExport&&!this.owner.enableTrackChanges)){e[d._64[this.keywordIndex]]=[];for(var i=0;i<t.revisions.length;i++)-1===this.selectedRevisionId.indexOf(t.revisions[i].revisionID)&&this.selectedRevisionId.push(t.revisions[i].revisionID),e[d._64[this.keywordIndex]].push(t.revisions[i].revisionID)}},e.prototype.writeShape=function(e,t){if(t[d._199[this.keywordIndex]]=e.shapeId,t[d._35[this.keywordIndex]]=e.name,t[d._200[this.keywordIndex]]=e.alternateText,t[d._272[this.keywordIndex]]=e.title,t[d._201[this.keywordIndex]]=a.a.getBoolInfo(e.visible,this.keywordIndex),t[d._204[this.keywordIndex]]=a.a.convertPixelToPoint(e.width),t[d._205[this.keywordIndex]]=a.a.convertPixelToPoint(e.height),e.isZeroHeight?t[d._205[this.keywordIndex]]=0:t[d._205[this.keywordIndex]]=a.a.convertPixelToPoint(e.height),t[d._206[this.keywordIndex]]=e.widthScale,t[d._207[this.keywordIndex]]=e.heightScale,t[d._310[this.keywordIndex]]=a.a.convertPixelToPoint(e.verticalPosition),t[d._309[this.keywordIndex]]=1==this.keywordIndex?this.getVerticalOriginEnumValue(e.verticalOrigin):e.verticalOrigin,t[d._114[this.keywordIndex]]=1==this.keywordIndex?this.getShapeVerticalAlignmentEnumValue(e.verticalAlignment):e.verticalAlignment,t[d._212[this.keywordIndex]]=e.verticalRelativePercent,t[d._313[this.keywordIndex]]=a.a.convertPixelToPoint(e.horizontalPosition),t[d._311[this.keywordIndex]]=1==this.keywordIndex?this.getHorizontalOriginEnumValue(e.horizontalOrigin):e.horizontalOrigin,t[d._312[this.keywordIndex]]=1==this.keywordIndex?this.getShapeHorizontalAlignmentEnumValue(e.horizontalAlignment):e.horizontalAlignment,t[d._213[this.keywordIndex]]=e.horizontalRelativePercent,t[d._214[this.keywordIndex]]=e.heightRelativePercent,t[d._215[this.keywordIndex]]=e.widthRelativePercent,t[d._216[this.keywordIndex]]=e.zOrderPosition,t[d._304[this.keywordIndex]]=a.a.getBoolInfo(e.allowOverlap,this.keywordIndex),t[d._210[this.keywordIndex]]=1==this.keywordIndex?this.getTextWrappingStyleEnumValue(e.textWrappingStyle):e.textWrappingStyle,t[d._211[this.keywordIndex]]=1==this.keywordIndex?this.getTextWrappingTypeEnumValue(e.textWrappingType):e.textWrappingType,t[d._202[this.keywordIndex]]=a.a.getBoolInfo(e.isBelowText,this.keywordIndex),t[d._203[this.keywordIndex]]=a.a.getBoolInfo(e.isHorizontalRule,this.keywordIndex),i.i(s.isNullOrUndefined)(e.distanceBottom)||(t[d._308[this.keywordIndex]]=a.a.convertPixelToPoint(e.distanceBottom)),i.i(s.isNullOrUndefined)(e.distanceLeft)||(t[d._307[this.keywordIndex]]=a.a.convertPixelToPoint(e.distanceLeft)),i.i(s.isNullOrUndefined)(e.distanceRight)||(t[d._306[this.keywordIndex]]=a.a.convertPixelToPoint(e.distanceRight)),i.i(s.isNullOrUndefined)(e.distanceTop)||(t[d._305[this.keywordIndex]]=a.a.convertPixelToPoint(e.distanceTop)),t[d._217[this.keywordIndex]]=a.a.getBoolInfo(e.layoutInCell,this.keywordIndex),t[d._218[this.keywordIndex]]=a.a.getBoolInfo(e.lockAnchor,this.keywordIndex),t[d._219[this.keywordIndex]]=1==this.keywordIndex?this.getAutoShapeTypeEnumValue(e.autoShapeType):e.autoShapeType,e.fillFormat&&(t[d._209[this.keywordIndex]]={},t[d._209[this.keywordIndex]][d._221[this.keywordIndex]]=e.fillFormat.color,t[d._209[this.keywordIndex]][d._222[this.keywordIndex]]=a.a.getBoolInfo(e.fillFormat.fill,this.keywordIndex)),e.lineFormat&&(t[d._208[this.keywordIndex]]={},t[d._208[this.keywordIndex]][d._370[this.keywordIndex]]=1==this.keywordIndex?this.getLineFormatTypeEnumValue(e.lineFormat.lineFormatType):e.lineFormat.lineFormatType,t[d._208[this.keywordIndex]][d._221[this.keywordIndex]]=e.lineFormat.color,t[d._208[this.keywordIndex]][d._372[this.keywordIndex]]=e.lineFormat.weight,t[d._208[this.keywordIndex]][d._142[this.keywordIndex]]=1==this.keywordIndex?this.getLineDashStyleEnumValue(e.lineFormat.dashStyle):e.lineFormat.dashStyle,t[d._208[this.keywordIndex]][d._149[this.keywordIndex]]=a.a.getBoolInfo(e.lineFormat.line,this.keywordIndex)),e.textFrame){t[d._220[this.keywordIndex]]={},t[d._220[this.keywordIndex]][d._223[this.keywordIndex]]=1==this.keywordIndex?this.getTextVerticalAlignmentEnumValue(e.textFrame.textVerticalAlignment):e.textFrame.textVerticalAlignment,t[d._220[this.keywordIndex]][d._93[this.keywordIndex]]=a.a.convertPixelToPoint(e.textFrame.marginLeft),t[d._220[this.keywordIndex]][d._94[this.keywordIndex]]=a.a.convertPixelToPoint(e.textFrame.marginRight),t[d._220[this.keywordIndex]][d._95[this.keywordIndex]]=a.a.convertPixelToPoint(e.textFrame.marginTop),t[d._220[this.keywordIndex]][d._96[this.keywordIndex]]=a.a.convertPixelToPoint(e.textFrame.marginBottom),t[d._220[this.keywordIndex]][d._314[this.keywordIndex]]=[];for(var n=0;n<e.textFrame.childWidgets.length;n++){var r=e.textFrame.childWidgets[n];r.hasOwnProperty("contentControlProperties")&&!i.i(s.isNullOrUndefined)(e.paragraph)&&e.paragraph.hasOwnProperty("contentControlProperties")&&(this.blocks=[]),this.writeBlock(r,0,t[d._220[this.keywordIndex]][d._314[this.keywordIndex]])}}},e.prototype.writeChart=function(e,t){t[d._190[this.keywordIndex]]={},t[d._188[this.keywordIndex]]={},t[d._187[this.keywordIndex]]={},t[d._189[this.keywordIndex]]={},t[d._185[this.keywordIndex]]=[],t[d._186[this.keywordIndex]]=[],t[d._191[this.keywordIndex]]={},t[d._192[this.keywordIndex]]={},this.writeChartTitleArea(e.chartTitleArea,t[d._188[this.keywordIndex]]),this.writeChartArea(e.chartArea,t[d._187[this.keywordIndex]]),this.writeChartArea(e.chartPlotArea,t[d._189[this.keywordIndex]]),this.writeChartCategory(e,t[d._185[this.keywordIndex]]),this.createChartSeries(e,t[d._186[this.keywordIndex]]),this.writeChartLegend(e.chartLegend,t[d._190[this.keywordIndex]]),this.writeChartCategoryAxis(e.chartPrimaryCategoryAxis,t[d._191[this.keywordIndex]]),this.writeChartCategoryAxis(e.chartPrimaryValueAxis,t[d._192[this.keywordIndex]]),void 0!==e.chartDataTable.showSeriesKeys&&(t[d._197[this.keywordIndex]]={},this.writeChartDataTable(e.chartDataTable,t[d._197[this.keywordIndex]])),t[d._193[this.keywordIndex]]=e.title,t[d._194[this.keywordIndex]]=e.type,t[d._195[this.keywordIndex]]=e.chartGapWidth,t[d._196[this.keywordIndex]]=e.chartOverlap,t[d._205[this.keywordIndex]]=a.a.convertPixelToPoint(e.height),t[d._204[this.keywordIndex]]=a.a.convertPixelToPoint(e.width)},e.prototype.writeChartTitleArea=function(e,t){t[d._374[this.keywordIndex]]=e.chartfontName,t[d._48[this.keywordIndex]]=e.chartFontSize,t[d._144[this.keywordIndex]]={},t[d._145[this.keywordIndex]]=this.writeChartDataFormat(e.dataFormat),this.writeChartLayout(e.layout,t[d._144[this.keywordIndex]])},e.prototype.writeChartDataFormat=function(e){var t={};return t[d._222[this.keywordIndex]]={},t[d._149[this.keywordIndex]]={},i.i(s.isNullOrUndefined)(e.fill.color)||(e.fill.color.length>6?t[d._222[this.keywordIndex]][d._150[this.keywordIndex]]=e.fill.color.substring(2):t[d._222[this.keywordIndex]][d._150[this.keywordIndex]]=e.fill.color),t[d._222[this.keywordIndex]][d._368[this.keywordIndex]]=e.fill.rgb,t[d._149[this.keywordIndex]][d._221[this.keywordIndex]]=e.line.color,t[d._149[this.keywordIndex]][d._368[this.keywordIndex]]=e.line.rgb,t},e.prototype.writeChartLayout=function(e,t){t[d._152[this.keywordIndex]]=e.chartLayoutLeft,t[d._153[this.keywordIndex]]=e.chartLayoutTop},e.prototype.writeChartArea=function(e,t){t[d._150[this.keywordIndex]]=e.chartForeColor},e.prototype.writeChartLegend=function(e,t){t[d._340[this.keywordIndex]]=e.chartLegendPostion,t[d._188[this.keywordIndex]]={},this.writeChartTitleArea(e.chartTitleArea,t[d._188[this.keywordIndex]])},e.prototype.writeChartCategoryAxis=function(e,t){t[d._193[this.keywordIndex]]=e.categoryAxisTitle,t[d._188[this.keywordIndex]]={},this.writeChartTitleArea(e.chartTitleArea,t[d._188[this.keywordIndex]]),t[d._184[this.keywordIndex]]=e.categoryAxisType,t[d._48[this.keywordIndex]]=e.axisFontSize,t[d._374[this.keywordIndex]]=e.axisFontName,t[d._328[this.keywordIndex]]=e.categoryNumberFormat,t[d._361[this.keywordIndex]]=e.max,t[d._362[this.keywordIndex]]=e.min,t[d._360[this.keywordIndex]]=e.interval,t[d._363[this.keywordIndex]]=a.a.getBoolInfo(e.majorGridLines,this.keywordIndex),t[d._364[this.keywordIndex]]=a.a.getBoolInfo(e.minorGridLines,this.keywordIndex),t[d._365[this.keywordIndex]]=e.majorTick,t[d._366[this.keywordIndex]]=e.minorTick,t[d._367[this.keywordIndex]]=e.tickPosition},e.prototype.writeChartDataTable=function(e,t){t[d._180[this.keywordIndex]]=a.a.getBoolInfo(e.showSeriesKeys,this.keywordIndex),t[d._181[this.keywordIndex]]=a.a.getBoolInfo(e.hasHorzBorder,this.keywordIndex),t[d._182[this.keywordIndex]]=a.a.getBoolInfo(e.hasVertBorder,this.keywordIndex),t[d._183[this.keywordIndex]]=a.a.getBoolInfo(e.hasBorders,this.keywordIndex)},e.prototype.writeChartCategory=function(e,t){var i=e.chartCategory;t[d._147[this.keywordIndex]]=[];for(var n=0;n<i.length;n++){var r=i[n],o=this.createChartCategory(r,e.chartType);t.push(o)}},e.prototype.createChartCategory=function(e,t){var i={};return i[d._147[this.keywordIndex]]=[],this.writeChartData(e,i[d._147[this.keywordIndex]],t),i[d._148[this.keywordIndex]]=e.categoryXName,i},e.prototype.writeChartData=function(e,t,i){for(var n=e.chartData,r=0;r<n.length;r++){var o=n[r],s=this.createChartData(o,i);t.push(s)}},e.prototype.createChartData=function(e,t){var i={};return i[d._146[this.keywordIndex]]=e.yValue,"Bubble"===t&&(i[d._248[this.keywordIndex]]=e.size),i},e.prototype.createChartSeries=function(e,t){for(var i=e.chartSeries,n=e.chartType,r=0;r<i.length;r++){var o=i[r],s=this.writeChartSeries(o,n);t.push(s)}},e.prototype.writeChartSeries=function(e,t){var n="Pie"===t||"Doughnut"===t,r={},o={},a=e.errorBar;if(r[d._170[this.keywordIndex]]=[],r[d._165[this.keywordIndex]]=e.seriesName,n&&(i.i(s.isNullOrUndefined)(e.firstSliceAngle)||(r[d._171[this.keywordIndex]]=e.firstSliceAngle),"Doughnut"===t&&(r[d._172[this.keywordIndex]]=e.doughnutHoleSize)),!i.i(s.isNullOrUndefined)(e.dataLabels.labelPosition)){var l=this.writeChartDataLabels(e.dataLabels);r[d._166[this.keywordIndex]]=l}if(!i.i(s.isNullOrUndefined)(e.seriesFormat.markerStyle)){var h={},c=e.seriesFormat;h[d._157[this.keywordIndex]]=c.markerStyle,h[d._159[this.keywordIndex]]=c.numberValue,h[d._158[this.keywordIndex]]=c.markerColor,r[d._168[this.keywordIndex]]=h}if(i.i(s.isNullOrUndefined)(a.type)||(o[d._359[this.keywordIndex]]=a.type,o[d._154[this.keywordIndex]]=a.direction,o[d._155[this.keywordIndex]]=a.endStyle,o[d._156[this.keywordIndex]]=a.numberValue,r[d._167[this.keywordIndex]]=o),e.trendLines.length>0){r[d._169[this.keywordIndex]]=[];for(var p=0;p<e.trendLines.length;p++){var u=this.writeChartTrendLines(e.trendLines[p]);r[d._169[this.keywordIndex]].push(u)}}for(var p=0;p<e.chartDataFormat.length;p++){var c=this.writeChartDataFormat(e.chartDataFormat[p]);r[d._170[this.keywordIndex]].push(c)}return r},e.prototype.writeChartDataLabels=function(e){var t={};return t[d._340[this.keywordIndex]]=e.position,t[d._374[this.keywordIndex]]=e.fontName,t[d._49[this.keywordIndex]]=a.a.convertArgbToRgb(e.fontColor),t[d._48[this.keywordIndex]]=e.fontSize,t[d._173[this.keywordIndex]]=a.a.getBoolInfo(e.isLegendKey,this.keywordIndex),t[d._174[this.keywordIndex]]=a.a.getBoolInfo(e.isBubbleSize,this.keywordIndex),t[d._175[this.keywordIndex]]=a.a.getBoolInfo(e.isCategoryName,this.keywordIndex),t[d._176[this.keywordIndex]]=a.a.getBoolInfo(e.isSeriesName,this.keywordIndex),t[d._177[this.keywordIndex]]=a.a.getBoolInfo(e.isValue,this.keywordIndex),t[d._178[this.keywordIndex]]=a.a.getBoolInfo(e.isPercentage,this.keywordIndex),t[d._179[this.keywordIndex]]=a.a.getBoolInfo(e.isLeaderLines,this.keywordIndex),t},e.prototype.writeChartTrendLines=function(e){var t={};return t[d._35[this.keywordIndex]]=e.trendLineName,t[d._359[this.keywordIndex]]=e.trendLineType,t[d._160[this.keywordIndex]]=e.forwardValue,t[d._161[this.keywordIndex]]=e.backwardValue,t[d._162[this.keywordIndex]]=e.interceptValue,t[d._164[this.keywordIndex]]=a.a.getBoolInfo(e.isDisplayEquation,this.keywordIndex),t[d._163[this.keywordIndex]]=a.a.getBoolInfo(e.isDisplayRSquared,this.keywordIndex),t},e.prototype.writeLines=function(e,t,i,n){for(var r=t,s=this.endLine instanceof o.p&&this.endLine.paragraph===e,a=s?this.endLine.indexInOwner:e.childWidgets.length-1,l=r;l<=a;l++){var d=e.childWidgets[l];this.endLine===d||t===l&&0!==i?(this.endLine===d&&e.paragraphFormat.bidi&&this.startLine!==this.endLine&&(this.endOffset=d.getEndOffset()),this.writeLine(d,this.startLine!==this.endLine&&d!==this.startLine?0:i,n)):this.writeInlines(e,d,n)}return s},e.prototype.writeLine=function(e,t,n){this.contentInline=[];for(var r=!1,a=!1,l=e===this.endLine,h=e,c=!1,p=!1,u=0,g=0;g<h.children.length;g++){var f=h.children[g];if(!(f instanceof o.q)){var m=void 0;if(u+=f.length,c=u>t,f instanceof o.H&&(c||(r=0===f.type),a=!0),f instanceof o.d&&f.hasOwnProperty("contentControlProperties")&&c&&!a&&(r=!0),f instanceof o.H&&(r&&1===f.type&&(r=!1),a&&1===f.type&&(a=!1)),p=l&&u>=this.endOffset,c&&!r)if(f instanceof o.H||this.startContent||this.blockContent){if(p){this.startContent=!1;break}this.writeInlinesContentControl(f,e,n,g)}else{if(m=this.writeInline(f),!i.i(s.isNullOrUndefined)(m)&&(n[n.length]=m,u>t||p)){if(m.hasOwnProperty(d._198[this.keywordIndex])){var v=u-f.length,y=t-v,w=p?this.endOffset-v:f.length;m[d._198[this.keywordIndex]]=m[d._198[this.keywordIndex]].substring(y,w)}t=-1}if(p)break}}}},e.prototype.writeInlinesFootNote=function(e,t,i,n){this.isWriteInlinesFootNote=!0;var r={};r[d._263[this.keywordIndex]]=1==this.keywordIndex?this.getFootnoteTypeEnumValue(t.footnoteType):t.footnoteType,r[d._4[this.keywordIndex]]={},r[d._4[this.keywordIndex]]=this.writeCharacterFormat(t.characterFormat),r[d._314[this.keywordIndex]]=[];for(var o=0;o<t.bodyWidget.childWidgets.length;o++)this.writeBlock(t.bodyWidget.childWidgets[o],0,r[d._314[this.keywordIndex]]);return r[d._264[this.keywordIndex]]=t.symbolCode,r[d._265[this.keywordIndex]]=t.symbolFontName,r[d._266[this.keywordIndex]]=t.customMarker,this.writeInlineRevisions(r,t),this.isWriteInlinesFootNote=!1,r},e.prototype.writeInlinesContentControl=function(e,t,n,r){if(e instanceof o.H&&"Block"===e.contentControlWidgetType)return this.isBlockClosed=!1,this.blockContent&&0===e.type?(this.nestedBlockContent=!0,!0):this.nestedBlockContent&&1===e.type?(this.nestedBlockContent=!1,!0):(this.blockContent=0===e.type,t.children[r-1]instanceof o.H&&"Block"===t.children[r-1].contentControlWidgetType&&(this.blockContent=!0),this.blockContent||(this.isBlockClosed=!0),!0);if(e instanceof o.H){if(this.startContent&&0===e.type)return this.nestedContent=!0,!0;if(this.startContent&&this.nestedContent){var a={};if(a[d._267[this.keywordIndex]]=this.contentInline,this.contentInline.length>0){var l=this.nestedContentProperty(t.children[r+1],a);n.push(l),this.contentInline=[]}return this.multipleLineContent&&(a=n[n.length-1],this.nestedContentProperty(t.children[r+1],a),this.multipleLineContent=!1),this.nestedContent=!1,!0}return this.contentType=e.contentControlWidgetType,this.startContent=0===e.type,!0}if(this.startContent&&"Inline"===this.contentType)if(this.multipleLineContent)this.inlineContentControl(e,t.children[r+1],n),this.contentInline=[];else{var h=this.inlineContentControl(e,t.children[r+1]);if(!i.i(s.isNullOrUndefined)(h)){if(!this.nestedContent||!this.multipleLineContent)return n.push(h),this.contentInline=[],!1;var a={};a[d._267[this.keywordIndex]]=this.contentInline,n.push(a),this.contentInline=[]}}else{var a=this.writeInline(e);i.i(s.isNullOrUndefined)(a)||n.push(a)}},e.prototype.createParagraph=function(e){var t={},o=!1,a=!1;if(!this.documentHelper.selection||this.documentHelper.selection.isEmpty||this.isExport)o=!0;else{var l=this.documentHelper.selection.end;this.documentHelper.selection.isForward||(l=this.documentHelper.selection.start);var h=l.paragraph.childWidgets[l.paragraph.childWidgets.length-1];a=!i.i(s.isNullOrUndefined)(e.paragraphFormat.listFormat.list),o=this.documentHelper.selection.isParagraphLastLine(h)&&l.currentWidget===h&&(l.offset===this.documentHelper.selection.getLineLength(h)+1||!(e.indexInOwner==l.paragraph.indexInOwner)&&a)}return t[d._5[this.keywordIndex]]=this.writeParagraphFormat(o?e.paragraphFormat:new n.a(e)),t[d._4[this.keywordIndex]]=this.writeCharacterFormat(o?e.characterFormat:new r.c(e)),t[d._267[this.keywordIndex]]=[],t},e.prototype.writeCharacterFormat=function(e,t){var i={};if(a.a.writeCharacterFormat(i,t,e,this.keywordIndex),i[d._57[this.keywordIndex]]=t?a.a.getBoolInfo(e.boldBidi,this.keywordIndex):e.getValue("boldBidi"),i[d._58[this.keywordIndex]]=t?a.a.getBoolInfo(e.italicBidi,this.keywordIndex):e.getValue("italicBidi"),i[d._55[this.keywordIndex]]=t?e.fontSizeBidi:e.getValue("fontSizeBidi"),e.revisions.length>0){i[d._64[this.keywordIndex]]=[];for(var n=0;n<e.revisions.length;n++)i[d._64[this.keywordIndex]].push(e.revisions[n].revisionID)}return this.writeInlineStyles&&!t&&(i[d._373[this.keywordIndex]]=this.writeCharacterFormat(e,!0)),i},e.prototype.writeParagraphFormat=function(e,t){var n={};return this.keywordIndex=i.i(s.isNullOrUndefined)(this.keywordIndex)?0:this.keywordIndex,a.a.writeParagraphFormat(n,t,e,this.keywordIndex),n[d._79[this.keywordIndex]]=this.writeListFormat(e.listFormat,t),n[d._86[this.keywordIndex]]=this.writeTabs(e.tabs),this.writeInlineStyles&&!t&&(n[d._373[this.keywordIndex]]=this.writeParagraphFormat(e,!0)),n},e.prototype.writeThemes=function(e){var t={};return t[d._351[this.keywordIndex]]={},t[d._351[this.keywordIndex]][d._352[this.keywordIndex]]=e.fontScheme.fontSchemeName,t[d._351[this.keywordIndex]][d._353[this.keywordIndex]]=this.writeMajorMinorFontScheme(e.fontScheme.majorFontScheme),t[d._351[this.keywordIndex]][d._354[this.keywordIndex]]=this.writeMajorMinorFontScheme(e.fontScheme.minorFontScheme),t},e.prototype.writeMajorMinorFontScheme=function(e){var t={};t[d._355[this.keywordIndex]]=this.writeFontSchemeList(e.fontSchemeList);for(var i=e.fontTypeface.keys,n={},r=0,o=i;r<o.length;r++){var s=o[r];n[s]=e.fontTypeface.get(s)}return t[d._356[this.keywordIndex]]=n,t},e.prototype.writeFontSchemeList=function(e){var t=this,i=[];return e.forEach(function(e){var n={};n[d._35[t.keywordIndex]]=e.name,n[d._357[t.keywordIndex]]=e.typeface,n[d._358[t.keywordIndex]]=e.panose,i.push(n)}),i},e.prototype.writeTabs=function(e){if(!(i.i(s.isNullOrUndefined)(e)||e.length<1)){for(var t=[],n=0;n<e.length;n++){var r=e[n],o={};o[d._340[this.keywordIndex]]=r.position,o[d._341[this.keywordIndex]]=r.deletePosition,o[d._339[this.keywordIndex]]=1==this.keywordIndex?this.getTabJustificationEnumValue(r.tabJustification):r.tabJustification,o[d._343[this.keywordIndex]]=1==this.keywordIndex?this.getTabLeaderEnumValue(r.tabLeader):r.tabLeader,t.push(o)}return t}},e.prototype.writeListFormat=function(e,t){var n={},r=e.getValue("listId");i.i(s.isNullOrUndefined)(r)||(n[d._65[this.keywordIndex]]=r,i.i(s.isNullOrUndefined)(this.lists)&&(this.lists=[]),this.lists.indexOf(e.listId)<0&&this.lists.push(e.listId));var o=e.getValue("listLevelNumber");i.i(s.isNullOrUndefined)(o)||(n[d._68[this.keywordIndex]]=o);var a=e.getValue("nsid");return i.i(s.isNullOrUndefined)(a)||(n[d._330]=a),n},e.prototype.writeTable=function(e,t,i,n){var r=e.childWidgets[i];if(!(r instanceof o.z&&this.writeRow(r,t[d._298[this.keywordIndex]]))){var s=e;do{e=s,s=e.nextSplitWidget}while(s instanceof o.C);return s=e.nextRenderedWidget,s instanceof o.C&&s.containerWidget.index===e.containerWidget.index?s:void 0}},e.prototype.writeRow=function(e,t){var i=e;do{if(e=i,i=this.writeRowInternal(i,t),e===i)return!0}while(i instanceof o.z);return!1},e.prototype.writeRowInternal=function(e,t){if(!(e instanceof o.z))return e;e.isCellsHaveSameWidthUnit()||e.updateUniformWidthUnitForCells();var n=this.createRow(e);t.push(n);for(var r=0;r<e.childWidgets.length;r++){var a=e.childWidgets[r];if(a instanceof o.j&&e.index===a.rowIndex&&(i.i(s.isNullOrUndefined)(this.startColumnIndex)||a.columnIndex>=this.startColumnIndex)&&(i.i(s.isNullOrUndefined)(this.endColumnIndex)||a.columnIndex<this.endColumnIndex)&&this.writeCell(a,n[d._297[this.keywordIndex]]))return e}var l=e;do{e=l,l=e.nextRenderedWidget,!i.i(s.isNullOrUndefined)(e.ownerTable.bodyWidget)&&l&&(e.ownerTable.index!==l.ownerTable.index&&e.ownerTable.bodyWidget.sectionIndex===l.ownerTable.bodyWidget.sectionIndex||e.ownerTable.bodyWidget.sectionIndex!==l.ownerTable.bodyWidget.sectionIndex)&&(l=void 0)}while(l instanceof o.z&&l.index===e.index);return l},e.prototype.writeCell=function(e,t){var i=this.createCell(e);t.push(i);var n=e.firstChild;do{n=this.writeBlock(n,0,i[d._314[this.keywordIndex]])}while(n);return this.endCell instanceof o.j&&this.endCell.cellFormat===e.cellFormat},e.prototype.createTable=function(e){var t={};i.i(s.isNullOrUndefined)(this.keywordIndex)&&(this.keywordIndex=0),t[d._298[this.keywordIndex]]=[],t[d._381[this.keywordIndex]]=[];for(var n=0;n<e.tableHolder.columns.length;n++)t[d._381[this.keywordIndex]][n]=e.tableHolder.columns[n].preferredWidth;return t[d._303[this.keywordIndex]]=this.writeTableFormat(e.tableFormat,this.keywordIndex),t[d._299[this.keywordIndex]]=e.tableFormat.description,t[d._272[this.keywordIndex]]=e.tableFormat.title,t[d._382[this.keywordIndex]]=e.tableHolder.columns.length,this.writeTablePositioning(t,e),t},e.prototype.writeTablePositioning=function(e,t){t.wrapTextAround&&(e[d._300[this.keywordIndex]]=a.a.getBoolInfo(t.wrapTextAround,this.keywordIndex),e[d._302[this.keywordIndex]]={},e[d._302[this.keywordIndex]][d._304[this.keywordIndex]]=a.a.getBoolInfo(t.positioning.allowOverlap,this.keywordIndex),i.i(s.isNullOrUndefined)(t.positioning.distanceBottom)||(e[d._302[this.keywordIndex]][d._308[this.keywordIndex]]=a.a.convertPixelToPoint(t.positioning.distanceBottom)),i.i(s.isNullOrUndefined)(t.positioning.distanceLeft)||(e[d._302[this.keywordIndex]][d._307[this.keywordIndex]]=a.a.convertPixelToPoint(t.positioning.distanceLeft)),i.i(s.isNullOrUndefined)(t.positioning.distanceRight)||(e[d._302[this.keywordIndex]][d._306[this.keywordIndex]]=a.a.convertPixelToPoint(t.positioning.distanceRight)),i.i(s.isNullOrUndefined)(t.positioning.distanceTop)||(e[d._302[this.keywordIndex]][d._305[this.keywordIndex]]=a.a.convertPixelToPoint(t.positioning.distanceTop)),i.i(s.isNullOrUndefined)(t.positioning.verticalAlignment)||(e[d._302[this.keywordIndex]][d._114[this.keywordIndex]]=1==this.keywordIndex?this.getTableVerticalPositionEnumValue(t.positioning.verticalAlignment):t.positioning.verticalAlignment),i.i(s.isNullOrUndefined)(t.positioning.verticalOrigin)||(e[d._302[this.keywordIndex]][d._309[this.keywordIndex]]=1==this.keywordIndex?this.getTableVerticalRelationEnumValue(t.positioning.verticalOrigin):t.positioning.verticalOrigin),e[d._302[this.keywordIndex]][d._310[this.keywordIndex]]=t.positioning.verticalPosition,i.i(s.isNullOrUndefined)(t.positioning.horizontalAlignment)||(e[d._302[this.keywordIndex]][d._312[this.keywordIndex]]=1==this.keywordIndex?this.getTableHorizontalPositionEnumValue(t.positioning.horizontalAlignment):t.positioning.horizontalAlignment),i.i(s.isNullOrUndefined)(t.positioning.horizontalOrigin)||(e[d._302[this.keywordIndex]][d._311[this.keywordIndex]]=1==this.keywordIndex?this.getTableHorizontalRelationEnumValue(t.positioning.horizontalOrigin):t.positioning.horizontalOrigin),e[d._302[this.keywordIndex]][d._313[this.keywordIndex]]=t.positioning.horizontalPosition)},e.prototype.createRow=function(e){var t={};return t[d._297[this.keywordIndex]]=[],t[d._296[this.keywordIndex]]=this.writeRowFormat(e.rowFormat,this.keywordIndex),e.hasOwnProperty("contentControlProperties")&&(t[d._268[this.keywordIndex]]=this.contentControlProperty(e.contentControlProperties)),t},e.prototype.createCell=function(e){var t={};return t[d._314[this.keywordIndex]]=[],t[d._295[this.keywordIndex]]=this.writeCellFormat(e.cellFormat,this.keywordIndex),t[d._376[this.keywordIndex]]=e.columnIndex,e.hasOwnProperty("contentControlProperties")&&(t[d._268[this.keywordIndex]]=this.contentControlProperty(e.contentControlProperties)),t},e.prototype.writeShading=function(e,t){var i={};return i[d._134[t]]=e.hasValue("backgroundColor")?e.backgroundColor:void 0,i[d._135[t]]=e.hasValue("foregroundColor")?e.foregroundColor:void 0,i[d._133[t]]=e.hasValue("textureStyle")?1==t?this.getTextureStyleEnumValue(e.textureStyle):e.textureStyle:void 0,i},e.prototype.writeBorders=function(e,t){var i={};return i[d._229[t]]=a.a.writeBorder(e.top,t),i[d._232[t]]=a.a.writeBorder(e.left,t),i[d._231[t]]=a.a.writeBorder(e.right,t),i[d._230[t]]=a.a.writeBorder(e.bottom,t),i[d._141[t]]=a.a.writeBorder(e.diagonalDown,t),i[d._140[t]]=a.a.writeBorder(e.diagonalUp,t),i[d._139[t]]=a.a.writeBorder(e.horizontal,t),i[d._138[t]]=a.a.writeBorder(e.vertical,t),i},e.prototype.writeCellFormat=function(e,t){var i={};return i[d._85[t]]=this.writeBorders(e.borders,t),i[d._128[t]]=this.writeShading(e.shading,t),i[d._95[t]]=e.hasValue("topMargin")?e.topMargin:void 0,i[d._94[t]]=e.hasValue("rightMargin")?e.rightMargin:void 0,i[d._93[t]]=e.hasValue("leftMargin")?e.leftMargin:void 0,i[d._96[t]]=e.hasValue("bottomMargin")?e.bottomMargin:void 0,i[d._130[t]]=e.hasValue("preferredWidth")?e.preferredWidth:void 0,i[d._131[t]]=e.hasValue("preferredWidthType")?1==t?this.getWidthTypeEnumValue(e.preferredWidthType):e.preferredWidthType:void 0,i[d._111[t]]=e.hasValue("cellWidth")?e.cellWidth:void 0,i[d._112[t]]=e.columnSpan,i[d._113[t]]=e.rowSpan,i[d._114[t]]=e.hasValue("verticalAlignment")?1==t?this.getCellVerticalAlignmentEnumValue(e.verticalAlignment):e.verticalAlignment:void 0,i},e.prototype.writeRowFormat=function(e,t){var i={},n=[];this.assignRowFormat(i,e,t);for(var r=0;r<e.revisions.length;r++)i[d._64[t]]=this.writeRowRevisions(e.revisions[r],n);return i},e.prototype.assignRowFormat=function(e,t,i){e[d._205[i]]=t.hasValue("height")?t.height:void 0,e[d._115[i]]=t.hasValue("allowBreakAcrossPages")?a.a.getBoolInfo(t.allowBreakAcrossPages,this.keywordIndex):void 0,e[d._117[i]]=t.hasValue("heightType")?1==this.keywordIndex?this.getHeighTypeEnumValue(t.heightType):t.heightType:void 0,e[d._116[i]]=t.hasValue("isHeader")?a.a.getBoolInfo(t.isHeader,this.keywordIndex):void 0,e[d._85[i]]=this.writeBorders(t.borders,i),e[d._120[i]]=t.gridBefore,e[d._121[i]]=t.hasValue("gridBeforeWidth")?t.gridBeforeWidth:void 0,e[d._122[i]]=t.hasValue("gridBeforeWidthType")?1==this.keywordIndex?this.getWidthTypeEnumValue(t.gridBeforeWidthType):t.gridBeforeWidthType:void 0,e[d._123[i]]=t.gridAfter,e[d._124[i]]=t.hasValue("gridAfterWidth")?t.gridAfterWidth:void 0,e[d._125[i]]=t.hasValue("gridAfterWidthType")?1==this.keywordIndex?this.getWidthTypeEnumValue(t.gridAfterWidthType):t.gridAfterWidthType:void 0,e[d._93[i]]=t.hasValue("leftMargin")?t.leftMargin:void 0,e[d._95[i]]=t.hasValue("topMargin")?t.topMargin:void 0,e[d._94[i]]=t.hasValue("rightMargin")?t.rightMargin:void 0,e[d._96[i]]=t.hasValue("bottomMargin")?t.bottomMargin:void 0,e[d._69[i]]=t.hasValue("leftIndent")?t.leftIndent:void 0},e.prototype.writeRowRevisions=function(e,t){return-1===this.selectedRevisionId.indexOf(e.revisionID)&&this.selectedRevisionId.push(e.revisionID),t.push(e.revisionID),t},e.prototype.writeTableFormat=function(e,t){var n={};return n[d._85[t]]=this.writeBorders(e.borders,t),n[d._128[t]]=this.writeShading(e.shading,t),n[d._127[t]]=e.hasValue("cellSpacing")?e.cellSpacing:void 0,n[d._69[t]]=e.hasValue("leftIndent")?e.leftIndent:void 0,n[d._129[t]]=e.hasValue("tableAlignment")?1==this.keywordIndex?this.getTableAlignmentEnumValue(e.tableAlignment):e.tableAlignment:void 0,n[d._95[t]]=e.hasValue("topMargin")?e.topMargin:void 0,n[d._94[t]]=e.hasValue("rightMargin")?e.rightMargin:void 0,n[d._93[t]]=e.hasValue("leftMargin")?e.leftMargin:void 0,n[d._96[t]]=e.hasValue("bottomMargin")?e.bottomMargin:void 0,n[d._130[t]]=e.hasValue("preferredWidth")?e.preferredWidth:void 0,n[d._131[t]]=e.hasValue("preferredWidthType")?1==this.keywordIndex?this.getWidthTypeEnumValue(e.preferredWidthType):e.preferredWidthType:void 0,n[d._52[t]]=e.hasValue("bidi")?a.a.getBoolInfo(e.bidi,this.keywordIndex):void 0,n[d._126[t]]=e.hasValue("allowAutoFit")?a.a.getBoolInfo(e.allowAutoFit,this.keywordIndex):void 0,n[d._51[t]]=i.i(s.isNullOrUndefined)(e.styleName)?void 0:e.styleName,n},e.prototype.footnotes=function(e){this.isWriteEndFootNote=!0;for(var t=0;t<e.footnotes.separator.length;t++)this.seprators(e);this.isWriteEndFootNote=!1},e.prototype.seprators=function(e){if(e.footnotes.separator.length>0){this.document[d._30[this.keywordIndex]]={},this.document[d._30[this.keywordIndex]][d._334[this.keywordIndex]]=[];for(var t=0;t<e.footnotes.separator.length;t++)this.writeBlock(e.footnotes.separator[t],0,this.document[d._30[this.keywordIndex]][d._334[this.keywordIndex]])}if(e.footnotes.continuationSeparator.length>0){this.document[d._30[this.keywordIndex]][d._335[this.keywordIndex]]=[];for(var t=0;t<e.footnotes.continuationSeparator.length;t++)this.writeBlock(e.footnotes.continuationSeparator[t],0,this.document[d._30[this.keywordIndex]][d._335[this.keywordIndex]])}if(e.footnotes.continuationNotice.length>0){this.document[d._30[this.keywordIndex]][d._336[this.keywordIndex]]=[];for(var t=0;t<e.footnotes.continuationNotice.length;t++)this.writeBlock(e.footnotes.continuationNotice[t],0,this.document[d._30[this.keywordIndex]][d._336[this.keywordIndex]])}},e.prototype.endnotes=function(e){this.isWriteEndFootNote=!0;for(var t=0;t<this.documentHelper.endnotes.separator.length;t++)this.endnoteSeparator(e);this.isWriteEndFootNote=!1},e.prototype.endnoteSeparator=function(e){if(e.endnotes.separator.length>0){this.document[d._31[this.keywordIndex]]={},this.document[d._31[this.keywordIndex]][d._334[this.keywordIndex]]=[];for(var t=0;t<e.endnotes.separator.length;t++)this.writeBlock(e.endnotes.separator[t],0,this.document[d._31[this.keywordIndex]][d._334[this.keywordIndex]])}if(e.endnotes.continuationSeparator.length>0){this.document[d._31[this.keywordIndex]][d._335[this.keywordIndex]]=[];for(var t=0;t<e.endnotes.continuationSeparator.length;t++)this.writeBlock(e.endnotes.continuationSeparator[t],0,this.document[d._31[this.keywordIndex]][d._335[this.keywordIndex]])}if(e.endnotes.continuationNotice.length>0){this.document[d._31[this.keywordIndex]][d._336[this.keywordIndex]]=[];for(var t=0;t<e.endnotes.continuationNotice.length;t++)this.writeBlock(e.endnotes.continuationNotice[t],0,this.document[d._31[this.keywordIndex]][d._336[this.keywordIndex]])}},e.prototype.writeStyles=function(e){this.document[d._9[this.keywordIndex]]=[];for(var t=0;t<e.styles.length;t++)this.document[d._9[this.keywordIndex]].push(this.writeStyle(e.styles.getItem(t)))},e.prototype.writeStyle=function(e){var t={};return t[d._35[this.keywordIndex]]=e.name,"Paragraph"===e.type&&(t[d._359[this.keywordIndex]]=1==this.keywordIndex?this.getStyleTypeEnumValue(e.type):e.type,t[d._5[this.keywordIndex]]=this.writeParagraphFormat(e.paragraphFormat),t[d._4[this.keywordIndex]]=this.writeCharacterFormat(e.characterFormat)),"Character"===e.type&&(t[d._359[this.keywordIndex]]=1==this.keywordIndex?this.getStyleTypeEnumValue(e.type):e.type,t[d._4[this.keywordIndex]]=this.writeCharacterFormat(e.characterFormat)),i.i(s.isNullOrUndefined)(e.basedOn)||(t[d._36[this.keywordIndex]]=e.basedOn.name),i.i(s.isNullOrUndefined)(e.link)||(t[d._38[this.keywordIndex]]=e.link.name),i.i(s.isNullOrUndefined)(e.next)||(t[d._37[this.keywordIndex]]=e.next.name),t},e.prototype.writeRevisions=function(e){this.document[d._11[this.keywordIndex]]=[];for(var t=0;t<e.owner.revisions.changes.length;t++)(this.isExport||!this.isExport&&!this.owner.enableTrackChanges&&-1!==this.selectedRevisionId.indexOf(e.owner.revisions.changes[t].revisionID))&&this.document[d._11[this.keywordIndex]].push(this.writeRevision(e.owner.revisions.changes[t]))},e.prototype.writeRevision=function(e){var t={};return t[d._254[this.keywordIndex]]=e.author,t[d._256[this.keywordIndex]]=e.date,t[d._259[this.keywordIndex]]=1==this.keywordIndex?this.getRevisionTypeEnumValue(e.revisionType):e.revisionType,t[d._260[this.keywordIndex]]=e.revisionID,t},e.prototype.writeComments=function(e){this.document[d._10[this.keywordIndex]]=[];for(var t=0;t<e.comments.length;t++)(this.isExport||!this.isExport&&-1!==this.selectedCommentsId.indexOf(this.documentHelper.comments[t].commentId))&&this.document[d._10[this.keywordIndex]].push(this.writeComment(this.documentHelper.comments[t]))},e.prototype.writeCustomXml=function(e){this.document[d._12[this.keywordIndex]]=[];for(var t=0;t<e.customXmlData.length;t++){var i={},n=e.customXmlData.keys[t];i[d._261[this.keywordIndex]]=n;var r=this.documentHelper.customXmlData.get(n);i[d._262[this.keywordIndex]]=r,this.document[d._12[this.keywordIndex]].push(i)}},e.prototype.writeImages=function(e){var t=this;this.document[d._377[this.keywordIndex]]={},e.images.keys.forEach(function(e){var i=t.documentHelper.images.get(e);t.document[d._377[t.keywordIndex]][e]=i})},e.prototype.writeComment=function(e){var t={};t[d._252[this.keywordIndex]]=e.commentId,t[d._254[this.keywordIndex]]=e.author,t[d._256[this.keywordIndex]]=e.date,t[d._314[this.keywordIndex]]=[],t[d._314[this.keywordIndex]].push(this.commentInlines(e.text)),t[d._257[this.keywordIndex]]=a.a.getBoolInfo(e.isResolved,this.keywordIndex),t[d._258[this.keywordIndex]]=[];for(var i=0;i<e.replyComments.length;i++)t[d._258[this.keywordIndex]].push(this.writeComment(e.replyComments[i]));return t},e.prototype.commentInlines=function(e){var t={};t[d._267[this.keywordIndex]]=[];var i={};return i[d._198[this.keywordIndex]]=e,t[d._267[this.keywordIndex]].push(i),t},e.prototype.writeLists=function(e){var t=[];this.document[d._6[this.keywordIndex]]=[];for(var i=0;i<e.lists.length;i++){var n=e.lists[i];this.lists.indexOf(n.listId)>-1&&(this.document[d._6[this.keywordIndex]].push(this.writeList(n)),t.indexOf(n.abstractListId)<0&&t.push(n.abstractListId))}this.document[d._7[this.keywordIndex]]=[];for(var i=0;i<e.abstractLists.length;i++){var r=e.abstractLists[i];t.indexOf(r.abstractListId)>-1&&this.document[d._7[this.keywordIndex]].push(this.writeAbstractList(r))}},e.prototype.writeAbstractList=function(e){var t={};t[d._329[this.keywordIndex]]=e.abstractListId,t[d._330]=e.nsid,t[d._331[this.keywordIndex]]=[];for(var i=0;i<e.levels.length;i++)t[d._331[this.keywordIndex]][i]=this.writeListLevel(e.levels[i]);return t},e.prototype.writeList=function(e){var t={};if(!i.i(s.isNullOrUndefined)(e)){t[d._329[this.keywordIndex]]=e.abstractListId,t[d._333[this.keywordIndex]]=[];for(var n=0;n<e.levelOverrides.length;n++)t[d._333[this.keywordIndex]].push(this.writeLevelOverrides(e.levelOverrides[n]));t[d._65[this.keywordIndex]]=e.listId,t[d._330]=e.nsid}return t},e.prototype.writeLevelOverrides=function(e){var t={};return t[d._327[this.keywordIndex]]=e.levelNumber,e.overrideListLevel&&(t[d._332[this.keywordIndex]]=this.writeListLevel(e.overrideListLevel)),t[d._325[this.keywordIndex]]=e.startAt,t},e.prototype.writeListLevel=function(e){var t={};return t[d._4[this.keywordIndex]]=this.writeCharacterFormat(e.characterFormat),t[d._5[this.keywordIndex]]=this.writeParagraphFormat(e.paragraphFormat),t[d._301[this.keywordIndex]]=a.a.getBoolInfo(e.isLegalStyleNumbering,this.keywordIndex),t[d._324[this.keywordIndex]]=1==this.keywordIndex?this.getFollowCharacterType(e.followCharacter):e.followCharacter,t[d._323[this.keywordIndex]]=1==this.keywordIndex?this.getListLevelPatternEnumValue(e.listLevelPattern):e.listLevelPattern,t[d._328[this.keywordIndex]]=e.numberFormat,t[d._326[this.keywordIndex]]=e.restartLevel,t[d._325[this.keywordIndex]]=e.startAt,t},e.prototype.getParentBlock=function(e){return e.isInsideTable&&(e=this.owner.documentHelper.layout.getParentTable(e)),e},e.prototype.getParentCell=function(e){for(;e.ownerTable.isInsideTable;)e=e.ownerTable.associatedCell;return e},e.prototype.getWidthTypeEnumValue=function(e){switch(e){case"Auto":return 0;case"Percent":return 1;case"Point":return 2}},e.prototype.getTableAlignmentEnumValue=function(e){switch(e){case"Left":return 0;case"Center":return 1;case"Right":return 2}},e.prototype.getTextureStyleEnumValue=function(e){switch(e){case"TextureNone":return 0;case"Texture2Pt5Percent":return 1;case"Texture5Percent":return 2;case"Texture7Pt5Percent":return 3;case"Texture10Percent":return 4;case"Texture12Pt5Percent":return 5;case"Texture15Percent":return 6;case"Texture17Pt5Percent":return 7;case"Texture20Percent":return 8;case"Texture22Pt5Percent":return 9;case"Texture25Percent":return 10;case"Texture27Pt5Percent":return 11;case"Texture30Percent":return 12;case"Texture32Pt5Percent":return 13;case"Texture35Percent":return 14;case"Texture37Pt5Percent":return 15;case"Texture40Percent":return 16;case"Texture42Pt5Percent":return 17;case"Texture45Percent":return 18;case"Texture47Pt5Percent":return 19;case"Texture50Percent":return 20;case"Texture52Pt5Percent":return 21;case"Texture55Percent":return 22;case"Texture57Pt5Percent":return 23;case"Texture60Percent":return 24;case"Texture62Pt5Percent":return 25;case"Texture65Percent":return 26;case"Texture67Pt5Percent":return 27;case"Texture70Percent":return 28;case"Texture72Pt5Percent":return 29;case"Texture75Percent":return 30;case"Texture77Pt5Percent":return 31;case"Texture80Percent":return 32;case"Texture82Pt5Percent":return 33;case"Texture85Percent":return 34;case"Texture87Pt5Percent":return 35;case"Texture90Percent":return 36;case"Texture92Pt5Percent":return 37;case"Texture95Percent":return 38;case"Texture97Pt5Percent":return 39;case"TextureSolid":return 40;case"TextureDarkHorizontal":return 41;case"TextureDarkVertical":return 42;case"TextureDarkDiagonalDown":return 43;case"TextureDarkDiagonalUp":return 44;case"TextureDarkCross":return 45;case"TextureDarkDiagonalCross":return 46;case"TextureHorizontal":return 47;case"TextureVertical":return 48;case"TextureDiagonalDown":return 49;case"TextureDiagonalUp":return 50;case"TextureCross":return 51;case"TextureDiagonalCross":return 52}},e.prototype.getHeighTypeEnumValue=function(e){switch(e){case"AtLeast":return 0;case"Exactly":return 1;default:return 0}},e.prototype.getCellVerticalAlignmentEnumValue=function(e){switch(e){case"Top":return 0;case"Center":return 1;case"Bottom":return 2}},e.prototype.getListLevelPatternEnumValue=function(e){switch(e){case"None":return 0;case"KanjiDigit":case"Arabic":return 1;case"UpRoman":return 2;case"LowRoman":return 3;case"UpLetter":return 4;case"LowLetter":return 5;case"Ordinal":return 6;case"Number":return 7;case"OrdinalText":return 8;case"LeadingZero":return 9;case"Bullet":return 10;case"FarEast":return 11;case"Special":return 12}},e.prototype.getStyleTypeEnumValue=function(e){switch(e){case"Paragraph":return 0;case"Character":return 1}},e.prototype.getProtectionTypeEnumValue=function(e){switch(e){case"NoProtection":return 0;case"ReadOnly":return 1;case"FormFieldsOnly":return 2;case"CommentsOnly":return 3;case"RevisionsOnly":return 4}},e.prototype.getRevisionTypeEnumValue=function(e){switch(e){case"Insertion":return 1;case"Deletion":return 2;case"MoveTo":return 3;case"MoveFrom":return 4}},e.prototype.getFootnoteTypeEnumValue=function(e){switch(e){case"Footnote":return 0;case"Endnote":return 1}},e.prototype.getFootnoteRestartIndexEnumValue=function(e){switch(e){case"DoNotRestart":return 0;case"RestartForEachSection":return 1;case"RestartForEachPage":return 2}},e.prototype.getFootEndNoteNumberFormatEnumValue=function(e){switch(e){case"Arabic":return 0;case"UpperCaseRoman":return 1;case"LowerCaseRoman":return 2;case"UpperCaseLetter":return 3;case"LowerCaseLetter":return 4}},e.prototype.getTextVerticalAlignmentEnumValue=function(e){switch(e){case"Top":return 0;case"Center":return 1;case"Bottom":return 2;default:return 0}},e.prototype.getShapeVerticalAlignmentEnumValue=function(e){switch(e){case"None":return 0;case"Top":return 1;case"Center":return 2;case"Bottom":return 3;case"Inline":return 4;case"Inside":return 5;case"Outside":return 6}},e.prototype.getShapeHorizontalAlignmentEnumValue=function(e){switch(e){case"None":return 0;case"Center":return 1;case"Inside":return 2;case"Left":return 3;case"Outside":return 4;case"Right":return 5}},e.prototype.getVerticalOriginEnumValue=function(e){switch(e){case"Paragraph":return 0;case"BottomMargin":return 1;case"InsideMargin":return 2;case"Line":return 3;case"Margin":return 4;case"OutsideMargin":return 5;case"Page":return 6;case"TopMargin":return 7}},e.prototype.getHorizontalOriginEnumValue=function(e){switch(e){case"Column":return 0;case"Character":return 1;case"InsideMargin":return 2;case"LeftMargin":return 3;case"Margin":return 4;case"OutsideMargin":return 5;case"Page":return 6;case"RightMargin":return 7}},e.prototype.getTableVerticalRelationEnumValue=function(e){switch(e){case"Paragraph":return 0;case"Margin":return 1;case"Page":return 2;default:return 0}},e.prototype.getTableHorizontalRelationEnumValue=function(e){switch(e){case"Column":return 0;case"Margin":return 1;case"Page":return 2;default:return 0}},e.prototype.getTableVerticalPositionEnumValue=function(e){switch(e){case"None":return 0;case"Top":return 1;case"Center":return 2;case"Bottom":return 3;case"Inside":return 4;case"Outside":return 5;default:return 0}},e.prototype.getTableHorizontalPositionEnumValue=function(e){switch(e){case"Left":return 0;case"Center":return 1;case"Inside":return 2;case"Outside":return 3;case"Right":return 4;default:return 0}},e.prototype.getLineDashStyleEnumValue=function(e){switch(e){case"Solid":return 0;case"Dash":return 1;case"DashDot":return 2;case"DashDotDot":return 3;case"DashDotGEL":return 4;case"DashGEL":return 5;case"Dot":return 6;case"DotGEL":return 7;case"LongDashDotDotGEL":return 8;case"LongDashDotGEL":return 9;case"LongDashGEL":return 10}},e.prototype.getHorizontalPositionAbsEnumValue=function(e){switch(e){case"Left":return 0;case"Center":return 1;case"Right":return 2;case"Inside":return 3;case"Outside":return 4;default:return 0}},e.prototype.getTabJustificationEnumValue=function(e){switch(e){case"Left":return 0;case"Bar":return 1;case"Center":return 2;case"Decimal":return 3;case"List":return 4;case"Right":return 5}},e.prototype.getTabLeaderEnumValue=function(e){switch(e){case"None":return 0;case"Single":return 1;case"Dot":return 2;case"Hyphen":return 3;case"Underscore":return 4}},e.prototype.getTextFormFieldTypeEnumValue=function(e){switch(e){case"Text":return 0;case"Number":return 1;case"Date":return 2;case"Calculation":return 3}},e.prototype.getTextFormFieldFormatEnumValue=function(e){switch(e){case"None":return 0;case"FirstCapital":return 1;case"Lowercase":return 2;case"Uppercase":return 3;case"Titlecase":return 4;default:return 0}},e.prototype.getCheckBoxSizeTypeEnumValue=function(e){switch(e){case"Auto":return 0;case"Exactly":return 1}},e.prototype.getContentControlAppearanceEnumValue=function(e){switch(e){case"BoundingBox":return 1;case"Hidden":return 2;case"Tags":return 3;default:return 1}},e.prototype.getContentControlTypeEnumValue=function(e){switch(e){case"RichText":return 0;case"BuildingBlockGallery":return 1;case"CheckBox":return 2;case"ComboBox":return 3;case"Date":return 4;case"DropDownList":return 5;case"Group":return 6;case"Picture":return 7;case"RepeatingSection":return 8;case"Text":return 9}},e.prototype.getDateCalendarTypeEnumValue=function(e){switch(e){case"Gregorian":return 0;case"GregorianArabic":return 1;case"GregorianEnglish":return 2;case"GregorianMiddleEastFrench":return 3;case"GregorianTransliteratedEnglish":return 4;case"GregorianTransliteratedFrench":return 5;case"Hebrew":return 6;case"Hijri":return 7;case"Japan":return 8;case"Korean":return 9;case"Saka":return 10;case"Taiwan":return 11;case"Thai":return 12;default:return 0}},e.prototype.getDateStorageFormatEnumValue=function(e){switch(e){case"DateStorageDate":return 1;case"DateStorageDateTime":return 2;case"DateStorageText":return 3;default:return 0}},e.prototype.getTextWrappingStyleEnumValue=function(e){switch(e){case"Inline":return 0;case"InFrontOfText":return 1;case"Square":return 2;case"TopAndBottom":return 3;case"Behind":return 4;default:return 0}},e.prototype.getTextWrappingTypeEnumValue=function(e){switch(e){case"Both":return 0;case"Left":return 1;case"Right":return 2;case"Largest":return 3}},e.prototype.getCompatibilityModeEnumValue=function(e){switch(e){case"Word2013":return 0;case"Word2003":return 1;case"Word2007":return 2;case"Word2010":return 3}},e.prototype.getLineFormatTypeEnumValue=function(e){switch(e){case"Solid":return 0;case"Patterned":return 1;case"Gradient":return 2;case"None":return 3}},e.prototype.getAutoShapeTypeEnumValue=function(e){switch(e){case"Rectangle":return 1;case"RoundedRectangle":return 2;case"StraightConnector":return 3;default:return 1}},e.prototype.getFollowCharacterType=function(e){switch(e){case"Tab":return 0;case"Space":return 1;case"None":return 2}},e.prototype.destroy=function(){this.lists=void 0,this.endLine=void 0,this.startLine=void 0,this.endOffset=void 0,this.documentHelper=void 0},e}()},function(e,t,i){"use strict";i.d(t,"a",function(){return o});var n=i(44),r=(i.n(n),i(0)),o=(i.n(r),function(){function e(){this.pageContent="",this.curSectionIndex=0,this.inField=!1}return e.prototype.getModuleName=function(){return"TextExport"},e.prototype.save=function(e,t){this.serialize(e);var i=new n.StreamWriter;this.writeInternal(i),i.save(t+".txt")},e.prototype.saveAsBlob=function(e){this.serialize(e);var t=new n.StreamWriter;this.writeInternal(t);var i=t.buffer;return t.destroy(),new Promise(function(e,t){e(i)})},e.prototype.serialize=function(e){var t=e.owner.sfdtExportModule.write(0);this.setDocument(t)},e.prototype.setDocument=function(e){this.document=e,this.mSections=e.sections},e.prototype.writeInternal=function(e){var t=void 0,i=this.document.sections.length-1,n=!1;this.updateLastParagraph();for(var r=0;r<=i;r++)t=this.document.sections[r],n=r===i,this.writeBody(e,t.blocks,!1),this.writeNewLine(e),this.writeSectionEnd(t,n);for(var o=0;o<=i;o++)t=this.document.sections[o],this.writeHeadersFooters(e,t)},e.prototype.writeBody=function(e,t,i){for(var n=t.length-1,r=void 0,o=0;o<=n;o++)if(r=t[o],r.hasOwnProperty("inlines")){var s=r===this.lastPara;this.writeParagraph(e,r,s,i)}else r.blocks?this.writeBody(e,r.blocks,i):this.writeTable(e,r)},e.prototype.writeParagraph=function(e,t,i,n){for(var r=0;r<t.inlines.length;r++){var o=t.inlines[r];o.hasOwnProperty("fieldType")?this.inField=0===o.fieldType:o.hasOwnProperty("text")&&!this.inField&&this.writeText(e,o.text)}(!n||t.inlines.length>0)&&(i||this.writeNewLine(e))},e.prototype.writeTable=function(e,t){for(var i=0;i<t.rows.length;i++)for(var n=t.rows[i],r=0;r<n.cells.length;r++){var o=n.cells[r];this.writeBody(e,o.blocks,!1)}},e.prototype.writeHeadersFooters=function(e,t){var n=t.headersFooters;i.i(r.isNullOrUndefined)(n)||(this.writeHeaderFooter(e,t.headersFooters.header),this.writeHeaderFooter(e,t.headersFooters.footer),this.writeHeaderFooter(e,t.headersFooters.evenFooter),this.writeHeaderFooter(e,t.headersFooters.evenHeader),this.writeHeaderFooter(e,t.headersFooters.firstPageHeader),this.writeHeaderFooter(e,t.headersFooters.firstPageFooter))},e.prototype.writeHeaderFooter=function(e,t){t&&t.blocks&&this.writeBody(e,t.blocks,!0)},e.prototype.writeSectionEnd=function(e,t){this.curSectionIndex++},e.prototype.writeNewLine=function(e){i.i(r.isNullOrUndefined)(e)?this.pageContent=this.pageContent+" ":e.writeLine("")},e.prototype.writeText=function(e,t){i.i(r.isNullOrUndefined)(e)?this.pageContent+=t:e.write(t)},e.prototype.updateLastParagraph=function(){var e,t=this.document.sections.length;if(t>0&&(e=this.document.sections[t-1]),!i.i(r.isNullOrUndefined)(e)){for(var n=[],o=0;o<e.blocks.length;o++)e.blocks[o].hasOwnProperty("inlines")&&n.push(e.blocks[o]);var s=n.length;s>0&&(this.lastPara=n[s-1])}},e.prototype.destroy=function(){this.document=void 0,this.lastPara=void 0,this.mSections=void 0,this.sections=[],this.sections=void 0,this.pageContent=void 0},e}())},function(e,t,i){"use strict";i.d(t,"a",function(){return l});var n=i(33),r=(i.n(n),i(44)),o=(i.n(r),i(0)),s=(i.n(o),i(7)),a=i(1),l=function(){function e(){this.customXMLItemsPath="customXml/item",this.customXMLItemsPropspath="customXml/itemProps",this.itemPropsPath="itemProps",this.documentPath="word/document.xml",this.stylePath="word/styles.xml",this.chartPath="word/charts",this.numberingPath="word/numbering.xml",this.settingsPath="word/settings.xml",this.headerPath="word/header",this.footerPath="word/footer",this.imagePath="word/media/image",this.footnotesPath="word/footnotes.xml",this.endnotesPath="word/endnotes.xml",this.appPath="docProps/app.xml",this.corePath="docProps/core.xml",this.contentTypesPath="[Content_Types].xml",this.defaultEmbeddingPath="word/embeddings/",this.commentsPath="word/comments.xml",this.commentsExtendedPath="word/commentsExtended.xml",this.themePath="word/theme/theme1.xml",this.generalRelationPath="_rels/.rels",this.wordRelationPath="word/_rels/document.xml.rels",this.customXMLRelPath="customXml/_rels/item",this.excelRelationPath="xl/_rels/workbook.xml.rels",this.footnotesRelationPath="word/_rels/footnotes.xml.rels",this.endnotesRelationPath="word/_rels/endnotes.xml.rels",this.headerRelationPath="word/_rels/header",this.footerRelationPath="word/_rels/footer",this.xmlContentType="application/xml",this.fontContentType="application/vnd.openxmlformats-officedocument.obfuscatedFont",this.documentContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml",this.TemplateContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.template.main+xml",this.settingsContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml",this.commentsContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml",this.commentsExContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.commentsExtended+xml",this.endnoteContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.endnotes+xml",this.footerContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml",this.footnoteContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml",this.headerContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml",this.numberingContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml",this.stylesContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml",this.webSettingsContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.webSettings+xml",this.appContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml",this.coreContentType="application/vnd.openxmlformats-package.core-properties+xml",this.customContentType="application/vnd.openxmlformats-officedocument.custom-properties+xml",this.customXmlContentType="application/vnd.openxmlformats-officedocument.customXmlProperties+xml",this.relationContentType="application/vnd.openxmlformats-package.relationships+xml",this.chartsContentType="application/vnd.openxmlformats-officedocument.drawingml.chart+xml",this.themeContentType="application/vnd.openxmlformats-officedocument.theme+xml",this.tableStyleContentType="application/vnd.openxmlformats-officedocument.presentationml.tableStyles+xml",this.chartColorStyleContentType="application/vnd.ms-office.chartcolorstyle+xml",this.commentsRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",this.commentsExRelType="http://schemas.microsoft.com/office/2011/relationships/commentsExtended",this.settingsRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings",this.endnoteRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/endnotes",this.footerRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer",this.footnoteRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes",this.headerRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/header",this.documentRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",this.numberingRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering",this.stylesRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",this.chartRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",this.ThemeRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",this.fontRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/font",this.tableStyleRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/tableStyles",this.coreRelType="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",this.appRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",this.customRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",this.imageRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",this.hyperlinkRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",this.controlRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/control",this.packageRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/package",this.customXmlRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",this.customUIRelType="http://schemas.microsoft.com/office/2006/relationships/ui/extensibility",this.attachedTemplateRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/attachedTemplate",this.chartColorStyleRelType="http://schemas.microsoft.com/office/2011/relationships/chartColorStyle",this.wNamespace="http://schemas.openxmlformats.org/wordprocessingml/2006/main",this.wpNamespace="http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",this.pictureNamespace="http://schemas.openxmlformats.org/drawingml/2006/picture",this.aNamespace="http://schemas.openxmlformats.org/drawingml/2006/main",this.a14Namespace="http://schemas.microsoft.com/office/drawing/2010/main",this.svgNamespace="http://schemas.microsoft.com/office/drawing/2016/SVG/main",this.rNamespace="http://schemas.openxmlformats.org/officeDocument/2006/relationships",this.rpNamespace="http://schemas.openxmlformats.org/package/2006/relationships",this.vNamespace="urn:schemas-microsoft-com:vml",this.oNamespace="urn:schemas-microsoft-com:office:office",this.xmlNamespace="http://www.w3.org/XML/1998/namespace",this.w10Namespace="urn:schemas-microsoft-com:office:word",this.cpNamespace="http://schemas.openxmlformats.org/package/2006/metadata/core-properties",this.dcNamespace="http://purl.org/dc/elements/1.1/",this.docPropsNamespace="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",this.veNamespace="http://schemas.openxmlformats.org/markup-compatibility/2006",this.mNamespace="http://schemas.openxmlformats.org/officeDocument/2006/math",this.wneNamespace="http://schemas.microsoft.com/office/word/2006/wordml",this.customPropsNamespace="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",this.vtNamespace="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",this.chartNamespace="http://schemas.openxmlformats.org/drawingml/2006/chart",this.slNamespace="http://schemas.openxmlformats.org/schemaLibrary/2006/main",this.dtNamespace="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",this.wmlNamespace="http://schemas.microsoft.com/office/word/2003/wordml",this.w14Namespace="http://schemas.microsoft.com/office/word/2010/wordml",this.wpCanvasNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",this.wpDrawingNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",this.wpGroupNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",this.wpInkNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingInk",this.wpShapeNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingShape",this.w15Namespace="http://schemas.microsoft.com/office/word/2012/wordml",this.diagramNamespace="http://schemas.openxmlformats.org/drawingml/2006/diagram",this.eNamespace="http://schemas.microsoft.com/office/2006/encryption",this.pNamespace="http://schemas.microsoft.com/office/2006/keyEncryptor/password",this.certNamespace="http://schemas.microsoft.com/office/2006/keyEncryptor/certificate",this.cxNamespace="http://schemas.microsoft.com/office/drawing/2014/chartex",this.c15Namespace="http://schemas.microsoft.com/office/drawing/2015/06/chart",this.c7Namespace="http://schemas.microsoft.com/office/drawing/2007/8/2/chart",this.csNamespace="http://schemas.microsoft.com/office/drawing/2012/chartStyle",this.spreadSheetNamespace="http://schemas.openxmlformats.org/spreadsheetml/2006/main",this.spreadSheet9="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main",this.cRelationshipsTag="Relationships",this.cRelationshipTag="Relationship",this.cIdTag="Id",this.cTypeTag="Type",this.cTargetTag="Target",this.cUserShapesTag="userShapes",this.cExternalData="externalData",this.twipsInOnePoint=20,this.twentiethOfPoint=20,this.borderMultiplier=8,this.percentageFactor=50,this.emusPerPoint=12700,this.cConditionalTableStyleTag="tblStylePr",this.cTableFormatTag="tblPr",this.cTowFormatTag="trPr",this.cCellFormatTag="tcPr",this.cParagraphFormatTag="pPr",this.cCharacterFormatTag="rPr",this.packageType="http://schemas.microsoft.com/office/2006/xmlPackage",this.relsPartPath="/_rels/.rels",this.documentRelsPartPath="/word/_rels/document.xml.rels",this.webSettingsPath="/word/webSettings.xml",this.wordMLDocumentPath="/word/document.xml",this.wordMLStylePath="/word/styles.xml",this.wordMLNumberingPath="/word/numbering.xml",this.wordMLSettingsPath="/word/settings.xml",this.wordMLHeaderPath="/word/header",this.wordMLFooterPath="/word/footer",this.wordMLCommentsPath="/word/comments.xml",this.wordMLImagePath="/word/media/image",this.wordMLFootnotesPath="/word/footnotes.xml",this.wordMLEndnotesPath="/word/endnotes.xml",this.wordMLAppPath="/docProps/app.xml",this.wordMLCorePath="/docProps/core.xml",this.wordMLCustomPath="/docProps/custom.xml",this.wordMLFontTablePath="/word/fontTable.xml",this.wordMLChartsPath="/word/charts/",this.wordMLDefaultEmbeddingPath="/word/embeddings/",this.wordMLEmbeddingPath="/word/embeddings/",this.wordMLDrawingPath="/word/drawings/",this.wordMLThemePath="/word/theme/theme1.xml",this.wordMLFontsPath="/word/fonts/",this.wordMLDiagramPath="/word/diagrams/",this.wordMLControlPath="/word/activeX/",this.wordMLVbaProject="/vbaProject.bin",this.wordMLVbaData="/vbaData.xml",this.wordMLVbaProjectPath="/word/vbaProject.bin",this.wordMLVbaDataPath="/word/vbaData.xml",this.wordMLWebSettingsPath="/word/webSettings.xml",this.wordMLCustomItemProp1Path="/customXml/itemProps1.xml",this.wordMLFootnoteRelPath="/word/_rels/footnotes.xml.rels",this.wordMLEndnoteRelPath="/word/_rels/endnotes.xml.rels",this.wordMLSettingsRelPath="/word/_rels/settings.xml.rels",this.wordMLNumberingRelPath="/word/_rels/numbering.xml.rels",this.wordMLFontTableRelPath="/word/_rels/fontTable.xml.rels",this.wordMLCustomXmlPropsRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",this.wordMLControlRelType="http://schemas.microsoft.com/office/2006/relationships/activeXControlBinary",this.wordMLDiagramContentType="application/vnd.ms-office.drawingml.diagramDrawing+xml",this.dsNamespace="http://schemas.openxmlformats.org/officeDocument/2006/customXml",this.excelFiles=void 0,this.lastSection=!1,this.mRelationShipID=0,this.cRelationShipId=0,this.eRelationShipId=0,this.efRelationShipId=0,this.mDocPrID=1,this.chartCount=0,this.seriesCount=0,this.chartStringCount=0,this.mDifferentFirstPage=!1,this.mBookmarks=void 0,this.mComments=[],this.revisions=[],this.customXMLProps=[],this.paraID=0,this.commentParaID=0,this.commentParaIDInfo={},this.isInsideComment=!1,this.commentId={},this.currentCommentId=0,this.trackChangesId=0,this.prevRevisionIds=[],this.isRevisionContinuous=!1;this.isBookmarkAtEnd=!1,this.isBookmarkAtRowEnd=!1,this.keywordIndex=void 0,this.isHeaderFooter=!1,this.isSerializeFootEndNote=void 0,this.containerWidth=0}return e.prototype.getModuleName=function(){return"WordExport"},Object.defineProperty(e.prototype,"bookmarks",{get:function(){return i.i(o.isNullOrUndefined)(this.mBookmarks)&&(this.mBookmarks=[]),this.mBookmarks},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"documentImages",{get:function(){return void 0===this.mDocumentImages&&(this.mDocumentImages=new a.o),this.mDocumentImages},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"svgImages",{get:function(){return void 0===this.mSvgImages&&(this.mSvgImages=new a.o),this.mSvgImages},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"externalImages",{get:function(){return void 0===this.mExternalLinkImages&&(this.mExternalLinkImages=new a.o),this.mExternalLinkImages},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"headerFooterImages",{get:function(){return void 0===this.mHeaderFooterImages&&(this.mHeaderFooterImages=new a.o),this.mHeaderFooterImages},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"headerFooterSvgImages",{get:function(){return void 0===this.mHeaderFooterSvgImages&&(this.mHeaderFooterSvgImages=new a.o),this.mHeaderFooterSvgImages},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"documentCharts",{get:function(){return void 0===this.mDocumentCharts&&(this.mDocumentCharts=new a.o),this.mDocumentCharts},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"headersFooters",{get:function(){return void 0===this.mHeaderFooterColl&&(this.mHeaderFooterColl=new a.o),this.mHeaderFooterColl},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endnotesFootnotes",{get:function(){return void 0===this.mFootEndnotesColl&&(this.mFootEndnotesColl=new a.o),this.mFootEndnotesColl},enumerable:!0,configurable:!0}),e.prototype.save=function(e,t,i){var n=this;this.fileName=t,this.serialize(e,i);var r=this.serializeExcelFiles();r&&r.length>0?Promise.all(r).then(function(){n.saveInternal(t,i)}):this.saveInternal(t,i),this.close()},e.prototype.saveInternal=function(e,t){"Docx"==t?this.mArchive.save(e+".docx").then(function(e){e.destroy()}):"Dotx"==t&&this.mArchive.save(e+".dotx").then(function(e){e.destroy()})},e.prototype.saveAsBlob=function(e,t){var i=this;this.serialize(e,t);var n=this.serializeExcelFiles();return new Promise(function(e,t){n.length>0?Promise.all(n).then(function(){i.mArchive.saveAsBlob().then(function(t){i.mArchive.destroy(),t=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}),e(t)})}):i.mArchive.saveAsBlob().then(function(t){i.mArchive.destroy(),t=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}),e(t)})})},e.prototype.serializeExcelFiles=function(){var e=this,t=this.excelFiles,i=[];if(t&&t.length>0){for(var r=0;r<t.length;r++)!function(r){var o=t.keys[parseInt(r.toString(),10)],s=t.get(o),a=s.saveAsBlob();i.push(a),a.then(function(t){var i=new n.ZipArchiveItem(t,o);e.mArchive.addItem(i)})}(r);this.excelFiles.clear()}return i},e.prototype.saveExcel=function(){var e=this.defaultEmbeddingPath+"Microsoft_Excel_Worksheet"+this.chartCount+".xlsx";this.excelFiles.add(e,this.mArchiveExcel),this.mArchiveExcel=void 0},e.prototype.destroy=function(){this.clearDocument(),this.mRelationShipID=void 0,this.mDocPrID=void 0,this.mDifferentFirstPage=void 0,this.fileName=void 0,this.imageRelationIds=void 0,this.svgImageRelationIds=void 0,this.mArchive&&(this.mArchive.destroy(),this.mArchive=void 0),this.mArchiveExcel&&(this.mArchiveExcel.destroy(),this.mArchiveExcel=void 0)},e.prototype.serialize=function(e,t){this.keywordIndex=e.owner.documentEditorSettings.optimizeSfdt?1:0;var i=e.owner.sfdtExportModule.write(this.keywordIndex);this.setDocument(i),this.mComments=e.comments,this.mCustomXML=e.customXmlData,this.mImages=e.images,this.revisions=e.owner.revisions.changes,this.mArchive=new n.ZipArchive,this.mArchive.compressionLevel="Normal",this.commentParaIDInfo={},this.commentParaID=0,this.currentCommentId=0,this.commentId={},this.mVerticalMerge=new a.o,this.mGridSpans=new a.o,this.imageRelationIds=new a.o,this.svgImageRelationIds=new a.o;this.serializeDocument(),this.serializeStyles(),this.serializeNumberings(),this.serializeComments(),this.serializeCommentsExtended(),this.serializeThemes(),this.serializeSettings(),this.serializeCoreProperties(),this.serializeAppProperties(),this.serializeFontTable(void 0),this.serializeSettingsRelation(),this.serializeHeaderFooters(),this.serializeFootnotes(),this.serializeEndnotes(),this.serializeDocumentRelations(),this.serializeGeneralRelations(),this.serializeContentTypes(void 0,t),this.clearDocument()},e.prototype.setDocument=function(e,t){i.i(o.isNullOrUndefined)(this.keywordIndex)&&(this.keywordIndex=t),this.document=e,this.mSections=e[a._2[this.keywordIndex]],this.mLists=e[a._6[this.keywordIndex]],this.mAbstractLists=e[a._7[this.keywordIndex]],this.defCharacterFormat=e[a._4[this.keywordIndex]],this.defParagraphFormat=e[a._5[this.keywordIndex]],this.defaultTabWidthValue=e[a._13[this.keywordIndex]],this.themeFontLang=e[a._33[this.keywordIndex]],this.dontUseHtmlParagraphAutoSpacing=s.h.parseBoolValue(e[a._26[this.keywordIndex]]),this.mStyles=e[a._9[this.keywordIndex]],this.mThemes=e[a._34[this.keywordIndex]],this.formatting=s.h.parseBoolValue(e[a._14[this.keywordIndex]]),this.enforcement=s.h.parseBoolValue(e[a._17[this.keywordIndex]]),this.hashValue=e[a._18[this.keywordIndex]],this.saltValue=e[a._19[this.keywordIndex]],this.protectionType=e[a._16[this.keywordIndex]],this.formFieldShading=s.h.parseBoolValue(e[a._28[this.keywordIndex]]),this.trackChanges=s.h.parseBoolValue(e[a._15[this.keywordIndex]]),this.compatibilityMode=e[a._32[this.keywordIndex]],this.allowSpaceOfSameStyleInTable=s.h.parseBoolValue(e[a._371[this.keywordIndex]])},e.prototype.clearDocument=function(){this.section=void 0,this.lastSection=void 0,this.blockOwner=void 0,this.paragraph=void 0,this.table=void 0,this.row=void 0,this.headerFooter=void 0,this.commentParaIDInfo={},this.commentParaID=0,this.currentCommentId=0,this.commentId={},this.document=void 0,this.mSections=void 0,this.mLists=void 0,this.mAbstractLists=void 0,this.defCharacterFormat=void 0,this.defParagraphFormat=void 0,this.defaultTabWidthValue=void 0,this.trackChanges=void 0,this.customXMLProps=[],this.mRelationShipID=0,this.eRelationShipId=0,this.cRelationShipId=0,this.efRelationShipId=0,this.mDocPrID=1,this.chartCount=0,this.keywordIndex=void 0,this.mDifferentFirstPage=!1,this.mHeaderFooterColl&&(this.mHeaderFooterColl.destroy(),this.mHeaderFooterColl=void 0),this.mVerticalMerge&&(this.mVerticalMerge.destroy(),this.mVerticalMerge=void 0),this.mGridSpans&&(this.mGridSpans.destroy(),this.mGridSpans=void 0),this.mDocumentImages&&(this.mDocumentImages.destroy(),this.mDocumentImages=void 0),this.mSvgImages&&(this.mSvgImages.destroy(),this.mSvgImages=void 0),this.mExternalLinkImages&&(this.mExternalLinkImages.destroy(),this.mExternalLinkImages=void 0),this.mHeaderFooterImages&&(this.mHeaderFooterImages.destroy(),this.mHeaderFooterImages=void 0),this.mHeaderFooterSvgImages&&(this.mHeaderFooterSvgImages.destroy(),this.mHeaderFooterSvgImages=void 0),this.mDocumentCharts&&(this.mDocumentCharts.destroy(),this.mDocumentCharts=void 0),this.mFootEndnotesColl&&(this.mFootEndnotesColl.destroy(),this.mFootEndnotesColl=void 0)},e.prototype.serializeDocument=function(){var e=new r.XmlWriter;e.writeStartElement("w","document",this.wNamespace),this.writeCommonAttributeStrings(e),e.writeStartElement("w","background",this.wNamespace),e.writeAttributeString("w","color",void 0,this.getColor(this.document[a._8[this.keywordIndex]][a._221[this.keywordIndex]])),e.writeEndElement(),this.serializeDocumentBody(e),e.writeEndElement();var t=new n.ZipArchiveItem(e.buffer,this.documentPath);this.mArchive.addItem(t)},e.prototype.writeCommonAttributeStrings=function(e){e.writeAttributeString("xmlns","wpc",void 0,this.wpCanvasNamespace),this.writeCustom(e),e.writeAttributeString("xmlns","wp14",void 0,this.wpDrawingNamespace),e.writeAttributeString("xmlns","wp",void 0,this.wpNamespace),e.writeAttributeString("xmlns","w10",void 0,this.w10Namespace),e.writeAttributeString("xmlns","w",void 0,this.wNamespace),this.writeDup(e),e.writeAttributeString("xmlns","wne",void 0,this.wneNamespace),e.writeAttributeString("xmlns","wps",void 0,this.wpShapeNamespace),e.writeAttributeString("mc","Ignorable",void 0,"w14 w15 wp14")},e.prototype.writeDup=function(e){e.writeAttributeString("xmlns","w14",void 0,this.w14Namespace),e.writeAttributeString("xmlns","w15",void 0,this.w15Namespace),e.writeAttributeString("xmlns","wpg",void 0,this.wpGroupNamespace),e.writeAttributeString("xmlns","wpi",void 0,this.wpInkNamespace)},e.prototype.writeCustom=function(e){e.writeAttributeString("xmlns","mc",void 0,this.veNamespace),e.writeAttributeString("xmlns","o",void 0,this.oNamespace),e.writeAttributeString("xmlns","r",void 0,this.rNamespace),e.writeAttributeString("xmlns","m",void 0,this.mNamespace),e.writeAttributeString("xmlns","v",void 0,this.vNamespace)},e.prototype.serializeDocumentBody=function(e){e.writeStartElement(void 0,"body",this.wNamespace);for(var t=this.document[a._2[this.keywordIndex]].length,i=0;i<t;i++)this.section=this.document[a._2[this.keywordIndex]][parseInt(i.toString(),10)],this.lastSection=i===t-1,this.containerWidth=this.section[a._322[this.keywordIndex]][a._91[this.keywordIndex]]-(this.section[a._322[this.keywordIndex]][a._93[this.keywordIndex]]+this.section[a._322[this.keywordIndex]][a._94[this.keywordIndex]]),this.serializeSection(e,this.section,i===t-1),this.section=void 0;e.writeEndElement()},e.prototype.serializeSection=function(e,t,n){this.blockOwner=t,i.i(o.isNullOrUndefined)(t[a._314[this.keywordIndex]])||this.serializeBodyItems(e,t[a._314[this.keywordIndex]],n),n&&this.serializeSectionProperties(e,t),this.blockOwner=void 0},e.prototype.serializeComments=function(){if(0!==this.mComments.length&&(1!==this.mComments.length||""!==this.mComments[0].text)){var e=new r.XmlWriter;e.writeStartElement("w","comments",this.wNamespace),this.serializeCommentCommonAttribute(e),this.serializeCommentInternal(e,this.mComments),e.writeEndElement();var t=new n.ZipArchiveItem(e.buffer,this.commentsPath);this.mArchive.addItem(t)}},e.prototype.serializeThemes=function(){if(!i.i(o.isNullOrUndefined)(this.mThemes)){var e=new r.XmlWriter;e.writeStartElement("a","theme",this.aNamespace),e.writeAttributeString(void 0,"name",void 0,"Office Theme"),e.writeStartElement(void 0,"themeElements",this.aNamespace),e.writeRaw('<a:clrScheme name="Office"><a:dk1><a:sysClr val="windowText" lastClr="000000" /></a:dk1><a:lt1><a:sysClr val="window" lastClr="FFFFFF" /></a:lt1><a:dk2><a:srgbClr val="44546A" /></a:dk2><a:lt2><a:srgbClr val="E7E6E6" /></a:lt2><a:accent1><a:srgbClr val="4472C4" /></a:accent1><a:accent2><a:srgbClr val="ED7D31" /></a:accent2><a:accent3><a:srgbClr val="A5A5A5" /></a:accent3><a:accent4><a:srgbClr val="FFC000" /></a:accent4><a:accent5><a:srgbClr val="5B9BD5" /></a:accent5><a:accent6><a:srgbClr val="70AD47" /></a:accent6><a:hlink><a:srgbClr val="0563C1" /></a:hlink><a:folHlink><a:srgbClr val="954F72" /></a:folHlink></a:clrScheme>'),e.writeStartElement(void 0,"fontScheme",this.aNamespace),e.writeAttributeString(void 0,"name",void 0,this.mThemes[a._352[this.keywordIndex]]),e.writeStartElement(void 0,"majorFont",this.aNamespace);for(var t=0;t<this.mThemes[a._351[this.keywordIndex]][a._353[this.keywordIndex]][a._355[this.keywordIndex]].length;t++){var s=this.mThemes[a._351[this.keywordIndex]][a._353[this.keywordIndex]][a._355[this.keywordIndex]][parseInt(t.toString(),10)];this.themeFont(e,s)}for(var l=Object.keys(this.mThemes[a._351[this.keywordIndex]][a._353[this.keywordIndex]][a._356[this.keywordIndex]]),d=0,h=l;d<h.length;d++){var c=h[d];this.themeType(e,c,this.mThemes[a._351[this.keywordIndex]][a._353[this.keywordIndex]][a._356[this.keywordIndex]][""+c])}e.writeEndElement(),e.writeStartElement(void 0,"minorFont",this.aNamespace);for(var t=0;t<this.mThemes[a._351[this.keywordIndex]][a._354[this.keywordIndex]][a._355[this.keywordIndex]].length;t++){var s=this.mThemes[a._351[this.keywordIndex]][a._354[this.keywordIndex]][a._355[this.keywordIndex]][parseInt(t.toString(),10)];this.themeFont(e,s)}l=Object.keys(this.mThemes[a._351[this.keywordIndex]][a._354[this.keywordIndex]][a._356[this.keywordIndex]]);for(var p=0,u=l;p<u.length;p++){var c=u[p];this.themeType(e,c,this.mThemes[a._351[this.keywordIndex]][a._354[this.keywordIndex]][a._356[this.keywordIndex]][""+c])}e.writeEndElement(),e.writeEndElement(),e.writeStartElement(void 0,"fmtScheme",this.aNamespace),e.writeAttributeString(void 0,"name",void 0,"Office"),e.writeRaw('<a:fillStyleLst><a:solidFill><a:schemeClr val="phClr" /></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:lumMod val="110000" /><a:satMod val="105000" /><a:tint val="67000" /></a:schemeClr></a:gs><a:gs pos="50000"><a:schemeClr val="phClr"><a:lumMod val="105000" /><a:satMod val="103000" /><a:tint val="73000" /></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:lumMod val="105000" /><a:satMod val="109000" /><a:tint val="81000" /></a:schemeClr></a:gs></a:gsLst><a:lin ang="5400000" scaled="0" /></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:satMod val="103000" /><a:lumMod val="102000" /><a:tint val="94000" /></a:schemeClr></a:gs><a:gs pos="50000"><a:schemeClr val="phClr"><a:satMod val="110000" /><a:lumMod val="100000" /><a:shade val="100000" /></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:lumMod val="99000" /><a:satMod val="120000" /><a:shade val="78000" /></a:schemeClr></a:gs></a:gsLst><a:lin ang="5400000" scaled="0" /></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w="6350" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr" /></a:solidFill><a:prstDash val="solid" /><a:miter lim="800000" /></a:ln><a:ln w="12700" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr" /></a:solidFill><a:prstDash val="solid" /><a:miter lim="800000" /></a:ln><a:ln w="19050" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr" /></a:solidFill><a:prstDash val="solid" /><a:miter lim="800000" /></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst /></a:effectStyle><a:effectStyle><a:effectLst /></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="57150" dist="19050" dir="5400000" algn="ctr" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="63000" /></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val="phClr" /></a:solidFill><a:solidFill><a:schemeClr val="phClr"><a:tint val="95000" /><a:satMod val="170000" /></a:schemeClr></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="93000" /><a:satMod val="150000" /><a:shade val="98000" /><a:lumMod val="102000" /></a:schemeClr></a:gs><a:gs pos="50000"><a:schemeClr val="phClr"><a:tint val="98000" /><a:satMod val="130000" /><a:shade val="90000" /><a:lumMod val="103000" /></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="63000" /><a:satMod val="120000" /></a:schemeClr></a:gs></a:gsLst><a:lin ang="5400000" scaled="0" /></a:gradFill></a:bgFillStyleLst>'),e.writeEndElement(),e.writeEndElement(),e.writeEndElement();var g=new n.ZipArchiveItem(e.buffer,this.themePath);this.mArchive.addItem(g)}},e.prototype.themeFont=function(e,t){"latin"!=t[a._35[this.keywordIndex]]&&"ea"!=t[a._35[this.keywordIndex]]&&"cs"!=t[a._35[this.keywordIndex]]||(e.writeStartElement(void 0,t[a._35[this.keywordIndex]],this.aNamespace),e.writeAttributeString(void 0,"typeface",void 0,t[a._357[this.keywordIndex]]),e.writeAttributeString(void 0,"panose",void 0,t[a._358[this.keywordIndex]]),e.writeEndElement())},e.prototype.themeType=function(e,t,i){e.writeStartElement(void 0,"font",this.aNamespace),e.writeAttributeString(void 0,"script",void 0,t),e.writeAttributeString(void 0,"typeface",void 0,i),e.writeEndElement()},e.prototype.serializeCommentCommonAttribute=function(e){e.writeAttributeString("xmlns","wpc",void 0,this.wpCanvasNamespace),e.writeAttributeString("xmlns","cx",void 0,this.cxNamespace),e.writeAttributeString("xmlns","mc",void 0,this.veNamespace),e.writeAttributeString("xmlns","o",void 0,this.oNamespace),e.writeAttributeString("xmlns","r",void 0,this.rNamespace),e.writeAttributeString("xmlns","m",void 0,this.mNamespace),e.writeAttributeString("xmlns","v",void 0,this.vNamespace),e.writeAttributeString("xmlns","wp14",void 0,this.wpDrawingNamespace),e.writeAttributeString("xmlns","wp",void 0,this.wpNamespace),e.writeAttributeString("xmlns","w10",void 0,this.w10Namespace),e.writeAttributeString("xmlns","w",void 0,this.wNamespace),e.writeAttributeString("xmlns","w14",void 0,this.w14Namespace),e.writeAttributeString("xmlns","w15",void 0,this.w15Namespace),e.writeAttributeString("mc","Ignorable",void 0,"w14 w15")},e.prototype.serializeCommentInternal=function(e,t){for(var i=0;i<t.length;i++){var n=t[parseInt(i.toString(),10)];e.writeStartElement("w","comment",this.wNamespace),e.writeAttributeString("w","id",this.wNamespace,this.commentId[n.commentId].toString()),n.author&&" "!==n.author&&e.writeAttributeString("w","author",this.wNamespace,n.author),n.date&&e.writeAttributeString("w","date",this.wNamespace,n.date),n.initial&&""!==n.initial&&e.writeAttributeString("w","initials",this.wNamespace,n.initial);for(var r=this.retrieveCommentText(n.text),o=0;o<r.length;o++)this.isInsideComment=!0,this.commentParaID++,this.serializeBodyItem(e,r[parseInt(o.toString(),10)],!0),this.isInsideComment=!1;0===r.length&&(this.isInsideComment=!0,this.commentParaID++),this.commentParaIDInfo[n.commentId]=this.commentParaID,this.isInsideComment=!1,e.writeEndElement(),n.replyComments.length>0&&this.serializeCommentInternal(e,n.replyComments)}},e.prototype.retrieveCommentText=function(e){for(var t=[],i=e.split("\n");i.length>0;){var n={};n[a._267[this.keywordIndex]]=[];var r={};r[a._198[this.keywordIndex]]=i[0],n[a._267[this.keywordIndex]].push(r),t.push(n),i.splice(0,1)}return t},e.prototype.serializeCommentsExtended=function(){if(0!==this.mComments.length&&(1!==this.mComments.length||""!==this.mComments[0].text)){var e=new r.XmlWriter;e.writeStartElement("w15","commentsEx",this.wNamespace),this.serializeCommentCommonAttribute(e),this.serializeCommentsExInternal(e,this.mComments,!1),e.writeEndElement();var t=new n.ZipArchiveItem(e.buffer,this.commentsExtendedPath);this.mArchive.addItem(t)}},e.prototype.serializeCommentsExInternal=function(e,t,i){for(var n=0;n<t.length;n++){var r=t[parseInt(n.toString(),10)];e.writeStartElement("w15","commentEx",this.wNamespace);var o=this.commentParaIDInfo[r.commentId];if(i){var s=this.commentParaIDInfo[r.ownerComment.commentId];e.writeAttributeString("w15","paraIdParent",this.wNamespace,s.toString())}e.writeAttributeString("w15","paraId",this.wNamespace,o.toString());var a=r.done?1:0;e.writeAttributeString("w15","done",this.wNamespace,a.toString()),e.writeEndElement(),r.replyComments.length>0&&this.serializeCommentsExInternal(e,r.replyComments,!0)}},e.prototype.serializeSectionProperties=function(e,t){i.i(o.isNullOrUndefined)(this.document.optimizeSfdt)||(this.keywordIndex=this.document.optimizeSfdt?1:0),e.writeStartElement("w","sectPr",this.wNamespace),t[a._321[this.keywordIndex]]&&this.serializeHFReference(e,t[a._321[this.keywordIndex]]),"NoBreak"===t[a._322[this.keywordIndex]][a._110[this.keywordIndex]]?this.serializeSectionType(e,"continuous"):this.serializeSectionType(e,"nextPage"),this.serializePageSetup(e,t[a._322[this.keywordIndex]]),this.serializeColumns(e,t[a._322[this.keywordIndex]]),this.serializeFootNotesPr(e,t[a._322[this.keywordIndex]]),this.serializeEndNotesPr(e,t[a._322[this.keywordIndex]]),void 0!==t[a._322[this.keywordIndex]]&&s.h.parseBoolValue(t[a._322[this.keywordIndex]][a._89[this.keywordIndex]])&&(e.writeStartElement(void 0,"titlePg",this.wNamespace),e.writeEndElement()),!i.i(o.isNullOrUndefined)(t[a._322[this.keywordIndex]])&&s.h.parseBoolValue(t[a._322[this.keywordIndex]][a._52[this.keywordIndex]])&&(e.writeStartElement(void 0,"bidi",this.wNamespace),e.writeEndElement()),e.writeEndElement()},e.prototype.serializeFootNotesPr=function(e,t){(t[a._100[this.keywordIndex]]||t[a._101[this.keywordIndex]])&&(e.writeStartElement(void 0,"footnotePr",this.wNamespace),e.writeStartElement(void 0,"pos",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,"pageBottom"),e.writeEndElement(),void 0!==t[a._100[this.keywordIndex]]&&(e.writeStartElement(void 0,"numFmt",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.getFootNoteNumberFormat(t[a._100[this.keywordIndex]])),e.writeEndElement()),void 0!==t[a._101[this.keywordIndex]]&&(e.writeStartElement(void 0,"numRestart",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.getFootNoteNumberRestart(t[a._101[this.keywordIndex]])),e.writeEndElement()),void 0!==t[a._103[this.keywordIndex]]&&(e.writeStartElement(void 0,"numStart",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t[a._103[this.keywordIndex]].toString()),e.writeEndElement()),e.writeEndElement())},e.prototype.getFootNoteNumberFormat=function(e){var t;switch(e){case"UpperCaseRoman":case 1:t="upperRoman";break;case"LowerCaseRoman":case 2:t="lowerRoman";break;case"UpperCaseLetter":case 3:t="upperLetter";break;case"LowerCaseLetter":case 4:t="lowerLetter";break;default:t="decimal"}return t},e.prototype.getFootNoteNumberRestart=function(e){switch(e){case"RestartForEachSection ":case 1:return"eachSect";case"RestartForEachPage":case 2:return"eachPage";default:return"continuous"}},e.prototype.getPageNumberFormat=function(e){var t;switch(e){case"RomanUpper":t="upperRoman";break;case"RomanLower":t="lowerRoman";break;case"LetterUpper":t="upperLetter";break;case"LetterLower":t="lowerLetter";break;default:t="Arabic"}return t},e.prototype.serializeEndNotesPr=function(e,t){(t[a._99[this.keywordIndex]]||t[a._102[this.keywordIndex]])&&(e.writeStartElement(void 0,"endnotePr",this.wNamespace),e.writeStartElement(void 0,"pos",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,"docEnd"),e.writeEndElement(),void 0!==t[a._99[this.keywordIndex]]&&(e.writeStartElement(void 0,"numFmt",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.getFootNoteNumberFormat(t[a._99[this.keywordIndex]])),e.writeEndElement()),void 0!==t[a._102[this.keywordIndex]]&&(e.writeStartElement(void 0,"numRestart",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.getFootNoteNumberRestart(t[a._102[this.keywordIndex]])),e.writeEndElement()),void 0!==t[a._104[this.keywordIndex]]&&(e.writeStartElement(void 0,"numStart",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t[a._104[this.keywordIndex]].toString()),e.writeEndElement()),e.writeEndElement())},e.prototype.serializeColumns=function(e,t){if(void 0!==t[a._107[this.keywordIndex]]&&t[a._107[this.keywordIndex]]>1){if(e.writeStartElement(void 0,"cols",this.wNamespace),e.writeAttributeString(void 0,"num",this.wNamespace,t[a._107[this.keywordIndex]].toString()),s.h.parseBoolValue(t[a._109[this.keywordIndex]])&&e.writeAttributeString(void 0,"sep",this.wNamespace,"1"),s.h.parseBoolValue(t[a._108[this.keywordIndex]]))e.writeAttributeString(void 0,"equalWidth",this.wNamespace,"1");else if(e.writeAttributeString(void 0,"equalWidth",this.wNamespace,"0"),void 0!==t[a._106[this.keywordIndex]]&&t[a._106[this.keywordIndex]].length>0)for(var i=0;i<t[a._106[this.keywordIndex]].length;i++)e.writeStartElement(void 0,"col",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,this.roundToTwoDecimal(t[a._106[this.keywordIndex]][parseInt(i.toString(),10)][a._204[this.keywordIndex]]*this.twentiethOfPoint).toString()),e.writeAttributeString(void 0,"space",this.wNamespace,this.roundToTwoDecimal(t[a._106[this.keywordIndex]][parseInt(i.toString(),10)][a._350[this.keywordIndex]]*this.twentiethOfPoint).toString()),e.writeEndElement();e.writeEndElement()}},e.prototype.serializePageSetup=function(e,t){void 0!==t&&(this.serializePageSize(e,t),this.serializePageMargins(e,t),this.serializePageNumberType(e,t)),s.h.parseBoolValue(t[a._97[this.keywordIndex]])&&(e.writeStartElement(void 0,"pgNumType",this.wNamespace),e.writeAttributeString(void 0,"start",this.wNamespace,t[a._98[this.keywordIndex]].toString()),e.writeEndElement()),e.writeStartElement(void 0,"pgBorders",this.wNamespace),e.writeEndElement()},e.prototype.serializePageSize=function(e,t){e.writeStartElement(void 0,"pgSz",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,this.roundToTwoDecimal(t[a._91[this.keywordIndex]]*this.twentiethOfPoint).toString()),e.writeAttributeString(void 0,"h",this.wNamespace,this.roundToTwoDecimal(t[a._92[this.keywordIndex]]*this.twentiethOfPoint).toString()),e.writeEndElement()},e.prototype.serializePageMargins=function(e,t){e.writeStartElement(void 0,"pgMar",this.wNamespace);var i=Math.round(t[a._95[this.keywordIndex]]*this.twentiethOfPoint);e.writeAttributeString(void 0,"top",this.wNamespace,i.toString()),i=Math.round(t[a._94[this.keywordIndex]]*this.twentiethOfPoint),e.writeAttributeString(void 0,"right",this.wNamespace,i.toString()),i=Math.round(t[a._96[this.keywordIndex]]*this.twentiethOfPoint),e.writeAttributeString(void 0,"bottom",this.wNamespace,i.toString()),i=Math.round(t[a._93[this.keywordIndex]]*this.twentiethOfPoint),e.writeAttributeString(void 0,"left",this.wNamespace,i.toString()),e.writeAttributeString(void 0,"header",this.wNamespace,this.roundToTwoDecimal(t[a._87[this.keywordIndex]]*this.twentiethOfPoint).toString()),e.writeAttributeString(void 0,"footer",this.wNamespace,this.roundToTwoDecimal(t[a._88[this.keywordIndex]]*this.twentiethOfPoint).toString()),e.writeAttributeString(void 0,"gutter",this.wNamespace,"0"),e.writeEndElement()},e.prototype.serializePageNumberType=function(e,t){void 0!==t[a._105[this.keywordIndex]]&&(e.writeStartElement(void 0,"pgNumType",this.wNamespace),e.writeAttributeString(void 0,"fmt",this.wNamespace,this.getPageNumberFormat(t[a._105[this.keywordIndex]])),e.writeEndElement())},e.prototype.serializeSectionType=function(e,t){e.writeStartElement("w","type",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t),e.writeEndElement()},e.prototype.serializeHFReference=function(e,t){var i="";if(void 0!==t){this.mDifferentFirstPage=s.h.parseBoolValue(this.section[a._322[this.keywordIndex]][a._90[this.keywordIndex]]);var n=t[a._319[this.keywordIndex]];n&&n[a._314[this.keywordIndex]]&&n[a._314[this.keywordIndex]].length>0&&(e.writeStartElement(void 0,"headerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"first"),i=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,i),this.addHeaderFooter(n,"FirstPageHeader",i),e.writeEndElement()),n=t[a._320[this.keywordIndex]],n&&n[a._314[this.keywordIndex]]&&n[a._314[this.keywordIndex]].length>0&&(e.writeStartElement(void 0,"footerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"first"),i=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,i),this.addHeaderFooter(n,"FirstPageFooter",i),e.writeEndElement()),n=t[a._317[this.keywordIndex]],n&&n[a._314[this.keywordIndex]]&&n[a._314[this.keywordIndex]].length>0&&(e.writeStartElement(void 0,"headerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"even"),i=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,i),this.addHeaderFooter(n,"EvenHeader",i),e.writeEndElement()),n=t[a._318[this.keywordIndex]],n&&n[a._314[this.keywordIndex]]&&n[a._314[this.keywordIndex]].length>0&&(e.writeStartElement(void 0,"footerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"even"),i=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,i),this.addHeaderFooter(n,"EvenFooter",i),e.writeEndElement()),n=t[a._315[this.keywordIndex]],n&&n[a._314[this.keywordIndex]]&&n[a._314[this.keywordIndex]].length>0&&(e.writeStartElement(void 0,"headerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"default"),i=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,i),this.addHeaderFooter(n,"OddHeader",i),e.writeEndElement()),n=t[a._316[this.keywordIndex]],n&&n[a._314[this.keywordIndex]]&&n[a._314[this.keywordIndex]].length>0&&(e.writeStartElement(void 0,"footerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"default"),i=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,i),this.addHeaderFooter(n,"OddFooter",i),e.writeEndElement())}},e.prototype.addHeaderFooter=function(e,t,i){var n=new a.o;this.headersFooters.add(t,n),this.headersFooters.get(t).add(i,e)},e.prototype.serializeBodyItems=function(e,t,i){for(var n=0;n<t.length;n++)this.serializeBodyItem(e,t[parseInt(n.toString(),10)],i)},e.prototype.serializeContentControl=function(e,t,n,r,s){if(i.i(o.isNullOrUndefined)(t))throw new Error("contentCOntrol should not be undefined");e.writeStartElement("w","sdt",this.wNamespace),e.writeStartElement(void 0,"sdtPr",this.wNamespace),i.i(o.isNullOrUndefined)(t)||this.serializeContentProperties(e,t,n,r,s)},e.prototype.serializeContentProperties=function(e,t,n,r,l){if(i.i(o.isNullOrUndefined)(t[a._272[this.keywordIndex]])||(e.writeStartElement(void 0,"alias",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t[a._272[this.keywordIndex]]),e.writeEndElement(),e.writeStartElement(void 0,"tag",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t[a._271[this.keywordIndex]]),e.writeEndElement()),i.i(o.isNullOrUndefined)(t[a._4[this.keywordIndex]])||this.serializeCharacterFormat(e,n[a._268[this.keywordIndex]][a._4[this.keywordIndex]]),(s.h.parseBoolValue(t[a._270[this.keywordIndex]])||s.h.parseBoolValue(t[a._269[this.keywordIndex]]))&&(e.writeStartElement(void 0,"lock",this.wNamespace),s.h.parseBoolValue(t[a._269[this.keywordIndex]])&&s.h.parseBoolValue(t[a._270[this.keywordIndex]])?e.writeAttributeString("w","val",this.wNamespace,"sdtContentLocked"):s.h.parseBoolValue(t[a._269[this.keywordIndex]])?e.writeAttributeString("w","val",this.wNamespace,"sdtLocked"):s.h.parseBoolValue(t[a._270[this.keywordIndex]])&&e.writeAttributeString("w","val",this.wNamespace,"contentLocked"),e.writeEndElement()),s.h.parseBoolValue(t[a._273[this.keywordIndex]])&&i.i(o.isNullOrUndefined)(void 0)&&(e.writeStartElement("w","placeholder",void 0),e.writeAttributeString("w","docPart",this.wNamespace,void 0),e.writeEndElement(),e.writeStartElement("w","showingPlcHdr",void 0),e.writeEndElement()),s.h.parseBoolValue(t[a._275[this.keywordIndex]])&&(e.writeStartElement("w","temporary",void 0),e.writeEndElement()),i.i(o.isNullOrUndefined)(t[a._369[this.keywordIndex]])||(e.writeStartElement("w15","appearance",void 0),e.writeAttributeString("w15","val",void 0,1==this.keywordIndex?this.getContentControlAppearance(t[a._369[this.keywordIndex]]).toLowerCase():t[a._369[this.keywordIndex]].toLowerCase()),e.writeEndElement()),i.i(o.isNullOrUndefined)(t[a._221[this.keywordIndex]])||(e.writeStartElement("w15","color",void 0),e.writeAttributeString("w","val",void 0,this.getColor(t[a._221[this.keywordIndex]])),e.writeEndElement()),s.h.parseBoolValue(t[a._274[this.keywordIndex]])&&(e.writeStartElement(void 0,"text",this.wNamespace),e.writeAttributeString("w","multiLine",this.wNamespace,"1"),e.writeEndElement()),i.i(o.isNullOrUndefined)(t[a._284[this.keywordIndex]])||s.h.parseBoolValue(t[a._284[this.keywordIndex]][a._288[this.keywordIndex]])&&(e.writeStartElement("w","dataBinding",this.wNamespace),e.writeAttributeString("w","xpath",void 0,t[a._284[this.keywordIndex]][a._291[this.keywordIndex]]),e.writeAttributeString("w","storeItemID",void 0,t[a._284[this.keywordIndex]][a._292[this.keywordIndex]]),e.writeEndElement()),t.picture&&(e.writeStartElement("w","picture",this.wNamespace),e.writeEndElement()),i.i(o.isNullOrUndefined)(t[a._281[this.keywordIndex]]||t[a._282[this.keywordIndex]])||(e.writeStartElement("w14","checkbox",void 0),s.h.parseBoolValue(t[a._280[this.keywordIndex]])?(e.writeStartElement("w14","checked",void 0),e.writeAttributeString("w14","val",void 0,"1"),e.writeEndElement()):(e.writeStartElement("w14","checked",void 0),e.writeAttributeString("w14","val",void 0,"0"),e.writeEndElement()),t[a._281[this.keywordIndex]]&&(e.writeStartElement("w14","uncheckedState",void 0),e.writeAttributeString("w14","val",void 0,this.toUnicode(t[a._281[this.keywordIndex]][a._286[this.keywordIndex]])),e.writeAttributeString("w14","font",void 0,t[a._281[this.keywordIndex]][a._285[this.keywordIndex]]),e.writeEndElement()),t[a._282[this.keywordIndex]]&&(e.writeStartElement("w14","checkedState",void 0),e.writeAttributeString("w14","val",void 0,this.toUnicode(t[a._282[this.keywordIndex]][a._286[this.keywordIndex]])),e.writeAttributeString("w14","font",void 0,t[a._282[this.keywordIndex]][a._285[this.keywordIndex]]),e.writeEndElement()),e.writeEndElement()),!i.i(o.isNullOrUndefined)(t[a._283[this.keywordIndex]])&&t[a._359[this.keywordIndex]]===(1==this.keywordIndex?5:"DropDownList")){var d=t[a._283[this.keywordIndex]];e.writeStartElement(void 0,"dropDownList",this.wNamespace),this.serializeContentControlList(e,d),e.writeEndElement()}if(!i.i(o.isNullOrUndefined)(t[a._283[this.keywordIndex]])&&t[a._359[this.keywordIndex]]===(1==this.keywordIndex?3:"ComboBox")){var h=t[a._283[this.keywordIndex]];e.writeStartElement(void 0,"comboBox",this.wNamespace),this.serializeContentControlList(e,h),e.writeEndElement()}if(this.serializeContentControlDate(e,t),i.i(o.isNullOrUndefined)(t[a._359[this.keywordIndex]])||t[a._359[this.keywordIndex]]===(1==this.keywordIndex?7:"Picture")&&(e.writeStartElement(void 0,"picture",this.wNamespace),e.writeEndElement()),e.writeEndElement(),e.writeStartElement("w","sdtContent",this.wNamespace),!l){if(n.hasOwnProperty(a._314[this.keywordIndex])&&i.i(o.isNullOrUndefined)(n[a._295[this.keywordIndex]]))for(var c=0;c<n[a._314[this.keywordIndex]].length;c++){var p=n[a._314[this.keywordIndex]][c];if(p.hasOwnProperty(a._267[this.keywordIndex]))this.paragraph=p,this.serializeParagraph(e,p,r),this.paragraph=void 0;else if(p.hasOwnProperty(a._296[this.keywordIndex])){var u=new a.o;this.serializeRow(e,p,u)}else if(p.hasOwnProperty(a._268[this.keywordIndex]))this.serializeContentControl(e,p[a._268[this.keywordIndex]],p,r);else{var g=p;this.serializeTable(e,g)}}else if(n.hasOwnProperty(a._296[this.keywordIndex])){if(n[a._297[this.keywordIndex]].length>0){var u=new a.o;this.serializeRow(e,n,u)}}else if(n.hasOwnProperty(a._295[this.keywordIndex])){var u=new a.o;this.serializeCell(e,n,u)}e.writeEndElement(),e.writeEndElement()}},e.prototype.toUnicode=function(e){return e.charCodeAt(0).toString(16)},e.prototype.serializeContentControlList=function(e,t){for(var n=0;n<t.length;n++)e.writeStartElement(void 0,"listItem",this.wNamespace),i.i(o.isNullOrUndefined)(t[n][a._287[this.keywordIndex]])||e.writeAttributeString("w","displayText",this.wNamespace,t[n][a._287[this.keywordIndex]]),e.writeAttributeString("w","value",this.wNamespace,t[n][a._286[this.keywordIndex]]),e.writeEndElement()},e.prototype.serializeContentParagraph=function(e,t){for(var n=0;n<t[a._314[this.keywordIndex]].length;n++){var r=t[a._314[this.keywordIndex]][n];if(r.hasOwnProperty(a._267[this.keywordIndex]))for(var s=0;s<r[a._267[this.keywordIndex]].length;s++){var l=r[a._267[this.keywordIndex]][s];i.i(o.isNullOrUndefined)(l[a._4[this.keywordIndex]])||this.serializeCharacterFormat(e,l[a._4[this.keywordIndex]])}}},e.prototype.serializeContentControlDate=function(e,t){t[a._359[this.keywordIndex]]===(1==this.keywordIndex?4:"Date")&&(e.writeStartElement("w","date",this.wNamespace),i.i(o.isNullOrUndefined)(t[a._276[this.keywordIndex]])||(e.writeStartElement("w","calender",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,1==this.keywordIndex?this.getDateCalendarType(t[a._276[this.keywordIndex]]):t[a._276[this.keywordIndex]]),e.writeEndElement()),i.i(o.isNullOrUndefined)(t[a._278[this.keywordIndex]])||(e.writeStartElement("w","lid",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t[a._278[this.keywordIndex]]),e.writeEndElement()),i.i(o.isNullOrUndefined)(t[a._277[this.keywordIndex]])||(e.writeStartElement("w","storeMappedDataAs",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,1==this.keywordIndex?this.getDateStorageFormat(t[a._277[this.keywordIndex]]):t[a._277[this.keywordIndex]]),e.writeEndElement()),i.i(o.isNullOrUndefined)(t[a._279[this.keywordIndex]])||(e.writeStartElement("w","dateFormat",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t[a._279[this.keywordIndex]]),e.writeEndElement()),e.writeEndElement())},e.prototype.serializeBodyItem=function(e,t,n){if(i.i(o.isNullOrUndefined)(t))throw new Error("BodyItem should not be undefined");if(t.hasOwnProperty(a._268[this.keywordIndex]))this.serializeContentControl(e,t[a._268[this.keywordIndex]],t,n);else if(t.hasOwnProperty(a._267[this.keywordIndex]))this.paragraph=t,this.serializeParagraph(e,t,n),this.paragraph=void 0;else{for(var r=t,s=0;s<r[a._298[this.keywordIndex]].length;s++)if(r[a._298[this.keywordIndex]][s][a._297[this.keywordIndex]].length>0){this.serializeTable(e,r);break}var l=this.blockOwner;!n&&l.hasOwnProperty(a._322[this.keywordIndex])&&l[a._314[this.keywordIndex]].indexOf(r)===l[a._314[this.keywordIndex]].length-1&&(e.writeStartElement("w","p",this.wNamespace),e.writeStartElement(void 0,"pPr",this.wNamespace),this.serializeSectionProperties(e,l),e.writeEndElement(),e.writeEndElement())}},e.prototype.serializeParagraph=function(e,t,n){if(i.i(o.isNullOrUndefined)(t))throw new Error("Paragraph should not be undefined");i.i(o.isNullOrUndefined)(this.document.optimizeSfdt)||(this.keywordIndex=this.document.optimizeSfdt?1:0),e.writeStartElement("w","p",this.wNamespace),this.isInsideComment&&e.writeAttributeString("w14","paraId",void 0,this.commentParaID.toString()),e.writeStartElement(void 0,"pPr",this.wNamespace),i.i(o.isNullOrUndefined)(t[a._5[this.keywordIndex]])||this.serializeParagraphFormat(e,t[a._5[this.keywordIndex]],t),i.i(o.isNullOrUndefined)(t[a._4[this.keywordIndex]])||this.serializeCharacterFormat(e,t[a._4[this.keywordIndex]]);var r=this.blockOwner;!n&&r.hasOwnProperty(a._322[this.keywordIndex])&&r[a._314[this.keywordIndex]].indexOf(t)===r[a._314[this.keywordIndex]].length-1&&this.serializeSectionProperties(e,r),e.writeEndElement(),this.prevRevisionIds=[],this.serializeParagraphItems(e,t[a._267[this.keywordIndex]]),this.isBookmarkAtEnd||this.isBookmarkAtRowEnd||e.writeEndElement(),this.isBookmarkAtEnd=!1},e.prototype.serializeRevisionStart=function(e,t,n){if(t.hasOwnProperty(a._64[this.keywordIndex])){if(!i.i(o.isNullOrUndefined)(n)&&n.hasOwnProperty(a._337[this.keywordIndex])&&0===n[a._337[this.keywordIndex]]&&!(n[a._35[this.keywordIndex]].indexOf("_Toc")>=0)&&i.i(o.isNullOrUndefined)(t[a._64[this.keywordIndex]]))return;for(var r=t[a._64[this.keywordIndex]],s=0;s<r.length;s++){var l=this.retrieveRevision(r[s]);"Insertion"===l.revisionType&&this.serializeTrackChanges(e,"ins",l.author,l.date),"Deletion"===l.revisionType&&this.serializeTrackChanges(e,"del",l.author,l.date)}}},e.prototype.serializeTrackChanges=function(e,t,i,n){e.writeStartElement("w",t,this.wNamespace),e.writeAttributeString("w","id",this.wNamespace,(this.trackChangesId++).toString()),"Unknown"!=i&&e.writeAttributeString("w","author",this.wNamespace,i),e.writeAttributeString("w","date",this.wNamespace,n)},e.prototype.retrieveRevision=function(e){for(var t=0;t<this.revisions.length;t++)if(this.revisions[t].revisionID===e)return this.revisions[t]},e.prototype.serializeParagraphItems=function(e,t,n){if(i.i(o.isNullOrUndefined)(t))throw new Error("Paragraph should not be undefined");var r,s=void 0,l=!1;i.i(o.isNullOrUndefined)(this.keywordIndex)&&(this.keywordIndex=n);for(var d=0;d<t.length;d++){var h=t[d];h.hasOwnProperty(a._268[this.keywordIndex])&&(r=!0,this.serializeContentControl(e,h[a._268[this.keywordIndex]],h,void 0,r),this.serializeParagraphItems(e,h[a._267[this.keywordIndex]])),h.hasOwnProperty(a._267[this.keywordIndex])&&this.serializeParagraphItems(e,h),this.serializeRevisionStart(e,h,s);var c=!1;if(h[a._4[this.keywordIndex]]&&(c=!i.i(o.isNullOrUndefined)(h[a._4[this.keywordIndex]][a._53[this.keywordIndex]])&&0!==h[a._4[this.keywordIndex]][a._53[this.keywordIndex]])&&!l&&(this.serializeBiDirectionalOverride(e,h[a._4[this.keywordIndex]]),l=!0),l&&!c&&(e.writeEndElement(),l=!1),h.hasOwnProperty(a._237[this.keywordIndex]))this.serializeFieldCharacter(e,h);else if(h.hasOwnProperty(a._224[this.keywordIndex]))this.serializePicture(e,h);else if(h.hasOwnProperty(a._199[this.keywordIndex])){var p=this.paragraph;this.serializeShape(e,h),this.paragraph=p}else h.hasOwnProperty(a._337[this.keywordIndex])?this.serializeBookMark(e,h):h.hasOwnProperty(a._344[this.keywordIndex])?this.serializeEditRange(e,h):h.hasOwnProperty(a._194[this.keywordIndex])?(this.chart=h,this.serializeChart(e,h),this.serializeChartStructure()):h.hasOwnProperty(a._253[this.keywordIndex])?this.serializeComment(e,h):h.hasOwnProperty(a._263[this.keywordIndex])?this.serializeEFReference(e,h):this.serializeTextRange(e,h,s);this.serializeRevisionEnd(e,h,s),s=h,r&&(e.writeEndElement(),e.writeEndElement(),r=!1)}l&&e.writeEndElement()},e.prototype.serializeEFReference=function(e,t){var i="",n=t[a._314[this.keywordIndex]];t[a._263[this.keywordIndex]]===(1==this.keywordIndex?0:"Footnote")?(e.writeStartElement(void 0,"r",this.wNamespace),this.serializeCharacterFormat(e,t[a._4[this.keywordIndex]]),e.writeStartElement(void 0,"footnoteReference",this.wNamespace),this.document[a._30[this.keywordIndex]][a._336[this.keywordIndex]]&&0===this.efRelationShipId&&(this.efRelationShipId=1),i=this.getEFNextRelationShipID(),e.writeAttributeString(void 0,"id",this.wNamespace,i),this.addFootnotesEndnotes(n,"footnote",i),e.writeEndElement(),e.writeEndElement()):(e.writeStartElement(void 0,"r",this.wNamespace),this.serializeCharacterFormat(e,t[a._4[this.keywordIndex]]),e.writeStartElement(void 0,"endnoteReference",this.wNamespace),i=this.getEFNextRelationShipID(),e.writeAttributeString(void 0,"id",this.wNamespace,i),this.addFootnotesEndnotes(n,"endnote",i),e.writeEndElement(),e.writeEndElement())},e.prototype.addFootnotesEndnotes=function(e,t,i){var n=new a.o;this.endnotesFootnotes.add(t,n),this.endnotesFootnotes.get(t).add(i,e)},e.prototype.serializeEndnotesFootnote=function(e,t){if(0!==this.endnotesFootnotes.length){if(this.endnotesFootnotes.containsKey(t))for(var i=this.endnotesFootnotes.get(t),n=void 0,r=0;r<i.keys.length;r++){var o=i.keys[r];n=i.get(o),"endnote"===t?(this.endnotesPath,this.endnotesRelationPath,this.serializeInlineEndnotes(e,n,o)):(this.footnotesPath,this.footnotesRelationPath,this.serializeInlineFootnotes(e,n,o))}}},e.prototype.serializeInlineEndnotes=function(e,t,i){this.isSerializeFootEndNote="Endnote",this.endNoteFootnote=t;var n=this.blockOwner;this.blockOwner=t,e.writeStartElement("w","endnote",this.wNamespace),e.writeAttributeString(void 0,"id",this.wNamespace,i),this.serializeBodyItems(e,t,!0),e.writeEndElement(),this.blockOwner=n,this.endNoteFootnote=void 0,this.isSerializeFootEndNote=void 0},e.prototype.serializeInlineFootnotes=function(e,t,i){this.isSerializeFootEndNote="Footnote",this.endNoteFootnote=t;var n=this.blockOwner;this.blockOwner=t,e.writeStartElement("w","footnote",this.wNamespace),e.writeAttributeString(void 0,"id",this.wNamespace,i),this.serializeBodyItems(e,t,!0),e.writeEndElement(),this.blockOwner=n,this.endNoteFootnote=void 0,this.isSerializeFootEndNote=void 0},e.prototype.writeEFCommonAttributes=function(e){e.writeAttributeString("xmlns","wpc",void 0,this.wpCanvasNamespace),e.writeAttributeString("xmlns","cx",void 0,this.cxNamespace),e.writeAttributeString("xmlns","aink",void 0,"http://schemas.microsoft.com/office/drawing/2016/ink"),e.writeAttributeString("xmlns","am3d",void 0,"http://schemas.microsoft.com/office/drawing/2017/,odel3d"),this.writeCustom(e),e.writeAttributeString("xmlns","wp14",void 0,this.wpDrawingNamespace),e.writeAttributeString("xmlns","wp",void 0,this.wpNamespace),e.writeAttributeString("xmlns","w",void 0,this.wNamespace),this.writeDup(e),e.writeAttributeString("xmlns","wne",void 0,this.wneNamespace),e.writeAttributeString("xmlns","wps",void 0,this.wpShapeNamespace),e.writeAttributeString("mc","Ignorable",void 0,"w14 w15")},e.prototype.serializeFootnotes=function(){if(!i.i(o.isNullOrUndefined)(this.document[a._30[this.keywordIndex]])){var e=new r.XmlWriter;e.writeStartElement("w","footnotes",this.wNamespace),this.writeEFCommonAttributes(e),e.writeStartElement("w","footnote",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"separator"),e.writeAttributeString(void 0,"id",this.wNamespace,"-1"),this.serializeBodyItems(e,this.document[a._30[this.keywordIndex]][a._334[this.keywordIndex]],!0),e.writeEndElement(),e.writeStartElement("w","footnote",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"continuationSeparator"),e.writeAttributeString(void 0,"id",this.wNamespace,"0"),this.serializeBodyItems(e,this.document[a._30[this.keywordIndex]][a._335[this.keywordIndex]],!0),e.writeEndElement(),this.document[a._30[this.keywordIndex]][a._336[this.keywordIndex]]&&(e.writeStartElement("w","footnote",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"continuationNotice"),e.writeAttributeString(void 0,"id",this.wNamespace,"1"),this.serializeBodyItems(e,this.document[a._30[this.keywordIndex]][a._336[this.keywordIndex]],!0),e.writeEndElement()),this.serializeEndnotesFootnote(e,"footnote"),e.writeEndElement();var t=new n.ZipArchiveItem(e.buffer,this.footnotesPath);this.mArchive.addItem(t)}},e.prototype.serializeEndnotes=function(){if(!i.i(o.isNullOrUndefined)(this.document[a._31[this.keywordIndex]])){var e=new r.XmlWriter;e.writeStartElement("w","endnotes",this.wNamespace),this.writeEFCommonAttributes(e),e.writeStartElement("w","endnote",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"separator"),e.writeAttributeString(void 0,"id",this.wNamespace,"-1"),this.serializeBodyItems(e,this.document[a._31[this.keywordIndex]][a._334[this.keywordIndex]],!0),e.writeEndElement(),e.writeStartElement("w","endnote",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"continuationSeparator"),e.writeAttributeString(void 0,"id",this.wNamespace,"0"),this.serializeBodyItems(e,this.document[a._31[this.keywordIndex]][a._335[this.keywordIndex]],!0),e.writeEndElement(),this.document[a._31[this.keywordIndex]][a._336[this.keywordIndex]]&&(e.writeStartElement("w","endnote",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"continuationNotice"),e.writeAttributeString(void 0,"id",this.wNamespace,"1"),this.serializeBodyItems(e,this.document[a._31[this.keywordIndex]][a._336[this.keywordIndex]],!0),e.writeEndElement()),this.serializeEndnotesFootnote(e,"endnote"),e.writeEndElement();var t=new n.ZipArchiveItem(e.buffer,this.endnotesPath);this.mArchive.addItem(t)}},e.prototype.serializeRevisionEnd=function(e,t,n){if(t.hasOwnProperty(a._64[this.keywordIndex])){if(!i.i(o.isNullOrUndefined)(n)&&n.hasOwnProperty(a._237[this.keywordIndex])&&0===n[a._237[this.keywordIndex]]&&t[a._198[this.keywordIndex]].indexOf("TOC")>=0)return;for(var r=0;r<t[a._64[this.keywordIndex]].length;r++){var s=this.retrieveRevision(t[a._64[this.keywordIndex]][r]);"Insertion"!==s.revisionType&&"Deletion"!==s.revisionType||e.writeEndElement()}}},e.prototype.serializeComment=function(e,t){if(1!==this.mComments.length||""!==this.mComments[0].text){0===t[a._253[this.keywordIndex]]?e.writeStartElement("w","commentRangeStart",this.wNamespace):1===t[a._253[this.keywordIndex]]&&e.writeStartElement("w","commentRangeEnd",this.wNamespace);var n=this.commentId[t[a._252[this.keywordIndex]]];i.i(o.isNullOrUndefined)(n)&&(n=this.commentId[t[a._252[this.keywordIndex]]]=this.currentCommentId++),e.writeAttributeString("w","id",this.wNamespace,n.toString()),e.writeEndElement(),1===t[a._253[this.keywordIndex]]&&this.serializeCommentItems(e,n)}},e.prototype.serializeCommentItems=function(e,t){e.writeStartElement("w","r",this.wNamespace),e.writeStartElement("w","commentReference",this.wNamespace),e.writeAttributeString("w","id",this.wNamespace,t.toString()),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeBiDirectionalOverride=function(e,t){e.writeStartElement(void 0,"bdo",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,1==this.keywordIndex?this.getBiDirectionalOverride(t[a._53[this.keywordIndex]]).toLowerCase():t[a._53[this.keywordIndex]].toLowerCase())},e.prototype.serializeEditRange=function(e,t){t.hasOwnProperty(a._349[this.keywordIndex])?e.writeStartElement("w","permEnd",this.wNamespace):(e.writeStartElement("w","permStart",this.wNamespace),t[a._347[this.keywordIndex]]&&""!==t[a._347[this.keywordIndex]]&&e.writeAttributeString("w","ed",this.wNamespace,t[a._347[this.keywordIndex]]),t[a._348[this.keywordIndex]]&&""!==t[a._348[this.keywordIndex]]&&e.writeAttributeString("w","edGrp",this.wNamespace,t[a._348[this.keywordIndex]].toLowerCase()),t[a._345[this.keywordIndex]]&&-1!==t[a._345[this.keywordIndex]]&&e.writeAttributeString("w","colFirst",this.wNamespace,t[a._345[this.keywordIndex]].toString()),t[a._346[this.keywordIndex]]&&-1!==t[a._346[this.keywordIndex]]&&e.writeAttributeString("w","colLast",this.wNamespace,t[a._346[this.keywordIndex]].toString())),e.writeAttributeString("w","id",this.wNamespace,t[a._344[this.keywordIndex]]),e.writeEndElement()},e.prototype.serializeBookMark=function(e,t){var n=this.getBookmarkId(t[a._35[this.keywordIndex]]),r=t[a._35[this.keywordIndex]];0===t[a._337[this.keywordIndex]]?(e.writeStartElement("w","bookmarkStart",this.wNamespace),e.writeAttributeString("w","name",this.wNamespace,r),i.i(o.isNullOrUndefined)(t[a._338[this.keywordIndex]])||(e.writeAttributeString("w","colFirst",this.wNamespace,t[a._338[this.keywordIndex]][a._345[this.keywordIndex]].toString()),e.writeAttributeString("w","colLast",this.wNamespace,t[a._338[this.keywordIndex]][a._346[this.keywordIndex]].toString()))):1===t[a._337[this.keywordIndex]]&&(i.i(o.isNullOrUndefined)(t[a._338[this.keywordIndex]])||this.isBookmarkAtEnd||this.isBookmarkAtRowEnd||(s.h.parseBoolValue(t[a._338[this.keywordIndex]][a._378[this.keywordIndex]])?(e.writeEndElement(),this.isBookmarkAtEnd=!0):s.h.parseBoolValue(t[a._338[this.keywordIndex]][a._380[this.keywordIndex]])&&(e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),this.isBookmarkAtRowEnd=!0)),e.writeStartElement("w","bookmarkEnd",this.wNamespace)),e.writeAttributeString("w","id",this.wNamespace,n.toString()),e.writeEndElement()},e.prototype.getBookmarkId=function(e){var t=this.bookmarks.indexOf(e);return t<0&&(t=this.bookmarks.length,this.bookmarks.push(e)),t},e.prototype.serializePicture=function(e,t){t[a._204[this.keywordIndex]]>=0&&t[a._205[this.keywordIndex]]>=0&&(e.writeStartElement(void 0,"r",this.wNamespace),this.serializeCharacterFormat(e,t[a._4[this.keywordIndex]]),this.serializeDrawing(e,t),e.writeEndElement())},e.prototype.serializeShape=function(e,t){t[a._204[this.keywordIndex]]>=0&&t[a._205[this.keywordIndex]]>=0&&(e.writeStartElement(void 0,"r",this.wNamespace),this.serializeCharacterFormat(e,t[a._4[this.keywordIndex]]),t[a._203[this.keywordIndex]]>0?this.serializeHorizontalRule(e,t):this.serializeDrawing(e,t),e.writeEndElement())},e.prototype.serializeHorizontalRule=function(e,t){e.writeStartElement(void 0,"pict",this.wNamespace),e.writeStartElement("v","rect",void 0);var i=Math.round(t[a._204[this.keywordIndex]]),n=Math.round(t[a._205[this.keywordIndex]]);if(e.writeAttributeString(void 0,"style",void 0,"width:"+i.toString()+";height:"+n.toString()),t[a._312[this.keywordIndex]]>0){var r=1==this.keywordIndex?this.getShapeHorizontalAlignment(t[a._312[this.keywordIndex]]):t[a._312[this.keywordIndex]].toString();e.writeAttributeString("o","hralign",void 0,r.toLowerCase())}e.writeAttributeString("o","hrstd",void 0,"t"),e.writeAttributeString("o","hr",void 0,"t"),e.writeAttributeString(void 0,"fillcolor",void 0,this.getColor(t[a._209[this.keywordIndex]][a._221[this.keywordIndex]])),e.writeAttributeString(void 0,"stroked",void 0,"f"),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeDrawing=function(e,t){e.writeStartElement(void 0,"drawing",this.wNamespace),t.hasOwnProperty(a._194[this.keywordIndex])?this.serializeInlineCharts(e,t):t[a._210[this.keywordIndex]]===(1==this.keywordIndex?0:"Inline")?this.serializeInlinePictureAndShape(e,t):this.serializeWrappingPictureAndShape(e,t),e.writeEndElement()},e.prototype.serializeWrappingPictureAndShape=function(e,t){i.i(o.isNullOrUndefined)(this.document.optimizeSfdt)||(this.keywordIndex=this.document.optimizeSfdt?1:0),e.writeStartElement("wp","anchor",this.wpNamespace),this.serializePictureAndShapeDistance(e,t),e.writeAttributeString(void 0,"simplePos",void 0,"0"),e.writeAttributeString(void 0,"relativeHeight",void 0,t[a._216[this.keywordIndex]]?Math.abs(t[a._216[this.keywordIndex]]).toString():"0");var n=t[a._210[this.keywordIndex]]&&t[a._210[this.keywordIndex]]===(1==this.keywordIndex?4:"Behind");e.writeAttributeString(void 0,"behindDoc",void 0,n?"1":"0");var r=1==this.keywordIndex?i.i(o.isNullOrUndefined)(t[a._218[this.keywordIndex]])?"0":t[a._218[this.keywordIndex]].toString():t[a._218[this.keywordIndex]]?"1":"0";e.writeAttributeString(void 0,"locked",void 0,r);var l=1==this.keywordIndex?i.i(o.isNullOrUndefined)(t[a._217[this.keywordIndex]])?"0":t[a._217[this.keywordIndex]].toString():t[a._217[this.keywordIndex]]?"1":"0";e.writeAttributeString(void 0,"layoutInCell",void 0,l);var d=1==this.keywordIndex?i.i(o.isNullOrUndefined)(t[a._304[this.keywordIndex]])?"0":t[a._304[this.keywordIndex]].toString():t[a._304[this.keywordIndex]]?"1":"0";e.writeAttributeString(void 0,"allowOverlap",void 0,d),e.writeStartElement("wp","simplePos",this.wpNamespace),e.writeAttributeString(void 0,"x",void 0,"0"),e.writeAttributeString(void 0,"y",void 0,"0"),e.writeEndElement(),e.writeStartElement("wp","positionH",this.wpNamespace);var h=1==this.keywordIndex?this.getHorizontalOrigin(t[a._311[this.keywordIndex]]):t[a._311[this.keywordIndex]].toString();if(e.writeAttributeString(void 0,"relativeFrom",void 0,s.h.formatText("firstlower",h)),t[a._312[this.keywordIndex]]===(1==this.keywordIndex?0:"None")){e.writeStartElement("wp","posOffset",this.wpNamespace);var c=Math.round(t[a._313[this.keywordIndex]]*this.emusPerPoint);e.writeString(c.toString()),e.writeEndElement()}else{e.writeStartElement("wp","align",this.wpNamespace);var p=1==this.keywordIndex?this.getShapeHorizontalAlignment(t[a._312[this.keywordIndex]]):t[a._312[this.keywordIndex]].toString();e.writeString(p.toLowerCase()),e.writeEndElement()}e.writeEndElement(),e.writeStartElement("wp","positionV",this.wpNamespace);var u=1==this.keywordIndex?this.getVerticalOrigin(t[a._309[this.keywordIndex]]):t[a._309[this.keywordIndex]].toString();if(e.writeAttributeString(void 0,"relativeFrom",void 0,s.h.formatText("firstlower",u)),t[a._114[this.keywordIndex]]===(1==this.keywordIndex?0:"None")){e.writeStartElement("wp","posOffset",this.wpNamespace);var g=Math.round(t[a._310[this.keywordIndex]]*this.emusPerPoint);e.writeString(g.toString()),e.writeEndElement()}else{e.writeStartElement("wp","align",this.wpNamespace);var f=1==this.keywordIndex?this.getShapeVerticalAlignment(t[a._114[this.keywordIndex]]):t[a._114[this.keywordIndex]];e.writeString(f.toLowerCase()),e.writeEndElement()}e.writeEndElement(),e.writeStartElement(void 0,"extent",this.wpNamespace);var m=Math.round(t[a._204[this.keywordIndex]]*this.emusPerPoint);e.writeAttributeString(void 0,"cx",void 0,m.toString());var v=Math.round(t[a._205[this.keywordIndex]]*this.emusPerPoint);e.writeAttributeString(void 0,"cy",void 0,v.toString()),e.writeEndElement(),i.i(o.isNullOrUndefined)(t[a._224[this.keywordIndex]])?this.serializeShapeDrawingGraphics(e,t):(this.serializeShapeWrapStyle(e,t),this.serializeDrawingGraphics(e,t)),e.writeEndElement()},e.prototype.serializeInlinePictureAndShape=function(e,t){e.writeStartElement(void 0,"inline",this.wpNamespace),this.writeDefaultDistAttribute(e),e.writeStartElement(void 0,"extent",this.wpNamespace);var n=Math.round(t[a._204[this.keywordIndex]]*this.emusPerPoint);e.writeAttributeString(void 0,"cx",void 0,n.toString());var r=Math.round(t[a._205[this.keywordIndex]]*this.emusPerPoint);e.writeAttributeString(void 0,"cy",void 0,r.toString()),e.writeEndElement(),i.i(o.isNullOrUndefined)(t[a._224[this.keywordIndex]])?this.serializeShapeDrawingGraphics(e,t):(this.serializeShapeWrapStyle(e,t),this.serializeDrawingGraphics(e,t)),e.writeEndElement()},e.prototype.serializePictureAndShapeDistance=function(e,t){var i=t[a._305[this.keywordIndex]]?Math.round(t[a._305[this.keywordIndex]]*this.emusPerPoint).toString():"0";e.writeAttributeString(void 0,"distT",void 0,i);var n=t[a._308[this.keywordIndex]]?Math.round(t[a._308[this.keywordIndex]]*this.emusPerPoint).toString():"0";e.writeAttributeString(void 0,"distB",void 0,n);var r=t[a._307[this.keywordIndex]]?Math.round(t[a._307[this.keywordIndex]]*this.emusPerPoint).toString():"114300";e.writeAttributeString(void 0,"distL",void 0,r);var o=t[a._306[this.keywordIndex]]?Math.round(t[a._306[this.keywordIndex]]*this.emusPerPoint).toString():"114300";e.writeAttributeString(void 0,"distR",void 0,o)},e.prototype.writeDefaultDistAttribute=function(e){e.writeAttributeString(void 0,"distT",void 0,"0"),e.writeAttributeString(void 0,"distB",void 0,"0"),e.writeAttributeString(void 0,"distL",void 0,"0"),e.writeAttributeString(void 0,"distR",void 0,"0")},e.prototype.serializeInlineCharts=function(e,t){e.writeStartElement(void 0,"inline",this.wpNamespace),this.writeDefaultDistAttribute(e),e.writeStartElement(void 0,"extent",this.wpNamespace);var i=Math.round(t[a._204[this.keywordIndex]]*this.emusPerPoint);e.writeAttributeString(void 0,"cx",void 0,i.toString());var n=Math.round(t[a._205[this.keywordIndex]]*this.emusPerPoint);e.writeAttributeString(void 0,"cy",void 0,n.toString()),e.writeEndElement(),e.writeStartElement(void 0,"effectExtent",this.wpNamespace),e.writeAttributeString(void 0,"l",void 0,"0"),e.writeAttributeString(void 0,"t",void 0,"0"),e.writeAttributeString(void 0,"r",void 0,"0"),e.writeAttributeString(void 0,"b",void 0,"0"),e.writeEndElement(),this.serializeDrawingGraphicsChart(e,t),e.writeEndElement()},e.prototype.serializeDrawingGraphicsChart=function(e,t){var i="";i=this.updatechartId(t),e.writeStartElement("wp","docPr",this.wpNamespace),e.writeAttributeString(void 0,"id",void 0,(this.mDocPrID++).toString()),e.writeAttributeString(void 0,"name",void 0,this.getNextChartName()),e.writeEndElement(),e.writeStartElement("wp","cNvGraphicFramePr",this.wpNamespace),e.writeEndElement(),e.writeStartElement("a","graphic",this.aNamespace),e.writeStartElement("a","graphicData",this.aNamespace),e.writeAttributeString(void 0,"uri",void 0,this.chartNamespace),e.writeStartElement("c","chart",this.chartNamespace),e.writeAttributeString("xmlns","r",void 0,this.rNamespace),e.writeAttributeString("r","id",void 0,i),e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},e.prototype.getBase64ImageString=function(e){var t=i.i(o.isNullOrUndefined)(e[a._225[this.keywordIndex]])?this.mImages.get(parseInt(e[a._224[this.keywordIndex]])):this.mImages.get(parseInt(e[a._225[this.keywordIndex]])),n=t[s.h.parseBoolValue(e[a._228[this.keywordIndex]])?1:0];return{imageString:n,metaFileImageString:t[this.startsWith(n,"https://")||this.startsWith(n,"http://")||this.startsWith(n,"file://")?1:0]}},e.prototype.getNextChartName=function(){return"Chart"+ ++this.chartCount},e.prototype.serializeChart=function(e,t){e.writeStartElement("w","r",this.wNamespace),this.serializeCharacterFormat(e,t[a._4[this.keywordIndex]]),this.serializeDrawing(e,t),e.writeEndElement()},e.prototype.serializeChartStructure=function(){this.serializeChartXML(),this.serializeChartColors(),this.serializeChartExcelData(),this.serializeChartRelations(),this.chart=void 0,this.saveExcel()},e.prototype.serializeChartXML=function(){var e="",t=new r.XmlWriter;t.writeStartElement("c","chartSpace",this.chartNamespace),t.writeAttributeString("xmlns","a",void 0,this.aNamespace),t.writeAttributeString("xmlns","r",void 0,this.rNamespace),t.writeAttributeString("xmlns","c16r2",void 0,this.c15Namespace),this.serializeChartData(t,this.chart),t.writeStartElement("c","externalData",this.chartNamespace),t.writeAttributeString("r","id",void 0,"rId1"),t.writeStartElement("c","autoUpdate",this.chartNamespace),t.writeAttributeString(void 0,"val",void 0,"0"),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),e=this.chartPath+"/chart"+this.chartCount+".xml";var i=new n.ZipArchiveItem(t.buffer,e);this.mArchive.addItem(i)},e.prototype.serializeChartColors=function(){var e=new r.XmlWriter,t="";e.writeStartElement("cs","colorStyle",this.csNamespace),e.writeAttributeString("xmlns","a",void 0,this.aNamespace),e.writeAttributeString(void 0,"meth",void 0,"cycle"),e.writeAttributeString(void 0,"id",void 0,"10"),this.serializeChartColor(e),t=this.chartPath+"/colors"+this.chartCount+".xml",e.writeEndElement();var i=new n.ZipArchiveItem(e.buffer,t);this.mArchive.addItem(i),t=""},e.prototype.serializeChartColor=function(e){for(var t=1;t<=6;t++)e.writeStartElement("a","schemeClr",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"accent"+t),e.writeEndElement();e.writeStartElement("cs","variation",this.csNamespace),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"60000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"80000"),e.writeEndElement(),e.writeStartElement("a","lumOff",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"20000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"80000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"60000"),e.writeEndElement(),e.writeStartElement("a","lumOff",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"40000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"50000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"70000"),e.writeEndElement(),e.writeStartElement("a","lumOff",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"30000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"70000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"50000"),e.writeEndElement(),e.writeStartElement("a","lumOff",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"50000"),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeChartExcelData=function(){i.i(o.isNullOrUndefined)(this.excelFiles)&&(this.excelFiles=new a.o),this.mArchiveExcel=new n.ZipArchive,this.mArchiveExcel.compressionLevel="Normal";var e=this.chart[a._194[this.keywordIndex]],t="Scatter_Markers"===e||"Bubble"===e;this.serializeWorkBook(),this.serializeSharedString(t),this.serializeExcelContentTypes(),this.serializeExcelData(t),this.serializeExcelStyles(),this.serializeExcelRelation(),this.serializeExcelGeneralRelations(),this.chartStringCount=0},e.prototype.serializeWorkBook=function(){var e=new r.XmlWriter;this.resetExcelRelationShipId(),e.writeStartElement(void 0,"workbook",void 0),e.writeAttributeString("xmlns","r",void 0,this.rNamespace),e.writeAttributeString("xmlns",void 0,void 0,this.spreadSheetNamespace),e.writeStartElement(void 0,"sheets",void 0),e.writeStartElement(void 0,"sheet",void 0),e.writeAttributeString(void 0,"name",void 0,"Sheet1"),e.writeAttributeString(void 0,"sheetId",void 0,"1"),e.writeAttributeString("r","id",void 0,this.getNextExcelRelationShipID()),e.writeEndElement(),e.writeEndElement(),e.writeEndElement();var t=new n.ZipArchiveItem(e.buffer,"xl/workbook.xml");this.mArchiveExcel.addItem(t)},e.prototype.serializeExcelStyles=function(){var e=new r.XmlWriter;e.writeStartElement(void 0,"styleSheet",void 0),e.writeAttributeString("xmlns","mc",void 0,this.veNamespace),e.writeAttributeString("mc","Ignorable",void 0,"x14ac"),e.writeAttributeString("xmlns","x14ac",void 0,"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"),e.writeAttributeString("xmlns",void 0,void 0,this.spreadSheetNamespace),e.writeEndElement();var t=new n.ZipArchiveItem(e.buffer,"xl/styles.xml");this.mArchiveExcel.addItem(t)},e.prototype.serializeExcelData=function(e){var t="",i=new r.XmlWriter;i.writeStartElement(void 0,"worksheet",void 0),i.writeAttributeString("xmlns","r",void 0,this.rNamespace),i.writeAttributeString("xmlns","x14",void 0,this.spreadSheet9),i.writeAttributeString("xmlns","mc",void 0,this.veNamespace),i.writeAttributeString("xmlns",void 0,void 0,this.spreadSheetNamespace),this.serializeExcelSheet(i,e),i.writeEndElement(),t="xl/worksheets/sheet1.xml";var o=new n.ZipArchiveItem(i.buffer,t);this.mArchiveExcel.addItem(o)},e.prototype.serializeSharedString=function(e){for(var t=this.chart,i=new r.XmlWriter,o="",s=[],l=this.chart[a._194[this.keywordIndex]],d=t[a._186[this.keywordIndex]].length,h=0;h<d;h++){var c=t[a._186[this.keywordIndex]][h],p=c[a._165[this.keywordIndex]],u=p.match(/[a-z]/i);e&&0===h&&s.push("X-Values"),u&&(s.push(c[a._165[this.keywordIndex]]),this.chartStringCount++)}"Bubble"===l&&s.push("Size");for(var g=0;g<t[a._185[this.keywordIndex]].length;g++){var f=t[a._185[this.keywordIndex]][g],m=t[a._191[this.keywordIndex]][a._328[this.keywordIndex]],v=f[a._148[this.keywordIndex]],u=v.match(/[a-z]/i);(u||"m/d/yyyy"===m)&&(s.push(f[a._148[this.keywordIndex]]),this.chartStringCount++)}var y=this.chartStringCount+1;i.writeStartElement(void 0,"sst",void 0),i.writeAttributeString("xmlns",void 0,void 0,this.spreadSheetNamespace),i.writeAttributeString(void 0,"count",void 0,y.toString()),i.writeAttributeString(void 0,"uniqueCount",void 0,y.toString());for(var w=0;w<=s.length;w++)i.writeStartElement(void 0,"si",void 0),i.writeStartElement(void 0,"t",void 0),w!==s.length?i.writeString(s[w]):e||(i.writeAttributeString("xml","space",this.xmlNamespace,"preserve"),i.writeString(" ")),i.writeEndElement(),i.writeEndElement();i.writeEndElement(),o="xl/sharedStrings.xml";var b=new n.ZipArchiveItem(i.buffer,o);this.mArchiveExcel.addItem(b)},e.prototype.serializeExcelSheet=function(e,t){var n,r=this.chart,s="s",l="Bubble"===r[a._194[this.keywordIndex]],d=r[a._185[this.keywordIndex]].length+1,h=r[a._191[this.keywordIndex]][a._328[this.keywordIndex]],c=r[a._186[this.keywordIndex]].length+1;l&&(n=c,c+=1);var p=void 0,u=void 0,g=0;e.writeStartElement(void 0,"sheetData",void 0);for(var f=0;f<d;f++){e.writeStartElement(void 0,"row",void 0),e.writeAttributeString(void 0,"r",void 0,(f+1).toString());for(var m=0;m<c;m++){var v=String.fromCharCode("A".charCodeAt(0)+m)+(f+1).toString();if(e.writeStartElement(void 0,"c",void 0),e.writeAttributeString(void 0,"r",void 0,v),0!==f&&0===m){p=r[a._185[this.keywordIndex]][f-1];var y=p[a._148[this.keywordIndex]],w=y.match(/[a-z]/i);s=i.i(o.isNullOrUndefined)(w)&&"m/d/yyyy"===h?"s":!w||t?"n":"s"}else if(0===f&&0!==m&&m!==n){u=r[a._186[this.keywordIndex]][m-1];var b=u[a._165[this.keywordIndex]],w=b.match(/[a-z]/i);s=w?"s":"n"}else s=0===f&&l&&m===n?"s":0===f&&0===m?"s":"n";if(e.writeAttributeString(void 0,"t",void 0,s),e.writeStartElement(void 0,"v",void 0),0!==f||0!==m||t){if("s"===s&&g<this.chartStringCount)e.writeString(g.toString()),g++;else if(0!==f&&"s"!==s&&0===m&&m!==n)e.writeString(p[a._148[this.keywordIndex]]);else if(0!==m&&"s"!==s&&0===f&&m!==n)e.writeString(u[a._165[this.keywordIndex]]);else if(0!==m&&m!==n){var x=p[a._147[this.keywordIndex]][m-1],C=x[a._146[this.keywordIndex]];e.writeString(C.toString())}else if(l&&m===n){var x=p[a._147[this.keywordIndex]][m-2],I=x[a._248[this.keywordIndex]];e.writeString(I.toString())}}else e.writeString(this.chartStringCount.toString());e.writeEndElement(),e.writeEndElement(),s=""}e.writeEndElement()}e.writeEndElement()},e.prototype.serializeExcelContentTypes=function(){var e=new r.XmlWriter;e.writeStartElement(void 0,"Types","http://schemas.openxmlformats.org/package/2006/content-types"),this.serializeDefaultContentType(e,"xml",this.xmlContentType),this.serializeDefaultContentType(e,"rels",this.relationContentType),this.serializeOverrideContentType(e,"xl/styles.xml","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"),this.serializeOverrideContentType(e,"xl/workbook.xml","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"),this.serializeOverrideContentType(e,"xl/sharedStrings.xml","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"),this.serializeOverrideContentType(e,"xl/worksheets/sheet1.xml","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"),e.writeEndElement();var t=new n.ZipArchiveItem(e.buffer,this.contentTypesPath);this.mArchiveExcel.addItem(t)},e.prototype.serializeExcelRelation=function(){var e=new r.XmlWriter;this.resetExcelRelationShipId();e.writeStartElement(void 0,"Relationships",this.rpNamespace),this.serializeRelationShip(e,this.getNextExcelRelationShipID(),"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","worksheets/sheet1.xml"),this.serializeRelationShip(e,this.getNextExcelRelationShipID(),this.stylesRelType,"styles.xml"),this.serializeRelationShip(e,this.getNextExcelRelationShipID(),"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings","sharedStrings.xml"),e.writeEndElement();var t=new n.ZipArchiveItem(e.buffer,this.excelRelationPath);this.mArchiveExcel.addItem(t)},e.prototype.serializeExcelGeneralRelations=function(){var e=new r.XmlWriter;this.resetExcelRelationShipId(),e.writeStartElement(void 0,"Relationships",this.rpNamespace),this.serializeRelationShip(e,this.getNextExcelRelationShipID(),this.documentRelType,"xl/workbook.xml"),e.writeEndElement();var t=new n.ZipArchiveItem(e.buffer,this.generalRelationPath);this.mArchiveExcel.addItem(t)},e.prototype.getNextExcelRelationShipID=function(){return"rId"+ ++this.eRelationShipId},e.prototype.getNextChartRelationShipID=function(){return"rId"+ ++this.cRelationShipId},e.prototype.serializeChartData=function(e,t){e.writeStartElement("c","date1904",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","lang",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"en-US"),e.writeEndElement(),e.writeStartElement("c","roundedCorners",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("mc","AlternateContent",this.veNamespace),e.writeStartElement("mc","Choice",this.veNamespace),e.writeAttributeString("xmlns","c14",void 0,this.c7Namespace),e.writeAttributeString(void 0,"Requires",void 0,"c14"),e.writeStartElement("c14","style",void 0),e.writeAttributeString(void 0,"val",void 0,"102"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("mc","Fallback",this.veNamespace),e.writeStartElement("c","style",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"2"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("c","chart",this.chartNamespace),i.i(o.isNullOrUndefined)(this.chart[a._193[this.keywordIndex]])||(e.writeStartElement("c","title",this.chartNamespace),this.serializeTextProperties(e,this.chart[a._188[this.keywordIndex]],this.chart[a._193[this.keywordIndex]]),e.writeEndElement()),this.serializeChartPlotArea(e,t),e.writeEndElement(),this.serializeShapeProperties(e,"D9D9D9",!0),e.writeStartElement("c","txPr",this.chartNamespace),e.writeAttributeString("xmlns","c",void 0,this.chartNamespace),e.writeStartElement("a","bodyPr",this.aNamespace),e.writeAttributeString("xmlns","a",void 0,this.aNamespace),e.writeEndElement(),e.writeStartElement("a","lstStyle",this.aNamespace),e.writeAttributeString("xmlns","a",void 0,this.aNamespace),e.writeEndElement(),e.writeStartElement("a","p",this.aNamespace),e.writeAttributeString("xmlns","a",void 0,this.aNamespace),e.writeStartElement("a","pPr",this.aNamespace),e.writeStartElement("a","defRPr",this.aNamespace),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("a","endParaRPr",this.aNamespace),e.writeAttributeString(void 0,"lang",void 0,"en-US"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeChartPlotArea=function(e,t){e.writeStartElement("c","autoTitleDeleted",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","plotArea",this.chartNamespace),e.writeStartElement("c","layout",this.chartNamespace),e.writeEndElement();var n=this.chartType(t),r="pieChart"===n||"doughnutChart"===n,l="scatterChart"===n||"bubbleChart"===n;if(e.writeStartElement("c",n,this.chartNamespace),"barChart"===n){var d="";d="Column_Clustered"===t[a._194[this.keywordIndex]]||"Column_Stacked"===t[a._194[this.keywordIndex]]||"Column_Stacked_100"===t[a._194[this.keywordIndex]]?"col":"bar",e.writeStartElement("c","barDir",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,d),e.writeEndElement()}if(!r&&!l){var h=this.chartGrouping(t[a._194[this.keywordIndex]]);e.writeStartElement("c","grouping",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,h),e.writeEndElement()}"scatterChart"===n&&(e.writeStartElement("c","scatterStyle",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"marker"),e.writeEndElement()),e.writeStartElement("c","varyColors",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement();for(var c="",p=0;p<t[a._186[this.keywordIndex]].length;p++){var u=t[a._186[this.keywordIndex]][p];this.seriesCount=p,e.writeStartElement("c","ser",this.chartNamespace),e.writeStartElement("c","idx",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,p.toString()),e.writeEndElement(),e.writeStartElement("c","order",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,p.toString()),e.writeEndElement(),e.writeStartElement("c","tx",this.chartNamespace),e.writeStartElement("c","strRef",this.chartNamespace),e.writeStartElement("c","f",this.chartNamespace);var g=String.fromCharCode("B".charCodeAt(0)+p);if(c="Sheet1!$"+g,e.writeString(c+"$1"),c=c+"$2:$"+g+"$",e.writeEndElement(),e.writeStartElement("c","strCache",this.chartNamespace),e.writeStartElement("c","ptCount",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"1"),e.writeEndElement(),e.writeStartElement("c","pt",this.chartNamespace),e.writeAttributeString(void 0,"idx",void 0,"0"),e.writeStartElement("c","v",this.chartNamespace),e.writeString(u[a._165[this.keywordIndex]]),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),"Pie"===t[a._194[this.keywordIndex]]||"Doughnut"===t[a._194[this.keywordIndex]]?(this.parseChartDataPoint(e,u),e.writeStartElement("c","explosion",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement()):l||this.parseChartSeriesColor(e,u[a._170[this.keywordIndex]],n),"scatterChart"===n){var f=u[a._170[this.keywordIndex]][0][a._222[this.keywordIndex]][a._150[this.keywordIndex]];e.writeStartElement("c","marker",this.chartNamespace),e.writeStartElement("c","symbol",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"circle"),e.writeEndElement(),e.writeStartElement("c","size",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"5"),e.writeEndElement(),this.serializeShapeProperties(e,f,!1),e.writeEndElement()}u[a._166[this.keywordIndex]]&&this.parseChartDataLabels(e,u[a._166[this.keywordIndex]]),u[a._169[this.keywordIndex]]&&this.parseChartTrendLines(e,u),u[a._167[this.keywordIndex]]&&this.serializeChartErrorBar(e,u),"scatterChart"===n?this.serializeDefaultShapeProperties(e):"bubbleChart"===n&&this.serializeShapeProperties(e,u[a._170[this.keywordIndex]][p][a._222[this.keywordIndex]][a._150[this.keywordIndex]],!1);var m="cat",v="strRef",y="strCache";"scatterChart"===n&&(m="xVal",v="numRef",y="numCache"),e.writeStartElement("c",m,this.chartNamespace),e.writeStartElement("c",v,this.chartNamespace),this.serializeChartCategory(e,t,y),e.writeEndElement(),e.writeEndElement(),this.serializeChartValue(e,c,n),e.writeEndElement()}if(e.writeStartElement("c","dLbls",this.chartNamespace),r&&(e.writeStartElement("c","dLblPos",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"bestFit"),e.writeEndElement()),e.writeStartElement("c","showLegendKey",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","showVal",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","showCatName",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","showSerName",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","showPercent",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","showBubbleSize",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","showLeaderLines",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"1"),e.writeEndElement(),e.writeEndElement(),r){var u=this.chart[a._186[this.keywordIndex]][0],w=0,b=0;u.hasOwnProperty(a._171[this.keywordIndex])&&(w=u[a._171[this.keywordIndex]]),e.writeStartElement("c","firstSliceAng",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,w.toString()),e.writeEndElement(),"Doughnut"===t[a._194[this.keywordIndex]]&&(b=u[a._172[this.keywordIndex]],e.writeStartElement("c","holeSize",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,b.toString()),e.writeEndElement())}"lineChart"===n||l?"bubbleChart"!==n&&(e.writeStartElement("c","smooth",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement()):(e.writeStartElement("c","gapWidth",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,this.chart[a._195[this.keywordIndex]].toString()),e.writeEndElement(),e.writeStartElement("c","overlap",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,this.chart[a._196[this.keywordIndex]].toString()),e.writeEndElement()),"bubbleChart"===n&&(e.writeStartElement("c","sizeRepresents",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"area"),e.writeEndElement());var x=this.chart[a._194[this.keywordIndex]];r||(e.writeStartElement("c","axId",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"335265000"),e.writeEndElement(),e.writeStartElement("c","axId",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"335263360"),e.writeEndElement()),e.writeEndElement();var C="Column_Stacked_100"===x||"Area_Stacked_100"===x||"Bar_Stacked_100"===x||"Line_Stacked_100"===x||"Line_Markers_Stacked_100"===x,I=this.chart[a._191[this.keywordIndex]][a._194[this.keywordIndex]];if(r||(this.serializeCategoryAxis(e,I,C),this.serializeValueAxis(e,I,C)),this.chart.hasOwnProperty(a._197[this.keywordIndex])){var F=this.chart[a._197[this.keywordIndex]],k=0,P=0,T=0,S=0;s.h.parseBoolValue(F[a._180[this.keywordIndex]])&&(S=1),s.h.parseBoolValue(F[a._181[this.keywordIndex]])&&(k=1),s.h.parseBoolValue(F[a._182[this.keywordIndex]])&&(P=1),s.h.parseBoolValue(F[a._183[this.keywordIndex]])&&(T=1),e.writeStartElement("c","dTable",this.chartNamespace),e.writeStartElement("c","showHorzBorder",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,k.toString()),e.writeEndElement(),e.writeStartElement("c","showVertBorder",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,P.toString()),e.writeEndElement(),e.writeStartElement("c","showOutline",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,T.toString()),e.writeEndElement(),e.writeStartElement("c","showKeys",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,S.toString()),e.writeEndElement(),e.writeEndElement()}this.serializeDefaultShapeProperties(e),e.writeEndElement(),i.i(o.isNullOrUndefined)(this.chart[a._190[this.keywordIndex]][a._340[this.keywordIndex]])||this.serializeChartLegend(e),e.writeStartElement("c","plotVisOnly",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"1"),e.writeEndElement(),e.writeStartElement("c","dispBlanksAs",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"gap"),e.writeEndElement()},e.prototype.serializeChartLegend=function(e){var t=this.chartLegendPosition(this.chart[a._190[this.keywordIndex]]),i=this.chart[a._190[this.keywordIndex]][a._188[this.keywordIndex]],n=i[a._145[this.keywordIndex]][a._222[this.keywordIndex]][a._150[this.keywordIndex]];e.writeStartElement("c","legend",this.chartNamespace),e.writeStartElement("c","legendPos",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,t),e.writeEndElement(),e.writeStartElement("c","overlay",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),this.serializeDefaultShapeProperties(e),e.writeStartElement("c","txPr",this.chartNamespace),e.writeStartElement("a","bodyPr",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","lstStyle",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","p",this.aNamespace),this.serializeChartTitleFont(e,i[a._48[this.keywordIndex]],n,i[a._374[this.keywordIndex]]),e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeChartErrorBar=function(e,t){var i=t[a._167[this.keywordIndex]],n=this.errorBarValueType(i[a._359[this.keywordIndex]]),r=0;"Cap"!==i[a._155[this.keywordIndex]]&&(r=1),e.writeStartElement("c","errBars",this.chartNamespace),e.writeStartElement("c","errBarType",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,i[a._154[this.keywordIndex]].toLowerCase()),e.writeEndElement(),e.writeStartElement("c","errValType",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,n),e.writeEndElement(),e.writeStartElement("c","noEndCap",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,r.toString()),e.writeEndElement(),e.writeStartElement("c","val",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,i[a._156[this.keywordIndex]].toString()),e.writeEndElement(),this.serializeShapeProperties(e,"595959",!0),e.writeEndElement()},e.prototype.errorBarValueType=function(e){var t="";switch(e){case"StandardError":t="stdErr";break;case"StandardDeviation":t="stdDev";break;case"Percentage":t="percentage";break;case"Fixed":t="fixedVal";break;default:t="stdErr"}return t},e.prototype.serializeCategoryAxis=function(e,t,i){var n="catAx",r=this.chart[a._191[this.keywordIndex]][a._328[this.keywordIndex]],o=this.chart[a._194[this.keywordIndex]],s="Scatter_Markers"===o||"Bubble"===o;"Time"===t&&(n="dateAx"),s&&(n="valAx"),e.writeStartElement("c",n,this.chartNamespace),e.writeStartElement("c","axId",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"335265000"),e.writeEndElement(),this.serializeAxis(e,"335263360",this.chart[a._191[this.keywordIndex]],r,i),s||(e.writeStartElement("c","auto",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"1"),e.writeEndElement(),e.writeStartElement("c","lblAlgn",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"ctr"),e.writeEndElement(),e.writeStartElement("c","lblOffset",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"100"),e.writeEndElement()),"Time"===t?(e.writeStartElement("c","baseTimeUnit",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"days"),e.writeEndElement()):"Bubble"!==this.chart[a._194[this.keywordIndex]]&&(e.writeStartElement("c","noMultiLvlLbl",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement()),e.writeEndElement()},e.prototype.serializeValueAxis=function(e,t,i){var n=this.chart[a._192[this.keywordIndex]],r="between";"Time"===t&&(r="midCat"),e.writeStartElement("c","valAx",this.chartNamespace),e.writeStartElement("c","axId",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"335263360"),e.writeEndElement(),this.serializeAxis(e,"335265000",n,"General",i),e.writeStartElement("c","crossBetween",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,r),e.writeEndElement(),0===n[a._360[this.keywordIndex]]||i||(e.writeStartElement("c","majorUnit",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,n[a._360[this.keywordIndex]].toString()),e.writeEndElement()),e.writeEndElement()},e.prototype.serializeAxis=function(e,t,i,n,r){e.writeStartElement("c","scaling",this.chartNamespace),e.writeStartElement("c","orientation",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"minMax"),e.writeEndElement(),0===i[a._361[this.keywordIndex]]||r||(e.writeStartElement("c","max",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,i[a._361[this.keywordIndex]].toString()),e.writeEndElement(),e.writeStartElement("c","min",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,i[a._362[this.keywordIndex]].toString()),e.writeEndElement()),e.writeEndElement(),e.writeStartElement("c","delete",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","axPos",this.chartNamespace),"335265000"===t?e.writeAttributeString(void 0,"val",void 0,"l"):e.writeAttributeString(void 0,"val",void 0,"b"),e.writeEndElement(),s.h.parseBoolValue(i[a._363[this.keywordIndex]])&&(e.writeStartElement("c","majorGridlines",this.chartNamespace),this.serializeShapeProperties(e,"D9D9D9",!0),e.writeEndElement()),s.h.parseBoolValue(i[a._364[this.keywordIndex]])&&(e.writeStartElement("c","minorGridlines",this.chartNamespace),this.serializeShapeProperties(e,"F2F2F2",!0),e.writeEndElement()),i[a._193[this.keywordIndex]]&&(e.writeStartElement("c","title",this.chartNamespace),this.serializeTextProperties(e,i[a._188[this.keywordIndex]],i[a._193[this.keywordIndex]]),e.writeEndElement()),e.writeStartElement("c","numFmt",this.chartNamespace),e.writeAttributeString(void 0,"formatCode",void 0,n),e.writeAttributeString(void 0,"sourceLinked",void 0,"1"),e.writeEndElement(),e.writeStartElement("c","majorTickMark",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"none"),e.writeEndElement(),e.writeStartElement("c","minorTickMark",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"none"),e.writeEndElement(),e.writeStartElement("c","tickLblPos",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"nextTo"),e.writeEndElement(),"Bubble"===this.chart[a._194[this.keywordIndex]]?this.serializeShapeProperties(e,"BFBFBF",!0):this.serializeDefaultShapeProperties(e),e.writeStartElement("c","txPr",this.chartNamespace),e.writeStartElement("a","bodyPr",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","p",this.aNamespace),this.serializeChartTitleFont(e,i[a._48[this.keywordIndex]],"595959",i[a._374[this.keywordIndex]]),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("c","crossAx",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,t),e.writeEndElement(),e.writeStartElement("c","crosses",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"autoZero"),e.writeEndElement()},e.prototype.parseChartTrendLines=function(e,t){for(var i=0;i<t[a._169[this.keywordIndex]].length;i++){var n=t[a._169[this.keywordIndex]][i],r=this.chartTrendLineType(n[a._359[this.keywordIndex]]),o=0,l=0;s.h.parseBoolValue(n[a._164[this.keywordIndex]])?l=1:s.h.parseBoolValue(n[a._163[this.keywordIndex]])&&(o=1);var d=t[a._170[this.keywordIndex]][i];e.writeStartElement("c","trendline",this.chartNamespace),e.writeStartElement("c","spPr",this.chartNamespace),e.writeStartElement("a","ln",this.aNamespace),e.writeAttributeString(void 0,"w",void 0,"19050"),this.serializeChartSolidFill(e,d[a._222[this.keywordIndex]][a._150[this.keywordIndex]],!1),e.writeStartElement("a","prstDash",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"sysDot"),e.writeEndElement(),e.writeStartElement("a","round",this.aNamespace),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("c","trendlineType",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,r),e.writeEndElement(),e.writeStartElement("c","forward",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,n[a._160[this.keywordIndex]].toString()),e.writeEndElement(),e.writeStartElement("c","backward",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,n[a._161[this.keywordIndex]].toString()),e.writeEndElement(),"NaN"!==n[a._162[this.keywordIndex]]&&(e.writeStartElement("c","intercept",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,n[a._162[this.keywordIndex]].toString()),e.writeEndElement()),e.writeStartElement("c","dispRSqr",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,o.toString()),e.writeEndElement(),e.writeStartElement("c","dispEq",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,l.toString()),e.writeEndElement(),e.writeEndElement()}},e.prototype.chartTrendLineType=function(e){var t="";switch(e){case"Linear":t="linear";break;case"Exponential":t="exp"}return t},e.prototype.parseChartDataLabels=function(e,t){var i="",n=t[a._340[this.keywordIndex]],r=0,o=0,l=0,d=0,h=0,c=0,p=0;switch(n){case"Center":i="ctr";break;case"Left":i="l";break;case"Right":i="r";break;case"Outside":i="outEnd";break;case"BestFit":i="bestFit";break;case"Bottom":case"OutsideBase":i="inBase";break;case"Inside":i="inEnd";break;case"Above":i="t";break;case"Below":i="b";break;default:i="Automatic"}e.writeStartElement("c","dLbls",this.chartNamespace),this.serializeDefaultShapeProperties(e),e.writeStartElement("c","txPr",this.chartNamespace),e.writeStartElement("a","bodyPr",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","lstStyle",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","p",this.aNamespace),this.serializeChartTitleFont(e,t[a._48[this.keywordIndex]],t[a._49[this.keywordIndex]],t[a._374[this.keywordIndex]]),e.writeEndElement(),e.writeEndElement(),s.h.parseBoolValue(t[a._173[this.keywordIndex]])?r=1:s.h.parseBoolValue(t[a._174[this.keywordIndex]])?o=1:s.h.parseBoolValue(t[a._175[this.keywordIndex]])?l=1:s.h.parseBoolValue(t[a._176[this.keywordIndex]])?d=1:s.h.parseBoolValue(t[a._177[this.keywordIndex]])?h=1:s.h.parseBoolValue(t[a._178[this.keywordIndex]])?c=1:s.h.parseBoolValue(t[a._179[this.keywordIndex]])&&(p=1),"Automatic"!==i&&(e.writeStartElement("c","dLblPos",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,i),e.writeEndElement()),e.writeStartElement("c","showLegendKey",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,r.toString()),e.writeEndElement(),e.writeStartElement("c","showVal",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,h.toString()),e.writeEndElement(),e.writeStartElement("c","showCatName",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,l.toString()),e.writeEndElement(),e.writeStartElement("c","showSerName",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,d.toString()),e.writeEndElement(),e.writeStartElement("c","showPercent",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,c.toString()),e.writeEndElement(),e.writeStartElement("c","showBubbleSize",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,o.toString()),e.writeEndElement(),e.writeStartElement("c","showLeaderLines",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,p.toString()),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeShapeProperties=function(e,t,i){var n=this.chart[a._194[this.keywordIndex]],r="Scatter_Markers"===n||"Bubble"===n;e.writeStartElement("c","spPr",this.chartNamespace),!r||i?(e.writeStartElement("a","ln",this.aNamespace),e.writeAttributeString(void 0,"w",void 0,"9525"),this.serializeChartSolidFill(e,t,!1),e.writeStartElement("a","prstDash",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"solid"),e.writeEndElement(),e.writeStartElement("a","round",this.aNamespace),e.writeEndElement(),e.writeEndElement()):"Scatter_Markers"===n?(this.serializeChartSolidFill(e,t,!1),this.serializeDefaultLineProperties(e)):"Bubble"===n&&(this.serializeChartSolidFill(e,t,!0),this.serializeDefaultLineProperties(e)),e.writeStartElement("a","effectLst",this.aNamespace),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeDefaultShapeProperties=function(e){e.writeStartElement("c","spPr",this.chartNamespace),e.writeStartElement("a","noFill",this.aNamespace),e.writeEndElement(),this.serializeDefaultLineProperties(e),e.writeStartElement("a","effectLst",this.aNamespace),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeDefaultLineProperties=function(e){e.writeStartElement("a","ln",this.aNamespace),e.writeStartElement("a","noFill",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","round",this.aNamespace),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeTextProperties=function(e,t,i){var n=t[a._145[this.keywordIndex]][a._222[this.keywordIndex]][a._150[this.keywordIndex]],r=100*t[a._48[this.keywordIndex]];e.writeStartElement("c","tx",this.chartNamespace),e.writeStartElement("c","rich",this.chartNamespace),e.writeStartElement("a","bodyPr",this.aNamespace),e.writeAttributeString(void 0,"rot",void 0,"0"),e.writeAttributeString(void 0,"vert",void 0,"horz"),e.writeEndElement(),e.writeStartElement("a","lstStyle",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","p",this.aNamespace),this.serializeChartTitleFont(e,t[a._48[this.keywordIndex]],n,t[a._374[this.keywordIndex]]),e.writeStartElement("a","r",this.aNamespace),e.writeStartElement("a","rPr",this.aNamespace),e.writeAttributeString(void 0,"lang",void 0,"en-US"),e.writeAttributeString(void 0,"b",void 0,"0"),e.writeAttributeString(void 0,"sz",void 0,r.toString()),e.writeAttributeString(void 0,"baseline",void 0,"0"),this.serializeChartSolidFill(e,n,!1),this.serializeFont(e,t[a._374[this.keywordIndex]]),e.writeEndElement(),e.writeStartElement("a","t",this.aNamespace),e.writeString(i),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("c","layout",this.chartNamespace),e.writeEndElement(),e.writeStartElement("c","overlay",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),this.serializeDefaultShapeProperties(e),e.writeStartElement("c","txPr",this.chartNamespace),e.writeStartElement("a","bodyPr",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","lstStyle",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","p",this.aNamespace),e.writeEndElement(),this.serializeChartTitleFont(e,t[a._48[this.keywordIndex]],n,t[a._374[this.keywordIndex]]),e.writeEndElement()},e.prototype.serializeChartTitleFont=function(e,t,i,n){var r=100*t;e.writeStartElement("a","pPr",this.aNamespace),e.writeStartElement("a","defRPr",this.aNamespace),e.writeAttributeString(void 0,"lang",void 0,"en-US"),e.writeAttributeString(void 0,"b",void 0,"0"),e.writeAttributeString(void 0,"sz",void 0,r.toString()),e.writeAttributeString(void 0,"baseline",void 0,"0"),this.serializeChartSolidFill(e,i,!1),this.serializeFont(e,n),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeChartSolidFill=function(e,t,i){e.writeStartElement("a","solidFill",this.aNamespace),e.writeStartElement("a","srgbClr",this.aNamespace),"000000"!==t?e.writeAttributeString(void 0,"val",void 0,t):e.writeAttributeString(void 0,"val",void 0,"595959"),"Bubble"===this.chart[a._194[this.keywordIndex]]&&i&&(e.writeStartElement("a","alpha",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"75000"),e.writeEndElement()),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeFont=function(e,t){e.writeStartElement("a","latin",this.aNamespace),e.writeAttributeString(void 0,"typeface",void 0,t),e.writeEndElement(),e.writeStartElement("a","ea",this.aNamespace),e.writeAttributeString(void 0,"typeface",void 0,t),e.writeEndElement(),e.writeStartElement("a","cs",this.aNamespace),e.writeAttributeString(void 0,"typeface",void 0,t),e.writeEndElement()},e.prototype.parseChartSeriesColor=function(e,t,i){for(var n=0;n<t.length;n++){var r=t[n];if(e.writeStartElement("c","spPr",this.chartNamespace),"lineChart"===i&&(e.writeStartElement("a","ln",this.aNamespace),e.writeAttributeString(void 0,"w",void 0,"28575"),e.writeAttributeString(void 0,"cap",void 0,"rnd")),"lineChart"!==i?this.serializeChartSolidFill(e,this.getColor(r[a._222[this.keywordIndex]][a._368[this.keywordIndex]]),!0):this.serializeChartSolidFill(e,r[a._149[this.keywordIndex]][a._221[this.keywordIndex]],!0),"lineChart"!==i&&(e.writeStartElement("a","ln",this.aNamespace),e.writeStartElement("a","noFill",this.aNamespace),e.writeEndElement()),e.writeStartElement("a","round",this.aNamespace),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("a","effectLst",this.aNamespace),e.writeEndElement(),e.writeEndElement(),"lineChart"===i){var o="none",s=0;this.chart[a._186[this.keywordIndex]][n].hasOwnProperty(a._168[this.keywordIndex])&&(o=this.chart[a._186[this.keywordIndex]][n][a._168[this.keywordIndex]][a._157[this.keywordIndex]],s=this.chart[a._186[this.keywordIndex]][n][a._168[this.keywordIndex]][a._159[this.keywordIndex]]),e.writeStartElement("c","marker",this.chartNamespace),e.writeStartElement("c","symbol",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,o.toLowerCase()),e.writeEndElement(),this.chart[a._186[this.keywordIndex]][n].hasOwnProperty(a._168[this.keywordIndex])&&(e.writeStartElement("c","size",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,s.toString()),e.writeEndElement()),e.writeEndElement()}}},e.prototype.parseChartDataPoint=function(e,t){for(var i=t[a._170[this.keywordIndex]],n=[],r=0;r<i.length;r++)n.push(i[r]),e.writeStartElement("c","dPt",this.chartNamespace),e.writeStartElement("c","idx",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,r.toString()),e.writeEndElement(),e.writeStartElement("c","bubble3D",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),this.parseChartSeriesColor(e,n,this.chart[a._194[this.keywordIndex]]),e.writeEndElement(),n=[]},e.prototype.serializeChartCategory=function(e,t,i){var n=t[a._185[this.keywordIndex]],r=n.length;e.writeStartElement("c","f",this.chartNamespace),e.writeString("Sheet1!$A$2:$A$"+(r+1).toString()),e.writeEndElement(),e.writeStartElement("c",i,this.chartNamespace),"numCache"===i&&(e.writeStartElement("c","formatCode",this.chartNamespace),e.writeString("General"),e.writeEndElement()),e.writeStartElement("c","ptCount",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,r.toString()),e.writeEndElement();for(var o=0;o<n.length;o++){var s=n[o];e.writeStartElement("c","pt",this.chartNamespace),e.writeAttributeString(void 0,"idx",void 0,o.toString()),e.writeStartElement("c","v",this.chartNamespace),""!==s[a._148[this.keywordIndex]]&&e.writeString(s[a._148[this.keywordIndex]]),e.writeEndElement(),e.writeEndElement()}e.writeEndElement()},e.prototype.serializeChartValue=function(e,t,i){var n="scatterChart"===i||"bubbleChart"===i,r="val";n&&(r="yVal"),this.serializeChartYValue(e,r,t),"bubbleChart"===i&&(r="bubbleSize",t="Sheet1!$C$2:$C$",this.serializeChartYValue(e,r,t)),"lineChart"!==i&&"scatterChart"!==i||(e.writeStartElement("c","smooth",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement())},e.prototype.serializeChartYValue=function(e,t,i){var n=this.chart,r=n[a._185[this.keywordIndex]],o=r.length;e.writeStartElement("c",t,this.chartNamespace),e.writeStartElement("c","numRef",this.chartNamespace),e.writeStartElement("c","f",this.chartNamespace),e.writeString(i+(o+1).toString()),e.writeEndElement(),e.writeStartElement("c","numCache",this.chartNamespace),e.writeStartElement("c","formatCode",this.chartNamespace),e.writeString("General"),e.writeEndElement(),e.writeStartElement("c","ptCount",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,o.toString()),e.writeEndElement();for(var s=0;s<o;s++)for(var l=r[s],d=0;d<l[a._147[this.keywordIndex]].length;d++)if(d===this.seriesCount){var h=l[a._147[this.keywordIndex]][this.seriesCount];e.writeStartElement("c","pt",this.chartNamespace),e.writeAttributeString(void 0,"idx",void 0,s.toString()),e.writeStartElement("c","v",this.chartNamespace),"bubbleSize"!==t?e.writeString(h[a._146[this.keywordIndex]].toString()):e.writeString(h[a._248[this.keywordIndex]].toString()),e.writeEndElement(),e.writeEndElement()}e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},e.prototype.chartType=function(e){var t=e[a._194[this.keywordIndex]];switch(t){case"Pie":t="pieChart";break;case"Doughnut":t="doughnutChart";break;case"Scatter_Markers":t="scatterChart";break;case"Bubble":t="bubbleChart"}return"Area"!==t&&"Area_Stacked"!==t&&"Area_Stacked_100"!==t||(t="areaChart"),"Bar_Stacked_100"!==t&&"Bar_Stacked"!==t&&"Bar_Clustered"!==t&&"Column_Clustered"!==t&&"Column_Stacked"!==t&&"Column_Stacked_100"!==t||(t="barChart"),"Line"!==t&&"Line_Markers"!==t&&"Line_Markers_Stacked"!==t&&"Line_Stacked"!==t&&"Line_Markers_Stacked_100"!==t&&"Line_Stacked_100"!==t||(t="lineChart"),t},e.prototype.chartGrouping=function(e){var t="standard";return"Bar_Stacked"===e||"Column_Stacked"===e||"Area_Stacked"===e||"Line_Stacked"===e||"Line_Markers_Stacked"===e?t="stacked":"Bar_Stacked_100"===e||"Column_Stacked_100"===e||"Area_Stacked_100"===e||"Line_Stacked_100"===e||"Line_Markers_Stacked_100"===e?t="percentStacked":"Bar_Clustered"!==e&&"Column_Clustered"!==e||(t="clustered"),t},e.prototype.chartLegendPosition=function(e){var t=e[a._340[this.keywordIndex]];switch(t){case"Top":t="t";break;case"Bottom":t="b";break;case"Left":t="l";break;case"Right":t="r";break;case"Corner":t="tr";break;default:t="b"}return t},e.prototype.updatechartId=function(e){var t="";return""===t&&(t=this.addChartRelation(this.documentCharts,e)),t},e.prototype.addChartRelation=function(e,t){var i="";return i=this.getNextRelationShipID(),e.add(i,t),i},e.prototype.startsWith=function(e,t){return t.length>0&&e.substring(0,t.length)===t},e.prototype.serializeShapeDrawingGraphics=function(e,t){var n=t[a._219[this.keywordIndex]];t[a._199[this.keywordIndex]];this.serializeShapeWrapStyle(e,t),e.writeStartElement("wp","docPr",this.wpNamespace),e.writeAttributeString(void 0,"id",void 0,(this.mDocPrID++).toString()),e.writeAttributeString(void 0,"name",void 0,t[a._35[this.keywordIndex]]),e.writeAttributeString(void 0,"title",void 0,t[a._272[this.keywordIndex]]),e.writeEndElement(),e.writeStartElement("a","graphic",this.aNamespace),e.writeStartElement("a","graphicData",this.aNamespace),e.writeAttributeString(void 0,"uri",void 0,this.wpShapeNamespace),e.writeStartElement("wps","wsp",this.wpShapeNamespace),e.writeStartElement("wps","cNvCnPr",this.wpShapeNamespace),e.writeStartElement("a","cxnSpLocks",this.aNamespace),e.writeAttributeString(void 0,"noChangeShapeType",void 0,"1"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("wps","spPr",this.wpShapeNamespace),e.writeAttributeString(void 0,"bwMode",void 0,"auto"),e.writeStartElement("a","xfrm",this.aNamespace),e.writeStartElement("a","off",this.aNamespace),e.writeAttributeString(void 0,"x",void 0,"0"),e.writeAttributeString(void 0,"y",void 0,"0"),e.writeEndElement(),e.writeStartElement("a","ext",this.aNamespace);var r=Math.round(t[a._204[this.keywordIndex]]*this.emusPerPoint);e.writeAttributeString(void 0,"cx",void 0,r.toString());var l=Math.round(t[a._205[this.keywordIndex]]*this.emusPerPoint);e.writeAttributeString(void 0,"cy",void 0,l.toString()),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("a","prstGeom",this.aNamespace),n===(1==this.keywordIndex?3:"StraightConnector")?e.writeAttributeString(void 0,"prst",void 0,"straightConnector1"):n===(1==this.keywordIndex?2:"RoundedRectangle")?e.writeAttributeString(void 0,"prst",void 0,"roundRect"):e.writeAttributeString(void 0,"prst",void 0,"rect"),e.writeStartElement("a","avLst",this.aNamespace),e.writeEndElement(),e.writeEndElement(),t[a._209[this.keywordIndex]]&&t[a._209[this.keywordIndex]][a._221[this.keywordIndex]]&&s.h.parseBoolValue(t[a._209[this.keywordIndex]][a._222[this.keywordIndex]])?(e.writeStartElement("a","solidFill",this.aNamespace),e.writeStartElement("a","srgbClr",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,this.getColor(t[a._209[this.keywordIndex]][a._221[this.keywordIndex]])),e.writeEndElement(),e.writeEndElement()):(e.writeStartElement("a","noFill",this.aNamespace),e.writeEndElement());var d=t[a._208[this.keywordIndex]][a._372[this.keywordIndex]]?t[a._208[this.keywordIndex]][a._372[this.keywordIndex]]*this.emusPerPoint:this.emusPerPoint;if(e.writeStartElement("a","ln",this.aNamespace),e.writeAttributeString(void 0,"w",void 0,Math.round(d).toString()),!i.i(o.isNullOrUndefined)(t[a._208[this.keywordIndex]][a._370[this.keywordIndex]])&&t[a._208[this.keywordIndex]][a._370[this.keywordIndex]]!==(1==this.keywordIndex?3:"None")&&s.h.parseBoolValue(t[a._208[this.keywordIndex]][a._149[this.keywordIndex]])?(e.writeStartElement("a","solidFill",this.aNamespace),e.writeStartElement("a","srgbClr",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,this.getColor(t[a._208[this.keywordIndex]][a._221[this.keywordIndex]])),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("a","round",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","headEnd",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","tailEnd",this.aNamespace),e.writeEndElement()):(e.writeStartElement("a","noFill",this.aNamespace),e.writeEndElement()),e.writeEndElement(),e.writeEndElement(),n!==(1==this.keywordIndex?1:"Rectangle")&&n!==(1==this.keywordIndex?2:"RoundedRectangle")||(e.writeStartElement("wps","txbx",this.wpShapeNamespace),e.writeStartElement(void 0,"txbxContent",this.wNamespace),this.serializeBodyItems(e,t[a._220[this.keywordIndex]][a._314[this.keywordIndex]],!0),e.writeEndElement(),e.writeEndElement()),e.writeStartElement("wps","bodyPr",this.wpShapeNamespace),!i.i(o.isNullOrUndefined)(t[a._220[this.keywordIndex]])){var h=void 0;if(t[a._220[this.keywordIndex]][a._93[this.keywordIndex]]>=0&&(h=Math.round(t[a._220[this.keywordIndex]][a._93[this.keywordIndex]]*this.emusPerPoint).toString(),e.writeAttributeString(void 0,"lIns",void 0,h)),t[a._220[this.keywordIndex]][a._95[this.keywordIndex]]>=0&&(h=Math.round(t[a._220[this.keywordIndex]][a._95[this.keywordIndex]]*this.emusPerPoint).toString(),e.writeAttributeString(void 0,"tIns",void 0,h)),t[a._220[this.keywordIndex]][a._94[this.keywordIndex]]>=0&&(h=Math.round(t[a._220[this.keywordIndex]][a._94[this.keywordIndex]]*this.emusPerPoint).toString(),e.writeAttributeString(void 0,"rIns",void 0,h)),t[a._220[this.keywordIndex]][a._96[this.keywordIndex]]>=0&&(h=Math.round(t[a._220[this.keywordIndex]][a._96[this.keywordIndex]]*this.emusPerPoint).toString(),e.writeAttributeString(void 0,"bIns",void 0,h)),t[a._220[this.keywordIndex]][a._223[this.keywordIndex]]){var c=void 0;c=1==this.keywordIndex?s.h.getTextVerticalAlignment(t[a._220[this.keywordIndex]][a._223[this.keywordIndex]]).toString().toLowerCase():t[a._220[this.keywordIndex]][a._223[this.keywordIndex]].toString().toLowerCase(),e.writeAttributeString(void 0,"anchor",void 0,this.getTextVerticalAlignmentProperty(c))}e.writeAttributeString(void 0,"anchorCtr",void 0,"0")}e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},e.prototype.getTextVerticalAlignmentProperty=function(e){switch(e){case"top":return"t";case"middle":case"center":return"ctr";case"bottom":return"b";default:return e}},e.prototype.serializeShapeWrapStyle=function(e,t){var n=1==this.keywordIndex?this.getTextWrappingStyle(t[a._210[this.keywordIndex]]):t[a._210[this.keywordIndex]];if("Inline"!==n){var r="wrapNone";if(n&&"InFrontOfText"!==n&&"Behind"!==n&&(r="wrap"+n,"Tight"===n&&(r="wrapSquare")),e.writeStartElement("wp",r,this.wpNamespace),n&&"InFrontOfText"!==n&&"Behind"!==n&&!i.i(o.isNullOrUndefined)(t[a._211[this.keywordIndex]])){var s=1==this.keywordIndex?this.getTextWrappingType(t[a._211[this.keywordIndex]]):"Both"===t[a._211[this.keywordIndex]]?"bothSides":t[a._211[this.keywordIndex]].toLowerCase();e.writeAttributeString(void 0,"wrapText",void 0,s)}e.writeEndElement()}},e.prototype.serializeDrawingGraphics=function(e,t){var n,r="",l=this.getBase64ImageString(t),d=l.imageString;if(s.h.parseBoolValue(t[a._228[this.keywordIndex]])&&".svg"!==(n=s.h.formatClippedString(l.metaFileImageString).extension)&&(d=l.metaFileImageString),r=this.updateShapeId(t,!1),e.writeStartElement("wp","docPr",this.wpNamespace),e.writeAttributeString(void 0,"id",void 0,(this.mDocPrID++).toString()),i.i(o.isNullOrUndefined)(t[a._200[this.keywordIndex]])||e.writeAttributeString(void 0,"descr",void 0,t[a._200[this.keywordIndex]]),e.writeAttributeString(void 0,"name",void 0,i.i(o.isNullOrUndefined)(t[a._35[this.keywordIndex]])?"":t[a._35[this.keywordIndex]]),i.i(o.isNullOrUndefined)(t[a._272[this.keywordIndex]])||e.writeAttributeString(void 0,"title",void 0,t[a._272[this.keywordIndex]]),e.writeEndElement(),e.writeStartElement("a","graphic",this.aNamespace),e.writeStartElement("a","graphicData",this.aNamespace),e.writeAttributeString(void 0,"uri",void 0,this.pictureNamespace),e.writeStartElement("pic","pic",this.pictureNamespace),e.writeStartElement("pic","nvPicPr",this.pictureNamespace),e.writeStartElement("pic","cNvPr",this.pictureNamespace),e.writeAttributeString(void 0,"id",void 0,"0"),e.writeAttributeString(void 0,"name",void 0,""),e.writeAttributeString(void 0,"descr",void 0,""),e.writeEndElement(),e.writeStartElement("pic","cNvPicPr",this.pictureNamespace),e.writeStartElement("a","picLocks",this.aNamespace),e.writeAttributeString(void 0,"noChangeAspect",void 0,"1"),e.writeAttributeString(void 0,"noChangeArrowheads",void 0,"1"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("pic","blipFill",this.pictureNamespace),e.writeStartElement("a","blip",this.aNamespace),this.startsWith(d,"data:image"))e.writeAttributeString("r","embed",this.rNamespace,r);else if(this.documentImages.containsKey(r)&&(this.documentImages.remove(r),this.externalImages.add(r,d),e.writeAttributeString(void 0,"link",this.rNamespace,r),!i.i(o.isNullOrUndefined)(l.metaFileImageString)&&(this.startsWith(d,"https://")||this.startsWith(d,"http://")||this.startsWith(d,"file://")))){var h=this.getNextRelationShipID();this.documentImages.add(h,l.metaFileImageString),e.writeAttributeString("r","embed",this.rNamespace,h)}if(".svg"===n&&this.serializeBlipExtensions(e,t),e.writeEndElement(),!i.i(o.isNullOrUndefined)(t[a._229[this.keywordIndex]])&&0!==t[a._229[this.keywordIndex]]||!i.i(o.isNullOrUndefined)(t[a._230[this.keywordIndex]])&&0!==t[a._230[this.keywordIndex]]||!i.i(o.isNullOrUndefined)(t[a._232[this.keywordIndex]])&&0!==t[a._232[this.keywordIndex]]||!i.i(o.isNullOrUndefined)(t[a._231[this.keywordIndex]])&&0!==t[a._231[this.keywordIndex]]){e.writeStartElement("a","srcRect",this.aNamespace);var c=Math.round(1e3*t[a._232[this.keywordIndex]]);e.writeAttributeString(void 0,"l",void 0,c.toString());var p=Math.round(1e3*t[a._229[this.keywordIndex]]);e.writeAttributeString(void 0,"t",void 0,p.toString());var u=Math.round(1e3*t[a._231[this.keywordIndex]]);e.writeAttributeString(void 0,"r",void 0,u.toString());var g=Math.round(1e3*t[a._230[this.keywordIndex]]);e.writeAttributeString(void 0,"b",void 0,g.toString()),e.writeEndElement()}e.writeStartElement("a","stretch",this.aNamespace),e.writeStartElement("a","fillRect",this.aNamespace),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("pic","spPr",this.pictureNamespace),e.writeAttributeString(void 0,"bwMode",void 0,"auto"),e.writeStartElement("a","xfrm",this.aNamespace),e.writeStartElement("a","off",this.aNamespace),e.writeAttributeString(void 0,"x",void 0,"0"),e.writeAttributeString(void 0,"y",void 0,"0"),e.writeEndElement(),e.writeStartElement("a","ext",this.aNamespace);var f=Math.round(t[a._204[this.keywordIndex]]*this.emusPerPoint);e.writeAttributeString(void 0,"cx",void 0,f.toString());var m=Math.round(t[a._205[this.keywordIndex]]*this.emusPerPoint);e.writeAttributeString(void 0,"cy",void 0,m.toString()),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("a","prstGeom",this.aNamespace),e.writeAttributeString(void 0,"prst",void 0,"rect"),e.writeStartElement("a","avLst",this.aNamespace),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeBlipExtensions=function(e,t){e.writeStartElement("a","extLst",this.aNamespace),e.writeStartElement("a","ext",this.aNamespace),e.writeAttributeString(void 0,"uri",void 0,"{96DAC541-7B7A-43D3-8B79-37D633B846F1}"),e.writeStartElement("asvg","svgBlip",this.svgNamespace);var i=this.updateShapeId(t,!0);e.writeAttributeString("r","embed",void 0,i),e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},e.prototype.updateShapeId=function(e,t){var i="",n=this.paragraph;return this.headerFooter?i=this.updateHFImageRels(this.headerFooter,e,t):""===i&&(n.hasOwnProperty(a._322[this.keywordIndex])||n.hasOwnProperty(a._267[this.keywordIndex]))&&(i=this.addImageRelation(t?this.svgImages:this.documentImages,e,t)),i},e.prototype.addImageRelation=function(e,t,i){var n="";return(i?this.svgImageRelationIds.keys.indexOf(parseInt(t[a._224[this.keywordIndex]])):this.imageRelationIds.keys.indexOf(parseInt(t[a._224[this.keywordIndex]])))<0||this.isHeaderFooter?(n=this.getNextRelationShipID(),i?this.svgImageRelationIds.add(parseInt(t[a._224[this.keywordIndex]]),n):this.imageRelationIds.add(parseInt(t[a._224[this.keywordIndex]]),n)):n=i?this.svgImageRelationIds.get(parseInt(t[a._224[this.keywordIndex]])):this.imageRelationIds.get(parseInt(t[a._224[this.keywordIndex]])),e.add(n,t),n},e.prototype.updateHFImageRels=function(e,t,i){for(var n="",r="",o=this.headersFooters.keys,s=0;s<o.length;s++)for(var l=this.headersFooters.get(o[s]),d=l.keys,h=0;h<d.length;h++)if(l.get(d[h])===e){r=d[h];var c=void 0;i?this.headerFooterSvgImages.containsKey(r)?(c=this.headerFooterSvgImages.get(r),n=this.addImageRelation(c,t,!0)):(c=new a.o,n=this.addImageRelation(c,t,!0),this.headerFooterSvgImages.add(r,c)):this.headerFooterImages.containsKey(r)?(c=this.headerFooterImages.get(r),n=this.addImageRelation(c,t,!1)):(c=new a.o,n=this.addImageRelation(c,t,!1),this.headerFooterImages.add(r,c))}return n},e.prototype.serializeTable=function(e,t){if(i.i(o.isNullOrUndefined)(this.keywordIndex)&&(this.keywordIndex=0),!(t[a._298[this.keywordIndex]].length<=0)){var n=this.table;this.table=t,e.writeStartElement(void 0,"tbl",this.wNamespace);var r=t[a._298[this.keywordIndex]][0][a._296[this.keywordIndex]];this.serializeTableFormat(e,r,t),this.serializeTableGrid(e,t);var s=new a.o,l=new a.o,d=new a.o,h=t[a._298[this.keywordIndex]];if(h.length>0)for(var c=0;c<h.length;c++){var p=h[c];if(p[a._297[this.keywordIndex]].length>0){if(p.hasOwnProperty(a._268[this.keywordIndex])){this.serializeContentControl(e,p[a._268[this.keywordIndex]],p);continue}var u=this.row;this.row=p,e.writeStartElement(void 0,"tr",this.wNamespace),this.serializeRowFormat(e,p);for(var g=p[a._297[this.keywordIndex]],f=g.length,m=0,v=0;v<f;v++){var y=g[v],w=y[a._376[this.keywordIndex]];if(y.hasOwnProperty(a._268[this.keywordIndex]))this.serializeContentControl(e,y[a._268[this.keywordIndex]],y);else{var b=y[a._295[this.keywordIndex]];if(w-m>0)for(var x=0===v?0:m+1,C=x;C<w;C++)if(s.containsKey(C)){var I=this.getMergeCellFormat(b,d.get(C),C<y[a._376[this.keywordIndex]]);this.serializeTableCell(e,y,I,!1),s.set(C,s.get(C)-1),1===s.get(C)&&(s.remove(C),d.remove(C),l.containsKey(C)&&l.remove(C)),l.containsKey(C)&&(m+=l.get(C)-1,(C+=l.get(C))>0&&C--)}m=w,b[a._113[this.keywordIndex]]>1&&(s.add(w,b[a._113[this.keywordIndex]]),d.add(w,b)),this.serializeTableCell(e,y,b,!0),b[a._112[this.keywordIndex]]>1&&b[a._113[this.keywordIndex]]>1&&l.add(w,b[a._112[this.keywordIndex]]);for(var F=w+1;;F++)if(s.containsKey(F)){var k=this.getMergeCellFormat(b,d.get(F),F<y[a._376[this.keywordIndex]]);this.serializeTableCell(e,y,k,!1),s.set(F,s.get(F)-1),m++,1===s.get(F)&&(s.remove(F),d.remove(F),l.containsKey(F)&&l.remove(F)),l.containsKey(F)&&(m+=l.get(F)-1,F+=l.get(F))}else if(!(v===f-1&&F<t[a._382[this.keywordIndex]]))break}}this.isBookmarkAtRowEnd||e.writeEndElement(),this.isBookmarkAtRowEnd=!1,this.row=u}}e.writeEndElement(),this.table=n}},e.prototype.getMergeCellFormat=function(e,t,i){var n=t;return i?n[a._85[this.keywordIndex]][a._231[this.keywordIndex]]=e[a._85[this.keywordIndex]][a._232[this.keywordIndex]]:n[a._85[this.keywordIndex]][a._232[this.keywordIndex]]=e[a._85[this.keywordIndex]][a._231[this.keywordIndex]],n},e.prototype.serializeTableCell=function(e,t,i,n){var r=this.blockOwner;if(this.blockOwner=t,e.writeStartElement(void 0,"tc",this.wNamespace),e.writeStartElement(void 0,"tcPr",this.wNamespace),this.serializeCellWidth(e,i),this.serializeCellMargins(e,i),e.writeStartElement(void 0,"tcBorders",this.wNamespace),this.serializeBorders(e,i[a._85[this.keywordIndex]],8,!1),e.writeEndElement(),this.serializeShading(e,t[a._295[this.keywordIndex]][a._128[this.keywordIndex]]),this.serializeTableCellDirection(e,i),this.serializeCellVerticalAlign(e,i[a._114[this.keywordIndex]]),i[a._112[this.keywordIndex]]>1){var o=i[a._112[this.keywordIndex]];e.writeStartElement(void 0,"gridSpan",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,o.toString()),e.writeEndElement()}if(i[a._113[this.keywordIndex]]>1&&(e.writeStartElement(void 0,"vMerge",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,n?"restart":"continue"),e.writeEndElement()),e.writeEndElement(),t&&t[a._314[this.keywordIndex]].length>0)for(var s=0,l=void 0;s<t[a._314[this.keywordIndex]].length;)l=t[a._314[this.keywordIndex]][s],this.serializeBodyItem(e,l,!1),s+=1;else e.writeStartElement(void 0,"p",this.wNamespace),e.writeStartElement(void 0,"pPr",this.wNamespace),e.writeStartElement(void 0,"pStyle",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"Normal"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement();this.isBookmarkAtRowEnd||e.writeEndElement(),this.blockOwner=r},e.prototype.serializeTableGrid=function(e,t){e.writeStartElement(void 0,"tblGrid",this.wNamespace),0!==t[a._381[this.keywordIndex]].length&&this.serializeGridColumns(e,t[a._381[this.keywordIndex]]),e.writeEndElement()},e.prototype.serializeTableRows=function(e,t){var i=new a.o;if(t.length>0)for(var n=0;n<t.length;n++){var r=t[n];if(r[a._297[this.keywordIndex]].length>0){if(r.hasOwnProperty(a._268[this.keywordIndex])){this.serializeContentControl(e,r[a._268[this.keywordIndex]],r);continue}this.serializeRow(e,r,i)}}},e.prototype.serializeRow=function(e,t,i){var n=this.row;this.row=t,e.writeStartElement(void 0,"tr",this.wNamespace),this.serializeRowFormat(e,t),this.serializeCells(e,t[a._297[this.keywordIndex]],i),e.writeEndElement(),this.row=n},e.prototype.serializeRowFormat=function(e,t){if(this.serializeRowMargins(e,t[a._296[this.keywordIndex]]),e.writeStartElement(void 0,"trPr",this.wNamespace),t[a._296[this.keywordIndex]][a._205[this.keywordIndex]]>0){e.writeStartElement(void 0,"trHeight",this.wNamespace),t[a._296[this.keywordIndex]][a._117[this.keywordIndex]]===(1==this.keywordIndex?1:"Exactly")?e.writeAttributeString("w","hRule",this.wNamespace,"exact"):t[a._296[this.keywordIndex]][a._117[this.keywordIndex]]===(1==this.keywordIndex?0:"AtLeast")&&e.writeAttributeString("w","hRule",this.wNamespace,"atLeast");var n=this.roundToTwoDecimal(t[a._296[this.keywordIndex]][a._205[this.keywordIndex]]*this.twentiethOfPoint).toString();e.writeAttributeString("w","val",this.wNamespace,n),e.writeEndElement()}var r=t[a._296[this.keywordIndex]],l=r[a._120[this.keywordIndex]];l>0&&(e.writeStartElement(void 0,"gridBefore",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,l.toString()),e.writeEndElement());var d=r[a._123[this.keywordIndex]];if(d>0&&(e.writeStartElement(void 0,"gridAfter",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,d.toString()),e.writeEndElement()),l>0){switch(e.writeStartElement(void 0,"wBefore",this.wNamespace),r[a._122[this.keywordIndex]]){case"Percent":case 1:var h=this.roundToTwoDecimal(r[a._121[this.keywordIndex]]*this.percentageFactor).toString();e.writeAttributeString("w","w",this.wNamespace,h),e.writeAttributeString("w","type",this.wNamespace,"pct");break;case"Point":case 2:var c=this.roundToTwoDecimal(r[a._121[this.keywordIndex]]*this.twipsInOnePoint).toString();e.writeAttributeString("w","w",this.wNamespace,c),e.writeAttributeString("w","type",this.wNamespace,"dxa")}e.writeEndElement()}if(d>0){switch(e.writeStartElement(void 0,"wAfter",this.wNamespace),r[a._125[this.keywordIndex]]){case"Percent":case 1:var h=this.roundToTwoDecimal(r[a._124[this.keywordIndex]]*this.percentageFactor).toString();e.writeAttributeString("w","val",this.wNamespace,h),e.writeAttributeString("w","type",this.wNamespace,"pct");break;case"Point":case 2:var c=this.roundToTwoDecimal(r[a._124[this.keywordIndex]]*this.twipsInOnePoint).toString();e.writeAttributeString("w","val",this.wNamespace,c),e.writeAttributeString("w","type",this.wNamespace,"dxa")}e.writeEndElement()}s.h.parseBoolValue(r[a._115[this.keywordIndex]])||(e.writeStartElement(void 0,"cantSplit",this.wNamespace),e.writeEndElement()),s.h.parseBoolValue(r[a._116[this.keywordIndex]])&&(e.writeStartElement(void 0,"tblHeader",this.wNamespace),e.writeEndElement()),!i.i(o.isNullOrUndefined)(r[a._64[this.keywordIndex]])&&r[a._64[this.keywordIndex]].length>0&&(this.serializeRevisionStart(e,r,void 0),this.serializeRevisionEnd(e,r,void 0)),e.writeEndElement()},e.prototype.serializeCells=function(e,t,i){for(var n=0;n<t.length;n++)t[n].hasOwnProperty(a._268[this.keywordIndex])?this.serializeContentControl(e,t[n][a._268[this.keywordIndex]],t[n]):this.serializeCell(e,t[n],i)},e.prototype.serializeCell=function(e,t,i){var n=this.blockOwner;if(this.blockOwner=t,e.writeStartElement(void 0,"tc",this.wNamespace),i=this.serializeCellFormat(e,t[a._295[this.keywordIndex]],!0,!0,i),t[a._314[this.keywordIndex]].length>0)for(var r=0,o=void 0;r<t[a._314[this.keywordIndex]].length;)o=t[a._314[this.keywordIndex]][r],this.serializeBodyItem(e,o,!1),r+=1;else e.writeStartElement(void 0,"p",this.wNamespace),e.writeStartElement(void 0,"pPr",this.wNamespace),e.writeStartElement(void 0,"pStyle",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"Normal"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement();e.writeEndElement();var s=1;if(i.containsKey(t[a._376[this.keywordIndex]]+t[a._295[this.keywordIndex]][a._112[this.keywordIndex]]-1+s)&&1===this.row[a._297[this.keywordIndex]].length)for(var l=i.keys[i.keys.length-1];s<=l;)s=this.createCellForMerge(e,t,i,s),s++;else this.createCellForMerge(e,t,i,s);this.blockOwner=n},e.prototype.createCellForMerge=function(e,t,n,r){for(;n.containsKey(t[a._376[this.keywordIndex]]+t[a._295[this.keywordIndex]][a._112[this.keywordIndex]]-1+r)&&(this.row[a._297[this.keywordIndex]].indexOf(t)===this.row[a._297[this.keywordIndex]].length-1||this.row[a._297[this.keywordIndex]].indexOf(t)===t[a._376[this.keywordIndex]])&&void 0===t.nextNode;){var s=t[a._376[this.keywordIndex]]+t[a._295[this.keywordIndex]][a._112[this.keywordIndex]]-1+r;e.writeStartElement(void 0,"tc",this.wNamespace);var l=!0;i.i(o.isNullOrUndefined)(this.spanCellFormat)?(e.writeStartElement(void 0,"tcPr",this.wNamespace),l=!1):(l=!1,n=this.serializeCellFormat(e,this.spanCellFormat,!1,l,n)),this.serializeColumnSpan(s,e),e.writeStartElement(void 0,"vMerge",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"continue"),e.writeEndElement(),i.i(o.isNullOrUndefined)(this.spanCellFormat)&&(e.writeStartElement(void 0,"tcBorders",this.wNamespace),this.serializeBorders(e,t[a._295[this.keywordIndex]][a._85[this.keywordIndex]],8,!1),e.writeEndElement()),l||e.writeEndElement(),n=this.checkMergeCell(s,n),e.writeStartElement("w","p",this.wNamespace),e.writeEndElement(),e.writeEndElement(),r++}return r},e.prototype.serializeCellFormat=function(e,t,i,n,r){var o=this.blockOwner;this.table[a._303[this.keywordIndex]],this.row[a._296[this.keywordIndex]];return e.writeStartElement(void 0,"tcPr",this.wNamespace),this.serializeCellWidth(e,t),this.serializeCellMargins(e,t),i&&(r=this.serializeCellMerge(e,t,r),this.serializeGridSpan(e,o)),e.writeStartElement(void 0,"tcBorders",this.wNamespace),this.serializeBorders(e,t[a._85[this.keywordIndex]],8,!1),e.writeEndElement(),this.serializeShading(e,o[a._295[this.keywordIndex]][a._128[this.keywordIndex]]),this.serializeTableCellDirection(e,t),this.serializeCellVerticalAlign(e,t[a._114[this.keywordIndex]]),n&&e.writeEndElement(),r},e.prototype.serializeCellWidth=function(e,t){e.writeStartElement(void 0,"tcW",this.wNamespace),t[a._131[this.keywordIndex]]===(1==this.keywordIndex?1:"Percent")?(e.writeAttributeString(void 0,"type",this.wNamespace,"pct"),e.writeAttributeString(void 0,"w",this.wNamespace,this.roundToTwoDecimal(t[a._130[this.keywordIndex]]*this.percentageFactor).toString())):t[a._131[this.keywordIndex]]===(1==this.keywordIndex?0:"Auto")?(e.writeAttributeString(void 0,"type",this.wNamespace,"auto"),e.writeAttributeString(void 0,"w",this.wNamespace,"0")):(e.writeAttributeString(void 0,"w",this.wNamespace,this.roundToTwoDecimal(t[a._130[this.keywordIndex]]*this.twipsInOnePoint).toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa")),e.writeEndElement()},e.prototype.serializeCellMerge=function(e,t,i){var n,r=this.blockOwner,o=!1,s=r[a._376[this.keywordIndex]],l=this.row[a._297[this.keywordIndex]].indexOf(r),d=l>0?this.row[a._297[this.keywordIndex]][l-1][a._376[this.keywordIndex]]:r[a._376[this.keywordIndex]];if(r[a._376[this.keywordIndex]]===l?(n=r[a._376[this.keywordIndex]],o=!0):o=!1,!o){0===l&&(s=r[a._376[this.keywordIndex]],d=-1);for(var h=d;h<s;h++)n=d+1,d+=1,0===n&&i.containsKey(n)&&(i=this.createMerge(e,n,r,i))}return t[a._113[this.keywordIndex]]>1?(e.writeStartElement(void 0,"vMerge",this.wNamespace),this.spanCellFormat=t,i.add(n,t[a._113[this.keywordIndex]]-1),t[a._112[this.keywordIndex]]>1&&this.mGridSpans.add(n,t[a._112[this.keywordIndex]]),e.writeAttributeString("w","val",this.wNamespace,"restart"),e.writeEndElement()):i.containsKey(n)&&o&&(i=this.createMerge(e,n,r,i)),i},e.prototype.createMerge=function(e,t,i,n){return this.serializeColumnSpan(t,e),e.writeStartElement(void 0,"vMerge",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"continue"),e.writeEndElement(),e.writeStartElement(void 0,"tcBorders",this.wNamespace),this.serializeBorders(e,i[a._295[this.keywordIndex]][a._85[this.keywordIndex]],8,!1),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("w","p",this.wNamespace),e.writeEndElement(),e.writeEndElement(),e.writeStartElement(void 0,"tc",this.wNamespace),e.writeStartElement(void 0,"tcPr",this.wNamespace),this.serializeCellWidth(e,i[a._295[this.keywordIndex]]),n=this.checkMergeCell(t,n)},e.prototype.serializeColumnSpan=function(e,t){this.mGridSpans.keys.length>0&&this.mGridSpans.containsKey(e)&&(t.writeStartElement(void 0,"gridSpan",this.wNamespace),t.writeAttributeString("w","val",this.wNamespace,this.mGridSpans.get(e).toString()),t.writeEndElement())},e.prototype.checkMergeCell=function(e,t){return t.get(e)-1==0?(t.remove(e),this.spanCellFormat=void 0,this.mGridSpans.keys.length>0&&this.mGridSpans.containsKey(e)&&this.mGridSpans.remove(e)):t.set(e,t.get(e)-1),t},e.prototype.serializeGridSpan=function(e,t){if(t[a._295[this.keywordIndex]][a._112[this.keywordIndex]]>1){var i=t[a._295[this.keywordIndex]][a._112[this.keywordIndex]];e.writeStartElement(void 0,"gridSpan",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,i.toString()),e.writeEndElement()}},e.prototype.serializeTableCellDirection=function(e,t){},e.prototype.serializeCellVerticalAlign=function(e,t){switch(e.writeStartElement(void 0,"vAlign",this.wNamespace),t){case"Center":case 1:e.writeAttributeString("w","val",this.wNamespace,"center");break;case"Bottom":case 2:e.writeAttributeString("w","val",this.wNamespace,"bottom");break;default:e.writeAttributeString("w","val",this.wNamespace,"top")}e.writeEndElement()},e.prototype.serializeGridColumns=function(e,t){for(var i=0,n=t.length;i<n;i++){var r=Math.round(20*t[i]);e.writeStartElement(void 0,"gridCol",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,r.toString()),e.writeEndElement()}},e.prototype.serializeTableFormat=function(e,t,n){e.writeStartElement(void 0,"tblPr",this.wNamespace),this.serializeTablePositioning(e,n),this.serializeTableWidth(e,n),this.serializeTableAlignment(e,n[a._303[this.keywordIndex]]),this.serializeCellSpacing(e,n[a._303[this.keywordIndex]]),this.serializeTableIndentation(e,n[a._303[this.keywordIndex]]),this.serializeTableMargins(e,n[a._303[this.keywordIndex]]),this.serializeTableBorders(e,n[a._303[this.keywordIndex]]),this.serializeShading(e,n[a._303[this.keywordIndex]][a._128[this.keywordIndex]]),s.h.parseBoolValue(n[a._303[this.keywordIndex]][a._52[this.keywordIndex]])&&(e.writeStartElement(void 0,"bidiVisual",this.wNamespace),e.writeEndElement()),this.serializeTblLayout(e,n[a._303[this.keywordIndex]]),i.i(o.isNullOrUndefined)(n)||e.writeEndElement()},e.prototype.serializeTablePositioning=function(e,t){if(s.h.parseBoolValue(t[a._300[this.keywordIndex]])){if(e.writeStartElement("w","tblpPr",this.wNamespace),t[a._302[this.keywordIndex]][a._307[this.keywordIndex]]>0){var n=Math.round(t[a._302[this.keywordIndex]][a._307[this.keywordIndex]]*this.twipsInOnePoint).toString();e.writeAttributeString("w","leftFromText",this.wNamespace,n)}if(t[a._302[this.keywordIndex]][a._306[this.keywordIndex]]>0){var r=Math.round(t[a._302[this.keywordIndex]][a._306[this.keywordIndex]]*this.twipsInOnePoint).toString();e.writeAttributeString("w","rightFromText",this.wNamespace,r)}if(t[a._302[this.keywordIndex]][a._305[this.keywordIndex]]>0){var l=Math.round(t[a._302[this.keywordIndex]][a._305[this.keywordIndex]]*this.twipsInOnePoint).toString();e.writeAttributeString("w","topFromText",this.wNamespace,l)}if(t[a._302[this.keywordIndex]][a._308[this.keywordIndex]]>0){var d=Math.round(t[a._302[this.keywordIndex]][a._308[this.keywordIndex]]*this.twipsInOnePoint).toString();e.writeAttributeString("w","bottomFromText",this.wNamespace,d)}if(!i.i(o.isNullOrUndefined)(t[a._302[this.keywordIndex]][a._309[this.keywordIndex]])){var h=t[a._302[this.keywordIndex]][a._309[this.keywordIndex]]===(1==this.keywordIndex?0:"Paragraph")?"text":1==this.keywordIndex?this.getTableVerticalRelation(t[a._302[this.keywordIndex]][a._309[this.keywordIndex]]).toLowerCase():this.getTableVerticalRelation(this.getTableVerticalRelationEnumValue(t[a._302[this.keywordIndex]][a._309[this.keywordIndex]])).toLowerCase();e.writeAttributeString("w","vertAnchor",this.wNamespace,h)}if(!i.i(o.isNullOrUndefined)(t[a._302[this.keywordIndex]][a._311[this.keywordIndex]])&&t[a._302[this.keywordIndex]][a._311[this.keywordIndex]]!==(1==this.keywordIndex?0:"Column")){var c=1==this.keywordIndex?this.getTableHorizontalRelation(t[a._302[this.keywordIndex]][a._311[this.keywordIndex]]).toLowerCase():t[a._302[this.keywordIndex]][a._311[this.keywordIndex]].toLowerCase();e.writeAttributeString("w","horzAnchor",this.wNamespace,c)}if(!i.i(o.isNullOrUndefined)(t[a._302[this.keywordIndex]][a._312[this.keywordIndex]])&&t[a._302[this.keywordIndex]][a._312[this.keywordIndex]]!==(1==this.keywordIndex?0:"Left")){var p=1==this.keywordIndex?this.getTableHorizontalAlignment(t[a._302[this.keywordIndex]][a._312[this.keywordIndex]]):t[a._302[this.keywordIndex]][a._312[this.keywordIndex]].toLowerCase();e.writeAttributeString("w","tblpXSpec",this.wNamespace,p)}if(!i.i(o.isNullOrUndefined)(t[a._302[this.keywordIndex]][a._114[this.keywordIndex]])&&t[a._302[this.keywordIndex]][a._114[this.keywordIndex]]!==(1==this.keywordIndex?0:"None")){var u=1==this.keywordIndex?this.getTableVerticalAlignment(t[a._302[this.keywordIndex]][a._114[this.keywordIndex]]):t[a._302[this.keywordIndex]][a._114[this.keywordIndex]].toLowerCase();e.writeAttributeString("w","tblpYSpec",this.wNamespace,u)}if((!i.i(o.isNullOrUndefined)(t[a._302[this.keywordIndex]][a._312[this.keywordIndex]])&&t[a._302[this.keywordIndex]][a._312[this.keywordIndex]]===(1==this.keywordIndex?0:"Left")||!t[a._302[this.keywordIndex]][a._312[this.keywordIndex]])&&t[a._302[this.keywordIndex]][a._313[this.keywordIndex]]>0){var g=Math.round(t[a._302[this.keywordIndex]][a._313[this.keywordIndex]]*this.twipsInOnePoint).toString();e.writeAttributeString("w","tblpX",this.wNamespace,g)}if(!i.i(o.isNullOrUndefined)(t[a._302[this.keywordIndex]][a._114[this.keywordIndex]])&&t[a._302[this.keywordIndex]][a._114[this.keywordIndex]]===(1==this.keywordIndex?0:"None")){var f=Math.round(t[a._302[this.keywordIndex]][a._310[this.keywordIndex]]*this.twipsInOnePoint).toString();e.writeAttributeString("w","tblpY",this.wNamespace,f)}e.writeEndElement(),s.h.parseBoolValue(t[a._302[this.keywordIndex]][a._304[this.keywordIndex]])||(e.writeStartElement("w","tblOverlap",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"never"),e.writeEndElement())}i.i(o.isNullOrUndefined)(t[a._299[this.keywordIndex]])||(e.writeStartElement("w","tblDescription",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t[a._299[this.keywordIndex]]),e.writeEndElement()),i.i(o.isNullOrUndefined)(t[a._272[this.keywordIndex]])||(e.writeStartElement("w","tblCaption",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t[a._272[this.keywordIndex]]),e.writeEndElement())},e.prototype.serializeTableMargins=function(e,t){this.serializeMargins(e,t,"tblCellMar")},e.prototype.serializeRowMargins=function(e,t){e.writeStartElement(void 0,"tblPrEx",this.wNamespace),e.writeStartElement(void 0,"tblBorders",this.wNamespace),this.serializeBorders(e,t[a._85[this.keywordIndex]],8,!1),e.writeEndElement(),this.serializeMargins(e,t,"tblCellMar"),e.writeEndElement()},e.prototype.serializeCellMargins=function(e,t){this.serializeMargins(e,t,"tcMar")},e.prototype.serializeMargins=function(e,t,n){if(e.writeStartElement(void 0,n,this.wNamespace),!i.i(o.isNullOrUndefined)(t[a._95[this.keywordIndex]])){var r=Math.round(20*t[a._95[this.keywordIndex]]);e.writeStartElement(void 0,"top",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,r.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),e.writeEndElement()}if(!i.i(o.isNullOrUndefined)(t[a._93[this.keywordIndex]])){var s=Math.round(20*t[a._93[this.keywordIndex]]);e.writeStartElement(void 0,"left",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,s.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),e.writeEndElement()}if(!i.i(o.isNullOrUndefined)(t[a._96[this.keywordIndex]])){var l=Math.round(20*t[a._96[this.keywordIndex]]);e.writeStartElement(void 0,"bottom",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,l.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),e.writeEndElement()}if(!i.i(o.isNullOrUndefined)(t[a._94[this.keywordIndex]])){var d=Math.round(20*t[a._94[this.keywordIndex]]);e.writeStartElement(void 0,"right",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,d.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),e.writeEndElement()}e.writeEndElement()},e.prototype.serializeShading=function(e,t){e.writeStartElement(void 0,"shd",this.wNamespace),t[a._134[this.keywordIndex]]&&"empty"!==t[a._134[this.keywordIndex]]?e.writeAttributeString(void 0,"fill",this.wNamespace,this.getColor(t[a._134[this.keywordIndex]])):e.writeAttributeString(void 0,"fill",this.wNamespace,"auto"),"empty"===t[a._135[this.keywordIndex]]||i.i(o.isNullOrUndefined)(t[a._135[this.keywordIndex]])?e.writeAttributeString(void 0,"color",this.wNamespace,"auto"):e.writeAttributeString(void 0,"color",this.wNamespace,this.getColor(t[a._135[this.keywordIndex]])),i.i(o.isNullOrUndefined)(t[a._133[this.keywordIndex]])||e.writeAttributeString("w","val",this.wNamespace,this.getTextureStyle(t[a._133[this.keywordIndex]])),e.writeEndElement()},e.prototype.getTextureStyle=function(e){switch(e){case"Texture5Percent":case"Texture2Pt5Percent":case"Texture7Pt5Percent":case 1:case 2:case 3:return"pct5";case"Texture10Percent":case 4:return"pct10";case"Texture12Pt5Percent":case 5:return"pct12";case"Texture15Percent":case"Texture17Pt5Percent":case 6:case 7:return"pct15";case"Texture20Percent":case"Texture22Pt5Percent":case 8:case 9:return"pct20";case"Texture25Percent":case"Texture27Pt5Percent":case 10:case 11:return"pct25";case"Texture30Percent":case"Texture32Pt5Percent":case 12:case 13:return"pct30";case"Texture35Percent":case 14:return"pct35";case"Texture37Pt5Percent":case 15:return"pct37";case"Texture40Percent":case"Texture42Pt5Percent":case 16:case 17:return"pct40";case"Texture45Percent":case"Texture47Pt5Percent":case 18:case 19:return"pct45";case"Texture50Percent":case"Texture52Pt5Percent":case 20:case 21:return"pct50";case"Texture55Percent":case"Texture57Pt5Percent":case 22:case 23:return"pct55";case"Texture60Percent":case 24:return"pct60";case"Texture62Pt5Percent":case 25:return"pct62";case"Texture65Percent":case"Texture67Pt5Percent":case 26:case 27:return"pct65";case"Texture70Percent":case"Texture72Pt5Percent":case 28:case 29:return"pct70";case"Texture75Percent":case"Texture77Pt5Percent":case 30:case 31:return"pct75";case"Texture80Percent":case"Texture82Pt5Percent":case 32:case 33:return"pct80";case"Texture85Percent":case 34:return"pct85";case"Texture87Pt5Percent":case 35:return"pct87";case"Texture90Percent":case"Texture92Pt5Percent":case 36:case 37:return"pct90";case"Texture95Percent":case"Texture97Pt5Percent":case 38:case 39:return"pct95";case 40:return"solid";case"TextureCross":return"thinHorzCross";case"TextureDarkCross":return"horzCross";case"TextureDarkDiagonalCross":return"diagCross";case"TextureDarkDiagonalDown":return"reverseDiagStripe";case"TextureDarkDiagonalUp":return"diagStripe";case"TextureDarkHorizontal":case 41:return"horzStripe";case"TextureDarkVertical":case 42:return"vertStripe";case 43:return"reverseDiagStripe";case 44:return"diagStripe";case 45:return"horzCross";case 46:return"diagCross";case"TextureDiagonalCross":return"thinDiagCross";case"TextureDiagonalDown":return"thinReverseDiagStripe";case"TextureDiagonalUp":return"thinDiagStripe";case"TextureHorizontal":case 47:return"thinHorzStripe";case"TextureSolid":return"solid";case"TextureVertical":case 48:return"thinVertStripe";case 49:return"thinReverseDiagStripe";case 50:return"thinDiagStripe";case 51:return"thinHorzCross";case 52:return"thinDiagCross";default:return"clear"}},e.prototype.serializeParagraphBorders=function(e,t){var n=t[a._85[this.keywordIndex]];i.i(o.isNullOrUndefined)(n)||(e.writeStartElement(void 0,"pBdr",this.wNamespace),this.serializeBorders(e,t[a._85[this.keywordIndex]],8,!0),e.writeEndElement())},e.prototype.serializeTableBorders=function(e,t){var n=t[a._85[this.keywordIndex]];i.i(o.isNullOrUndefined)(n)||(e.writeStartElement(void 0,"tblBorders",this.wNamespace),this.serializeBorders(e,t[a._85[this.keywordIndex]],8,!1),e.writeEndElement())},e.prototype.serializeBorders=function(e,t,i,n){this.serializeBorder(e,t[a._229[this.keywordIndex]],"top",i),this.serializeBorder(e,t[a._232[this.keywordIndex]],"left",i),this.serializeBorder(e,t[a._230[this.keywordIndex]],"bottom",i),this.serializeBorder(e,t[a._231[this.keywordIndex]],"right",i),n?(this.serializeBorder(e,t[a._139[this.keywordIndex]],"between",i),this.serializeBorder(e,t[a._138[this.keywordIndex]],"bar",i)):(this.serializeBorder(e,t[a._139[this.keywordIndex]],"insideH",i),this.serializeBorder(e,t[a._138[this.keywordIndex]],"insideV",i),this.serializeBorder(e,t[a._141[this.keywordIndex]],"tl2br",i),this.serializeBorder(e,t[a._140[this.keywordIndex]],"tr2bl",i))},e.prototype.serializeTblLayout=function(e,t){(!s.h.parseBoolValue(t[a._126[this.keywordIndex]])||t[a._130[this.keywordIndex]]>this.containerWidth)&&(e.writeStartElement(void 0,"tblLayout",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"fixed"),e.writeEndElement())},e.prototype.serializeBorder=function(e,t,n,r){var l=t[a._142[this.keywordIndex]],d=(t[a._143[this.keywordIndex]]?t[a._143[this.keywordIndex]]:0)*r,h=t[a._350[this.keywordIndex]]?t[a._350[this.keywordIndex]]:0;if(l===(1==this.keywordIndex?26:"Cleared"))return e.writeStartElement(void 0,n,this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"nil"),void e.writeEndElement();(l===(1==this.keywordIndex?1:"None")||i.i(o.isNullOrUndefined)(l))&&!s.h.parseBoolValue(t[a._137[this.keywordIndex]])||d<0&&!s.h.parseBoolValue(t[a._137[this.keywordIndex]])||(e.writeStartElement(void 0,n,this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.getBorderStyle(l)),t[a._221[this.keywordIndex]]&&e.writeAttributeString(void 0,"color",this.wNamespace,this.getColor(t[a._221[this.keywordIndex]])),e.writeAttributeString(void 0,"sz",this.wNamespace,this.roundToTwoDecimal(d).toString()),e.writeAttributeString(void 0,"space",this.wNamespace,h.toString()),s.h.parseBoolValue(t[a._136[this.keywordIndex]])&&e.writeAttributeString(void 0,"shadow",this.wNamespace,"on"),e.writeEndElement())},e.prototype.getBorderStyle=function(e){switch(e){case"Cleared":return"cleared";case"None":case 1:return"None";case"DashSmallGap":return"dashSmallGap";case"Triple":return"triple";case"Dot":case 2:return"dotted";case 3:return"dashSmallGap";case"DashDot":return"dotDash";case"DashLargeGap":case 4:return"dashed";case 5:return"dotDash";case"DashDotDot":case 6:return"dotDotDash";case"Double":case 7:return"double";case 8:return"triple";case"ThinThickSmallGap":case 9:return"thinThickSmallGap";case"ThickThinSmallGap":case 10:return"thickThinSmallGap";case"ThinThickThinSmallGap":case 11:return"thinThickThinSmallGap";case"ThickThinMediumGap":case 12:return"thickThinMediumGap";case"ThinThickMediumGap":case 13:return"thinThickMediumGap";case"ThinThickThinMediumGap":case 14:return"thinThickThinMediumGap";case"ThickThinLargeGap":return"thickThinLargeGap";case"ThinThickLargeGap":case 15:return"thinThickLargeGap";case 16:return"thickThinLargeGap";case"ThinThickThinLargeGap":case 17:return"thinThickThinLargeGap";case"Thick":return"thick";case"SingleWavy":case 18:return"wave";case"DoubleWavy":case 19:return"doubleWave";case"DashDotStroked":case 20:return"dashDotStroked";case"Engrave3D":return"threeDEngrave";case"Emboss3D":case 21:return"threeDEmboss";case 22:return"threeDEngrave";case"Outset":case 23:return"outset";case"Inset":case 24:return"inset";case 25:return"thick";case 26:return"cleared";default:return"single"}},e.prototype.serializeTableIndentation=function(e,t){if(!i.i(o.isNullOrUndefined)(t[a._69[this.keywordIndex]])){e.writeStartElement(void 0,"tblInd",this.wNamespace);var n=Math.round(t[a._69[this.keywordIndex]]*this.twipsInOnePoint);e.writeAttributeString(void 0,"w",this.wNamespace,n.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),e.writeEndElement()}},e.prototype.serializeCellSpacing=function(e,t){!i.i(o.isNullOrUndefined)(t[a._127[this.keywordIndex]])&&t[a._127[this.keywordIndex]]>0&&(e.writeStartElement(void 0,"tblCellSpacing",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,this.roundToTwoDecimal(t[a._127[this.keywordIndex]]/2*this.twentiethOfPoint).toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),e.writeEndElement())},e.prototype.serializeTableWidth=function(e,t){if(e.writeStartElement(void 0,"tblW",this.wNamespace),t[a._303[this.keywordIndex]][a._131[this.keywordIndex]]===(1==this.keywordIndex?1:"Percent")){var i=Math.round(t[a._303[this.keywordIndex]][a._130[this.keywordIndex]]*this.percentageFactor);e.writeAttributeString(void 0,"w",this.wNamespace,i.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"pct")}else if(t[a._303[this.keywordIndex]][a._131[this.keywordIndex]]===(1==this.keywordIndex?2:"Point")){var i=Math.round(t[a._303[this.keywordIndex]][a._130[this.keywordIndex]]*this.twipsInOnePoint);e.writeAttributeString(void 0,"w",this.wNamespace,i.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa")}else e.writeAttributeString(void 0,"w",this.wNamespace,"0"),e.writeAttributeString(void 0,"type",this.wNamespace,"auto");e.writeEndElement()},e.prototype.serializeTableAlignment=function(e,t){switch(e.writeStartElement(void 0,"jc",this.wNamespace),t[a._129[this.keywordIndex]]){case"Right":e.writeAttributeString("w","val",this.wNamespace,"right");break;case"Center":case 1:e.writeAttributeString("w","val",this.wNamespace,"center");break;case 2:e.writeAttributeString("w","val",this.wNamespace,"right");break;default:e.writeAttributeString("w","val",this.wNamespace,"left")}e.writeEndElement()},e.prototype.serializeFieldCharacter=function(e,t){e.writeStartElement(void 0,"r",this.wNamespace),this.serializeCharacterFormat(e,t[a._4[this.keywordIndex]]),e.writeStartElement(void 0,"fldChar",this.wNamespace);var n=0===t[a._237[this.keywordIndex]]?"begin":1===t[a._237[this.keywordIndex]]?"end":"separate";if(e.writeAttributeString(void 0,"fldCharType",this.wNamespace,n),"begin"===n&&!i.i(o.isNullOrUndefined)(t[a._236[this.keywordIndex]])){var r=t[a._236[this.keywordIndex]];if(e.writeStartElement(void 0,"ffData",this.wNamespace),e.writeStartElement(void 0,"name",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,r[a._35[this.keywordIndex]]),e.writeEndElement(),e.writeStartElement(void 0,"enabled",this.wNamespace),e.writeEndElement(),r.hasOwnProperty(a._241[this.keywordIndex])){e.writeStartElement(void 0,"textInput",this.wNamespace);var s=1==this.keywordIndex?this.getTextFormFieldType(r[a._241[this.keywordIndex]][a._359[this.keywordIndex]]):r[a._241[this.keywordIndex]][a._359[this.keywordIndex]].toString();e.writeStartElement(void 0,"type",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,"Calculation"==s?"calculated":s.toLowerCase()),e.writeEndElement(),e.writeStartElement(void 0,"default",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,r[a._241[this.keywordIndex]][a._245[this.keywordIndex]]),e.writeEndElement(),e.writeStartElement(void 0,"format",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,1==this.keywordIndex&&"Text"===s?this.getTextFormFieldFormat(r[a._241[this.keywordIndex]][a._246[this.keywordIndex]]):r[a._241[this.keywordIndex]][a._246[this.keywordIndex]]),e.writeEndElement(),e.writeEndElement()}else if(r.hasOwnProperty(a._242[this.keywordIndex]))e.writeStartElement(void 0,"checkBox",this.wNamespace),r[a._242[this.keywordIndex]][a._247[this.keywordIndex]]===(1==this.keywordIndex?0:"Auto")?(e.writeStartElement(void 0,"sizeAuto",this.wNamespace),e.writeEndElement()):(e.writeStartElement(void 0,"size",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.roundToTwoDecimal(2*r[a._242[this.keywordIndex]][a._248[this.keywordIndex]]).toString()),e.writeEndElement()),e.writeStartElement(void 0,"defalut",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,r[a._242[this.keywordIndex]][a._245[this.keywordIndex]]?"1":"0"),e.writeEndElement(),r[a._242[this.keywordIndex]][a._249[this.keywordIndex]]&&(e.writeStartElement(void 0,"checked",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,r[a._242[this.keywordIndex]][a._249[this.keywordIndex]]?"1":"0"),e.writeEndElement()),e.writeEndElement();else{e.writeStartElement(void 0,"ddList",this.wNamespace),0!==r[a._243[this.keywordIndex]][a._251[this.keywordIndex]]&&(e.writeStartElement(void 0,"result",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,r[a._243[this.keywordIndex]][a._251[this.keywordIndex]].toString()),e.writeEndElement());for(var l=0;l<r[a._243[this.keywordIndex]][a._250[this.keywordIndex]].length;l++)e.writeStartElement(void 0,"listEntry",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,r[a._243[this.keywordIndex]][a._250[this.keywordIndex]][l].toString()),e.writeEndElement();e.writeEndElement()}e.writeEndElement()}e.writeEndElement(),e.writeEndElement(),0===t[a._237[this.keywordIndex]]&&"FieldFormTextInput"===t[a._237[this.keywordIndex]]&&(e.writeStartElement("w","r",this.wNamespace),e.writeStartElement(void 0,"instrText",this.wNamespace),e.writeAttributeString("xml","space",this.xmlNamespace,"preserve"),e.writeString("FORMTEXT"),e.writeEndElement(),e.writeEndElement())},e.prototype.serializeTextRange=function(e,t,n,r){if(e.writeStartElement("w","r",this.wNamespace),i.i(o.isNullOrUndefined)(t[a._4[this.keywordIndex]])||this.serializeCharacterFormat(e,t[a._4[this.keywordIndex]]),"\t"===t[a._198[this.keywordIndex]])e.writeElementString(void 0,"tab",this.wNamespace,void 0);else if("\v"===t[a._198[this.keywordIndex]])e.writeElementString(void 0,"br",this.wNamespace,void 0);else if(i.i(o.isNullOrUndefined)(t[a._54[this.keywordIndex]]))if("\f"===t[a._198[this.keywordIndex]])e.writeStartElement(void 0,"br",this.wNamespace),e.writeAttributeString("w","type",this.wNamespace,"page"),e.writeEndElement();else if("\r"===t[a._198[this.keywordIndex]])e.writeStartElement("w","cr",this.wNamespace),e.writeEndElement();else if(t[a._198[this.keywordIndex]]===String.fromCharCode(14))e.writeStartElement(void 0,"br",this.wNamespace),e.writeAttributeString("w","type",this.wNamespace,"column"),e.writeEndElement();else if("%02"===encodeURI(t[a._198[this.keywordIndex]]))e.writeStartElement(void 0,"footnoteRef",this.wNamespace),e.writeEndElement();else if("%02"===encodeURI(t[a._198[this.keywordIndex]])&&"endnote"===r)e.writeStartElement(void 0,"endnoteRef",this.wNamespace),e.writeEndElement();else if("%03"===encodeURI(t[a._198[this.keywordIndex]]))e.writeStartElement(void 0,"separator",this.wNamespace),e.writeEndElement();else if("%04"===encodeURI(t[a._198[this.keywordIndex]]))e.writeStartElement(void 0,"continuationSeparator",this.wNamespace),e.writeEndElement();else{var s=this.retrieveDeleteRevision(t),l=!i.i(o.isNullOrUndefined)(n)&&n.hasOwnProperty(a._237[this.keywordIndex])&&2!==n[a._237[this.keywordIndex]],d=l?s?"delInstrText":"instrText":s?"delText":"t";e.writeStartElement(void 0,d,this.wNamespace),e.writeAttributeString("xml","space",this.xmlNamespace,"preserve"),e.writeString(t[a._198[this.keywordIndex]]),e.writeEndElement()}else e.writeStartElement(void 0,"br",this.wNamespace),e.writeAttributeString("w","type",this.wNamespace,"textWrapping"),e.writeAttributeString("w","clear",this.wNamespace,this.getBreakClearType(t[a._54[this.keywordIndex]]).toString().toLowerCase()),e.writeEndElement();e.writeEndElement()},e.prototype.retrieveDeleteRevision=function(e){if(e.hasOwnProperty(a._64[this.keywordIndex])&&e[a._64[this.keywordIndex]].length>0)for(var t=0;t<e[a._64[this.keywordIndex]].length;t++)if("Deletion"===this.retrieveRevision(e[a._64[this.keywordIndex]][t]).revisionType)return!0;return!1},e.prototype.serializeParagraphFormat=function(e,t,n,r){i.i(o.isNullOrUndefined)(t)||(i.i(o.isNullOrUndefined)(this.keywordIndex)&&(this.keywordIndex=r),this.serializeParagraphBorders(e,t),i.i(o.isNullOrUndefined)(t[a._51[this.keywordIndex]])||(e.writeStartElement(void 0,"pStyle",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t[a._51[this.keywordIndex]]),e.writeEndElement()),i.i(o.isNullOrUndefined)(n)?this.serializeListFormat(e,t[a._79[this.keywordIndex]]):this.serializeListFormat(e,n[a._5[this.keywordIndex]][a._79[this.keywordIndex]]),s.h.parseBoolValue(t[a._52[this.keywordIndex]])&&(e.writeStartElement(void 0,"bidi",this.wNamespace),e.writeEndElement()),i.i(o.isNullOrUndefined)(t[a._80[this.keywordIndex]])||(e.writeStartElement(void 0,"keepNext",this.wNamespace),s.h.parseBoolValue(t[a._80[this.keywordIndex]])||e.writeAttributeString("w","val",this.wNamespace,"0"),e.writeEndElement()),i.i(o.isNullOrUndefined)(t[a._82[this.keywordIndex]])||(e.writeStartElement(void 0,"keepLines",this.wNamespace),s.h.parseBoolValue(t[a._82[this.keywordIndex]])||e.writeAttributeString("w","val",this.wNamespace,"0"),e.writeEndElement()),i.i(o.isNullOrUndefined)(t[a._83[this.keywordIndex]])||(e.writeStartElement(void 0,"outlineLvl",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.getOutlineLevelValue(t[a._83[this.keywordIndex]]).toString()),e.writeEndElement()),this.serializeParagraphSpacing(e,t),i.i(o.isNullOrUndefined)(t[a._84[this.keywordIndex]])||(e.writeStartElement("w","contextualSpacing",this.wNamespace),s.h.parseBoolValue(t[a._84[this.keywordIndex]])||e.writeAttributeString("w","val",this.wNamespace,"0"),e.writeEndElement()),i.i(o.isNullOrUndefined)(t[a._81[this.keywordIndex]])||(e.writeStartElement("w","widowControl",this.wNamespace),s.h.parseBoolValue(t[a._81[this.keywordIndex]])?e.writeAttributeString("w","val",this.wNamespace,"1"):e.writeAttributeString("w","val",this.wNamespace,"0"),e.writeEndElement()),this.serializeIndentation(e,t),this.serializeParagraphAlignment(e,t[a._72[this.keywordIndex]],s.h.parseBoolValue(t[a._52[this.keywordIndex]])),!i.i(o.isNullOrUndefined)(t[a._86[this.keywordIndex]])&&t[a._86[this.keywordIndex]].length>0&&this.serializeTabs(e,t[a._86[this.keywordIndex]]))},e.prototype.getOutlineLevelValue=function(e){if(1==this.keywordIndex){if(e>0)return e-1}else if(-1!==e.toString().indexOf("Level")){var t=parseInt(e.toString().substring(5),10);if(t>0)return t-1}return 9},e.prototype.serializeTabs=function(e,t){e.writeStartElement("w","tabs",this.wNamespace);for(var i=0;i<t.length;i++)this.serializeTab(e,t[i]);e.writeEndElement()},e.prototype.serializeTab=function(e,t){var n=0;e.writeStartElement("w","tab",this.wNamespace),0===t[a._340[this.keywordIndex]]&&0!==t[a._341[this.keywordIndex]]?(n=t[a._341[this.keywordIndex]]*this.twentiethOfPoint,e.writeAttributeString("w","val",this.wNamespace,"clear")):(n=t[a._340[this.keywordIndex]]*this.twentiethOfPoint,e.writeAttributeString("w","val",this.wNamespace,this.getTabJustification(t[a._339[this.keywordIndex]]))),i.i(o.isNullOrUndefined)(t[a._343[this.keywordIndex]])||t[a._343[this.keywordIndex]]===(1==this.keywordIndex?0:"None")||e.writeAttributeString("w","leader",this.wNamespace,this.getTabLeader(t[a._343[this.keywordIndex]])),isNaN(n)||e.writeAttributeString("w","pos",this.wNamespace,n.toString()+""),e.writeEndElement()},e.prototype.getTextWrappingType=function(e){switch(e){case 0:return"bothSides";case 1:return"left";case 2:return"right";case 3:return"largest";default:return"bothSides"}},e.prototype.getTextWrappingStyle=function(e){switch(e){case 1:return"InFrontOfText";case 2:return"Square";case 3:return"TopAndBottom";case 4:return"Behind";default:return"Inline"}},e.prototype.getDateStorageFormat=function(e){switch(e){case 2:return"DateStorageDateTime";case 3:return"DateStorageText";default:return"DateStorageDate"}},e.prototype.getDateCalendarType=function(e){switch(e){case 1:return"GregorianArabic";case 2:return"GregorianEnglish";case 3:return"GregorianMiddleEastFrench";case 4:return"GregorianTransliteratedEnglish";case 5:return"GregorianTransliteratedFrench";case 6:return"Hebrew";case 7:return"Hijri";case 8:return"Japan";case 9:return"Korean";case 10:return"Saka";case 11:return"Taiwan";case 12:return"Thai";default:return"Gregorian"}},e.prototype.getContentControlAppearance=function(e){switch(e){case 2:return"Hidden";case 3:return"Tags";default:return"BoundingBox"}},e.prototype.getTextFormFieldFormat=function(e){switch(e){case 1:return"FirstCapital";case 2:return"Lowercase";case 3:return"Uppercase";case 4:return"Titlecase";default:return"None"}},e.prototype.getTextFormFieldType=function(e){switch(e){case 1:return"Number";case 2:return"Date";case 3:return"Calculation";default:return"Text"}},e.prototype.getTabLeader=function(e){switch(e){case"Dot":case 2:return"dot";case"Hyphen":case 3:return"hyphen";case"Underscore":case 4:return"underscore";default:return"none"}},e.prototype.getTabJustification=function(e){switch(e){case"Bar":case 0:return"left";case 1:return"bar";case"Center":case 2:return"center";case"Decimal":case 3:return"decimal";case"Left":return"left";case"List":case 4:return"num";case"Right":case 5:return"right";default:return"clear"}},e.prototype.getTableVerticalAlignment=function(e){switch(e){case 1:return"top";case 2:return"center";case 3:return"bottom";case 4:return"inside";case 5:return"outside";default:return"none"}},e.prototype.getTableHorizontalAlignment=function(e){switch(e){case 1:return"center";case 2:return"inside";case 3:return"outside";case 4:return"right";default:return"left"}},e.prototype.getTableVerticalRelationEnumValue=function(e){switch(e){case"Paragraph":return 0;case"Margin":return 1;case"Page":return 2;default:return 0}},e.prototype.getTableVerticalRelation=function(e){switch(e){case 1:return"Margin";case 2:return"Page";default:return"Paragraph"}},e.prototype.getTableHorizontalRelation=function(e){switch(e){case 1:return"Margin";case 2:return"Page";default:return"Column"}},e.prototype.getVerticalOrigin=function(e){switch(e){case 1:return"BottomMargin";case 2:return"InsideMargin";case 3:return"Line";case 4:return"Margin";case 5:return"OutsideMargin";case 6:return"Page";case 7:return"TopMargin";default:return"Paragraph"}},e.prototype.getHorizontalOrigin=function(e){switch(e){case 1:return"Character";case 2:return"InsideMargin";case 3:return"LeftMargin";case 4:return"Margin";case 5:return"OutsideMargin";case 6:return"Page";case 7:return"RightMargin";default:return"Column"}},e.prototype.getShapeVerticalAlignment=function(e){switch(e){case 1:return"Top";case 2:return"Center";case 3:return"Bottom";case 4:return"Inline";case 5:return"Inside";case 6:return"Outside";default:return"None"}},e.prototype.getShapeHorizontalAlignment=function(e){switch(e){case 1:return"Center";case 2:return"Inside";case 3:return"Left";case 4:return"Outside";case 5:return"Right";default:return"None"}},e.prototype.getBiDirectionalOverride=function(e){switch(e){case 1:return"LTR";case 2:return"RTL";default:return"None"}},e.prototype.getBreakClearType=function(e){switch(e){case 0:return"None";case 1:return"Left";case 2:return"Right";case 3:return"All";default:return e}},e.prototype.serializeListFormat=function(e,t){if(!i.i(o.isNullOrUndefined)(t[a._65[this.keywordIndex]])||!i.i(o.isNullOrUndefined)(t[a._68[this.keywordIndex]])){if(e.writeStartElement(void 0,"numPr",this.wNamespace),i.i(o.isNullOrUndefined)(t[a._68[this.keywordIndex]])||-1===t[a._68[this.keywordIndex]]||(e.writeStartElement(void 0,"ilvl",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t[a._68[this.keywordIndex]].toString()),e.writeEndElement()),!i.i(o.isNullOrUndefined)(t[a._65[this.keywordIndex]])){e.writeStartElement(void 0,"numId",this.wNamespace);var n=(t[a._65[this.keywordIndex]]+1).toString();e.writeAttributeString("w","val",this.wNamespace,n),e.writeEndElement()}e.writeEndElement()}},e.prototype.serializeParagraphAlignment=function(e,t,n){if(!i.i(o.isNullOrUndefined)(t)){e.writeStartElement(void 0,"jc",this.wNamespace);var r=void 0;switch(t){case"Center":case 1:r="center";break;case"Right":case 2:r="right";break;case"Justify":case 3:r="both";break;default:r="left"}e.writeAttributeString("w","val",this.wNamespace,r),e.writeEndElement()}},e.prototype.serializeParagraphSpacing=function(e,t){if(e.writeStartElement(void 0,"spacing",this.wNamespace),i.i(o.isNullOrUndefined)(t[a._74[this.keywordIndex]])||e.writeAttributeString(void 0,"before",this.wNamespace,this.roundToTwoDecimal(t[a._74[this.keywordIndex]]*this.twentiethOfPoint).toString()),!i.i(o.isNullOrUndefined)(t[a._76[this.keywordIndex]])){var n=1==this.keywordIndex?t[a._76[this.keywordIndex]].toString():t[a._76[this.keywordIndex]]?"1":"0";e.writeAttributeString(void 0,"beforeAutospacing",this.wNamespace,n)}if(i.i(o.isNullOrUndefined)(t[a._73[this.keywordIndex]])||e.writeAttributeString(void 0,"after",this.wNamespace,this.roundToTwoDecimal(t[a._73[this.keywordIndex]]*this.twentiethOfPoint).toString()),!i.i(o.isNullOrUndefined)(t[a._75[this.keywordIndex]])){var n=1==this.keywordIndex?t[a._75[this.keywordIndex]].toString():t[a._75[this.keywordIndex]]?"1":"0";e.writeAttributeString(void 0,"afterAutospacing",this.wNamespace,n)}if(!i.i(o.isNullOrUndefined)(t[a._77[this.keywordIndex]])){var r=t[a._78[this.keywordIndex]]===(1==this.keywordIndex?1:"AtLeast")||t[a._78[this.keywordIndex]]===(1==this.keywordIndex?2:"Exactly")?this.roundToTwoDecimal(t[a._77[this.keywordIndex]]*this.twentiethOfPoint):this.roundToTwoDecimal(240*t[a._77[this.keywordIndex]]);e.writeAttributeString(void 0,"line",this.wNamespace,r.toString())}if(!i.i(o.isNullOrUndefined)(t[a._78[this.keywordIndex]])){var s="auto";t[a._78[this.keywordIndex]]===(1==this.keywordIndex?1:"AtLeast")?s="atLeast":t[a._78[this.keywordIndex]]===(1==this.keywordIndex?2:"Exactly")&&(s="exact"),e.writeAttributeString(void 0,"lineRule",this.wNamespace,s)}e.writeEndElement()},e.prototype.serializeIndentation=function(e,t){e.writeStartElement(void 0,"ind",this.wNamespace),i.i(o.isNullOrUndefined)(t[a._69[this.keywordIndex]])||e.writeAttributeString(void 0,"left",this.wNamespace,this.roundToTwoDecimal(t[a._69[this.keywordIndex]]*this.twipsInOnePoint).toString()),i.i(o.isNullOrUndefined)(t[a._70[this.keywordIndex]])||e.writeAttributeString(void 0,"right",this.wNamespace,this.roundToTwoDecimal(t[a._70[this.keywordIndex]]*this.twipsInOnePoint).toString()),i.i(o.isNullOrUndefined)(t[a._71[this.keywordIndex]])||(t[a._71[this.keywordIndex]]<0?e.writeAttributeString(void 0,"hanging",this.wNamespace,this.roundToTwoDecimal(-1*t[a._71[this.keywordIndex]]*this.twipsInOnePoint).toString()):e.writeAttributeString(void 0,"firstLine",this.wNamespace,this.roundToTwoDecimal(t[a._71[this.keywordIndex]]*this.twipsInOnePoint).toString())),e.writeEndElement()},e.prototype.serializeCustomXMLMapping=function(e,t){if(e.length>0)for(var i=e.keys,o=0;o<i.length;o++){var s=new r.XmlWriter;s.writeStartElement(void 0,"Relationships",this.rpNamespace);var a=this.mCustomXML.get(i[o]),l=i[o],d=this.getNextRelationShipID(),h=o+1,c=this.createXMLItem(a,d,h),p=this.createXMLItemProps(l,h);this.serializeRelationShip(t,d,this.customXmlRelType,"../"+c),this.customXMLRelation(s,h,p),s.writeEndElement();var u=new n.ZipArchiveItem(s.buffer,this.customXMLRelPath+h+".xml.rels");this.mArchive.addItem(u)}},e.prototype.customXMLRelation=function(e,t,i){this.serializeRelationShip(e,"rId1",this.wordMLCustomXmlPropsRelType,i)},e.prototype.createXMLItem=function(e,t,i){var r=new Blob([e],{type:"text/plain"}),o=this.customXMLItemsPath+i+".xml",s=new n.ZipArchiveItem(r,o);return this.mArchive.addItem(s),o},e.prototype.createXMLItemProps=function(e,t){var i=new r.XmlWriter,o=this.customXMLItemsPropspath+t+".xml",s=this.itemPropsPath+t+".xml";i.writeStartElement("ds","datastoreItem",this.wNamespace),i.writeAttributeString("ds","itemID",void 0,e),i.writeAttributeString("xmlns","ds",void 0,this.dsNamespace),i.writeEndElement(),this.customXMLProps.push(o);var a=new n.ZipArchiveItem(i.buffer,o);return this.mArchive.addItem(a),s},e.prototype.serializeStyles=function(){var e=new r.XmlWriter;e.writeStartElement("w","styles",this.wNamespace),e.writeAttributeString("xmlns","mc",void 0,this.veNamespace),e.writeAttributeString("xmlns","r",void 0,this.rNamespace),e.writeAttributeString("xmlns","w",void 0,this.wNamespace),e.writeAttributeString("xmlns","w14",void 0,this.w14Namespace),e.writeAttributeString("xmlns","w15",void 0,this.w15Namespace),e.writeAttributeString("mc","Ignorable",void 0,"w14 w15"),this.serializeDefaultStyles(e),this.serializeDocumentStyles(e),e.writeEndElement();var t=new n.ZipArchiveItem(e.buffer,this.stylePath);this.mArchive.addItem(t)},e.prototype.serializeDefaultStyles=function(e){e.writeStartElement(void 0,"docDefaults",this.wNamespace),e.writeStartElement(void 0,"rPrDefault",this.wNamespace),this.serializeCharacterFormat(e,this.defCharacterFormat),e.writeEndElement(),e.writeStartElement(void 0,"pPrDefault",this.wNamespace),i.i(o.isNullOrUndefined)(this.defParagraphFormat)||(e.writeStartElement(void 0,"pPr",this.wNamespace),this.serializeParagraphFormat(e,this.defParagraphFormat,void 0),e.writeEndElement()),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeDocumentStyles=function(e){for(var t=0;t<this.mStyles.length;t++){var n=this.mStyles[t];e.writeStartElement(void 0,"style",this.wNamespace);var r=n[a._359[this.keywordIndex]]===(1==this.keywordIndex?0:"Paragraph")?"paragraph":"character";e.writeAttributeString("w","type",this.wNamespace,r),e.writeAttributeString("w","styleId",this.wNamespace,n[a._35[this.keywordIndex]]),e.writeStartElement(void 0,"name",this.wNamespace);-1!=["TOC 1","TOC 2","TOC 3","TOC 4","TOC 5","TOC 6","TOC 7","TOC 8","TOC 9"].indexOf(n[a._35[this.keywordIndex]])?e.writeAttributeString("w","val",this.wNamespace,n[a._35[this.keywordIndex]].toLowerCase()):e.writeAttributeString("w","val",this.wNamespace,n[a._35[this.keywordIndex]]),e.writeEndElement(),i.i(o.isNullOrUndefined)(n[a._36[this.keywordIndex]])||(e.writeStartElement(void 0,"basedOn",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,n[a._36[this.keywordIndex]]),e.writeEndElement()),i.i(o.isNullOrUndefined)(n[a._37[this.keywordIndex]])||(e.writeStartElement(void 0,"next",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,n[a._37[this.keywordIndex]]),e.writeEndElement()),i.i(o.isNullOrUndefined)(n[a._38[this.keywordIndex]])||(e.writeStartElement(void 0,"link",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,n[a._38[this.keywordIndex]]),e.writeEndElement()),n[a._359[this.keywordIndex]]===(1==this.keywordIndex?0:"Paragraph")&&(e.writeStartElement(void 0,"pPr",this.wNamespace),this.serializeParagraphFormat(e,n[a._5[this.keywordIndex]],void 0),e.writeEndElement()),this.serializeCharacterFormat(e,n[a._4[this.keywordIndex]]),e.writeEndElement()}},e.prototype.serializeCharacterFormat=function(e,t){if(i.i(o.isNullOrUndefined)(this.keywordIndex)&&(this.keywordIndex=0),e.writeStartElement(void 0,"rPr",this.wNamespace),i.i(o.isNullOrUndefined)(t[a._51[this.keywordIndex]])||(e.writeStartElement(void 0,"rStyle",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t[a._51[this.keywordIndex]]),e.writeEndElement()),!i.i(o.isNullOrUndefined)(t[a._50[this.keywordIndex]])||!i.i(o.isNullOrUndefined)(t[a._56[this.keywordIndex]])){if(e.writeStartElement(void 0,"rFonts",this.wNamespace),!i.i(o.isNullOrUndefined)(t[a._61[this.keywordIndex]])){var n=s.h.isThemeFont(t[a._61[this.keywordIndex]])?"asciiTheme":"ascii";e.writeAttributeString(void 0,n,this.wNamespace,t[a._61[this.keywordIndex]])}if(!i.i(o.isNullOrUndefined)(t[a._62[this.keywordIndex]])){var n=s.h.isThemeFont(t[a._62[this.keywordIndex]])?"eastAsiaTheme":"eastAsia";e.writeAttributeString(void 0,n,this.wNamespace,t[a._62[this.keywordIndex]])}if(!i.i(o.isNullOrUndefined)(t[a._63[this.keywordIndex]])){var n=s.h.isThemeFont(t[a._63[this.keywordIndex]])?"hAnsiTheme":"hAnsi";e.writeAttributeString(void 0,n,this.wNamespace,t[a._63[this.keywordIndex]])}if(!i.i(o.isNullOrUndefined)(t[a._56[this.keywordIndex]])){var n=s.h.isThemeFont(t[a._56[this.keywordIndex]])?"cstheme":"cs";e.writeAttributeString(void 0,n,this.wNamespace,t[a._56[this.keywordIndex]])}e.writeEndElement()}if(i.i(o.isNullOrUndefined)(t[a._42[this.keywordIndex]])||this.serializeBoolProperty(e,"b",s.h.parseBoolValue(t[a._42[this.keywordIndex]])),s.h.parseBoolValue(t[a._57[this.keywordIndex]])&&this.serializeBoolProperty(e,"bCs",s.h.parseBoolValue(t[a._57[this.keywordIndex]])),i.i(o.isNullOrUndefined)(t[a._43[this.keywordIndex]])||this.serializeBoolProperty(e,"i",s.h.parseBoolValue(t[a._43[this.keywordIndex]])),i.i(o.isNullOrUndefined)(t[a._58[this.keywordIndex]])||this.serializeBoolProperty(e,"iCs",s.h.parseBoolValue(t[a._58[this.keywordIndex]])),s.h.parseBoolValue(t[a._52[this.keywordIndex]])&&(e.writeStartElement(void 0,"rtl",this.wNamespace),e.writeEndElement()),i.i(o.isNullOrUndefined)(t[a._59[this.keywordIndex]])||this.serializeBoolProperty(e,"caps",s.h.parseBoolValue(t[a._59[this.keywordIndex]])),s.h.parseBoolValue(t[a._60[this.keywordIndex]])&&this.serializeBoolProperty(e,"cs",s.h.parseBoolValue(t[a._60[this.keywordIndex]])),!i.i(o.isNullOrUndefined)(t[a._46[this.keywordIndex]]))switch(t[a._46[this.keywordIndex]]){case"SingleStrike":case 1:this.serializeBoolProperty(e,"strike",!0);break;case"DoubleStrike":case 2:this.serializeBoolProperty(e,"dstrike",!0);break;default:this.serializeBoolProperty(e,"strike",!1),this.serializeBoolProperty(e,"dstrike",!1)}if(i.i(o.isNullOrUndefined)(t[a._49[this.keywordIndex]])||(e.writeStartElement(void 0,"color",this.wNamespace),"empty"===t[a._49[this.keywordIndex]]||"#00000000"===t[a._49[this.keywordIndex]]?e.writeAttributeString("w","val",this.wNamespace,"auto"):e.writeAttributeString("w","val",this.wNamespace,this.getColor(t[a._49[this.keywordIndex]])),e.writeEndElement()),i.i(o.isNullOrUndefined)(t[a._48[this.keywordIndex]])||(e.writeStartElement(void 0,"sz",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.roundToTwoDecimal(2*t[a._48[this.keywordIndex]]).toString()),e.writeEndElement()),i.i(o.isNullOrUndefined)(t[a._66[this.keywordIndex]])||(e.writeStartElement(void 0,"spacing",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,(20*t[a._66[this.keywordIndex]]).toString()),e.writeEndElement()),i.i(o.isNullOrUndefined)(t[a._67[this.keywordIndex]])||(e.writeStartElement(void 0,"w",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t[a._67[this.keywordIndex]].toString()),e.writeEndElement()),i.i(o.isNullOrUndefined)(t[a._55[this.keywordIndex]])||(e.writeStartElement(void 0,"szCs",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.roundToTwoDecimal(2*t[a._55[this.keywordIndex]]).toString()),e.writeEndElement()),i.i(o.isNullOrUndefined)(t[a._47[this.keywordIndex]])||t[a._47[this.keywordIndex]]===(1==this.keywordIndex?0:"NoColor")||(e.writeStartElement(void 0,"highlight",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.getHighlightColor(t[a._47[this.keywordIndex]])),e.writeEndElement()),!i.i(o.isNullOrUndefined)(t[a._64[this.keywordIndex]])&&t[a._64[this.keywordIndex]].length>0&&(this.serializeRevisionStart(e,t,void 0),this.serializeRevisionEnd(e,t,void 0)),i.i(o.isNullOrUndefined)(t[a._44[this.keywordIndex]])||(e.writeStartElement(void 0,"u",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.getUnderlineStyle(t[a._44[this.keywordIndex]])),e.writeEndElement()),!i.i(o.isNullOrUndefined)(t[a._45[this.keywordIndex]])){switch(e.writeStartElement(void 0,"vertAlign",this.wNamespace),t[a._45[this.keywordIndex]]){case"Superscript":case 1:e.writeAttributeString("w","val",this.wNamespace,"superscript");break;case"Subscript":case 2:e.writeAttributeString("w","val",this.wNamespace,"subscript");break;default:e.writeAttributeString("w","val",this.wNamespace,"baseline")}e.writeEndElement()}e.writeEndElement()},e.prototype.getColor=function(e){return e.length>0&&("#"===e[0]&&(e=e.substr(1)),e.length>6&&(e=e.substr(0,6))),e},e.prototype.getUnderlineStyle=function(e){switch(e){case"None":case 0:return"none";case"Single":case 1:return"single";case"Words":case 2:return"words";case"Double":case 3:return"double";case"Dotted":case 4:return"dotted";case"Thick":case 5:return"thick";case 6:return"dash";case"DashLong":case 7:return"dashLong";case"DotDash":case 8:return"dotDash";case"DotDotDash":case 9:return"dotDotDash";case"Wavy":case 10:return"wave";case"DottedHeavy":case 11:return"dottedHeavy";case"DashHeavy":case 12:return"dashedHeavy";case"DashLongHeavy":case 13:return"dashLongHeavy";case"DotDashHeavy":case 14:return"dashDotHeavy";case"DotDotDashHeavy":case 15:return"dashDotDotHeavy";case"WavyHeavy":case 16:return"wavyHeavy";case"WavyDouble":case 17:return"wavyDouble";default:return"dash"}},e.prototype.getHighlightColor=function(e){switch(e){case"BrightGreen":case 2:return"green";case"Turquoise":case 3:return"cyan";case"Pink":case 4:return"magenta";case"Blue":case 5:return"blue";case"Red":case 6:return"red";case"DarkBlue":case 7:return"darkBlue";case"Teal":case 8:return"darkCyan";case"Green":case 9:return"darkGreen";case"Violet":case 10:return"darkMagenta";case"DarkRed":case 11:return"darkRed";case"DarkYellow":case 12:return"darkYellow";case"Gray50":case 13:return"darkGray";case"Gray25":case 14:return"lightGray";case"Black":case 15:return"black";default:return"yellow"}},e.prototype.serializeBoolProperty=function(e,t,i){e.writeStartElement(void 0,t,this.wNamespace),i||e.writeAttributeString(void 0,"val",this.wNamespace,"0"),e.writeEndElement()},e.prototype.serializeNumberings=function(){if(0!==this.document[a._6[this.keywordIndex]].length){var e=new r.XmlWriter;e.writeStartElement("w","numbering",this.wNamespace),this.writeCommonAttributeStrings(e),this.serializeAbstractListStyles(e,this.document[a._7[this.keywordIndex]]),this.serializeListInstances(e,this.document[a._6[this.keywordIndex]]),e.writeEndElement();var t=new n.ZipArchiveItem(e.buffer,this.numberingPath);this.mArchive.addItem(t)}},e.prototype.serializeAbstractListStyles=function(e,t){for(var i=0;i<t.length;i++){var n=t[i];e.writeStartElement(void 0,"abstractNum",this.wNamespace),e.writeAttributeString(void 0,"abstractNumId",this.wNamespace,n[a._329[this.keywordIndex]].toString()),e.writeStartElement(void 0,"nsid",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.generateHex()),e.writeEndElement();for(var r=0,o=n[a._331[this.keywordIndex]].length;r<o;r++)this.serializeListLevel(e,n[a._331[this.keywordIndex]][r],r);e.writeEndElement()}},e.prototype.serializeListInstances=function(e,t){for(var i=0;i<t.length;i++){var n=t[i];e.writeStartElement(void 0,"num",this.wNamespace),e.writeAttributeString(void 0,"numId",this.wNamespace,(n[a._65[this.keywordIndex]]+1).toString()),e.writeStartElement(void 0,"abstractNumId",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,n[a._329[this.keywordIndex]].toString()),e.writeEndElement();for(var r=0,o=n[a._333[this.keywordIndex]].length;r<o;r++)this.serializeLevelOverrides(e,n[a._333[this.keywordIndex]][r],n[a._333[this.keywordIndex]][r][a._327[this.keywordIndex]]);e.writeEndElement()}},e.prototype.generateHex=function(){return(Math.floor(373e7*Math.random())+27e7).toString(16).toUpperCase()},e.prototype.roundToTwoDecimal=function(e){return Math.round(e)},e.prototype.serializeListLevel=function(e,t,n){e.writeStartElement(void 0,"lvl",this.wNamespace),e.writeAttributeString(void 0,"ilvl",this.wNamespace,n.toString()),!i.i(o.isNullOrUndefined)(t[a._301[this.keywordIndex]])&&t[a._301[this.keywordIndex]]&&e.writeElementString(void 0,"isLgl",this.wNamespace,void 0),e.writeStartElement(void 0,"start",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t[a._325[this.keywordIndex]].toString()),e.writeEndElement(),e.writeStartElement(void 0,"numFmt",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.getLevelPattern(t[a._323[this.keywordIndex]])),e.writeEndElement(),this.serializeLevelFollow(e,t),this.serializeLevelText(e,t,n+1),e.writeStartElement(void 0,"pPr",this.wNamespace),this.serializeParagraphFormat(e,t[a._5[this.keywordIndex]],void 0),e.writeEndElement(),this.serializeCharacterFormat(e,t[a._4[this.keywordIndex]]),e.writeEndElement()},e.prototype.serializeLevelOverrides=function(e,t,n){e.writeStartElement(void 0,"lvlOverride",this.wNamespace),e.writeAttributeString(void 0,"ilvl",this.wNamespace,n.toString()),i.i(o.isNullOrUndefined)(t[a._332[this.keywordIndex]])||this.serializeListLevel(e,t[a._332[this.keywordIndex]],n),i.i(o.isNullOrUndefined)(t[a._325[this.keywordIndex]])||(e.writeStartElement(void 0,"startOverride",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t[a._325[this.keywordIndex]].toString()),e.writeEndElement()),e.writeEndElement()},e.prototype.getLevelPattern=function(e){var t;switch(e){case"None":case 0:t="none";break;case"Arabic":case 1:t="decimal";break;case"UpRoman":case 2:t="upperRoman";break;case"LowRoman":case 3:t="lowerRoman";break;case"UpLetter":case 4:t="upperLetter";break;case"LowLetter":case 5:t="lowerLetter";break;case"Ordinal":case 6:t="ordinal";break;case"Number":case 7:t="cardinalText";break;case"OrdinalText":case 8:t="ordinalText";break;case"LeadingZero":case 9:t="decimalZero";break;case"FarEast":case 11:t="aiueoFullWidth";break;case"Special":case 12:t="russianLower";break;default:t="bullet"}return t},e.prototype.serializeLevelText=function(e,t,i){e.writeStartElement(void 0,"lvlText",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t[a._328[this.keywordIndex]]),e.writeEndElement()},e.prototype.serializeLevelFollow=function(e,t){var i;i=t[a._324[this.keywordIndex]]===(1==this.keywordIndex?0:"Tab")?"tab":t[a._324[this.keywordIndex]]===(1==this.keywordIndex?1:"Space")?"space":"nothing",e.writeStartElement(void 0,"suff",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,i),e.writeEndElement()},e.prototype.serializeThemeFontLang=function(e){var t=this.themeFontLang[a._41[this.keywordIndex]]>0,i=this.themeFontLang[a._39[this.keywordIndex]]>0,n=this.themeFontLang[a._40[this.keywordIndex]]>0;if(i||n||t){if(e.writeStartElement("w","themeFontLang",void 0),i){var r=a.l[this.themeFontLang[a._39[this.keywordIndex]]];e.writeAttributeString("w","val",void 0,r.replace("_","-"))}if(t){var o=a.l[this.themeFontLang[a._41[this.keywordIndex]]];e.writeAttributeString("w","bidi",void 0,o.replace("_","-"))}if(n){var s=a.l[this.themeFontLang[a._40[this.keywordIndex]]];e.writeAttributeString("w","eastAsia",void 0,s.replace("_","-"))}e.writeEndElement()}},e.prototype.serializeDocumentProtectionSettings=function(e){if(e.writeStartElement("w","documentProtection",this.wNamespace),this.formatting&&e.writeAttributeString("w","formatting",this.wNamespace,"1"),this.protectionType&&0!==this.protectionType){var t=void 0;switch(this.protectionType){case"ReadOnly":case 1:t="readOnly";break;case"FormFieldsOnly":case 2:t="forms";break;case"CommentsOnly":case 3:t="comments";break;case"RevisionsOnly":case 4:t="trackedChanges"}e.writeAttributeString("w","edit",this.wNamespace,t)}e.writeAttributeString("w","cryptProviderType",this.wNamespace,"rsaAES"),e.writeAttributeString("w","cryptAlgorithmClass",this.wNamespace,"hash"),e.writeAttributeString("w","cryptAlgorithmType",this.wNamespace,"typeAny"),e.writeAttributeString("w","cryptAlgorithmSid",this.wNamespace,"14"),e.writeAttributeString("w","cryptSpinCount",this.wNamespace,"100000"),this.enforcement&&e.writeAttributeString("w","enforcement",this.wNamespace,"1"),this.hashValue&&e.writeAttributeString("w","hash",this.wNamespace,this.hashValue),this.saltValue&&e.writeAttributeString("w","salt",this.wNamespace,this.saltValue),e.writeEndElement()},e.prototype.serializeSettings=function(){var e=new r.XmlWriter;e.writeStartElement("w","settings",this.wNamespace),this.writeCustom(e),e.writeAttributeString("xmlns","w10",void 0,this.w10Namespace),e.writeAttributeString("xmlns","w14",void 0,this.w14Namespace),e.writeAttributeString("xmlns","w15",void 0,this.w15Namespace),e.writeAttributeString("xmlns","sl",void 0,this.slNamespace),e.writeAttributeString("mc","Ignorable",void 0,"w14 w15"),this.serializeDocumentProtectionSettings(e),e.writeStartElement("w","zoom",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"none"),e.writeAttributeString("w","percent",this.wNamespace,"100"),e.writeEndElement(),this.serializeThemeFontLang(e),e.writeStartElement(void 0,"displayBackgroundShape",this.wNamespace),e.writeEndElement(),e.writeStartElement(void 0,"defaultTabStop",this.wNamespace);var t=Math.round(this.defaultTabWidthValue*this.twipsInOnePoint);e.writeAttributeString(void 0,"val",this.wNamespace,t.toString()),e.writeEndElement(),this.trackChanges&&(e.writeStartElement(void 0,"trackRevisions",this.wNamespace),e.writeEndElement()),this.mDifferentFirstPage&&(e.writeStartElement(void 0,"evenAndOddHeaders",this.wNamespace),e.writeEndElement()),this.formFieldShading||(e.writeStartElement(void 0,"doNotShadeFormData",this.wNamespace),e.writeEndElement()),e.writeStartElement(void 0,"compat",this.wNamespace),this.dontUseHtmlParagraphAutoSpacing&&this.serializeBoolProperty(e,"doNotUseHTMLParagraphAutoSpacing",this.dontUseHtmlParagraphAutoSpacing),this.allowSpaceOfSameStyleInTable&&this.serializeBoolProperty(e,"allowSpaceOfSameStyleInTable",this.allowSpaceOfSameStyleInTable),e.writeStartElement(void 0,"compatSetting",this.wNamespace),e.writeAttributeString(void 0,"name",this.wNamespace,"compatibilityMode"),e.writeAttributeString(void 0,"uri",this.wNamespace,"http://schemas.microsoft.com/office/word");var i=1===this.keywordIndex?s.h.getCompatibilityModeValue(this.compatibilityMode):s.h.getCompatibilityModeValue(this.getCompatibilityModeEnumValue(this.compatibilityMode.toString()));e.writeAttributeString(void 0,"val",this.wNamespace,i),e.writeEndElement(),e.writeEndElement(),this.document[a._30[this.keywordIndex]]&&(e.writeStartElement(void 0,"footnotePr",this.wNamespace),e.writeStartElement(void 0,"footnote",this.wNamespace),e.writeAttributeString(void 0,"id",this.wNamespace,"-1"),e.writeEndElement(),e.writeStartElement(void 0,"footnote",this.wNamespace),e.writeAttributeString(void 0,"id",this.wNamespace,"0"),e.writeEndElement(),e.writeEndElement()),this.document[a._31[this.keywordIndex]]&&(e.writeStartElement(void 0,"endnotePr",this.wNamespace),e.writeStartElement(void 0,"endnote",this.wNamespace),e.writeAttributeString(void 0,"id",this.wNamespace,"-1"),e.writeEndElement(),e.writeStartElement(void 0,"endnote",this.wNamespace),e.writeAttributeString(void 0,"id",this.wNamespace,"0"),e.writeEndElement(),e.writeEndElement()),e.writeEndElement();var o=new n.ZipArchiveItem(e.buffer,this.settingsPath);this.mArchive.addItem(o)},e.prototype.serializeCoreProperties=function(){},e.prototype.serializeAppProperties=function(){},e.prototype.serializeFontTable=function(e){},e.prototype.serializeSettingsRelation=function(){},e.prototype.getCompatibilityModeEnumValue=function(e){switch(e){case"Word2013":return 0;case"Word2003":return 1;case"Word2007":return 2;case"Word2010":return 3}},e.prototype.serializeHeaderFooters=function(){this.isHeaderFooter=!0,this.serializeHeaderFooter("EvenFooter"),this.serializeHeaderFooter("EvenHeader"),this.serializeHeaderFooter("FirstPageFooter"),this.serializeHeaderFooter("FirstPageHeader"),this.serializeHeaderFooter("OddFooter"),this.serializeHeaderFooter("OddHeader"),this.isHeaderFooter=!1},e.prototype.serializeHeaderFooter=function(e){if(0!==this.headersFooters.length){var t,i;if(this.headersFooters.containsKey(e))for(var n=this.headersFooters.get(e),r=void 0,o=0;o<n.keys.length;o++){var s=n.keys[o];r=n.get(s),"EvenHeader"===e||"FirstPageHeader"===e||"OddHeader"===e?(t=this.headerPath+s.replace("rId","")+".xml",i=this.headerRelationPath+s.replace("rId","")+".xml.rels",this.serializeHeader(r,s,t,i)):(t=this.footerPath+s.replace("rId","")+".xml",i=this.footerRelationPath+s.replace("rId","")+".xml.rels",this.serializeFooter(r,s,t,i))}}},e.prototype.serializeHeader=function(e,t,i,o){this.headerFooter=e;var s=new r.XmlWriter;s.writeStartElement("w","hdr",this.wNamespace),this.writeHFCommonAttributes(s);var l=this.blockOwner;this.blockOwner=e,this.serializeBodyItems(s,e[a._314[this.keywordIndex]],!0),this.blockOwner=l,s.writeEndElement();var d=new n.ZipArchiveItem(s.buffer,i);this.mArchive.addItem(d),this.serializeHFRelations(t,o),this.headerFooter=void 0},e.prototype.serializeHFRelations=function(e,t){if(this.headerFooterImages.containsKey(e)){var i=new r.XmlWriter;i.writeStartElement(void 0,"Relationships",this.rpNamespace),this.serializeImagesRelations(this.headerFooterImages.get(e),i,!1),this.headerFooterSvgImages.containsKey(e)&&this.serializeSvgImageRelation(this.headerFooterSvgImages.get(e),i),i.writeEndElement();var o=new n.ZipArchiveItem(i.buffer,t);this.mArchive.addItem(o)}},e.prototype.writeHFCommonAttributes=function(e){e.writeAttributeString("xmlns","v",void 0,this.vNamespace),e.writeAttributeString("xmlns","w10",void 0,this.w10Namespace),e.writeAttributeString("xmlns","o",void 0,this.oNamespace),e.writeAttributeString("xmlns","ve",void 0,this.veNamespace),e.writeAttributeString("xmlns","r",void 0,this.rNamespace),e.writeAttributeString("xmlns","m",void 0,this.mNamespace),e.writeAttributeString("xmlns","wne",void 0,this.wneNamespace),e.writeAttributeString("xmlns","a",void 0,this.aNamespace),e.writeAttributeString("xmlns","pic",void 0,this.pictureNamespace),e.writeAttributeString("xmlns","wp",void 0,this.wpNamespace),e.writeAttributeString("xmlns","wpc",void 0,this.wpCanvasNamespace),e.writeAttributeString("xmlns","wp14",void 0,this.wpDrawingNamespace),this.writeDup(e),e.writeAttributeString("xmlns","wps",void 0,this.wpShapeNamespace),e.writeAttributeString("ve","Ignorable",void 0,"w14 w15 wp14")},e.prototype.serializeFooter=function(e,t,i,o){this.headerFooter=e;var s=new r.XmlWriter;s.writeStartElement("w","ftr",this.wNamespace),this.writeHFCommonAttributes(s),this.serializeBodyItems(s,e[a._314[this.keywordIndex]],!0),s.writeEndElement();var l=new n.ZipArchiveItem(s.buffer,i);this.mArchive.addItem(l),this.serializeHFRelations(t,o)},e.prototype.serializeDocumentRelations=function(){var e=new r.XmlWriter;e.writeStartElement(void 0,"Relationships",this.rpNamespace),this.serializeRelationShip(e,this.getNextRelationShipID(),this.stylesRelType,"styles.xml"),this.serializeRelationShip(e,this.getNextRelationShipID(),this.settingsRelType,"settings.xml"),this.document[a._31[this.keywordIndex]]&&this.serializeRelationShip(e,this.getNextRelationShipID(),this.endnoteRelType,"endnotes.xml"),this.document[a._30[this.keywordIndex]]&&this.serializeRelationShip(e,this.getNextRelationShipID(),this.footnoteRelType,"footnotes.xml"),this.mComments.length>0&&(1===this.mComments.length&&""===this.mComments[0].text||(this.serializeRelationShip(e,this.getNextRelationShipID(),this.commentsRelType,"comments.xml"),this.serializeRelationShip(e,this.getNextRelationShipID(),this.commentsExRelType,"commentsExtended.xml"))),i.i(o.isNullOrUndefined)(this.mThemes)||this.serializeRelationShip(e,this.getNextRelationShipID(),this.ThemeRelType,"theme/theme1.xml"),this.document[a._6[this.keywordIndex]].length>0&&this.serializeRelationShip(e,this.getNextRelationShipID(),this.numberingRelType,"numbering.xml"),this.serializeHeaderFooterRelations(e),this.serializeImagesRelations(this.documentImages,e,!1),this.serializeSvgImageRelation(this.svgImages,e),this.serializeCustomXMLMapping(this.mCustomXML,e),this.serializeChartDocumentRelations(this.documentCharts,e),this.serializeExternalLinkImages(e),e.writeEndElement();var t=new n.ZipArchiveItem(e.buffer,this.wordRelationPath);this.mArchive.addItem(t),this.headerFooter=void 0},e.prototype.serializeChartDocumentRelations=function(e,t){if(e.length>0)for(var i=e.keys,n=1;n<=i.length;n++)this.serializeRelationShip(t,i[n-1],this.chartRelType,"charts/chart"+n+".xml")},e.prototype.serializeChartRelations=function(){var e=new r.XmlWriter;this.resetChartRelationShipId(),e.writeStartElement(void 0,"Relationships",this.rpNamespace);var t="colors"+this.chartCount+".xml",i=this.chartPath+"/_rels/chart"+this.chartCount+".xml.rels",o="../embeddings/Microsoft_Excel_Worksheet"+this.chartCount+".xlsx";this.serializeRelationShip(e,this.getNextChartRelationShipID(),this.packageRelType,o),this.serializeRelationShip(e,this.getNextChartRelationShipID(),this.chartColorStyleRelType,t),e.writeEndElement();var s=new n.ZipArchiveItem(e.buffer,i);this.mArchive.addItem(s)},e.prototype.serializeImagesRelations=function(e,t,r){if(e.length>0)for(var l="",d=void 0,h=e.keys,c=0;c<h.length;c++){var p=e.get(h[c]),u=void 0;if("string"==typeof p&&this.startsWith(p,"data"))d=p;else if(u=this.getBase64ImageString(p),d=u.imageString,s.h.parseBoolValue(p[a._228[this.keywordIndex]])){var g=s.h.formatClippedString(u.metaFileImageString).extension;(".svg"!==g||r)&&(d=u.metaFileImageString)}if(i.i(o.isNullOrUndefined)(d))l=this.imagePath+"/0.jpeg",this.serializeRelationShip(t,h[c],this.imageRelType,l.replace("word/",""));else{var f=s.h.formatClippedString(d),m=f.extension,v=f.formatClippedString;l=this.imagePath+h[c]+m,this.serializeRelationShip(t,h[c],this.imageRelType,l.replace("word/",""));var y=void 0;y=this.startsWith(d,"data:image/svg+xml;utf8,")?new Blob([v]):new Blob([this.encodedString(v)]);var w=new n.ZipArchiveItem(y,l);this.mArchive.addItem(w)}}},e.prototype.serializeSvgImageRelation=function(e,t){this.serializeImagesRelations(e,t,!0)},e.prototype.encodedString=function(e){var t,i,n,r,o,s,a,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",d=0,h=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");var c=3*e.length/4;if(e.charAt(e.length-1)===l.charAt(64)&&c--,e.charAt(e.length-2)===l.charAt(64)&&c--,c%1!=0)throw new Error("Invalid base64 input, bad content length.");for(var p=new Uint8Array(0|c);d<e.length;)r=l.indexOf(e.charAt(d++)),o=l.indexOf(e.charAt(d++)),s=l.indexOf(e.charAt(d++)),a=l.indexOf(e.charAt(d++)),t=r<<2|o>>4,i=(15&o)<<4|s>>2,n=(3&s)<<6|a,p[h++]=t,64!==s&&(p[h++]=i),64!==a&&(p[h++]=n);return p},e.prototype.serializeExternalLinkImages=function(e){for(var t=this.externalImages.keys,i=0;i<this.externalImages.keys.length;i++)this.serializeRelationShip(e,t[i],this.imageRelType,this.externalImages.get(t[i]))},e.prototype.serializeHeaderFooterRelations=function(e){this.serializeHFRelation(e,"EvenFooter"),this.serializeHFRelation(e,"EvenHeader"),this.serializeHFRelation(e,"FirstPageFooter"),this.serializeHFRelation(e,"FirstPageHeader"),this.serializeHFRelation(e,"OddFooter"),this.serializeHFRelation(e,"OddHeader")},e.prototype.serializeHFRelation=function(e,t){var i,n="";if(this.headersFooters.containsKey(t))for(var r=this.headersFooters.get(t),o=0;o<r.keys.length;o++){var s=r.keys[o];"EvenHeader"===t||"FirstPageHeader"===t||"OddHeader"===t?(n="header"+s.replace("rId","")+".xml",i=this.headerRelType):(n="footer"+s.replace("rId","")+".xml",i=this.footerRelType),this.serializeRelationShip(e,s,i,n)}},e.prototype.serializeRelationShip=function(e,t,i,n){e.writeStartElement(void 0,"Relationship",void 0),e.writeAttributeString(void 0,"Id",void 0,t),e.writeAttributeString(void 0,"Type",void 0,i),e.writeAttributeString(void 0,"Target",void 0,n.replace("\\","/").replace("\v","")),(i===this.hyperlinkRelType||this.startsWith(n,"http://")||this.startsWith(n,"https://")||this.startsWith(n,"file:///"))&&e.writeAttributeString(void 0,"TargetMode",void 0,"External"),e.writeEndElement()},e.prototype.getNextRelationShipID=function(){return"rId"+ ++this.mRelationShipID},e.prototype.getEFNextRelationShipID=function(){return(++this.efRelationShipId).toString()},e.prototype.serializeGeneralRelations=function(){var e=new r.XmlWriter;this.resetRelationShipID(),e.writeStartElement(void 0,"Relationships",this.rpNamespace),this.serializeRelationShip(e,this.getNextRelationShipID(),this.documentRelType,this.documentPath),e.writeEndElement();var t=new n.ZipArchiveItem(e.buffer,this.generalRelationPath);this.mArchive.addItem(t)},e.prototype.serializeContentTypes=function(e,t){var i=new r.XmlWriter;if(i.writeStartElement(void 0,"Types","http://schemas.openxmlformats.org/package/2006/content-types"),this.serializeDefaultContentType(i,"rels",this.relationContentType),this.serializeDefaultContentType(i,"xml",this.xmlContentType),(this.documentImages.length>0||this.externalImages.length>0||this.headerFooterImages.length>0)&&(this.serializeDefaultContentType(i,"png","image/png"),this.serializeDefaultContentType(i,"bmp","image/bmp"),this.serializeDefaultContentType(i,"emf","image/x-emf"),this.serializeDefaultContentType(i,"wmf","image/x-wmf"),this.serializeDefaultContentType(i,"gif","image/gif"),this.serializeDefaultContentType(i,"ico","image/x-icon"),this.serializeDefaultContentType(i,"tif","image/tiff"),this.serializeDefaultContentType(i,"tiff","image/tiff"),this.serializeDefaultContentType(i,"jpeg","image/jpeg"),this.serializeDefaultContentType(i,"jpg","image/jpeg"),this.serializeDefaultContentType(i,"svg","image/svg+xml")),"Docx"==t?this.serializeOverrideContentType(i,this.documentPath,this.documentContentType):"Dotx"==t&&this.serializeOverrideContentType(i,this.documentPath,this.TemplateContentType),this.serializeOverrideContentType(i,this.numberingPath,this.numberingContentType),this.serializeOverrideContentType(i,this.stylePath,this.stylesContentType),this.serializeOverrideContentType(i,this.settingsPath,this.settingsContentType),this.serializeOverrideContentType(i,this.commentsPath,this.commentsContentType),this.serializeOverrideContentType(i,this.themePath,this.themeContentType),this.serializeOverrideContentType(i,this.commentsExtendedPath,this.commentsExContentType),this.chartCount>0){var o=1;for(this.serializeDefaultContentType(i,"xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet");o<=this.chartCount;)this.serializeOverrideContentType(i,"word/charts/chart"+o+".xml",this.chartsContentType),this.serializeOverrideContentType(i,"word/charts/colors"+o+".xml",this.chartColorStyleContentType),o++}if(this.customXMLProps.length>0)for(var s=0;s<this.customXMLProps.length;s++)this.serializeOverrideContentType(i,this.customXMLProps[s],this.customXmlContentType);this.serializeHFContentTypes(i),this.SerializeEFContentTypes(i),i.writeEndElement();var a=new n.ZipArchiveItem(i.buffer,this.contentTypesPath);this.mArchive.addItem(a)},e.prototype.serializeHFContentTypes=function(e){this.serializeHeaderFootersContentType(e,"EvenFooter"),this.serializeHeaderFootersContentType(e,"EvenHeader"),this.serializeHeaderFootersContentType(e,"FirstPageFooter"),this.serializeHeaderFootersContentType(e,"FirstPageHeader"),this.serializeHeaderFootersContentType(e,"OddFooter"),this.serializeHeaderFootersContentType(e,"OddHeader")},e.prototype.serializeHeaderFootersContentType=function(e,t){var i,n;if(this.headersFooters.containsKey(t))for(var r=this.headersFooters.get(t),o=0;o<r.keys.length;o++){var s=r.keys[o];"EvenHeader"===t||"FirstPageHeader"===t||"OddHeader"===t?(n=this.headerPath+s.replace("rId","")+".xml",i=this.headerContentType):(n=this.footerPath+s.replace("rId","")+".xml",i=this.footerContentType),this.serializeOverrideContentType(e,n,i)}},e.prototype.SerializeEFContentTypes=function(e){this.serializeEFContentType(e)},e.prototype.serializeEFContentType=function(e){var t,i;i=this.endnotesPath,t=this.endnoteContentType,this.serializeOverrideContentType(e,i,t),i=this.footnotesPath,t=this.footnoteContentType,this.serializeOverrideContentType(e,i,t)},e.prototype.serializeOverrideContentType=function(e,t,i){e.writeStartElement(void 0,"Override",void 0),e.writeAttributeString(void 0,"PartName",void 0,"/"+t.replace("\\","/")),e.writeAttributeString(void 0,"ContentType",void 0,i),e.writeEndElement()},e.prototype.serializeDefaultContentType=function(e,t,i){e.writeStartElement(void 0,"Default",void 0),e.writeAttributeString(void 0,"Extension",void 0,t),e.writeAttributeString(void 0,"ContentType",void 0,i),e.writeEndElement()},e.prototype.resetRelationShipID=function(){this.mRelationShipID=0},e.prototype.resetExcelRelationShipId=function(){this.eRelationShipId=0},e.prototype.resetChartRelationShipId=function(){this.cRelationShipId=0},e.prototype.close=function(){},e}()},function(e,t){e.exports=c},function(e,t){e.exports=p}])});